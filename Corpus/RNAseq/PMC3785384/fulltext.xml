<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Cancer Inform</journal-id><journal-id journal-id-type="iso-abbrev">Cancer Inform</journal-id><journal-id journal-id-type="publisher-id">101258149</journal-id><journal-title-group><journal-title>Cancer Informatics</journal-title></journal-title-group><issn pub-type="epub">1176-9351</issn><publisher><publisher-name>Libertas Academica</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3785384</article-id><article-id pub-id-type="doi">10.4137/CIN.S12862</article-id><article-id pub-id-type="publisher-id">cin-12-2013-193</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Research</subject></subj-group></article-categories><title-group><article-title>Monitoring of Technical Variation in Quantitative High-Throughput Datasets</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Lauss</surname><given-names>Martin</given-names></name><xref ref-type="aff" rid="af1-cin-12-2013-193">1</xref><xref ref-type="corresp" rid="c1-cin-12-2013-193"/></contrib><contrib contrib-type="author"><name><surname>Visne</surname><given-names>Ilhami</given-names></name><xref ref-type="aff" rid="af2-cin-12-2013-193">2</xref></contrib><contrib contrib-type="author"><name><surname>Kriegner</surname><given-names>Albert</given-names></name><xref ref-type="aff" rid="af2-cin-12-2013-193">2</xref></contrib><contrib contrib-type="author"><name><surname>Ringn&#x000e9;r</surname><given-names>Markus</given-names></name><xref ref-type="aff" rid="af1-cin-12-2013-193">1</xref></contrib><contrib contrib-type="author"><name><surname>J&#x000f6;nsson</surname><given-names>G&#x000f6;ran</given-names></name><xref ref-type="aff" rid="af1-cin-12-2013-193">1</xref></contrib><contrib contrib-type="author"><name><surname>H&#x000f6;glund</surname><given-names>Mattias</given-names></name><xref ref-type="aff" rid="af1-cin-12-2013-193">1</xref></contrib></contrib-group><aff id="af1-cin-12-2013-193"><label>1</label>Department of Oncology, Clinical Sciences, Lund University, Sweden.</aff><aff id="af2-cin-12-2013-193"><label>2</label>Austrian Institute of Technology, Vienna, Austria.</aff><author-notes><corresp id="c1-cin-12-2013-193">Corresponding author email: <email>martin.lauss@med.lu.se</email></corresp></author-notes><pub-date pub-type="collection"><year>2013</year></pub-date><pub-date pub-type="epub"><day>23</day><month>9</month><year>2013</year></pub-date><volume>12</volume><fpage>193</fpage><lpage>201</lpage><permissions><copyright-statement>&#x000a9; 2013 the author(s), publisher and licensee Libertas Academica Ltd.</copyright-statement><copyright-year>2013</copyright-year><license license-type="open-access"><license-p>This is an open access article published under the Creative Commons CC-BY-NC 3.0 license.</license-p></license></permissions><abstract><p>High-dimensional datasets can be confounded by variation from technical sources, such as batches. Undetected batch effects can have severe consequences for the validity of a study&#x02019;s conclusion(s). We evaluate high-throughput RNAseq and miRNAseq as well as DNA methylation and gene expression microarray datasets, mainly from the Cancer Genome Atlas (TCGA) project, in respect to technical and biological annotations. We observe technical bias in these datasets and discuss corrective interventions. We then suggest a general procedure to control study design, detect technical bias using linear regression of principal components, correct for batch effects, and re-evaluate principal components. This procedure is implemented in the R package <italic>swamp</italic>, and as graphical user interface software. In conclusion, high-throughput platforms that generate continuous measurements are sensitive to various forms of technical bias. For such data, monitoring of technical variation is an important analysis step.</p></abstract><kwd-group><kwd>data adjustment</kwd><kwd>batch effect</kwd><kwd>bias</kwd><kwd>sample annotation</kwd><kwd>RNAseq</kwd><kwd>high-throughput analysis</kwd></kwd-group></article-meta></front><body><sec><title>Introduction</title><p>In high-throughput datasets, sophisticated biostatistical analyses are required to see how technical and biological information of samples is reflected in the data. The variation inherent to the samples (biological variation) coexists with variation added by technical sources, such as batch effects, and random noise.<xref ref-type="bibr" rid="b1-cin-12-2013-193">1</xref> A landmark study has highlighted that technical biases in the form of batch effects are found in several high-dimensional data such as gene expression, protein data, and data from next-generation sequencing.<xref ref-type="bibr" rid="b2-cin-12-2013-193">2</xref> Data on epigenetic profiling<xref ref-type="bibr" rid="b3-cin-12-2013-193">3</xref> and copy number changes<xref ref-type="bibr" rid="b4-cin-12-2013-193">4</xref> may also be influenced by batch effects. The underlying cause of an observed batch effect is often unclear and may be linked to a variety of experimental conditions, such as reagent lot, date of experiment, or laboratory personnel. In a broader sense, the merging of several datasets into one single dataset also constitutes a batch effect problem.<xref ref-type="bibr" rid="b5-cin-12-2013-193">5</xref>,<xref ref-type="bibr" rid="b6-cin-12-2013-193">6</xref> Undetected batch effects can have major impact on subsequent conclusions in both unsupervised and supervised analysis.<xref ref-type="bibr" rid="b2-cin-12-2013-193">2</xref> Several methods that remove or adjust batch variation have been developed. These methods range from simple batchwise centering of probes to more sophisticated methods, eg, ComBat,<xref ref-type="bibr" rid="b7-cin-12-2013-193">7</xref> DWD,<xref ref-type="bibr" rid="b8-cin-12-2013-193">8</xref> SVA,<xref ref-type="bibr" rid="b9-cin-12-2013-193">9</xref> and XPN;<xref ref-type="bibr" rid="b10-cin-12-2013-193">10</xref> however no clear best-performing method has emerged.<xref ref-type="bibr" rid="b11-cin-12-2013-193">11</xref>,<xref ref-type="bibr" rid="b12-cin-12-2013-193">12</xref> It is worth noting that batch correction changes the data substantially and may be incomplete or may introduce new bias to the data. Therefore it is important to evaluate the quality of batch correction.</p><p>Herein we identify technical bias in datasets from commonly used high-throughput platforms and delineate problems of batch correction in such data. We then suggest a simple procedure to validate batch correction that can be conveniently applied using the R package <italic>swamp</italic>.</p></sec><sec sec-type="methods"><title>Methods</title><sec><title>Detection, correction and re-evaluation of technical bias</title><p>We have developed the R package <italic>swamp</italic> to provide algorithms and supportive plots for the analyses of high-throughput data in respect to sample annotations. The basic elements of the suggested framework presented in <xref ref-type="fig" rid="f4-cin-12-2013-193">Figure 4</xref> are:</p><list list-type="order"><list-item><p>Study design: Heatmap of the square matrix of log<sub>10</sub><italic>P</italic>-values from pair-wise tests of sample annotations using Fisher/Chi-square test or linear models. Function: <italic>confounding</italic>.</p></list-item><list-item><p>Principal component analysis, using univariate linear regression models to determine the association between principal components and sample annotations. A heatmap of log<sub>10</sub><italic>P</italic>-values or R<sup>2</sup> values is plotted. Functions: <italic>prince, prince.plot</italic>.</p></list-item><list-item><p>Hierarchical clustering analysis and a quantification of batch effects across the dendrogram clusters using Fisher/Chi-square test or linear models for factors and numeric vectors respectively. Functions: <italic>hca.plot, hca.test</italic>.</p></list-item><list-item><p>We include two data correction methods that so far have not been implemented in R packages: The function <italic>kill.pc</italic> removes principal components from the data, as described by Alter et al.<xref ref-type="bibr" rid="b13-cin-12-2013-193">13</xref> Principal components are deleted from the data by setting the corresponding singular values to zero and recalculating the data matrix. The function <italic>adjust.linearmodel</italic> uses the lm() function to obtain for each probe the residuals of a linear regression model with the technical variable as regressor. The <italic>adjust.linearmodel</italic> function makes it possible to correct the data for continuous technical variables. Furthermore we implemented the popular Com-Bat algorithm,<xref ref-type="bibr" rid="b7-cin-12-2013-193">7</xref> taken from the webpage <ext-link ext-link-type="uri" xlink:href="http://www.bu.edu/jlab/wp-assets/ComBat">http://www.bu.edu/jlab/wp-assets/ComBat</ext-link>, in the function <italic>combat.</italic> The functions <italic>batchadjust.ref</italic> and <italic>bachadjust.zero</italic> perform simple median-centering of each probe and batch.</p></list-item></list><p>Additional batch correction methods, which may be more appropriate for certain data types, can be found in dedicated R packages for dwd,<xref ref-type="bibr" rid="b14-cin-12-2013-193">14</xref> poe,<xref ref-type="bibr" rid="b15-cin-12-2013-193">15</xref> sva,<xref ref-type="bibr" rid="b16-cin-12-2013-193">16</xref> isva,<xref ref-type="bibr" rid="b17-cin-12-2013-193">17</xref> pls-sva,<xref ref-type="bibr" rid="b18-cin-12-2013-193">18</xref> and xpn.<xref ref-type="bibr" rid="b12-cin-12-2013-193">12</xref></p></sec><sec sec-type="methods"><title>Data processing</title><p>For RNAseq data, we downloaded level3 RNAseqv2 data from the Cancer Genome Atlas (TCGA) data portal. We used the files that contain &#x02018;reads per kilo-base per million mapped reads&#x02019; (RPKM) values for each gene. There is currently no standard processing pipeline of RPKM values. In the case of colon cancer, we used quantile-normalization as it removed substantial amounts of unexplained variation. For all RNAseq datasets from TCGA, we added an offset of 32, capped the data at 65,000, log2 transformed the data, and mean-centered the genes. This simple pre-processing method makes the data similar to the microarray gene expression format. It has been proposed that heteroscedastic RNAseq counts may influence downstream homoscedastic-based methods, such as principal component analysis.<xref ref-type="bibr" rid="b19-cin-12-2013-193">19</xref> We therefore compared the simple pre-processing method with &#x02018;variance stabilizing transformation&#x02019; (vst).<xref ref-type="bibr" rid="b19-cin-12-2013-193">19</xref> However, we find that principal component analysis of TCGA data produces highly similar results for the simple pre-processing method and the vst-correction (<xref ref-type="supplementary-material" rid="s1-cin-12-2013-193">Supplementary Fig. 1</xref>). In order to limit unnecessary data transformation, we did not continue to use vst-corrected data. For miRNAseq data, we downloaded level3 data from the TCGA data portal and performed the same data pre-processing (offset 32, cap 65,000, log2 transformation).</p><p>For methylation data we downloaded level2 data and calculated beta-values as M/(M+U), where M is methylated and U is unmethylated signal. For microarray gene expression data we used processed data from Leek et al.<xref ref-type="bibr" rid="b2-cin-12-2013-193">2</xref> The batch variable in this dataset refers to date of hybridization, as derived from the headers of the cel files.</p></sec><sec><title>Availability and requirements</title><p>The R package <italic>swamp</italic> is freely available at CRAN. The package runs in R 2.15 or higher, and requires <italic>amap</italic>, <italic>gplots</italic>, and <italic>impute</italic><xref ref-type="bibr" rid="b20-cin-12-2013-193">20</xref> packages. A Windows software for <italic>swamp</italic> is freely available at <ext-link ext-link-type="uri" xlink:href="http://co.bmc.lu.se/swamp/">http://co.bmc.lu.se/swamp/</ext-link>. The software is implemented in RGG language,<xref ref-type="bibr" rid="b21-cin-12-2013-193">21</xref> and requires R 2.15 or higher and Java.</p></sec></sec><sec sec-type="results"><title>Results</title><sec sec-type="methods"><title>Batch effects are found in a variety of datasets</title><p>TCGA resource is remarkable as it reports technical variables in detail, notably by the MD Anderson Batch Effects Tool that implements the MBatch package. To visualize technical bias, such as batch effects, in high-throughput datasets, we introduce a plot which we call <italic>prince</italic> plot (<xref ref-type="fig" rid="f1-cin-12-2013-193">Fig. 1</xref>). For the <italic>prince</italic> plot we perform a univariate linear regression of each principal component of a data matrix using the sample annotations as regressors. The heatmap of <italic>P</italic>-values shows the strength of associations of each sample annotation with the top principal components of a dataset. Biological variables are well associated to the top principal components, as shown in <xref ref-type="fig" rid="f1-cin-12-2013-193">Figure 1</xref>, for several types of data, including RNAseq, miRNAseq, Methylation27K, and Affymetrix gene expression data. For instance, estrogen receptor status is strongly associated with top components of all three breast cancer datasets. In the kidney cancer RNAseq and miRNAseq data sets, histological grade and tumor stage are well associated with principal component 1. However, technical variables can also be associated to high-ranking principal components. In particular, the &#x02018;batch&#x02019; annotations from TCGA data were associated to the top components in all types of investigated data (<xref ref-type="fig" rid="f1-cin-12-2013-193">Fig. 1</xref>). The &#x02018;batch&#x02019; variable is not further defined in the TCGA project; however, in most datasets correlates well with &#x02018;tissue source site&#x02019; (hospital), &#x02018;shipment date,&#x02019; and &#x02018;plate-id&#x02019; variables. Notably, the &#x02018;tissue source site&#x02019; variable can introduce slightly different bias when compared to the &#x02018;batch&#x02019; variable, as observed in the breast cancer RNAseq data (<xref ref-type="fig" rid="f1-cin-12-2013-193">Fig. 1</xref>). Sources of technical bias can also stem from continuous variables such as amount of DNA or RIN-value (RNA Integrity Number, ranges from 1 to 10) as observed in the kidney cancer RNAseq dataset. Furthermore, technical bias can occur in more than one principal component. For example, the batch variable of the lung cancer RNAseq data is associated with principal components 2, 3 and 4; and the strength of these associations differs across principal components. Biological variation may overlap technical variation and therefore can influence the same principal component. For example, principal component 2 of the bladder cancer expression data indicates that the technical &#x02018;batch&#x02019; and the biological &#x02018;CIS&#x02019; variables are interrelated. In summary, technical bias is present in all investigated high-throughput technologies, varies in effect size, and may overlap with biological variation in the data.</p></sec><sec><title>Monitoring of batch correction</title><p>We took RNAseq data from TCGA&#x02019;s colon cancer project generated using Illumina Hiseq2000 technology as an example.<xref ref-type="bibr" rid="b22-cin-12-2013-193">22</xref> To make the analysis straightforward, we considered only the four largest sample batches. A plot of the interrelation of some important biological and technical variables revealed information on the study design of the TCGA colon project (<xref ref-type="fig" rid="f2-cin-12-2013-193">Fig. 2A</xref>). The &#x02018;batch&#x02019; variable overlaps with &#x02018;date-of-shipment&#x02019; and &#x02018;plate-id,&#x02019; as is the case for most TCGA projects. On the other hand, &#x02018;batch&#x02019; is largely independent from biological variables such as &#x02018;MSI status&#x02019; or &#x02018;MLH1 silencing,&#x02019; indicating that each batch contains roughly the same biological composition. The <italic>prince</italic> plot shows that batch, together with other technical variables, confounds the first and the third component (<xref ref-type="fig" rid="f2-cin-12-2013-193">Fig. 2B</xref>). The biological variables are highly associated with the second principal component and show moderate association with the fourth component. As biological and technical variables are associated to different sets of principal components, they contribute to uncorrelated variation patterns. No conclusions can be made a priori on the unexplained variance in the principal component analysis. For example, the variance in component 5 could be caused by either unknown technical or unknown biological processes. Batch effects have an immediate impact on unsupervised clustering analysis, with samples from the same batch clustering together (<xref ref-type="fig" rid="f2-cin-12-2013-193">Fig. 2C</xref>). The two main colon cancer clusters are driven significantly by batch assignment (<italic>P</italic> = 2.5 &#x000d7; 10<sup>&#x02212;6</sup>, Fisher test). We removed the first and third principal components from the dataset, as they are dominated by technical confounders and confirm the removal using a <italic>prince</italic> plot (<xref ref-type="fig" rid="f2-cin-12-2013-193">Fig. 2D</xref>). This resulted in the batch variable being equally distributed across the two main clusters (<xref ref-type="fig" rid="f2-cin-12-2013-193">Fig. 2E</xref>, <italic>P</italic> = 0.47). The TCGA publication concluded that <italic>MYC</italic> is a key regulator in colon cancer. We compared the associations of all genes on the platform to MYC expression, before and after correction (<xref ref-type="fig" rid="f2-cin-12-2013-193">Fig. 2F</xref>). Before correction, 2879 genes were correlated to MYC at fdr = 0.05 while 4757 genes were after correction. Furthermore, there were 2406 genes before correction and 3924 genes after correction correlated to micro-satellite instability, respectively. It should be emphasized that successful batch correction can also decrease associations in supervised analysis. This is the case when the technical variable and the biological variable of interest are correlated. In such cases, the initial biological effect had been inflated by the batch effect.</p></sec><sec sec-type="methods"><title>Monitoring of dataset merging</title><p>In another example, two RNAseq datasets taken from the ReCount database were assessed.<xref ref-type="bibr" rid="b23-cin-12-2013-193">23</xref> Here, two labs used independently generated B-lymphocyte cell lines from the same 29 HapMap samples. A large association of the study variable was found with the first principal component of the merged data (<xref ref-type="fig" rid="f3-cin-12-2013-193">Fig. 3A</xref>), and corrected the data by setting the median of each probe to be the same in both studies. Gender remained associated to the data after correction (<xref ref-type="fig" rid="f3-cin-12-2013-193">Fig. 3B</xref>). The gender association is weak, however, as it relies on only 3 Y-chromosome genes, expressed in males. The highest expressed gene, <italic>RPS4Y1</italic>, shows increased male-specific expression after study correction (before: <italic>P</italic> = 6 &#x000d7; 10<sup>&#x02212;9</sup>; after: <italic>P</italic> = 3 &#x000d7; 10<sup>&#x02212;15</sup>). For a single HapMap individual, RNAseq data across the two studies should be similar. Before study correction sample pairs, however, are anti-correlated. This is due to the strong effect of the study variable in combination with low biological variation, as all cell lines are derived from lymphocytic cells of healthy individuals. Mean correlation values of HapMap cell line pairs increase after study correction, from &#x02212;0.38 to 0.29 (<xref ref-type="fig" rid="f3-cin-12-2013-193">Fig. 3C</xref>).</p></sec></sec><sec sec-type="discussion"><title>Discussion</title><p>We find that large RNAseq datasets, such as those generated by the TCGA,<xref ref-type="bibr" rid="b22-cin-12-2013-193">22</xref>,<xref ref-type="bibr" rid="b24-cin-12-2013-193">24</xref>&#x02013;<xref ref-type="bibr" rid="b26-cin-12-2013-193">26</xref> can be burdened with technical variation and that this bias distorts downstream analysis. For expression microarray data, it has been shown that standard normalization pipelines may perform poorly to remove batch effects.<xref ref-type="bibr" rid="b2-cin-12-2013-193">2</xref> In the colon RNA-seq dataset from TCGA, we applied quantile-normalization to RPKM values, thereby removing unexplained variances. However, batch effects remained after quantile-normalization. Applying a vst, as suggested for RNAseq data,<xref ref-type="bibr" rid="b19-cin-12-2013-193">19</xref> did not make a notable impact on the TCGA datasets. For sequencing technologies, it may be possible that platform-tailored alignment and pre-processing algorithms can reduce batch effects, and we would argue that the <italic>prince</italic> plot is an adequate tool to monitor improvements.</p><p>The high prevalence of batch effects has important implications on study design. As it is unclear how to avoid batch effects, it may be wise to consider a study design that allows for repairing batch effects. In the worst case, biological variables and technical variables are highly correlated, eg, Phenotype A was assayed preferentially on Date A, and Phenotype B was preferentially assayed on Date B. The removal of a batch effect in such a case will be problematic as it reduces the biological variation in the data. To be able to correct for batch effects, each batch should be a good representation of the overall cohort. If there remains a risk that a strong biological variable is unknown, randomization of samples across batches may be a good strategy. A sufficiently large number of samples per batch are needed to statistically secure biological independence of batches. When the data is a compendium of small batches, batch correction is likely to shift biological variation, and hence outweighs the benefits. Unfortunately, many TCGA batches show biological selection and are small-sized, which makes it problematic to provide batch-corrected data.</p><p>To control batch effects, we propose a simple framework (<xref ref-type="fig" rid="f4-cin-12-2013-193">Fig. 4</xref>). During the experiment all possible sources of technical variation are recorded and put into relation with biological annotations. The data is then screened by a <italic>prince</italic> plot and hierarchical clustering analysis. This may lead to detection of batch effects and subsequent batch correction efforts. If the correction algorithms provided by the <italic>swamp</italic> package are not suitable for a certain dataset, we encourage the use of an alternative algorithm from the literature. The choice of batch correction algorithm is likely to be dependent on study design,<xref ref-type="bibr" rid="b12-cin-12-2013-193">12</xref> pre-processing steps, sample type, and platform. Regardless of the chosen algorithm, it is important to monitor the success of batch correction. Therefore, the outcome of data manipulation is controlled again by a <italic>prince</italic> plot/HCA. The elements of this framework are implemented in the R package <italic>swamp</italic>.</p></sec><sec sec-type="conclusions"><title>Conclusions</title><p>In summary, we find that high-throughput datasets which result in continuous measurements are potentially subject to technical biases. In such data, we argue that it is essential to monitor batch effects, eg, using the <italic>prince</italic> plot. Furthermore, we recommend a study design that keeps technical and biological variables independent, to be able to take rescue actions. To increase transparency and reproducibility of scientific findings, data submissions to public repositories should include technical variables.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Figure</title><supplementary-material content-type="loca-data" id="s1-cin-12-2013-193"><label>Figure S1</label><caption><p>Simple data processing vs. variance stabilizing transformation.</p><p><bold>Notes:</bold> The <italic>prince</italic> plots show the log<sub>10</sub><italic>P</italic>-values from univariate linear regression of the top 10 principal components with sample annotations as regressors. The <italic>P</italic>-values are color-coded from red (<italic>P</italic> &#x0003c; 10<sup>&#x02212;8</sup>) to white (<italic>P</italic> = 1). For sample annotations see <xref ref-type="fig" rid="f1-cin-12-2013-193">Figure 1</xref>.</p></caption><media mimetype="image" mime-subtype="tif" xlink:href="cin-12-2013-193s1.tif" xlink:type="simple" id="d35e530" position="anchor"/></supplementary-material></sec></body><back><fn-group><fn id="fn1-cin-12-2013-193"><p><bold>Author Contributions</bold></p><p>ML has conceived the study, scripted the R package, analyzed the data and wrote the manuscript. IV and AK have developed the GUI software. MR and GJ have assisted in data analyses. MH conceived and supervised the study and wrote the manuscript. All authors read and approved the final manuscript.</p></fn><fn id="fn2-cin-12-2013-193"><p><bold>Competing Interests</bold></p><p>Author(s) disclose no potential conflicts of interest.</p></fn><fn id="fn3-cin-12-2013-193"><p><bold>Disclosures and Ethics</bold></p><p>As a requirement of publication the authors have provided signed confirmation of their compliance with ethical and legal obligations including but not limited to compliance with ICMJE authorship and competing interests guidelines, that the article is neither under consideration for publication nor published elsewhere, of their compliance with legal and ethical guidelines concerning human and animal research participants (if applicable), and that permission has been obtained for reproduction of any copyrighted material. This article was subject to blind, independent, expert peer review. The reviewers reported no competing interests.</p></fn><fn id="fn4-cin-12-2013-193"><p><bold>Funding</bold></p><p>This work was supported by the Swedish Cancer Society, the Swedish Research Council and the Nilsson Cancer Foundation.</p></fn></fn-group><ref-list><title>References</title><ref id="b1-cin-12-2013-193"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lazar</surname><given-names>C</given-names></name><name><surname>Meganck</surname><given-names>S</given-names></name><name><surname>Taminau</surname><given-names>J</given-names></name><etal/></person-group><article-title>Batch effect removal methods for microarray gene expression data integration: a survey</article-title><source>Brief Bioinformatics</source><year>2013</year><volume>14</volume><issue>4</issue><fpage>469</fpage><lpage>90</lpage><pub-id pub-id-type="pmid">22851511</pub-id></element-citation></ref><ref id="b2-cin-12-2013-193"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leek</surname><given-names>JT</given-names></name><name><surname>Scharpf</surname><given-names>RB</given-names></name><name><surname>Bravo</surname><given-names>HC</given-names></name><etal/></person-group><article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title><source>Nat Rev Genet</source><year>2010</year><volume>11</volume><issue>10</issue><fpage>733</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">20838408</pub-id></element-citation></ref><ref id="b3-cin-12-2013-193"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teschendorff</surname><given-names>AE</given-names></name><name><surname>Menon</surname><given-names>U</given-names></name><name><surname>Gentry-Maharaj</surname><given-names>A</given-names></name><etal/></person-group><article-title>An epigenetic signature in peripheral blood predicts active ovarian cancer</article-title><source>PLoS ONE</source><year>2009</year><volume>4</volume><issue>12</issue><fpage>e8274</fpage><pub-id pub-id-type="pmid">20019873</pub-id></element-citation></ref><ref id="b4-cin-12-2013-193"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scharpf</surname><given-names>RB</given-names></name><name><surname>Ruczinski</surname><given-names>I</given-names></name><name><surname>Carvalho</surname><given-names>B</given-names></name><name><surname>Doan</surname><given-names>B</given-names></name><name><surname>Chakravarti</surname><given-names>A</given-names></name><name><surname>Irizarry</surname><given-names>RA</given-names></name></person-group><article-title>A multilevel model to address batch effects in copy number estimation using SNP arrays</article-title><source>Biostatistics</source><year>2011</year><volume>12</volume><issue>1</issue><fpage>33</fpage><lpage>50</lpage><pub-id pub-id-type="pmid">20625178</pub-id></element-citation></ref><ref id="b5-cin-12-2013-193"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taminau</surname><given-names>J</given-names></name><name><surname>Meganck</surname><given-names>S</given-names></name><name><surname>Lazar</surname><given-names>C</given-names></name><etal/></person-group><article-title>Unlocking the potential of publicly available microarray data using inSilicoDb and inSilicoMerging R/Bioconductor packages</article-title><source>BMC Bioinformatics</source><year>2012</year><volume>13</volume><fpage>335</fpage><pub-id pub-id-type="pmid">23259851</pub-id></element-citation></ref><ref id="b6-cin-12-2013-193"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Boutros</surname><given-names>PC</given-names></name></person-group><article-title>LTR: Linear Cross-Platform Integration of Microarray Data</article-title><source>Cancer Inform</source><year>2010</year><volume>9</volume><fpage>197</fpage><lpage>208</lpage><pub-id pub-id-type="pmid">20838609</pub-id></element-citation></ref><ref id="b7-cin-12-2013-193"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>WE</given-names></name><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Rabinovic</surname><given-names>A</given-names></name></person-group><article-title>Adjusting batch effects in microarray expression data using empirical Bayes methods</article-title><source>Biostatistics</source><year>2007</year><volume>8</volume><issue>1</issue><fpage>118</fpage><lpage>27</lpage><pub-id pub-id-type="pmid">16632515</pub-id></element-citation></ref><ref id="b8-cin-12-2013-193"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benito</surname><given-names>M</given-names></name><name><surname>Parker</surname><given-names>J</given-names></name><name><surname>Du</surname><given-names>Q</given-names></name><etal/></person-group><article-title>Adjustment of systematic microarray data biases</article-title><source>Bioinformatics</source><year>2004</year><volume>20</volume><issue>1</issue><fpage>105</fpage><lpage>14</lpage><pub-id pub-id-type="pmid">14693816</pub-id></element-citation></ref><ref id="b9-cin-12-2013-193"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leek</surname><given-names>JT</given-names></name><name><surname>Storey</surname><given-names>JD</given-names></name></person-group><article-title>Capturing heterogeneity in gene expression studies by surrogate variable analysis</article-title><source>PLoS Genet</source><year>2007</year><volume>3</volume><issue>9</issue><fpage>1724</fpage><lpage>35</lpage><pub-id pub-id-type="pmid">17907809</pub-id></element-citation></ref><ref id="b10-cin-12-2013-193"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shabalin</surname><given-names>AA</given-names></name><name><surname>Tjelmeland</surname><given-names>H</given-names></name><name><surname>Fan</surname><given-names>C</given-names></name><name><surname>Perou</surname><given-names>CM</given-names></name><name><surname>Nobel</surname><given-names>AB</given-names></name></person-group><article-title>Merging two gene-expression studies via cross-platform normalization</article-title><source>Bioinformatics</source><year>2008</year><volume>24</volume><issue>9</issue><fpage>1154</fpage><lpage>60</lpage><pub-id pub-id-type="pmid">18325927</pub-id></element-citation></ref><ref id="b11-cin-12-2013-193"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>C</given-names></name><name><surname>Grennan</surname><given-names>K</given-names></name><name><surname>Badner</surname><given-names>J</given-names></name><etal/></person-group><article-title>Removing batch effects in analysis of expression microarray data: an evaluation of six batch adjustment methods</article-title><source>PLoS ONE</source><year>2011</year><volume>6</volume><issue>2</issue><fpage>e17238</fpage><pub-id pub-id-type="pmid">21386892</pub-id></element-citation></ref><ref id="b12-cin-12-2013-193"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rudy</surname><given-names>J</given-names></name><name><surname>Valafar</surname><given-names>F</given-names></name></person-group><article-title>Empirical comparison of cross-platform normalization methods for gene expression data</article-title><source>BMC Bioinformatics</source><year>2011</year><volume>12</volume><fpage>467</fpage><pub-id pub-id-type="pmid">22151536</pub-id></element-citation></ref><ref id="b13-cin-12-2013-193"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alter</surname><given-names>O</given-names></name><name><surname>Brown</surname><given-names>PO</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name></person-group><article-title>Singular value decomposition for genome-wide expression data processing and modeling</article-title><source>Proc Natl Acad Sci U S A</source><year>2000</year><volume>97</volume><issue>18</issue><fpage>10101</fpage><lpage>6</lpage><pub-id pub-id-type="pmid">10963673</pub-id></element-citation></ref><ref id="b14-cin-12-2013-193"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Lu</surname><given-names>X</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><name><surname>Haaland</surname><given-names>P</given-names></name><name><surname>Marron</surname><given-names>JS</given-names></name></person-group><article-title>R/DWD: distance-weighted discrimination for classification, visualization and batch adjustment</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><issue>8</issue><fpage>1182</fpage><lpage>3</lpage><pub-id pub-id-type="pmid">22368246</pub-id></element-citation></ref><ref id="b15-cin-12-2013-193"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Scharpf</surname><given-names>R</given-names></name><name><surname>Garrett</surname><given-names>ES</given-names></name><name><surname>Hu</surname><given-names>J</given-names></name><name><surname>Parmigiani</surname><given-names>G</given-names></name></person-group><article-title>Statistical modeling and visualization of molecular profiles in cancer</article-title><source>BioTechniques</source><year>2003</year><issue>Suppl</issue><fpage>22</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">12664681</pub-id></element-citation></ref><ref id="b16-cin-12-2013-193"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leek</surname><given-names>JT</given-names></name><name><surname>Johnson</surname><given-names>WE</given-names></name><name><surname>Parker</surname><given-names>HS</given-names></name><name><surname>Jaffe</surname><given-names>AE</given-names></name><name><surname>Storey</surname><given-names>JD</given-names></name></person-group><article-title>The sva package for removing batch effects and other unwanted variation in high-throughput experiments</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><issue>6</issue><fpage>882</fpage><lpage>3</lpage><pub-id pub-id-type="pmid">22257669</pub-id></element-citation></ref><ref id="b17-cin-12-2013-193"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teschendorff</surname><given-names>AE</given-names></name><name><surname>Zhuang</surname><given-names>J</given-names></name><name><surname>Widschwendter</surname><given-names>M</given-names></name></person-group><article-title>Independent surrogate variable analysis to deconvolve confounding factors in large-scale microarray profiling studies</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><issue>11</issue><fpage>1496</fpage><lpage>505</lpage><pub-id pub-id-type="pmid">21471010</pub-id></element-citation></ref><ref id="b18-cin-12-2013-193"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chakraborty</surname><given-names>S</given-names></name><name><surname>Datta</surname><given-names>S</given-names></name><name><surname>Datta</surname><given-names>S</given-names></name></person-group><article-title>Surrogate variable analysis using partial least squares (SVA-PLS) in gene expression studies</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><issue>6</issue><fpage>799</fpage><lpage>806</lpage><pub-id pub-id-type="pmid">22238271</pub-id></element-citation></ref><ref id="b19-cin-12-2013-193"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group><article-title>Differential expression analysis for sequence count data</article-title><source>Genome Biol</source><year>2010</year><volume>11</volume><issue>10</issue><fpage>R106</fpage><pub-id pub-id-type="pmid">20979621</pub-id></element-citation></ref><ref id="b20-cin-12-2013-193"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Troyanskaya</surname><given-names>O</given-names></name><name><surname>Cantor</surname><given-names>M</given-names></name><name><surname>Sherlock</surname><given-names>G</given-names></name><etal/></person-group><article-title>Missing value estimation methods for DNA microarrays</article-title><source>Bioinformatics</source><year>2001</year><volume>17</volume><issue>6</issue><fpage>520</fpage><lpage>5</lpage><pub-id pub-id-type="pmid">11395428</pub-id></element-citation></ref><ref id="b21-cin-12-2013-193"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Visne</surname><given-names>I</given-names></name><name><surname>Dilaveroglu</surname><given-names>E</given-names></name><name><surname>Vierlinger</surname><given-names>K</given-names></name><etal/></person-group><article-title>RGG: a general GUI Framework for R scripts</article-title><source>BMC Bioinformatics</source><year>2009</year><volume>10</volume><fpage>74</fpage><pub-id pub-id-type="pmid">19254356</pub-id></element-citation></ref><ref id="b22-cin-12-2013-193"><label>22</label><element-citation publication-type="journal"><collab>Cancer Genome Atlas Research Network</collab><article-title>Comprehensive molecular characterization of human colon and rectal cancer</article-title><source>Nature</source><year>2012</year><volume>487</volume><issue>7407</issue><fpage>330</fpage><lpage>7</lpage><pub-id pub-id-type="pmid">22810696</pub-id></element-citation></ref><ref id="b23-cin-12-2013-193"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frazee</surname><given-names>AC</given-names></name><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Leek</surname><given-names>JT</given-names></name></person-group><article-title>ReCount: a multi-experiment resource of analysis-ready RNA-seq gene count datasets</article-title><source>BMC Bioinformatics</source><year>2011</year><volume>12</volume><fpage>449</fpage><pub-id pub-id-type="pmid">22087737</pub-id></element-citation></ref><ref id="b24-cin-12-2013-193"><label>24</label><element-citation publication-type="journal"><collab>Cancer Genome Atlas Research Network</collab><article-title>Comprehensive molecular portraits of human breast tumours</article-title><source>Nature</source><year>2012</year><volume>490</volume><issue>7418</issue><fpage>61</fpage><lpage>70</lpage><pub-id pub-id-type="pmid">23000897</pub-id></element-citation></ref><ref id="b25-cin-12-2013-193"><label>25</label><element-citation publication-type="journal"><collab>Cancer Genome Atlas Research Network</collab><article-title>Comprehensive genomic characterization of squamous cell lung cancers</article-title><source>Nature</source><year>2012</year><volume>489</volume><issue>7417</issue><fpage>519</fpage><lpage>25</lpage><pub-id pub-id-type="pmid">22960745</pub-id></element-citation></ref><ref id="b26-cin-12-2013-193"><label>26</label><element-citation publication-type="journal"><collab>Cancer Genome Atlas Research Network</collab><article-title>Comprehensive molecular characterization of clear cell renal cell carcinoma</article-title><source>Nature</source><year>2013</year><volume>499</volume><issue>7456</issue><fpage>43</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">23792563</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="f1-cin-12-2013-193" position="float"><label>Figure 1</label><caption><p>Technical and biological variation in cancer high-throughput data.</p><p><bold>Notes:</bold> The <italic>prince</italic> plots show the log<sub>10</sub><italic>P</italic>-values from univariate linear regression of the top 10 principal components with sample annotations as regressors. The <italic>P</italic>-values are color-coded from red (<italic>P</italic> &#x0003c; 10<sup>&#x02212;8</sup>) to white (<italic>P</italic> = 1). Sample annotations are named as in the TCGA biotab files or patient information tables of the respective TCGA portal publications.</p><p><bold>Abbreviations:</bold> TCGA, The Cancer Genome Atlas; CIS, carcinoma in situ.</p></caption><graphic xlink:href="cin-12-2013-193f1"/></fig><fig id="f2-cin-12-2013-193" position="float"><label>Figure 2</label><caption><p>Adjustment of the RNAseq data from the TCGA colorectal cancer project.</p><p><bold>Notes:</bold> The 4 largest batches of the colon cancer data are analyzed before and after data correction. (<bold>A</bold>) Confounding plot shows the association of sample annotations with <italic>P</italic>-values color-coded from purple (<italic>P</italic> &#x0003c; 10<sup>&#x02212;8</sup>) to white (<italic>P</italic> = 1). (<bold>B</bold>) <italic>Prince</italic> plot before correction. Legend as in <xref ref-type="fig" rid="f1-cin-12-2013-193">Figure 1</xref>, and percentage of variation for each principal component in brackets. (<bold>C</bold>) Hierarchical cluster analysis (HCA) using correlation as distance and ward algorithm as linkage method. MSI, microsatellite instability: green, stable microsatellites; red, MSI-low; black, MSI-high. (<bold>D</bold>) <italic>Prince</italic> plot after removal of principal components 1 and 3. (<bold>E</bold>) HCA after correction. (<bold>F</bold>) Correlation of the expression of all genes on the platform to MYC expression before (black) and after (green) correction.</p></caption><graphic xlink:href="cin-12-2013-193f2"/></fig><fig id="f3-cin-12-2013-193" position="float"><label>Figure 3</label><caption><p>Merging of two HapMap RNAseq datasets.</p><p><bold>Notes:</bold> RNAseq data of 29 HapMap cell lines from two independent studies. (<bold>A</bold>) <italic>Prince</italic> plot before study correction and (<bold>B</bold>) after correction. (<bold>C</bold>) Density plot of correlations of HapMap cell line pairs before (black) and after (red) study correction.</p></caption><graphic xlink:href="cin-12-2013-193f3"/></fig><fig id="f4-cin-12-2013-193" position="float"><label>Figure 4</label><caption><p>Framework to monitor technical variation.</p></caption><graphic xlink:href="cin-12-2013-193f4"/></fig></floats-group></article>