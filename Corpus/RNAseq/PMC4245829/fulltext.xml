<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id><journal-title-group><journal-title>BMC Bioinformatics</journal-title></journal-title-group><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4245829</article-id><article-id pub-id-type="pmid">25413493</article-id><article-id pub-id-type="publisher-id">367</article-id><article-id pub-id-type="doi">10.1186/s12859-014-0367-1</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology Article</subject></subj-group></article-categories><title-group><article-title>A fast algorithm for determining bounds and accurate approximate <italic>p</italic>-values of the rank product statistic for replicate experiments</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Heskes</surname><given-names>Tom</given-names></name><address><email>t.heskes@science.ru.nl</email></address><xref ref-type="aff" rid="Aff1"/></contrib><contrib contrib-type="author"><name><surname>Eisinga</surname><given-names>Rob</given-names></name><address><email>r.eisinga@maw.ru.nl</email></address><xref ref-type="aff" rid="Aff2"/></contrib><contrib contrib-type="author"><name><surname>Breitling</surname><given-names>Rainer</given-names></name><address><email>rainer.breitling@manchester.ac.uk</email></address><xref ref-type="aff" rid="Aff3"/></contrib><aff id="Aff1"><label/>Institute for Computing and Information Sciences, Radboud University Nijmegen, Nijmegen, The Netherlands </aff><aff id="Aff2"><label/>Department of Social Science Research Methods, Radboud University Nijmegen, Nijmegen, The Netherlands </aff><aff id="Aff3"><label/>Manchester Institute of Biotechnology, Faculty of Life Sciences, University of Manchester, Manchester, UK </aff></contrib-group><pub-date pub-type="epub"><day>21</day><month>11</month><year>2014</year></pub-date><pub-date pub-type="pmc-release"><day>21</day><month>11</month><year>2014</year></pub-date><pub-date pub-type="collection"><year>2014</year></pub-date><volume>15</volume><issue>1</issue><elocation-id>367</elocation-id><history><date date-type="received"><day>6</day><month>8</month><year>2014</year></date><date date-type="accepted"><day>29</day><month>10</month><year>2014</year></date></history><permissions><copyright-statement>&#x000a9; Heskes et al.; licensee BioMed Central Ltd. 2014</copyright-statement><license license-type="open-access"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p>The rank product method is a powerful statistical technique for identifying differentially expressed molecules in replicated experiments. A critical issue in molecule selection is accurate calculation of the <italic>p</italic>-value of the rank product statistic to adequately address multiple testing. Both exact calculation and permutation and gamma approximations have been proposed to determine molecule-level significance. These current approaches have serious drawbacks as they are either computationally burdensome or provide inaccurate estimates in the tail of the <italic>p</italic>-value distribution.</p></sec><sec><title>Results</title><p>We derive strict lower and upper bounds to the exact <italic>p</italic>-value along with an accurate approximation that can be used to assess the significance of the rank product statistic in a computationally fast manner. The bounds and the proposed approximation are shown to provide far better accuracy over existing approximate methods in determining tail probabilities, with the slightly conservative upper bound protecting against false positives. We illustrate the proposed method in the context of a recently published analysis on transcriptomic profiling performed in blood.</p></sec><sec><title>Conclusions</title><p>We provide a method to determine upper bounds and accurate approximate <italic>p</italic>-values of the rank product statistic. The proposed algorithm provides an order of magnitude increase in throughput as compared with current approaches and offers the opportunity to explore new application domains with even larger multiple testing issue. The R code is published in one of the Additional files and is available at <ext-link ext-link-type="uri" xlink:href="http://www.ru.nl/publish/pages/726696/rankprodbounds.zip">http://www.ru.nl/publish/pages/726696/rankprodbounds.zip</ext-link>.</p></sec><sec><title>Electronic supplementary material</title><p>The online version of this article (doi:10.1186/s12859-014-0367-1) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Rank product statistic</kwd><kwd><italic>p</italic>-value distribution</kwd><kwd>Transcriptomics</kwd><kwd>Proteomics</kwd><kwd>Metabolomics</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2014</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>Background</title><p>Post-genomic data analysis (transcriptomics, proteomics, metabolomics) is often concerned with the identification of differentially expressed molecules (transcripts, proteins, metabolites) under different experimental conditions (e.g., treatment vs. control) using multiple biological replicates. A simple and widely used non-parametric statistical method, initially introduced by Breitling <italic>et al</italic>. [<xref ref-type="bibr" rid="CR1">1</xref>] for gene expression microarrays, is to rank the molecules within each experiment in order of evidence for differential expression and to calculate the product of the ranks across experiments. This rank product method is based on the common biological belief that if a molecule is repeatedly at the top of the lists ordered by up- or down-regulation fold change in multiple treatment&#x02013;control experiments, the molecule is more likely to be differentially expressed.</p><p>The rank product statistic is particularly useful for the analysis of noisy datasets and a small number of replicates, as it does not rely on any distributional assumptions [<xref ref-type="bibr" rid="CR1">1</xref>&#x02013;<xref ref-type="bibr" rid="CR4">4</xref>]. Its main weakness is sensitivity to variations in molecule-specific variance, namely higher variance of weakly expressed molecules. This limitation is mitigated, in practice, by variance-stabilizing normalization [<xref ref-type="bibr" rid="CR5">5</xref>]. The rank product method is used to combine ranked lists in gene expression profiling and in various other postgenomic datasets with ranked scores, including proteomics and metabolomics [<xref ref-type="bibr" rid="CR6">6</xref>&#x02013;<xref ref-type="bibr" rid="CR8">8</xref>]. Such ranking is important because only a limited number of candidate molecules (transcripts or proteins or metabolites) can usually be followed up in a typical biological downstream analysis for confirmation or further study. Another advantage of the ranking is the resulting suppression of the unwanted influence of correlated behaviour between different molecules. In contrast to traditional marginal tests, such as the <italic>t</italic>-test, in the rank product approach correlating molecules &#x02018;compete&#x02019; for positions in the ranked list. In the extreme case of identical behaviour of all molecules, a <italic>t</italic>-test would yield the same (possibly false positive) result for all molecules, whereas in a rank product test, ties in the ranked list would be broken randomly, guaranteeing that none of them would be considered differentially expressed. As a useful side effect of this feature, the rank product test becomes increasingly conservative as larger fractions of the set of molecules studied are differentially expressed: if all molecules are changing to the same extent, their rank ordering will again be random.</p><p>Having ranked the molecules by their rank product, the next step is to obtain the <italic>p</italic>-value associated with each molecule under the null hypothesis that the molecule is not differentially expressed in any of the independent replicate experiments. The crux here is the requirement to correct for multiple testing inherent in the need to perform one test per queried molecule. Methods that use the entire distribution of <italic>p</italic>-values to estimate or control the false discovery rate (FDR) assume and perform well only when accurate <italic>p</italic>-values are available [<xref ref-type="bibr" rid="CR9">9</xref>]. It is therefore imperative to obtain the most accurate probability estimates in applications that involve a massive number of tests [<xref ref-type="bibr" rid="CR10">10</xref>], such as in the analysis of transcriptome profiling data.</p><p>For this reason, exact calculation is preferred in computing <italic>p</italic>-values for use in subsequent molecule-specific FDR-adjustment procedures. Eisinga <italic>et al</italic>. [<xref ref-type="bibr" rid="CR11">11</xref>] recently provided a derivation of the exact probability distribution of the discrete rank product statistic and its true tail probabilities. An obstacle of exact calculation is that, whereas the <italic>p</italic>-values of small rank products can be calculated swiftly, computing the probabilities of large rank products may consume considerable amounts of time. Although the speed of execution will depend on computing power, exact <italic>p</italic>-value calculation becomes time prohibitive in multiple experiments for rank product values exceeding 10<sup>7</sup>. Unfortunately, in a typical large postgenomic molecular profiling study, such rank products may occur for the bulk of the molecules analysed.</p><p>If exact calculation is infeasible, re-sampling-based inference methods such as permutation testing may be considered. The permutation re-sampling procedure involves a trade-off between accuracy and number of permutations [<xref ref-type="bibr" rid="CR12">12</xref>]. That is, the number of permutations needed is always larger than the inverse of the <italic>p</italic>-value, but a factor of the order of 100 or so more permutations is required so that the <italic>p</italic>-values can be accurately estimated to several decimal places for performing multiple-testing adjustment. In practice, the number of permutation samples may perhaps go up to 10<sup>13</sup>, but re-sampling then starts to become unrealistically expensive, meaning that it is hard to accurately estimate <italic>p</italic>-values smaller than 10<sup>&#x02212;11</sup>. Such <italic>p</italic>-values are common in rank product analysis of the expression values of many molecules in multiple batches.</p><p>As an alternative procedure, Koziol [<xref ref-type="bibr" rid="CR13">13</xref>] suggested to use the continuous gamma distribution to approximate the sampling distribution of the discrete rank product statistic. For large rank products the gamma calculation performs well, and for extremely large values the gamma <italic>p</italic>-values are close to exact. However, Eisinga <italic>et al</italic>. [<xref ref-type="bibr" rid="CR11">11</xref>] have shown that for smaller rank product values, i.e., the ones biologists are most interested in, the gamma approximation has a serious bias, overestimating <italic>p</italic>-values by several orders of magnitude, and that the error increases as the <italic>p</italic>-values become smaller.</p><p>There is therefore a range of intermediate rank product values in postgenomic studies where current approaches, exact calculation and stochastic and deterministic approximations, all have serious drawbacks in terms of computation time, accuracy or both. The goal of this paper is to obtain guaranteed lower and, in particular, upper bounds for the <italic>p</italic>-values of any rank product value observed, with the conservative upper bound protecting against false positives. The strict bounds may also be exploited to quickly calculate accurate approximate <italic>p</italic>-values for rank product analysis of a variety of postgenomic molecular profiling data.</p></sec><sec id="Sec2" sec-type="materials|methods"><title>Methods</title><p>The rank product approach was originally derived for paired experiments (two-colour microarrays). However it can be applied for unpaired data, which are common in postgenomic molecular profiling, by creating random pairs of experiments and calculating the average rank product for several random pairings. Without loss of generality, we thus consider <italic>n</italic> molecules profiled in <italic>k</italic> paired experiments. In each experiment <italic>i</italic>, a molecule receives a random ranking <italic>r</italic><sub><italic>i</italic>,</sub> i.e., any number between 1 and <italic>n.</italic> We define <italic>G</italic><sub><italic>k</italic></sub>(<italic>&#x003c1;)</italic>/<italic>n</italic><sup><italic>k</italic></sup> as the probability that the product of these random rankings is smaller than rank product <italic>&#x003c1;</italic>:<disp-formula id="Equa"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {G}_k\left(\rho \right)={\displaystyle \sum_{r_{\;1}=1}^n{\displaystyle \sum_{r_{\;2}=1}^n\dots {\displaystyle \sum_{r_{\;k}=1}^n\varTheta \left(\rho -{r}_1\times {r}_2\times \dots \times {r}_k\right),}}} $$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mspace width="0.12em"/><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mspace width="0.12em"/><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo>&#x02026;</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mspace width="0.12em"/><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mi>&#x00398;</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:math><graphic xlink:href="12859_2014_367_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>with the Heaviside step function &#x00398;(<italic>x</italic>)&#x02009;=&#x02009;1 iff <italic>x</italic>&#x02009;&#x02265;&#x02009;0 and 0 otherwise. We obviously have <italic>G</italic><sub><italic>k</italic></sub>(<italic>&#x003c1;</italic>)&#x02009;=&#x02009;0 for any <italic>&#x003c1;</italic>&#x02009;&#x0003c;&#x02009;1 and <italic>G</italic><sub><italic>k</italic></sub>(<italic>&#x003c1;</italic>)&#x02009;=&#x02009;<italic>n</italic><sup><italic>k</italic></sup> for <italic>&#x003c1;&#x02009;&#x02265;&#x02009;n</italic><sup><italic>k</italic></sup>. Our starting point is the observation that the distribution of <italic>&#x003c1;</italic> for <italic>k</italic> experiments relates to that for <italic>k&#x02009;&#x02212;</italic>&#x02009;1 experiments. Since any rank product <italic>&#x003c1;</italic> based on <italic>k</italic> experiments can be written as the product of a rank <italic>r</italic><sub>1</sub> in the first experiment times a rank product <italic>&#x003c1;</italic>' based on <italic>k&#x02009;&#x02212;</italic>&#x02009;1 experiments, we have:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {G}_k\left(\rho \right)={\displaystyle \sum_{r_{\;1}=1}^n{G}_{k-1}\left(\rho /{r}_1\right)}={G}_{k-1}\left(\rho \right)+{\displaystyle \sum_{r_{\;1}=2}^{\min \left(\rho, n\right)}{G}_{k-1}\left(\rho /{r}_1\right).} $$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mspace width="0.12em"/><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mspace width="0.12em"/><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>min</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mtext>.</mml:mtext></mml:mrow></mml:mstyle></mml:math><graphic xlink:href="12859_2014_367_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p><p>Here the upper limit min(<italic>&#x003c1;</italic>,<italic>n</italic>) explicitly incorporates that <italic>&#x003c1;</italic>' can never be smaller than 1, so <italic>r</italic><sub>1</sub> can never be larger than <italic>&#x003c1;</italic>. In theory, we could use this recursion to compute <italic>G</italic><sub><italic>k</italic></sub>(<italic>&#x003c1;</italic>). In practice, this is unfeasible for large <italic>&#x003c1;, n</italic>, and/or <italic>k</italic>. The discrete nature of this recursion makes it difficult, if not impossible, to obtain a generic analytical solution. However, as we will show below, it is possible to bound and approximate this sum through integrals that can be evaluated analytically.</p><p>Our line of reasoning is as follows. Since <italic>G</italic><sub><italic>k</italic></sub>(<italic>&#x003c1;</italic>) is a cumulative function, it is monotonically increasing in <italic>&#x003c1;</italic>. Sums over monotonically increasing or decreasing functions can be bounded by integrals. In doing so, we turn the discrete recursion (<xref rid="Equ1" ref-type="">1</xref>) involving a summation into continuous recursions involving integrals, one for a lower bound and another one for an upper bound. Recursions involving integrals are typically easier to solve than recursions involving summations. The upper limit min(<italic>&#x003c1;</italic>,<italic>n</italic>) in the discrete recursion (<xref rid="Equ1" ref-type="">1</xref>) translates to the same upper limit in the continuous recursion, basically implementing the fact that a rank product <italic>&#x003c1;</italic>' based on <italic>k&#x02009;&#x02212;</italic>&#x02009;1 experiments cannot contribute to a rank product <italic>&#x003c1;</italic> based on <italic>k</italic> experiments if <italic>&#x003c1;</italic>'&#x02009;&#x0003e;&#x02009;<italic>&#x003c1;</italic>. This upper limit is a highly nonlinear function of <italic>&#x003c1;</italic>, which then also does not allow for an easy solution of the continuous recursion. By consistently separating the cases <italic>&#x003c1;&#x02009;&#x02265;&#x02009;n</italic> and <italic>&#x003c1;</italic>'&#x02009;<italic>&#x02265;&#x02009;n</italic> from <italic>&#x003c1;</italic>&#x02009;&#x0003c;&#x02009;<italic>n</italic> and <italic>&#x003c1;</italic>'&#x02009;<italic>&#x0003c;&#x02009;n</italic>, we will see that the solution of the continuous recursions can be written as a piecewise function, with recursions for the separate pieces still in terms of integrals, but now with limits that are linear rather than nonlinear functions of the rank product <italic>&#x003c1;.</italic></p><p>Perhaps surprisingly, these recursions for the separate pieces, each corresponding to a different interval for the rank product <italic>&#x003c1;</italic>, can be solved analytically. That is, these solutions can be written in terms of basic functions, the parameters of which follow a simple recursion that can be implemented in a fast algorithm. So, in the end, we have managed to turn the complicated recursion (<xref rid="Equ1" ref-type="">1</xref>) on a function <italic>G</italic><sub><italic>k</italic></sub>(<italic>&#x003c1;</italic>) into a simple recursion on parameters that specify piecewise continuous upper and lower bounds on <italic>G</italic><sub><italic>k</italic></sub>(<italic>&#x003c1;</italic>). The following sections describe the steps in mathematical detail.</p><sec id="Sec3"><title>Integral and piecewise recursion</title><p>Since any combination of ranks that contributes to <italic>G</italic><sub><italic>k</italic></sub>(<italic>&#x003c1;</italic>) also contributes to <italic>G</italic><sub><italic>k</italic></sub>(<italic>&#x003c1;</italic>') if <italic>&#x003c1;</italic>'&#x02009;&#x02265;&#x02009;<italic>&#x003c1;</italic>, we easily see that <italic>G</italic><sub><italic>k</italic></sub>(<italic>&#x003c1;</italic>) is monotonically (not necessarily strictly) increasing in <italic>&#x003c1;</italic> for any <italic>k</italic>. But then <italic>G</italic><sub><italic>k</italic>&#x02212;1</sub>(<italic>&#x003c1;</italic>/<italic>r</italic><sub>1</sub>) is monotonically decreasing in <italic>r</italic><sub>1</sub>. Summations over monotonically decreasing functions can be bounded by integrals (and vice versa). As the following theorem indicates, this can be used to derive upper and lower bounds that obey recursion equations involving integrals instead of summations.</p><p><sc>Theorem</sc> 1. <italic>Consider the two functions</italic><inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{G}}_k\left(\rho \right) $$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq1.gif"/></alternatives></inline-formula><italic>and</italic><inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\underset{\bar{\mkern6mu}}{G}}_k\left(\rho \right) $$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:munder accentunder="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:munder><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq2.gif"/></alternatives></inline-formula><italic>that satisfy the recursions</italic><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{G}}_k\left(\rho \right)={\overline{G}}_{k-1}\left(\rho \right)+{\displaystyle {\int}_1^{\min \left(\rho, n\right)}\;{\overline{G}}_{k-1}\left(\rho /r\right)}\;dr $$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo stretchy="true">&#x0222b;</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>min</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mrow><mml:mspace width="0.12em"/><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mstyle><mml:mspace width="0.12em"/><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:math><graphic xlink:href="12859_2014_367_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><italic>and</italic><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\underset{\bar{\mkern6mu}}{G}}_k\left(\rho \right)={\underset{\bar{\mkern6mu}}{G}}_{k-1}\left( \max \left(1,\rho /n\right)\right)+{\displaystyle {\int}_1^{\min \left(\rho, n\right)}{\underset{\bar{\mkern6mu}}{G}}_{k-1}\left(\rho /r\right)}\;dr, $$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:munder accentunder="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:munder><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:munder accentunder="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:munder><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mo>max</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo stretchy="true">&#x0222b;</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>min</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:munder accentunder="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:munder><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mstyle><mml:mspace width="0.12em"/><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.12em"/><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12859_2014_367_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><italic>and are both initialized at</italic><inline-formula id="IEq3"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{G}}_0\left(\rho \right)={\underset{\bar{\mkern6mu}}{G}}_0\left(\rho \right)={G}_0\left(\rho \right)=\varTheta \left(\rho -1\right). $$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:munder accentunder="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:munder><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mtext>.</mml:mtext></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq3.gif"/></alternatives></inline-formula><italic>For any k</italic>&#x02009;&#x02265;&#x02009;0 <italic>and &#x003c1;</italic>&#x02009;&#x02264;&#x02009;<italic>n</italic><sup><italic>k</italic></sup><italic>we have</italic><disp-formula id="Equb"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\underset{\bar{\mkern6mu}}{G}}_k\left(\rho \right)\le {G}_k\left(\rho \right)\le {\overline{G}}_k\left(\rho \right). $$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:munder accentunder="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:munder><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mtext>.</mml:mtext></mml:math><graphic xlink:href="12859_2014_367_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p><p><italic>That is,</italic><inline-formula id="IEq4"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\overline{G}}_k\left(\rho \right) $$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq4.gif"/></alternatives></inline-formula><italic>gives an upper bound on G</italic><sub><italic>k</italic></sub>(<italic>&#x003c1;</italic>) <italic>and</italic><inline-formula id="IEq5"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\underset{\bar{\mkern6mu}}{G}}_k\left(\rho \right) $$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:munder accentunder="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:munder><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq5.gif"/></alternatives></inline-formula><italic>a lower bound.</italic> The proof is detailed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p><p>For ease of exposition, we introduce the constant &#x02206; and consider the recursion<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_k\left(\rho \right)=\varDelta {\tilde{G}}_{k-1}\left(\rho \right)+\left(1-\varDelta \right){\tilde{G}}_{k-1}\left( \max \left(1,\rho /n\right)\right)+{\displaystyle {\int}_1^{\min \left(\rho, n\right)}\;{\tilde{G}}_{k-1}\left(\rho /r\right)}\;dr. $$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x00394;</mml:mi></mml:mrow></mml:mfenced><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mo>max</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo stretchy="true">&#x0222b;</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>min</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mrow><mml:mspace width="0.12em"/><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mstyle><mml:mspace width="0.12em"/><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mtext>.</mml:mtext></mml:math><graphic xlink:href="12859_2014_367_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p><p>Setting &#x02206; to either 0 or 1, we obtain the recursion for the lower and upper bound, respectively. We will argue and empirically show that an accurate approximation (but no guaranteed bound) can be obtained by taking the geometric mean of the upper and lower bound.</p><p>The recursion starts from <inline-formula id="IEq6"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_0\left(\rho \right)=\varTheta \left(\rho -1\right). $$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>&#x00398;</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mtext>.</mml:mtext></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq6.gif"/></alternatives></inline-formula> The constraint that <inline-formula id="IEq7"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_k\left(\rho \right)={G}_k\left(\rho \right)=0 $$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq7.gif"/></alternatives></inline-formula> for <italic>&#x003c1;</italic>&#x02009;&#x0003c;&#x02009;1, and the consequence that the upper limit of the integral is a nonlinear function of <italic>&#x003c1;</italic>, seriously complicates the solution of the recursion (<xref rid="Equ4" ref-type="">4</xref>). However, we will see that if we write <inline-formula id="IEq8"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_k\left(\rho \right) $$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq8.gif"/></alternatives></inline-formula> as a piecewise function,<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_k\left(\rho \right)=\left\{\begin{array}{c}\hfill {\tilde{G}}_{k0}\left(\rho \right)={n}^k\;\hfill \\ {}\hfill {\tilde{G}}_{kj}\left(\rho \right)\kern1.44em \hfill \\ {}\hfill\;{\tilde{G}}_{k,k+1}\left(\rho \right)=0\hfill \end{array}\right.\kern0.6em \begin{array}{c}\hfill \mathrm{if}\;\rho\ \ge\ {n}^k\kern5.04em \hfill \\ {}\hfill \kern0.35em \mathrm{if}\;{n}^{k-j}\le \rho &#x0003c;{n}^{k-j+1};\kern0.1em j=1\dots k\hfill \\ {}\hfill \mathrm{if}\ \rho &#x0003c;1,\kern5.4em \hfill \end{array} $$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="" open="{"><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mspace width="0.12em"/></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mspace width="1.44em"/></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mspace width="0.12em"/><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mspace width="0.6em"/><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.12em"/><mml:mi>&#x003c1;</mml:mi><mml:mspace width="0.25em"/><mml:mo>&#x02265;</mml:mo><mml:mspace width="0.25em"/><mml:msup><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mspace width="5.04em"/></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mspace width="0.35em"/><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.12em"/><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mspace width="0.2em"/><mml:mo>&#x02264;</mml:mo><mml:mspace width="0.2em"/><mml:mi>&#x003c1;</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>;</mml:mo><mml:mspace width="0.1em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02026;</mml:mo><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.25em"/><mml:mi>&#x003c1;</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="5.4em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2014_367_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>the recursion equation for the pieces <inline-formula id="IEq9"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{kj}\left(\rho \right) $$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq9.gif"/></alternatives></inline-formula> simplifies considerably and can in fact be solved.</p><p><sc>Theorem</sc> 2. <italic>With</italic><inline-formula id="IEq10"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_k\left(\rho \right) $$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq10.gif"/></alternatives></inline-formula><italic>a piecewise function of the form (</italic><xref rid="Equ5" ref-type="">5</xref><italic>), the pieces</italic><inline-formula id="IEq11"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{kj}\left(\rho \right) $$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq11.gif"/></alternatives></inline-formula><italic>satisfy, for</italic> 1&#x02009;&#x02264;&#x02009;<italic>j</italic>&#x02009;&#x02264;&#x02009;<italic>k</italic> &#x02212;&#x02009;1, <italic>the recursion</italic><disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{kj}\left(\rho \right)=\varDelta {\tilde{G}}_{k-1,j-1}\left(\rho \right)+\left(1-\varDelta \right){\tilde{G}}_{k-1,j}\left(\rho /n\right)+{\displaystyle {\int}_1^{\rho /{n}^{k-j}}dr\;{\tilde{G}}_{k-1,j-1}\left(\rho /r\right)}+{\displaystyle {\int}_{\rho /{n}^{k-j}}^n\;{\tilde{G}}_{k-1,j}\left(\rho /r\right)\;dr,} $$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x00394;</mml:mi></mml:mrow></mml:mfenced><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mtext/><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo stretchy="true">&#x0222b;</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mspace width="0.12em"/><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo stretchy="true">&#x0222b;</mml:mo><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mspace width="0.12em"/><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced><mml:mspace width="0.12em"/><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mtext>,</mml:mtext></mml:mrow></mml:mstyle></mml:math><graphic xlink:href="12859_2014_367_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><italic>and, for j</italic>&#x02009;=&#x02009;<italic>k</italic>,<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{kk}\left(\rho \right)=\varDelta {\tilde{G}}_{k-1,k-1}\left(\rho \right)+1-\varDelta +{\displaystyle {\int}_1^{\rho}\;{\tilde{G}}_{k-1,k-1}\left(\rho /r\right)}\;dr. $$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x00394;</mml:mi><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo stretchy="true">&#x0222b;</mml:mo><mml:mn>1</mml:mn><mml:mi>&#x003c1;</mml:mi></mml:msubsup><mml:mrow><mml:mspace width="0.12em"/><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mstyle><mml:mspace width="0.12em"/><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mtext>.</mml:mtext></mml:math><graphic xlink:href="12859_2014_367_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p><p>The proof is given in Additional file <xref rid="MOESM2" ref-type="media">2</xref>. The intuition behind the piecewise construction follows if one tries to construct the recursion for <italic>k</italic> =1,2,3, and so on. For <italic>k</italic> =1, <italic>&#x003c1;</italic> is always smaller than <italic>n</italic>, so max(1, <italic>&#x003c1;</italic>/<italic>n</italic>) =1 and min(<italic>&#x003c1;</italic>, <italic>n</italic>)&#x02009;=&#x02009;<italic>&#x003c1;</italic>. For <italic>k</italic> =2, we can separate the cases <italic>&#x003c1;</italic>&#x02009;&#x02265;&#x02009;<italic>n</italic> and <italic>&#x003c1;&#x02009;&#x0003c;&#x02009;n</italic>, corresponding to the pieces <inline-formula id="IEq12"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{21} $$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mn>21</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{21} $$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mn>21</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq13.gif"/></alternatives></inline-formula>, respectively. For <italic>k</italic> =3, we again separate the cases <italic>&#x003c1;</italic>&#x02009;&#x02265;&#x02009;<italic>n</italic> and <italic>&#x003c1;</italic>&#x02009;&#x0003c;&#x02009;<italic>n</italic>, but now we also have to check whether <italic>&#x003c1;</italic>/<italic>r</italic> in the integrand <inline-formula id="IEq14"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_2\left(\rho /r\right) $$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="true">/</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq14.gif"/></alternatives></inline-formula> is larger than <italic>n</italic> (i.e., refers to <inline-formula id="IEq15"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{22}\Big) $$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mn>22</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq15.gif"/></alternatives></inline-formula> or smaller than <italic>n</italic> (i.e., refers to <inline-formula id="IEq16"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{21}\Big). $$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mn>21</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mtext>.</mml:mtext></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq16.gif"/></alternatives></inline-formula> Working this out, one realizes that three different pieces are needed for <inline-formula id="IEq17"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_3. $$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:mtext>.</mml:mtext></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq17.gif"/></alternatives></inline-formula> Induction on <italic>k</italic> leads to the piecewise function (<xref rid="Equ5" ref-type="">5</xref>) and the recursions (<xref rid="Equ6" ref-type="">6</xref>) and (<xref rid="Equ7" ref-type="">7</xref>). These recursions now involve integrals, instead of summations, with limits that are either constants or linear in <italic>&#x003c1;</italic>, instead of a nonlinear function of <italic>&#x003c1;.</italic></p></sec><sec id="Sec4"><title>Lattice</title><p>Figure&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> sketches the dependencies between different combinations of <italic>k</italic> and <italic>j,</italic> where <italic>j</italic> is the index of the interval [<italic>n</italic><sup><italic>k</italic>&#x02212;<italic>j</italic></sup>,<italic>n</italic><sup><italic>k</italic>&#x02212;<italic>j</italic>+1</sup>] that contains the rank product <italic>&#x003c1;</italic>, i.e., <italic>j</italic>&#x02009;=&#x02009;ceiling(<italic>k</italic>&#x02009;&#x02212;&#x02009;log <italic>&#x003c1;</italic>/log <italic>n</italic>).<fig id="Fig1"><label>Figure 1</label><caption><p>
<bold>Visualization of recursion.</bold> Visualization of recursion with <italic>k</italic>, the numbers of experiments, on the <italic>y</italic>-axis, and <italic>j</italic>, the index of the interval that contains the rank product <italic>&#x003c1;</italic>, on the <italic>x</italic>-axis. Nodes correspond to combinations of <italic>k</italic> and <italic>j</italic>. The squares are given: <inline-formula id="IEq18"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{k0}\left(\rho \right)={n}^k, $$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:mtext>,</mml:mtext></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq18.gif"/></alternatives></inline-formula> with <italic>n</italic> the number of molecules. The arrows show the dependencies between the nodes. For example, to compute <inline-formula id="IEq19"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{4,2}\left(\rho \right), $$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mtext>,</mml:mtext></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq19.gif"/></alternatives></inline-formula> we first need to compute <inline-formula id="IEq20"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{3,1}\left(\rho \right) $$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq20.gif"/></alternatives></inline-formula> and <inline-formula id="IEq21"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{3,2}\left(\rho \right) $$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq21.gif"/></alternatives></inline-formula>. The red path visualizes the calculations required to obtain <inline-formula id="IEq22"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{5,3}\left(\rho \right). $$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mtext>.</mml:mtext></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq22.gif"/></alternatives></inline-formula>
</p></caption><graphic xlink:href="12859_2014_367_Fig1_HTML" id="MO1"/></fig></p><p>An actual implementation to compute <inline-formula id="IEq23"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{kj}\left(\rho \right) $$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq23.gif"/></alternatives></inline-formula> can be recursive, e.g., starting at node (<italic>k</italic>,<italic>j</italic>) and recursively computing the parameters that are needed. The alternative is to pre-calculate which parameters are needed and then go through these in two for-loops. To compute <inline-formula id="IEq24"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{kj}\left(\rho \right), $$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mtext>,</mml:mtext></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq24.gif"/></alternatives></inline-formula> one possibility is then to have an outer loop with <italic>j</italic>' running from 0 to <italic>j</italic> (from left to right on the lattice in Figure&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>), with an inner loop with <italic>k</italic>' running from <italic>j</italic>' to max(<italic>k</italic>, <italic>k</italic>&#x02009;&#x02212;&#x02009;<italic>j</italic>&#x02009;+&#x02009;<italic>j</italic>') (from top to bottom). The other option is to have an outer loop with <italic>k</italic>' running from 0 to <italic>k</italic> (from top to bottom) and <italic>j</italic>' from max(<italic>k</italic>'&#x02009;&#x02212;&#x02009;<italic>k</italic>&#x02009;+&#x02009;<italic>j</italic>, 0) to min(<italic>k</italic>', <italic>j</italic>) (from left to right).</p></sec><sec id="Sec5"><title>Functional form</title><p>The recursions (<xref rid="Equ6" ref-type="">6</xref>) and (<xref rid="Equ7" ref-type="">7</xref>), together with the initialization <inline-formula id="IEq25"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{k\hbox{'}0}\left(\rho \right)={n}^{k\hbox{'}}, $$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>'</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mtext>,</mml:mtext></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq25.gif"/></alternatives></inline-formula> fully determine <inline-formula id="IEq26"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{kj}\left(\rho \right) $$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq26.gif"/></alternatives></inline-formula> for any <italic>&#x003c1;</italic> (and corresponding <italic>j</italic>) and <italic>k</italic>. We could replace analytical integration by numerical integration. However, trying a few steps, one soon realizes that the integrations that are required in each of the steps can be done analytically and a pattern starts to emerge. It appears that every solution can be written in the form<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{kj}\left(\rho \right)={\varepsilon}_{kj}+{\delta}_{kj}\rho +{\boldsymbol{\gamma}}_{kj}^T\varPsi \left(\rho; {\boldsymbol{\alpha}}_{kj},{n}^{k-j+{\boldsymbol{\beta}}_{k\ j}}\right), $$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mi>&#x003a8;</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mspace width="0.25em"/><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12859_2014_367_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>with<disp-formula id="Equc"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \varPsi \left(\rho; \alpha, \lambda \right)\equiv \rho {\left( \log \left[\frac{\rho }{\lambda}\right]\right)}^{\alpha }, $$\end{document}</tex-math><mml:math id="M74"><mml:mi>&#x003a8;</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>;</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x02261;</mml:mo><mml:mi>&#x003c1;</mml:mi><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mo>log</mml:mo><mml:mfenced close="]" open="["><mml:mfrac><mml:mi>&#x003c1;</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced><mml:mi>&#x003b1;</mml:mi></mml:msup><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12859_2014_367_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>and appropriate choices for the parameters <bold><italic>&#x003b1;</italic></bold>, <bold><italic>&#x003b2;</italic></bold>, <bold><italic>&#x003b3;</italic></bold>, <italic>&#x003b4;</italic>, and <italic>&#x003b5;</italic>. Here <bold><italic>&#x003b1;</italic></bold><sub><italic>kj</italic></sub>, <bold><italic>&#x003b2;</italic></bold><sub><italic>kj</italic></sub>, and <bold><italic>&#x003b3;</italic></bold><sub><italic>kj</italic></sub> are vectors of equal length. We used vector notation such as<disp-formula id="Equd"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\gamma}^T\varPsi \left(\rho; \boldsymbol{\alpha}, {n}^{k-j+{\beta}_{kj}}\right)={\displaystyle \sum_m{\gamma}_m\varPsi \left(\rho; {\alpha}_m,{n}^{k-j+{\beta}_m}\right),} $$\end{document}</tex-math><mml:math id="M76"><mml:msup><mml:mi>&#x003b3;</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>&#x003a8;</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mi>m</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mi>&#x003a8;</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:mrow></mml:mstyle></mml:math><graphic xlink:href="12859_2014_367_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where the sum runs over all elements of the vectors.</p><p><sc>Theorem</sc> 3. <italic>The solutions of the recursions (</italic><xref rid="Equ6" ref-type="">6</xref>)<italic> and (</italic><xref rid="Equ7" ref-type="">7</xref><italic>), starting from the initialization</italic><inline-formula id="IEq27"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{k\hbox{'}0}={n}^{k\hbox{'}}, $$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>'</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mtext>,</mml:mtext></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq27.gif"/></alternatives></inline-formula><italic>can be written in the form (</italic><xref rid="Equ8" ref-type="">8</xref><italic>).</italic> See Additional file <xref rid="MOESM3" ref-type="media">3</xref> for the proof.</p></sec><sec id="Sec6"><title>Updates and implementation</title><p>Now that we have confirmed that the solution is indeed of the form (<xref rid="Equ8" ref-type="">8</xref>), what remains is to find the proper updates of the parameters <italic>&#x003b8;</italic>&#x02009;&#x02261;&#x02009;{<bold><italic>&#x003b1;</italic></bold>, <bold><italic>&#x003b2;</italic></bold>, <bold><italic>&#x003b3;</italic></bold>, <italic>&#x003b4;</italic>, <italic>&#x003b5;</italic>}. These are given in the following theorem, the proof of which is given in Additional file <xref rid="MOESM4" ref-type="media">4</xref>.</p><p><sc>Theorem</sc> 4. <italic>The parameters &#x003b8;</italic>&#x02009;&#x02261;&#x02009;{<bold><italic>&#x003b1;</italic></bold>, <bold><italic>&#x003b2;</italic></bold>, <bold><italic>&#x003b3;</italic></bold>, <italic>&#x003b4;</italic>, <italic>&#x003b5;</italic>} <italic>of the solution</italic><inline-formula id="IEq28"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{kj}\left(\rho \right) $$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq28.gif"/></alternatives></inline-formula><italic>obey the update equations, for</italic> 1&#x02009;&#x02264;&#x02009;<italic>j</italic>&#x02009;&#x02264;&#x02009;<italic>k</italic>&#x02009;&#x02212;&#x02009;1,<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l}{\boldsymbol{\alpha}}_{kj}=\left[1,1,{\boldsymbol{\alpha}}_{k-1,j-1},{\boldsymbol{\alpha}}_{k-1,j},{\boldsymbol{\alpha}}_{k-1,j-1}+1,{\boldsymbol{\alpha}}_{k-1,j}+1\right]\\ {}{\boldsymbol{\beta}}_{kj}=\left[0,1,{\boldsymbol{\beta}}_{k-1,j-1},{\boldsymbol{\beta}}_{k-1,j},{\boldsymbol{\beta}}_{k-1,j-1},{\boldsymbol{\beta}}_{k-1,j}\right]\\ {}{\boldsymbol{\gamma}}_{kj}=\left[{\delta}_{k-1,j-1},-{\delta}_{k-1,j},\varDelta {\boldsymbol{\gamma}}_{k-1,j-1},{\scriptscriptstyle \frac{1-\varDelta }{n}}{\boldsymbol{\gamma}}_{k-1,j},{\boldsymbol{\phi}}_{k-1,j-1},-{\boldsymbol{\phi}}_{k-1,j}\right]\\ {}{\delta}_{kj}=\varDelta {\delta}_{k-1,j-1}+{\scriptscriptstyle \frac{1-\varDelta }{n}}{\delta}_{k-1,j}+{\scriptscriptstyle \frac{1}{n^{k-j}}}\left({\varepsilon}_{k-1,j-1}-{\varepsilon}_{k-1,j}\right)\\ {}\kern1.69em -{\boldsymbol{\phi}}_{k-1,j-1}^T{\left(-{\boldsymbol{\beta}}_{k-1,j-1} \log (n)\right)}^{\circ {\boldsymbol{\alpha}}_{k-1,j-1}+1}+{\boldsymbol{\phi}}_{k-1,j}^T{\left(\left(1-{\boldsymbol{\beta}}_{k-1,j}\right) \log (n)\right)}^{\circ {\boldsymbol{\alpha}}_{k-1,j}+1}\\ {}{\varepsilon}_{k\ j}=\left(1-\varDelta \right)\left({\varepsilon}_{k-1,j}-{\varepsilon}_{k-1,j-1}\right)+n{\varepsilon}_{k-1,j},\;\end{array} $$\end{document}</tex-math><mml:math id="M82"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x00394;</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mstyle><mml:msub><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x00394;</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mstyle><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mfrac></mml:mstyle><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1.69em"/><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mi>n</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mrow><mml:mo>&#x02218;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mi>n</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mrow><mml:mo>&#x02218;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mspace width="0.25em"/><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x00394;</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.12em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2014_367_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><italic>with shorthand</italic><disp-formula id="Eque"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{\phi}}_{k\hbox{'},j\hbox{'}}\equiv {\boldsymbol{\gamma}}_{k\hbox{'},j\hbox{'}}\circ /\left({\boldsymbol{\alpha}}_{k\hbox{'},j\hbox{'}}+1\right), $$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>'</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:msub><mml:mo>&#x02261;</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>'</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:msub><mml:mo>&#x02218;</mml:mo><mml:mo stretchy="true">/</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>'</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12859_2014_367_Article_Eque.gif" position="anchor"/></alternatives></disp-formula><italic>and, for j</italic>&#x02009;=&#x02009;<italic>k</italic>,<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l}{\boldsymbol{\alpha}}_{kk}=\left[1,{\boldsymbol{\alpha}}_{k-1,k-1},{\boldsymbol{\alpha}}_{k-1,k-1}+1\right]\\ {}{\boldsymbol{\beta}}_{kk}=\left[0,{\boldsymbol{\beta}}_{k-1,k-1},{\boldsymbol{\beta}}_{k-1,k-1}\right]\\ {}{\boldsymbol{\gamma}}_{kk} = \left[{\delta}_{k-1,k-1},\varDelta {\boldsymbol{\gamma}}_{k-1,k-1},{\boldsymbol{\phi}}_{k-1,k-1}\right]\\ {}{\delta}_{kk}=\varDelta {\delta}_{k-1,k-1}+{\varepsilon}_{k-1,k-1}\\ {}{\varepsilon}_{kk}=\left(1-\varDelta \right)\left(1-{\varepsilon}_{k-1,k-1}\right).\;\end{array} $$\end{document}</tex-math><mml:math id="M86"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x00394;</mml:mi></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>.</mml:mo><mml:mspace width="0.12em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2014_367_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p><p>In the above expressions, division (<italic>&#x003b3;</italic> divided by <bold><italic>&#x003b1;</italic></bold>+1) and exponentiation (<bold><italic>&#x003b2;</italic></bold> to the power <bold><italic>&#x003b1;</italic></bold>+1) are to be interpreted element-wise (hence the &#x0201c;&#x02218;&#x0201d;) and [1, 1, <bold><italic>&#x003b1;</italic></bold><sub><italic>k</italic>&#x02212;1,<italic>j</italic>&#x02212;1</sub>, &#x02026;] stands for the concatenation of elements and vectors into a new (longer) vector. The update equations can be initialized by setting<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\varepsilon}_{k\hbox{'}0}={n}^{k\hbox{'}},\kern0.37em {\delta}_{k\hbox{'}0}=0,\kern0.24em \mathrm{and}\kern0.5em {\boldsymbol{\alpha}}_{k\hbox{'},0}={\boldsymbol{\beta}}_{k\hbox{'},0}={\boldsymbol{\gamma}}_{k\hbox{'},0}=\mathbf{0}, $$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>'</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.37em"/><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>'</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.24em"/><mml:mtext/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="0.5em"/><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>'</mml:mo><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>'</mml:mo><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>'</mml:mo><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12859_2014_367_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>for all 0&#x02009;&#x02264;&#x02009;<italic>k</italic>'&#x02009;&#x02264;&#x02009;<italic>k</italic>.</p><p>From the updates it can be seen that each <italic>&#x003b1;</italic><sub><italic>k</italic>,<italic>j</italic>,<italic>m</italic></sub> &#x02208; {1, &#x02026;, <italic>k</italic>} and each <italic>&#x003b2;</italic><sub><italic>k</italic>,<italic>j</italic>,<italic>m</italic></sub> &#x02208; {0, 1}. So, at most there will be 2&#x02009;<italic>k</italic> unique combinations of <italic>&#x003b1;</italic> and <italic>&#x003b2;</italic> values. In an actual implementation, with every update we first compute and concatenate all <italic>&#x003b1;&#x02019;s</italic> and <italic>&#x003b2;&#x02019;s</italic> and then confine them to unique combinations by adding the <italic>&#x003b3;</italic> coefficients that correspond to the same combination.</p><p>To compute <inline-formula id="IEq29"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_k\left(\boldsymbol{\rho} \right) $$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="bold-italic">&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq29.gif"/></alternatives></inline-formula> for the whole range of rank products <bold><italic>&#x003c1;</italic></bold> at once, we first compute the set of corresponding intervals labelled by <bold>j</bold>. For all <italic>j</italic> &#x02208; <bold>j</bold> we then need to calculate the corresponding <italic>&#x003b8;</italic><sub><italic>kj</italic></sub>. We can do this recursively or using for-loops. When doing this recursively, it is wise to keep track of the parameters that already have been computed to prevent repetitive calculations. See Algorithm 1 in the Additional file <xref rid="MOESM5" ref-type="media">5</xref>. When using for-loops, following the same line of reasoning as suggested by Figure&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>, we have an outer loop with <italic>j</italic>' running from 0 to max(<bold>j</bold>) (from left to right) and an inner loop with <italic>k</italic>' running from <italic>j</italic>' to max(<italic>k</italic>&#x02009;&#x02212;&#x02009;min(<bold>j</bold>)&#x02009;+&#x02009;<italic>j</italic>', <italic>k</italic>) (from top to bottom). Alternatively, we can have an outer loop with <italic>k</italic>' running from 0 to <italic>k</italic> (from top to bottom) and <italic>j</italic>' from max(<italic>k</italic>'&#x02009;&#x02212;&#x02009;<italic>k</italic>&#x02009;+&#x02009;min(<bold>j</bold>), 0) to min(<italic>k</italic>', max(<bold>j</bold>)) (from left to right). This latter ordering is taken in Algorithm 2 in Additional file <xref rid="MOESM5" ref-type="media">5</xref>. The solution for each <italic>&#x003c1;</italic> then follows by computing <inline-formula id="IEq30"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{kj}\left(\rho \right) $$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq30.gif"/></alternatives></inline-formula> from (<xref rid="Equ8" ref-type="">8</xref>), with <italic>j</italic> labelling the interval containing <italic>&#x003c1;</italic>. Algorithm 1 is implemented in R (R Core Team [<xref ref-type="bibr" rid="CR14">14</xref>]) and the R code is published in Additional file <xref rid="MOESM6" ref-type="media">6</xref> and is available at <ext-link ext-link-type="uri" xlink:href="http://www.ru.nl/publish/pages/726696/rankprodbounds.zip">http://www.ru.nl/publish/pages/726696/rankprodbounds.zip</ext-link>.</p></sec><sec id="Sec7"><title>Exact calculation and gamma approximation</title><p>The exact <italic>p</italic>-values may be obtained by a brute force search using the discrete recursion (<xref rid="Equ1" ref-type="">1</xref>). An alternative method, proposed by Eisinga <italic>et al.</italic> [<xref ref-type="bibr" rid="CR11">11</xref>], is to use number theory to obtain a combinatorial exact expression for calculating the discrete probability distribution of the rank product statistic. The distribution is asymmetric (i.e., positively skewed) and in determining the <italic>p</italic>-value, all probabilities need to be calculated, from the smallest rank product possible, with <italic>&#x003c1;</italic>&#x02009;=&#x02009;1, to the rank product value of interest. This implies that the exact statistical significance of large rank products may take unacceptably long amounts of time to compute [<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR16">16</xref>].</p><p>In [<xref ref-type="bibr" rid="CR13">13</xref>], Koziol argues that under the null hypothesis for experiment <italic>i</italic> the <italic>p</italic>-values <italic>r</italic><sub><italic>i</italic></sub>/(<italic>n</italic>&#x02009;+&#x02009;1) are approximately uniformly distributed on the interval [0,1]. As the probability distribution of the negative log-transformed <italic>p</italic>-values is given by the exponential distribution with scale parameter 1, the negative sum of the log-transformed <italic>p</italic>-values over <italic>k</italic> independent experiments has a Gamma(<italic>k</italic>,1) distribution (see also Pounds and Cheng [<xref ref-type="bibr" rid="CR17">17</xref>]). This approach is equivalent to Fisher&#x02019;s [<xref ref-type="bibr" rid="CR18">18</xref>] method of combining <italic>p</italic>-values over independent tests. As illustrated below, the assumption that the distribution of the <italic>p</italic>-values is uniform on the continuous interval [0,1], when in fact it is uniform on the discrete set {1/(<italic>n</italic>&#x02009;+&#x02009;1), 2/(<italic>n</italic>&#x02009;+&#x02009;1), &#x02026;, <italic>n</italic>/(<italic>n</italic>&#x02009;+&#x02009;1)}, leads to substantial deviations from the right tail of the true distribution.</p></sec></sec><sec id="Sec8" sec-type="results"><title>Results and discussion</title><sec id="Sec9"><title>Time performance and accuracy</title><p>The R program computes the bounds and the geometric mean <italic>p</italic>-value approximation at a very fast speed. For example, it takes approximately 2 milliseconds to calculate the upper bound <italic>p</italic>-value of any rank product <italic>&#x003c1;</italic> in the range 1 to <italic>n</italic><sup><italic>k</italic></sup>, for <italic>n</italic>&#x02009;=&#x02009;10000 and <italic>k</italic>&#x02009;=&#x02009;4, on a HP desktop computer using the interpreted R language running under Windows 7 with an Intel Core i7 CPU at 2.9 GHz. It takes twice as much time to calculate the geometric mean <italic>p</italic>-value approximation. Unlike exact calculation, the algorithm&#x02019;s computational time is almost unrelated to the value of rank product <italic>&#x003c1;.</italic></p><p>To examine the effect of the number of experiments <italic>k</italic> on the algorithm&#x02019;s running time, we generated 10000 random draws from the discrete uniform distribution on [1, <italic>n</italic><sup><italic>k</italic></sup>] and calculated the upper bounded <italic>p</italic>-value of the simulated rank products, for <italic>n</italic>&#x02009;=&#x02009;10000 and <italic>k</italic>&#x02009;=&#x02009;2, &#x02026;, 50. Figure&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> plots the computation time (in milliseconds) for the calculation of 10000 <italic>p</italic>-values and a third-order polynomial fitted line.<fig id="Fig2"><label>Figure 2</label><caption><p>
<bold>Computation time (in milliseconds) for calculating 10000 upper bound</bold>
<bold><italic>p</italic></bold>
<bold>-values for</bold>
<bold><italic>n</italic></bold>&#x02009;
<bold>=&#x02009;10000 and</bold>
<bold><italic>k</italic></bold>&#x02009;
<bold>=&#x02009;2, &#x02026;, 50.</bold>
</p></caption><graphic xlink:href="12859_2014_367_Fig2_HTML" id="MO2"/></fig></p><p>The figure indicates that computation time is no limiting factor when it comes to approximate <italic>p</italic>-value calculation of rank products, even for very demanding problems. Running time increases polynomially (of maximum order 3) with increasing <italic>k.</italic> Also, the time needed to do the same calculation for much larger <italic>n</italic> is similar to the time figures shown in the plot, as the algorithm&#x02019;s computational time is not only virtually unrelated to rank product <italic>&#x003c1;</italic>, but also unaffected by <italic>n</italic>. This implies that the proposed calculation method should work well with all sample and replicate sizes typically encountered in postgenomic molecular profiling experiments.</p><p>To assess numerical accuracy, the entire <italic>p</italic>-value distribution was obtained for both large and small values of <italic>n</italic> and <italic>k</italic> (i.e., <italic>n</italic> = 10,10000 and <italic>k</italic> = 4,20)<italic>.</italic> Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref> displays the gamma approximation, the upper and lower bounds, and the geometric mean <italic>p</italic>-value approximation. The exact <italic>p</italic>-values are reported only for small values of <italic>&#x003c1;</italic> (right-hand panels of Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>) and for the entire range of rank products of the smallest <italic>n</italic> and <italic>k</italic> (left-hand panel of Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>C). Exact <italic>p</italic>-value calculation of the entire distribution is computationally unmanageable (or at least extremely time consuming) for the other values of <italic>n</italic> and <italic>k</italic>. As can be seen in Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>A, the upper and lower bounds are rather tight. Relatively speaking, i.e., on a logarithmic scale, they are most tight for large rank products. For small rank products they are in this case (<italic>n</italic> = 10000 and <italic>k</italic> = 4) at most a factor 3 off, that is higher/lower than the exact <italic>p</italic>-value. The approximation obtained by taking the geometric mean of the upper and lower bound is seen to be very accurate.<fig id="Fig3"><label>Figure 3</label><caption><p>
<bold>Bounds and approximations of</bold>
<bold><italic>p</italic></bold>
<bold>-value distribution. (A)</bold> Strict bounds and approximations (geometric mean of upper and lower bound, and gamma) for <italic>n</italic> = 10000 molecules and <italic>k</italic> = 4 experiments, on the left-hand side over the whole range of rank products, on the right-hand side for small rank products only (gamma approximation is outside the figure). It can be seen that, on the log scale, the bounds are very tight. Zooming in on small rank products, the bounds are on average about a factor 2.5 off (i.e., higher/lower than the exact <italic>p</italic>-value), yet the geometric mean approximation is still very close to the exact <italic>p</italic>-value. <bold>(B)</bold> Same as <bold>(A)</bold>, but for <italic>n</italic> = 10000 and <italic>k</italic> = 20. The curve on the left looks more or less the same but, as is best seen on the right, the bounds are much further off (almost a factor 1000). <bold>(C)</bold> Same as <bold>(A)</bold>, but for <italic>n</italic>&#x02009;=&#x02009;10 and <italic>k</italic>&#x02009;=&#x02009;4. The curve on the left may look worse, but that is mainly because of the scaling of the <italic>y</italic>-axis. Relatively speaking, the bounds are still on average about a factor 2.5 off. <bold>(D)</bold> Same as <bold>(A)</bold>, but for <italic>n</italic> = 10 and <italic>k</italic> = 20. With very small <italic>n</italic> and relatively large <italic>k</italic>, we get the worst of both worlds.</p></caption><graphic xlink:href="12859_2014_367_Fig3_HTML" id="MO3"/></fig></p><p>Trying different values of <italic>n</italic> and <italic>k</italic>, the curves look extremely similar when we plot them over the entire range of rank products, that is, for log-transformed <italic>p</italic>-values, between&#x02009;&#x02212;&#x02009;<italic>k</italic>log<italic>n</italic> and 0. The range between the log upper bound and the log lower bound is more or less independent of <italic>n</italic> and increases roughly linear with <italic>k,</italic> but then so does the range of log <italic>p</italic>-values. With increasing <italic>n</italic>, the range of log <italic>p</italic>-values does increase logarithmically with <italic>n</italic>, where the range between upper and lower bound remains about constant (see Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>C for <italic>n</italic> = 10 and <italic>k</italic> = 4). This makes that curves for large <italic>n</italic> look most impressive in the sense of displaying tight bounds. Results for small <italic>n</italic> and large <italic>k</italic> are least impressive (see Figure&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>D for <italic>n</italic> = 10 and <italic>k</italic> = 20). In any case, excluding extremely large rank products, the upper bounds are always orders of magnitude better than the gamma approximation. The latter assumes a continuous distribution and this assumption is too strong for the analysis of discrete rank products.</p><p>When trying to find an even better approximation or bound for <italic>G</italic><sub><italic>k</italic></sub>(<italic>&#x003c1;</italic>), one option is to use the continuous approximation scheme to compute <inline-formula id="IEq31"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_{k-1}\left(\rho \hbox{'}\right) $$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq31.gif"/></alternatives></inline-formula> for all <italic>&#x003c1;</italic>'&#x02009;&#x02264;&#x02009;<italic>&#x003c1;</italic> and then apply the discrete recursion (<xref rid="Equ1" ref-type="">1</xref>) to arrive at better <inline-formula id="IEq32"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\tilde{G}}_k\left(\rho \right). $$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mover accent="true"><mml:mi>G</mml:mi><mml:mo stretchy="true">&#x002dc;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c1;</mml:mi></mml:mfenced><mml:mtext>.</mml:mtext></mml:math><inline-graphic xlink:href="12859_2014_367_Article_IEq32.gif"/></alternatives></inline-formula> Initial attempts revealed that this indeed yields somewhat tighter bounds (e.g., a factor 1.5 off instead of 2.5) and a more accurate approximation, but not to the extent that it seems worth the computational effort.</p></sec><sec id="Sec10"><title>Application</title><p>To illustrate our method in a real-world application, gene expression data on human aging were obtained from Van den Akker <italic>et al</italic>. [<xref ref-type="bibr" rid="CR19">19</xref>], available at <ext-link ext-link-type="uri" xlink:href="http://onlinelibrary.wiley.com/doi/10.1111/acel.12160/suppinfo">http://onlinelibrary.wiley.com/doi/10.1111/acel.12160/suppinfo</ext-link> [Supplementary Table S2]. The data set contains the statistical results for 9047 unique genes (expressed in 2539 individuals) from four different studies. The authors employed rank product analysis to identify genes consistently up- or down-regulated with age across the four data sets. Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref> displays the top 25 genes having increased expression with age.<table-wrap id="Tab1"><label>Table 1</label><caption><p>
<bold>Top-25 age-associated genes with increased expression level (Van den Akker</bold>
<bold><italic>et al.</italic></bold> [<xref ref-type="bibr" rid="CR19">19</xref>]<bold>)</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th>
<bold>Symbol</bold>
</th><th>
<bold>GeneID</bold>
</th><th>
<bold><italic>&#x003c1;</italic></bold>
</th><th/><th/><th>
<bold><italic>p</italic></bold>
<bold>-value</bold>
</th><th/><th/></tr><tr valign="top"><th/><th/><th/><th>
<bold>Exact</bold>
</th><th>
<bold>Gamma</bold>
</th><th>
<bold>Upper bound</bold>
</th><th>
<bold>Geometric mean</bold>
</th><th>
<bold>Lower bound</bold>
</th></tr></thead><tbody><tr valign="top"><td>GPR56</td><td>9289</td><td>9282</td><td>2.645&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;10</sup>
</td><td>5.255&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;09</sup>
</td><td>3.888&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;10</sup>
</td><td>2.709&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;10</sup>
</td><td>1.887&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;10</sup>
</td></tr><tr valign="top"><td>HF1</td><td>3075</td><td>48576</td><td>2.074&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;09</sup>
</td><td>2.296&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td><td>2.873&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;09</sup>
</td><td>2.117&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;09</sup>
</td><td>1.559&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;09</sup>
</td></tr><tr valign="top"><td>SYT11</td><td>23208</td><td>57600</td><td>2.550&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;09</sup>
</td><td>2.671&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td><td>3.510&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;09</sup>
</td><td>2.601&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;09</sup>
</td><td>1.927&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;09</sup>
</td></tr><tr valign="top"><td>ARP10</td><td>164668</td><td>179400</td><td>9.817&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;09</sup>
</td><td>7.297&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td><td>1.303&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td><td>1.000&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td><td>7.680&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;09</sup>
</td></tr><tr valign="top"><td>B3GAT1(CD57)</td><td>27087</td><td>278460</td><td>1.635&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td><td>1.075&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>2.142&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td><td>1.666&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td><td>1.295&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td></tr><tr valign="top"><td>SLC1A7</td><td>6512</td><td>483780</td><td>3.078&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td><td>1.746&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>3.970&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td><td>3.135&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td><td>2.476&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td></tr><tr valign="top"><td>IFNG</td><td>3458</td><td>1594440</td><td>1.171&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>4.953&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>1.465&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>1.192&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>9.697&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;08</sup>
</td></tr><tr valign="top"><td>DSCR1L1</td><td>10231</td><td>2004864</td><td>1.507&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>6.046&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>1.874&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>1.533&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>1.254&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td></tr><tr valign="top"><td>ARK5</td><td>9891</td><td>2726880</td><td>2.110&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>7.898&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>2.605&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>2.146&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>1.768&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td></tr><tr valign="top"><td>PIG13</td><td>81563</td><td>3549314</td><td>2.809&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>9.927&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>3.448&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>2.857&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>2.367&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td></tr><tr valign="top"><td>SPUVE</td><td>11098</td><td>3880576</td><td>3.093&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>1.072&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>3.789&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>3.146&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>2.612&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td></tr><tr valign="top"><td>PDGFRB</td><td>5159</td><td>4294368</td><td>3.451&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>1.171&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>4.217&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>3.509&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>2.920&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td></tr><tr valign="top"><td>EDG8</td><td>53637</td><td>5083584</td><td>4.137&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>1.355&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>5.037&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>4.207&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>3.513&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td></tr><tr valign="top"><td>MARLIN1</td><td>152789</td><td>5505984</td><td>4.507&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>1.451&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>5.477&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>4.582&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>3.833&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td></tr><tr valign="top"><td>TGFBR3</td><td>7049</td><td>8081700</td><td>6.784&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>2.021&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>8.176&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>6.896&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>5.815&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td></tr><tr valign="top"><td>GZMB</td><td>3002</td><td>9886240</td><td>8.396&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>2.404&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.008&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>8.533&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>7.227&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td></tr><tr valign="top"><td>DEFA3</td><td>1168</td><td>9980528</td><td>8.481&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>2.423&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.018&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>8.619&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td><td>7.301&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td></tr><tr valign="top"><td>KRT1</td><td>3848</td><td>11787930</td><td>1.010&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>2.796&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.208&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.027&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>8.728&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td></tr><tr valign="top"><td>CX3CR1</td><td>1524</td><td>12060288</td><td>1.035&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>2.851&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.237&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.052&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>8.944&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;07</sup>
</td></tr><tr valign="top"><td>STYK1</td><td>55359</td><td>14337372</td><td>1.241&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>3.308&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.477&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.260&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.076&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td></tr><tr valign="top"><td>ADRB2</td><td>154</td><td>16272900</td><td>1.416&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>3.687&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.681&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.438&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.231&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td></tr><tr valign="top"><td>GAF1</td><td>26056</td><td>35217600</td><td>3.138&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>7.128&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>3.667&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>3.186&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>2.769&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td></tr><tr valign="top"><td>CTSL</td><td>1514</td><td>38246400</td><td>3.414&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>7.647&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>3.982&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>3.465&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>3.016&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td></tr><tr valign="top"><td>GFI1</td><td>2672</td><td>56960480</td><td>5.107&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.072&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;05</sup>
</td><td>5.907&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>5.183&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>4.547&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td></tr><tr valign="top"><td>TTC38</td><td>55020</td><td>59340600</td><td>5.322&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>1.110&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;05</sup>
</td><td>6.150&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>5.400&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td><td>4.742&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;06</sup>
</td></tr></tbody></table></table-wrap></p><p>We obtained the exact <italic>p</italic>-values and, ideally, one should use these values in correcting for multiple testing as they are the gold standard in the sense that the sampling distribution is known exactly. Only by deciding to accept or reject the null on the basis of exact <italic>p</italic>-values are we guaranteed to be protected from Type-1 errors at the desired significance level. However, it takes considerable amounts of time to calculate the <italic>p</italic>-value for the gene listed in the bottom of Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref> (approximately 120&#x000a0;minutes) and it is (by far) not feasible to obtain the exact <italic>p</italic>-values of the largest rank products on a timely enough basis. The strict upper and lower bounds, however, perform well in the sense that the limits are narrow and the bias is tiny. Although the geometric mean <italic>p</italic>-value approximation provides no absolute guarantee to protection from Type-1 errors, the estimates and the exact probabilities are seen to be very close. The gamma distribution is seen to produce rather inaccurate approximate results.</p><p>Bonferroni corrections are one approach for controlling the experiment-wide false positive rate (<italic>&#x003c0;</italic>) by specifying what <italic>&#x003b1;</italic> value should be used for each individual test, taking <italic>&#x003b1;</italic>&#x02009;=&#x02009;<italic>&#x003c0;</italic>/<italic>n</italic>. For the current study, <italic>&#x003c0;</italic> = 0.05 gives <italic>&#x003b1;</italic> = 0.05/9047&#x02009;&#x02248;&#x02009;5.526&#x02009;&#x000d7;&#x02009;10<sup>&#x02212;6</sup>. We declare a test (i.e., gene) to be significant if <italic>p</italic>&#x02009;&#x02264;&#x02009;<italic>&#x003b1;</italic>.</p><p>The results for both up- and down-regulated genes are shown in the left panel of Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>. Under a strict Bonferroni correction, we reject the null hypothesis of no differential expression with associated exact <italic>p</italic>-value for 25 up- and 42 down-regulated genes. The geometric mean <italic>p</italic>-value approximation produces results identical to the exact method. The asymptotic gamma approximation is too conservative in that it tends to understate the evidence against the null hypothesis. While reducing the number of false positives, it also reduces the number of true discoveries, especially for down-regulated genes. The Bonferroni method applied to the gamma <italic>p</italic>-values declared 30 genes to be significant, instead of 42.<table-wrap id="Tab2"><label>Table 2</label><caption><p>
<bold>Number of genes called significant according to Bonferroni correction and FDR</bold>
<bold><italic>q</italic></bold>
<bold>-values</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr valign="top"><th/><th>
<bold>Bonferroni correction</bold>
</th><th/><th>
<bold><italic>q</italic></bold>
<bold>-value</bold>
</th><th/></tr><tr valign="top"><th/><th/><th>
<bold>&#x0003c; 0.001</bold>
</th><th>
<bold>&#x0003c; 0.01</bold>
</th><th>
<bold>&#x0003c; 0.05</bold>
</th></tr></thead><tbody><tr valign="top"><td>
<bold>Up-regulated genes</bold>
</td><td/><td/><td/><td/></tr><tr valign="top"><td>Exact</td><td>25</td><td/><td/><td/></tr><tr valign="top"><td>Gamma</td><td>21</td><td>14</td><td>40</td><td>112</td></tr><tr valign="top"><td>Upper bound</td><td>23</td><td>21</td><td>57</td><td>122</td></tr><tr valign="top"><td>Geometric mean</td><td>25</td><td>21</td><td>58</td><td>129</td></tr><tr valign="top"><td>Lower bound</td><td>26</td><td>21</td><td>59</td><td>131</td></tr><tr valign="top"><td colspan="5">
<bold>Down-regulated genes</bold>
</td></tr><tr valign="top"><td>Exact</td><td>42</td><td/><td/><td/></tr><tr valign="top"><td>Gamma</td><td>30</td><td>23</td><td>69</td><td>140</td></tr><tr valign="top"><td>Upper bound</td><td>42</td><td>39</td><td>74</td><td>143</td></tr><tr valign="top"><td>Geometric mean</td><td>42</td><td>42</td><td>74</td><td>154</td></tr><tr valign="top"><td>Lower bound</td><td>43</td><td>43</td><td>75</td><td>157</td></tr></tbody></table></table-wrap></p><p>The traditional Bonferroni correction may be too stringent in postgenomic multiple testing, where the number of molecules profiled in parallel is very large, and falsely detecting a small number of molecules as differently expressed will usually not be a serious problem if the majority of significant molecules are properly selected. A less stringent method is to estimate the FDR for the entire collection of <italic>p</italic>-values, defined as the expected number of false positives amongst the molecules selected as significantly differentially expressed, described in detail in Storey [<xref ref-type="bibr" rid="CR20">20</xref>] and Storey and Tibshirani [<xref ref-type="bibr" rid="CR9">9</xref>]. We obtained the FDR adjusted <italic>p</italic>-values, i.e., <italic>q</italic>-values, for all approximate <italic>p</italic>-value estimates, using Storey&#x02019;s R program Q-value (with the bootstrap estimator). The estimated <italic>q</italic>-value for any particular test is a function of the <italic>p</italic>-value for that test and the distribution of the entire set of <italic>p</italic>-values. As it utilizes information from all the <italic>p</italic>-values at once, it is impossible to obtain <italic>q</italic>-values based on the exact probabilities. The right panel of Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref> presents the number of significant calls for various thresholds by <italic>p</italic>-value approximation method. As can be seen, about [(57&#x02013;40)/57&#x02009;&#x000d7;&#x02009;100=] 30% of the differentially expressed up-regulated genes selected using the upper bounded <italic>p</italic>-values at a <italic>q</italic>-value of 0.01, were not detected by the overly conservative gamma approach.</p></sec></sec><sec id="Sec11" sec-type="conclusion"><title>Conclusions</title><p>In replicated molecular profiling experiments, where large numbers of molecules are simultaneously tested, accurately estimated <italic>p</italic>-values are essential for making justified, reproducible decisions about which molecules to consider as significantly differentially expressed in the downstream analysis. We provide a tailor-made solution to calculate strict bounds and accurate approximate <italic>p</italic>-values for rank product analysis of postgenomic molecular profiling data. The proposed algorithm runs very fast and gives a slightly conservative upper bound protecting against false positives and a close approximate estimate of the true <italic>p</italic>-values.</p><p>Over the past decade, the rank product method, developed originally for the analysis of microarray datasets, has found widespread use in various settings such as proteomics [<xref ref-type="bibr" rid="CR6">6</xref>,<xref ref-type="bibr" rid="CR7">7</xref>], metabolomics [<xref ref-type="bibr" rid="CR8">8</xref>], RNAi screening [<xref ref-type="bibr" rid="CR21">21</xref>], meta-analysis [<xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR22">22</xref>], and classification [<xref ref-type="bibr" rid="CR23">23</xref>]. However, its application has been restricted to medium sample and replicate sizes due to an intensive permutation test used to calculate significance. The algorithm presented here can provide an order of magnitude increase in throughput as compared with permutation testing. It also allows researchers to explore new application domains with even larger multiple testing issue, e.g., in large genetics studies with millions of markers or RNAseq analyses where the number of studies transcripts is larger than the number of genes or in applications to image analysis.</p><sec id="Sec12"><title>Software availability</title><p>The R code is also freely available at <ext-link ext-link-type="uri" xlink:href="http://www.ru.nl/publish/pages/726696/rankprodbounds.zip">http://www.ru.nl/publish/pages/726696/rankprodbounds.zip</ext-link>.</p></sec></sec></body><back><app-group><app id="App1"><sec id="Sec13"><title>Additional files</title><p><media position="anchor" xlink:href="12859_2014_367_MOESM1_ESM.doc" id="MOESM1"><label>Additional file 1:</label><caption><p>
<bold>Proof of Theorem 1.</bold>
</p></caption></media><media position="anchor" xlink:href="12859_2014_367_MOESM2_ESM.doc" id="MOESM2"><label>Additional file 2:</label><caption><p>
<bold>Proof of Theorem 2.</bold>
</p></caption></media><media position="anchor" xlink:href="12859_2014_367_MOESM3_ESM.doc" id="MOESM3"><label>Additional file 3:</label><caption><p>
<bold>Proof of Theorem 3.</bold>
</p></caption></media><media position="anchor" xlink:href="12859_2014_367_MOESM4_ESM.doc" id="MOESM4"><label>Additional file 4:</label><caption><p>
<bold>Proof of Theorem 4.</bold>
</p></caption></media><media position="anchor" xlink:href="12859_2014_367_MOESM5_ESM.pdf" id="MOESM5"><label>Additional file 5:</label><caption><p>
<bold>Pseudo code.</bold> A pdf file providing the pseudo code of two algorithms.</p></caption></media><media position="anchor" xlink:href="12859_2014_367_MOESM6_ESM.zip" id="MOESM6"><label>Additional file 6:</label><caption><p>
<bold>Rankprodbounds.</bold> A .zip file providing the code of the algorithm implemented in R.</p></caption></media></p></sec></app></app-group><fn-group><fn><p><bold>Competing interests</bold></p><p>The authors declare that they have no competing interests.</p></fn><fn><p><bold>Authors&#x02019; contributions</bold></p><p>TH designed the approximation method, implemented the algorithm, and drafted the manuscript. RE participated in the design of the method, performed the data analysis and drafted the manuscript. RB supervised the study and drafted the manuscript. All authors read and approved the final manuscript.</p></fn></fn-group><ack><title>Acknowledgements</title><p>Rank products of the genes in the transcript study discussed here were obtained from Van den Akker <italic>et al</italic>. [<xref ref-type="bibr" rid="CR19">19</xref>]. The authors are grateful to Erik van den Akker for valuable correspondence about the data. We also gratefully acknowledge financial support from the Netherlands Organization for Scientific Research (NWO) via the Complexity project (645.000.003).</p></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breitling</surname><given-names>R</given-names></name><name><surname>Armengaud</surname><given-names>P</given-names></name><name><surname>Amtmann</surname><given-names>A</given-names></name><name><surname>Herzyk</surname><given-names>P</given-names></name></person-group><article-title>Rank products: a simple, yet powerful, new method to detect differentially regulated genes in replicated microarray experiments</article-title><source>FEBS Lett</source><year>2004</year><volume>573</volume><issue>1&#x02013;3</issue><fpage>83</fpage><lpage>92</lpage><pub-id pub-id-type="doi">10.1016/j.febslet.2004.07.055</pub-id><?supplied-pmid 15327980?><pub-id pub-id-type="pmid">15327980</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breitling</surname><given-names>R</given-names></name><name><surname>Herzyk</surname><given-names>P</given-names></name></person-group><article-title>Rank-based methods as a non-parametric alternative of the t-statistic for the analysis of biological microarray data</article-title><source>J Bioinform Comput Biol</source><year>2005</year><volume>3</volume><issue>5</issue><fpage>1171</fpage><lpage>1189</lpage><pub-id pub-id-type="doi">10.1142/S0219720005001442</pub-id><?supplied-pmid 16278953?><pub-id pub-id-type="pmid">16278953</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeffery</surname><given-names>IB</given-names></name><name><surname>Higgins</surname><given-names>DG</given-names></name><name><surname>Culhane</surname><given-names>AC</given-names></name></person-group><article-title>Comparison and evaluation of methods for generating differentially expressed gene lists from microarray data</article-title><source>BMC Bioinform</source><year>2006</year><volume>7</volume><fpage>359</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-7-359</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>L-C</given-names></name><name><surname>Lin</surname><given-names>H-M</given-names></name><name><surname>Sibille</surname><given-names>E</given-names></name><name><surname>Tseng</surname><given-names>GC</given-names></name></person-group><article-title>Meta-analysis methods for combining multiple expression profiles: comparisons, statistical characterization and an application guideline</article-title><source>BMC Bioinform</source><year>2013</year><volume>14</volume><fpage>368</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-14-368</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bolstad</surname><given-names>BM</given-names></name><name><surname>Irizarry</surname><given-names>RA</given-names></name><name><surname>&#x000c5;strand</surname><given-names>M</given-names></name><name><surname>Speed</surname><given-names>TP</given-names></name></person-group><article-title>A comparison of normalization methods for high density oligonucleotide array data based on variance and bias</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>185</fpage><lpage>193</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/19.2.185</pub-id><?supplied-pmid 12538238?><pub-id pub-id-type="pmid">12538238</pub-id></element-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smit</surname><given-names>S</given-names></name><name><surname>van Breemen</surname><given-names>MJ</given-names></name><name><surname>Hoefsloot</surname><given-names>HCJ</given-names></name><name><surname>Smilde</surname><given-names>AK</given-names></name><name><surname>Aerts</surname><given-names>JMFG</given-names></name><name><surname>de Koster</surname><given-names>CG</given-names></name></person-group><article-title>Assessing the statistical validity of proteomics based biomarkers</article-title><source>Anal Chim Acta</source><year>2007</year><volume>592</volume><issue>2</issue><fpage>210</fpage><lpage>217</lpage><pub-id pub-id-type="doi">10.1016/j.aca.2007.04.043</pub-id><?supplied-pmid 17512828?><pub-id pub-id-type="pmid">17512828</pub-id></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wiederhold</surname><given-names>E</given-names></name><name><surname>Gandhi</surname><given-names>T</given-names></name><name><surname>Permentier</surname><given-names>HP</given-names></name><name><surname>Breitling</surname><given-names>R</given-names></name><name><surname>Poolman</surname><given-names>B</given-names></name><name><surname>Slotboom</surname><given-names>DJ</given-names></name></person-group><article-title>The yeast vacuolar membrane proteome</article-title><source>Mol Cell Proteomics</source><year>2009</year><volume>8</volume><issue>2</issue><fpage>380</fpage><lpage>392</lpage><pub-id pub-id-type="doi">10.1074/mcp.M800372-MCP200</pub-id><?supplied-pmid 19001347?><pub-id pub-id-type="pmid">19001347</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fukushima</surname><given-names>A</given-names></name><name><surname>Kusano</surname><given-names>M</given-names></name><name><surname>Redestig</surname><given-names>H</given-names></name><name><surname>Arita</surname><given-names>M</given-names></name><name><surname>Saito</surname><given-names>K</given-names></name></person-group><article-title>Metabolomic correlation-network modules in Arabidopsis based on a graph-clustering approach</article-title><source>BMC Syst Biol</source><year>2011</year><volume>5</volume><fpage>1</fpage><pub-id pub-id-type="doi">10.1186/1752-0509-5-1</pub-id><?supplied-pmid 21194489?><pub-id pub-id-type="pmid">21194489</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storey</surname><given-names>JD</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><article-title>Statistical significance for genome-wide experiments</article-title><source>Proc Natl Acad Sci USA</source><year>2003</year><volume>100</volume><issue>16</issue><fpage>9440</fpage><lpage>9445</lpage><pub-id pub-id-type="doi">10.1073/pnas.1530509100</pub-id><?supplied-pmid 12883005?><pub-id pub-id-type="pmid">12883005</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pounds</surname><given-names>S</given-names></name><name><surname>Cheng</surname><given-names>C</given-names></name></person-group><article-title>Robust estimation of the false discovery rate</article-title><source>Bioinformatics</source><year>2006</year><volume>22</volume><issue>16</issue><fpage>1979</fpage><lpage>1987</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btl328</pub-id><?supplied-pmid 16777905?><pub-id pub-id-type="pmid">16777905</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eisinga</surname><given-names>R</given-names></name><name><surname>Breitling</surname><given-names>R</given-names></name><name><surname>Heskes</surname><given-names>T</given-names></name></person-group><article-title>The exact probability distribution of the rank product statistics for replicated experiments</article-title><source>FEBS Lett</source><year>2013</year><volume>587</volume><issue>6</issue><fpage>677</fpage><lpage>682</lpage><pub-id pub-id-type="doi">10.1016/j.febslet.2013.01.037</pub-id><?supplied-pmid 23395607?><pub-id pub-id-type="pmid">23395607</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Knijnenburg</surname><given-names>TA</given-names></name></person-group><article-title>Fewer permutations, more accurate <italic>P</italic>-values</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><issue>12</issue><fpage>161</fpage><lpage>168</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp211</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koziol</surname><given-names>JA</given-names></name></person-group><article-title>Comments on the rank product method for analyzing replicated experiments</article-title><source>FEBS Lett</source><year>2010</year><volume>584</volume><issue>5</issue><fpage>941</fpage><lpage>944</lpage><pub-id pub-id-type="doi">10.1016/j.febslet.2010.01.031</pub-id><?supplied-pmid 20093118?><pub-id pub-id-type="pmid">20093118</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="book"><person-group person-group-type="author"><collab>R Core Team</collab></person-group><source>R: A Language and Environment for Statistical Computing</source><year>2012</year><publisher-loc>Vienna, Austria</publisher-loc><publisher-name>R Foundation for Statistical Computing</publisher-name></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caldas</surname><given-names>J</given-names></name><name><surname>Vinga</surname><given-names>S</given-names></name></person-group><article-title>Global meta-analysis of transcriptomics studies</article-title><source>PLoS One</source><year>2014</year><volume>9</volume><issue>2</issue><fpage>e89318</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0089318</pub-id><?supplied-pmid 24586684?><pub-id pub-id-type="pmid">24586684</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Demb&#x000e9;l&#x000e9;</surname><given-names>D</given-names></name><name><surname>Kastner</surname><given-names>P</given-names></name></person-group><article-title>Fold change rank ordering statistics: a new method for detecting differentially expressed genes</article-title><source>BMC Bioinform</source><year>2014</year><volume>15</volume><fpage>14</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-15-14</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pounds</surname><given-names>S</given-names></name><name><surname>Cheng</surname><given-names>C</given-names></name></person-group><article-title>Statistical development and evaluation of microarray gene expression data filters</article-title><source>J Comput Biol</source><year>2005</year><volume>12</volume><issue>4</issue><fpage>482</fpage><lpage>495</lpage><pub-id pub-id-type="doi">10.1089/cmb.2005.12.482</pub-id><?supplied-pmid 15882143?><pub-id pub-id-type="pmid">15882143</pub-id></element-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>RA</given-names></name></person-group><source>Statistical Methods for Research Workers</source><year>1932</year><publisher-loc>London</publisher-loc><publisher-name>Oliver and Boyd</publisher-name></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van den Akker</surname><given-names>EB</given-names></name><name><surname>Passtoors</surname><given-names>WM</given-names></name><name><surname>Jansen</surname><given-names>R</given-names></name><name><surname>van Zwet</surname><given-names>EW</given-names></name><name><surname>Goeman</surname><given-names>JJ</given-names></name><name><surname>Hulsman</surname><given-names>M</given-names></name><name><surname>Emilsson</surname><given-names>V</given-names></name><name><surname>Perola</surname><given-names>M</given-names></name><name><surname>Willemsen</surname><given-names>G</given-names></name><name><surname>Penninx</surname><given-names>BW</given-names></name><name><surname>Heijmans</surname><given-names>BT</given-names></name><name><surname>Maier</surname><given-names>AB</given-names></name><name><surname>Boomsma</surname><given-names>DI</given-names></name><name><surname>Kok</surname><given-names>JN</given-names></name><name><surname>Slagboom</surname><given-names>PE</given-names></name><name><surname>Reinders</surname><given-names>MJ</given-names></name><name><surname>Beekman</surname><given-names>M</given-names></name></person-group><article-title>Meta-analysis on blood transcriptomic studies identifies consistently coexpressed protein-protein interaction modules as robust markers of human aging</article-title><source>Aging Cell</source><year>2014</year><volume>13</volume><issue>2</issue><fpage>216</fpage><lpage>225</lpage><pub-id pub-id-type="doi">10.1111/acel.12160</pub-id><?supplied-pmid 24119000?><pub-id pub-id-type="pmid">24119000</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storey</surname><given-names>JD</given-names></name></person-group><article-title>A direct approach to false discovery rates</article-title><source>J Roy Stat Soc B</source><year>2002</year><volume>64</volume><issue>3</issue><fpage>479</fpage><lpage>498</lpage><pub-id pub-id-type="doi">10.1111/1467-9868.00346</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cinghu</surname><given-names>S</given-names></name><name><surname>Yellaboina</surname><given-names>S</given-names></name><name><surname>Freudenberg</surname><given-names>JM</given-names></name><name><surname>Ghosh</surname><given-names>S</given-names></name><name><surname>Zheng</surname><given-names>X</given-names></name><name><surname>Oldfield</surname><given-names>AJ</given-names></name><name><surname>Lackford</surname><given-names>BL</given-names></name><name><surname>Zaykin</surname><given-names>DV</given-names></name><name><surname>Hu</surname><given-names>G</given-names></name><name><surname>Jothi</surname><given-names>R</given-names></name></person-group><article-title>Integrative framework for identification of key cell identity genes uncovers determinants of ES cell identity and homeostasis</article-title><source>PNAS</source><year>2014</year><volume>111</volume><issue>16</issue><fpage>E1581</fpage><lpage>E1590</lpage><pub-id pub-id-type="doi">10.1073/pnas.1318598111</pub-id><?supplied-pmid 24711389?><pub-id pub-id-type="pmid">24711389</pub-id></element-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tsoi</surname><given-names>LC</given-names></name><name><surname>Qin</surname><given-names>T</given-names></name><name><surname>Slate</surname><given-names>EH</given-names></name><name><surname>Zheng</surname><given-names>WJ</given-names></name></person-group><article-title>Consistent Differential Expression Pattern (CDEP) on microarray to identify genes related to metastatic behavior</article-title><source>BMC Bioinform</source><year>2011</year><volume>12</volume><fpage>438</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-12-438</pub-id></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louen&#x000e7;o</surname><given-names>A</given-names></name><name><surname>Conover</surname><given-names>M</given-names></name><name><surname>Wong</surname><given-names>A</given-names></name><name><surname>Nematzadeh</surname><given-names>A</given-names></name><name><surname>Pan</surname><given-names>F</given-names></name><name><surname>Shatkay</surname><given-names>H</given-names></name><name><surname>Rocha</surname><given-names>LM</given-names></name></person-group><article-title>A linear classifier based on entity recognition tools and a statistical approach to method extraction in the protein-protein interaction literature</article-title><source>BMC Bioinform</source><year>2011</year><volume>12</volume><issue>Suppl 8</issue><fpage>S12</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-12-S8-S12</pub-id></element-citation></ref></ref-list></back></article>