<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3463124</article-id><article-id pub-id-type="pmid">22847932</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/bts477</article-id><article-id pub-id-type="publisher-id">bts477</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Notes</subject><subj-group><subject>Gene Expression</subject></subj-group></subj-group></article-categories><title-group><article-title>easyRNASeq: a bioconductor package for processing RNA-Seq data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Delhomme</surname><given-names>Nicolas</given-names></name><xref ref-type="aff" rid="bts477-AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="bts477-COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Padioleau</surname><given-names>Isma&#x000eb;l</given-names></name><xref ref-type="aff" rid="bts477-AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Furlong</surname><given-names>Eileen E.</given-names></name><xref ref-type="aff" rid="bts477-AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="bts477-AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Steinmetz</surname><given-names>Lars M.</given-names></name><xref ref-type="aff" rid="bts477-AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="bts477-AFF1"><sup>2</sup></xref></contrib></contrib-group><aff id="bts477-AFF1"><sup>1</sup>Genome Biology Computational Support and <sup>2</sup>Genome Biology Unit, European Molecular Biology Laboratory, Meyerhofstrasse 1, 69117 Heidelberg, Germany</aff><author-notes><corresp id="bts477-COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Janet Kelso</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>10</month><year>2012</year></pub-date><pub-date pub-type="epub"><day>30</day><month>7</month><year>2012</year></pub-date><pub-date pub-type="pmc-release"><day>30</day><month>7</month><year>2012</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the							<pub-date pub-type="epub"/>. --><volume>28</volume><issue>19</issue><fpage>2532</fpage><lpage>2533</lpage><history><date date-type="received"><day>22</day><month>12</month><year>2011</year></date><date date-type="rev-recd"><day>18</day><month>6</month><year>2012</year></date><date date-type="accepted"><day>24</day><month>7</month><year>2012</year></date></history><permissions><copyright-statement>&#x000a9; The Author 2012. Published by Oxford University Press.</copyright-statement><copyright-year>2012</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/3.0"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0">http://creativecommons.org/licenses/by/3.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p><bold>Motivation:</bold> RNA sequencing is becoming a standard for expression profiling experiments and many tools have been developed in the past few years to analyze RNA-Seq data. Numerous &#x02018;Bioconductor&#x02019; packages are available for next-generation sequencing data loading in R, e.g. ShortRead and Rsamtools as well as to perform differential gene expression analyses, e.g. DESeq and edgeR. However, the processing tasks lying in between these require the precise interplay of many Bioconductor packages, e.g. Biostrings, IRanges or external solutions are to be sought.</p><p><bold>Results:</bold> We developed &#x02018;easyRNASeq&#x02019;, an R package that simplifies the processing of RNA sequencing data, hiding the complex interplay of the required packages behind a single functionality.</p><p><bold>Availability:</bold> The package is implemented in R (as of version 2.15) and is available from Bioconductor (as of version 2.10) at the URL: <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/html/easyRNASeq.html">http://bioconductor.org/packages/release/bioc/html/easyRNASeq.html</ext-link>, where installation and usage instructions can be found.</p><p><bold>Contact:</bold>
<email>delhomme@embl.de</email></p></abstract><counts><page-count count="2"/></counts></article-meta></front><body><sec id="SEC1"><title>1 INTRODUCTION</title><p>Since the extensive utilization of RNA sequencing for expression profiling (RNA-Seq, <xref ref-type="bibr" rid="bts477-B9">Mortazavi <italic>et al.</italic>, 2008</xref>), numerous tools have been developed, as part of the R/Bioconductor (<xref ref-type="bibr" rid="bts477-B3">Gentleman <italic>et al.</italic>, 2004</xref>) project, to load RNA-Seq data in R. The first: &#x02018;ShortRead&#x02019; (<xref ref-type="bibr" rid="bts477-B8">Morgan <italic>et al.</italic>, 2009</xref>) parses manufacturer-specific formats. It gave way to the &#x02018;Rsamtools&#x02019; package, as the &#x02018;SAM/BAM&#x02019; format (<xref ref-type="bibr" rid="bts477-B7">Li <italic>et al.</italic>, 2009</xref>) became a <italic>de facto</italic> standard for reporting next-generation sequencing (NGS) alignment data. In parallel, analysis packages were adapted (&#x02018;edgeR&#x02019;, <xref ref-type="bibr" rid="bts477-B10">Robinson <italic>et al.</italic>, 2010</xref>) or newly developed (&#x02018;DESeq&#x02019;, <xref ref-type="bibr" rid="bts477-B1">Anders and Huber, 2010</xref>) to accommodate for NGS specificities. Recently, the &#x02018;Bioconductor&#x02019; Core Team released several packages to connect these parts of the process: e.g. GenomicRanges, GenomicFeatures; however, combining them appropriately requires a good understanding of their functionalities, and depending on the data, different combinations of these packages have to be used, implying a long learning curve for RNA-Seq neophytes. In parallel to these aspects, the sequencers&#x02019; yield increase resulted in the generalization of protocols that allow several samples to be run in a single lane, a process called &#x02018;multiplexing&#x02019; (<xref ref-type="bibr" rid="bts477-B6">Lefran&#x000e7;ois <italic>et al.</italic>, 2009</xref>). De-multiplexing the obtained data is a processing step that no R package currently addresses. Here, we describe &#x02018;easyRNASeq&#x02019;, an R package that eases RNA-Seq processing by combining the necessary packages in a single wrapper that ensures the pertinence of the provided data and information and helps users circumnavigate RNA-Seq processing pitfalls. In addition, it introduces functionalities to handle data produced by recent NGS protocols.</p></sec><sec id="SEC2"><title>2 easyRNASeq</title><p>The easyRNASeq package combines the following steps: reading in sequenced reads, retrieving annotations, summarizing read counts by the feature of interest, e.g. exon, gene and finally reporting results, normalized or not, in formats suitable for downstream analyses. This is achieved by using and extending many Bioconductor packages functionalities (<xref ref-type="fig" rid="bts477-F1">Fig. 1</xref>) and provided to end users as a single function that wraps the entire process.
<fig id="bts477-F1" position="float"><label>Fig. 1.</label><caption><p>Packages wrapped by easyRNASeq. At every step of the process, easyRNASeq encapsulates and extends lower level package functionalities, finally merging them into a single high-level function.: <italic>easyRNASeq</italic></p></caption><graphic xlink:href="bts477f1p"/></fig></p><sec id="SEC2.1"><title>2.1 Reading data</title><p>Depending on the alignment format, manufacturer-specific (e.g. Illumina export) or the <italic>de facto</italic> BAM (Binary Alignment/Map) standard, the data are parsed by either ShortRead or Rsamtools, respectively. The coverage is extracted per base pair and divided by the read length&#x02014;i.e. reads&#x02019; coverage proportion are reported per base pair&#x02014;and stored in an &#x02018;IRanges running length encoding&#x02019; (RLE) vector. This approach yields identical results to the common counting reads per se approach, when applied to non-spliced regions as shown in the &#x02018;RNASeqTutorial&#x02019; vignette. However, it more accurately assigns reads spanning exon&#x02013;exon junctions (EEJ), i.e. unlike common methods that arbitrarily select an EEJ side, reads coverage proportion is, here, distributed across the EEJ.</p></sec><sec id="SEC2.2"><title>2.2 Loading annotations</title><p>Genic annotations are retrieved using &#x02018;biomaRt&#x02019; (<xref ref-type="bibr" rid="bts477-B2">Durinck <italic>et al.</italic>, 2005</xref>) or read from &#x02018;General Feature Format 3&#x02019; (GFF3) or &#x02018;Gene Transfer Format&#x02019; (GTF) files using &#x02018;genomeIntervals&#x02019;. The annotation set is stored in a &#x02018;RangedData&#x02019; object (IRanges). To reduce loading times, &#x02018;RangedData&#x02019; or &#x02018;GRangesList&#x02019; objects from the R environment or <italic>RData</italic> (rda) files can be used, provided they describe exons, features, transcripts or genes (a &#x02018;feature&#x02019; is the representation of a genomic locus, not necessarily genic, e.g. an enhancer).</p></sec><sec id="SEC2.3"><title>2.3 Counting reads</title><p>The reads&#x02019; coverage is summarized according to the chosen features: exons, features, transcripts or gene models. Here, a gene model is defined as the set of non-overlapping loci (i.e. synthetic exons) that represent all the possible exons and untranslated regions of a gene. easyRNASeq is not limited to genic summarization only, e.g. promoter &#x02018;features&#x02019; can be used to look for eRNAs (<xref ref-type="bibr" rid="bts477-B5">Kim <italic>et al.</italic>, 2010</xref>).</p></sec><sec id="SEC2.4"><title>2.4 Output</title><p>Four formats are offered: count table (the default), &#x02018;CountDataSet&#x02019; (<italic>DESeq</italic> object), &#x02018;DGEList&#x02019; (<italic>edgeR</italic> object) and &#x02018;RNAseq&#x02019; (<italic>easyRNASeq</italic> object). The count table reports raw counts or &#x02018;reads per kb of feature per million reads&#x02019; (RPKM, <xref ref-type="bibr" rid="bts477-B9">Mortazavi <italic>et al.</italic>, 2008</xref>), if preferred. For <italic>DESeq</italic> and <italic>edgeR</italic>, an object of their respective class is returned. If desired, these would have been subjected to their respective normalization, in which case quality assessment (QA) plots are drawn to evaluate it. Finally, <italic>RNAseq</italic> objects allow different count summarizations to be performed (e.g. by exon, by gene) on the same data without re-processing, a useful feature when first assessing a dataset.</p></sec><sec id="SEC2.5"><title>2.5 Performance</title><p>Fetching annotation using &#x02018;biomaRt&#x02019; takes about 10 min from an average network. Generating the gene models takes up to 15 min for large genomes&#x02014;e.g. Homo sapiens. If these annotations are readily available, processing a 36-bp single-end &#x02018;Illumina&#x02019; lane with 100 M reads&#x02014;a BAM file of 3.2 GB&#x02014;requires 3 GB RAM and 3 min on an Intel 2.4 GHz CPU.</p></sec></sec><sec id="SEC3"><title>3 DE-MULTIPLEXING</title><p>The current data yield allows several samples to be sequenced as a single library, where small nucleotide &#x02018;barcodes&#x02019; (4&#x02013;6 bp) uniquely identify the samples. Resulting sequences must be &#x02018;de-multiplexed&#x02019;, a functionality introduced by easyRNASeq that splits the result file into sample-specific files. To account for sequencing errors, flexibility in identifying the barcode is necessary and achieved using thresholds based on the Hamming distance (<xref ref-type="bibr" rid="bts477-B4">Hamming, 1950</xref>). QA plots help validating the chosen thresholds as well as assessing the multiplexing efficacy.</p></sec><sec id="SEC4"><title>4 CONCLUSIONS</title><p>This note presents the Bioconductor easyRNASeq package. It introduces a method that effectively hides the complex interplay of numerous Bioconductor packages to the end user. Its output can be formatted for further processing by analysis packages such as DESeq or edgeR. Finally, it contains additional features such as de-multiplexing or support for gapped alignments. Future developments will integrate recent trends such as strand-specific sequencing or differential exon usage detection methods.</p></sec></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>Many thanks to P. Aboyoun, S. Bonn, W. Huber and M. Morgan for suggestions and feedback on the package implementation. Thanks to J. Gagneur, C. Girardot, L.-A. Schmitt and Wu Wei for comments on the article. This note was technically supported by EMBL&#x02019;s IT Service Unit and EMBL&#x02019;s Genomics Core Facility.</p><p><italic>Funding</italic>: <funding-source>European Molecular Biology Laboratory</funding-source>, an ERASysBio grant ModHeart awarded to EEF and a <funding-source>NIH</funding-source> grant (<funding-source>NIH</funding-source>: <award-id>R01 GM068717</award-id>) to LMS.</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="bts477-B1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group><article-title>Differential expression analysis for sequence count data</article-title><source>Genome Biol.</source><year>2010</year><volume>11</volume><issue>10</issue><fpage>R106</fpage><pub-id pub-id-type="pmid">20979621</pub-id></element-citation></ref><ref id="bts477-B2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Durinck</surname><given-names>S</given-names></name><etal/></person-group><article-title>Biomart and bioconductor: a powerful link between biological databases and microarray data analysis</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>3439</fpage><lpage>3440</lpage><pub-id pub-id-type="pmid">16082012</pub-id></element-citation></ref><ref id="bts477-B3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gentleman</surname><given-names>RC</given-names></name><etal/></person-group><article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title><source>Genome Biol.</source><year>2004</year><volume>5</volume><fpage>R80</fpage><pub-id pub-id-type="pmid">15461798</pub-id></element-citation></ref><ref id="bts477-B4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamming</surname><given-names>R</given-names></name></person-group><article-title>Error detecting and error correcting codes</article-title><source>Bell Syst. Tech. J.</source><year>1950</year><volume>29</volume><fpage>147</fpage><lpage>160</lpage></element-citation></ref><ref id="bts477-B5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>T-K</given-names></name><etal/></person-group><article-title>Widespread transcription at neuronal activity-regulated enhancers</article-title><source>Nature</source><year>2010</year><volume>465</volume><fpage>182</fpage><lpage>187</lpage><pub-id pub-id-type="pmid">20393465</pub-id></element-citation></ref><ref id="bts477-B6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lefran&#x000e7;ois</surname><given-names>P</given-names></name><etal/></person-group><article-title>Efficient yeast chip-seq using multiplex short-read dna sequencing</article-title><source>BMC Genom</source><year>2009</year><volume>10</volume><fpage>37</fpage></element-citation></ref><ref id="bts477-B7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><etal/></person-group><article-title>The sequence alignment/map format and samtools</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2078</fpage><lpage>2079</lpage><pub-id pub-id-type="pmid">19505943</pub-id></element-citation></ref><ref id="bts477-B8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morgan</surname><given-names>M</given-names></name><etal/></person-group><article-title>Shortread: a bioconductor package for input, quality assessment and exploration of high-throughput sequence data</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2607</fpage><lpage>2608</lpage><pub-id pub-id-type="pmid">19654119</pub-id></element-citation></ref><ref id="bts477-B9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mortazavi</surname><given-names>A</given-names></name><etal/></person-group><article-title>Mapping and quantifying mammalian transcriptomes by RNA-seq</article-title><source>Nat. Methods</source><year>2008</year><volume>5</volume><fpage>621</fpage><lpage>628</lpage><pub-id pub-id-type="pmid">18516045</pub-id></element-citation></ref><ref id="bts477-B10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><etal/></person-group><article-title>edger: a bioconductor package for differential expression analysis of digital gene expression data</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>139</fpage><lpage>140</lpage><pub-id pub-id-type="pmid">19910308</pub-id></element-citation></ref></ref-list></back></article>