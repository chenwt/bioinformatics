<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v3.0 20080202//EN" "archivearticle3.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.0 20040830//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.0?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3253133</article-id><article-id pub-id-type="publisher-id">PONE-D-11-16012</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0029175</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic Acids</subject><subj-group><subject>RNA</subject></subj-group></subj-group></subj-group><subj-group><subject>Biophysics</subject><subj-group><subject>Nucleic Acids</subject><subj-group><subject>RNA</subject></subj-group></subj-group></subj-group><subj-group><subject>Computational Biology</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome Analysis Tools</subject></subj-group></subj-group></subj-group><subj-group><subject>Genetics</subject><subj-group><subject>Gene Expression</subject></subj-group></subj-group><subj-group><subject>Genomics</subject><subj-group><subject>Genome Analysis Tools</subject></subj-group></subj-group><subj-group><subject>Molecular Cell Biology</subject><subj-group><subject>Gene Expression</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer Science</subject><subj-group><subject>Algorithms</subject></subj-group><subj-group><subject>Computerized Simulations</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Mathematics</subject><subj-group><subject>Statistics</subject></subj-group></subj-group></article-categories><title-group><article-title>IQSeq: Integrated Isoform Quantification Analysis Based on Next-Generation Sequencing</article-title><alt-title alt-title-type="running-head">Integrated Isoform Quantification Analysis</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Du</surname><given-names>Jiang</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Leng</surname><given-names>Jing</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Habegger</surname><given-names>Lukas</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Sboner</surname><given-names>Andrea</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>McDermott</surname><given-names>Drew</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Gerstein</surname><given-names>Mark</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>&#x0002a;</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Computer Science, Yale University, New Haven, Connecticut, United States of America</addr-line></aff><aff id="aff2"><label>2</label><addr-line>Program in Computational Biology and Bioinformatics, Yale University, New Haven, Connecticut, United States of America</addr-line></aff><aff id="aff3"><label>3</label><addr-line>Department of Molecular Biophysics and Biochemistry, Yale University, New Haven, Connecticut, United States of America</addr-line></aff><contrib-group><contrib contrib-type="editor"><name><surname>Rzhetsky</surname><given-names>Andrey</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University of Chicago, United States of America</aff><author-notes><corresp id="cor1">&#x0002a; E-mail: <email>Mark.Gerstein@yale.edu</email></corresp><fn fn-type="con"><p>Conceived and designed the experiments: JD JL MG. Performed the experiments: JD JL. Analyzed the data: JD JL LH AS DM MG. Contributed reagents/materials/analysis tools: JD JL DM MG. Wrote the paper: JD JL MG.</p></fn></author-notes><pub-date pub-type="collection"><year>2012</year></pub-date><pub-date pub-type="epub"><day>6</day><month>1</month><year>2012</year></pub-date><volume>7</volume><issue>1</issue><elocation-id>e29175</elocation-id><history><date date-type="received"><day>17</day><month>8</month><year>2011</year></date><date date-type="accepted"><day>22</day><month>11</month><year>2011</year></date></history><permissions><copyright-statement>Du et al. This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</copyright-statement><copyright-year>2012</copyright-year></permissions><abstract><p>With the recent advances in high-throughput RNA sequencing (RNA-Seq), biologists are able to measure transcription with unprecedented precision. One problem that can now be tackled is that of isoform quantification: here one tries to reconstruct the abundances of isoforms of a gene. We have developed a statistical solution for this problem, based on analyzing a set of RNA-Seq reads, and a practical implementation, available from archive.gersteinlab.org/proj/rnaseq/IQSeq, in a tool we call IQSeq (Isoform Quantification in next-generation Sequencing). Here, we present theoretical results which IQSeq is based on, and then use both simulated and real datasets to illustrate various applications of the tool. In order to measure the accuracy of an isoform-quantification result, one would try to estimate the average variance of the estimated isoform abundances for each gene (based on resampling the RNA-seq reads), and IQSeq has a particularly fast algorithm (based on the Fisher Information Matrix) for calculating this, achieving a speedup of <inline-formula><inline-graphic xlink:href="pone.0029175.e001.jpg" mimetype="image"/></inline-formula> times compared to brute-force resampling. IQSeq also calculates an information theoretic measure of overall transcriptome complexity to describe isoform abundance for a whole experiment. IQSeq has many features that are particularly useful in RNA-Seq experimental design, allowing one to optimally model the integration of different sequencing technologies in a cost-effective way. In particular, the IQSeq formalism integrates the analysis of different sample (i.e. read) sets generated from different technologies within the same statistical framework. It also supports a generalized statistical partial-sample-generation function to model the sequencing process. This allows one to have a modular, &#x0201c;plugin-able&#x0201d; read-generation function to support the particularities of the many evolving sequencing technologies.</p></abstract><counts><page-count count="16"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>The concepts of genes and isoforms have evolved and become more complex <xref ref-type="bibr" rid="pone.0029175-Gerstein1">[1]</xref>: the discovery of splicing <xref ref-type="bibr" rid="pone.0029175-Berget1">[2]</xref>&#x02013;<xref ref-type="bibr" rid="pone.0029175-Gelinas1">[4]</xref> revealed that the gene was a series of exons, coding for, in some cases, discrete protein domains, and separated by long noncoding stretches called introns. With alternative splicing, one genetic locus could code for multiple different mRNA transcripts (isoform transcripts). This discovery complicated the concept of the gene radically. For instance, as of 2007, the GENCODE annotation <xref ref-type="bibr" rid="pone.0029175-Harrow1">[5]</xref> contained on average <inline-formula><inline-graphic xlink:href="pone.0029175.e002.jpg" mimetype="image"/></inline-formula> transcripts per locus.</p><p>With the recent development of high-throughput RNA sequencing (RNA-Seq) technology, it is possible for biologists to measure transcription with unprecedented precision. One problem that can now be tackled is that of isoform quantification, where one tries to reconstruct the abundances of similar isoforms based on a set of RNA-Seq reads. Various methods have been developed to solve this problem. In previous work, researchers proposed different statistical frameworks to solve this problem. Xing et al. <xref ref-type="bibr" rid="pone.0029175-Xing1">[6]</xref> proposed a maximum likelihood problem, an expectation maximization solution, and a Fisher information measurement for performance estimation; Jiang et al. <xref ref-type="bibr" rid="pone.0029175-Jiang1">[7]</xref>, based on Poisson model assumption, formulated a maximum likelihood problem and its numerical solution, and also utilized the observed Fisher information matrix to sample the posterior distribution of isoform quantity; Trapnell et al. <xref ref-type="bibr" rid="pone.0029175-Trapnell1">[8]</xref> used variable read-length model (normal distribution by default) and a sampling method similar to <xref ref-type="bibr" rid="pone.0029175-Jiang1">[7]</xref> to derive the posterior distribution of isoform quantity; Richard et al. <xref ref-type="bibr" rid="pone.0029175-Richard1">[9]</xref> with a Poisson model, also used bootstrapping to study the robustness of their method against non-uniform sequencing effects; Lacroix et al. <xref ref-type="bibr" rid="pone.0029175-Lacroix1">[10]</xref> studied the conditions under which the problem can be solved, revealing that although neither single nor paired-end sequencing guarantee a unique solution, paired-end reads may be sufficient to solve the vast majority of the transcript variants in practice.</p><p>These studies, however, have not fully addressed the problem of isoform quantification in a couple of respects: First of all, they usually assume that only one sequencing technique is used in an experiment, and that the reads are uniformly sampled along the transcripts. These are not necessarily good approximations to real data. Second, while some theoretical results have been presented on estimating the accuracy (e.g. average variance) of quantification results, there does not yet exist a method to efficiently compute these measurements other than using brute-force simulation, which is computationally infeasible in large scale expriments involving tens of thousands of genes and millions of sequencing reads. On the other hand, fast estimation of quantification accuracy would not only enable researchers to better understand the analysis results being obtained, but also will be useful in RNA-Seq experiment design to optimally integrate different sequencing technologies in a cost-efficient way.</p><p>In order to fill in these gaps, we have developed a generalized statistical solution for the problem of isoform quantification, and a practical implementation in a tool we call IQSeq (Isoform Quantification in next-generation SEQuencing). IQSeq has the following features which represent improvements over previous work in isoform quantification in the following aspects:</p><list list-type="order"><list-item><p>It has a generalized statistical read generation function during the sequencing process (i.e. a customizable function describing how reads are randomly sampled from isoforms). This provide a flexible way to incorporate characteristics of different sequencing technologies (e.g. 3&#x02032; end sequencing bias of transcripts).</p></list-item><list-item><p>It integrates the analysis of different sample sets generated from different sampling technologies (e.g. long and short reads).</p></list-item><list-item><p>It has a fast algorithm for estimating the average variance of the results provided by our expectation maximization based solution.</p></list-item><list-item><p>Given the estimated isoform abundance output, IQSeq also provides an information theoretical method to measure the overall transcriptome complexity.</p></list-item></list><p>In this paper, we will first introduce a mathematical definition of the generalized partial sampling and distribution estimation problem (which IQSeq is based on), and provide a expectation maximization based iterative solution. Then we discuss in detail on how to estimate the performance of this solution using Fisher information based heuristics, and present fast algorithms that implement the computation of these heuristics. Finally, we show results of applying our methods to both simulated and real-world data, illustrating scenarios where such integrated analysis can be the most informative.</p></sec><sec sec-type="methods" id="s2"><title>Methods</title><p>First, we formally define the isoform quantification with multiple sequencing technologies as a generalized statistical partial sampling problem, and present a computational solution based on maximum likelihood estimation and expectation maximization. We then show both analytical results and practical fast algorithms to estimate the average variance of the solution on isoform quantification, and compare their computational complexity against brute-force methods. We present the main theoretical results in this section, and detailed derivations can be found in <xref ref-type="supplementary-material" rid="pone.0029175.s001">Text S1</xref>.</p><sec id="s2a"><title>Problem Definition</title><p>We start by defining the generalized process of batch partial sampling, which represents the sequencing process in RNA-Seq experiments, and the relationships between partial samples and the objects being sampled.</p><sec id="s2a1"><title>Definition 1</title><p>(Batch Partial Sampling) Let <inline-formula><inline-graphic xlink:href="pone.0029175.e003.jpg" mimetype="image"/></inline-formula> be all the possible isoforms for a given gene, with relative abundances <inline-formula><inline-graphic xlink:href="pone.0029175.e004.jpg" mimetype="image"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0029175.e005.jpg" mimetype="image"/></inline-formula>. We assume that there are <inline-formula><inline-graphic xlink:href="pone.0029175.e006.jpg" mimetype="image"/></inline-formula> different partial sampling methods (sequencing techniques with difference characteristics, e.g. long/medium/short, single/paired end): <inline-formula><inline-graphic xlink:href="pone.0029175.e007.jpg" mimetype="image"/></inline-formula>, and let <inline-formula><inline-graphic xlink:href="pone.0029175.e008.jpg" mimetype="image"/></inline-formula> denote all the samples (reads): <inline-formula><inline-graphic xlink:href="pone.0029175.e009.jpg" mimetype="image"/></inline-formula> from <inline-formula><inline-graphic xlink:href="pone.0029175.e010.jpg" mimetype="image"/></inline-formula>. We also define <inline-formula><inline-graphic xlink:href="pone.0029175.e011.jpg" mimetype="image"/></inline-formula> (partial sample (read) <inline-formula><inline-graphic xlink:href="pone.0029175.e012.jpg" mimetype="image"/></inline-formula> is compatible with <inline-formula><inline-graphic xlink:href="pone.0029175.e013.jpg" mimetype="image"/></inline-formula>), where <inline-formula><inline-graphic xlink:href="pone.0029175.e014.jpg" mimetype="image"/></inline-formula> is the indicator function. There are in total <inline-formula><inline-graphic xlink:href="pone.0029175.e015.jpg" mimetype="image"/></inline-formula> samples, where <inline-formula><inline-graphic xlink:href="pone.0029175.e016.jpg" mimetype="image"/></inline-formula> is the total number of partial samples from <inline-formula><inline-graphic xlink:href="pone.0029175.e017.jpg" mimetype="image"/></inline-formula>.</p><p>Here we assume a two-step sampling process: First, a sampling method <inline-formula><inline-graphic xlink:href="pone.0029175.e018.jpg" mimetype="image"/></inline-formula> chooses an isoform instance <inline-formula><inline-graphic xlink:href="pone.0029175.e019.jpg" mimetype="image"/></inline-formula> according to <inline-formula><inline-graphic xlink:href="pone.0029175.e020.jpg" mimetype="image"/></inline-formula>. Second, the sampling method generates a partial sample <inline-formula><inline-graphic xlink:href="pone.0029175.e021.jpg" mimetype="image"/></inline-formula> according to a local partial sample generation model (the read generation function) <inline-formula><inline-graphic xlink:href="pone.0029175.e022.jpg" mimetype="image"/></inline-formula> (generating <inline-formula><inline-graphic xlink:href="pone.0029175.e023.jpg" mimetype="image"/></inline-formula>).</p></sec><sec id="s2a2"><title>Definition 2</title><p>(Distribution Estimation based on Batch Partial Samples) <italic>Given</italic> <inline-formula><inline-graphic xlink:href="pone.0029175.e024.jpg" mimetype="image"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0029175.e025.jpg" mimetype="image"/></inline-formula> as defined in Definition 1, estimate <inline-formula><inline-graphic xlink:href="pone.0029175.e026.jpg" mimetype="image"/></inline-formula>.</p><p>As shown in <xref ref-type="fig" rid="pone-0029175-g001">Figure 1</xref>, <inline-formula><inline-graphic xlink:href="pone.0029175.e027.jpg" mimetype="image"/></inline-formula> are the isoforms with different relative abundances <inline-formula><inline-graphic xlink:href="pone.0029175.e028.jpg" mimetype="image"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0029175.e029.jpg" mimetype="image"/></inline-formula> are the single- and paired-end reads whose sequences align with part of this gene region. Some of these reads (e.g. read <inline-formula><inline-graphic xlink:href="pone.0029175.e030.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0029175.e031.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0029175.e032.jpg" mimetype="image"/></inline-formula>) are compatible with multiple isoforms. The ultimate problem is to estimate <inline-formula><inline-graphic xlink:href="pone.0029175.e033.jpg" mimetype="image"/></inline-formula> based on <inline-formula><inline-graphic xlink:href="pone.0029175.e034.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0029175.e035.jpg" mimetype="image"/></inline-formula>, i.e., reconstructing a distribution based on partial observations.</p><fig id="pone-0029175-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g001</object-id><label>Figure 1</label><caption><title>Reads (partial samples) in the isoform quantification problem.</title></caption><graphic xlink:href="pone.0029175.g001"/></fig><p>In the remaining part of this paper, we will use two notations to describe a partial sample <inline-formula><inline-graphic xlink:href="pone.0029175.e036.jpg" mimetype="image"/></inline-formula>: <inline-formula><inline-graphic xlink:href="pone.0029175.e037.jpg" mimetype="image"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="pone.0029175.e038.jpg" mimetype="image"/></inline-formula>th sample from <inline-formula><inline-graphic xlink:href="pone.0029175.e039.jpg" mimetype="image"/></inline-formula>; and <inline-formula><inline-graphic xlink:href="pone.0029175.e040.jpg" mimetype="image"/></inline-formula> stands for a partial sample from <inline-formula><inline-graphic xlink:href="pone.0029175.e041.jpg" mimetype="image"/></inline-formula>, starting (inclusive) from position <inline-formula><inline-graphic xlink:href="pone.0029175.e042.jpg" mimetype="image"/></inline-formula> and ending (exclusive) at <inline-formula><inline-graphic xlink:href="pone.0029175.e043.jpg" mimetype="image"/></inline-formula> in that isoform. We also define exons as those nodes in the splicing graph of a gene, so that there are no exons that overlap with each other (i.e. an exon in a transcript may be a combination of multiple nodes of the splicing graph). We have included in our software package a preprocessing tool for grouping transcripts into gene clusters and formulating corresponding splicing graphs.</p></sec></sec><sec id="s2b"><title>Maximum Likelihood Estimation (MLE)</title><p>Definition 2 does not give an explicit criterion for a &#x0201c;good&#x0201d; estimation of <inline-formula><inline-graphic xlink:href="pone.0029175.e044.jpg" mimetype="image"/></inline-formula>. Since the problem is defined in a statistical sampling framework, it is natural to consider using Maximum Likelihood as such a criterion.</p><sec id="s2b1"><title>Definition 3</title><p>(Maximum-Likelihood Distribution Estimation based on Batch Partial Samples) Given <inline-formula><inline-graphic xlink:href="pone.0029175.e045.jpg" mimetype="image"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0029175.e046.jpg" mimetype="image"/></inline-formula> as defined in Definition 1, find <inline-formula><inline-graphic xlink:href="pone.0029175.e047.jpg" mimetype="image"/></inline-formula> such that:<disp-formula><graphic xlink:href="pone.0029175.e048"/><label>(1)</label></disp-formula></p><p>By plugging in the partial samples <inline-formula><inline-graphic xlink:href="pone.0029175.e049.jpg" mimetype="image"/></inline-formula>s and <inline-formula><inline-graphic xlink:href="pone.0029175.e050.jpg" mimetype="image"/></inline-formula>s, we can rewrite the formula above as follows:<disp-formula><graphic xlink:href="pone.0029175.e051"/><label>(2)</label></disp-formula></p><p>In the next subsection, we demonstrate how this problem can be solved by introducing a hidden variable <inline-formula><inline-graphic xlink:href="pone.0029175.e052.jpg" mimetype="image"/></inline-formula> and using the technique of Expectation Maximization <xref ref-type="bibr" rid="pone.0029175-Dempster1">[11]</xref>.</p></sec></sec><sec id="s2c"><title>Applying the Expectation Maximization Method</title><p>We define <inline-formula><inline-graphic xlink:href="pone.0029175.e053.jpg" mimetype="image"/></inline-formula> is from <inline-formula><inline-graphic xlink:href="pone.0029175.e054.jpg" mimetype="image"/></inline-formula>, which are the hidden variables in this problem. Since Expectation Maximization gives an iterative solution, we denote the estimation for <inline-formula><inline-graphic xlink:href="pone.0029175.e055.jpg" mimetype="image"/></inline-formula> in the <inline-formula><inline-graphic xlink:href="pone.0029175.e056.jpg" mimetype="image"/></inline-formula>th step as <inline-formula><inline-graphic xlink:href="pone.0029175.e057.jpg" mimetype="image"/></inline-formula>, and further define <inline-formula><inline-graphic xlink:href="pone.0029175.e058.jpg" mimetype="image"/></inline-formula>, which is the expectation of <inline-formula><inline-graphic xlink:href="pone.0029175.e059.jpg" mimetype="image"/></inline-formula> given <inline-formula><inline-graphic xlink:href="pone.0029175.e060.jpg" mimetype="image"/></inline-formula> (the estimated paramters at the <inline-formula><inline-graphic xlink:href="pone.0029175.e061.jpg" mimetype="image"/></inline-formula>th step) and the reads <inline-formula><inline-graphic xlink:href="pone.0029175.e062.jpg" mimetype="image"/></inline-formula>.<disp-formula><graphic xlink:href="pone.0029175.e063"/><label>(3)</label></disp-formula><disp-formula><graphic xlink:href="pone.0029175.e064"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0029175.e065.jpg" mimetype="image"/></inline-formula> is generated by <inline-formula><inline-graphic xlink:href="pone.0029175.e066.jpg" mimetype="image"/></inline-formula>.</p><p>By performing an E step that computes<disp-formula><graphic xlink:href="pone.0029175.e067"/><label>(5)</label></disp-formula><disp-formula><graphic xlink:href="pone.0029175.e068"/><label>(6)</label></disp-formula>and a M step which maximizes <inline-formula><inline-graphic xlink:href="pone.0029175.e069.jpg" mimetype="image"/></inline-formula> with constraint: <inline-formula><inline-graphic xlink:href="pone.0029175.e070.jpg" mimetype="image"/></inline-formula>, we have:<disp-formula><graphic xlink:href="pone.0029175.e071"/><label>(7)</label></disp-formula>as the new estimation for <inline-formula><inline-graphic xlink:href="pone.0029175.e072.jpg" mimetype="image"/></inline-formula>.</p><p>The iterative estimation in Equation 7 is intuitively consistent with the case of estimating a distribution based on full samples: consider the scenario in which for each <inline-formula><inline-graphic xlink:href="pone.0029175.e073.jpg" mimetype="image"/></inline-formula>, there is only one <inline-formula><inline-graphic xlink:href="pone.0029175.e074.jpg" mimetype="image"/></inline-formula> satisfying <inline-formula><inline-graphic xlink:href="pone.0029175.e075.jpg" mimetype="image"/></inline-formula>, the right hand side of Equation 7 thus becomes <inline-formula><inline-graphic xlink:href="pone.0029175.e076.jpg" mimetype="image"/></inline-formula>, which is exactly how the distribution estimation problem with traditional full samples can be solved. In the case of partial samples, our solution provides a way to adjust the &#x0201c;weight&#x0201d; each sample <inline-formula><inline-graphic xlink:href="pone.0029175.e077.jpg" mimetype="image"/></inline-formula> contributes to the <inline-formula><inline-graphic xlink:href="pone.0029175.e078.jpg" mimetype="image"/></inline-formula>s of different objects.</p></sec><sec id="s2d"><title>Analyzing the Performance of Estimation</title><p>Given <inline-formula><inline-graphic xlink:href="pone.0029175.e079.jpg" mimetype="image"/></inline-formula> obtained from the MLE solution presented in the previous section, we would like to understand how much this estimate will deviate from the &#x0201c;true&#x0201d; <inline-formula><inline-graphic xlink:href="pone.0029175.e080.jpg" mimetype="image"/></inline-formula> on average. Here we focus on the variance of the <inline-formula><inline-graphic xlink:href="pone.0029175.e081.jpg" mimetype="image"/></inline-formula>, which describes how stable the MLE result is over many different partial sample sets (obtained via additional experiments or re-sampling) drawn from the same isoform set:<disp-formula><graphic xlink:href="pone.0029175.e082"/><label>(8)</label></disp-formula></p><p>As we will show later, although brute-force simulation can be performed to obtain a relatively accurate estimation of this measurement, it is may become computationally intractable when there are too many reads and genes to be considered. We thus propose to use a Fisher information based heuristic for estimating <inline-formula><inline-graphic xlink:href="pone.0029175.e083.jpg" mimetype="image"/></inline-formula>, and present a fast algorithm to compute the exact value of this heuristic.</p><p>We first introduce the Fisher information matrix <xref ref-type="bibr" rid="pone.0029175-Schervish1">[12]</xref>, <xref ref-type="bibr" rid="pone.0029175-VanderVaart1">[13]</xref> as a basis for further discussion. The Fisher information is a way of measuring the amount of information that the random samples <inline-formula><inline-graphic xlink:href="pone.0029175.e084.jpg" mimetype="image"/></inline-formula> carries about the unknown parameter <inline-formula><inline-graphic xlink:href="pone.0029175.e085.jpg" mimetype="image"/></inline-formula> upon which the likelihood function of <inline-formula><inline-graphic xlink:href="pone.0029175.e086.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0029175.e087.jpg" mimetype="image"/></inline-formula>, depends. An important use of the Fisher information matrix in statistical analyses is its contribution to the calculation of the covariance matrices of estimates of parameters fitted by maximium likelihood.</p><p>Let <inline-formula><inline-graphic xlink:href="pone.0029175.e088.jpg" mimetype="image"/></inline-formula> be the free parameters, and <inline-formula><inline-graphic xlink:href="pone.0029175.e089.jpg" mimetype="image"/></inline-formula>.</p><sec id="s2d1"><title>Definition 4</title><p>(Observed Fisher information matrix).<disp-formula><graphic xlink:href="pone.0029175.e090"/><label>(9)</label></disp-formula><disp-formula><graphic xlink:href="pone.0029175.e091"/><label>(10)</label></disp-formula></p></sec><sec id="s2d2"><title>Definition 5</title><p>(Expected Fisher information matrix).<disp-formula><graphic xlink:href="pone.0029175.e092"/><label>(11)</label></disp-formula></p></sec></sec><sec id="s2e"><title>Covariance matrix of the maximum likelihood estimator</title><p>Let <inline-formula><inline-graphic xlink:href="pone.0029175.e093.jpg" mimetype="image"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0029175.e094.jpg" mimetype="image"/></inline-formula>. The Cram&#x000e9;r-Rao bound <xref ref-type="bibr" rid="pone.0029175-VanderVaart1">[13]</xref> states that:<disp-formula><graphic xlink:href="pone.0029175.e095"/><label>(12)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0029175.e096.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0029175.e097.jpg" mimetype="image"/></inline-formula>; <inline-formula><inline-graphic xlink:href="pone.0029175.e098.jpg" mimetype="image"/></inline-formula>.</p><p>We then estimate <inline-formula><inline-graphic xlink:href="pone.0029175.e099.jpg" mimetype="image"/></inline-formula> by <inline-formula><inline-graphic xlink:href="pone.0029175.e100.jpg" mimetype="image"/></inline-formula>, and use the bound above to estimate the covariance matrix:<disp-formula><graphic xlink:href="pone.0029175.e101"/><label>(13)</label></disp-formula></p><p>This means that we only need <inline-formula><inline-graphic xlink:href="pone.0029175.e102.jpg" mimetype="image"/></inline-formula> in order to estimate the performance of our MLE with different sampling method combinations.</p></sec><sec id="s2f"><title>Heuristic for MLE performance estimation</title><p>In order to provide a single value measure for the expected performance of Maximum Likelihood estimation, we propose to use the following heuristic to estimate the average variance of <inline-formula><inline-graphic xlink:href="pone.0029175.e103.jpg" mimetype="image"/></inline-formula>:<disp-formula><graphic xlink:href="pone.0029175.e104"/><label>(14)</label></disp-formula></p><p>This heuristic avoids the potential computational intensive and numerically unstable computation of the inverse of <inline-formula><inline-graphic xlink:href="pone.0029175.e105.jpg" mimetype="image"/></inline-formula>, and is consistent with the theoretical result on the lower-bound of <inline-formula><inline-graphic xlink:href="pone.0029175.e106.jpg" mimetype="image"/></inline-formula> in one dimensional case:<disp-formula><graphic xlink:href="pone.0029175.e107"/><label>(15)</label></disp-formula>which is a specialization of the result in the previous subsection. In other words, the precision to which we can estimate <inline-formula><inline-graphic xlink:href="pone.0029175.e108.jpg" mimetype="image"/></inline-formula> is fundamentally limited by the Fisher information.</p><p>In order to compute this heuristic, all we need is <inline-formula><inline-graphic xlink:href="pone.0029175.e109.jpg" mimetype="image"/></inline-formula> itself. However, the brute-force computation (according to Definition 4 and 5) of this matrix will be time-consuming since its time complexity is proportional to the total number of possible sample sets (which in turn grows exponentially with the number of samples). In the next section, we will present algorithms that can compute this matrix in a more efficient fashion.</p></sec><sec id="s2g"><title>Efficient Computation of <inline-formula><inline-graphic xlink:href="pone.0029175.e110.jpg" mimetype="image"/></inline-formula></title><p>First of all, we can decompose <inline-formula><inline-graphic xlink:href="pone.0029175.e111.jpg" mimetype="image"/></inline-formula> in the following way:<disp-formula><graphic xlink:href="pone.0029175.e112"/><label>(16)</label></disp-formula>where<disp-formula><graphic xlink:href="pone.0029175.e113"/><label>(17)</label></disp-formula>is the expected Fisher information matrix of a single partial sample based on <inline-formula><inline-graphic xlink:href="pone.0029175.e114.jpg" mimetype="image"/></inline-formula>. Thus we need to be able to compute <inline-formula><inline-graphic xlink:href="pone.0029175.e115.jpg" mimetype="image"/></inline-formula> in order to obtain <inline-formula><inline-graphic xlink:href="pone.0029175.e116.jpg" mimetype="image"/></inline-formula>.</p></sec><sec id="s2h"><title>Further decomposing <inline-formula><inline-graphic xlink:href="pone.0029175.e117.jpg" mimetype="image"/></inline-formula></title><p><disp-formula><graphic xlink:href="pone.0029175.e118"/><label>(18)</label></disp-formula>where<disp-formula><graphic xlink:href="pone.0029175.e119"/><label>(19)</label></disp-formula>is the Fisher information matrix of a partial sample <inline-formula><inline-graphic xlink:href="pone.0029175.e120.jpg" mimetype="image"/></inline-formula> from <inline-formula><inline-graphic xlink:href="pone.0029175.e121.jpg" mimetype="image"/></inline-formula> at <inline-formula><inline-graphic xlink:href="pone.0029175.e122.jpg" mimetype="image"/></inline-formula> in <inline-formula><inline-graphic xlink:href="pone.0029175.e123.jpg" mimetype="image"/></inline-formula>.</p><p>A brute-force algorithm for computing <inline-formula><inline-graphic xlink:href="pone.0029175.e124.jpg" mimetype="image"/></inline-formula> can thus be described as follows: <xref ref-type="fig" rid="pone-0029175-g013">Algorithm 1</xref></p><fig id="pone-0029175-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g002</object-id><label>Figure 2</label><caption><title>A simple shotgun read generation model.</title></caption><graphic xlink:href="pone.0029175.g002"/></fig><p>In Algorithm 4, if <inline-formula><inline-graphic xlink:href="pone.0029175.e125.jpg" mimetype="image"/></inline-formula> is the length of a given sequence <inline-formula><inline-graphic xlink:href="pone.0029175.e126.jpg" mimetype="image"/></inline-formula>, then the whole algorithm consists of <inline-formula><inline-graphic xlink:href="pone.0029175.e127.jpg" mimetype="image"/></inline-formula> length(<italic>I</italic><italic><sub>k</sub></italic>) computations of <inline-formula><inline-graphic xlink:href="pone.0029175.e128.jpg" mimetype="image"/></inline-formula>.</p></sec><sec id="s2i"><title>Equivalent partial samples</title><p>In order to continue our discussion on faster algorithms to compute <inline-formula><inline-graphic xlink:href="pone.0029175.e129.jpg" mimetype="image"/></inline-formula>, we introduce the concept of equivalent partial samples below (the relavant proofs can be found in <xref ref-type="supplementary-material" rid="pone.0029175.s001">Text S1</xref>):</p><sec id="s2i1"><title>Definition 6</title><p>Two partial samples <inline-formula><inline-graphic xlink:href="pone.0029175.e130.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0029175.e131.jpg" mimetype="image"/></inline-formula> are equivalent w.r.t. <inline-formula><inline-graphic xlink:href="pone.0029175.e132.jpg" mimetype="image"/></inline-formula> if and only if <inline-formula><inline-graphic xlink:href="pone.0029175.e133.jpg" mimetype="image"/></inline-formula>.</p></sec><sec id="s2i2"><title>Lemma 1</title><p><italic>If </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e134.jpg" mimetype="image"/></inline-formula><italic>, </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e135.jpg" mimetype="image"/></inline-formula><italic>, then </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e136.jpg" mimetype="image"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e137.jpg" mimetype="image"/></inline-formula><italic> are equivalent w.r.t. </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e138.jpg" mimetype="image"/></inline-formula><italic>.</italic></p></sec><sec id="s2i3"><title>Definition 7</title><p>A set of partial samples <inline-formula><inline-graphic xlink:href="pone.0029175.e139.jpg" mimetype="image"/></inline-formula> is an equivalent sample set w.r.t. <inline-formula><inline-graphic xlink:href="pone.0029175.e140.jpg" mimetype="image"/></inline-formula> if and only if <inline-formula><inline-graphic xlink:href="pone.0029175.e141.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0029175.e142.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0029175.e143.jpg" mimetype="image"/></inline-formula> are equivalent w.r.t. <inline-formula><inline-graphic xlink:href="pone.0029175.e144.jpg" mimetype="image"/></inline-formula>.</p></sec><sec id="s2i4"><title>Lemma 2</title><p><italic>Given an isoform </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e145.jpg" mimetype="image"/></inline-formula><italic> and a sampling method </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e146.jpg" mimetype="image"/></inline-formula><italic>, if we divide all its possible partial samples into </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e147.jpg" mimetype="image"/></inline-formula><italic> non-overlapping equivalent sample sets</italic> <inline-formula><inline-graphic xlink:href="pone.0029175.e148.jpg" mimetype="image"/></inline-formula>, <italic>then:</italic><disp-formula><graphic xlink:href="pone.0029175.e149"/><label>(20)</label></disp-formula></p></sec></sec><sec id="s2j"><title>Results from a simple shotgun read generation model</title><p>In this subsection, we consider a simplified partial sample generation model:</p><sec id="s2j1"><title>Definition 8</title><p>A simple shotgun sampling method <inline-formula><inline-graphic xlink:href="pone.0029175.e150.jpg" mimetype="image"/></inline-formula> generates samples with fixed read length <inline-formula><inline-graphic xlink:href="pone.0029175.e151.jpg" mimetype="image"/></inline-formula>. When sampling from an isoform <inline-formula><inline-graphic xlink:href="pone.0029175.e152.jpg" mimetype="image"/></inline-formula> with length <inline-formula><inline-graphic xlink:href="pone.0029175.e153.jpg" mimetype="image"/></inline-formula>, there are in total <inline-formula><inline-graphic xlink:href="pone.0029175.e154.jpg" mimetype="image"/></inline-formula> different samples <inline-formula><inline-graphic xlink:href="pone.0029175.e155.jpg" mimetype="image"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0029175.e156.jpg" mimetype="image"/></inline-formula>; and <inline-formula><inline-graphic xlink:href="pone.0029175.e157.jpg" mimetype="image"/></inline-formula>. Each of these samples has equal probability of being generated from <inline-formula><inline-graphic xlink:href="pone.0029175.e158.jpg" mimetype="image"/></inline-formula>: <inline-formula><inline-graphic xlink:href="pone.0029175.e159.jpg" mimetype="image"/></inline-formula>.</p><p><xref ref-type="fig" rid="pone-0029175-g002">Figure 2</xref> illustrates simple shotgun sampling process and its corresponding per-base coverage on the isoform being sampled.</p><fig id="pone-0029175-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g003</object-id><label>Figure 3</label><caption><title>Equivalent samples in a simple shotgun read generation model.</title></caption><graphic xlink:href="pone.0029175.g003"/></fig></sec><sec id="s2j2"><title>Lemma 3</title><p><italic>Given the sample generation model </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e160.jpg" mimetype="image"/></inline-formula><italic> above, if two samples </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e161.jpg" mimetype="image"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e162.jpg" mimetype="image"/></inline-formula><italic> generated by this method are compatible with the same set of isoforms, i.e. </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e163.jpg" mimetype="image"/></inline-formula><italic>, then </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e164.jpg" mimetype="image"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e165.jpg" mimetype="image"/></inline-formula><italic> are equivalent w.r.t. </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e166.jpg" mimetype="image"/></inline-formula><italic>.</italic></p></sec><sec id="s2j3"><title>Theorem 1</title><p><italic>Given the sample generation model </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e167.jpg" mimetype="image"/></inline-formula><italic> above, if two samples </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e168.jpg" mimetype="image"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e169.jpg" mimetype="image"/></inline-formula><italic> generated by this method overlap with all the junctions in the same set of connected exons </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e170.jpg" mimetype="image"/></inline-formula><italic>, then </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e171.jpg" mimetype="image"/></inline-formula><italic> and </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e172.jpg" mimetype="image"/></inline-formula><italic> are equivalent w.r.t. </italic><inline-formula><inline-graphic xlink:href="pone.0029175.e173.jpg" mimetype="image"/></inline-formula><italic>.</italic></p><p>For example, in <xref ref-type="fig" rid="pone-0029175-g003">Figure 3</xref>, where the reads are generated from a simple shotgun sampling process, the equivalent partial samples are -read<inline-formula><inline-graphic xlink:href="pone.0029175.e174.jpg" mimetype="image"/></inline-formula>, read<inline-formula><inline-graphic xlink:href="pone.0029175.e175.jpg" mimetype="image"/></inline-formula>, read<inline-formula><inline-graphic xlink:href="pone.0029175.e176.jpg" mimetype="image"/></inline-formula>}, -read<inline-formula><inline-graphic xlink:href="pone.0029175.e177.jpg" mimetype="image"/></inline-formula>, read<inline-formula><inline-graphic xlink:href="pone.0029175.e178.jpg" mimetype="image"/></inline-formula>}. Also, if we consider a paired-end read as a long shotgun read with its gap filled, the samples read<inline-formula><inline-graphic xlink:href="pone.0029175.e179.jpg" mimetype="image"/></inline-formula> and read<inline-formula><inline-graphic xlink:href="pone.0029175.e180.jpg" mimetype="image"/></inline-formula> are also (approximately) equivalent, if their insert sizes are close to each other. However, read<inline-formula><inline-graphic xlink:href="pone.0029175.e181.jpg" mimetype="image"/></inline-formula> is not equivalent to these reads, since its shotgun version overlaps with a different exon junction set (with an addition exon).</p><fig id="pone-0029175-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g004</object-id><label>Figure 4</label><caption><title>Results on simplified genes.</title><p>(a) Results on gene A (b) Results on gene B (c) Results on gene C.</p></caption><graphic xlink:href="pone.0029175.g004"/></fig></sec></sec><sec id="s2k"><title>Algorithms for efficiently computing <inline-formula><inline-graphic xlink:href="pone.0029175.e182.jpg" mimetype="image"/></inline-formula></title><p>Based on Definition 8 and Theorem 1, we can design the following algorithm for efficiently computing <inline-formula><inline-graphic xlink:href="pone.0029175.e183.jpg" mimetype="image"/></inline-formula> by combining the computation of this value for equivalent partial samples from each isoform. <xref ref-type="fig" rid="pone-0029175-g014">Algorithm 2</xref></p><fig id="pone-0029175-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g005</object-id><label>Figure 5</label><caption><title>Computations on gene TCF7.</title><p>(a) Known isoforms (b) Splicing graph (c) Simulation schema.</p></caption><graphic xlink:href="pone.0029175.g005"/></fig><p>In Algorithm 2, <inline-formula><inline-graphic xlink:href="pone.0029175.e184.jpg" mimetype="image"/></inline-formula> identifies the connected exons set in <inline-formula><inline-graphic xlink:href="pone.0029175.e185.jpg" mimetype="image"/></inline-formula> that overlaps with a given partial sample <inline-formula><inline-graphic xlink:href="pone.0029175.e186.jpg" mimetype="image"/></inline-formula>, and can be implemented with <inline-formula><inline-graphic xlink:href="pone.0029175.e187.jpg" mimetype="image"/></inline-formula> time complexity by pre-computing an exon-position index table for the isoforms.</p><p>We can further reduce the number of times of computing <inline-formula><inline-graphic xlink:href="pone.0029175.e188.jpg" mimetype="image"/></inline-formula> by combining equivalent partial samples from across isoforms: when an equivalent sample set from an isoform has been identified, all the same samples from other isoforms can be recorded in lists of intervals to avoid redundant computation of their <inline-formula><inline-graphic xlink:href="pone.0029175.e189.jpg" mimetype="image"/></inline-formula>s. The algorithm is shown below: <xref ref-type="fig" rid="pone-0029175-g015">Algorithm 3</xref></p><fig id="pone-0029175-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g006</object-id><label>Figure 6</label><caption><title>Speedup in FIM computation for gene TCF7.</title></caption><graphic xlink:href="pone.0029175.g006"/></fig><p>In Algorithm 3, <inline-formula><inline-graphic xlink:href="pone.0029175.e190.jpg" mimetype="image"/></inline-formula> finds the minimum position <inline-formula><inline-graphic xlink:href="pone.0029175.e191.jpg" mimetype="image"/></inline-formula> that is outside a given interval list <inline-formula><inline-graphic xlink:href="pone.0029175.e192.jpg" mimetype="image"/></inline-formula>; <inline-formula><inline-graphic xlink:href="pone.0029175.e193.jpg" mimetype="image"/></inline-formula> returns the partial sample <inline-formula><inline-graphic xlink:href="pone.0029175.e194.jpg" mimetype="image"/></inline-formula> from <inline-formula><inline-graphic xlink:href="pone.0029175.e195.jpg" mimetype="image"/></inline-formula> covering all the exon junctions in <inline-formula><inline-graphic xlink:href="pone.0029175.e196.jpg" mimetype="image"/></inline-formula> with a minimum <inline-formula><inline-graphic xlink:href="pone.0029175.e197.jpg" mimetype="image"/></inline-formula>, and can be implemented with a worst-case <inline-formula><inline-graphic xlink:href="pone.0029175.e198.jpg" mimetype="image"/></inline-formula> time complexity by using a pre-computed exon position index table for the isoforms.</p></sec><sec id="s2l"><title>Complexity analysis</title><p>Given a set of <inline-formula><inline-graphic xlink:href="pone.0029175.e199.jpg" mimetype="image"/></inline-formula> possible isoforms <inline-formula><inline-graphic xlink:href="pone.0029175.e200.jpg" mimetype="image"/></inline-formula>, with lengths <inline-formula><inline-graphic xlink:href="pone.0029175.e201.jpg" mimetype="image"/></inline-formula>, respectively, and a shotgun sampling method <inline-formula><inline-graphic xlink:href="pone.0029175.e202.jpg" mimetype="image"/></inline-formula> with sample read length <inline-formula><inline-graphic xlink:href="pone.0029175.e203.jpg" mimetype="image"/></inline-formula> as described in Definition 8, Algorithm 1 requires <inline-formula><inline-graphic xlink:href="pone.0029175.e204.jpg" mimetype="image"/></inline-formula> steps of computing <inline-formula><inline-graphic xlink:href="pone.0029175.e205.jpg" mimetype="image"/></inline-formula>. Thus computing <inline-formula><inline-graphic xlink:href="pone.0029175.e206.jpg" mimetype="image"/></inline-formula> using this brute-force algorithm requires <inline-formula><inline-graphic xlink:href="pone.0029175.e207.jpg" mimetype="image"/></inline-formula> operations of calculating <inline-formula><inline-graphic xlink:href="pone.0029175.e208.jpg" mimetype="image"/></inline-formula>. If we assume that the average length of an isoform is <inline-formula><inline-graphic xlink:href="pone.0029175.e209.jpg" mimetype="image"/></inline-formula>, this corresponds to <inline-formula><inline-graphic xlink:href="pone.0029175.e210.jpg" mimetype="image"/></inline-formula> computations of <inline-formula><inline-graphic xlink:href="pone.0029175.e211.jpg" mimetype="image"/></inline-formula>.</p><p>Suppose that on average an isoform can be divided into <inline-formula><inline-graphic xlink:href="pone.0029175.e212.jpg" mimetype="image"/></inline-formula> equivalent sample sets by Algorithm 2, this algorithm will then require <inline-formula><inline-graphic xlink:href="pone.0029175.e213.jpg" mimetype="image"/></inline-formula> steps of computing <inline-formula><inline-graphic xlink:href="pone.0029175.e214.jpg" mimetype="image"/></inline-formula> to obtain the Fisher information matrix <inline-formula><inline-graphic xlink:href="pone.0029175.e215.jpg" mimetype="image"/></inline-formula> for the given sampling method, thus being more efficient than Algorithm 1 by a ratio of <inline-formula><inline-graphic xlink:href="pone.0029175.e216.jpg" mimetype="image"/></inline-formula>. Algorithm 3 will obviously be even more efficient by avoiding the redundant computation of some of the equivalent sample sets in Algorithm 2.</p></sec><sec id="s2m"><title>Using more complex <inline-formula><inline-graphic xlink:href="pone.0029175.e217.jpg" mimetype="image"/></inline-formula> function in Algorithm 3</title><p>The sequencing technology being used in an RNA-Seq experiment is usually more complicated than the simplified <inline-formula><inline-graphic xlink:href="pone.0029175.e218.jpg" mimetype="image"/></inline-formula> function described in Definition 8, which assumes equal sample-length and uniform generative probability. In reality, a typical <inline-formula><inline-graphic xlink:href="pone.0029175.e219.jpg" mimetype="image"/></inline-formula> usually involves reads with different lengths within a certain range, and also biased sample generation probability at different locations of a full-length isoform. Although once such a <inline-formula><inline-graphic xlink:href="pone.0029175.e220.jpg" mimetype="image"/></inline-formula> is defined, our MLE solution can treat it in the same way as it does for simplified versions, Algorithm 3 no longer works &#x0201c;out of the box&#x0201d; due to its dependency on Definition 8 to find equivalent partial samples. We discuss briefly in this subsection on how to handle more complex features.</p><p>When the assumption of uniform sample generation still holds, it is straightforward to handle samples with different lengths in FIM computation. We can treat one sampling method as a combination of multiple simplified methods as in Definition 8, with different sample lengths <inline-formula><inline-graphic xlink:href="pone.0029175.e221.jpg" mimetype="image"/></inline-formula>:<disp-formula><graphic xlink:href="pone.0029175.e222"/><label>(21)</label></disp-formula><disp-formula><graphic xlink:href="pone.0029175.e223"/><label>(22)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0029175.e224.jpg" mimetype="image"/></inline-formula> represents the probability of generating a sample with length <inline-formula><inline-graphic xlink:href="pone.0029175.e225.jpg" mimetype="image"/></inline-formula> in sampling method <inline-formula><inline-graphic xlink:href="pone.0029175.e226.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0029175.e227.jpg" mimetype="image"/></inline-formula> is a sample with length <inline-formula><inline-graphic xlink:href="pone.0029175.e228.jpg" mimetype="image"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0029175.e229.jpg" mimetype="image"/></inline-formula> is the simplified sample generation probability as in Definition 8, with sample length <inline-formula><inline-graphic xlink:href="pone.0029175.e230.jpg" mimetype="image"/></inline-formula>.</p><p>In the case of non-uniform sample generation along the isoform, if <inline-formula><inline-graphic xlink:href="pone.0029175.e231.jpg" mimetype="image"/></inline-formula> is a step function (piece-wise constant function) for sample <inline-formula><inline-graphic xlink:href="pone.0029175.e232.jpg" mimetype="image"/></inline-formula> along isoform <inline-formula><inline-graphic xlink:href="pone.0029175.e233.jpg" mimetype="image"/></inline-formula>, we will still be able to find equivalent sample sets as described in Definition 7, based on both the isoform structures and the intervals in <inline-formula><inline-graphic xlink:href="pone.0029175.e234.jpg" mimetype="image"/></inline-formula>. If, however, very few such constant components exist in <inline-formula><inline-graphic xlink:href="pone.0029175.e235.jpg" mimetype="image"/></inline-formula>, we will need to relax the definition of equivalent partial samples to satisfying <inline-formula><inline-graphic xlink:href="pone.0029175.e236.jpg" mimetype="image"/></inline-formula> only. With this relaxed definition, we can find samples <inline-formula><inline-graphic xlink:href="pone.0029175.e237.jpg" mimetype="image"/></inline-formula> with equivalent structural similarities to all the isoforms. In this case, if the isoforms contain regions where any <inline-formula><inline-graphic xlink:href="pone.0029175.e238.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0029175.e239.jpg" mimetype="image"/></inline-formula> from it satisfy <inline-formula><inline-graphic xlink:href="pone.0029175.e240.jpg" mimetype="image"/></inline-formula> with a constant <inline-formula><inline-graphic xlink:href="pone.0029175.e241.jpg" mimetype="image"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="pone.0029175.e242.jpg" mimetype="image"/></inline-formula>, we still have <inline-formula><inline-graphic xlink:href="pone.0029175.e243.jpg" mimetype="image"/></inline-formula> according to Equation 19, and the <inline-formula><inline-graphic xlink:href="pone.0029175.e244.jpg" mimetype="image"/></inline-formula> can thus be efficiently computed using a variant of Algorithm 3 by combining the computation for such equivalent partial samples. For more complex <inline-formula><inline-graphic xlink:href="pone.0029175.e245.jpg" mimetype="image"/></inline-formula> functions, however, approximation algorithms may have to be introduced for fast computation of <inline-formula><inline-graphic xlink:href="pone.0029175.e246.jpg" mimetype="image"/></inline-formula>.</p></sec></sec><sec id="s3"><title>Results</title><sec id="s3a"><title>Simulation Results</title><p>Here we present our results on a set of simulated datasets. In order to demonstrate the accuracy and efficiency of the methods we developed, we first use simulations to show the performance of our approach on simplified gene models and a real gene. These simulations are useful in designing optimal sequencing experiments for isoform quantification.</p></sec><sec id="s3b"><title>Simulation on simplified genes</title><p>Due to the complexity of real gene structure, we apply our methods to three artificially constructed genes with simplified isoform structures, so as to better illustrate how different characteristics of the gene structures can affect the outcome of the isoform quantification analysis.</p><p>As shown in <xref ref-type="fig" rid="pone-0029175-g004">Figure 4A</xref>, each of these genes has two different isoforms, with the more abundant one shown in a darker color. Two sampling techniques, short single and short paired-end (PE), are used to generate reads from them, with a fixed total cost of $<inline-formula><inline-graphic xlink:href="pone.0029175.e247.jpg" mimetype="image"/></inline-formula> (roughly corresponding to <inline-formula><inline-graphic xlink:href="pone.0029175.e248.jpg" mimetype="image"/></inline-formula> medium length reads with average size of <inline-formula><inline-graphic xlink:href="pone.0029175.e249.jpg" mimetype="image"/></inline-formula> bp (<inline-formula><inline-graphic xlink:href="pone.0029175.e250.jpg" mimetype="image"/></inline-formula>&#x000d7; coverage on the simplied genes), or <inline-formula><inline-graphic xlink:href="pone.0029175.e251.jpg" mimetype="image"/></inline-formula> short reads with average length of <inline-formula><inline-graphic xlink:href="pone.0029175.e252.jpg" mimetype="image"/></inline-formula> bp (<inline-formula><inline-graphic xlink:href="pone.0029175.e253.jpg" mimetype="image"/></inline-formula>x)). The per-base costs of these sampling techniques are based on <xref ref-type="bibr" rid="pone.0029175-Du1">[14]</xref>. Different cost combinations, e.g. different percentage of the total cost being assigned to a certain sampling technique, are illustrated by the <inline-formula><inline-graphic xlink:href="pone.0029175.e254.jpg" mimetype="image"/></inline-formula>-axis in <xref ref-type="fig" rid="pone-0029175-g004">Figure 4B&#x02013;D</xref>. For each of these cost combinations, we randomly generate <inline-formula><inline-graphic xlink:href="pone.0029175.e255.jpg" mimetype="image"/></inline-formula> read sets, and use the MLE solution to estimate <inline-formula><inline-graphic xlink:href="pone.0029175.e256.jpg" mimetype="image"/></inline-formula>, based on which <inline-formula><inline-graphic xlink:href="pone.0029175.e257.jpg" mimetype="image"/></inline-formula> are computed (solid lines in <xref ref-type="fig" rid="pone-0029175-g004">Figure 4B&#x02013;D</xref>). We also use Algorithm 3 to estimate the same quantity, and plot the estimations using dashed lines in the same figure for comparison. The results show that the FIM estimation of <inline-formula><inline-graphic xlink:href="pone.0029175.e258.jpg" mimetype="image"/></inline-formula> are close to the direct simulation results, and also correctly predicts the trend in how this value changes with different cost combinations. Also, different gene structures have noticeable impact on the MLE accuracy, mostly due to the ability of sampling techniques to distinguish isoforms from each other with different gene structures.</p><fig id="pone-0029175-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g007</object-id><label>Figure 7</label><caption><title>Simulation results on TCF7.</title><p>(a) Results on all possible isoforms (b) Results on known isoforms.</p></caption><graphic xlink:href="pone.0029175.g007"/></fig><p>Not only can the FIM based heuristic correctly approximate how the performance of MLE changes with regard to different sampling technique combinations, it is also able to dramatically shorten the time of computation, as shown in <xref ref-type="table" rid="pone-0029175-t001">Table 1</xref>. This is mainly because while the computation of brute-force simulation depends heavily on the number of reads being generated and the number of trials needed to obtain a relatively stable estimation of <inline-formula><inline-graphic xlink:href="pone.0029175.e259.jpg" mimetype="image"/></inline-formula>, the core computation taken by the FIM based heuristic is the evaluation of individual FIMs for the sampling techniques involved, which can be efficiently computed using Algorithm 3, and then combined based on Equation 16 to estimate <inline-formula><inline-graphic xlink:href="pone.0029175.e260.jpg" mimetype="image"/></inline-formula> under different cost combinations. Being able to do these simulations fast is useful in designing optimal expriments.</p><table-wrap id="pone-0029175-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.t001</object-id><label>Table 1</label><caption><title>Total time used by brute-force simulation vs. FIM based heuristic to estimate <inline-formula><inline-graphic xlink:href="pone.0029175.e261.jpg" mimetype="image"/></inline-formula> in simplified genes.</title></caption><alternatives><graphic id="pone-0029175-t001-1" xlink:href="pone.0029175.t001"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/></colgroup><tbody><tr><td align="left" rowspan="1" colspan="1"><bold>Total trials for one gene</bold></td><td align="left" rowspan="1" colspan="1">Number of trials<inline-formula><inline-graphic xlink:href="pone.0029175.e262.jpg" mimetype="image"/></inline-formula>Number of sampling method combinations<inline-formula><inline-graphic xlink:href="pone.0029175.e263.jpg" mimetype="image"/></inline-formula></td></tr><tr><td align="left" rowspan="1" colspan="1"><bold>Total FIM computation for one gene</bold></td><td align="left" rowspan="1" colspan="1">Number of sampling methods<inline-formula><inline-graphic xlink:href="pone.0029175.e264.jpg" mimetype="image"/></inline-formula></td></tr><tr><td align="left" rowspan="1" colspan="1"><bold>Total CPU time used by brute-force simulation</bold></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0029175.e265.jpg" mimetype="image"/></inline-formula> minutes</td></tr><tr><td align="left" rowspan="1" colspan="1"><bold>Total CPU time used by FIM based heuristic</bold></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0029175.e266.jpg" mimetype="image"/></inline-formula> second</td></tr></tbody></table></alternatives></table-wrap></sec><sec id="s3c"><title>Efficiently Estimating quantification error: Application on a typical gene</title><p>We have developed a Fisher information matrix (FIM) based fast algorithm (Algorithm 3 in <xref ref-type="sec" rid="s2">Methods</xref> section) for estimating the quantification error in <inline-formula><inline-graphic xlink:href="pone.0029175.e267.jpg" mimetype="image"/></inline-formula>, and compared its speed with two other benchmark algorithms. Here we consider the gene <inline-formula><inline-graphic xlink:href="pone.0029175.e268.jpg" mimetype="image"/></inline-formula>, which has <inline-formula><inline-graphic xlink:href="pone.0029175.e269.jpg" mimetype="image"/></inline-formula> known isoforms shown in <xref ref-type="fig" rid="pone-0029175-g005">Figure 5A</xref>. <xref ref-type="fig" rid="pone-0029175-g005">Figure 5B</xref> shows its corresponding splicing graph <xref ref-type="bibr" rid="pone.0029175-Xing1">[6]</xref>, <xref ref-type="bibr" rid="pone.0029175-Heber1">[15]</xref>, with <inline-formula><inline-graphic xlink:href="pone.0029175.e270.jpg" mimetype="image"/></inline-formula> exon blocks, and <inline-formula><inline-graphic xlink:href="pone.0029175.e271.jpg" mimetype="image"/></inline-formula> possible isoforms, which are all the possible paths from node &#x0201c;START&#x0201d; to node &#x0201c;END&#x0201d; in the splicing graph. <xref ref-type="fig" rid="pone-0029175-g005">Figure 5C</xref> shows the brute-force way and Fisher information based method to estimate <inline-formula><inline-graphic xlink:href="pone.0029175.e272.jpg" mimetype="image"/></inline-formula>.</p><fig id="pone-0029175-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g008</object-id><label>Figure 8</label><caption><title>Simulation results on TCF7 with paired-end reads.</title></caption><graphic xlink:href="pone.0029175.g008"/></fig><p>When computing the expected Fisher information matrix <inline-formula><inline-graphic xlink:href="pone.0029175.e273.jpg" mimetype="image"/></inline-formula>, a brute-force algorithm (Algorithm 1) requires <inline-formula><inline-graphic xlink:href="pone.0029175.e274.jpg" mimetype="image"/></inline-formula> computations of the observed Fisher information matrix <inline-formula><inline-graphic xlink:href="pone.0029175.e275.jpg" mimetype="image"/></inline-formula>, while an improved algorithm developed by us (Algorithm 2) involves <inline-formula><inline-graphic xlink:href="pone.0029175.e276.jpg" mimetype="image"/></inline-formula> such computations, and the number for our final algorithm (Algorithm 3) is <inline-formula><inline-graphic xlink:href="pone.0029175.e277.jpg" mimetype="image"/></inline-formula>, achieving a <inline-formula><inline-graphic xlink:href="pone.0029175.e278.jpg" mimetype="image"/></inline-formula> times speedup compared to the brute-force method. A summary of the speedups is shown in <xref ref-type="fig" rid="pone-0029175-g006">Figure 6</xref>. Note that theoretical speedup is calculated based on the number of key computational steps (per-read FIM computation), while the actual speedup depends on the software implementation of all steps in the algorithm.</p><fig id="pone-0029175-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g009</object-id><label>Figure 9</label><caption><title>Isoform composition in two stages.</title><p>(a) Gene 14047 in two stages ( <italic>Diff</italic><inline-formula><inline-graphic xlink:href="pone.0029175.e279.jpg" mimetype="image"/></inline-formula>) (b) Gene 7649 in two stages ( <italic>Diff</italic><inline-formula><inline-graphic xlink:href="pone.0029175.e280.jpg" mimetype="image"/></inline-formula>).</p></caption><graphic xlink:href="pone.0029175.g009"/></fig></sec><sec id="s3d"><title>Integrated analysis with multiple sequencing technologies: Simulation on a typical gene</title><p>We present in this section the application of the FIM based heuristic on a real gene, and compared the results to the ones obtained from direct simulations. We pick TCF7 again as a typical example gene with multiple isoforms. Similarly to our procedure in the section on simplified genes, two sampling techniques, medium and short shotgun sequencing (with average length of <inline-formula><inline-graphic xlink:href="pone.0029175.e281.jpg" mimetype="image"/></inline-formula> bp and <inline-formula><inline-graphic xlink:href="pone.0029175.e282.jpg" mimetype="image"/></inline-formula> bp, $<inline-formula><inline-graphic xlink:href="pone.0029175.e283.jpg" mimetype="image"/></inline-formula> and $<inline-formula><inline-graphic xlink:href="pone.0029175.e284.jpg" mimetype="image"/></inline-formula> per <inline-formula><inline-graphic xlink:href="pone.0029175.e285.jpg" mimetype="image"/></inline-formula> million base cost respectively), are used to generate reads from them, with a fixed total cost of $<inline-formula><inline-graphic xlink:href="pone.0029175.e286.jpg" mimetype="image"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="pone.0029175.e287.jpg" mimetype="image"/></inline-formula> trials being conducted for each cost combination. Two different sets of results are shown in <xref ref-type="fig" rid="pone-0029175-g007">Figure 7</xref>, one using all the <inline-formula><inline-graphic xlink:href="pone.0029175.e288.jpg" mimetype="image"/></inline-formula> possible isoforms deduced from its splicing graph, and the other just using its <inline-formula><inline-graphic xlink:href="pone.0029175.e289.jpg" mimetype="image"/></inline-formula> known isoforms. As in the previous section, the results here show that the FIM estimation of <inline-formula><inline-graphic xlink:href="pone.0029175.e290.jpg" mimetype="image"/></inline-formula> are close to the direct simulation results, and also correctly predicts the trend in how this value changes with different cost combinations.</p><fig id="pone-0029175-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g010</object-id><label>Figure 10</label><caption><title><italic>Diff</italic> of all genes across four stages.</title></caption><graphic xlink:href="pone.0029175.g010"/></fig><p><xref ref-type="fig" rid="pone-0029175-g008">Figure 8</xref> presents a more detailed simulation focusing on short paired-end reads. The <inline-formula><inline-graphic xlink:href="pone.0029175.e291.jpg" mimetype="image"/></inline-formula> value reflects the expectation of the variance in insert size for such experiments: a <inline-formula><inline-graphic xlink:href="pone.0029175.e292.jpg" mimetype="image"/></inline-formula> value means that all the paired-end reads are expected to have exactly the same insert size; the higher the <inline-formula><inline-graphic xlink:href="pone.0029175.e293.jpg" mimetype="image"/></inline-formula> is, the more relaxed are we on the insert size variation (i.e. if the distance of the mapped positions of the two ends of a read on a transcript is within the expected insert size <inline-formula><inline-graphic xlink:href="pone.0029175.e294.jpg" mimetype="image"/></inline-formula> a &#x0201c;tolerated&#x0201d; ratio, the paired-end read will be considered &#x0201c;compatible&#x0201d; with the transcript). As we can see from this figure, the higher the <inline-formula><inline-graphic xlink:href="pone.0029175.e295.jpg" mimetype="image"/></inline-formula>, the larger <inline-formula><inline-graphic xlink:href="pone.0029175.e296.jpg" mimetype="image"/></inline-formula> becomes, corresponding to a worse expected performance of MLE. This can be explained by the fact that a higher <inline-formula><inline-graphic xlink:href="pone.0029175.e297.jpg" mimetype="image"/></inline-formula> makes the sampling method less capable of distinguishing highly similar isoforms from each other based on a single paired-end read (e.g. GeneA in <xref ref-type="fig" rid="pone-0029175-g004">Figure 4A</xref>). The FIM based heuristic is again able to correctly depict the different trends of MLE performance under different cost combinations and <inline-formula><inline-graphic xlink:href="pone.0029175.e298.jpg" mimetype="image"/></inline-formula> settings.</p><fig id="pone-0029175-g011" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g011</object-id><label>Figure 11</label><caption><title>Gene 7649: Leave out one isoform, or add a &#x0201c;dummy&#x0201d; isoform.</title><p>(a) Standard calculation with all isoforms: <inline-formula><inline-graphic xlink:href="pone.0029175.e299.jpg" mimetype="image"/></inline-formula> (b) Leave out the dominant isoform: <inline-formula><inline-graphic xlink:href="pone.0029175.e300.jpg" mimetype="image"/></inline-formula> (c) Leave out a non-dominant isoform: <inline-formula><inline-graphic xlink:href="pone.0029175.e301.jpg" mimetype="image"/></inline-formula> (d) Add a &#x0201c;dummy&#x0201d; isoform: <inline-formula><inline-graphic xlink:href="pone.0029175.e302.jpg" mimetype="image"/></inline-formula>.</p></caption><graphic xlink:href="pone.0029175.g011"/></fig><p>We also show the computation time used by brute-force simulation and FIM based heuristic in <xref ref-type="table" rid="pone-0029175-t002">Table 2</xref>. Note that the brute-force simulation is even more computational consuming, mainly because more isoforms are involved in the MLE process. Given the fact that there exist more than <inline-formula><inline-graphic xlink:href="pone.0029175.e303.jpg" mimetype="image"/></inline-formula> genes in the human genome and that the simulation has to be rerun for every new experiment to adjust its read counts (the number of reads attributed to a gene region in the experiment), using the FIM based heuristic instead for the purpose of estimating isoform quantification accuracy is obviously a more computationally tractable choice.</p><table-wrap id="pone-0029175-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.t002</object-id><label>Table 2</label><caption><title>Total time used by brute-force simulation vs. FIM based heuristic to estimate <inline-formula><inline-graphic xlink:href="pone.0029175.e304.jpg" mimetype="image"/></inline-formula> in TCF7.</title></caption><alternatives><graphic id="pone-0029175-t002-2" xlink:href="pone.0029175.t002"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/></colgroup><tbody><tr><td align="left" rowspan="1" colspan="1"><bold>Total trials for one gene</bold></td><td align="left" rowspan="1" colspan="1">Number of trials<inline-formula><inline-graphic xlink:href="pone.0029175.e305.jpg" mimetype="image"/></inline-formula>Number of sampling method combinations<inline-formula><inline-graphic xlink:href="pone.0029175.e306.jpg" mimetype="image"/></inline-formula></td></tr><tr><td align="left" rowspan="1" colspan="1"><bold>Total FIM computation for one gene</bold></td><td align="left" rowspan="1" colspan="1">Number of sampling methods<inline-formula><inline-graphic xlink:href="pone.0029175.e307.jpg" mimetype="image"/></inline-formula></td></tr><tr><td align="left" rowspan="1" colspan="1"><bold>Total CPU time used by brute-force simulation</bold></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0029175.e308.jpg" mimetype="image"/></inline-formula> hours</td></tr><tr><td align="left" rowspan="1" colspan="1"><bold>Total CPU time used by FIM based heuristic</bold></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0029175.e309.jpg" mimetype="image"/></inline-formula> second</td></tr></tbody></table></alternatives></table-wrap></sec><sec id="s3e"><title>Application to a model-organism (worm) dataset</title><p>To illustrate how we can interpret the <inline-formula><inline-graphic xlink:href="pone.0029175.e310.jpg" mimetype="image"/></inline-formula> values output, we further apply our MLE solution to a worm dataset <xref ref-type="bibr" rid="pone.0029175-Hillier1">[16]</xref>&#x02013;<xref ref-type="bibr" rid="pone.0029175-Gerstein2">[18]</xref>, which is a well-studied model organism. which is a well-studied model organism. The worm has intermediate complexity in isoform structures. It has isoforms but they are significantly simpler in structure than in human, leading to interpretability in the results. This dataset includes multiple developmental stages, and we were able to compare the results on a same set of isoforms under different conditions. The worm genome contains <inline-formula><inline-graphic xlink:href="pone.0029175.e311.jpg" mimetype="image"/></inline-formula> K genes, and the transcripts from each stage are sequenced with <inline-formula><inline-graphic xlink:href="pone.0029175.e312.jpg" mimetype="image"/></inline-formula> M short Solexa reads. This dataset is particularly useful for isoform comparison since it contains multiple stages of splicing events that are not overly complex.</p></sec><sec id="s3f"><title>Dataset description</title><p>Whole transcriptome sequencing data for worm L2, L3, L4 and Young Adult stages, each stage with on average 50 M reads. The annotation set (derived from the modENCODE project, <xref ref-type="bibr" rid="pone.0029175-Celniker1">[17]</xref>, <xref ref-type="bibr" rid="pone.0029175-Gerstein2">[18]</xref>) has 21774 total genes. Of these, 12875 genes has multiple isoforms, with an average of 4.344 isoforms per gene.</p></sec><sec id="s3g"><title>Comparison of isoform composition between stages</title><p>We first present the isoform quantification results on individual genes in two different stages, early embryo (EE) and late embryo (LE), to briefly illustrate the fact that different genes have different isoform composition differences between stages. Here we use the following formula to measure the difference in isoform composition of the same gene in two different stages:<disp-formula><graphic xlink:href="pone.0029175.e313"/><label>(23)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0029175.e314.jpg" mimetype="image"/></inline-formula> is the total number of isoforms in gene <inline-formula><inline-graphic xlink:href="pone.0029175.e315.jpg" mimetype="image"/></inline-formula>.</p><p><xref ref-type="fig" rid="pone-0029175-g009">Figure 9</xref> shows two examples of zero and non-zero <italic>Diff</italic> values. The reads are plotted below the isoforms, and the numbers associated with the isoforms are their estimated relative abundances based on MLE. Furthermore, if we compute such values for all the genes in these two stages, we can get a histogram of isoform composition differences as illustrated in <xref ref-type="fig" rid="pone-0029175-g010">Figure 10</xref>, which characterizes the general isoform composition difference between stages. The distribution of differences in relative isoform composition for genes is shown: Isoform quantification was applied to RNA-Seq data in 4 developmental stages in worm (L2, L3, L4, YA) and <italic>Diff</italic> score was calculated for each gene in all 6 pairwise comparisons. Because isoform quantification is noisy for genes expressed at very low level, we plotted the distribution for genes that have at least an RPKM value of <inline-formula><inline-graphic xlink:href="pone.0029175.e316.jpg" mimetype="image"/></inline-formula> here (RPKM for a gene is the sum of RPKMs of all its isoforms). Red bars represent the average number of genes within the respective <italic>Diff</italic> score range, while error bars indicate the maximum and minimum numbers. <italic>Diff</italic> scores close to <inline-formula><inline-graphic xlink:href="pone.0029175.e317.jpg" mimetype="image"/></inline-formula> indicate big changes in isoform composition, or the relative expression level of isoforms between stages. The histogram indicates that only a few genes (<inline-formula><inline-graphic xlink:href="pone.0029175.e318.jpg" mimetype="image"/></inline-formula>) show dramatic differences in isoform expression between stages. (The number <inline-formula><inline-graphic xlink:href="pone.0029175.e319.jpg" mimetype="image"/></inline-formula> is derived from a cutoff of <inline-formula><inline-graphic xlink:href="pone.0029175.e320.jpg" mimetype="image"/></inline-formula> on the <italic>Diff</italic> score.) In <xref ref-type="table" rid="pone-0029175-t003">Table 3</xref>, we include a classification of the structural difference (5&#x02032; UTR, 3&#x02032; UTR, alternative exon, etc.), between the dominant transcripts in such genes with different isoform compositions. When the different dominant isoforms from a gene differ in two aspects, we assign <inline-formula><inline-graphic xlink:href="pone.0029175.e321.jpg" mimetype="image"/></inline-formula> to each category. As shown in this table, many of the structural differences are due to either Distinct 5&#x02032; UTR or Overlapping 3&#x02032; UTR. We have also included in the supplementary website (<ext-link ext-link-type="uri" xlink:href="http://archive.gersteinlab.org/proj/rnaseq/IQSeq">http://archive.gersteinlab.org/proj/rnaseq/IQSeq</ext-link>) the genes with stage-wise isoform composition differences, ranked by their FIM based estimation variances, and with a thresholded on <italic>Diff</italic> score and RPKM at <inline-formula><inline-graphic xlink:href="pone.0029175.e322.jpg" mimetype="image"/></inline-formula>.</p><fig id="pone-0029175-g012" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g012</object-id><label>Figure 12</label><caption><title>Comparison between IQSeq and Cufflinks.</title></caption><graphic xlink:href="pone.0029175.g012"/></fig><fig id="pone-0029175-g013" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g013</object-id><label>Algorithm 1</label><caption><title>BruteForceFIM (<italic>I,</italic>&#x00398;<italic>,Samp<sub>m</sub>,p,q</italic>)</title></caption><graphic xlink:href="pone.0029175.g013"/></fig><table-wrap id="pone-0029175-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.t003</object-id><label>Table 3</label><caption><title>Classification of different isoform composition between stages.</title></caption><alternatives><graphic id="pone-0029175-t003-3" xlink:href="pone.0029175.t003"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1">Type</td><td align="left" rowspan="1" colspan="1">L3 vs L2</td><td align="left" rowspan="1" colspan="1">L4 vs L2</td><td align="left" rowspan="1" colspan="1">L4 vs L3</td><td align="left" rowspan="1" colspan="1">YA vs L2</td><td align="left" rowspan="1" colspan="1">YA vs L3</td><td align="left" rowspan="1" colspan="1">YA vs L4</td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1"><bold>Overlapping 5&#x02032; UTR</bold></td><td align="left" rowspan="1" colspan="1">6.5</td><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1">2.5</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">4.5</td><td align="left" rowspan="1" colspan="1">2.5</td></tr><tr><td align="left" rowspan="1" colspan="1"><bold>Distinct 5&#x02032; UTR</bold></td><td align="left" rowspan="1" colspan="1">7.5</td><td align="left" rowspan="1" colspan="1">26</td><td align="left" rowspan="1" colspan="1">13.5</td><td align="left" rowspan="1" colspan="1">20</td><td align="left" rowspan="1" colspan="1">11</td><td align="left" rowspan="1" colspan="1">11</td></tr><tr><td align="left" rowspan="1" colspan="1"><bold>Alternative Exon</bold></td><td align="left" rowspan="1" colspan="1">4.5</td><td align="left" rowspan="1" colspan="1">6.5</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">4.5</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">4.5</td></tr><tr><td align="left" rowspan="1" colspan="1"><bold>Extended Exon</bold></td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1">6.5</td><td align="left" rowspan="1" colspan="1">6.5</td><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1">6.5</td></tr><tr><td align="left" rowspan="1" colspan="1"><bold>Overlapping 3&#x02032; UTR</bold></td><td align="left" rowspan="1" colspan="1">13.5</td><td align="left" rowspan="1" colspan="1">11</td><td align="left" rowspan="1" colspan="1">8.5</td><td align="left" rowspan="1" colspan="1">11.5</td><td align="left" rowspan="1" colspan="1">9.5</td><td align="left" rowspan="1" colspan="1">10</td></tr><tr><td align="left" rowspan="1" colspan="1"><bold>Distinct 3&#x02032; UTR</bold></td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">3.5</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">2.5</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">1.5</td></tr></tbody></table></alternatives></table-wrap></sec><sec id="s3h"><title>The effect of different isoform sets on MLE result</title><p>We also investigate how different isoform sets (e.g. with a major/minor isoform missing, with an additional &#x0201c;dummy&#x0201d; isoform) will affect the MLE result, especially in terms of the maximized likelihood value. We pick gene No. <inline-formula><inline-graphic xlink:href="pone.0029175.e323.jpg" mimetype="image"/></inline-formula> as a base isoform set, using the same set of reads and the per-read average maximized likelihood value <inline-formula><inline-graphic xlink:href="pone.0029175.e324.jpg" mimetype="image"/></inline-formula> to measure the goodness of fitting:<disp-formula><graphic xlink:href="pone.0029175.e325"/><label>(24)</label></disp-formula></p><p>As we can see from <xref ref-type="fig" rid="pone-0029175-g011">Figure 11</xref>, the <inline-formula><inline-graphic xlink:href="pone.0029175.e326.jpg" mimetype="image"/></inline-formula> value always decreases when we modify the &#x0201c;true&#x0201d; isoform set in an unfavorable fashion. This shows that the likelihood score is an effective metric for ranking isoform sets for a particular gene. We observe that the <inline-formula><inline-graphic xlink:href="pone.0029175.e327.jpg" mimetype="image"/></inline-formula> value decreases the most in all cases when the dominant isoform is removed from the isoform set <xref ref-type="fig" rid="pone-0029175-g011">Figure 11b</xref>), which indicates that a more important element has a larger contribution in explaining the generated reads. Correspondingly, when a low-probability or dummy isoform (that is not similar to the dominant one) is added to the input isoform set, the <inline-formula><inline-graphic xlink:href="pone.0029175.e328.jpg" mimetype="image"/></inline-formula> value decreases less significantly (about half of the case with dominant isoform removal), and also the isoform quantification results remain almost unchanged for the other transcripts in the isoform set. In practice, this characteristic can also be useful to eliminate non-existing isoforms - any isoform that has little effect on either quantification result or <inline-formula><inline-graphic xlink:href="pone.0029175.e329.jpg" mimetype="image"/></inline-formula> score can be considered &#x0201c;not important&#x0201d; for explaining the observed reads, and can thus be removed from the isoform set when analyzing a particular dataset.</p><fig id="pone-0029175-g014" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g014</object-id><label>Algorithm 2</label><caption><title>FasterShotgunFIM (<italic>I,</italic>&#x00398;<italic>,Samp<sub>m</sub>,p,q</italic>)</title></caption><graphic xlink:href="pone.0029175.g014"/></fig></sec><sec id="s3i"><title>Use of empirical <inline-formula><inline-graphic xlink:href="pone.0029175.e330.jpg" mimetype="image"/></inline-formula> function</title><p>To illustrate how non-uniform <inline-formula><inline-graphic xlink:href="pone.0029175.e331.jpg" mimetype="image"/></inline-formula> function works, we modeled the bias of RNA-Seq data by aggregating signal of mapped reads along annotated transcripts. A signal map of the first base of mapped reads was generated. The signal was subsequently mapped onto the transcript and aggregated for all genes with signal isoform. An aggregation plot of such a signal map for Young Adult is shown in <xref ref-type="supplementary-material" rid="pone.0029175.s001">Text S1</xref>. In this aggregation, each transcript is divided evenly into 100 bins, with the signals normalized by the sum of signals across all the bins. The normalized signal at each bin thus represents the probability that a read is generated at certain position of the transcript. These non-uniform probabilities gave more realistic estimation of how the reads are generated, and were plugged into the EM calculations. We compared the quantification results for Young Adult worm with uniform and non-uniform G function. The Pearson correlation score for relative abundance is <inline-formula><inline-graphic xlink:href="pone.0029175.e332.jpg" mimetype="image"/></inline-formula>, and score for absolute abundance is <inline-formula><inline-graphic xlink:href="pone.0029175.e333.jpg" mimetype="image"/></inline-formula>. The results are similar for other stages. For the majority of genes, the isoform quantification is largely dependent upon whether reads are compatible with the different isoforms of the gene, while the subtle differences in start position probabilities have little influences on final estimation results. Only for a few genes where the isoform structures are highly similar to each other, the quantification results are different.</p><p>Also, there have been some recent works <xref ref-type="bibr" rid="pone.0029175-Li1">[19]</xref>, <xref ref-type="bibr" rid="pone.0029175-Hansen1">[20]</xref> studying the sequencing biases in RNA-Seq data, with more sophisticated modeling utilizing local sequence composition at different positions along the transcript. Based on different assumptions on sequencing bias, their results can be plugged into the <inline-formula><inline-graphic xlink:href="pone.0029175.e334.jpg" mimetype="image"/></inline-formula> function to derive more realistic quantification results.</p></sec><sec id="s3j"><title>Comparison with existing tools</title><p>In order to understand the performance of our method compared with other existing tools, we have conducted additional computational analysis by applying IQSeq and Cufflinks on <inline-formula><inline-graphic xlink:href="pone.0029175.e335.jpg" mimetype="image"/></inline-formula> samples from MAQC-3 data <xref ref-type="bibr" rid="pone.0029175-Bullard1">[21]</xref>. We summarize our result in <xref ref-type="fig" rid="pone-0029175-g012">Figure 12</xref>. The genes are categorized by their number of isoforms, and Pearson correlations of the estimated isoform level RPKMs (in logarithmic scale) from the two methods are calculated for each category in each sample. The overall correlation of the isoform quantification results from these two methods is <inline-formula><inline-graphic xlink:href="pone.0029175.e336.jpg" mimetype="image"/></inline-formula> across all samples, which indicates a similar characteristic with a near uniform read-generation assumption. Also, both outputs from IQSeq and Cufflinks have <inline-formula><inline-graphic xlink:href="pone.0029175.e337.jpg" mimetype="image"/></inline-formula> correlation with the Taqman assay <xref ref-type="bibr" rid="pone.0029175-Consortium1">[22]</xref> (an qRT-PCR technique, which can be considered as a gold-standard here). These results confirm consistency of our method with previous work. Note, however, that with our method one can readily &#x0201c;plug-in&#x0201d; more practical read generation models as illustrated in the previous section, making it a more flexible tool to handle and integrate data from different sequencing technologies. Also, we compared the isoform quantification variances between replicates with the FIM based variance estimations, and their logarithmic values have a correlation of <inline-formula><inline-graphic xlink:href="pone.0029175.e338.jpg" mimetype="image"/></inline-formula> (<xref ref-type="fig" rid="pone-0029175-g003">Figure 3</xref> in <xref ref-type="supplementary-material" rid="pone.0029175.s001">Text S1</xref>).</p><fig id="pone-0029175-g015" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0029175.g015</object-id><label>Algorithm 3</label><caption><title>FasterShotgunFIM (<italic>I,</italic>&#x00398;<italic>,Samp<sub>m</sub>,p,q</italic>)</title></caption><graphic xlink:href="pone.0029175.g015"/></fig></sec></sec><sec id="s4"><title>Discussion</title><p>In this paper we explore the problem of integrating different sequencing techniques to quantify the relative abundance of different isoform transcripts, which can be generalized to the problem of estimating the distribution based on partial samples from different sampling techniques. We first introduce a statistical framework to model the generative process of the partial samples, using a &#x0201c;plugin-able&#x0201d; function <inline-formula><inline-graphic xlink:href="pone.0029175.e339.jpg" mimetype="image"/></inline-formula> to allow flexible incorporation of different sampling characteristics, and then present the original problem as a maximum likelihood estimation (MLE) problem, with an iterative solution based on expectation maximization, which guarantees a locally optimum answer. This provides a solution to the question of estimating a distribution based on partial samples.</p><p>In order to further investigate the problem involving partial samples, we introduce a heuristic based on the Fisher information matrix (FIM) to estimate the variance of the previously presented MLE solution. Also, in order to accelerate the computation of this measurement, we introduce the concept of equivalent partial samples and develop a fast algorithm, Algorithm 3, to accurately calculate FIM, achieving a speedup of <inline-formula><inline-graphic xlink:href="pone.0029175.e340.jpg" mimetype="image"/></inline-formula> times compared to the brute-force method. Simulation results on both hypothetical and real gene models also show that our FIM-based heuristic gives a good approximation to the value of <inline-formula><inline-graphic xlink:href="pone.0029175.e341.jpg" mimetype="image"/></inline-formula>, and accurately predicts the numeric order of this value under different conditions. With this metric, we are also able to demonstrate examples of how to efficiently find low-cost combinations of different sampling techniques to best estimate the isoform compositions in RNA-Seq experiments. Although we are only using individual genes as examples, once we have good assumptions of expression levels of different genes, this procedure can be generalized to all the genes for the low-cost design of actual whole genome RNA-Seq experiments.</p><p>What is more, by applying the MLE method to a worm RNA-Seq dataset, we illustrate how we can compare the differential isoform composition between different developmental stages, and how different isoform sets (e.g. with a major/minor isoform missing, with an additional &#x02018;dummy&#x0201d; isoform) will affect the MLE result, especially in terms of the maximized likelihood value, showing that the likelihood score is an effective tool for ranking the &#x0201c;fitness&#x0201d; of isoform sets for a particular gene.</p><p>Since IQSeq estimates isoform quantity within a probabilistic framework, it does not directly determine the existence of a certain isoform transcript in the data, but rather gives probability measures (<inline-formula><inline-graphic xlink:href="pone.0029175.e342.jpg" mimetype="image"/></inline-formula>) and corresponding RPKM values. The result of a secondary experiment with high precision, e.g. qPCR, on a smaller set of genes, can be used as a gold standard dataset to assist answering such existence questions, with either a simple RPKM value threshold that maximizes the prediction accuracy on the gold standard (training) dataset, or more sophisticated classification techniques that takes multiple characteristics (e.g. <inline-formula><inline-graphic xlink:href="pone.0029175.e343.jpg" mimetype="image"/></inline-formula>, overall gene expression, FIM-based variance estimation) into account.</p><p>The FIM-based variance we are trying to estimate in the proposed algorithm focuses mainly on the expected estimation variance based on different read sets of similar on a same sample, and is a measurement of estimation accuracy. In the case of read sets from different biological replicates, the variances of interest there are usually the actual differences in isoform composition of particular genes between/among the replicates, and analysis on such differences can be generally conducted as a downstream procedure after the isoform quantification calculation.</p><p>As sequencing technologies constantly evolve, IQSeq will remain able to provide integrated analysis of different datasets with their own sequencing characteristics, and provide guidelines for optimal RNA-Seq experiment design.</p></sec><sec sec-type="supplementary-material" id="s5"><title>Supporting Information</title><supplementary-material content-type="local-data" id="pone.0029175.s001"><label>Text S1</label><caption><p><bold>Supplementary material including additional derivation of formulas, proof of lemmas and theorems, and analysis results.</bold></p><p>(PDF)</p></caption><media xlink:href="pone.0029175.s001.pdf" mimetype="application" mime-subtype="pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><fn-group><fn fn-type="conflict"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><fn fn-type="financial-disclosure"><p><bold>Funding: </bold>These authors have no support or funding to report.</p></fn></fn-group><ref-list><title>References</title><ref id="pone.0029175-Gerstein1"><label>1</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Gerstein</surname><given-names>MB</given-names></name><name><surname>Bruce</surname><given-names>C</given-names></name><name><surname>Rozowsky</surname><given-names>JS</given-names></name><name><surname>Zheng</surname><given-names>D</given-names></name><name><surname>Du</surname><given-names>J</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>What is a gene, post-encode? history and updated definition.</article-title>             <source>Genome Res</source>             <volume>17</volume>             <fpage>669</fpage>             <lpage>681</lpage>          <pub-id pub-id-type="pmid">17567988</pub-id></element-citation></ref><ref id="pone.0029175-Berget1"><label>2</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Berget</surname><given-names>SM</given-names></name><name><surname>Moore</surname><given-names>C</given-names></name><name><surname>Sharp</surname><given-names>PA</given-names></name></person-group>             <year>1977</year>             <article-title>Spliced segments at the 5&#x02032; terminus of adenovirus 2 late mrna.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>74</volume>             <fpage>3171</fpage>             <lpage>3175</lpage>          <pub-id pub-id-type="pmid">269380</pub-id></element-citation></ref><ref id="pone.0029175-Chow1"><label>3</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Chow</surname><given-names>LT</given-names></name><name><surname>Gelinas</surname><given-names>RE</given-names></name><name><surname>Broker</surname><given-names>TR</given-names></name><name><surname>Roberts</surname><given-names>RJ</given-names></name></person-group>             <year>1977</year>             <article-title>An amazing sequence arrangement at the 5&#x02032; ends of adenovirus 2 messenger rna.</article-title>             <source>Cell</source>             <volume>12</volume>             <fpage>1</fpage>             <lpage>8</lpage>          <pub-id pub-id-type="pmid">902310</pub-id></element-citation></ref><ref id="pone.0029175-Gelinas1"><label>4</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Gelinas</surname><given-names>RE</given-names></name><name><surname>Roberts</surname><given-names>RJ</given-names></name></person-group>             <year>1977</year>             <article-title>One predominant 5&#x02032;-undecanucleotide in adenovirus 2 late messen- ger rnas.</article-title>             <source>Cell</source>             <volume>11</volume>             <fpage>533</fpage>             <lpage>544</lpage>          <pub-id pub-id-type="pmid">884734</pub-id></element-citation></ref><ref id="pone.0029175-Harrow1"><label>5</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Harrow</surname><given-names>J</given-names></name><name><surname>Denoeud</surname><given-names>F</given-names></name><name><surname>Frankish</surname><given-names>A</given-names></name><name><surname>Reymond</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>CK</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Gencode: producing a reference annotation for encode.</article-title>             <source>Genome Biol</source>             <volume>7</volume>             <issue>Suppl 1</issue>             <fpage>S4.1</fpage>             <lpage>S4.9</lpage>          <pub-id pub-id-type="pmid">16925838</pub-id></element-citation></ref><ref id="pone.0029175-Xing1"><label>6</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Xing</surname><given-names>Y</given-names></name><name><surname>Yu</surname><given-names>T</given-names></name><name><surname>Wu</surname><given-names>YN</given-names></name><name><surname>Roy</surname><given-names>M</given-names></name><name><surname>Kim</surname><given-names>J</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>An expectation-maximization algorithm for probabilistic reconstructions of full-length isoforms from splice graphs.</article-title>             <source>Nucleic Acids Res</source>             <volume>34</volume>             <fpage>3150</fpage>             <lpage>3160</lpage>          <pub-id pub-id-type="pmid">16757580</pub-id></element-citation></ref><ref id="pone.0029175-Jiang1"><label>7</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Jiang</surname><given-names>H</given-names></name><name><surname>Wong</surname><given-names>WH</given-names></name></person-group>             <year>2009</year>             <article-title>Statistical inferences for isoform expression in rna-seq.</article-title>             <source>Bioinformatics</source>             <volume>25</volume>             <fpage>1026</fpage>             <lpage>1032</lpage>          <pub-id pub-id-type="pmid">19244387</pub-id></element-citation></ref><ref id="pone.0029175-Trapnell1"><label>8</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Williams</surname><given-names>BA</given-names></name><name><surname>Pertea</surname><given-names>G</given-names></name><name><surname>Mortazavi</surname><given-names>A</given-names></name><name><surname>Kwan</surname><given-names>G</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Transcript assembly and quantification by rna-seq reveals unannotated transcripts and isoform switching during cell differentiation.</article-title>             <source>Nat Biotechnol</source>          </element-citation></ref><ref id="pone.0029175-Richard1"><label>9</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Richard</surname><given-names>H</given-names></name><name><surname>Schulz</surname><given-names>MH</given-names></name><name><surname>Sultan</surname><given-names>M</given-names></name><name><surname>Nrnberger</surname><given-names>A</given-names></name><name><surname>Schrinner</surname><given-names>S</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Prediction of alternative isoforms from exon expression levels in rna-seq experiments.</article-title>             <source>Nucleic Acids Res</source>             <volume>38</volume>             <fpage>e112</fpage>          <pub-id pub-id-type="pmid">20150413</pub-id></element-citation></ref><ref id="pone.0029175-Lacroix1"><label>10</label><element-citation publication-type="book">             <person-group person-group-type="author"><name><surname>Lacroix</surname><given-names>V</given-names></name><name><surname>Sammeth</surname><given-names>M</given-names></name><name><surname>Guigo</surname><given-names>R</given-names></name><name><surname>Bergeron</surname><given-names>A</given-names></name></person-group>             <year>2008</year>             <article-title>Exact transcriptome reconstruction from short sequence reads.</article-title>             <source>WABI '08: Proceedings of the 8th international workshop on Algorithms in Bioinformatics</source>             <publisher-loc>Berlin, Heidelberg</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>             <fpage>50</fpage>             <lpage>63</lpage>          </element-citation></ref><ref id="pone.0029175-Dempster1"><label>11</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Dempster</surname><given-names>AP</given-names></name><name><surname>Laird</surname><given-names>NM</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group>             <year>1977</year>             <article-title>Maximum likelihood from incomplete data via the em algorithm.</article-title>             <source>Journal of the Royal Statistical Society Series B (Methodological)</source>             <volume>39</volume>             <fpage>1</fpage>             <lpage>38</lpage>          </element-citation></ref><ref id="pone.0029175-Schervish1"><label>12</label><element-citation publication-type="book">             <person-group person-group-type="author"><name><surname>Schervish</surname><given-names>MJ</given-names></name></person-group>             <year>1995</year>             <source>Theory of Statistics</source>             <publisher-name>Springer</publisher-name>          </element-citation></ref><ref id="pone.0029175-VanderVaart1"><label>13</label><element-citation publication-type="book">             <person-group person-group-type="author"><name><surname>Van der Vaart</surname><given-names>AW</given-names></name></person-group>             <year>1998</year>             <source>Asymptotic Statistics</source>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation></ref><ref id="pone.0029175-Du1"><label>14</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Du</surname><given-names>J</given-names></name><name><surname>Bjornson</surname><given-names>RD</given-names></name><name><surname>Zhang</surname><given-names>ZD</given-names></name><name><surname>Kong</surname><given-names>Y</given-names></name><name><surname>Snyder</surname><given-names>M</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Integrating sequencing technologies in personal genomics: optimal low cost reconstruction of structural variants.</article-title>             <source>PLoS Comput Biol</source>             <volume>5</volume>             <fpage>e1000432</fpage>          <pub-id pub-id-type="pmid">19593373</pub-id></element-citation></ref><ref id="pone.0029175-Heber1"><label>15</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Heber</surname><given-names>S</given-names></name><name><surname>Alekseyev</surname><given-names>M</given-names></name><name><surname>Sze</surname><given-names>SH</given-names></name><name><surname>Tang</surname><given-names>H</given-names></name><name><surname>Pevzner</surname><given-names>PA</given-names></name></person-group>             <year>2002</year>             <article-title>Splicing graphs and est assembly problem.</article-title>             <source>Bioinformatics</source>             <volume>18</volume>             <issue>Suppl 1</issue>             <fpage>S181</fpage>             <lpage>S188</lpage>          <pub-id pub-id-type="pmid">12169546</pub-id></element-citation></ref><ref id="pone.0029175-Hillier1"><label>16</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Hillier</surname><given-names>LW</given-names></name><name><surname>Reinke</surname><given-names>V</given-names></name><name><surname>Green</surname><given-names>P</given-names></name><name><surname>Hirst</surname><given-names>M</given-names></name><name><surname>Marra</surname><given-names>MA</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Massively parallel sequencing of the polyadenylated transcriptome of c. elegans.</article-title>             <source>Genome Res</source>             <volume>19</volume>             <fpage>657</fpage>             <lpage>666</lpage>          <pub-id pub-id-type="pmid">19181841</pub-id></element-citation></ref><ref id="pone.0029175-Celniker1"><label>17</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Celniker</surname><given-names>SE</given-names></name><name><surname>Dillon</surname><given-names>LAL</given-names></name><name><surname>Gerstein</surname><given-names>MB</given-names></name><name><surname>Gunsalus</surname><given-names>KC</given-names></name><name><surname>Henikoff</surname><given-names>S</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Unlocking the secrets of the genome.</article-title>             <source>Nature</source>             <volume>459</volume>             <fpage>927</fpage>             <lpage>930</lpage>          <pub-id pub-id-type="pmid">19536255</pub-id></element-citation></ref><ref id="pone.0029175-Gerstein2"><label>18</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Gerstein</surname><given-names>MB</given-names></name><name><surname>Lu</surname><given-names>ZJ</given-names></name><name><surname>Nostrand</surname><given-names>ELV</given-names></name><name><surname>Cheng</surname><given-names>C</given-names></name><name><surname>Arshinoff</surname><given-names>BI</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Integrative analysis of the caenorhabditis elegans genome by the modencode project.</article-title>             <source>Science</source>             <volume>330</volume>             <fpage>1775</fpage>             <lpage>1787</lpage>          <pub-id pub-id-type="pmid">21177976</pub-id></element-citation></ref><ref id="pone.0029175-Li1"><label>19</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Jiang</surname><given-names>H</given-names></name><name><surname>Wong</surname><given-names>WH</given-names></name></person-group>             <year>2010</year>             <article-title>Modeling non-uniformity in short-read rates in rna-seq data.</article-title>             <source>Genome Biol</source>             <volume>11</volume>             <fpage>R50</fpage>          <pub-id pub-id-type="pmid">20459815</pub-id></element-citation></ref><ref id="pone.0029175-Hansen1"><label>20</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Hansen</surname><given-names>KD</given-names></name><name><surname>Brenner</surname><given-names>SE</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name></person-group>             <year>2010</year>             <article-title>Biases in illumina transcriptome sequencing caused by random hexamer priming.</article-title>             <source>Nucleic Acids Res</source>          </element-citation></ref><ref id="pone.0029175-Bullard1"><label>21</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Bullard</surname><given-names>JH</given-names></name><name><surname>Purdom</surname><given-names>E</given-names></name><name><surname>Hansen</surname><given-names>KD</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name></person-group>             <year>2010</year>             <article-title>Evaluation of statistical methods for normal- ization and differential expression in mrna-seq experiments.</article-title>             <source>BMC Bioinformatics</source>             <volume>11</volume>             <fpage>94</fpage>          <pub-id pub-id-type="pmid">20167110</pub-id></element-citation></ref><ref id="pone.0029175-Consortium1"><label>22</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Shi</surname><given-names>L</given-names></name><name><surname>Reid</surname><given-names>LH</given-names></name><name><surname>Jones</surname><given-names>WD</given-names></name><name><surname>Shippy</surname><given-names>R</given-names></name><etal/></person-group>             <collab>Consortium MAQC</collab>             <year>2006</year>             <article-title>The microarray quality control (maqc) project shows inter- and intraplatform reproducibility of gene expression measure- ments.</article-title>             <source>Nat Biotechnol</source>             <volume>24</volume>             <fpage>1151</fpage>             <lpage>1161</lpage>          <pub-id pub-id-type="pmid">16964229</pub-id></element-citation></ref></ref-list></back></article>