<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d2 20140930//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Algorithms Mol Biol</journal-id><journal-id journal-id-type="iso-abbrev">Algorithms Mol Biol</journal-id><journal-title-group><journal-title>Algorithms for Molecular Biology : AMB</journal-title></journal-title-group><issn pub-type="epub">1748-7188</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4327811</article-id><article-id pub-id-type="publisher-id">32</article-id><article-id pub-id-type="doi">10.1186/s13015-015-0032-x</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research</subject></subj-group></article-categories><title-group><article-title>Estimating evolutionary distances between genomic sequences from spaced-word matches</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Morgenstern</surname><given-names>Burkhard</given-names></name><address><email>bmorgen@gwdg.de</email></address><xref ref-type="aff" rid="Aff1"/><xref ref-type="aff" rid="Aff2"/></contrib><contrib contrib-type="author"><name><surname>Zhu</surname><given-names>Bingyao</given-names></name><address><email>lucil_zby@hotmail.com</email></address><xref ref-type="aff" rid="Aff3"/></contrib><contrib contrib-type="author"><name><surname>Horwege</surname><given-names>Sebastian</given-names></name><address><email>sebastian.horwege@stud.uni-goettingen.de</email></address><xref ref-type="aff" rid="Aff1"/></contrib><contrib contrib-type="author"><name><surname>Leimeister</surname><given-names>Chris Andr&#x000e9;</given-names></name><address><email>chris.leimeister@stud.uni-goettingen.de</email></address><xref ref-type="aff" rid="Aff1"/></contrib><aff id="Aff1"><label/>University of G&#x000f6;ttingen, Department of Bioinformatics, Goldschmidtstr. 1, G&#x000f6;ttingen, 37073 Germany </aff><aff id="Aff2"><label/>Universit&#x000e9; d&#x02019;Evry Val d&#x02019;Essonne, Laboratoire Statistique et G&#x000e9;nome, UMR CNRS 8071, USC INRA 23 Boulevard de France, Evry, 91037 France </aff><aff id="Aff3"><label/>University of G&#x000f6;ttingen, Department of General Microbiology, Grisebachstr. 8, G&#x000f6;ttingen, 37073 Germany </aff></contrib-group><pub-date pub-type="epub"><day>11</day><month>2</month><year>2015</year></pub-date><pub-date pub-type="pmc-release"><day>11</day><month>2</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>10</volume><elocation-id>5</elocation-id><history><date date-type="received"><day>19</day><month>11</month><year>2014</year></date><date date-type="accepted"><day>6</day><month>1</month><year>2015</year></date></history><permissions><copyright-statement>&#x000a9; Morgenstern et al.; licensee BioMed Central. 2015</copyright-statement><license license-type="open-access"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><p>Alignment-free methods are increasingly used to calculate evolutionary distances between DNA and protein sequences as a basis of phylogeny reconstruction. Most of these methods, however, use heuristic distance functions that are not based on any explicit model of molecular evolution. Herein, we propose a simple estimator <italic>d</italic><sub><italic>N</italic></sub> of the evolutionary distance between two DNA sequences that is calculated from the number <italic>N</italic> of (spaced) word matches between them. We show that this distance function is more accurate than other distance measures that are used by alignment-free methods. In addition, we calculate the variance of the normalized number <italic>N</italic> of (spaced) word matches. We show that the variance of <italic>N</italic> is smaller for spaced words than for contiguous words, and that the variance is further reduced if our spaced-words approach is used with multiple patterns of &#x02018;match positions&#x02019; and &#x02018;don&#x02019;t care positions&#x02019;. Our software is available online and as downloadable source code at: <ext-link ext-link-type="uri" xlink:href="http://spaced.gobics.de/">http://spaced.gobics.de/</ext-link>.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd><italic>k</italic>-mers</kwd><kwd>Spaced words</kwd><kwd>Alignment-free</kwd><kwd>Phylogeny</kwd><kwd>Word frequency</kwd><kwd>Distance estimation</kwd><kwd>Variance</kwd><kwd>Genome comparison</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2015</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p>Alignment-free methods are increasingly used for DNA and protein sequence comparison since they are much faster than traditional alignment-based approaches [<xref ref-type="bibr" rid="CR1">1</xref>]. Applications of alignment-free approaches include <italic>protein classification</italic> [<xref ref-type="bibr" rid="CR2">2</xref>-<xref ref-type="bibr" rid="CR5">5</xref>], <italic>read alignment</italic> [<xref ref-type="bibr" rid="CR6">6</xref>-<xref ref-type="bibr" rid="CR8">8</xref>], <italic>isoform quantification</italic> from RNAseq reads [<xref ref-type="bibr" rid="CR9">9</xref>], <italic>sequence assembly</italic> [<xref ref-type="bibr" rid="CR10">10</xref>], <italic>read-binning</italic> in metagenomics [<xref ref-type="bibr" rid="CR11">11</xref>-<xref ref-type="bibr" rid="CR16">16</xref>] or analysis of <italic>regulatory elements</italic> [<xref ref-type="bibr" rid="CR17">17</xref>-<xref ref-type="bibr" rid="CR20">20</xref>]. Most alignment-free algorithms are based on the <italic>word</italic> or <italic>k-mer composition</italic> of the sequences under study [<xref ref-type="bibr" rid="CR21">21</xref>]. To measure pairwise distances between genomic or protein sequences, it is common practice to apply standard metrics such as the <italic>Euclidean</italic> or the <italic>Jensen-Shannon (JS)</italic> distance [<xref ref-type="bibr" rid="CR22">22</xref>] to the relative word frequency vectors of the sequences.</p><p>Recently, we proposed an alternative approach to alignment-free sequence comparison. Instead of considering <italic>contiguous</italic> subwords of the input sequences, our approach considers <italic>spaced words, i.e.</italic> words containing <italic>wildcard</italic> or <italic>don&#x02019;t care</italic> characters at positions defined by a pre-defined <italic>pattern</italic><italic>P</italic>. This is similar as in the <italic>spaced-seeds</italic> approach that is used in database searching [<xref ref-type="bibr" rid="CR23">23</xref>]. As in existing alignment-free methods, we compared the (relative) frequencies of these spaced words using standard distance measures [<xref ref-type="bibr" rid="CR24">24</xref>]. In [<xref ref-type="bibr" rid="CR25">25</xref>], we extended this approach by using whole sets <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P} = \{P_{1},\dots,P_{m}\}$
\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="script">P</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq1.gif"/></alternatives></inline-formula> of patterns and calculating the spaced-word frequencies with respect to <italic>all</italic> patterns in <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e412"/>. In this <italic>multiple-pattern</italic> approach, the distance between two sequences is defined as the <italic>average</italic> of the distances based on the <italic>individual</italic> patterns <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$P_{i}\in {\mathcal {P}}$
\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq2.gif"/></alternatives></inline-formula>, see also [<xref ref-type="bibr" rid="CR26">26</xref>]. &#x02018;Spaced words&#x02019; have been proposed simultaneously by Onodera and Shibuya for protein classification [<xref ref-type="bibr" rid="CR27">27</xref>] and by Ghandi <italic>et al.</italic> to study regulatory elements [<xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref>].</p><p><italic>Phylogeny reconstruction</italic> is an important application of alignment-free sequence comparison. Consequently, most alignment-free methods were benchmarked by applying them to phylogeny problems [<xref ref-type="bibr" rid="CR30">30</xref>-<xref ref-type="bibr" rid="CR35">35</xref>]. The distance metrics used by these methods, however, are only rough measures of dissimilarity, not derived from any explicit model of molecular evolution. This may be one reason why distances calculated by alignment-free algorithms are usually not directly evaluated, but are used as input for distance-based phylogeny methods such as <italic>Neighbour-Joining</italic> [<xref ref-type="bibr" rid="CR36">36</xref>]. The resulting tree topologies are then compared to trusted reference topologies. For applications to genomic sequences, we modified our distance <italic>d</italic><sub><italic>N</italic></sub> by taking into account that sequences can contain repeats and homologies on different strands. Obviously, this is only a very rough way of evaluating sequence-comparison methods, since the resulting tree topologies not only depend on the distance values calculated by the evaluated methods, but also on the tree-reconstruction method that is applied to them. Also, comparing topologies ignores branch lengths, so the results of these benchmark studies depend only indirectly on the distance values calculated by the alignment-free methods that are to be evaluated.</p><p>Three remarkable exceptions are the papers describing <italic>K</italic><sub><italic>r</italic></sub> [<xref ref-type="bibr" rid="CR37">37</xref>], <italic>Co-phylog</italic> [<xref ref-type="bibr" rid="CR38">38</xref>] and <italic>andi</italic> [<xref ref-type="bibr" rid="CR39">39</xref>]. <italic>K</italic><sub><italic>r</italic></sub> estimates evolutionary distances based on <italic>shortest unique substrings</italic>, <italic>Co-phylog</italic> uses so-called <italic>microalignments</italic> defined by <italic>spaced-word</italic> matches and considers the <italic>don&#x02019;t care positions</italic> to estimate distances, while <italic>andi</italic> uses gap-free local alignments bounded by maximal unique matches. To our knowledge, these approaches are the only alignment-free methods so far that try to estimate phylogenetic distances in a rigorous way, based on a probabilistic model of evolution. Consequently, the authors of <italic>K</italic><sub><italic>r</italic></sub>, <italic>Co-phylog</italic> and <italic>andy</italic> compared the distance values calculated by their methods directly to reference distances. Haubold <italic>et al.</italic> could show that <italic>K</italic><sub><italic>r</italic></sub> can correctly estimate evolutionary distances between DNA sequences up to around 0.5 mutations per site [<xref ref-type="bibr" rid="CR37">37</xref>].</p><p>In previous papers, we have shown, that our <italic>spaced-word</italic> approach is useful for phylogeny reconstruction. Tree topologies calculated with <italic>Neighbour-Joining</italic> based on <italic>spaced-word</italic> frequency vectors are usually superior to topologies calculated from the <italic>contiguous</italic> word frequency vectors that are used by traditional alignment-free methods [<xref ref-type="bibr" rid="CR25">25</xref>]. Moreover, we could show that the &#x02018;multiple-pattern approach&#x02019; leads to much better results than the &#x02018;single-pattern approach&#x02019;; these results were confirmed by No&#x000e9; and Martin [<xref ref-type="bibr" rid="CR40">40</xref>]. We also showed experimentally that distance values and tree topologies produced from <italic>spaced-word</italic> frequencies are statistically more stable than those based on <italic>contiguous</italic> words. In fact, the main difference between our <italic>spaced words</italic> and the commonly used <italic>contiguous words</italic> is that spaced-word matches at neighbouring positions are statistically less dependent on each other.</p><p>Since the aim of our previous papers was to compare (multiple) spaced-word frequencies to contiguous word frequencies, we applied the same distance metrics to our spaced-word frequencies that are applied by standard methods to <italic>k</italic>-mer frequencies, namely <italic>Jensen-Shannon</italic> and the <italic>Euclidean</italic> distance. In the present paper, we propose a new pairwise distance measure based on a probabilistic model of DNA evolution. We estimate the evolutionary distance between two nucleic-acid sequences based on the number <italic>N</italic> of space-word matches between them. We show that this distance measure is more accurate and works for more distantly related sequences than existing alignment-free distance measures. In addition, we calculate the <italic>variance</italic> of <italic>N</italic> for <italic>contiguous</italic><italic>k</italic>-mers, as well as for <italic>spaced words</italic> using our single and multiple pattern approaches. We show that the variance of <italic>N</italic> is lower for spaced words than for contiguous words and that the variance is further reduced if <italic>multiple</italic> patterns are used.</p><p>This paper is an extended version of a manuscript that was first published in the proceedings of <italic>Workshop on Algorithms in Bioinformatics (WABI) 2013</italic> in Wroclaw, Poland [<xref ref-type="bibr" rid="CR41">41</xref>]. We added two extensions to our WABI paper that are crucial if our method is to be applied to real-world genomic sequences. (a) While the original version of our distance function assumed that homologies are located on the same <italic>strand</italic> of two genomes under comparison, we modified our original distance measure to account for homologies that are on different strands. (b) The number <italic>N</italic> of spaced-word matches is highly sensitive to <italic>repeats</italic> in the compared sequences, and our previously defined distance function could grossly under-estimate phylogenetic distances in the present of repeats. We therefore propose a simple modification of this distance function that is insensitive to repeats. Finally, we added more test data sets to evaluate our method.</p></sec><sec id="Sec2"><title>Motifs and spaced words</title><p>As usual, for an alphabet <italic>&#x003a3;</italic> and <italic>&#x02113;</italic>&#x02208;<bold>N</bold>, <italic>&#x003a3;</italic><sup><italic>&#x02113;</italic></sup> denotes the set of all sequences of length <italic>&#x02113;</italic> over <italic>&#x003a3;</italic>. For a sequence <italic>S</italic>&#x02208;<italic>&#x003a3;</italic><sup><italic>&#x02113;</italic></sup> and 0&#x0003c;<italic>i</italic>&#x02264;<italic>&#x02113;</italic>, <italic>S</italic>[<italic>i</italic>] denotes the <italic>i</italic>-th character of <italic>S</italic>. A <italic>pattern</italic> of length <italic>&#x02113;</italic> is a word <italic>P</italic>&#x02208;{0,1}<sup><italic>&#x02113;</italic></sup>, <italic>i.e.</italic> a sequence over {0,1} of length <italic>&#x02113;</italic>. In the context of our work, a position <italic>i</italic> with <italic>P</italic>[<italic>i</italic>]=1 is called a <italic>match position</italic> while a position <italic>i</italic> with <italic>P</italic>[<italic>i</italic>]=0 is called a <italic>don&#x02019;t care position</italic>. The number of all <italic>match positions</italic> in a patterns <italic>P</italic> is called the <italic>weight</italic> of <italic>P</italic>. For a pattern <italic>P</italic> of weight <italic>k</italic>, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\hat {P}_{i}$
\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq3.gif"/></alternatives></inline-formula> denotes the <italic>i</italic>-th match position and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\hat {P} = \{\hat {P}_{1}, \dots \hat {P}_{k}\}, \hat {P}_{i} &#x0003c; \hat {P}_{i+1},$
\end{document}</tex-math><mml:math id="M8"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq4.gif"/></alternatives></inline-formula> denotes the set of all match positions.</p><p>A <italic>spaced word</italic><italic>w</italic> of weight <italic>k</italic> over an alphabet <italic>&#x003a3;</italic> is a pair (<italic>P</italic>,<italic>w</italic><sup>&#x02032;</sup>) such that <italic>P</italic> is a pattern of weight <italic>k</italic> and <italic>w</italic><sup>&#x02032;</sup> is a word of length <italic>k</italic> over <italic>&#x003a3;</italic>. We say that a spaced word (<italic>P</italic>,<italic>w</italic><sup>&#x02032;</sup>) occurs at position <italic>i</italic> in a sequence <italic>S</italic> over <italic>&#x003a3;</italic>, if <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$S[i+\hat {P}_{r}-1] = w'[r-1]$
\end{document}</tex-math><mml:math id="M10"><mml:mi>S</mml:mi><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>[</mml:mo><mml:mi>r</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>]</mml:mo></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq5.gif"/></alternatives></inline-formula> for all 1&#x02264;<italic>r</italic>&#x02264;<italic>k</italic>. For example, for 
<disp-formula id="Equa"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$\Sigma = \{A,T,C,G\},\ \ P = 1101, \ \ w'= ACT, $$ 
\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>&#x003a3;</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mn>1101</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">ACT</mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equa.gif" position="anchor"/></alternatives></disp-formula> we have <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\hat {P} = \{1,2,4\}$
\end{document}</tex-math><mml:math id="M14"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq6.gif"/></alternatives></inline-formula>, and the spaced word <italic>w</italic>=(<italic>P</italic>,<italic>w</italic><sup>&#x02032;</sup>) occurs at position 2 in sequence <italic>S</italic>=<italic>C</italic><italic>A</italic><italic>C</italic><italic>G</italic><italic>T</italic><italic>C</italic><italic>A</italic> since 
<disp-formula id="Equb"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ S[2] S[3] S[5] = ACT = w'. $$ 
\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>S</mml:mi><mml:mo>[</mml:mo><mml:mn>2</mml:mn><mml:mo>]</mml:mo><mml:mi>S</mml:mi><mml:mo>[</mml:mo><mml:mn>3</mml:mn><mml:mo>]</mml:mo><mml:mi>S</mml:mi><mml:mo>[</mml:mo><mml:mn>5</mml:mn><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">ACT</mml:mtext><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p><p>A pattern is called <italic>contiguous</italic> if it consists of match positions only, a spaced word is called contiguous if the underlying pattern is contiguous. So a &#x02018;contiguous spaced word&#x02019; is just a &#x02018;word&#x02019; in the usual sense.</p><p>For a pattern <italic>P</italic> of weight <italic>k</italic> and two sequences <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> over an alphabet <italic>&#x003a3;</italic>, we say that there is a <italic>spaced-word match</italic> with respect to <italic>P</italic> &#x02013; or a <italic>P</italic>-match &#x02013; at (<italic>i</italic>,<italic>j</italic>) if 
<disp-formula id="Equc"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ S_{1}\left[i+\hat{P}_{r}-1\right] = S_{2}\left[j+\hat{P}_{r}-1\right] $$ 
\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equc.gif" position="anchor"/></alternatives></disp-formula> holds for all 1&#x02264;<italic>r</italic>&#x02264;<italic>k</italic>. For example, for sequences 
<disp-formula id="Equd"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$S_{1} = ACTACAG \text{ and} S_{2}= TATAGG $$ 
\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">ACTACAG</mml:mtext><mml:mtext>and</mml:mtext><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">TATAGG</mml:mtext></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equd.gif" position="anchor"/></alternatives></disp-formula> and <italic>P</italic> as above, there is a <italic>P</italic>-match at (3,1) since one has <italic>S</italic><sub>1</sub>[3]=<italic>S</italic><sub>2</sub>[1],<italic>S</italic><sub>1</sub>[4]=<italic>S</italic><sub>2</sub>[2] and <italic>S</italic><sub>1</sub>[6]=<italic>S</italic><sub>2</sub>[4]. For a set <inline-formula id="IEq7"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
${\mathcal {P}} = \{P_{1}, \dots, P_{m}\}$
\end{document}</tex-math><mml:math id="M22"><mml:mi mathvariant="script">P</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq7.gif"/></alternatives></inline-formula> of patterns, we say that there is a <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e1371"/>-match at (<italic>i</italic>,<italic>j</italic>) if there is some <inline-formula id="IEq8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$P\in {\mathcal {P}}$
\end{document}</tex-math><mml:math id="M24"><mml:mi>P</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq8.gif"/></alternatives></inline-formula> such that there is a <italic>P</italic>-match at (<italic>i</italic>,<italic>j</italic>).</p></sec><sec id="Sec3"><title>The number <italic>N</italic> of spaced-word matches for a pair of sequences with respect to a set <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e1410"/> of patterns</title><p>We consider sequences <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> as above and a fixed set <inline-formula id="IEq9"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\mathcal {P} = \{P_{1},\dots,P_{m}\}$
\end{document}</tex-math><mml:math id="M26"><mml:mi mathvariant="script">P</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq9.gif"/></alternatives></inline-formula> of patterns. For simplicity, we assume that all patterns in <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e1461"/> have the same length <italic>&#x02113;</italic> and the same weight <italic>k</italic>. For now, we use a simplified model of sequence evolution without insertions and deletions, with a constant mutation rate and with different sequence positions independent of each other. Moreover, we assume that we have the same substitution rates for all substitutions <italic>a</italic>&#x02192;<italic>b</italic>,<italic>a</italic>&#x02260;<italic>b</italic>. We therefore consider two sequences <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> of the same length <italic>L</italic> with match probabilities 
<disp-formula id="Eque"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$P(S_{1}[i] = S_{2}[j]) = \left\{ \begin{array}{ll} p &#x00026; \text{for } i=j \\ q &#x00026; \text{for } i\not=j \\ \end{array} \right. $$ 
\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>p</mml:mi></mml:mtd><mml:mtd><mml:mtext>for</mml:mtext><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>q</mml:mi></mml:mtd><mml:mtd><mml:mtext>for</mml:mtext><mml:mi>i</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p><p>If <italic>q</italic><sub><italic>a</italic></sub> is the relative frequency of a single character <inline-formula id="IEq10"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$a\in {\mathcal {A}}$
\end{document}</tex-math><mml:math id="M30"><mml:mi>a</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">A</mml:mi></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq10.gif"/></alternatives></inline-formula>, <inline-formula id="IEq11"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$q = \sum _{a\in {\mathcal {A}}}{q_{a}^{2}}$
\end{document}</tex-math><mml:math id="M32"><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">A</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq11.gif"/></alternatives></inline-formula> is the background match probability, and <italic>p</italic>&#x02265;<italic>q</italic> is the match probability for a pair of &#x02018;homologous&#x02019; positions.</p><p>For a pattern <italic>P</italic>, let <italic>N</italic>(<italic>S</italic><sub>1</sub>,<italic>S</italic><sub>2</sub>,<italic>P</italic>) be the number of pairs of positions (<italic>i</italic>,<italic>j</italic>) where there is a <italic>P</italic>-match between <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub>. We then define 
<disp-formula id="Equf"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ N = N(S_{1},S_{2},\mathcal{P}) = \sum_{P\in\mathcal{P}} N(S_{1},S_{2},P) $$ 
\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equf.gif" position="anchor"/></alternatives></disp-formula> to be the sum of all <italic>P</italic>-matches for patterns <inline-formula id="IEq12"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$P\in \mathcal {P}$
\end{document}</tex-math><mml:math id="M36"><mml:mi>P</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq12.gif"/></alternatives></inline-formula>. Note that for two sequences, there can be <italic>P</italic>-matches for different patterns <italic>P</italic> at the same pair of positions (<italic>i</italic>,<italic>j</italic>). In the definition of <italic>N</italic>, we count not only the positions (<italic>i</italic>,<italic>j</italic>) where there is some <italic>P</italic>-match, but we count <italic>all</italic><italic>P</italic>-matches with respect to all patterns in <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e1802"/>.</p><p><italic>N</italic> can be seen as the <italic>inner product</italic> of <inline-formula id="IEq13"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$m\cdot |{\mathcal {A}}|^{k}$
\end{document}</tex-math><mml:math id="M38"><mml:mi>m</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq13.gif"/></alternatives></inline-formula>-dimensional count vectors for spaced words with respect to the set of patterns <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e1835"/>. In the special case where <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e1838"/> consists of a <italic>single contiguous</italic> pattern, <italic>i.e.</italic> for <italic>k</italic>=<italic>&#x02113;</italic> and <italic>m</italic>=1, <italic>N</italic> is also called the <italic>D</italic><sub>2</sub> score [<xref ref-type="bibr" rid="CR42">42</xref>]. The statistical behaviour of the <italic>D</italic><sub>2</sub> score has been studied under the <italic>null model</italic> where <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> are <italic>unrelated</italic> [<xref ref-type="bibr" rid="CR18">18</xref>,<xref ref-type="bibr" rid="CR43">43</xref>]. In contrast to these studies, we want to investigate the number <italic>N</italic> of spaced-word matches for <italic>evolutionarily related</italic> sequence pairs under a model as specified above. To this end, we define <inline-formula id="IEq14"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$X_{i,j}^{P}$
\end{document}</tex-math><mml:math id="M40"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq14.gif"/></alternatives></inline-formula> to be the Bernoulli random variable that is 1 if there is a <italic>P</italic>-match between <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> at (<italic>i</italic>,<italic>j</italic>), <inline-formula id="IEq15"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$P\in \mathcal {P}$
\end{document}</tex-math><mml:math id="M42"><mml:mi>P</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq15.gif"/></alternatives></inline-formula>, and 0 otherwise, so <italic>N</italic> can be written as 
<disp-formula id="Equg"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ N= \sum_{\substack{P\in\mathcal{P} \\ i,j }} X_{i,j}^{P} $$ 
\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mtable rowspacing="0"><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p><p>If we want to calculate the expectation value and variance of <italic>N</italic>, we have to distinguish between &#x02018;homologous&#x02019; spaced-word matches, that is matches that are due do &#x02018;common ancestry&#x02019; and &#x02018;background matches&#x02019; due to chance. In our model where we do not consider insertions and deletions, a <italic>P</italic>-match at (<italic>i</italic>,<italic>j</italic>) is &#x02018;homologous&#x02019; if and only if <italic>i</italic>=<italic>j</italic> holds. So in this special case, we can define 
<disp-formula id="Equh"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ \mathcal{X}_{Hom} = \left\{ X_{i,i}^{P} | 1 \le i \le L-\ell+1, P\in\mathcal{P} \right\}, $$ 
\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Hom</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equh.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equi"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ \mathcal{X}_{BG} = \left\{ X_{i,j}^{P} | 1 \le i,j \le L-\ell+1, i\not= j, P \in \mathcal{P} \right\}. $$ 
\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">BG</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p><p>Note that if sequences do not contain insertions and deletions, <italic>every</italic> spaced-word match is either entirely a <italic>homologous</italic> match or entirely a <italic>background</italic> match. If indels are considered, a spaced-word match may involve both, homologous and background regions, and the above definitions need to be adapted. The set <inline-graphic xlink:href="13015_2015_32_Figb_HTML.gif" id="d30e2183"/> of all random variables <inline-formula id="IEq16"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$X_{i,j}^{P}$
\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq16.gif"/></alternatives></inline-formula> can be written as <inline-formula id="IEq17"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$ \mathcal {X} = \mathcal {X}_{\textit {Hom}} \cup \mathcal {X}_{\textit {BG}}$
\end{document}</tex-math><mml:math id="M52"><mml:mi mathvariant="script">X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Hom</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">BG</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq17.gif"/></alternatives></inline-formula>, the total sum <italic>N</italic> of spaced-word matches with respect to the set <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e2240"/> of patterns is 
<disp-formula id="Equj"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ N = \sum_{X\in\mathcal{X}} X $$ 
\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:mrow></mml:munder><mml:mi>X</mml:mi></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equj.gif" position="anchor"/></alternatives></disp-formula> and the expected number of spaced-word matches is 
<disp-formula id="Equk"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$E(N) = \sum_{X\in \mathcal{X}_{Hom}} E(X) + \sum_{X\in \mathcal{X}_{BG}} E(X),$$ 
\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Hom</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">BG</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equk.gif" position="anchor"/></alternatives></disp-formula> where the expectation value of a single random variable <inline-formula id="IEq18"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$X\in \mathcal {X}$
\end{document}</tex-math><mml:math id="M58"><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq18.gif"/></alternatives></inline-formula> is 
<disp-formula id="Equ1"><label>(1)</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ E(X) = \left\{ \begin{array}{ll} p^{k} &#x00026; \text{if}\ \ X \in \mathcal{X}_{Hom} \\ q^{k} &#x00026; \text{if}\ \ X \in \mathcal{X}_{BG} \end{array} \right.  $$ 
\end{document}</tex-math><mml:math id="M60"><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Hom</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">BG</mml:mtext></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13015_2015_32_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p><p>There are <italic>L</italic>&#x02212;<italic>&#x02113;</italic>+1 positions (<italic>i</italic>,<italic>i</italic>) and (<italic>L</italic>&#x02212;<italic>&#x02113;</italic>)&#x000b7;(<italic>L</italic>&#x02212;<italic>&#x02113;</italic>+1) positions (<italic>i</italic>,<italic>j</italic>),<italic>i</italic>&#x02260;<italic>j</italic> where spaced-word matches can occur, so we obtain 
<disp-formula id="Equ2"><label>(2)</label><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$  E(N) = m \cdot \left[ (L-\ell+1) \cdot p^{k} + (L-\ell)\cdot (L-\ell+1) \cdot q^{k} \right]  $$ 
\end{document}</tex-math><mml:math id="M62"><mml:mspace width="-13.0pt"/><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13015_2015_32_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec4"><title>Estimating evolutionary distances from the number <italic>N</italic> of spaced-word matches</title><p>If the <italic>weight</italic> of the patterns &#x02013; <italic>i.e.</italic> the number of match positions &#x02013; in the <italic>spaced-words</italic> approach is sufficiently large, random space-word matches can be ignored. In this case, the <italic>Jensen-Shannon</italic> distance between two DNA sequences approximates the number of (spaced) words that occur in one of the compared sequences, but not in the other one. Thus, if two sequences of length <italic>L</italic> are compared and <italic>N</italic> is the number of (spaced) words that two sequences have in common, their <italic>Jenson-Shannon</italic> distance can be approximated by <italic>L</italic>&#x02212;<italic>N</italic>. Accordingly, the <italic>Euclidean</italic> distances between two sequences can be approximated by the square root of this value if the distance is small and <italic>k</italic> is large enough. For <italic>small</italic> evolutionary distances, the <italic>Jensen-Shannon</italic> distance grows therefore roughly linearly with the distance between two sequences, and this explains why it is possible to produce reasonable phylogenies based on this metric. It is clear, however, that the <italic>Jensen-Shannon</italic> distance is far from linear to the real distance for larger distances. We therefore propose an alternative estimator of the evolutionary distance between two sequences in terms of the number <italic>N</italic> of <italic>spaced-word</italic> matches between them.</p><p>Again, we first consider sequences without insertions and deletions. From the expected number <italic>E</italic>(<italic>N</italic>) of spaced words shared by sequences <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> with respect to a set of patterns <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e2633"/> as given in equation (<xref rid="Equ2" ref-type="">2</xref>), we obtain 
<disp-formula id="Equ3"><label>(3)</label><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$  \hat{p} = \sqrt[k]{\frac{N}{m\cdot (L-\ell+1)}- (L-\ell) \cdot q^{k}}  $$ 
\end{document}</tex-math><mml:math id="M64"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mroot><mml:mrow><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mroot></mml:math><graphic xlink:href="13015_2015_32_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p><p>as an estimator for the match probability <italic>p</italic> for sequences without indels, and with Jukes-Cantor [<xref ref-type="bibr" rid="CR44">44</xref>] we obtain 
<disp-formula id="Equ4"><label>(4)</label><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$   d_{N}= -\frac{3}{4} \cdot \ln \left[ \frac{4}{3}\cdot \sqrt[k]{\frac{N}{m\cdot(L-\ell+1)}- (L-\ell) \cdot q^{k}} - \frac{1}{3} \right]  $$ 
\end{document}</tex-math><mml:math id="M66"><mml:mspace width="-13.0pt"/><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mo>&#x000b7;</mml:mo><mml:mo>ln</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>&#x000b7;</mml:mo><mml:mroot><mml:mrow><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mroot><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13015_2015_32_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p><p>as an estimator for the distance <italic>d</italic> between the sequences <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub>. Note that for a model without insertions and deletions, it is, of course, not necessary to estimate the mismatch probability <italic>p</italic> from the number <italic>N</italic> of spaced-word matches. In this case, one could simply <italic>count</italic> the mismatches between two sequences and use their relative frequency as an estimator for <italic>p</italic>. The reason why we want to estimate <italic>p</italic> based on the number of spaced-word matches is that this estimate can be easily adapted to a model with insertions and deletions.</p></sec><sec id="Sec5"><title>Local homologies, homologies on different strands and repeats</title><p>Next, we consider the case where <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> may have different lengths and share one region of <italic>local</italic> homology. Again, we assume again that there are no insertions and deletions within this homologous region. Let <italic>L</italic><sub><italic>Hom</italic></sub> be the length of the local homology; we assume that <italic>L</italic><sub><italic>Hom</italic></sub> is known. Equation (<xref rid="Equ2" ref-type="">2</xref>) for the expected number <italic>N</italic> of spaced-word matches between two sequences <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> can be easily generalized to the case of local homology. If <italic>L</italic><sub>1</sub> and <italic>L</italic><sub>2</sub> are the lengths of <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub>, respectively, we define 
<disp-formula id="Equl"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ L^{*} = (L_{1}-\ell+1)\cdot(L_{2}-\ell+1) - L_{Hom} $$ 
\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Hom</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equl.gif" position="anchor"/></alternatives></disp-formula> to be the (approximate) number of positions (<italic>i</italic>,<italic>j</italic>) where a <italic>background match</italic> can occur (<italic>L</italic><sup>&#x02217;</sup> is only an approximation since we ignore spaced-word matches that involve both, homologous and background regions of the sequences). Then, we can the estimate the expected number of spaced-word matches as 
<disp-formula id="Equ5"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$  E(N) \approx m \cdot \left[ \left(L_{Hom}-\ell+1 \right) \cdot p^{k} + L^{*} \cdot q^{k} \right]   $$ 
\end{document}</tex-math><mml:math id="M70"><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x02248;</mml:mo><mml:mi>m</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Hom</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13015_2015_32_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p><p>and we obtain 
<disp-formula id="Equ6"><label>(5)</label><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$  d_{loc} = -\frac{3}{4} \cdot \ln \left[ \frac{4}{3} \cdot \sqrt[k]{\frac{N/m - L^{*} \cdot q^{k}}{L_{Hom}-\ell+1 }} - \frac{1}{3} \right]  $$ 
\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">loc</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mo>&#x000b7;</mml:mo><mml:mo>ln</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>&#x000b7;</mml:mo><mml:mroot><mml:mrow><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:mi>m</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Hom</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mroot><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13015_2015_32_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p><p>as an estimator for the distance between <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub>. It is straight-forward, though somewhat cumbersome, to extend this estimator to the case where the homologous region contains insertions and deletions.</p><p>Note that, if local homologies between input sequences are known to the user, the best thing would be to remove the non-homologous regions of the sequences and to use the distance <italic>d</italic><sub><italic>N</italic></sub> defined by equation (<xref rid="Equ4" ref-type="">4</xref>) to the remaining homologous regions (which are then &#x02018;globally&#x02019; related to each other). Nevertheless, the distance <italic>d</italic><sub><italic>loc</italic></sub> might be useful in situations where the <italic>extent</italic> of homology between genomic sequences can be estimated, even though the precise location and boundaries of these homologies are unknown.</p><p>So far, we considered the case where homologies between two genomic sequences <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> are located on the same respective strand. For realistic applications, we have to take into account that homologies can occur on both strands of the DNA double helix. More importantly, we have to consider the case where a region of homology is located on one strand of <italic>S</italic><sub>1</sub>, but on the reverse strand on <italic>S</italic><sub>2</sub>. Let <italic>L</italic><sub>1</sub> and <italic>L</italic><sub>2</sub> be the lengths of <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub>, respectively, with <italic>L</italic><sub>1</sub>&#x02264;<italic>L</italic><sub>2</sub>. For simplicity, we assume that the entire sequence <italic>S</italic><sub>1</sub> is homologous to a contiguous segment of <italic>S</italic><sub>2</sub> and we ignore insertions and deletions. We now assume, however, that some segments of <italic>S</italic><sub>1</sub> may align to their homologous counterpart in <italic>S</italic><sub>2</sub> while other segments of <italic>S</italic><sub>2</sub> may align to the reverse complement of their counterparts in <italic>S</italic><sub>2</sub>. The more general situation involving local homology and indels can be accounted for as discussed above.</p><p>The simplest way to capture homologies between <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> regardless of their orientation is to concatenate one of the sequences, say <italic>S</italic><sub>2</sub> with its <italic>reverse complement</italic> and to compare <italic>S</italic><sub>1</sub> to this concatenated sequence. So in this case, we would consider all spaced-word matches between <italic>S</italic><sub>1</sub> and <inline-formula id="IEq19"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\tilde {S_{2}}$
\end{document}</tex-math><mml:math id="M74"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq19.gif"/></alternatives></inline-formula> where <inline-formula id="IEq20"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\tilde {S_{2}}$
\end{document}</tex-math><mml:math id="M76"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq20.gif"/></alternatives></inline-formula> is the concatenation of <italic>S</italic><sub>2</sub> and its reverse complement. To estimate the expected number of spaced-word matches in this situation, we can homologous spaced-word matches can be locate and &#x02248;2&#x000b7;(<italic>L</italic><sub>1</sub>&#x02212;<italic>&#x02113;</italic>+1)&#x000b7;(<italic>L</italic><sub>2</sub>&#x02212;<italic>&#x02113;</italic>) positions where background matches can occur. By adapting Formulae (<xref rid="Equ2" ref-type="">2</xref>) to (<xref rid="Equ4" ref-type="">4</xref>) accordingly and ignoring fringe effects, we obtain 
<disp-formula id="Equ7"><label>(6)</label><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ \begin{aligned} E(N) \approx m \cdot&#x00026; \left[ \left(L_{1}-\ell+1 \right) \cdot p^{k} + 2\cdot \left(L_{1}-\ell+1 \right)\right. \\ &#x00026;\quad\left.\times \left(L_{2}-\ell\right) \cdot q^{k} \right]  \end{aligned}  $$ 
\end{document}</tex-math><mml:math id="M78"><mml:mtable><mml:mtr><mml:mtd><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x02248;</mml:mo><mml:mi>m</mml:mi><mml:mo>&#x000b7;</mml:mo></mml:mtd><mml:mtd><mml:mfenced close="" open="[" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"/><mml:mfenced close="]" open="" separators=""><mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13015_2015_32_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p><p><disp-formula id="Equ8"><label>(7)</label><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$  \hat{p} = \sqrt[k]{\frac{N}{m\cdot (L_{1}-\ell+1)} - 2 \cdot (L_{2}-\ell) \cdot q^{k}}  $$ 
\end{document}</tex-math><mml:math id="M80"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mroot><mml:mrow><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mroot></mml:math><graphic xlink:href="13015_2015_32_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p><p>as an estimator for the match probability <italic>p</italic> for sequences without indels, and with Jukes-Cantor [<xref ref-type="bibr" rid="CR44">44</xref>] we obtain 
<disp-formula id="Equ9"><label>(8)</label><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$  {\fontsize{8.8}{6} \begin{aligned} d_{RC} = -\frac{3}{4} \cdot \ln \left[ \frac{4}{3} \cdot \sqrt[k]{\frac{N}{m\cdot\left(L_{1}-\ell+1\right)} - 2 \cdot \left(L_{2}-\ell\right) \cdot q^{k}} - \frac{1}{3} \right] \end{aligned}}  $$ 
\end{document}</tex-math><mml:math id="M82"><mml:mspace width="-14.0pt"/><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mo>&#x000b7;</mml:mo><mml:mo>ln</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>&#x000b7;</mml:mo><mml:mroot><mml:mrow><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:mroot><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13015_2015_32_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p><p>as an estimator for the distance <italic>d</italic> between the sequences <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> if homologies on the <italic>reverse complement</italic> are taken into account.</p><p>Finally, we consider the case where sequences contain <italic>repeats</italic>. A direct application of the distance functions discussed so far would be highly sensitive to repeats in the input sequences, since repeats can drastically increase the number <italic>N</italic> of (spaced) word matches. This can even lead to negative distance values if the number <italic>N</italic> of <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e3719"/> matches between two sequences with repeats exceeds the expected number of <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e3722"/> matches between a non-repetitive sequence of the same length to itself. A simple but efficient way of dealing with repeats is to use <italic>binary</italic> variables <italic>N</italic><sup><italic>b</italic><italic>i</italic><italic>n</italic></sup>(<italic>S</italic><sub>1</sub>,<italic>S</italic><sub>2</sub>,<italic>P</italic>) that are one if there are one or several <italic>P</italic> matches between sequences <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub>, and zero if there is no such match. Instead of using the number <italic>N</italic> of <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e3770"/> matches for a set <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e3773"/> of patterns, we then consider 
<disp-formula id="Equm"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ N^{bin} = N^{bin}\left(S_{1},S_{2},\mathcal{P}\right) = \sum_{P\in\mathcal{P}} N^{bin}\left(S_{1},S_{2},P\right) $$ 
\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bin</mml:mtext></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bin</mml:mtext></mml:mrow></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bin</mml:mtext></mml:mrow></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equm.gif" position="anchor"/></alternatives></disp-formula> and distances <inline-formula id="IEq21"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$d_{N}^{bin}$
\end{document}</tex-math><mml:math id="M86"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bin</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq21.gif"/></alternatives></inline-formula>, <inline-formula id="IEq22"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$d_{\textit {loc}}^{bin}$
\end{document}</tex-math><mml:math id="M88"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">loc</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bin</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq22.gif"/></alternatives></inline-formula> and <inline-formula id="IEq23"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$d_{\textit {RC}}^{bin}$
\end{document}</tex-math><mml:math id="M90"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bin</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq23.gif"/></alternatives></inline-formula>, respectively, can be defined as in equations (<xref rid="Equ4" ref-type="">4</xref>), (<xref rid="Equ6" ref-type="">5</xref>) and (<xref rid="Equ9" ref-type="">8</xref>), but with <italic>N</italic> replaced by <italic>N</italic><sup><italic>b</italic><italic>i</italic><italic>n</italic></sup>.</p></sec><sec id="Sec6"><title>The variance of <italic>N</italic></title><p>Our new distance measure and other word-based distance measures depend on the number <italic>N</italic> of (spaced) word matches between sequences. To study the stability of these measures, we want to calculate the <italic>variance</italic> of <italic>N</italic>. To do so, we adapt results on the occurrence of words in a sequence as outlined in [<xref ref-type="bibr" rid="CR45">45</xref>]. Since <italic>N</italic> can be written as the sum of all random variables <inline-formula id="IEq24"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$X_{i,j}^{P}$
\end{document}</tex-math><mml:math id="M92"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq24.gif"/></alternatives></inline-formula>, we need to calculate the <italic>covariances</italic> of these random variables. To simplify this, we make a further assumption on our sequence model: we assume that the four nucleotides occur with the same probability 0.25. In this case, the covariance of two random variables <inline-formula id="IEq25"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$X_{i,j}^{P}$
\end{document}</tex-math><mml:math id="M94"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq25.gif"/></alternatives></inline-formula> and <inline-formula id="IEq26"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$X_{i',j'}^{P'}$
\end{document}</tex-math><mml:math id="M96"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq26.gif"/></alternatives></inline-formula> can be non-zero only if <italic>i</italic><sup>&#x02032;</sup>&#x02212;<italic>i</italic>=<italic>j</italic><sup>&#x02032;</sup>&#x02212;<italic>j</italic> holds (note that this is not true if nucleotides have different probabilities to occur). In particular, for random variables <inline-formula id="IEq27"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$X\in \mathcal {X}_{\textit {Hom}}$
\end{document}</tex-math><mml:math id="M98"><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Hom</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq27.gif"/></alternatives></inline-formula> and <inline-formula id="IEq28"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$X'\in \mathcal {X}_{\textit {BG}}$
\end{document}</tex-math><mml:math id="M100"><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">BG</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq28.gif"/></alternatives></inline-formula>, their covariance is zero. Thus, we only need to consider covariances of pairs of random variables <inline-formula id="IEq29"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$X_{i,j}^{P}$
\end{document}</tex-math><mml:math id="M102"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq29.gif"/></alternatives></inline-formula> and <inline-formula id="IEq30"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$X_{i+s,j+s}^{P'}$
\end{document}</tex-math><mml:math id="M104"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq30.gif"/></alternatives></inline-formula>.</p><p>For patterns <italic>P</italic>,<italic>P</italic><sup>&#x02032;</sup> and <italic>s</italic>&#x02208;<bold>N</bold> we define <italic>n</italic>(<italic>P</italic>,<italic>P</italic><sup>&#x02032;</sup>,<italic>s</italic>) to be the number of integers that are match positions of <italic>P</italic> or match positions of <italic>P</italic><sup>&#x02032;</sup> shifted by <italic>s</italic> positions to the right (or both). Formally, if 
<disp-formula id="Equn"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ \hat{P}_{s} = \left\{\hat{P}_{1} + s,\dots, \hat{P}_{k} + s\right\} $$ 
\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equn.gif" position="anchor"/></alternatives></disp-formula> denotes the set of match positions of a pattern <italic>P</italic> shifted by <italic>s</italic> positions to the right, we define 
<disp-formula id="Equo"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ n(P,P',s) = |\hat{P} \cup \hat{P'}_{s}| = |\hat{P}| + |\hat{P'}_{s}| - |\hat{P} \cap \hat{P'}_{s}| $$ 
\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>&#x0222a;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>&#x02229;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equo.gif" position="anchor"/></alternatives></disp-formula></p><p>For example, for <italic>P</italic>=101011,<italic>P</italic><sup>&#x02032;</sup>=111001 and <italic>s</italic>=2, there are 6 positions that are match positions of <italic>P</italic> or of <italic>P</italic><sup>&#x02032;</sup> shifted by 2 positions to the right, namely positions 1, 3, 4, 5, 6, 8: 
<disp-formula id="Equp"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$\begin{array}{cccccccccc} P: &#x00026; &#x00026; 1 &#x00026; 0 &#x00026; 1 &#x00026; 0 &#x00026; 1 &#x00026; 1 &#x00026; &#x00026; \\ P': &#x00026; &#x00026; &#x00026; &#x00026; 1 &#x00026; 1 &#x00026; 1 &#x00026; 0 &#x00026; 0 &#x00026; 1\\ \end{array} $$ 
\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>:</mml:mo></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>:</mml:mo></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equp.gif" position="anchor"/></alternatives></disp-formula> so one has <italic>n</italic>(<italic>P</italic>,<italic>P</italic><sup>&#x02032;</sup>,<italic>s</italic>)=6. In particular, one has <italic>n</italic>(<italic>P</italic>,<italic>P</italic>,0)=<italic>k</italic> for all patterns <italic>P</italic> of weight <italic>k</italic>, and 
<disp-formula id="Equq"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ n(P,P,s) = k + \max\{s,k\} $$ 
\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mo>max</mml:mo><mml:mo>{</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equq.gif" position="anchor"/></alternatives></disp-formula> for all <italic>contiguous</italic> patterns <italic>P</italic> of weight (or length) <italic>k</italic>. With this notation, we can write 
<disp-formula id="Equ10"><label>(9)</label><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$\begin{array}{@{}rcl@{}}  E\left(X_{i,j}^{P} \cdot X_{i+s,j+s}^{P'} \right) &#x00026; = &#x00026;\left\{ \begin{array}{ll} p^{n(P,P',s)} &#x00026; \text{if}\ \ i = j\\ q^{n(P,P',s)} &#x00026; \text{else} \end{array} \right. \end{array} $$ 
\end{document}</tex-math><mml:math id="M114"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mi>E</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext>if</mml:mtext><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mtext>else</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mtext/><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13015_2015_32_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p><p>for all <inline-formula id="IEq31"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$X_{i,j}^{P}, X_{i+s,j+s}^{P'}$
\end{document}</tex-math><mml:math id="M116"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq31.gif"/></alternatives></inline-formula></p><p>To calculate the covariance of two random variables from <inline-graphic xlink:href="13015_2015_32_Figb_HTML.gif" id="d30e4767"/>, we distinguish again between homologous and random matches. We first consider &#x02019;homologous&#x02019; pairs <inline-formula id="IEq32"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$X_{i,i}^{P}, X_{i+s,i+s}^{P'} \in \mathcal {X}_{\textit {Hom}}$
\end{document}</tex-math><mml:math id="M118"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Hom</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq32.gif"/></alternatives></inline-formula>. Here, we obtain with (<xref rid="Equ10" ref-type="">9</xref>) 
<disp-formula id="Equ11"><label>(10)</label><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$  \begin{aligned} Cov \left(X_{i,i}^{P}, X_{i+s,i+s}^{P'}\right) &#x00026;= p^{n(P,P',s)} - p^{2k} \end{aligned}  $$ 
\end{document}</tex-math><mml:math id="M120"><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">Cov</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13015_2015_32_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p><p>Similarly, for a pair of &#x02018;background&#x02019; variables <inline-formula id="IEq33"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$X_{i,j}^{P},$
\end{document}</tex-math><mml:math id="M122"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq33.gif"/></alternatives></inline-formula><inline-formula id="IEq34"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$ X_{i+s,j+s}^{P'} \in \mathcal {X}_{\textit {BG}}$
\end{document}</tex-math><mml:math id="M124"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">BG</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq34.gif"/></alternatives></inline-formula>, one obtains 
<disp-formula id="Equ12"><label>(11)</label><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$  \begin{aligned} Cov \left(X_{i,j}^{P}, X_{i+s,j+s}^{P'}\right) &#x00026;= q^{n(P,P',s)} - q^{2k}. \end{aligned}  $$ 
\end{document}</tex-math><mml:math id="M126"><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">Cov</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13015_2015_32_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p><p>Since &#x02018;homologous&#x02019; and &#x02018;background&#x02019; variables are uncorrelated, the variance of <italic>N</italic> can be written as 
<disp-formula id="Equr"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$\begin{aligned} Var(N) =&#x00026;\; Var \left(\sum_{X\in\mathcal{X}} X\right) = Var \left(\sum_{X\in \mathcal{X}_{Hom}}\right)\\ &#x00026;+ Var \left(\sum_{X\in \mathcal{X}_{BG}}\right) \end{aligned} $$ 
\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mspace width="2.77626pt"/><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:mrow></mml:munder><mml:mi>X</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Hom</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">BG</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equr.gif" position="anchor"/></alternatives></disp-formula></p><p>We express the variance of these sums of random variable as the sum of all of their covariances, so for the &#x02019;homologous&#x02019; random variables we can write 
<disp-formula id="Equs"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$ Var \left(\sum_{X\in \mathcal{X}_{Hom}}X\right) = \sum_{P,P'\in\mathcal{P}} \sum_{i,i'=1}^{L-l+1} Cov \left(X_{i,i}^{P}, X_{i',i'}^{P'} \right) $$ 
\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Hom</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>X</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mtext mathvariant="italic">Cov</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equs.gif" position="anchor"/></alternatives></disp-formula></p><p>Since the covariance for non-correlated random variables vanishes, we can ignore the covariances of all pairs <inline-formula id="IEq35"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\left (X_{i,i}^{P}, X_{i',i'}^{P'}\right)$
\end{document}</tex-math><mml:math id="M132"><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq35.gif"/></alternatives></inline-formula> with |<italic>i</italic>&#x02212;<italic>i</italic><sup>&#x02032;</sup>|&#x02265;<italic>l</italic> so, ignoring side effects, we can write the above sum as 
<disp-formula id="Equt"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $${\fontsize{9.3}{6}\begin{aligned} Var \left(\sum_{X\in \mathcal{X}_{Hom}} X\right) &#x00026; \approx &#x00026;\sum_{i=1}^{L-\ell+1} \sum_{P,P'\in\mathcal{P}} \sum_{s= -\ell + 1}^{\ell-1} Cov \left(X_{i,i}^{P}, X_{i+s,i+s}^{P'} \right) \end{aligned}} $$ 
\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mspace width="-15.0pt"/><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Hom</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>X</mml:mi></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mo>&#x02248;</mml:mo></mml:mtd><mml:mtd><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>&#x02113;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mtext mathvariant="italic">Cov</mml:mtext><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equt.gif" position="anchor"/></alternatives></disp-formula> and since the above covariances depend only on <italic>s</italic> but not on <italic>i</italic>, we can use (<xref rid="Equ10" ref-type="">9</xref>) and (<xref rid="Equ12" ref-type="">11</xref>) and obtain 
<disp-formula id="Equu"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$\begin{aligned} Var &#x00026;\left(\sum_{X\in \mathcal{X}_{Hom}} X\right) \approx (L-\ell+1)\\ &#x00026;\times\sum_{P,P'\in\mathcal{P}} \sum_{s=-\ell+1}^{\ell-1} \left(p^{n(P,P',s)} - p^{2k}\right) \end{aligned} $$ 
\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">Var</mml:mtext></mml:mtd><mml:mtd><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">Hom</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>X</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x02248;</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x000d7;</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>&#x02113;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equu.gif" position="anchor"/></alternatives></disp-formula> and similarly 
<disp-formula id="Equv"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$\begin{aligned} Var &#x00026;\left(\sum_{X\in \mathcal{X}_{BG}}X\right) \approx (L-\ell+1) \cdot (L-\ell)\\ &#x00026;\times\sum_{P,P'\in\mathcal{P}}\sum_{s=-\ell+1}^{\ell-1} \left(q^{n(P,P',s)} - q^{2k}\right) \end{aligned} $$ 
\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">Var</mml:mtext></mml:mtd><mml:mtd><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">BG</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>X</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x02248;</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x000d7;</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>&#x02113;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13015_2015_32_Article_Equv.gif" position="anchor"/></alternatives></disp-formula></p><p>Together, we get 
<disp-formula id="Equ13"><label>(12)</label><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
 $$  {\begin{aligned} Var(N) \approx &#x00026; \;(L-\ell+1) \cdot \sum_{P,P'\in\mathcal{P}} \sum_{s=-\ell+1}^{\ell-1} \left(p^{n(P,P',s)} - p^{2k} \right)\\ &#x00026; +\ \ (L-\ell+1) \cdot (L-\ell) \\ &#x00026;\times\sum_{P,P'\in\mathcal{P}} \sum_{s=-\ell+1}^{\ell-1} \left(q^{n(P,P',s)} - q^{2k}\right) \end{aligned}}  $$ 
\end{document}</tex-math><mml:math id="M140"><mml:mspace width="-18.0pt"/><mml:mtable><mml:mtr><mml:mtd><mml:mtext mathvariant="italic">Var</mml:mtext><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mo>&#x02248;</mml:mo></mml:mtd><mml:mtd><mml:mspace width="2.77626pt"/><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:munder><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>&#x02113;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mspace width="1em"/><mml:mspace width="1em"/><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x000d7;</mml:mo><mml:munder><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>&#x02113;</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>&#x02113;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13015_2015_32_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec7"><title>Test results</title><sec id="Sec8"><title>Simulated DNA sequences</title><p>To evaluate the distance function <italic>d</italic><sub><italic>N</italic></sub> defined by equation (<xref rid="Equ4" ref-type="">4</xref>), we simulated pairs of DNA sequences with an (average) length of 100,000 and with an average of <italic>d</italic> substitutions per sequence position. More precisely, we generated sequence pairs by generating a first sequence using a Bernoulli model with probability 0.25 for each nucleotide. A second sequence was then generated from the first sequence by substituting nucleotides with a probability corresponding to the substitution frequency <italic>d</italic>, as calculated with Jukes-Cantor. We varied <italic>d</italic> between 0 and 1 and compared the distances estimated by our distance measure and by various other alignment-free programs to the &#x02018;real&#x02019; distance <italic>d</italic>. We performed these experiments for sequence pairs without insertions and deletions and for sequence pairs where we included insertions and deletions with a probability of 1<italic>%</italic> at every position. The length of indels was randomly chosen between 1 and 50 with uniform probability.</p><p>Figure <xref rid="Fig1" ref-type="fig">1</xref> shows the results of these experiments. Our new distance measure <italic>d</italic><sub><italic>N</italic></sub> applied to spaced-word frequencies is well in accordance with the real distances <italic>d</italic> for values of <italic>d</italic>&#x02264;0.8 on sequence pairs without insertions and deletions if the <italic>single-pattern</italic> version of our program is used. For the <italic>multiple-pattern</italic> version, our distance function estimates the real distances correctly for all values of <italic>d</italic>&#x02264;1. If indels are added as specified above, our distance functions slightly overestimates the real distance <italic>d</italic>. By contrast, the <italic>Jensen-Shannon</italic> distance applied to the same spaced-word frequencies increased non-linearly with <italic>d</italic> and flattened for values of around <italic>d</italic>&#x02265;0.4.
<fig id="Fig1"><label>Figure 1</label><caption><p>
<bold>Distances calculated by different alignment-free methods.</bold> Distances were calculated for pairs of simulated DNA sequences and plotted against their &#x02018;real&#x02019; distances <italic>d</italic> measured in substitutions per site. Plots on the left-hand side are for sequence pairs without insertions and deletions, on the right-hand side the corresponding results are shown for sequences with an indel probability of 1<italic>%</italic> for each site and an average indel length of 25. From top to bottom, the applied methods were: 1. spaced words with the <italic>single-pattern</italic> approach and the <italic>Jensen-Shannon</italic> distance (squares) and the distance <italic>d</italic>
<sub><italic>N</italic></sub> defined in equation (<xref rid="Equ4" ref-type="">4</xref>) in this paper (circles), 2. the <italic>multiple-pattern</italic> version of <italic>Spaced Words</italic> using sets <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e6207"/> of <italic>m</italic>=100 patterns with the same distance functions, 3. distances calculated with <italic>K</italic>
<sub><italic>r</italic></sub> [<xref ref-type="bibr" rid="CR37">37</xref>], 4. with <italic>kmacs</italic> [<xref ref-type="bibr" rid="CR47">47</xref>] and <italic>ACS</italic> [<xref ref-type="bibr" rid="CR30">30</xref>] and 5. with <italic>Co-phylog</italic> [<xref ref-type="bibr" rid="CR38">38</xref>].</p></caption><graphic xlink:href="13015_2015_32_Fig1_HTML" id="MO1"/></fig></p><p>As mentioned, <italic>K</italic><sub><italic>r</italic></sub> [<xref ref-type="bibr" rid="CR46">46</xref>] estimates evolutionary distances on the basis of a probabilistic model of evolution. In our study, <italic>K</italic><sub><italic>r</italic></sub> correctly estimated the true distance <italic>d</italic> for values of around <italic>d</italic>&#x02264;0.6, this precisely corresponds to the results reported by the authors of the program. For larger distances, <italic>K</italic><sub><italic>r</italic></sub> grossly overestimates the distance <italic>d</italic>, though, and the variance strongly increases. The distances estimated by <italic>Co-phylog</italic> [<xref ref-type="bibr" rid="CR38">38</xref>] nearly coincide with the substitution rate <italic>d</italic> for values <italic>d</italic>&#x02264;0.7, then the curve flattens. Moreover, it appears that the distances calculated with <italic>Co-phylog</italic> are not much affected by indels. The distance values calculated by the program <italic>k mismatch average common substring (kmacs)</italic> that we previously developed [<xref ref-type="bibr" rid="CR47">47</xref>] are roughly linear to the real distances <italic>d</italic> for values of up to around <italic>d</italic>=0.3. From around <italic>d</italic>=0.5 on, the curve becomes flat. With <italic>k</italic>=30 mismatches, the performance of <italic>kmacs</italic> was better than with <italic>k</italic>=0, in which case <italic>kmacs</italic> corresponds to the <italic>Average Common Substring (ACS)</italic> approach [<xref ref-type="bibr" rid="CR30">30</xref>].</p></sec><sec id="Sec9"><title>Real-world genomes</title><p>Next, we applied various distance measures to a set of 27 mitochondrial genomes from different primates that were previously used by [<xref ref-type="bibr" rid="CR46">46</xref>] as a benchmark data set for alignment-free approaches. We used our <italic>multiple spaced-words</italic> approach with the parameters that we used in [<xref ref-type="bibr" rid="CR25">25</xref>], that is with a pattern weight (number of match positions) of <italic>k</italic>=9 and with pattern lengths <italic>&#x02113;</italic> between 9 and 39, <italic>i.e.</italic> with up to 30 <italic>don&#x02019;t-care</italic> positions in the patterns. For each value of <italic>&#x02113;</italic>, we randomly generated sets <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e6359"/> of <italic>m</italic>=100 patterns. For this data set, we used the distance <italic>d</italic><sub><italic>RC</italic></sub> defined in equation (<xref rid="Equ9" ref-type="">8</xref>) that takes the reverse complement of the input sequences into account. (We did not use the &#x02018;binary&#x02019; version <inline-formula id="IEq36"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$d_{\textit {RC}}^{bin}$
\end{document}</tex-math><mml:math id="M142"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bin</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq36.gif"/></alternatives></inline-formula> of our distance function, since these sequences do not contain major repeats). In addition, we used the competing approaches <italic>FFP</italic> [<xref ref-type="bibr" rid="CR32">32</xref>], CVTree [<xref ref-type="bibr" rid="CR48">48</xref>], <italic>K</italic><sub><italic>r</italic></sub> [<xref ref-type="bibr" rid="CR37">37</xref>], <italic>kmacs</italic> [<xref ref-type="bibr" rid="CR47">47</xref>], <italic>ACS</italic> [<xref ref-type="bibr" rid="CR30">30</xref>] and Co-phylog [<xref ref-type="bibr" rid="CR38">38</xref>]. For some of these methods, program parameters need to be defined, <italic>e.g.</italic> a predefined word length or the number of allowed mismatches. For these methods we tested various parameters and used the best performing values.</p><p>With each method, we calculated a distance matrix for the input sequences, and we compared this matrix to a <italic>reference</italic> distance matrix that we calculated with the program <italic>Dnadist</italic> from the <italic>PHYLIP</italic> package [<xref ref-type="bibr" rid="CR49">49</xref>] based on a reference multiple alignment. For comparison with the reference matrix, we used a software program based on the <italic>Mantel</italic> test [<xref ref-type="bibr" rid="CR50">50</xref>] that was also used by Didier <italic>et al.</italic> [<xref ref-type="bibr" rid="CR51">51</xref>]. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the results of this comparison. As can be seen, our new distance measure <italic>d</italic><sub><italic>RC</italic></sub>, applied to multiple spaced-word frequencies, produced distance matrices close to the reference matrix and outperformed the <italic>Jenson-Shannon</italic> distance for all pattern lengths <italic>&#x02113;</italic> that we tested. The distance function <italic>d</italic><sub><italic>RC</italic></sub> also outperformed some of the existing alignment-free methods, with the exception of <italic>K</italic><sub><italic>r</italic></sub> and <italic>kmacs</italic>.
<fig id="Fig2"><label>Figure 2</label><caption><p>
<bold>Comparison of distance matrices for primate mitochondrial genomes.</bold> We applied various alignment-free methods to a set of 27 mitochondrial genomes from different primates and compared the resulting distance matrices to a trusted <italic>reference</italic> distance matrix using the <italic>Mantel test</italic>. The similarity between the calculated matrices and the reference matrix is plotted. We applied our <italic>Spaced-Words</italic> approach using sets <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e6509"/> of 100 randomly calculated patterns with weight <italic>k</italic>=9 and length <italic>&#x02113;</italic> between 9 and 39, <italic>i.e.</italic> with 9 <italic>match positions</italic> and up to 30 <italic>don&#x02019;t care</italic> positions. Yellow squares are the results for the &#x02018;binary&#x02019; version of new distance measure <inline-formula id="IEq37"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$d_{N}^{bin}$
\end{document}</tex-math><mml:math id="M144"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bin</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq37.gif"/></alternatives></inline-formula>. We did not use the reverse-complement option on these data, since genes in the compared genomes are known to be on the same strand. Green diamonds are the results for the <italic>Jensen-Shannon</italic> distance applied to the same spaced-word frequency vectors as explained in [<xref ref-type="bibr" rid="CR25">25</xref>]. In addition, distances calculated by six other alignment-free methods were evaluated.</p></caption><graphic xlink:href="13015_2015_32_Fig2_HTML" id="MO2"/></fig></p><p>In addition to this direct distance comparison we performed an indirect evaluation by phylogeny analysis. To do so, we applied <italic>Neighbor-Joining</italic> [<xref ref-type="bibr" rid="CR36">36</xref>] to the distance matrices and compared the resulting trees to the corresponding reference tree, using the <italic>Robinson-Foulds (RF)</italic> metric [<xref ref-type="bibr" rid="CR52">52</xref>]. The results for the mitochondrial genomes are shown in Figure <xref rid="Fig3" ref-type="fig">3</xref>. The outcome of this evaluation is partially in contradiction to the results of the direct comparison of the distances. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows that the distance matrices produced by <italic>Spaced-Words</italic> with the <italic>Jensen-Shannon divergence</italic> are worse than the distance matrices produced by most other methods, if these matrices are directly compared to the reference distance matrix. However, <italic>Spaced Words</italic> with <italic>Jensen-Shannon</italic> led to better tree topologies than most other methods in our study, as shown in Figure <xref rid="Fig3" ref-type="fig">3</xref>. A similar contradictory result is observed for <italic>K</italic><sub><italic>r</italic></sub>. While the distance matrix produced by <italic>K</italic><sub><italic>r</italic></sub> is similar to the reference matrix, the tree topology produced with these distances is further away from the reference topology than the trees computed by the other alignment-free approaches in our study.
<fig id="Fig3"><label>Figure 3</label><caption><p>
<bold>RF distances for primate mitochondrial genomes.</bold> Performance of various alignment-free methods on the same set of 27 primate mitochondrial genomes as in Figure <xref rid="Fig2" ref-type="fig">2</xref>. <italic>Neighbour-Joining</italic> was applied to the calculated distance matrices, the resulting tree topologies were compared with the Robinson-Foulds metric. Parameters for <italic>Spaced Words</italic> and colour coding as in Figure <xref rid="Fig2" ref-type="fig">2</xref>.</p></caption><graphic xlink:href="13015_2015_32_Fig3_HTML" id="MO3"/></fig></p><p>To evaluate our new method for larger sequences we used two prokaryotic data sets. The first data set consists of 26 <italic>E. coli</italic> and <italic>Shigella</italic> genomes, which are very closely related and the second data set consist of 32 <italic>Roseobacter</italic> genomes, which are far more divergent. For these sequences, we used our &#x02018;repeat-aware&#x02019; distance function <inline-formula id="IEq38"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$d_{\textit {RC}}^{bin}$
\end{document}</tex-math><mml:math id="M146"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bin</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq38.gif"/></alternatives></inline-formula>. As for the primate mitochondrial genomes, we calculated distance matrices using the same alignment-free methods, constructed trees with <italic>Neighbor-Joining</italic> and compared the resulting tree topologies to a benchmark tree using the <italic>RF</italic> metric. For the <italic>E.coli/Shigella</italic> genomes we used the tree proposed by [<xref ref-type="bibr" rid="CR53">53</xref>] as reference which is based on concatenated alignments of the 2034 core genes. For the <italic>Roseobacter</italic> genomes we used the tree by [<xref ref-type="bibr" rid="CR54">54</xref>] as reference. This benchmark tree was constructed based on alignments of 70 universal single-copy genes.</p><p>The results for the <italic>E.coli/Shigella</italic> are shown in Figure <xref rid="Fig4" ref-type="fig">4</xref>. The best result was achieved by <italic>Co-phylog</italic> with a <italic>RF</italic> distance of only 4, followed by our new distance <italic>d</italic><sub><italic>RC</italic></sub> with a <italic>RF</italic> distance of 10, which is a huge improvement compared to the previously described version of <italic>Spaced Words</italic> where we used the <italic>Jensen-Shannon divergence</italic>. <italic>K</italic><sub><italic>r</italic></sub> performed slightly worse than our new estimator with a <italic>RF</italic> distance of 12. The other alignment-free methods performed relatively poorly. For the <italic>Spaced Words</italic> approach we performed 25 runs with <italic>m</italic>=100 patterns that were randomly generated. For this data set, all sets of patterns led to the same tree topology. Additionally the results are also not influenced by the number of <italic>don&#x02019;t-care</italic> positions, which can be explained by the very small number of substitutions between these genomes.
<fig id="Fig4"><label>Figure 4</label><caption><p>
<bold>RF distances for E.coli/Shigella genomes.</bold> Performance of various alignment-free methods on a set of 26 E.coli/Shigella genomes. Robinson-Foulds distances to the reference tree are shown. For <italic>Spaced Words</italic>, we used a weight of <italic>k</italic>=17 and applied the &#x02018;binary&#x02019; distance function <inline-formula id="IEq39"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$d_{\textit {RC}}^{bin}$
\end{document}</tex-math><mml:math id="M148"><mml:msubsup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">RC</mml:mtext></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bin</mml:mtext></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq39.gif"/></alternatives></inline-formula>. Colour coding as in Figure <xref rid="Fig2" ref-type="fig">2</xref>.</p></caption><graphic xlink:href="13015_2015_32_Fig4_HTML" id="MO4"/></fig></p><p>For the <italic>Roseobacter</italic> genomes we used the same evaluation procedure as for the <italic>E. coli/Shigella</italic> genomes. Here, our new evolutionary distance <italic>d</italic><sub><italic>RC</italic></sub> outperformed the other alignment-free methods, if <italic>don&#x02019;t-care</italic> positions are incorporated in the patterns, and the performance increased with the number of don&#x02019;t-care positions, as shown in Figure <xref rid="Fig5" ref-type="fig">5</xref>. (Without don&#x02019;t-care positions, <italic>i.e.</italic> if classical word-matches are counted, <italic>d</italic><sub><italic>RC</italic></sub> was slightly outperformed by <italic>Co-phylog</italic>, but was still better than all other methods in our comparison). The <italic>RF</italic> distance to the benchmark tree varied between 24 and 28. <italic>Co-phylog</italic> ranked second in this evaluation with a <italic>RF</italic> distance of 28. All other methods achieved a <italic>RF</italic> distance of greater or equal to 30. Surprisingly, <italic>K</italic><sub><italic>r</italic></sub> performs worse than other programs on these sequences.
<fig id="Fig5"><label>Figure 5</label><caption><p>
<bold>RF distances for Roseobacter genomes.</bold> Performance of various alignment-free methods on a set of 32 Roseobacter genomes. Robinson-Foulds distances to the reference tree are shown. <italic>Spaced Words</italic> was used with parameters as in Figure <xref rid="Fig4" ref-type="fig">4</xref>, colour coding is as in Figure <xref rid="Fig2" ref-type="fig">2</xref>.</p></caption><graphic xlink:href="13015_2015_32_Fig5_HTML" id="MO5"/></fig></p></sec><sec id="Sec10"><title>The variance of <italic>N</italic>: experimental results</title><p>Figure <xref rid="Fig1" ref-type="fig">1</xref> shows not only striking differences in the shape of the distance functions used by various alignment-free programs. There are also remarkable differences in the <italic>variance</italic> of the distances calculated with our new distance measure <italic>d</italic><sub><italic>N</italic></sub> that we defined in equation (<xref rid="Equ4" ref-type="">4</xref>). The distance <italic>D</italic><sub><italic>N</italic></sub> is defined in terms of the number <italic>N</italic> of <italic>(spaced) word</italic> matches between two sequences. As mentioned above, the established <italic>Jensen-Shannon</italic> and <italic>Euclidean</italic> distances on (spaced) word frequency vectors also depend on <italic>N</italic>, for small distances, they can be approximated by <italic>L</italic>&#x02212;<italic>N</italic> and <inline-formula id="IEq40"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\sqrt {L-N}$
\end{document}</tex-math><mml:math id="M150"><mml:msqrt><mml:mrow><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msqrt></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq40.gif"/></alternatives></inline-formula>, respectively. Thus, the variances of these three distance measures directly depend on the variance of <italic>N</italic>. As can be seen in Figure <xref rid="Fig1" ref-type="fig">1</xref>, the variance of <italic>d</italic><sub><italic>N</italic></sub> increases with the frequency of substitutions. Also, the variance is higher for the single-pattern approach than for the multiple-pattern approach. To explain this observation, we calculated the <italic>variance</italic> of the normalized number <italic>N</italic>/<italic>m</italic> of spaced-word matches using equation <xref rid="Equ13" ref-type="">12</xref>. Figure <xref rid="Fig6" ref-type="fig">6</xref> summarizes the results for a sequence length of <italic>L</italic>=16.000 and mismatch frequencies of 0.7 and 0.25, respectively. As can be seen, for single spaced words the variance of <italic>N</italic>/<italic>m</italic> is far smaller than for contiguous words, and for multiple spaced words, the variance is further reduced.
<fig id="Fig6"><label>Figure 6</label><caption><p>
<bold>Variance of the number of spaced-word matches.</bold> Variance of the normalized number <inline-formula id="IEq41"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$\frac {N}{m}$
\end{document}</tex-math><mml:math id="M152"><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq41.gif"/></alternatives></inline-formula> of spaced-word matches where <inline-formula id="IEq42"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$m={|\mathcal {P}|}$
\end{document}</tex-math><mml:math id="M154"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>|</mml:mo></mml:math><inline-graphic xlink:href="13015_2015_32_Article_IEq42.gif"/></alternatives></inline-formula> is the number of patterns in the multiple-pattern approach. Formula (<xref rid="Equ13" ref-type="">12</xref>) was applied to contiguous words and to single and multiple spaced words for un-gapped sequence pairs of length 16,000 <italic>nt</italic> with a mismatch frequency of 0.7 (left) and 0.25 (right).</p></caption><graphic xlink:href="13015_2015_32_Fig6_HTML" id="MO6"/></fig></p></sec></sec><sec id="Sec11" sec-type="discussion"><title>Discussion</title><p>In this paper, we proposed a new estimator <italic>d</italic><sub><italic>N</italic></sub> for the evolutionary distance between two DNA sequences that is based on the number <italic>N</italic> of <italic>spaced-word</italic> matches between them. While most alignment-free methods use ad-hoc distance measures, the distance function that we defined is based on a probabilistic model of evolution and seems to be a good estimator for the number of substitutions per site that have occurred since two sequences have evolved separately. For simplicity, we used a model of evolution without insertions and deletions. Nevertheless, our test results show that our distance function is still a reasonable estimator if the input sequences contain a moderate number of insertions and deletions although, in this case, distances between the input sequences are overestimated since the number <italic>N</italic> of spaced-word matches is smaller than it would be for sequences without indels.</p><p>The model that we used to derive our distance <italic>d</italic><sub><italic>N</italic></sub> assumes that two sequences are globally related. If sequences share only local homology, the number <italic>N</italic> of spaced-word matches would be smaller than for globally related sequences with the same length and rate of mismatches, so their distance would be over-estimated by our distance measure <italic>d</italic><sub><italic>N</italic></sub>. This is clearly a limitation of our approach. However, as indicated in section <xref rid="Sec4" ref-type="sec">Estimating evolutionary distances from the number <italic>N</italic> of spaced-word matches</xref>, our distance function can be adapted to the case of <italic>local</italic> homologies if the length of these homologies and the number of gaps in the homologous regions can be estimated. In principle, it should therefore be possible to apply our method to locally related sequences by first estimating the extent of their shared (local) homology and then using the distance <italic>d</italic><sub><italic>loc</italic></sub> defined in equation (<xref rid="Equ6" ref-type="">5</xref>) instead of <italic>d</italic><sub><italic>N</italic></sub>.</p><p>The distance measures introduced in this paper and other distances that we previously used for our <italic>spaced words</italic> approach depend on the number <italic>N</italic> of space-word matches between two sequences with respect to a set <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e7064"/> of patterns of &#x02018;match&#x02019; and &#x02018;don&#x02019;t care&#x02019; positions. This is similar for more traditional alignment-free methods that calculated distances based on <italic>k</italic>-mer frequencies. While the <italic>expected</italic> number of (spaced) word matches is essentially the same for contiguous words and for spaced words of the corresponding <italic>weight</italic>, we have showed that the <italic>variance</italic> of <italic>N</italic> is considerably lower for spaced-words than for the traditionally used contiguous words. Moreover, with our <italic>multiple-pattern</italic> approach the variance of the normalized number of spaced-word matches is further reduced. This seems to be the main reason why our <italic>multiple spaced words</italic> approach outperforms the <italic>single-pattern</italic> approach that we previously introduced as well as the classical <italic>k</italic>-mer approach when used for phylogeny reconstruction.</p><p>As we have shown, the variance of <italic>N</italic> depends on the number of overlapping &#x02018;match&#x02019; positions if patterns from <inline-graphic xlink:href="13015_2015_32_Figa_HTML.gif" id="d30e7101"/> are shifted against each other. Consequently, in our single-pattern approach, the variance of <italic>N</italic> is higher for periodic patterns than for non-periodic patterns. For example, for the periodic pattern 101010&#x02026;, the variance is equal to the variance of the contiguous pattern of the corresponding weight. In our previous benchmark studies, we could experimentally confirm that <italic>spaced words</italic> performs better with non-periodic patterns than with periodic patterns. The theoretical results of this study may be useful to find patterns or sets of patterns that minimize the variance of <italic>N</italic> to further improve our spaced-words approach.</p></sec></body><back><fn-group><fn><p><bold>Competing interests</bold></p><p>The authors declare that they have no competing interests.</p></fn><fn><p><bold>Authors&#x02019; contributions</bold></p><p>BM conceived the new distance measures and the theoretical results on the variance of <italic>N</italic> and wrote most of the manuscripts. CAL implemented <italic>Spaced Words</italic>, did most of the program evaluation and wrote parts of the manuscript. BZ and SH contributed to the program evaluation. All authors read and approved the final manuscript.</p></fn></fn-group><ack><title>Acknowledgements</title><p>We would like to thank Marcus Boden, Sebastian Lindner, Alec Guyomard and Claudine Devauchelle for help with the program evaluation and Gilles Didier for help with the software to compare distance matrices. We thank Matteo Comin, Ruth Kantorovitz, Saurabh Sinha and an unknown WABI reviewer for pointing out an an error regarding the covariance of spaced-word matches in the previous version of this manuscript that was published at WABI 2014.</p></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vinga</surname><given-names>S</given-names></name></person-group><article-title>Editorial: Alignment-free methods in computational biology</article-title><source>Briefings Bioinf.</source><year>2014</year><volume>15</volume><fpage>341</fpage><lpage>2</lpage><pub-id pub-id-type="doi">10.1093/bib/bbu005</pub-id></element-citation></ref><ref id="CR2"><label>2</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Leslie</surname><given-names>C</given-names></name><name><surname>Eskin</surname><given-names>E</given-names></name><name><surname>Noble</surname><given-names>WSS</given-names></name></person-group><article-title>The spectrum kernel: a string kernel for SVM protein classification</article-title><source>Pacific Symposium on Biocomputing</source><year>2002</year><publisher-loc>Singapore</publisher-loc><publisher-name>World Scientific Publishing</publisher-name></element-citation></ref><ref id="CR3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lingner</surname><given-names>T</given-names></name><name><surname>Meinicke</surname><given-names>P</given-names></name></person-group><article-title>Remote homology detection based on oligomer distances</article-title><source>Bioinformatics.</source><year>2006</year><volume>22</volume><fpage>2224</fpage><lpage>31</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btl376</pub-id><?supplied-pmid 16837522?><pub-id pub-id-type="pmid">16837522</pub-id></element-citation></ref><ref id="CR4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lingner</surname><given-names>T</given-names></name><name><surname>Meinicke</surname><given-names>P</given-names></name></person-group><article-title>Word correlation matrices for protein sequence analysis and remote homology detection</article-title><source>BMC Bioinf.</source><year>2008</year><volume>9</volume><fpage>259</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-9-259</pub-id></element-citation></ref><ref id="CR5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Comin</surname><given-names>M</given-names></name><name><surname>Verzotto</surname><given-names>D</given-names></name></person-group><article-title>The irredundant class method for remote homology detection of protein sequences</article-title><source>J Comput Biol.</source><year>2011</year><volume>18</volume><fpage>1819</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1089/cmb.2010.0171</pub-id><?supplied-pmid 21548811?><pub-id pub-id-type="pmid">21548811</pub-id></element-citation></ref><ref id="CR6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Kristiansen</surname><given-names>K</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group><article-title>SOAP: short oligonucleotide alignment program</article-title><source>Bioinformatics.</source><year>2008</year><volume>24</volume><fpage>713</fpage><lpage>4</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btn025</pub-id><?supplied-pmid 18227114?><pub-id pub-id-type="pmid">18227114</pub-id></element-citation></ref><ref id="CR7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Pop</surname><given-names>M</given-names></name><name><surname>Salzberg</surname><given-names>S</given-names></name></person-group><article-title>Ultrafast and memory-efficient alignment of short dna sequences to the human genome</article-title><source>Genome Biol.</source><year>2009</year><volume>10</volume><fpage>25</fpage><pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id></element-citation></ref><ref id="CR8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahmadi</surname><given-names>A</given-names></name><name><surname>Behm</surname><given-names>A</given-names></name><name><surname>Honnalli</surname><given-names>N</given-names></name><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Weng</surname><given-names>L</given-names></name><name><surname>Xie</surname><given-names>X</given-names></name></person-group><article-title>Hobbes: optimized gram-based methods for efficient read alignment</article-title><source>Nucleic Acids Res.</source><year>2011</year><volume>40</volume><fpage>1</fpage><pub-id pub-id-type="pmid">21908400</pub-id></element-citation></ref><ref id="CR9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Patro</surname><given-names>R</given-names></name><name><surname>Mount</surname><given-names>SM</given-names></name><name><surname>Kingsford</surname><given-names>C</given-names></name></person-group><article-title>Sailfish enables alignment-free isoform quantification from RNA-seq reads using lightweight algorithms</article-title><source>Nat Biotechnol.</source><year>2014</year><volume>32</volume><fpage>462</fpage><lpage>4</lpage><pub-id pub-id-type="doi">10.1038/nbt.2862</pub-id><?supplied-pmid 24752080?><pub-id pub-id-type="pmid">24752080</pub-id></element-citation></ref><ref id="CR10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zerbino</surname><given-names>DR</given-names></name><name><surname>Birney</surname><given-names>E</given-names></name></person-group><article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title><source>Genome Res.</source><year>2008</year><volume>18</volume><fpage>821</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1101/gr.074492.107</pub-id><?supplied-pmid 18349386?><pub-id pub-id-type="pmid">18349386</pub-id></element-citation></ref><ref id="CR11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teeling</surname><given-names>H</given-names></name><name><surname>Waldmann</surname><given-names>J</given-names></name><name><surname>Lombardot</surname><given-names>T</given-names></name><name><surname>Bauer</surname><given-names>M</given-names></name><name><surname>Glockner</surname><given-names>F</given-names></name></person-group><article-title>Tetra: a web-service and a stand-alone program for the analysis and comparison of tetranucleotide usage patterns in dna sequences</article-title><source>BMC Bioinf.</source><year>2004</year><volume>5</volume><fpage>163</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-5-163</pub-id></element-citation></ref><ref id="CR12"><label>12</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Chatterji</surname><given-names>S</given-names></name><name><surname>Yamazaki</surname><given-names>I</given-names></name><name><surname>Bai</surname><given-names>Z</given-names></name><name><surname>Eisen</surname><given-names>JA</given-names></name></person-group><article-title>Compostbin: A DNA composition-based algorithm for binning environmental shotgun reads</article-title><source>Research in Computational Molecular Biology, 12th Annual International Conference, RECOMB 2008, Singapore, March 30 - April 2, 2008. Proceedings</source><year>2008</year><publisher-loc>Berlin, Heidelberg</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="CR13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y-W</given-names></name><name><surname>Ye</surname><given-names>Y</given-names></name></person-group><article-title>A novel abundance-based algorithm for binning metagenomic sequences using l-tuples</article-title><source>J Comput Biol.</source><year>2011</year><volume>18</volume><fpage>523</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1089/cmb.2010.0245</pub-id><?supplied-pmid 21385052?><pub-id pub-id-type="pmid">21385052</pub-id></element-citation></ref><ref id="CR14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanaseichuk</surname><given-names>O</given-names></name><name><surname>Borneman</surname><given-names>J</given-names></name><name><surname>Jiang</surname><given-names>T</given-names></name></person-group><article-title>Separating metagenomic short reads into genomes via clustering</article-title><source>Algorithms Mol Biol.</source><year>2012</year><volume>7</volume><fpage>27</fpage><pub-id pub-id-type="doi">10.1186/1748-7188-7-27</pub-id><?supplied-pmid 23009059?><pub-id pub-id-type="pmid">23009059</pub-id></element-citation></ref><ref id="CR15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leung</surname><given-names>HCM</given-names></name><name><surname>Yiu</surname><given-names>SM</given-names></name><name><surname>Yang</surname><given-names>B</given-names></name><name><surname>Peng</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><etal/></person-group><article-title>A robust and accurate binning algorithm for metagenomic sequences with arbitrary species abundance ratio</article-title><source>Bioinformatics.</source><year>2011</year><volume>27</volume><fpage>1489</fpage><lpage>95</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr186</pub-id><?supplied-pmid 21493653?><pub-id pub-id-type="pmid">21493653</pub-id></element-citation></ref><ref id="CR16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Leung</surname><given-names>HCM</given-names></name><name><surname>Yiu</surname><given-names>SM</given-names></name><name><surname>Chin</surname><given-names>FYL</given-names></name></person-group><article-title>Metacluster 5.0: a two-round binning approach for metagenomic data for low-abundance species in a noisy sample</article-title><source>Bioinformatics.</source><year>2012</year><volume>28</volume><fpage>356</fpage><lpage>62</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts397</pub-id></element-citation></ref><ref id="CR17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meinicke</surname><given-names>P</given-names></name><name><surname>Tech</surname><given-names>M</given-names></name><name><surname>Morgenstern</surname><given-names>B</given-names></name><name><surname>Merkl</surname><given-names>R</given-names></name></person-group><article-title>Oligo kernels for datamining on biological sequences: a case study on prokaryotic translation initiation sites</article-title><source>BMC Bioinf.</source><year>2004</year><volume>5</volume><fpage>169</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-5-169</pub-id></element-citation></ref><ref id="CR18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kantorovitz</surname><given-names>M</given-names></name><name><surname>Robinson</surname><given-names>G</given-names></name><name><surname>Sinha</surname><given-names>S</given-names></name></person-group><article-title>A statistical method for alignment-free comparison of regulatory sequences</article-title><source>Bioinformatics.</source><year>2007</year><volume>23</volume><fpage>249</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btm211</pub-id><pub-id pub-id-type="pmid">17032675</pub-id></element-citation></ref><ref id="CR19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leung</surname><given-names>G</given-names></name><name><surname>Eisen</surname><given-names>MB</given-names></name></person-group><article-title>Identifying cis-regulatory sequences by word profile similarity</article-title><source>PloS one.</source><year>2009</year><volume>4</volume><issue>9</issue><fpage>6901</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0006901</pub-id></element-citation></ref><ref id="CR20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Federico</surname><given-names>M</given-names></name><name><surname>Leoncini</surname><given-names>M</given-names></name><name><surname>Montangero</surname><given-names>M</given-names></name><name><surname>Valente</surname><given-names>P</given-names></name></person-group><article-title>Direct vs 2-stage approaches to structured motif finding</article-title><source>Algorithms Mol Biol.</source><year>2012</year><volume>7</volume><fpage>20</fpage><pub-id pub-id-type="doi">10.1186/1748-7188-7-20</pub-id><?supplied-pmid 22908910?><pub-id pub-id-type="pmid">22908910</pub-id></element-citation></ref><ref id="CR21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blaisdell</surname><given-names>BE</given-names></name></person-group><article-title>A measure of the similarity of sets of sequences not requiring sequence alignment</article-title><source>Proc Nat Acad Sci USA.</source><year>1986</year><volume>83</volume><fpage>5155</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1073/pnas.83.14.5155</pub-id><?supplied-pmid 3460087?><pub-id pub-id-type="pmid">3460087</pub-id></element-citation></ref><ref id="CR22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>J</given-names></name></person-group><article-title>Divergence measures based on the shannon entropy</article-title><source>IEEE Trans Inf theory.</source><year>1991</year><volume>37</volume><fpage>145</fpage><lpage>51</lpage><pub-id pub-id-type="doi">10.1109/18.61115</pub-id></element-citation></ref><ref id="CR23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>B</given-names></name><name><surname>Tromp</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>M</given-names></name></person-group><article-title>PatternHunter: faster and more sensitive homology search</article-title><source>Bioinformatics.</source><year>2002</year><volume>18</volume><fpage>440</fpage><lpage>5</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.440</pub-id><?supplied-pmid 11934743?><pub-id pub-id-type="pmid">11934743</pub-id></element-citation></ref><ref id="CR24"><label>24</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Boden</surname><given-names>M</given-names></name><name><surname>Sch&#x000f6;neich</surname><given-names>M</given-names></name><name><surname>Horwege</surname><given-names>S</given-names></name><name><surname>Lindner</surname><given-names>S</given-names></name><name><surname>Leimeister</surname><given-names>C-A</given-names></name><name><surname>Morgenstern</surname><given-names>B</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Bei&#x000df;barth</surname><given-names>T</given-names></name><name><surname>Kollmar</surname><given-names>M</given-names></name><name><surname>Leha</surname><given-names>A</given-names></name><name><surname>Morgenstern</surname><given-names>B</given-names></name><name><surname>Schultz</surname><given-names>A-K</given-names></name><name><surname>Waack</surname><given-names>S</given-names></name><name><surname>Wingender</surname><given-names>E</given-names></name></person-group><article-title>German Conference on Bioinformatics 2013</article-title><source>OpenAccess Series in Informatics (OASIcs)</source><year>2013</year><publisher-loc>Dagstuhl, Germany</publisher-loc><publisher-name>Schloss Dagstuhl&#x02013;Leibniz-Zentrum fuer Informatik</publisher-name></element-citation></ref><ref id="CR25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leimeister</surname><given-names>C-A</given-names></name><name><surname>Boden</surname><given-names>M</given-names></name><name><surname>Horwege</surname><given-names>S</given-names></name><name><surname>Lindner</surname><given-names>S</given-names></name><name><surname>Morgenstern</surname><given-names>B</given-names></name></person-group><article-title>Fast alignment-free sequence comparison using spaced-word frequencies</article-title><source>Bioinformatics.</source><year>2014</year><volume>30</volume><fpage>1991</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu177</pub-id><?supplied-pmid 24700317?><pub-id pub-id-type="pmid">24700317</pub-id></element-citation></ref><ref id="CR26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horwege</surname><given-names>S</given-names></name><name><surname>Lindner</surname><given-names>S</given-names></name><name><surname>Boden</surname><given-names>M</given-names></name><name><surname>Hatje</surname><given-names>K</given-names></name><name><surname>Kollmar</surname><given-names>M</given-names></name><etal/></person-group><article-title><italic>Spaced words</italic> and <italic>kmacs</italic>: fast alignment-free sequence comparison based on inexact word matches</article-title><source>Nucleic Acids Res.</source><year>2014</year><volume>42</volume><fpage>W7</fpage><lpage>W11</lpage><pub-id pub-id-type="doi">10.1093/nar/gku398</pub-id><?supplied-pmid 24829447?><pub-id pub-id-type="pmid">24829447</pub-id></element-citation></ref><ref id="CR27"><label>27</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Onodera</surname><given-names>T</given-names></name><name><surname>Shibuya</surname><given-names>T</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Perner</surname><given-names>P</given-names></name></person-group><article-title>The gapped spectrum kernel for support vector machines</article-title><source>Machine Learning and Data Mining in Pattern Recognition, Lecture Notes in Computer Science</source><year>2013</year><publisher-loc>Berlin,Heidelberg</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="CR28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghandi</surname><given-names>M</given-names></name><name><surname>Mohammad-Noori</surname><given-names>M</given-names></name><name><surname>Beer</surname><given-names>MA</given-names></name></person-group><article-title>Robust <italic>k</italic>-mer frequency estimation using gapped k-mers</article-title><source>J Math Biol.</source><year>2014</year><volume>69</volume><fpage>469</fpage><lpage>500</lpage><pub-id pub-id-type="doi">10.1007/s00285-013-0705-3</pub-id><?supplied-pmid 23861010?><pub-id pub-id-type="pmid">23861010</pub-id></element-citation></ref><ref id="CR29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ghandi</surname><given-names>M</given-names></name><name><surname>Lee</surname><given-names>D</given-names></name><name><surname>Mohammad-Noori</surname><given-names>M</given-names></name><name><surname>Beer</surname><given-names>MA</given-names></name></person-group><article-title>Enhanced regulatory sequence prediction using gapped <italic>k</italic>-mer features</article-title><source>PLoS Comput Biol.</source><year>2014</year><volume>10</volume><issue>7</issue><fpage>1003711</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1003711</pub-id></element-citation></ref><ref id="CR30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ulitsky</surname><given-names>I</given-names></name><name><surname>Burstein</surname><given-names>D</given-names></name><name><surname>Tuller</surname><given-names>T</given-names></name><name><surname>Chor</surname><given-names>B</given-names></name></person-group><article-title>The average common substring approach to phylogenomic reconstruction</article-title><source>J Comput Biol.</source><year>2006</year><volume>13</volume><fpage>336</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1089/cmb.2006.13.336</pub-id><?supplied-pmid 16597244?><pub-id pub-id-type="pmid">16597244</pub-id></element-citation></ref><ref id="CR31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Didier</surname><given-names>G</given-names></name><name><surname>Debomy</surname><given-names>L</given-names></name><name><surname>Pupin</surname><given-names>M</given-names></name><name><surname>Zhang</surname><given-names>M</given-names></name><name><surname>Grossmann</surname><given-names>A</given-names></name><name><surname>Devauchelle</surname><given-names>C</given-names></name><etal/></person-group><article-title>Comparing sequences without using alignments: application to HIV/SIV subtyping</article-title><source>BMC Bioinf.</source><year>2007</year><volume>8</volume><fpage>1</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-8-1</pub-id></element-citation></ref><ref id="CR32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sims</surname><given-names>GE</given-names></name><name><surname>Jun</surname><given-names>S-R</given-names></name><name><surname>Wu</surname><given-names>GA</given-names></name><name><surname>Kim</surname><given-names>S-H</given-names></name></person-group><article-title>Alignment-free genome comparison with feature frequency profiles (FFP) and optimal resolutions</article-title><source>Proc Nat Acad Sci.</source><year>2009</year><volume>106</volume><fpage>2677</fpage><lpage>82</lpage><pub-id pub-id-type="doi">10.1073/pnas.0813249106</pub-id><?supplied-pmid 19188606?><pub-id pub-id-type="pmid">19188606</pub-id></element-citation></ref><ref id="CR33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Domazet-Loso</surname><given-names>M</given-names></name><name><surname>Haubold</surname><given-names>B</given-names></name></person-group><article-title>Alignment-free detection of local similarity among viral and bacterial genomes</article-title><source>Bioinformatics.</source><year>2011</year><volume>27</volume><issue>11</issue><fpage>1466</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr176</pub-id><?supplied-pmid 21471011?><pub-id pub-id-type="pmid">21471011</pub-id></element-citation></ref><ref id="CR34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haubold</surname><given-names>B</given-names></name><name><surname>Reed</surname><given-names>FA</given-names></name><name><surname>Pfaffelhuber</surname><given-names>P</given-names></name></person-group><article-title>Alignment-free estimation of nucleotide diversity</article-title><source>Bioinformatics.</source><year>2011</year><volume>27</volume><fpage>449</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq689</pub-id><?supplied-pmid 21156730?><pub-id pub-id-type="pmid">21156730</pub-id></element-citation></ref><ref id="CR35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Comin</surname><given-names>M</given-names></name><name><surname>Verzotto</surname><given-names>D</given-names></name></person-group><article-title>Alignment-free phylogeny of whole genomes using underlying subwords</article-title><source>Algorithms Mol Biol.</source><year>2012</year><volume>7</volume><fpage>34</fpage><pub-id pub-id-type="doi">10.1186/1748-7188-7-34</pub-id><?supplied-pmid 23216990?><pub-id pub-id-type="pmid">23216990</pub-id></element-citation></ref><ref id="CR36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saitou</surname><given-names>N</given-names></name><name><surname>Nei</surname><given-names>M</given-names></name></person-group><article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title><source>Mol Biol Evol.</source><year>1987</year><volume>4</volume><fpage>406</fpage><lpage>25</lpage><?supplied-pmid 3447015?><pub-id pub-id-type="pmid">3447015</pub-id></element-citation></ref><ref id="CR37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haubold</surname><given-names>B</given-names></name><name><surname>Pierstorff</surname><given-names>N</given-names></name><name><surname>M&#x000f6;ller</surname><given-names>F</given-names></name><name><surname>Wiehe</surname><given-names>T</given-names></name></person-group><article-title>Genome comparison without alignment using shortest unique substrings</article-title><source>BMC Bioinf.</source><year>2005</year><volume>6</volume><fpage>123</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-6-123</pub-id></element-citation></ref><ref id="CR38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yi</surname><given-names>H</given-names></name><name><surname>Jin</surname><given-names>L</given-names></name></person-group><article-title>Co-phylog: an assembly-free phylogenomic approach for closely related organisms</article-title><source>Nucleic Acids Res.</source><year>2013</year><volume>41</volume><fpage>75</fpage><pub-id pub-id-type="doi">10.1093/nar/gkt003</pub-id></element-citation></ref><ref id="CR39"><label>39</label><mixed-citation publication-type="other">Haubold B, Kl&#x000f6;tzl F, Pfaffelhuber P. andi: Fast and accurate estimation of evolutionary distances between closely related genomes. Bioinformatics.doi:10.1093/bioinformatics/btu815.</mixed-citation></ref><ref id="CR40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>No&#x000e9;</surname><given-names>L</given-names></name><name><surname>Martin</surname><given-names>DEK</given-names></name></person-group><article-title>A coverage criterion for spaced seeds and its applications to SVM string-kernels and k-mer distances</article-title><source>J Comput Biol.</source><year>2014</year><volume>12</volume><fpage>947</fpage><lpage>63</lpage><pub-id pub-id-type="doi">10.1089/cmb.2014.0173</pub-id><pub-id pub-id-type="pmid">25393923</pub-id></element-citation></ref><ref id="CR41"><label>41</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Morgenstern</surname><given-names>B</given-names></name><name><surname>Zhu</surname><given-names>B</given-names></name><name><surname>Horwege</surname><given-names>S</given-names></name><name><surname>Leimeister</surname><given-names>C</given-names></name></person-group><article-title>Estimating evolutionary distances from spaced-word matches</article-title><source>Proc. Workshop on Algorithms in Bioinformatics (WABI&#x02019;14). Lecture Notes in Bioinformatics</source><year>2014</year><publisher-loc>Berlin Heidelberg.</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="CR42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lippert</surname><given-names>RA</given-names></name><name><surname>Huang</surname><given-names>H</given-names></name><name><surname>Waterman</surname><given-names>MS</given-names></name></person-group><article-title>Distributional regimes for the number of k-word matches between two random sequences</article-title><source>Proc Nat Acad Sci.</source><year>2002</year><volume>99</volume><fpage>13980</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1073/pnas.202468099</pub-id><?supplied-pmid 12374863?><pub-id pub-id-type="pmid">12374863</pub-id></element-citation></ref><ref id="CR43"><label>43</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reinert</surname><given-names>G</given-names></name><name><surname>Chew</surname><given-names>D</given-names></name><name><surname>Sun</surname><given-names>F</given-names></name><name><surname>Waterman</surname><given-names>MS</given-names></name></person-group><article-title>Alignment-free sequence comparison (i): Statistics and power</article-title><source>J Comput Biol.</source><year>2009</year><volume>16</volume><fpage>1615</fpage><lpage>34</lpage><pub-id pub-id-type="doi">10.1089/cmb.2009.0198</pub-id><?supplied-pmid 20001252?><pub-id pub-id-type="pmid">20001252</pub-id></element-citation></ref><ref id="CR44"><label>44</label><mixed-citation publication-type="other">Jukes TH, Cantor CR. Evolution of Protein Molecules: Academy Press, NY; 1969.</mixed-citation></ref><ref id="CR45"><label>45</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Robin</surname><given-names>S</given-names></name><name><surname>Rodolphe</surname><given-names>F</given-names></name><name><surname>Schbath</surname><given-names>S</given-names></name></person-group><source>DNA, Words and Models: Statistics of Exceptional Words</source><year>2005</year><publisher-loc>Cambridge</publisher-loc><publisher-name>Cambridge University Press</publisher-name></element-citation></ref><ref id="CR46"><label>46</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haubold</surname><given-names>B</given-names></name><name><surname>Pfaffelhuber</surname><given-names>P</given-names></name><name><surname>Domazet-Loso</surname><given-names>M</given-names></name><name><surname>Wiehe</surname><given-names>T</given-names></name></person-group><article-title>Estimating mutation distances from unaligned genomes</article-title><source>J Comput Biol.</source><year>2009</year><volume>16</volume><fpage>1487</fpage><lpage>500</lpage><pub-id pub-id-type="doi">10.1089/cmb.2009.0106</pub-id><?supplied-pmid 19803738?><pub-id pub-id-type="pmid">19803738</pub-id></element-citation></ref><ref id="CR47"><label>47</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leimeister</surname><given-names>C-A</given-names></name><name><surname>Morgenstern</surname><given-names>B</given-names></name></person-group><article-title>kmacs: the <italic>k</italic>-mismatch average common substring approach to alignment-free sequence comparison</article-title><source>Bioinformatics.</source><year>2014</year><volume>30</volume><fpage>2000</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu331</pub-id><?supplied-pmid 24828656?><pub-id pub-id-type="pmid">24828656</pub-id></element-citation></ref><ref id="CR48"><label>48</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qi</surname><given-names>J</given-names></name><name><surname>Luo</surname><given-names>H</given-names></name><name><surname>Hao</surname><given-names>B</given-names></name></person-group><article-title>CVTree: a phylogenetic tree reconstruction tool based on whole genomes</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><issue>suppl 2</issue><fpage>45</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1093/nar/gkh362</pub-id><pub-id pub-id-type="pmid">14704342</pub-id></element-citation></ref><ref id="CR49"><label>49</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>PHYLIP - Phylogeny Inference Package (Version 3.2)</article-title><source>Cladistics.</source><year>1989</year><volume>5</volume><fpage>164</fpage><lpage>6</lpage></element-citation></ref><ref id="CR50"><label>50</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonnet</surname><given-names>E</given-names></name><name><surname>de Peer</surname><given-names>YV</given-names></name></person-group><article-title>zt: A sofware tool for simple and partial mantel tests</article-title><source>J Stat Software.</source><year>2002</year><volume>7</volume><fpage>1</fpage><lpage>12</lpage></element-citation></ref><ref id="CR51"><label>51</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Didier</surname><given-names>G</given-names></name><name><surname>Laprevotte</surname><given-names>I</given-names></name><name><surname>Pupin</surname><given-names>M</given-names></name><name><surname>H&#x000e9;naut</surname><given-names>A</given-names></name></person-group><article-title>Local decoding of sequences and alignment-free comparison</article-title><source>J Comput Biol.</source><year>2006</year><volume>13</volume><fpage>1465</fpage><lpage>76</lpage><pub-id pub-id-type="doi">10.1089/cmb.2006.13.1465</pub-id><?supplied-pmid 17061922?><pub-id pub-id-type="pmid">17061922</pub-id></element-citation></ref><ref id="CR52"><label>52</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>D</given-names></name><name><surname>Foulds</surname><given-names>L</given-names></name></person-group><article-title>Comparison of phylogenetic trees</article-title><source>Mathematical Biosciences.</source><year>1981</year><volume>53</volume><fpage>131</fpage><lpage>47</lpage><pub-id pub-id-type="doi">10.1016/0025-5564(81)90043-2</pub-id></element-citation></ref><ref id="CR53"><label>53</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>X</given-names></name><name><surname>Liu</surname><given-names>B</given-names></name><name><surname>Beutin</surname><given-names>L</given-names></name><name><surname>Xu</surname><given-names>J</given-names></name><name><surname>Ren</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Derivation of Escherichia coli O157:H7 from Its O55:H7 Precursor</article-title><source>PLOS One.</source><year>2010</year><volume>5</volume><fpage>8700</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0008700</pub-id></element-citation></ref><ref id="CR54"><label>54</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newton</surname><given-names>RJ</given-names></name><name><surname>Griffin</surname><given-names>LE</given-names></name><name><surname>Bowles</surname><given-names>KM</given-names></name><name><surname>Meile</surname><given-names>C</given-names></name><name><surname>Gifford</surname><given-names>S</given-names></name><name><surname>Givens</surname><given-names>CE</given-names></name><etal/></person-group><article-title>Genome characteristics of a generalist marine bacterial lineage</article-title><source>ISME J.</source><year>2010</year><volume>4</volume><fpage>784</fpage><lpage>98</lpage><pub-id pub-id-type="doi">10.1038/ismej.2009.150</pub-id><?supplied-pmid 20072162?><pub-id pub-id-type="pmid">20072162</pub-id></element-citation></ref></ref-list></back></article>