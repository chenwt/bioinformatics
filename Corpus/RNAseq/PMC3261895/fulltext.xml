<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v3.0 20080202//EN" "archivearticle3.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.0 20040830//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.0?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3261895</article-id><article-id pub-id-type="publisher-id">PONE-D-11-02167</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0030377</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Computational Biology</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome Analysis Tools</subject></subj-group></subj-group></subj-group><subj-group><subject>Genomics</subject></subj-group></subj-group></article-categories><title-group><article-title>Fast Computation and Applications of Genome Mappability</article-title><alt-title alt-title-type="running-head">Fast Computation of Genome Mappability</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Derrien</surname><given-names>Thomas</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>&#x0002a;</sup></xref></contrib><contrib contrib-type="author"><name><surname>Estell&#x000e9;</surname><given-names>Jordi</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Marco Sola</surname><given-names>Santiago</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Knowles</surname><given-names>David G.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Raineri</surname><given-names>Emanuele</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Guig&#x000f3;</surname><given-names>Roderic</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Ribeca</surname><given-names>Paolo</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>&#x0002a;</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>Institut de G&#x000e9;n&#x000e9;tique et D&#x000e9;veloppement (IGDR), Universit&#x000e9; Rennes 1, Rennes, France</addr-line></aff><aff id="aff2"><label>2</label><addr-line>Centro Nacional de An&#x000e1;lisis Gen&#x000f3;mico (CNAG), Barcelona, Spain</addr-line></aff><aff id="aff3"><label>3</label><addr-line>Centre for Genomic Regulation (CRG), Universitat Pompeu Fabra, Barcelona, Spain</addr-line></aff><contrib-group><contrib contrib-type="editor"><name><surname>Ouzounis</surname><given-names>Christos A.</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">The Centre for Research and Technology, Hellas, Greece</aff><author-notes><corresp id="cor1">&#x0002a; E-mail: <email>toma.derrien@gmail.com</email> (TD); <email>paolo.ribeca@gmail.com</email> (PR)</corresp><fn fn-type="con"><p>Conceived and designed the experiments: TD RG PR. Performed the experiments: TD JE SMS DGK ER PR. Analyzed the data: TD JE DGK ER PR. Contributed reagents/materials/analysis tools: SMS PR. Wrote the paper: TD JE DGK ER RG PR.</p></fn></author-notes><pub-date pub-type="collection"><year>2012</year></pub-date><pub-date pub-type="epub"><day>19</day><month>1</month><year>2012</year></pub-date><volume>7</volume><issue>1</issue><elocation-id>e30377</elocation-id><history><date date-type="received"><day>28</day><month>1</month><year>2011</year></date><date date-type="accepted"><day>19</day><month>12</month><year>2011</year></date></history><permissions><copyright-statement>Derrien et al. This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</copyright-statement><copyright-year>2012</copyright-year></permissions><abstract><p>We present a fast mapping-based algorithm to compute the mappability of each region of a reference genome up to a specified number of mismatches. Knowing the mappability of a genome is crucial for the interpretation of massively parallel sequencing experiments. We investigate the properties of the mappability of eukaryotic DNA/RNA both as a whole and at the level of the gene family, providing for various organisms tracks which allow the mappability information to be visually explored. In addition, we show that mappability varies greatly between species and gene classes. Finally, we suggest several practical applications where mappability can be used to refine the analysis of high-throughput sequencing data (SNP calling, gene expression quantification and paired-end experiments). This work highlights mappability as an important concept which deserves to be taken into full account, in particular when massively parallel sequencing technologies are employed. The GEM mappability program belongs to the GEM (GEnome Multitool) suite of programs, which can be freely downloaded for any use from its website (<ext-link ext-link-type="uri" xlink:href="http://gemlibrary.sourceforge.net">http://gemlibrary.sourceforge.net</ext-link>).</p></abstract><counts><page-count count="16"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Dramatic advances in massively parallel sequencing technologies (also known as <italic>high-throughput sequencing</italic>, HTS or <italic>next-generation sequencing</italic>, NGS) have extended the application of sequencing of nucleic acid to many problems in genomics, epigenomics, and transcriptomics. Whole or targeted genome sequencing and re-sequencing, genome-wide profiling of chromatin status and transcription factor binding through ChIPSeq, quantitative estimation of transcriptome abundance through RNASeq, metagenomic and metatranscriptomic sequencing are a just a few examples. HTS technologies typically produce huge amounts of short sequences (<italic>sequence reads</italic>, or simply <italic>reads</italic>), with different lengths and characteristics (qualities, error rates, structural designs, etc.) depending on the technology employed. A fundamental step of the post-sequencing protocol often consists in efficiently aligning the sequence reads onto a genome used as reference. Numerous short read aligners (or <italic>mappers</italic>) have been developed to achieve this goal with suitable efficiency <xref ref-type="bibr" rid="pone.0030377-Li1">[1]</xref>, <xref ref-type="bibr" rid="pone.0030377-Ribeca1">[2]</xref>. However, owing to the non-random nature of genomes &#x02013;which include a significant proportion of structurally, evolutionary and functionally important repetitive sequences <xref ref-type="bibr" rid="pone.0030377-Huda1">[3]</xref>, <xref ref-type="bibr" rid="pone.0030377-Feschotte1">[4]</xref>&#x02013; one key part of the mapping step is to discern reads that can be aligned to only one single location (<italic>uniquely mapping</italic> reads) from reads matching multiple possible locations in the reference (<italic>multiply mapping</italic> reads). The latter are often interpreted differently by existing mappers, and sometimes even altogether discarded during the analysis steps subsequent to mapping. The specific interpretation of multiply mapping reads may have implications on the outcome of downstream analysis, in particular when reads are used to obtain quantitative estimates. Typical examples are the determination of transcription factor binding affinity (in ChIPSeq experiments) or transcript abundance (in RNASeq experiments). Thus, for a given HTS run one would aim at maximizing the number of unique mappings obtained, in order to exploit most of the signal from the biological input.</p><p>For a given genome, the proportion of uniquely mapped reads depends mostly on the length of the sequence reads produced by the experiment, and on the number of mismatches allowed during the mapping step <xref ref-type="bibr" rid="pone.0030377-Whiteford1">[5]</xref>. Therefore, given the technical specifications of the sequencing experiment it is possible to compute <italic>a priori</italic> the mappability of the whole sequence, i.e., the inverse of the number of times that a read originating from any position in the reference genome maps to the genome itself &#x02013; thus identifying, for instance, the regions that are truly &#x0201c;mappable&#x0201d;, that is those producing reads which map back unambiguously to themselves. Regions with high mappability will tend to produce unique mappings, while regions with low mappability will tend to produce ambiguous mappings. Mappability information can therefore be used <italic>a priori</italic>, as a guide to fine-tune the design of an HTS experiment in order to increase the number of uniquely mappable reads.</p><p>In addition, the mappability information is crucial when quantitative estimates are produced. Indeed, mappability has been originally introduced and used to carry out quantitative studies of binding affinity from ChIPSeq experiments, where the ratio of input versus control peaks cannot be exactly assessed unless the proper normalization factor is known <xref ref-type="bibr" rid="pone.0030377-Rozowsky1">[6]</xref>. In these studies the mappability of various genomes has been investigated without considering mismatches. However, one must make provision for sequencing errors inherent to HTS technologies, as well as for polymorphisms or variants between the individual genome/transcriptome actually sequenced and the genome used as a mapping reference. Therefore, it is customary to allow for mismatches when mapping reads; the <inline-formula><inline-graphic xlink:href="pone.0030377.e001.jpg" mimetype="image"/></inline-formula>-mismatch mappability is not sufficient in these cases. Unfortunately, computing the mappability of a sequence up to even a few mismatches is usually a task orders of magnitude more expensive than when no mismatches are allowed, and hence not one routinely performed.</p><p>In this work, we introduce and describe a mapping-based method to compute the mappability of an entire sequence of the size of a mammalian genome up to an arbitrary number of mismatches, which is guaranteed to be comparatively fast even for short reads and very redundant sequences. The method produces the exact mappability in the case of <inline-formula><inline-graphic xlink:href="pone.0030377.e002.jpg" mimetype="image"/></inline-formula> mismatches, and a very good approximation of it if a non-zero number of mismatches is allowed. For different number of substitutions, we then examine the genome-wide mappability profiles of four model organisms (human, mouse, fly and nematode), for which we also produced visualization schemes as part of the UCSC genome browser <xref ref-type="bibr" rid="pone.0030377-Rhead1">[7]</xref>.</p><p>Second, we study the mappability of the transcribed genomic regions. Since a high proportion of transcripts in a genome exhibit repetitive sequences &#x02013;such as repeated functional units or retrotransposons (LINEs and SINEs)&#x02013; which can influence their mappability profiles, we use our mappability method to explore the variations in mappability of different classes of transcripts, taking the GENCODE annotation <xref ref-type="bibr" rid="pone.0030377-Harrow1">[8]</xref> as a reference. We show that indeed mappability profiles vary greatly with the transcript class (protein-coding genes, non coding RNAs, orthologous families, etc). We thus propose an improved measure of RNA quantification which takes into account the mappability at the level of the single locus.</p><p>Third, we investigate how the use of paired-end sequencing or mate-pair libraries relates to mappability. To this end, we predict and quantify how many of the pairs obtained from a typical DNASeq experiment can be rescued by taking advantage of the uniqueness of one of its reads and of the distance information for the pair.</p><p>In conclusion, we are able to precisely link our findings to the design of a better experiment when the focus is on some particular element in the genome. Our results suggest that the mappability is an important concept to be taken into account when one is trying, for instance, to re-sequence a particular genomic region, or to produce quantitative estimates of transcript abundance from RNASeq experiments.</p></sec><sec sec-type="methods" id="s2"><title>Methods</title><p>Formally, our definition of the mappability is the following. Given some read length <inline-formula><inline-graphic xlink:href="pone.0030377.e003.jpg" mimetype="image"/></inline-formula>, the <inline-formula><inline-graphic xlink:href="pone.0030377.e004.jpg" mimetype="image"/></inline-formula><italic>-frequency</italic> <inline-formula><inline-graphic xlink:href="pone.0030377.e005.jpg" mimetype="image"/></inline-formula> of a sequence at a given position <inline-formula><inline-graphic xlink:href="pone.0030377.e006.jpg" mimetype="image"/></inline-formula> corresponds to the number of times the <inline-formula><inline-graphic xlink:href="pone.0030377.e007.jpg" mimetype="image"/></inline-formula>-mer starting at position <inline-formula><inline-graphic xlink:href="pone.0030377.e008.jpg" mimetype="image"/></inline-formula> appears in the sequence and in its reverse complement, considering as equivalent all the <inline-formula><inline-graphic xlink:href="pone.0030377.e009.jpg" mimetype="image"/></inline-formula>-mers which differ by less than some predefined alignment score (like a given number of mismatches&#x02013;for the sake of simplicity, in the rest of this paper we will assume a framework where only substitutions, and neither insertions nor deletions, are allowed during alignment). For instance, the <inline-formula><inline-graphic xlink:href="pone.0030377.e010.jpg" mimetype="image"/></inline-formula>-frequency up to <inline-formula><inline-graphic xlink:href="pone.0030377.e011.jpg" mimetype="image"/></inline-formula> substitution of the string TICTACTOE at positions <inline-formula><inline-graphic xlink:href="pone.0030377.e012.jpg" mimetype="image"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0030377.e013.jpg" mimetype="image"/></inline-formula> is given by the values <inline-formula><inline-graphic xlink:href="pone.0030377.e014.jpg" mimetype="image"/></inline-formula>. It is possible to define an analogous quantity, the <inline-formula><inline-graphic xlink:href="pone.0030377.e015.jpg" mimetype="image"/></inline-formula><italic>-mappability</italic> or <inline-formula><inline-graphic xlink:href="pone.0030377.e016.jpg" mimetype="image"/></inline-formula><italic>-uniqueness</italic> <inline-formula><inline-graphic xlink:href="pone.0030377.e017.jpg" mimetype="image"/></inline-formula>, as the inverse of the frequency: <inline-formula><inline-graphic xlink:href="pone.0030377.e018.jpg" mimetype="image"/></inline-formula>. While the frequency usually varies by several orders of magnitude, the mappability has the advantage of always being a quantity between <inline-formula><inline-graphic xlink:href="pone.0030377.e019.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0030377.e020.jpg" mimetype="image"/></inline-formula>, and such that the highest possible values of <inline-formula><inline-graphic xlink:href="pone.0030377.e021.jpg" mimetype="image"/></inline-formula> correspond to uniquely mapping position (here, and throughout all the paper, by &#x0201c;unique&#x0201d; we mean &#x0201c;unique up to the specified number of mismatches&#x0201d;).</p><p>Various methods can be employed to compute the exact frequency (and hence the mappability) of a sequence. The simplest one is a brute-force approach, consisting in the explicit enumeration and counting of all the <inline-formula><inline-graphic xlink:href="pone.0030377.e022.jpg" mimetype="image"/></inline-formula>-mers present in the sequence; it is practical only for very short strings. More sophisticated strategies might rely on the traversal of some string data structure &#x02013;like a suffix tree, a suffix array or a hash table&#x02013; to directly obtain an enumeration of the <inline-formula><inline-graphic xlink:href="pone.0030377.e023.jpg" mimetype="image"/></inline-formula>-mers together with their counts; this is what has been used in <xref ref-type="bibr" rid="pone.0030377-Whiteford1">[5]</xref>, <xref ref-type="bibr" rid="pone.0030377-Rozowsky1">[6]</xref>. All such approaches, however, become problematic if mismatches are allowed: the authors of <xref ref-type="bibr" rid="pone.0030377-Rozowsky1">[6]</xref> report for their method a slowdown of a factor of <inline-formula><inline-graphic xlink:href="pone.0030377.e024.jpg" mimetype="image"/></inline-formula> when <inline-formula><inline-graphic xlink:href="pone.0030377.e025.jpg" mimetype="image"/></inline-formula> substitutions are permitted, and they do not go further than evaluating the mappability of just <inline-formula><inline-graphic xlink:href="pone.0030377.e026.jpg" mimetype="image"/></inline-formula> Mb of the human genome using such an edit distance.</p><p>In the case of mismatches, essentially, the problem of computing the frequencies becomes equivalent to that of exhaustively mapping all the positions in the sequence after a suitable choice of the alignment parameters. At a first glance, this goal would seem well within the range of existing high-performance mappers, which may easily attain speeds of several tens of millions of mapped reads per hour; assuming a mapping speed of <inline-formula><inline-graphic xlink:href="pone.0030377.e027.jpg" mimetype="image"/></inline-formula> reads per hour, for instance, it would appear possible to compute the frequencies of the human genome in only about <inline-formula><inline-graphic xlink:href="pone.0030377.e028.jpg" mimetype="image"/></inline-formula> hours, with the additional possibility of distributing the computation among different processors.</p><p>There are two algorithmic issues, however. The first one is that most of the available mappers are not based on exhaustive alignment algorithms; this fact implies that they are unable to report the exact count of all the existing matches for a given sequence (although they can usually return a more or less precise approximation of such a quantity). The second problem concerns performance: most mapping algorithms are usually optimized to quickly report a few matches and most of them become (much) slower when requested to perform full counting queries. In practice, the speed of all implementations of mapping algorithms always shows some dependency on the number of matches found in the reference; this means that aligning one million reads which all map to thousands of locations in the genome will be (much) slower than aligning one million reads mapping uniquely. Performance degradation may become very relevant in the case of a brute-force enumeration of a sequence in a genome (for instance, it is still possible to find in <italic>H.sapiens</italic> genomic locations having <inline-formula><inline-graphic xlink:href="pone.0030377.e029.jpg" mimetype="image"/></inline-formula>-mappability as large as 10,000 when <inline-formula><inline-graphic xlink:href="pone.0030377.e030.jpg" mimetype="image"/></inline-formula> substitutions are allowed &#x02013; like <named-content content-type="gene">ACGGTGGCTCATGCCTGTAATCCCAGCACTTTGGGAGGCCGAGGCGGGCG</named-content>, which appears 15,323 times with less than <inline-formula><inline-graphic xlink:href="pone.0030377.e031.jpg" mimetype="image"/></inline-formula> nucleotide substitutions). In general, performance will be worse when the mappability of a transcriptome is being evaluated, and dramatically worse when small values for <inline-formula><inline-graphic xlink:href="pone.0030377.e032.jpg" mimetype="image"/></inline-formula> are used, as in typical ChIPSeq or MNaseSeq experiments.</p><p>In our framework, the first problem is automatically taken care of by our own genome indexing implementation, which provides for fast exhaustive searches and counting queries <xref ref-type="bibr" rid="pone.0030377-Ribeca1">[2]</xref>. We address the second issue by noting that most of the degradation in performance actually comes from the fraction of <inline-formula><inline-graphic xlink:href="pone.0030377.e033.jpg" mimetype="image"/></inline-formula>-mers showing high frequencies, where thousands of <inline-formula><inline-graphic xlink:href="pone.0030377.e034.jpg" mimetype="image"/></inline-formula>-mers exist which are equivalent within the specified number of mismatches; thus, most of the computational time is actually spent mapping such set of <inline-formula><inline-graphic xlink:href="pone.0030377.e035.jpg" mimetype="image"/></inline-formula>-mers over and over again, each time any single element of the set is mapped.</p><p>To avoid the latter problem at least in part, we perform the following approximation: each time a <inline-formula><inline-graphic xlink:href="pone.0030377.e036.jpg" mimetype="image"/></inline-formula>-mer is mapped within the given number of mismatches to a set of positions <inline-formula><inline-graphic xlink:href="pone.0030377.e037.jpg" mimetype="image"/></inline-formula>, one can pretend that all the positions in <inline-formula><inline-graphic xlink:href="pone.0030377.e038.jpg" mimetype="image"/></inline-formula> have already been mapped, assign to them a frequency value equal to the number of elements in <inline-formula><inline-graphic xlink:href="pone.0030377.e039.jpg" mimetype="image"/></inline-formula>, and skip them altogether from that point on. Such a strategy is not enough to completely factor the redundancy out &#x02013;it is effective in eliminating only the equivalent <inline-formula><inline-graphic xlink:href="pone.0030377.e040.jpg" mimetype="image"/></inline-formula>-mers occurring in the sequence <italic>after</italic> the <inline-formula><inline-graphic xlink:href="pone.0030377.e041.jpg" mimetype="image"/></inline-formula>-mer being mapped&#x02013;, and is only exact for <inline-formula><inline-graphic xlink:href="pone.0030377.e042.jpg" mimetype="image"/></inline-formula>-frequencies when no substitutions are allowed. From a practical standpoint, however, the mappability computed in this way is a good approximation of the exact mappability, and, more importantly, is computationally feasible even when <inline-formula><inline-graphic xlink:href="pone.0030377.e043.jpg" mimetype="image"/></inline-formula> is small. The complete algorithm is as follows.</p><p><bold>Algorithm 1 (Fast mappability computation)</bold> <italic>To compute the </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e044.jpg" mimetype="image"/></inline-formula><italic>-frequencies of a sequence of length </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e045.jpg" mimetype="image"/></inline-formula><italic> up to </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e046.jpg" mimetype="image"/></inline-formula><italic> mismatches, given an approximation parameter </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e047.jpg" mimetype="image"/></inline-formula><italic>:</italic></p><list list-type="order"><list-item><p><bold><italic>initialize and zero</italic></bold><italic> an array </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e048.jpg" mimetype="image"/></inline-formula><italic> of </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e049.jpg" mimetype="image"/></inline-formula><italic> numbers</italic></p></list-item><list-item><p><bold><italic>for</italic></bold><italic> all positions </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e050.jpg" mimetype="image"/></inline-formula><italic> in the sequence </italic><bold><italic>do</italic></bold></p></list-item></list><p><bold><italic>if</italic></bold> <inline-formula><inline-graphic xlink:href="pone.0030377.e051.jpg" mimetype="image"/></inline-formula> <bold><italic>then</italic></bold></p><p><italic>(a) take the </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e052.jpg" mimetype="image"/></inline-formula><italic>-mer </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e053.jpg" mimetype="image"/></inline-formula><italic> starting at position </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e054.jpg" mimetype="image"/></inline-formula></p><p><italic>(b) compute all the positions </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e055.jpg" mimetype="image"/></inline-formula><italic> in the sequence to which </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e056.jpg" mimetype="image"/></inline-formula><italic> maps up to </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e057.jpg" mimetype="image"/></inline-formula><italic> mismatches</italic></p><p><italic>(c) </italic><bold><italic>set</italic></bold> <inline-formula><inline-graphic xlink:href="pone.0030377.e058.jpg" mimetype="image"/></inline-formula></p><p><italic>(d) </italic><bold><italic>if</italic></bold> <inline-formula><inline-graphic xlink:href="pone.0030377.e059.jpg" mimetype="image"/></inline-formula> <bold><italic>then</italic></bold></p><p><bold><italic>for</italic></bold><italic> all positions </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e060.jpg" mimetype="image"/></inline-formula><italic> in </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e061.jpg" mimetype="image"/></inline-formula> <bold><italic>do</italic></bold></p><p><bold><italic>if</italic></bold> <inline-formula><inline-graphic xlink:href="pone.0030377.e062.jpg" mimetype="image"/></inline-formula> <bold><italic>then</italic></bold></p><p><bold><italic>set</italic></bold> <inline-formula><inline-graphic xlink:href="pone.0030377.e063.jpg" mimetype="image"/></inline-formula></p><p><bold><italic>else</italic></bold></p><p><bold><italic>set</italic></bold> <inline-formula><inline-graphic xlink:href="pone.0030377.e064.jpg" mimetype="image"/></inline-formula></p><list list-type="order"><list-item><p><bold><italic>output</italic></bold><italic> the array </italic><inline-formula><inline-graphic xlink:href="pone.0030377.e065.jpg" mimetype="image"/></inline-formula>.</p></list-item></list><p>When <inline-formula><inline-graphic xlink:href="pone.0030377.e066.jpg" mimetype="image"/></inline-formula>, the proposed algorithm provides approximated values for the frequency of positions which are not unique in the sequence: this is due to the fact that, given two different <inline-formula><inline-graphic xlink:href="pone.0030377.e067.jpg" mimetype="image"/></inline-formula>-mers <inline-formula><inline-graphic xlink:href="pone.0030377.e068.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0030377.e069.jpg" mimetype="image"/></inline-formula>, the set <inline-formula><inline-graphic xlink:href="pone.0030377.e070.jpg" mimetype="image"/></inline-formula> of locations equivalent to <inline-formula><inline-graphic xlink:href="pone.0030377.e071.jpg" mimetype="image"/></inline-formula> up to the given number of mismatches is in general different from the set of locations <inline-formula><inline-graphic xlink:href="pone.0030377.e072.jpg" mimetype="image"/></inline-formula> equivalent to <inline-formula><inline-graphic xlink:href="pone.0030377.e073.jpg" mimetype="image"/></inline-formula>; hence, considering <inline-formula><inline-graphic xlink:href="pone.0030377.e074.jpg" mimetype="image"/></inline-formula> as the frequency of both <inline-formula><inline-graphic xlink:href="pone.0030377.e075.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0030377.e076.jpg" mimetype="image"/></inline-formula> is an approximation. However, as stated above the algorithm is acceptable from a practical standpoint since:</p><list list-type="order"><list-item><p>it is exact for the whole sequence when <inline-formula><inline-graphic xlink:href="pone.0030377.e077.jpg" mimetype="image"/></inline-formula></p></list-item><list-item><p>when <inline-formula><inline-graphic xlink:href="pone.0030377.e078.jpg" mimetype="image"/></inline-formula> it still gives correct values for the frequency of the <inline-formula><inline-graphic xlink:href="pone.0030377.e079.jpg" mimetype="image"/></inline-formula>-mers that are unique within the specified number of mismatches, as a <inline-formula><inline-graphic xlink:href="pone.0030377.e080.jpg" mimetype="image"/></inline-formula>-mer <inline-formula><inline-graphic xlink:href="pone.0030377.e081.jpg" mimetype="image"/></inline-formula> can belong to the set <inline-formula><inline-graphic xlink:href="pone.0030377.e082.jpg" mimetype="image"/></inline-formula> of locations equivalent to a previously occurring <inline-formula><inline-graphic xlink:href="pone.0030377.e083.jpg" mimetype="image"/></inline-formula>-mer <inline-formula><inline-graphic xlink:href="pone.0030377.e084.jpg" mimetype="image"/></inline-formula> only if it is not unique; in addition, the parameter <inline-formula><inline-graphic xlink:href="pone.0030377.e085.jpg" mimetype="image"/></inline-formula> allows to propagate an approximated frequency value only when it is sufficiently large</p></list-item><list-item><p>the difference between approximated and real frequency can be large in absolute terms, but in the majority of cases it represents only a relatively small fraction of the correct value, since the optimization affects the locations in proportion to their redundancy.</p></list-item></list><p>Another important observation is about the presence of the maximum function in the <italic>else</italic> branch of case (2d): this choice regulates the case when a <inline-formula><inline-graphic xlink:href="pone.0030377.e086.jpg" mimetype="image"/></inline-formula>-mer is hit more than once during the mapping of other similar <inline-formula><inline-graphic xlink:href="pone.0030377.e087.jpg" mimetype="image"/></inline-formula>-mers. Since the frequency of the <inline-formula><inline-graphic xlink:href="pone.0030377.e088.jpg" mimetype="image"/></inline-formula>-mer will not be directly recomputed due to the chosen optimization strategy, the maximum of all the possibilities is taken as its value, to make sure that an underestimation of the actual value is avoided as much as possible.</p><p>Finally, we emphasize that when the exact mappability is needed the approximation can always be turned off by setting <inline-formula><inline-graphic xlink:href="pone.0030377.e089.jpg" mimetype="image"/></inline-formula>: this produces exact frequencies, albeit at the price of possibly much longer running times if <inline-formula><inline-graphic xlink:href="pone.0030377.e090.jpg" mimetype="image"/></inline-formula> is small and/or the genome is very repetitive.</p><p>We made use of the latter property to test our approximation, and assess how well it correlates with the exact results. To this end we performed two runs for each example, one with the value of <inline-formula><inline-graphic xlink:href="pone.0030377.e091.jpg" mimetype="image"/></inline-formula> automatically selected by the program, and another with <inline-formula><inline-graphic xlink:href="pone.0030377.e092.jpg" mimetype="image"/></inline-formula>; we then compared the results thus obtained.</p><p>We applied such a procedure to both the complete genome of <italic>C.elegans</italic> (using the default value of <inline-formula><inline-graphic xlink:href="pone.0030377.e093.jpg" mimetype="image"/></inline-formula> versus <inline-formula><inline-graphic xlink:href="pone.0030377.e094.jpg" mimetype="image"/></inline-formula>, see <xref ref-type="fig" rid="pone-0030377-g001">Figure 1</xref>) and the chromosome <inline-formula><inline-graphic xlink:href="pone.0030377.e095.jpg" mimetype="image"/></inline-formula> of <italic>H.sapiens</italic> (with the default <inline-formula><inline-graphic xlink:href="pone.0030377.e096.jpg" mimetype="image"/></inline-formula> versus <inline-formula><inline-graphic xlink:href="pone.0030377.e097.jpg" mimetype="image"/></inline-formula>, see <xref ref-type="fig" rid="pone-0030377-g002">Figure 2</xref>); being the richest of its genome in segmental duplications and paralog genes (the <inline-formula><inline-graphic xlink:href="pone.0030377.e098.jpg" mimetype="image"/></inline-formula> of the sequence, with respect to a whole-genome <inline-formula><inline-graphic xlink:href="pone.0030377.e099.jpg" mimetype="image"/></inline-formula> average), human chromosome <inline-formula><inline-graphic xlink:href="pone.0030377.e100.jpg" mimetype="image"/></inline-formula> is particularly suited as a test on the scale of a mammalian chromosome. In both cases we chose an intermediate <inline-formula><inline-graphic xlink:href="pone.0030377.e101.jpg" mimetype="image"/></inline-formula>-mer size of <inline-formula><inline-graphic xlink:href="pone.0030377.e102.jpg" mimetype="image"/></inline-formula> bp. Each panel of the aforementioned Figures focuses on a different set of <inline-formula><inline-graphic xlink:href="pone.0030377.e103.jpg" mimetype="image"/></inline-formula>-mers, all those belonging to the same frequency bin in terms of our <inline-formula><inline-graphic xlink:href="pone.0030377.e104.jpg" mimetype="image"/></inline-formula>-bit reduced-precision representation of the mappability (see next Section) when no approximation is applied. In case of exact computation, such <inline-formula><inline-graphic xlink:href="pone.0030377.e105.jpg" mimetype="image"/></inline-formula>-mers will all fall into one single bin in their respective panel; when the approximation is active, however, some <inline-formula><inline-graphic xlink:href="pone.0030377.e106.jpg" mimetype="image"/></inline-formula>-mers will migrate to other bins of the same panel, since their estimated frequency is now different from the actual value &#x02013; and the better the approximation, the more the <inline-formula><inline-graphic xlink:href="pone.0030377.e107.jpg" mimetype="image"/></inline-formula>-mers staying in their correct bin.</p><fig id="pone-0030377-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.g001</object-id><label>Figure 1</label><caption><title>Effect of our approximation on the frequencies of the <italic>C.elegans</italic> genome, for </title><p><inline-formula><inline-graphic xlink:href="pone.0030377.e108.jpg" mimetype="image"/></inline-formula><bold> and </bold><inline-formula><inline-graphic xlink:href="pone.0030377.e109.jpg" mimetype="image"/></inline-formula>. Both the exact and the approximated data were obtained with gem-mappability, the former by setting the value of parameter <inline-formula><inline-graphic xlink:href="pone.0030377.e110.jpg" mimetype="image"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0030377.e111.jpg" mimetype="image"/></inline-formula>, the latter with the default value of <inline-formula><inline-graphic xlink:href="pone.0030377.e112.jpg" mimetype="image"/></inline-formula> automatically selected by the program after the length of the <italic>C.elegans</italic> genome. Each panel shows how our approximation scatters the <inline-formula><inline-graphic xlink:href="pone.0030377.e113.jpg" mimetype="image"/></inline-formula>-mers originally populating a non-approximate <inline-formula><inline-graphic xlink:href="pone.0030377.e114.jpg" mimetype="image"/></inline-formula>-bit frequence bin into more than one single approximate bin. Using the panel <xref ref-type="bibr" rid="pone.0030377-Burrows1">[9]</xref>&#x02013;<xref ref-type="bibr" rid="pone.0030377-Xavier1">[10]</xref> as an example, one can see that about 80&#x00025; of the <inline-formula><inline-graphic xlink:href="pone.0030377.e115.jpg" mimetype="image"/></inline-formula>-mers fall into the correct bin, while the remaining 20&#x00025; is dispersed in bins from <xref ref-type="bibr" rid="pone.0030377-Rhead1">[7]</xref>&#x02013;<xref ref-type="bibr" rid="pone.0030377-Harrow1">[8]</xref> to <xref ref-type="bibr" rid="pone.0030377-Ponting1">[24]</xref>&#x02013;<xref ref-type="bibr" rid="pone.0030377-Li3">[28]</xref>, with most of the <inline-formula><inline-graphic xlink:href="pone.0030377.e116.jpg" mimetype="image"/></inline-formula>-mers staying in bins close to the correct one. In addition, the color of the bins shows that such a 20&#x00025; of <inline-formula><inline-graphic xlink:href="pone.0030377.e117.jpg" mimetype="image"/></inline-formula>-mers corresponds in absolute terms to a small number (in this example about the 90&#x00025; of the <inline-formula><inline-graphic xlink:href="pone.0030377.e118.jpg" mimetype="image"/></inline-formula>-mers of the genome is unique and hence falls into the [1&#x02013;1] bin, which, as explained in the text, is not perturbed by our approximation owing to the good properties of the latter).</p></caption><graphic xlink:href="pone.0030377.g001"/></fig><fig id="pone-0030377-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.g002</object-id><label>Figure 2</label><caption><title>Effect of our approximation on the frequencies of chromosome </title><p><inline-formula><inline-graphic xlink:href="pone.0030377.e119.jpg" mimetype="image"/></inline-formula><bold> of </bold><bold><italic>H.sapiens</italic></bold><bold>, for </bold><inline-formula><inline-graphic xlink:href="pone.0030377.e120.jpg" mimetype="image"/></inline-formula><bold> and </bold><inline-formula><inline-graphic xlink:href="pone.0030377.e121.jpg" mimetype="image"/></inline-formula>. Both the exact and the approximated data were obtained with gem-mappability, the former by setting the value of parameter <inline-formula><inline-graphic xlink:href="pone.0030377.e122.jpg" mimetype="image"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0030377.e123.jpg" mimetype="image"/></inline-formula>, the latter with the default value of <inline-formula><inline-graphic xlink:href="pone.0030377.e124.jpg" mimetype="image"/></inline-formula> automatically selected by the program after the length of chromosome <inline-formula><inline-graphic xlink:href="pone.0030377.e125.jpg" mimetype="image"/></inline-formula> of <italic>H.sapiens</italic>. Each panel shows how our approximation scatters the <inline-formula><inline-graphic xlink:href="pone.0030377.e126.jpg" mimetype="image"/></inline-formula>-mers originally populating a non-approximate <inline-formula><inline-graphic xlink:href="pone.0030377.e127.jpg" mimetype="image"/></inline-formula>-bit frequence bin into more than one single approximate bin.</p></caption><graphic xlink:href="pone.0030377.g002"/></fig><p>As expected, both Figures show that the approximation is good: in each panel the distribution of <inline-formula><inline-graphic xlink:href="pone.0030377.e128.jpg" mimetype="image"/></inline-formula>-mers is usually centered around the correct frequency value, and the number of approximated values which are very overestimated or very underestimated is uniformly low. Furthermore, <inline-formula><inline-graphic xlink:href="pone.0030377.e129.jpg" mimetype="image"/></inline-formula>-mers having frequencies of less than <inline-formula><inline-graphic xlink:href="pone.0030377.e130.jpg" mimetype="image"/></inline-formula> only appear in their respective bins, as they should after our thresholding rule. However, one can better appreciate the value of the approximation only taking into account another important point: in general, the number of genome positions having a frequency above the threshold <inline-formula><inline-graphic xlink:href="pone.0030377.e131.jpg" mimetype="image"/></inline-formula> is very low (in the case of <italic>C.elegans</italic>, less than <inline-formula><inline-graphic xlink:href="pone.0030377.e132.jpg" mimetype="image"/></inline-formula>; less than <inline-formula><inline-graphic xlink:href="pone.0030377.e133.jpg" mimetype="image"/></inline-formula> for human chromosome 19); hence, the number of incorrectly estimated high-frequency genomic locations will be even lower, and small in absolute terms. In the case of human chromosome 19 and <inline-formula><inline-graphic xlink:href="pone.0030377.e134.jpg" mimetype="image"/></inline-formula> illustrated in <xref ref-type="fig" rid="pone-0030377-g002">Figure 2</xref>, for instance, almost the <inline-formula><inline-graphic xlink:href="pone.0030377.e135.jpg" mimetype="image"/></inline-formula> of the <inline-formula><inline-graphic xlink:href="pone.0030377.e136.jpg" mimetype="image"/></inline-formula>-mers maintain their correct frequency bin after approximation; and more than the <inline-formula><inline-graphic xlink:href="pone.0030377.e137.jpg" mimetype="image"/></inline-formula> fall within <inline-formula><inline-graphic xlink:href="pone.0030377.e138.jpg" mimetype="image"/></inline-formula> bins of distance from the correct one. It should also be mentioned that, being mappability defined as the inverse of the frequency, an underestimation/overestimation of the frequency at a very redundant genomic location will not result in large differences in the value of the mappability for that location, since both the true and the estimated value will be large. We concluded that our approximation is sound for most practical uses.</p><p>Finally, it is evident that the proposed algorithm is still easily distributable, in particular in a multi-threaded shared-memory model (so far, a multi-core parallelization has proven sufficient for all of our computations).</p><sec id="s2a"><title>Implementation</title><p>The algorithm presented in the previous Section has been implemented on top of the GEM (GEnome Multitool) library for the indexing of HTS data <xref ref-type="bibr" rid="pone.0030377-Ribeca1">[2]</xref>. The library provides a very fast C mapping engine, based on the Burrows-Wheeler Transform <xref ref-type="bibr" rid="pone.0030377-Burrows1">[9]</xref> and custom mapping algorithms (whose description is out of the scope of this paper, and will be presented elsewhere). The C library can be accessed via various interfaces written in higher-level programming languages, notably Objective Caml <xref ref-type="bibr" rid="pone.0030377-Xavier1">[10]</xref>; such interfaces allow to prototype and implement new algorithms in a concise way.</p><p>One relevant difference between the algorithm of last Section and our implementation is that we chose to encode the frequency array as reduced-precision <inline-formula><inline-graphic xlink:href="pone.0030377.e139.jpg" mimetype="image"/></inline-formula>-bit numbers, each one representing a range of frequency values; low numbers encode a single value (frequency equal to <inline-formula><inline-graphic xlink:href="pone.0030377.e140.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0030377.e141.jpg" mimetype="image"/></inline-formula>, and so on) while higher numbers represent larger and larger intervals. Although different choices might have been possible, this solution has the clear advantage of providing a consistent reduction in memory consumption. In addition, storing the frequency values at full resolution is hardly useful, since we are usually interested in knowing the exact frequency only when it is small (typically values ranging from <inline-formula><inline-graphic xlink:href="pone.0030377.e142.jpg" mimetype="image"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0030377.e143.jpg" mimetype="image"/></inline-formula>), while we can usually get by with its approximate value when it is in the range of the hundreds, thousands or more. The results are output as a pseudo-multi-FASTA file, where the frequency at each position is encoded as a printable ASCII character.</p><p>Finally, we note that along with the mappability program we also provide a fast retriever; such a program allows the user to pre-index the obtained mappability files (which are huge), and to subsequently query them in an efficient way.</p><sec id="s2a1"><title>Benchmarks</title><p>We evaluated the program on an Intel machine with 8 Xeon X5570 CPU cores clocked at 3 GHz, using 8 cores for all the tests. Such a number of processors has been chosen to reduce the wall-clock running time as much as possible; however, it is likely to be suboptimal, since due to the competition in memory access the efficiency of shared-memory distributed computation decreases when many threads are used.</p><p>Typical running times and memory occupancy for various genomes are shown in <xref ref-type="table" rid="pone-0030377-t001">Table 1</xref>. When the approximation is active, the whole-reference mappabillity can usually be computed within a few hours. On the other hand, in the bottom-most panel one can find the timings obtained when setting the parameter <inline-formula><inline-graphic xlink:href="pone.0030377.e144.jpg" mimetype="image"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0030377.e145.jpg" mimetype="image"/></inline-formula>: this has the effect of turning off our approximation, and is indeed equivalent to performing a brute-force mapping of all the <inline-formula><inline-graphic xlink:href="pone.0030377.e146.jpg" mimetype="image"/></inline-formula>-mers in the genome. For the <italic>H.sapiens</italic> genome, such a method is several times slower than the approximate one at <inline-formula><inline-graphic xlink:href="pone.0030377.e147.jpg" mimetype="image"/></inline-formula>, and completely unfeasible at <inline-formula><inline-graphic xlink:href="pone.0030377.e148.jpg" mimetype="image"/></inline-formula>, thus confirming that the approximation is necessary when <inline-formula><inline-graphic xlink:href="pone.0030377.e149.jpg" mimetype="image"/></inline-formula> is small. On the other hand, a brute-force approach might be practically feasible at large <inline-formula><inline-graphic xlink:href="pone.0030377.e150.jpg" mimetype="image"/></inline-formula>, albeit at the price of much longer running times.</p><table-wrap id="pone-0030377-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.t001</object-id><label>Table 1</label><caption><title>Performance of gem-mappability for different parameters and genome species.</title></caption><alternatives><graphic id="pone-0030377-t001-1" xlink:href="pone.0030377.t001"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e151.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><italic>D.melanogast.</italic></td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><italic>D.melanogast.</italic></td><td align="left" rowspan="1" colspan="1"/></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e152.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;2, <inline-formula><inline-graphic xlink:href="pone.0030377.e153.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;36</td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e154.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;3, <inline-formula><inline-graphic xlink:href="pone.0030377.e155.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;75</td><td align="left" rowspan="1" colspan="1"/></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">Time</td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e156.jpg" mimetype="image"/></inline-formula> mins</td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e157.jpg" mimetype="image"/></inline-formula> mins</td><td align="left" rowspan="1" colspan="1"/></tr><tr><td align="left" rowspan="1" colspan="1">Mem.</td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e158.jpg" mimetype="image"/></inline-formula> GB</td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e159.jpg" mimetype="image"/></inline-formula> GB</td><td align="left" rowspan="1" colspan="1"/></tr><tr><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e160.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><italic>H.sapiens</italic></td><td align="left" rowspan="1" colspan="1"><italic>H.sapiens</italic></td><td align="left" rowspan="1" colspan="1"><italic>H.sapiens</italic></td><td align="left" rowspan="1" colspan="1"><italic>H.sapiens</italic></td><td align="left" rowspan="1" colspan="1"><italic>H.sapiens</italic></td><td align="left" rowspan="1" colspan="1"><italic>H.sapiens</italic></td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e161.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;0, <inline-formula><inline-graphic xlink:href="pone.0030377.e162.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;36</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e163.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;1, <inline-formula><inline-graphic xlink:href="pone.0030377.e164.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;24</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e165.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;2, <inline-formula><inline-graphic xlink:href="pone.0030377.e166.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;36</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e167.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;2, <inline-formula><inline-graphic xlink:href="pone.0030377.e168.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;50</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e169.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;3, <inline-formula><inline-graphic xlink:href="pone.0030377.e170.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;75</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e171.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;4, <inline-formula><inline-graphic xlink:href="pone.0030377.e172.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;100</td></tr><tr><td align="left" rowspan="1" colspan="1">Time</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e173.jpg" mimetype="image"/></inline-formula> mins</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e174.jpg" mimetype="image"/></inline-formula> hrs</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e175.jpg" mimetype="image"/></inline-formula> hrs</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e176.jpg" mimetype="image"/></inline-formula> hrs</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e177.jpg" mimetype="image"/></inline-formula> hrs</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e178.jpg" mimetype="image"/></inline-formula> hrs</td></tr><tr><td align="left" rowspan="1" colspan="1">Mem.</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e179.jpg" mimetype="image"/></inline-formula> GB</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e180.jpg" mimetype="image"/></inline-formula> GB</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e181.jpg" mimetype="image"/></inline-formula> GB</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e182.jpg" mimetype="image"/></inline-formula> GB</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e183.jpg" mimetype="image"/></inline-formula> GB</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e184.jpg" mimetype="image"/></inline-formula> GB</td></tr><tr><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e185.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><italic>H.sapiens</italic></td><td align="left" rowspan="1" colspan="1"><italic>H.sapiens</italic></td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><italic>H.sapiens</italic></td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e186.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;2, <inline-formula><inline-graphic xlink:href="pone.0030377.e187.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;36</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e188.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;2, <inline-formula><inline-graphic xlink:href="pone.0030377.e189.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;50</td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e190.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;4, <inline-formula><inline-graphic xlink:href="pone.0030377.e191.jpg" mimetype="image"/></inline-formula>&#x0200a;=&#x0200a;100</td></tr><tr><td align="left" rowspan="1" colspan="1">Time</td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e192.jpg" mimetype="image"/></inline-formula> days</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e193.jpg" mimetype="image"/></inline-formula> day</td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e194.jpg" mimetype="image"/></inline-formula> hrs</td></tr><tr><td align="left" rowspan="1" colspan="1">Mem.</td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e195.jpg" mimetype="image"/></inline-formula> GB</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e196.jpg" mimetype="image"/></inline-formula> GB</td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e197.jpg" mimetype="image"/></inline-formula> GB</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>We used 8 cores for all the tests. Wall-clock times are reported. In the lowest panel, the timings are those obtained when computing the exact mappability (i.e., with our approximation switched off).</p></fn></table-wrap-foot></table-wrap></sec><sec id="s2a2"><title>Visualization of mappability</title><p>The mappability scores produced by our program can be easily converted to other formats, like those suitable for display in the UCSC genome browser <xref ref-type="bibr" rid="pone.0030377-Rhead1">[7]</xref>. To this end, we just have to compute the mappability at each position out of the corresponding frequency. We note again that the mappability naturally lends itself to a good visualization, since it always has a value between <inline-formula><inline-graphic xlink:href="pone.0030377.e198.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0030377.e199.jpg" mimetype="image"/></inline-formula>, with the highest scores corresponding to uniquely mapping positions. On the other hand, the direct visualization of frequency would be problematic: its dynamic range is large &#x02013;with values possibly varying from <inline-formula><inline-graphic xlink:href="pone.0030377.e200.jpg" mimetype="image"/></inline-formula> to millions&#x02013;, but at the same time the most interesting region is usually that of small values.</p><p>We have created mappability tracks for multiple genome species and annotations, including human (both assembly versions Hg18 and Hg19/GRCH37) and mouse (mm9) genomes. At the time of this writing such tracks are integrated in the official UCSC genome browser (see <xref ref-type="fig" rid="pone-0030377-g003">Figure 3</xref>), and hence can be immediately explored on-line without the need of any further preparation from the user. For other organisms &#x02013;mainly <italic>D.melanogaster</italic> (dm3) and <italic>C.elegans</italic> (ce6)&#x02013; we also generated additional tracks which are not part of the UCSC genome browser; they can be obtained from the authors upon request, and subsequently visualized as custom tracks. In case no precomputed track is available for some organism, the users can easily compute it on their own even on modest hardware.</p><fig id="pone-0030377-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.g003</object-id><label>Figure 3</label><caption><title>Visualization of mappability on the UCSC browser <xref ref-type="bibr" rid="pone.0030377-Rhead1">[<bold>7</bold>]</xref>: the example of the human TK1 gene.</title><p>Six mappability tracks (green) are shown here corresponding to <inline-formula><inline-graphic xlink:href="pone.0030377.e201.jpg" mimetype="image"/></inline-formula>-mer sizes <inline-formula><inline-graphic xlink:href="pone.0030377.e202.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0030377.e203.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0030377.e204.jpg" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0030377.e205.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0030377.e206.jpg" mimetype="image"/></inline-formula> bp (from top to bottom of the figure). Regions with low mappability score have high frequencies, and conversely. This example illustrates that the uniqueness of the TK1 locus (especially within the introns) could be inversely correlated with the presence of some repetitive elements as identified by RepeatMasker <xref ref-type="bibr" rid="pone.0030377-Smit1">[37]</xref>.</p></caption><graphic xlink:href="pone.0030377.g003"/></fig></sec></sec></sec><sec id="s3"><title>Results</title><sec id="s3a"><title>The mappability of eukaryotic genomes</title><p>Given a random sequence of length <inline-formula><inline-graphic xlink:href="pone.0030377.e207.jpg" mimetype="image"/></inline-formula> drawn from an alphabet of <inline-formula><inline-graphic xlink:href="pone.0030377.e208.jpg" mimetype="image"/></inline-formula> symbols, we define its <italic>proper length</italic> <inline-formula><inline-graphic xlink:href="pone.0030377.e209.jpg" mimetype="image"/></inline-formula> as the shortest length such that any string of length <inline-formula><inline-graphic xlink:href="pone.0030377.e210.jpg" mimetype="image"/></inline-formula> is expected to occur in the sequence about once, that is <inline-formula><inline-graphic xlink:href="pone.0030377.e211.jpg" mimetype="image"/></inline-formula>. For instance, the proper length for the human genome is <inline-formula><inline-graphic xlink:href="pone.0030377.e212.jpg" mimetype="image"/></inline-formula> (since <inline-formula><inline-graphic xlink:href="pone.0030377.e213.jpg" mimetype="image"/></inline-formula>), while that of <italic>D.melanogaster</italic> is <inline-formula><inline-graphic xlink:href="pone.0030377.e214.jpg" mimetype="image"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0030377.e215.jpg" mimetype="image"/></inline-formula> only <inline-formula><inline-graphic xlink:href="pone.0030377.e216.jpg" mimetype="image"/></inline-formula>. Hence, for any sequencing read length <inline-formula><inline-graphic xlink:href="pone.0030377.e217.jpg" mimetype="image"/></inline-formula> (a condition already satisfied even by &#x0201c;short&#x0201d; sequence reads of <inline-formula><inline-graphic xlink:href="pone.0030377.e218.jpg" mimetype="image"/></inline-formula> bp produced by early versions of some HTS technologies) one would expect the genome mappability to be <inline-formula><inline-graphic xlink:href="pone.0030377.e219.jpg" mimetype="image"/></inline-formula> almost everywhere &#x02013; that is, that most reads map uniquely.</p><p>However, this is often not the case. There are two main reasons for this deviation from the expected behavior:</p><list list-type="order"><list-item><p>genomes are far from being random; they are the result of a long evolutionary history that includes frequent duplications, involving the whole genome or specific regions <xref ref-type="bibr" rid="pone.0030377-Ohno1">[11]</xref>. The result is a fractal-like structure with repetitions of different nature <xref ref-type="bibr" rid="pone.0030377-Cordaux1">[12]</xref> appearing at different levels of resolution <xref ref-type="bibr" rid="pone.0030377-Kazazian1">[13]</xref> &#x02013; from large structural variants, including segmental duplications <xref ref-type="bibr" rid="pone.0030377-Bailey1">[14]</xref>, to copy number variations <xref ref-type="bibr" rid="pone.0030377-Freeman1">[15]</xref>, long and short interspersed repeats, paralogous gene families, pseudogenes, and modular domains appearing within the sequence of functionally diverse genes <xref ref-type="bibr" rid="pone.0030377-Ohno2">[16]</xref></p></list-item><list-item><p>mismatches are often allowed when mapping HTS reads, and hence in mappability computations. As a result, they lower the number of unique <inline-formula><inline-graphic xlink:href="pone.0030377.e220.jpg" mimetype="image"/></inline-formula>-mers in the genome.</p></list-item></list><p>Even relatively long sequences may map to multiple locations, in particular when mismatches are allowed. Using our method, we have sought to characterize the mappability profiles at a whole genome level for four model organisms (human, mouse, fly, nematode): in <xref ref-type="table" rid="pone-0030377-t002">Table 2</xref> we extend the results obtained in <xref ref-type="bibr" rid="pone.0030377-Rozowsky1">[6]</xref> &#x02013;where the mappability was computed with 0 mismatches&#x02013; by listing the number of uniquely mapping positions in the case of 2 substitutions for three arbitrarily defined read lengths (36, 50 and 75 bp) frequently used in HTS experiments. As expected, mappability correlates with sequence length and number of mismatches: the longer the reads and the smaller the number of mismatches, the higher the uniqueness of the sequence reads. It is interesting to note that with the parameters typically used in ChIPSeq experiments (36-bp reads and two substitutions) a large fraction of eukaryotic genomes is not uniquely mappable: in principle, even exact sequence reads obtained from such loci cannot be inequivocally assigned to their originating positions. As we have already pointed out, this has obvious important implications for quantitative estimates (for instance, transcription factor binding affinity or intensity of chromatin modifications). This fraction represents 30&#x00025; of mammalian and insect genomes at 36 bp; extending the read length increases the uniquely mappable fraction, but even with longer reads of 75 bp (and maintaining constant the number of substitutions, that is effectively increasing the stringency of the mapping) almost 20&#x00025; of the human genome remains unmappable. Even a very restrictive prescription which requires exact mapping (0 mismatches) of 75-bp sequence reads leaves <inline-formula><inline-graphic xlink:href="pone.0030377.e221.jpg" mimetype="image"/></inline-formula> of the human genome unmappable.</p><table-wrap id="pone-0030377-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.t002</object-id><label>Table 2</label><caption><title>Relationship between the proportions/type of repeat elements and the proportion of <inline-formula><inline-graphic xlink:href="pone.0030377.e222.jpg" mimetype="image"/></inline-formula>-mers having a mappability score of 1 (i.e., uniquely mappable).</title></caption><alternatives><graphic id="pone-0030377-t002-2" xlink:href="pone.0030377.t002"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><italic>H.sapiens</italic></td><td align="left" rowspan="1" colspan="1"><italic>M.musculus</italic></td><td colspan="2" align="left" rowspan="1"><italic>D.melanogaster</italic> (dm3)</td><td align="left" rowspan="1" colspan="1"><italic>C.elegans</italic></td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">(hg19)</td><td align="left" rowspan="1" colspan="1">(mm9)</td><td align="left" rowspan="1" colspan="1">with het.</td><td align="left" rowspan="1" colspan="1">without het.</td><td align="left" rowspan="1" colspan="1">(ce6)</td></tr></thead><tbody><tr><td colspan="2" align="left" rowspan="1">Genome size (bp)</td><td align="left" rowspan="1" colspan="1">3,107,677,273</td><td align="left" rowspan="1" colspan="1">2,725,765,481</td><td align="left" rowspan="1" colspan="1">168,736,537</td><td align="left" rowspan="1" colspan="1">159,454,756</td><td align="left" rowspan="1" colspan="1">100,281,426</td></tr><tr><td colspan="2" align="left" rowspan="1">Repeat sequences (bp)</td><td align="left" rowspan="1" colspan="1">1,406,290,513</td><td align="left" rowspan="1" colspan="1">1,153,714,659</td><td align="left" rowspan="1" colspan="1">44,719,009</td><td align="left" rowspan="1" colspan="1">38,601,028</td><td align="left" rowspan="1" colspan="1">13,121,257</td></tr><tr><td colspan="2" align="left" rowspan="1">Proportion of repeats</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e223.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e224.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e225.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e226.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e227.jpg" mimetype="image"/></inline-formula></td></tr><tr><td colspan="2" align="left" rowspan="1">LTR</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e228.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e229.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e230.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1">&#x02013;</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e231.jpg" mimetype="image"/></inline-formula></td></tr><tr><td align="left" rowspan="1" colspan="1">Non-LTR</td><td align="left" rowspan="1" colspan="1">SINEs</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e232.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e233.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e234.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1">&#x02013;</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e235.jpg" mimetype="image"/></inline-formula></td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">LINEs</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e236.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e237.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e238.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1">&#x02013;</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e239.jpg" mimetype="image"/></inline-formula></td></tr><tr><td colspan="7" align="left" rowspan="1">Uniquely mapped positions (<inline-formula><inline-graphic xlink:href="pone.0030377.e240.jpg" mimetype="image"/></inline-formula>)</td></tr><tr><td colspan="2" align="left" rowspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e241.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1">2,489,885,654</td><td align="left" rowspan="1" colspan="1">2,178,433,024</td><td align="left" rowspan="1" colspan="1">119,915,412</td><td align="left" rowspan="1" colspan="1">116,918,511</td><td align="left" rowspan="1" colspan="1">92,332,303</td></tr><tr><td colspan="2" align="left" rowspan="1"/><td align="left" rowspan="1" colspan="1">(<inline-formula><inline-graphic xlink:href="pone.0030377.e242.jpg" mimetype="image"/></inline-formula>)</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e243.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e244.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e245.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e246.jpg" mimetype="image"/></inline-formula></td></tr><tr><td colspan="2" align="left" rowspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e247.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1">2,627,947,484</td><td align="left" rowspan="1" colspan="1">2,267,226,534</td><td align="left" rowspan="1" colspan="1">121,732,432</td><td align="left" rowspan="1" colspan="1">118,368,697</td><td align="left" rowspan="1" colspan="1">93,775,749</td></tr><tr><td colspan="2" align="left" rowspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e248.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e249.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e250.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e251.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e252.jpg" mimetype="image"/></inline-formula></td></tr><tr><td colspan="2" align="left" rowspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e253.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1">2,729,902,459</td><td align="left" rowspan="1" colspan="1">2,349,591,487</td><td align="left" rowspan="1" colspan="1">124,087,375</td><td align="left" rowspan="1" colspan="1">120,329,119</td><td align="left" rowspan="1" colspan="1">95,226,461</td></tr><tr><td colspan="2" align="left" rowspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e254.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e255.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e256.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e257.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e258.jpg" mimetype="image"/></inline-formula></td></tr><tr><td colspan="7" align="left" rowspan="1">Uniquely mapped positions (<inline-formula><inline-graphic xlink:href="pone.0030377.e259.jpg" mimetype="image"/></inline-formula>)</td></tr><tr><td colspan="2" align="left" rowspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e260.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1">2,175,066,863</td><td align="left" rowspan="1" colspan="1">1,964,593,763</td><td align="left" rowspan="1" colspan="1">114,889,241</td><td align="left" rowspan="1" colspan="1">113,088,604</td><td align="left" rowspan="1" colspan="1">87,385,879</td></tr><tr><td colspan="2" align="left" rowspan="1"/><td align="left" rowspan="1" colspan="1">(<inline-formula><inline-graphic xlink:href="pone.0030377.e261.jpg" mimetype="image"/></inline-formula>)</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e262.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e263.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e264.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e265.jpg" mimetype="image"/></inline-formula></td></tr><tr><td colspan="2" align="left" rowspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e266.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1">2,380,109,920</td><td align="left" rowspan="1" colspan="1">2,100,436,231</td><td align="left" rowspan="1" colspan="1">117,178,560</td><td align="left" rowspan="1" colspan="1">114,915,550</td><td align="left" rowspan="1" colspan="1">90,050,144</td></tr><tr><td colspan="2" align="left" rowspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e267.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e268.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e269.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e270.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e271.jpg" mimetype="image"/></inline-formula></td></tr><tr><td colspan="2" align="left" rowspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e272.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1">2,582,297,225</td><td align="left" rowspan="1" colspan="1">2,225,670,208</td><td align="left" rowspan="1" colspan="1">119,798,046</td><td align="left" rowspan="1" colspan="1">116,955,098</td><td align="left" rowspan="1" colspan="1">92,369,340</td></tr><tr><td colspan="2" align="left" rowspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e273.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e274.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e275.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e276.jpg" mimetype="image"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0030377.e277.jpg" mimetype="image"/></inline-formula></td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt102"><label/><p>Repeat elements have been identified and classified by the RepeatMasker program <xref ref-type="bibr" rid="pone.0030377-Smit1">[37]</xref>. The mappability has been computed for <inline-formula><inline-graphic xlink:href="pone.0030377.e278.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0030377.e279.jpg" mimetype="image"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="pone.0030377.e280.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0030377.e281.jpg" mimetype="image"/></inline-formula>.</p></fn></table-wrap-foot></table-wrap><p>While there is a negative correlation between the uniqueness of the genome and its repetitive content, the relationship between genome structure and mappability is more complex. For instance, while the proportion of repeats in the <italic>D.melanogaster</italic> genome is lower than that of mammalian genomes, the fraction of its mappable genome is not larger. Interestingly, in the fly genome, in contrast with the other genomes analyzed, uniqueness does not seem to increase substantially with the read length when moving from 36 to 75 bp. Indeed, with 75-bp reads and two substitutions, about 20&#x00025; of the mammalian genome remains unmappable, but the proportion raises to 30&#x00025; in the case of the fly genome. Even after removing the heterochromatic fraction of the <italic>D.melanogaster</italic> genome &#x02013;which mainly corresponds to repetitive sequences and could lead to an underestimation of the uniqueness of the genome&#x02013; the proportion of uniquely mappable positions in fly remains lower if compared to other model genomes.</p><p>One hypothesis which could explain, in part, the lower fraction of uniquely mappable regions observed in <italic>D.melanogaster</italic> genome might rely on the different nature and proportion of repetitive elements. Indeed, among repeat elements of class I the fly genome does not contain non-LTR retrotransposons such as SINEs <xref ref-type="bibr" rid="pone.0030377-Kaminker1">[17]</xref>, whereas the proportion of LTR retrotransposons constitutes more than one third of the total proportion of repeats (<inline-formula><inline-graphic xlink:href="pone.0030377.e282.jpg" mimetype="image"/></inline-formula> versus <inline-formula><inline-graphic xlink:href="pone.0030377.e283.jpg" mimetype="image"/></inline-formula>; see <xref ref-type="table" rid="pone-0030377-t002">Table 2</xref>). These LTR retrotransposons are found in higher copy number than non-LTR retrotransposons. On the opposite, most of the repetitive sequences in human correspond to non-LTR retrotransposons (Alu sequences) which have a lower number of copies. Thus, the high copy number of LTR retrotransposons in <italic>D.melanogaster</italic> could lead to an over-representation of duplicated <inline-formula><inline-graphic xlink:href="pone.0030377.e284.jpg" mimetype="image"/></inline-formula>-mers that may induce the lower uniqueness observed in this genome.</p></sec><sec id="s3b"><title>Mappability and SNP calling</title><p>In this section we show that computing the mappability of a given genomic region can be critical when inferring single nucleotide variants from HTS data. In fact, these are called by looking at the pileup over the same genomic position, i.e. at the set of symbols which are assigned (by the alignment algorithm) to that position.</p><p>Before proceeding, we observe that our definition of mappability should be refined if we are to deal with pileups. This is due to the fact that the number of possible <inline-formula><inline-graphic xlink:href="pone.0030377.e285.jpg" mimetype="image"/></inline-formula>-mers covering a particular position of the genome is equal to <inline-formula><inline-graphic xlink:href="pone.0030377.e286.jpg" mimetype="image"/></inline-formula>, that is to the read length used for sequencing. In other words, when considering a position of the pileup we are not certain about the starting point of the reads which are contributing to it; therefore, using for it the value of mappability as it had been defined so far does not appear to be the best possible strategy. Thus, to estimate how much mappable a pileup position is when using single-end reads, one could take into account the whole set of possible contributing <inline-formula><inline-graphic xlink:href="pone.0030377.e287.jpg" mimetype="image"/></inline-formula>-mers, and use the mean of their mappabilities (<xref ref-type="fig" rid="pone-0030377-g004">Figure 4</xref>). From now on we will refer to this quantity as to the <italic>pileup mappability</italic>.</p><fig id="pone-0030377-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.g004</object-id><label>Figure 4</label><caption><title>Pileup mappability.</title><p>The number of all possible <inline-formula><inline-graphic xlink:href="pone.0030377.e288.jpg" mimetype="image"/></inline-formula>-mers covering a particular position of the genome (corresponding to nucleotide C) is equal to <inline-formula><inline-graphic xlink:href="pone.0030377.e289.jpg" mimetype="image"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0030377.e290.jpg" mimetype="image"/></inline-formula> in this example). The average of the mappabilities of the <inline-formula><inline-graphic xlink:href="pone.0030377.e291.jpg" mimetype="image"/></inline-formula>-mers can be taken as the <italic>pileup mappability</italic>. Such a quantity represents how mappable would be this position in a pileup of a whole genome sequencing study with reads of length <inline-formula><inline-graphic xlink:href="pone.0030377.e292.jpg" mimetype="image"/></inline-formula>.</p></caption><graphic xlink:href="pone.0030377.g004"/></fig><p>In an ideal case, the pileup would either be composed of one kind of nucleotide only, or it would split into two (roughly equal) subsets, if that position corresponds to an heterozygous locus in a diploid organism. In practice things often go differently, for at least two reasons. First of all there are sequencing errors, which introduce spurious nucleotides in the reads; customarily, one dampens the effect of mis-sequencing by scrutinizing the quality score associated to each letter. Futhermore, due to the fact that genomes contains repeats, each alignment suffers from a certain, unescapable, degree of ambiguity.</p><p>Namely, when two or more stretches of the sequence under study are very similar to each other, it is not possible to exclude that a read contributing to the pileup in a certain position actually belongs to another portion of the molecule: this leads to occasional mismatches in the alignment, which in turn imply variability in the pileup. It is to quantify the above phenomenon that the concept of (pileup) mappability turns out to be very useful. In fact, if we count the number of symbols different from the reference in the pileup over a certain region of the genome (normalized by the coverage), we expect this quantity to be, on average, inversely related to its uniqueness.</p><p>This is indeed what we observe in <xref ref-type="fig" rid="pone-0030377-g005">Figure 5</xref>. To generate it, we considered a pileup computed via the SAMtools pileup utility <xref ref-type="bibr" rid="pone.0030377-Li2">[18]</xref> from reads produced in-house and mapping uniquely to <italic>H.sapiens</italic> chromosomes 15 and 17. We sampled uniformly 100000 positions from each pileup. We then computed the mean heterozygosity (number of symbols in the pileup different from the reference) as a function of the pileup mappability of the position where the read is mapped, grouping together positions with similar levels of mappability.</p><fig id="pone-0030377-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.g005</object-id><label>Figure 5</label><caption><title>Relation between heterozygosity and pileup mappability.</title><p>Low-pileup-mappability regions are more prone to show a high value of heterozygosity than those with high mappability. This is due to the spurious contribution of reads which originate from similar regions belonging to the same mappability group. This figure was obtained for <italic>H.sapiens</italic> chromosomes <inline-formula><inline-graphic xlink:href="pone.0030377.e293.jpg" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0030377.e294.jpg" mimetype="image"/></inline-formula> out of an in-house experiment with average coverage 30<inline-formula><inline-graphic xlink:href="pone.0030377.e295.jpg" mimetype="image"/></inline-formula>.</p></caption><graphic xlink:href="pone.0030377.g005"/></fig><p>The figure clearly suggests that to obtain a set of <italic>bona fide</italic> diploid SNPs it could be certainly worth excluding those coming from regions of low pileup mappability.</p></sec><sec id="s3c"><title>Mappability of the projected transcriptome</title><p>As we have already pointed out, genome mappability is essential when normalizing counts of reads mapping to the genome in order to obtain quantitative estimates from ChIPSeq experiments. Similarly, transcriptome mappability is also essential when computing normalized counts of transcript abundances after an RNASeq experiment. Here, we sought to apply our method in order to investigate transcriptome mappability.</p><p>We use the term transcriptome in the sense being used in RNASeq experiments: a transcript annotation of a reference genome, that is a set of genomic coordinates specifying the exonic structure of transcripts (ideally all known transcripts encoded in the reference genome), or directly the sequence of such transcripts. Most RNASeq protocols map reads to both the genome and the transcriptome, since transcript sequences across splice junctions are not represented in the sequence of the genome.</p><p>In this regard, mappability can be understood in two different ways. First, we may compute frequencies by counting <inline-formula><inline-graphic xlink:href="pone.0030377.e296.jpg" mimetype="image"/></inline-formula>-mers in all transcript sequences. Given the high incidence of alternative splicing in eukaryotic transcriptomes <xref ref-type="bibr" rid="pone.0030377-Wang1">[19]</xref>, mappability obtained in this way is likely to be low. Indeed, exon sequences shared by alternative splice forms will have, by definition, mappability less than one. In fact, deconvolving the originating alternative transcripts of RNASeq reads is one of the most important challenges that need to be overcome to produce accurate quantifications at the alternative transcript level, and a number of methods are being explored towards that end <xref ref-type="bibr" rid="pone.0030377-Trapnell1">[20]</xref>, <xref ref-type="bibr" rid="pone.0030377-Montgomery1">[21]</xref>.</p><p>Alternatively, we can compute frequencies, and from them the mappability, by counting <inline-formula><inline-graphic xlink:href="pone.0030377.e297.jpg" mimetype="image"/></inline-formula>-mers in a non-redundant transcriptome in which transcript coordinates are projected onto the genome, and each exon or exon fragment unique to a set of transcripts is considered only once. This is the sense in which we use mappability in our analysis here.</p><p>As a reference transcriptome dataset, we use the GENCODE annotation of the human genome <xref ref-type="bibr" rid="pone.0030377-Harrow1">[8]</xref>, the most complete transcriptome annotation of this genome currently available. We have partitioned the GENCODE annotated genes into functional sub-classes: protein-coding RNAs (with the Olfactory Receptors, OR, as representative of a superfamily of paralogous genes), long non-coding RNAs (lncRNAs), ribosomal RNAs (rRNAs), pseudogenes, and small non-coding RNAs (considering separately microRNA precursors, miRNAs, and small nuclear RNAs, snRNAs). We have computed the mappability profiles within each of these categories for multiple read lengths and substitution values. Our results appear in <xref ref-type="fig" rid="pone-0030377-g006">Figure 6</xref>. For convenience, we separately display the proportion of GENCODE projected exonic <inline-formula><inline-graphic xlink:href="pone.0030377.e298.jpg" mimetype="image"/></inline-formula>-mers having a frequency of one (unique mappings, maximum mappability) from those having a frequency greater than one (multiple mappings, low mappability) for each combination of the tested parameters: 0 or 2 substitutions, and read lengths of 36, 40, 50, 75 and 100 nucleotides.</p><fig id="pone-0030377-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.g006</object-id><label>Figure 6</label><caption><title>Influence of mismatch values and read lengths on the mappability of the human projected transcriptome as defined by GENCODE <xref ref-type="bibr" rid="pone.0030377-Harrow1">[<bold>8</bold>]</xref>.</title><p>For simplicity, we display the proportion of <inline-formula><inline-graphic xlink:href="pone.0030377.e299.jpg" mimetype="image"/></inline-formula>-mers having a frequency of <inline-formula><inline-graphic xlink:href="pone.0030377.e300.jpg" mimetype="image"/></inline-formula> (i.e. uniquely mappable) and those having a frequency <inline-formula><inline-graphic xlink:href="pone.0030377.e301.jpg" mimetype="image"/></inline-formula> (ambiguous) on the first and second row, respectively. The influence of mismatch number and <inline-formula><inline-graphic xlink:href="pone.0030377.e302.jpg" mimetype="image"/></inline-formula>-mer lengths are presented in the first and second column, respectively.</p></caption><graphic xlink:href="pone.0030377.g006"/></fig><p>As expected, the mappability score of a particular <inline-formula><inline-graphic xlink:href="pone.0030377.e303.jpg" mimetype="image"/></inline-formula>-mer in the transcriptome never decreases when increasing the read length; on the other hand, it always tends to decrease when increasing the number of mismatches <xref ref-type="bibr" rid="pone.0030377-Du1">[22]</xref>. However, important differences can be observed between gene classes. For instance, within a mappability profile computed with at least 2 substitutions almost 90&#x00025; of the protein-coding <inline-formula><inline-graphic xlink:href="pone.0030377.e304.jpg" mimetype="image"/></inline-formula>-mer exons will be mapped uniquely, even with short sequence reads of 36 bp, whereas this fraction is only 20&#x00025; for rRNAs, even with longer reads of 100 bp.</p><p>It is worth noting that, even if in general protein-coding genes all share a high mappability, large paralogous families are likely to originate smaller fractions of uniquely mappable reads. For instance, the fraction of mappable reads for the roughly <inline-formula><inline-graphic xlink:href="pone.0030377.e305.jpg" mimetype="image"/></inline-formula> olfactory receptors annotated in GENCODE is at least <inline-formula><inline-graphic xlink:href="pone.0030377.e306.jpg" mimetype="image"/></inline-formula>&#x00025; less than the average of protein-coding genes for all read lengths and number of substitutions considered. This and similar cases will originate a clear bias whenever transcript expression measurements of paralog genes are attempted during RNASeq experiments.</p><p>Pseudo-genes, which still share a relevant sequence similarity with their parent genes, show an even lower mappable fraction. Interestingly, the highest variation observed between the mappability computed with 0 and 2 substitutions concerns pseudogenes (from 69&#x00025; to 44&#x00025;, respectively). This observation might be due to the fact that duplicated pseudogenes present in many copies escape purifying selection, and thus tend to accumulate more mutations if compared to their parent genes.</p><p>The long non-coding RNAs (lncRNAs) <xref ref-type="bibr" rid="pone.0030377-Amaral1">[23]</xref>, <xref ref-type="bibr" rid="pone.0030377-Ponting1">[24]</xref> also seem to be less unique than protein-coding sequences; interestingly, they contain a significant proportion of nucleotide mapping more than <inline-formula><inline-graphic xlink:href="pone.0030377.e307.jpg" mimetype="image"/></inline-formula>-<inline-formula><inline-graphic xlink:href="pone.0030377.e308.jpg" mimetype="image"/></inline-formula> times in the genome, probably reflecting their tendency to be enriched in repetitive elements such as SINEs or LINEs <xref ref-type="bibr" rid="pone.0030377-rom1">[25]</xref>. Finally, the short non-coding RNAs (separated into miRNAs and snRNAs) present distinct mappability profiles which are directly related to the presence of subfamilies and/or derived pseudo-copies within each class. For instance, our manual investigation of the peculiar peak in the proportion of rRNA <inline-formula><inline-graphic xlink:href="pone.0030377.e309.jpg" mimetype="image"/></inline-formula>-mers that could be mapped <inline-formula><inline-graphic xlink:href="pone.0030377.e310.jpg" mimetype="image"/></inline-formula>-<inline-formula><inline-graphic xlink:href="pone.0030377.e311.jpg" mimetype="image"/></inline-formula> times (see <xref ref-type="fig" rid="pone-0030377-g007">Figure 7</xref>) showed that the phenomenon is due to a the sub-family of 5S rRNAs belonging to the large subunit of the ribosome, clustered together on chromosome <inline-formula><inline-graphic xlink:href="pone.0030377.e312.jpg" mimetype="image"/></inline-formula>.</p><fig id="pone-0030377-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.g007</object-id><label>Figure 7</label><caption><title>Cluster of 5S rRNAs on human chr1 exhibiting a very low mappability profile.</title><p>This locus explains the peaks observed for annotated rRNAs in the frequency range <inline-formula><inline-graphic xlink:href="pone.0030377.e313.jpg" mimetype="image"/></inline-formula>-<inline-formula><inline-graphic xlink:href="pone.0030377.e314.jpg" mimetype="image"/></inline-formula>.</p></caption><graphic xlink:href="pone.0030377.g007"/></fig></sec><sec id="s3d"><title>Refining expression level measure derived from RNASeq data</title><p>Transcriptome mappability can be used to produce more accurate estimates of transcript abundances from RNASeq experiments. As we have seen, some gene classes and families are characterized by low sequence uniqueness, meaning that reads mapping to their sequence are likely to map to (many) other locations in the genome/transcriptome. Different RNASeq mapping and quantification strategies deal with this issue in different ways. They may simply ignore reads that either map to multiple locations <xref ref-type="bibr" rid="pone.0030377-Marioni1">[26]</xref> or fall in low-mappability regions <xref ref-type="bibr" rid="pone.0030377-Morin1">[27]</xref>. They may select one mapping location (or a few), either randomly <xref ref-type="bibr" rid="pone.0030377-Li3">[28]</xref> or using additional context-based information &#x02013; such as the mapping of mate pairs in paired end sequencing, or the density of mappings in the neighborhood <xref ref-type="bibr" rid="pone.0030377-Faulkner1">[29]</xref>, <xref ref-type="bibr" rid="pone.0030377-Mortazavi1">[30]</xref>. Finally, some quantification strategies keep all mapping locations (within the capacities of the used mapping algorithm) and possibly, during the quantification step, employ a statistical model (such as Poisson distribution, Bayesian networks, maximum likelihood, etc.) to infer read counts among all transcripts <xref ref-type="bibr" rid="pone.0030377-Li1">[1]</xref>, <xref ref-type="bibr" rid="pone.0030377-Trapnell1">[20]</xref>, <xref ref-type="bibr" rid="pone.0030377-Li4">[31]</xref>&#x02013;<xref ref-type="bibr" rid="pone.0030377-Paaniuc1">[33]</xref>.</p><p>A widespread measure of exon, transcript and gene abundance in RNASeq experiments is the so-called RPKM (Reads Per Kilobase of exon per Million mapped reads) <xref ref-type="bibr" rid="pone.0030377-Mortazavi1">[30]</xref>. If reads mapping to multiple locations are simply discarded, as it is often the case, RPKM may underestimate the expression of genes belonging to conserved paralogous families.</p><p>For instance, let us assume that two genes exist, both having exactly the same length and originating exactly the same number of reads, but the first being uniquely mappable on its entire length (mappability equal to one everywhere), while the second is uniquely mappabile only in half of its length. Insofar as non-unique reads are ignored, if the two genes are equally expressed the RPKM of the second one will artificially turn out to be the half of that of the first one.</p><p>In fact, if reads mapping to multiple locations are discarded, only locations with mappability of one can actually contribute to the normalization of expression. In such a case, therefore, we suggest to compute RPKM considering only the fraction of uniquely mappable positions of the feature being quantified (exon, transcript, gene). More specifically, we suggest to compute instead the Reads Per Kilobase of Unique exon per Million mapped reads (RPKUM). <xref ref-type="fig" rid="pone-0030377-g008">Figure 8</xref> illustrates the comparison between RPKM and RPKUM values for GENCODE protein-coding genes. Both expression measures were computed using an RNASeq experiment of the human brain transcriptome which produced 32-bp reads <xref ref-type="bibr" rid="pone.0030377-Wang1">[19]</xref>. In this analysis, we have mapped the reads to both genome and transcriptome using GEM <xref ref-type="bibr" rid="pone.0030377-Ribeca1">[2]</xref>, and allowing for two mismatches.</p><fig id="pone-0030377-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.g008</object-id><label>Figure 8</label><caption><title>Comparison of Gencode protein-coding genes RPKM and RPKUM expression values as measured in brain tissue (data from <xref ref-type="bibr" rid="pone.0030377-Wang1">[<bold>19</bold>]</xref>).</title><p>Both axis are log-scaled, and each dot represents a protein-coding gene with or without annotated paralogous genes (in green and red, respectively). Protein coding genes totally or partially included in segmental duplications are presented in the top panel, whereas those not overlapping segmental duplications are shown in the bottom panel. The figure illustrates the importance of taking into account the mappability information in order not to underestimate expression level. Without mappability correction, two main reasons are shown to introduce a bias in the quantification of expression levels: gene having paralogs, and genes overlapping segmental duplications.</p></caption><graphic xlink:href="pone.0030377.g008"/></fig><p>Separately, we produced the mappability profile of the human genome with identical mapping parameters (<inline-formula><inline-graphic xlink:href="pone.0030377.e315.jpg" mimetype="image"/></inline-formula>-mer length 32, and at most 2 mismatches). Then, for each protein-coding gene annotated by GENCODE, we computed the RPKM and the RPKUM as defined previously. As one can readily observe, for a substantial number of genes the RPKUM measure is significantly higher than the corresponding RPKM, and for few of them the differences may be of up to several orders of magnitude (<xref ref-type="fig" rid="pone-0030377-g008">Figure 8</xref>). Clearly, genes exhibiting the highest difference between RPKM and RPKUM typically belong to either of the following two families:</p><list list-type="order"><list-item><p>genes partially or totally included a segmental duplication as defined in <xref ref-type="bibr" rid="pone.0030377-Bailey2">[34]</xref> (top panel of <xref ref-type="fig" rid="pone-0030377-g008">Figure 8</xref>)</p></list-item><list-item><p>genes having at least one paralog (green dots) as identified by the Ensembl Compara database <xref ref-type="bibr" rid="pone.0030377-Vilella1">[35]</xref>.</p></list-item></list><p>A striking example is the HLA-A gene (Human Leucocyte Antigen, class I, A) involved in the major histocompatibility complex, which has many paralogs (<xref ref-type="fig" rid="pone-0030377-g009">Figure 9</xref>). More generally, amongst the top 1000 genes exhibiting the highest variations between RPKM and RPKUM, 741 (74,1&#x00025;) have at least one paralog gene.</p><fig id="pone-0030377-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.g009</object-id><label>Figure 9</label><caption><title>Influence of paralogous genes on the mappability scores: the example of the HLA-A gene.</title><p>The HLA-A gene is part of the Major Histocompatibility Complex (MHC) involving a large gene family with numerous paralogs. This screenshot of the UCSC genome browser (with the six mappability tracks in green) illustrates the low uniqueness of the HLA-A gene (especially, its exon 4) which could render its targeting by RNASeq difficult (if only uniquely mapping reads are considered).</p></caption><graphic xlink:href="pone.0030377.g009"/></fig><p>It should be noted that the importance of computing the uniquely mappable area of a transcript in order to refine its RNA abundance quantification is gaining more and more attention: for instance, a very sophisticated strategy to accurately perform this task has been recently presented in <xref ref-type="bibr" rid="pone.0030377-Lee1">[36]</xref>. However, such a strategy does not rely on the explicit pre-computation of the mappability, nor it takes mismatches into account when computing the length of mappable regions: using our algorithm as the first step of that method might lead to even better results.</p><p>If the chosen RNASeq mapping strategy consists of selecting one mapping location among the many possible ones, mappability can still be used as an additional criterion to help in the selection. Finally, if the contribution of mapped reads to the quantification of transcriptional features (exons, transcripts, genes, etc.) is weighted by the number of mapping locations, the frequencies as computed by our method may also be relevant. Indeed, being not exhaustive, most mapping algorithms are unable to report the exact number of existing matches, and hence the exact frequency value. Thus the frequencies produced by our method (provided that a suitable value for <inline-formula><inline-graphic xlink:href="pone.0030377.e316.jpg" mimetype="image"/></inline-formula> is chosen, as explained in Section Methods) would produce more accurate corrections.</p><sec id="s3d1"><title>Mapping and mappability: a complicated relation</title><p>One fact in need of being emphasized is that, when mapping with mismatches, the relation between mapping uniqueness and mappability is rather complex. Given some edit distance greater than 0, indeed, some counterintuitive situations might arise, where a read which does not occur in the genome maps uniquely (within the specified edit distance) to a repetitive location having a low mappability. This fact is illustrated with the toy example of <xref ref-type="fig" rid="pone-0030377-g010">Figure 10</xref>, where one substitution is used as the maximum allowed edit distance both for computing the mappability and for mapping. With such a choice of parameters the read will map to only one location; yet this position is not unique in the genome, since it has a frequency of <inline-formula><inline-graphic xlink:href="pone.0030377.e317.jpg" mimetype="image"/></inline-formula> (or, equivalently, a mappability score of <inline-formula><inline-graphic xlink:href="pone.0030377.e318.jpg" mimetype="image"/></inline-formula>). A similar phenomenon happens each time the placement of sequencing errors present in the read forbids the mapping to all copies of a repeated region but one.</p><fig id="pone-0030377-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.g010</object-id><label>Figure 10</label><caption><title>Read mapping and mappability are different concepts: there is no straightforward relation between the number of times a read matches the genome and the mappability of the regions it maps to.</title><p>Within an edit distance of 1 mismatch, the sequence IMG maps uniquely to location ING in the schematic genome &#x0201c;......PING-PONG.....&#x0201d;. However, the matched position is not unique in the genome, since considering 1 mismatch it has a frequency of 2 due to location ONG.</p></caption><graphic xlink:href="pone.0030377.g010"/></fig><p>In conclusion, knowing that a read maps uniquely to a location is in general <italic>not</italic> enough to establish, when mismatches are considered, that such a location is unique. In this case, a better indicator for the &#x0201c;uniqueness of the read&#x0201d; is likely to be the theoretical mappability of the region, which has to have been computed separately. The existence of this problem is often overlooked.</p><p>Strictly speaking, this not-so-straightforward connection also complicates the (re)definition of expression measures able to take correctly into account the reduced number of unique reads in repetitive loci; however, neither this observation diminishes the need for such measures, nor it makes less natural and appealing the definition of the RPKUM measure previously presented earlier.</p></sec></sec><sec id="s3e"><title>Mappability of paired-end reads</title><p>In this last section, we examine how the mappability information can be used together with paired-end/mate-pair sequencing to improve the design of an HTS experiment. In particular, we show that when the mappability is known it is possible to tune the insert size in order to maximize the number of sequencing pairs which one will be able to rescue by resorting to the uniqueness of either end.</p><p>When using paired-end reads (or mate-pairs), the mapping information of one end can be used to discard spurious mapping positions of the other end if one takes into account the expected distance between ends imposed by the library size used for sequencing. In consequence, when sequencing with a paired-end type strategy, the <italic>paired-end mappability</italic> of a position <inline-formula><inline-graphic xlink:href="pone.0030377.e319.jpg" mimetype="image"/></inline-formula> will be function of both its own single-end mappability and the mappabilities of the positions located at <inline-formula><inline-graphic xlink:href="pone.0030377.e320.jpg" mimetype="image"/></inline-formula>, being <inline-formula><inline-graphic xlink:href="pone.0030377.e321.jpg" mimetype="image"/></inline-formula> the library size (see <xref ref-type="fig" rid="pone-0030377-g011">Figure 11</xref>).</p><fig id="pone-0030377-g011" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.g011</object-id><label>Figure 11</label><caption><title>Schematic representation of the computation of the paired-end mappability.</title><p>In this example the average of the single-end mappabilities at the target position (base C) is bigger than the average of the single-end mappabilities at one of the pairs (base A). Hence the resulting paired-end mappability will be the average of the mean mappabilities at C and A.</p></caption><graphic xlink:href="pone.0030377.g011"/></fig><p>To facilitate the analysis, we have assumed that the standard deviation of the fragment size in each library is zero (that is, all the fragments in the library are having exactly the same size, and hence all the pairs the same distance).</p><p>Given the assumptions just presented, it is straightforward to conclude that exactly three cases are possible, as follows (in <xref ref-type="fig" rid="pone-0030377-g011">Figure 11</xref> we illustrate them for the case of paired-end pileup mappability):</p><list list-type="order"><list-item><p>the single-end mappability of the target position is bigger than, or equal to, the mappabilities of the two possible pairs: the paired-end mappability is not affected by the mappability of the pairs</p></list-item><list-item><p>the single-end mappability of the target position is smaller than the mappabilities of one of the pairs: as the new mappability of the target, one can take the average of the single-end mappability of the target and the single-end mappability of that pair</p></list-item><list-item><p>the single-end mappability of the target positon is smaller than the mappabilities of the two possible pairs: as the new mappability of the target, one can take the average of the single-end mappabilities of the two possible pairs.</p></list-item></list><p>The latter two cases might allow &#x02013;depending on the single-end mappability of the various loci&#x02013; to rescue reads which are not by themselves uniquely mappable.</p><p>It should be noted that in our calculations we did not take into account paired-end configurations which, while not being unique at any of the pairs, could be still rescued due to the fact that only one of the possible matches for the pair is having the expected insert size. On the contrary, we might be overestimating the mappability of the flanks of regions having long series of tandem repeats: in such a case, a big standard deviation in the sizes of the fragments belonging to a library would complicate the process of identifying a single compatible pair by the expected size of the insert region between the ends, as the problematic reads will have alternative mapping positions very close to each other.</p><p>In <xref ref-type="fig" rid="pone-0030377-g012">Figure 12</xref> we present the results of a comparison of single-end and paired-end mappabilities for human chromosome 1 (HSA1) when using a library size of 800 bp. On the heatmap plots one can spot that even when using 100-bp reads the increase in unique mappability can be considerable if the pair information is integrated. Another interesting feature is the distribution of the positions of HSA1 having different single- and paired-end mappabilities: we can clearly identify the centromere position as the one where both mappabilities are the same (and close to zero).</p><fig id="pone-0030377-g012" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.g012</object-id><label>Figure 12</label><caption><title>Behavior of pileup single-end and paired-end mappabilities at different loci of human chromosome 1 (HSA1).</title><p>Parameters used to generate this example were: <inline-formula><inline-graphic xlink:href="pone.0030377.e322.jpg" mimetype="image"/></inline-formula>-mer length 100, 2 mismatches and a library size of 800 bases. Top left: Heatmap of the number of locations in HSA1 as a function of their single-end and paired-end mappabilities. Bottom left: Histogram of the number of locations in HSA1 that show different single-end and paired-end mappabilities, plotted versus their position along the chromosome. Top right: Heatmap of the number of locations in HSA1 as a function of their single-end mappability and their position along the chromosome. Bottom right: Heatmap of the number of locations in HSA1 as a function of their paired-end mappability and their position along the chromosome.</p></caption><graphic xlink:href="pone.0030377.g012"/></fig><p>Additionally, in order to evaluate the importance of using paired-end information when processing the results of read mapping, we have estimated the single- and paired-end mappability of 100-bp reads for a set of library sizes (300, 400, 500, 600, 700, 800, 900, 1000, 1500, 2000, 4000, 6000, 8000 and 10000 bp) along the whole human genome. To this end, we have estimated which proportion of positions having a non-1 single-end mappability can be rescued completely owing to the fact that both possible pairs in a paired-end experiment are unique. <xref ref-type="fig" rid="pone-0030377-g013">Figure 13</xref> clearly shows that when increasing the library size also the proportion of reads rescued with this method increases; for large library sizes and some chromosomes (e.g. 3, 4 or 6), such proportion can be higher than 50&#x00025;.</p><fig id="pone-0030377-g013" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0030377.g013</object-id><label>Figure 13</label><caption><title>Proportion of completely rescuable positions for all human chromosomes.</title><p>In this figure we only consider positions having a single-end mappability greater than 1, and for different library sizes (300, 400, 500, 600, 700, 800, 900, 1000, 1500, 2000, 4000, 6000, 8000 and 10000 bp) we plot the fraction of locations which could be rescued by taking advantage of the fact that they have a paired-end mappability equal to one.</p></caption><graphic xlink:href="pone.0030377.g013"/></fig><p>Remarkably, at small library sizes (<inline-formula><inline-graphic xlink:href="pone.0030377.e323.jpg" mimetype="image"/></inline-formula> bp) the fraction of rescued reads increases very fast with the distance between the ends. At this scale, the improvement in uniqueness is expected to happen in short regions of the genome (like transposons) which can be seen as unique if they are smaller than the library size, and such that the sequence context around them is itself unique. On the contrary, while for bigger library sizes the percentage of rescued reads keeps growing, the slope of the improvement is much smaller. This result would seem to indicate that in the latter case the repetitive regions we are trying to rescue are much bigger (for instance, this could be the predominant situation for chromosome Y, where the advantage given by such a rescuing strategy turns out to be minimal).</p></sec></sec><sec id="s4"><title>Discussion</title><p>In this work, we explore the mappability concept with unprecedented detail, presenting a fast algorithm to compute a well-behaved approximation of the mappability at the level of an entire mammalian genome, even when mismatches are allowed or when small read lengths are used. Our program is freely available, and can be easily used to construct mappability profiles of any given genome. Our visualization tracks of human and mouse mappability profiles are already accessible through the official UCSC genome browser, and more could be uploaded as custom tracks for different model organisms. Auxiliary tracks can be easily derived from the existing ones to account, for instance, for CG-content sequencing bias.</p><p>The analysis of the uniqueness of a genome (i.e. the proportion of <inline-formula><inline-graphic xlink:href="pone.0030377.e324.jpg" mimetype="image"/></inline-formula>-mers having a mappability score of 1) for four model organisms (human, mouse, fly and nematode) computed with up to <inline-formula><inline-graphic xlink:href="pone.0030377.e325.jpg" mimetype="image"/></inline-formula> substitutions revealed a more complex architecture than anticipated. Regions of the genome that are not uniquely mappable correlate not only with the global proportion of repetitive sequences but also, more importantly, with the nature (and hence, the number of copies) of these repeats.</p><p>Computing the mappability of a genome is very useful in ChIPSeq experiments, in order to provide a suitable normalization when peaks are scored. In a given RNASeq experiment, calculating <italic>a priori</italic> the mappability sheds light on regions which will not be easily accessible if multiple mappings are discarded; it could also help to design a better experiment, in particular whenever the main goal is either to exploit most of the biological signal, or to access a specific feature of a genome.</p><p>Indeed, we also showed that mappability profiles vary significantly depending on the type of functional element studied and the parameters used (read length and/or number of mismatches). In particular, the analysis of the mappability profiles of gene families (like the olfactory receptors) and pseudo-genes shows that even long HTS reads are not enough to make some features easily accessible: just using a longer read length may not be enough by itself to completely eliminate the ambiguity which arises from the repetitive nature of some interesting features of the genome.</p><p>The connection with the design and the analysis of HTS experiments at the level of the single locus is therefore straightforward. We further emphasized it by examining how mappability impacts the study of single-nucleotide polimorphisms, and how it relates to paired-end sequencing schemes.</p><p>Finally, one could note that the systematic fast computation of mappability may be used in various situations of common interest in biology other than those related to the analysis of HTS data &#x02013; typical examples being the identification of interesting repeated motifs, or the refinement of primer design. Overall, we believe the present work still far from being exhaustive: more and more practical applications of the study of sequence mappability will certainly follow in the future.</p></sec></body><back><ack><p>We would like to thank Rachel Harte from the University of California Santa Cruz for her substantial help in the integration of our mappability tracks into the UCSC Genome Browser.</p></ack><fn-group><fn fn-type="conflict"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><fn fn-type="financial-disclosure"><p><bold>Funding: </bold>This work has been partially supported by grants BIO2006-03380 (to RG) and CONSOLIDER CSD2007-00050 (to RG and PR) from the Spanish Ministerio de Educacion y Ciencia. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p></fn></fn-group><ref-list><title>References</title><ref id="pone.0030377-Li1"><label>1</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Homer</surname><given-names>N</given-names></name></person-group>             <year>2010</year>             <article-title>A survey of sequence alignment algorithms for next-generation sequencing.</article-title>             <source>Brief Bioinformatics</source>             <volume>11</volume>             <fpage>473</fpage>             <lpage>83</lpage>          <pub-id pub-id-type="pmid">20460430</pub-id></element-citation></ref><ref id="pone.0030377-Ribeca1"><label>2</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Ribeca</surname><given-names>P</given-names></name></person-group>             <year>2008</year>             <article-title>The GEM (GEnome Multitool) library.</article-title>             <comment>URL <ext-link ext-link-type="uri" xlink:href="http://gemlibrary.sourceforge.net">http://gemlibrary.sourceforge.net</ext-link>. Accessed 2011 Dec 23</comment>          </element-citation></ref><ref id="pone.0030377-Huda1"><label>3</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Huda</surname><given-names>A</given-names></name><name><surname>Mari&#x000f1;o-Ram&#x000ed;rez</surname><given-names>L</given-names></name><name><surname>Landsman</surname><given-names>D</given-names></name><name><surname>Jordan</surname><given-names>IK</given-names></name></person-group>             <year>2009</year>             <article-title>Repetitive DNA elements, nucleosome binding and human gene expression.</article-title>             <source>Gene</source>             <volume>436</volume>             <fpage>12</fpage>             <lpage>22</lpage>          <pub-id pub-id-type="pmid">19393174</pub-id></element-citation></ref><ref id="pone.0030377-Feschotte1"><label>4</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Feschotte</surname><given-names>C</given-names></name></person-group>             <year>2008</year>             <article-title>Transposable elements and the evolution of regulatory networks.</article-title>             <source>Nat Rev Genet</source>             <volume>9</volume>             <fpage>397</fpage>             <lpage>405</lpage>          <pub-id pub-id-type="pmid">18368054</pub-id></element-citation></ref><ref id="pone.0030377-Whiteford1"><label>5</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Whiteford</surname><given-names>N</given-names></name><name><surname>Haslam</surname><given-names>N</given-names></name><name><surname>Weber</surname><given-names>G</given-names></name><name><surname>Pr&#x000fc;gel-Bennett</surname><given-names>A</given-names></name><name><surname>Essex</surname><given-names>JW</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>An analysis of the feasibility of short read sequencing.</article-title>             <source>Nucleic Acids Res</source>             <volume>33</volume>             <fpage>e171</fpage>          <pub-id pub-id-type="pmid">16275781</pub-id></element-citation></ref><ref id="pone.0030377-Rozowsky1"><label>6</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Rozowsky</surname><given-names>J</given-names></name><name><surname>Euskirchen</surname><given-names>G</given-names></name><name><surname>Auerbach</surname><given-names>RK</given-names></name><name><surname>Zhang</surname><given-names>ZD</given-names></name><name><surname>Gibson</surname><given-names>T</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>PeakSeq enables systematic scoring of ChIP-seq experiments relative to controls.</article-title>             <source>Nat Biotechnol</source>             <volume>27</volume>             <fpage>66</fpage>             <lpage>75</lpage>          <pub-id pub-id-type="pmid">19122651</pub-id></element-citation></ref><ref id="pone.0030377-Rhead1"><label>7</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Rhead</surname><given-names>B</given-names></name><name><surname>Karolchik</surname><given-names>D</given-names></name><name><surname>Kuhn</surname><given-names>RM</given-names></name><name><surname>Hinrichs</surname><given-names>AS</given-names></name><name><surname>Zweig</surname><given-names>AS</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>The UCSC Genome Browser database: update 2010.</article-title>             <source>Nucleic Acids Res</source>             <volume>38</volume>             <fpage>D613</fpage>             <lpage>9</lpage>          <pub-id pub-id-type="pmid">19906737</pub-id></element-citation></ref><ref id="pone.0030377-Harrow1"><label>8</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Harrow</surname><given-names>J</given-names></name><name><surname>Denoeud</surname><given-names>F</given-names></name><name><surname>Frankish</surname><given-names>A</given-names></name><name><surname>Reymond</surname><given-names>A</given-names></name><name><surname>Chen</surname><given-names>CK</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>GENCODE: producing a reference annotation for ENCODE.</article-title>             <source>Genome Biol</source>             <volume>7</volume>             <issue>Suppl 1</issue>             <fpage>S4.1</fpage>             <lpage>9</lpage>          <pub-id pub-id-type="pmid">16925838</pub-id></element-citation></ref><ref id="pone.0030377-Burrows1"><label>9</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Burrows</surname><given-names>M</given-names></name><name><surname>Wheeler</surname><given-names>DJ</given-names></name></person-group>             <year>1994</year>             <article-title>A block-sorting lossless data compression algorithm.</article-title>             <source>Digital Systems Research Center Research Reports</source>             <volume>1</volume>             <fpage>18</fpage>          </element-citation></ref><ref id="pone.0030377-Xavier1"><label>10</label><element-citation publication-type="journal">             <article-title>Xavier L. The Objective Caml programming language.</article-title>             <comment>URL <ext-link ext-link-type="uri" xlink:href="http://www.ocaml.org">http://www.ocaml.org</ext-link>. Accessed 2011 Dec 23</comment>          </element-citation></ref><ref id="pone.0030377-Ohno1"><label>11</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Ohno</surname><given-names>S</given-names></name></person-group>             <year>1993</year>             <article-title>Patterns in genome evolution.</article-title>             <source>Curr Opin Genet Dev</source>             <volume>3</volume>             <fpage>911</fpage>             <lpage>4</lpage>          <pub-id pub-id-type="pmid">8118217</pub-id></element-citation></ref><ref id="pone.0030377-Cordaux1"><label>12</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Cordaux</surname><given-names>R</given-names></name><name><surname>Batzer</surname><given-names>MA</given-names></name></person-group>             <year>2009</year>             <article-title>The impact of retrotransposons on human genome evolution.</article-title>             <source>Nat Rev Genet</source>             <volume>10</volume>             <fpage>691</fpage>             <lpage>703</lpage>          <pub-id pub-id-type="pmid">19763152</pub-id></element-citation></ref><ref id="pone.0030377-Kazazian1"><label>13</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Kazazian</surname><given-names>HH</given-names></name></person-group>             <year>2004</year>             <article-title>Mobile elements: drivers of genome evolution.</article-title>             <source>Science</source>             <volume>303</volume>             <fpage>1626</fpage>             <lpage>32</lpage>          <pub-id pub-id-type="pmid">15016989</pub-id></element-citation></ref><ref id="pone.0030377-Bailey1"><label>14</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Bailey</surname><given-names>JA</given-names></name><name><surname>Eichler</surname><given-names>EE</given-names></name></person-group>             <year>2006</year>             <article-title>Primate segmental duplications: crucibles of evolution, diversity and disease.</article-title>             <source>Nat Rev Genet</source>             <volume>7</volume>             <fpage>552</fpage>             <lpage>64</lpage>          <pub-id pub-id-type="pmid">16770338</pub-id></element-citation></ref><ref id="pone.0030377-Freeman1"><label>15</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Freeman</surname><given-names>JL</given-names></name><name><surname>Perry</surname><given-names>GH</given-names></name><name><surname>Feuk</surname><given-names>L</given-names></name><name><surname>Redon</surname><given-names>R</given-names></name><name><surname>Mccarroll</surname><given-names>SA</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Copy number variation: new insights in genome diversity.</article-title>             <source>Genome Res</source>             <volume>16</volume>             <fpage>949</fpage>             <lpage>61</lpage>          <pub-id pub-id-type="pmid">16809666</pub-id></element-citation></ref><ref id="pone.0030377-Ohno2"><label>16</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Ohno</surname><given-names>S</given-names></name></person-group>             <year>1987</year>             <article-title>Repetition as the essence of life on this earth: music and genes.</article-title>             <source>Haematol Blood Transfus</source>             <volume>31</volume>             <fpage>511</fpage>             <lpage>8</lpage>          <pub-id pub-id-type="pmid">3443409</pub-id></element-citation></ref><ref id="pone.0030377-Kaminker1"><label>17</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Kaminker</surname><given-names>JS</given-names></name><name><surname>Bergman</surname><given-names>CM</given-names></name><name><surname>Kronmiller</surname><given-names>B</given-names></name><name><surname>Carlson</surname><given-names>J</given-names></name><name><surname>Svirskas</surname><given-names>R</given-names></name><etal/></person-group>             <year>2002</year>             <article-title>The transposable elements of the Drosophila melanogaster euchromatin: a genomics perspective.</article-title>             <source>Genome Biol</source>             <volume>3</volume>          </element-citation></ref><ref id="pone.0030377-Li2"><label>18</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Handsaker</surname><given-names>B</given-names></name><name><surname>Wysoker</surname><given-names>A</given-names></name><name><surname>Fennell</surname><given-names>T</given-names></name><name><surname>Ruan</surname><given-names>J</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>The Sequence Alignment/Map format and SAMtools.</article-title>             <source>Bioinformatics</source>             <volume>25</volume>             <fpage>2078</fpage>             <lpage>2079</lpage>          <pub-id pub-id-type="pmid">19505943</pub-id></element-citation></ref><ref id="pone.0030377-Wang1"><label>19</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Wang</surname><given-names>ET</given-names></name><name><surname>Sandberg</surname><given-names>R</given-names></name><name><surname>Luo</surname><given-names>S</given-names></name><name><surname>Khrebtukova</surname><given-names>I</given-names></name><name><surname>Zhang</surname><given-names>L</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Alternative isoform regulation in human tissue transcriptomes.</article-title>             <source>Nature</source>             <volume>456</volume>             <fpage>470</fpage>             <lpage>476</lpage>          <pub-id pub-id-type="pmid">18978772</pub-id></element-citation></ref><ref id="pone.0030377-Trapnell1"><label>20</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Williams</surname><given-names>BA</given-names></name><name><surname>Pertea</surname><given-names>G</given-names></name><name><surname>Mortazavi</surname><given-names>A</given-names></name><name><surname>Kwan</surname><given-names>G</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation.</article-title>             <source>Nature Biotechnology</source>             <volume>28</volume>             <fpage>511</fpage>             <lpage>5</lpage>          </element-citation></ref><ref id="pone.0030377-Montgomery1"><label>21</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Montgomery</surname><given-names>SB</given-names></name><name><surname>Sammeth</surname><given-names>M</given-names></name><name><surname>Gutierrez-Arcelus</surname><given-names>M</given-names></name><name><surname>Lach</surname><given-names>RP</given-names></name><name><surname>Ingle</surname><given-names>C</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Transcriptome genetics using second generation sequencing in a Caucasian population.</article-title>             <source>Nature</source>             <volume>464</volume>             <fpage>773</fpage>             <lpage>7</lpage>          <pub-id pub-id-type="pmid">20220756</pub-id></element-citation></ref><ref id="pone.0030377-Du1"><label>22</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Du</surname><given-names>J</given-names></name><name><surname>Bjornson</surname><given-names>RD</given-names></name><name><surname>Zhang</surname><given-names>ZD</given-names></name><name><surname>Kong</surname><given-names>Y</given-names></name><name><surname>Snyder</surname><given-names>M</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Integrating sequencing technologies in personal genomics: optimal low cost reconstruction of structural variants.</article-title>             <source>PLoS Comput Biol</source>             <volume>5</volume>             <fpage>e1000432</fpage>          <pub-id pub-id-type="pmid">19593373</pub-id></element-citation></ref><ref id="pone.0030377-Amaral1"><label>23</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Amaral</surname><given-names>PP</given-names></name><name><surname>Dinger</surname><given-names>ME</given-names></name><name><surname>Mercer</surname><given-names>TR</given-names></name><name><surname>Mattick</surname><given-names>JS</given-names></name></person-group>             <year>2008</year>             <article-title>The eukaryotic genome as an RNA machine.</article-title>             <source>Science</source>             <volume>319</volume>             <fpage>1787</fpage>             <lpage>9</lpage>          <pub-id pub-id-type="pmid">18369136</pub-id></element-citation></ref><ref id="pone.0030377-Ponting1"><label>24</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Ponting</surname><given-names>CP</given-names></name><name><surname>Oliver</surname><given-names>PL</given-names></name><name><surname>Reik</surname><given-names>W</given-names></name></person-group>             <year>2009</year>             <article-title>Evolution and functions of long noncoding RNAs.</article-title>             <source>Cell</source>             <volume>136</volume>             <fpage>629</fpage>             <lpage>41</lpage>          <pub-id pub-id-type="pmid">19239885</pub-id></element-citation></ref><ref id="pone.0030377-rom1"><label>25</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>&#x000d8;rom</surname><given-names>UA</given-names></name><name><surname>Derrien</surname><given-names>T</given-names></name><name><surname>Beringer</surname><given-names>M</given-names></name><name><surname>Gumireddy</surname><given-names>K</given-names></name><name><surname>Gardini</surname><given-names>A</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Long noncoding RNAs with enhancer-like function in human cells.</article-title>             <source>Cell</source>             <volume>143</volume>             <fpage>46</fpage>             <lpage>58</lpage>          <pub-id pub-id-type="pmid">20887892</pub-id></element-citation></ref><ref id="pone.0030377-Marioni1"><label>26</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Marioni</surname><given-names>JC</given-names></name><name><surname>Mason</surname><given-names>CE</given-names></name><name><surname>Mane</surname><given-names>SM</given-names></name><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Gilad</surname><given-names>Y</given-names></name></person-group>             <year>2008</year>             <article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays.</article-title>             <source>Genome Research</source>             <volume>18</volume>             <fpage>1509</fpage>             <lpage>17</lpage>          <pub-id pub-id-type="pmid">18550803</pub-id></element-citation></ref><ref id="pone.0030377-Morin1"><label>27</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Morin</surname><given-names>R</given-names></name><name><surname>Bainbridge</surname><given-names>M</given-names></name><name><surname>Fejes</surname><given-names>A</given-names></name><name><surname>Hirst</surname><given-names>M</given-names></name><name><surname>Krzywinski</surname><given-names>M</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Profiling the HeLa S3 transcriptome using randomly primed cDNA and massively parallel short-read sequencing.</article-title>             <source>Biotech</source>             <volume>45</volume>             <fpage>81</fpage>             <lpage>94</lpage>          </element-citation></ref><ref id="pone.0030377-Li3"><label>28</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Ruan</surname><given-names>J</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group>             <year>2008</year>             <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores.</article-title>             <source>Genome Res</source>             <volume>18</volume>             <fpage>1851</fpage>             <lpage>8</lpage>          <pub-id pub-id-type="pmid">18714091</pub-id></element-citation></ref><ref id="pone.0030377-Faulkner1"><label>29</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Faulkner</surname><given-names>GJ</given-names></name><name><surname>Forrest</surname><given-names>ARR</given-names></name><name><surname>Chalk</surname><given-names>AM</given-names></name><name><surname>Schroder</surname><given-names>K</given-names></name><name><surname>Hayashizaki</surname><given-names>Y</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>A rescue strategy for multimapping short sequence tags refines surveys of transcriptional activity by CAGE.</article-title>             <source>Genomics</source>             <volume>91</volume>             <fpage>281</fpage>             <lpage>8</lpage>          <pub-id pub-id-type="pmid">18178374</pub-id></element-citation></ref><ref id="pone.0030377-Mortazavi1"><label>30</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Mortazavi</surname><given-names>A</given-names></name><name><surname>Williams</surname><given-names>BA</given-names></name><name><surname>Mccue</surname><given-names>K</given-names></name><name><surname>Schaeffer</surname><given-names>L</given-names></name><name><surname>Wold</surname><given-names>B</given-names></name></person-group>             <year>2008</year>             <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq.</article-title>             <source>Nat Meth</source>             <volume>5</volume>             <fpage>621</fpage>             <lpage>628</lpage>          </element-citation></ref><ref id="pone.0030377-Li4"><label>31</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Li</surname><given-names>B</given-names></name><name><surname>Ruotti</surname><given-names>V</given-names></name><name><surname>Stewart</surname><given-names>RM</given-names></name><name><surname>Thomson</surname><given-names>JA</given-names></name><name><surname>Dewey</surname><given-names>CN</given-names></name></person-group>             <year>2010</year>             <article-title>RNA-Seq gene expression estimation with read mapping uncertainty.</article-title>             <source>Bioinformatics</source>             <volume>26</volume>             <fpage>493</fpage>             <lpage>500</lpage>          <pub-id pub-id-type="pmid">20022975</pub-id></element-citation></ref><ref id="pone.0030377-Wang2"><label>32</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Huda</surname><given-names>A</given-names></name><name><surname>Lunyak</surname><given-names>VV</given-names></name><name><surname>Jordan</surname><given-names>IK</given-names></name></person-group>             <year>2010</year>             <article-title>A Gibbs sampling strategy applied to the mapping of ambiguous short-sequence tags.</article-title>             <source>Bioinformatics</source>             <volume>26</volume>             <fpage>2501</fpage>             <lpage>8</lpage>          <pub-id pub-id-type="pmid">20871106</pub-id></element-citation></ref><ref id="pone.0030377-Paaniuc1"><label>33</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Pa&#x0015f;aniuc</surname><given-names>B</given-names></name><name><surname>Zaitlen</surname><given-names>N</given-names></name><name><surname>Halperin</surname><given-names>E</given-names></name></person-group>             <year>2011</year>             <article-title>Accurate estimation of expression levels of homologous genes in RNA-seq experiments.</article-title>             <source>Journal of Computational Biology</source>             <volume>18</volume>             <fpage>459</fpage>             <lpage>68</lpage>          <pub-id pub-id-type="pmid">21385047</pub-id></element-citation></ref><ref id="pone.0030377-Bailey2"><label>34</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Bailey</surname><given-names>JA</given-names></name><name><surname>Gu</surname><given-names>Z</given-names></name><name><surname>Clark</surname><given-names>RA</given-names></name><name><surname>Reinert</surname><given-names>K</given-names></name><name><surname>Samonte</surname><given-names>RV</given-names></name><etal/></person-group>             <year>2002</year>             <article-title>Recent segmental duplications in the human genome.</article-title>             <source>Science</source>             <volume>297</volume>             <fpage>1003</fpage>             <lpage>7</lpage>          <pub-id pub-id-type="pmid">12169732</pub-id></element-citation></ref><ref id="pone.0030377-Vilella1"><label>35</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Vilella</surname><given-names>AJ</given-names></name><name><surname>Severin</surname><given-names>J</given-names></name><name><surname>Ureta-Vidal</surname><given-names>A</given-names></name><name><surname>Heng</surname><given-names>L</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>EnsemblCompara GeneTrees: Complete, duplication-aware phylogenetic trees in vertebrates.</article-title>             <source>Genome Res</source>             <volume>19</volume>             <fpage>327</fpage>             <lpage>35</lpage>          <pub-id pub-id-type="pmid">19029536</pub-id></element-citation></ref><ref id="pone.0030377-Lee1"><label>36</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Lee</surname><given-names>S</given-names></name><name><surname>Seo</surname><given-names>CH</given-names></name><name><surname>Lim</surname><given-names>B</given-names></name><name><surname>Yang</surname><given-names>JO</given-names></name><name><surname>Oh</surname><given-names>J</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Accurate quantification of transcriptome from RNA-Seq data by effective length normalization.</article-title>             <source>Nucleic Acids Research</source>             <volume>39</volume>             <fpage>e9</fpage>          <pub-id pub-id-type="pmid">21059678</pub-id></element-citation></ref><ref id="pone.0030377-Smit1"><label>37</label><element-citation publication-type="journal">             <person-group person-group-type="author"><name><surname>Smit</surname><given-names>A</given-names></name><name><surname>Hubley</surname><given-names>R</given-names></name><name><surname>Green</surname><given-names>P</given-names></name></person-group>             <year>1996</year>             <article-title>RepeatMasker Open-3.0.</article-title>             <comment>URL <ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org">http://www.repeatmasker.org</ext-link>. Accessed 2011 Dec 23.Dec 23</comment>          </element-citation></ref></ref-list></back></article>