<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id><journal-title-group><journal-title>BMC Bioinformatics</journal-title></journal-title-group><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4351697</article-id><article-id pub-id-type="pmid">25887316</article-id><article-id pub-id-type="publisher-id">479</article-id><article-id pub-id-type="doi">10.1186/s12859-015-0479-2</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology Article</subject></subj-group></article-categories><title-group><article-title>A hidden Markov approach for ascertaining cSNP genotypes from RNA sequence data in the presence of allelic imbalance by exploiting linkage disequilibrium</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Steibel</surname><given-names>Juan P</given-names></name><address><email>steibelj@msu.edu</email></address><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Wang</surname><given-names>Heng</given-names></name><address><email>hengwang@stt.msu.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Zhong</surname><given-names>Ping-Shou</given-names></name><address><email>pszhong@stt.msu.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2150 1785</institution-id><institution-id institution-id-type="GRID">grid.17088.36</institution-id><institution>Department of Statistics and Probability, </institution><institution>Michigan State University, </institution></institution-wrap>619 Red Cedar Road, East Lansing MI, 48824 USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2150 1785</institution-id><institution-id institution-id-type="GRID">grid.17088.36</institution-id><institution>Department of Animal Science, </institution><institution>Michigan State University, </institution></institution-wrap>East Lansing MI, 48824 USA </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2150 1785</institution-id><institution-id institution-id-type="GRID">grid.17088.36</institution-id><institution>Lyman Briggs College, </institution><institution>Michigan State University, </institution></institution-wrap>East Lansing MI, 48824 USA </aff></contrib-group><pub-date pub-type="epub"><day>22</day><month>2</month><year>2015</year></pub-date><pub-date pub-type="collection"><year>2015</year></pub-date><volume>16</volume><elocation-id>61</elocation-id><history><date date-type="received"><day>3</day><month>2</month><year>2014</year></date><date date-type="accepted"><day>27</day><month>1</month><year>2015</year></date></history><permissions><copyright-statement>&#x000a9; Steibel et al.; licensee BioMed Central. 2015</copyright-statement><license license-type="open-access"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly credited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p>Allelic specific expression (ASE) increases our understanding of the genetic control of gene expression and its links to phenotypic variation. ASE testing is implemented through binomial or beta-binomial tests of sequence read counts of alternative alleles at a cSNP of interest in heterozygous individuals. This requires prior ascertainment of the cSNP genotypes for all individuals. To meet the needs, we propose hidden Markov methods to call SNPs from next generation RNA sequence data when ASE possibly exists.</p></sec><sec><title>Results</title><p>We propose two hidden Markov models (HMMs), HMM-ASE and HMM-NASE that consider or do not consider ASE, respectively, in order to improve genotyping accuracy. Both HMMs have the advantages of calling the genotypes of several SNPs simultaneously and allow mapping error which, respectively, utilize the dependence among SNPs and correct the bias due to mapping error. In addition, HMM-ASE exploits ASE information to further improve genotype accuracy when the ASE is likely to be present.</p><p>Simulation results indicate that the HMMs proposed demonstrate a very good prediction accuracy in terms of controlling both the false discovery rate (FDR) and the false negative rate (FNR). When ASE is present, the HMM-ASE had a lower FNR than HMM-NASE, while both can control the false discovery rate (FDR) at a similar level. By exploiting linkage disequilibrium (LD), a real data application demonstrate that the proposed methods have better sensitivity and similar FDR in calling heterozygous SNPs than the VarScan method. Sensitivity and FDR are similar to that of the BCFtools and Beagle methods. The resulting genotypes show good properties for the estimation of the genetic parameters and ASE ratios.</p></sec><sec><title>Conclusions</title><p>We introduce HMMs, which are able to exploit LD and account for the ASE and mapping errors, to simultaneously call SNPs from the next generation RNA sequence data. The method introduced can reliably call for cSNP genotypes even in the presence of ASE and under low sequencing coverage. As a byproduct, the proposed method is able to provide predictions of ASE ratios for the heterozygous genotypes, which can then be used for ASE testing.</p></sec><sec><title>Electronic supplementary material</title><p>The online version of this article (doi:10.1186/s12859-015-0479-2) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Hidden Markov model</kwd><kwd>RNA-seq data</kwd><kwd>Allelic specific expression</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2015</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p>RNAseq is revolutionizing transcriptome analyses [<xref ref-type="bibr" rid="CR1">1</xref>]. While RNAseq is typically used for transcript-centric analysis, where differential expression of genes or transcripts is tested between treatments or tissues [<xref ref-type="bibr" rid="CR2">2</xref>], recently, RNAseq has been increasingly utilized for nucleotide-centric inferences such as, for coding SNP (cSNP) discovery [<xref ref-type="bibr" rid="CR3">3</xref>], for cSNP genotyping to estimate population parameters [<xref ref-type="bibr" rid="CR4">4</xref>] or for allelic specific expression [<xref ref-type="bibr" rid="CR5">5</xref>,<xref ref-type="bibr" rid="CR6">6</xref>].</p><p>ASE is particularly promising because it illuminates the genetic control of gene expression and its links to phenotypic variation [<xref ref-type="bibr" rid="CR7">7</xref>]. In general, ASE testing is implemented through binomial or beta-binomial tests of counts of alternative alleles in reads aligned to cSNPs of interest in heterozygous individuals [<xref ref-type="bibr" rid="CR8">8</xref>]. Some algorithms and models have been specifically tailored to perform this inference using RNAseq data [<xref ref-type="bibr" rid="CR8">8</xref>-<xref ref-type="bibr" rid="CR11">11</xref>], but most of them require prior ascertainment of cSNP genotypes to extract read counts for heterozygous sites or they require RNAseq or genomic sequence on parents of the individuals used for ASE testing to reliably infer cSNP genotypes. Moreover, most models do not include biological replication and assume either a single replicate or treat all biological replicates alike and collapse counts down to the nucleotide level. These assumptions may not be too restrictive in F1 crosses of inbred strains of individuals of model organisms [<xref ref-type="bibr" rid="CR12">12</xref>] for which exhaustive sequence resources are available and biological variation is minimal, but they become more problematic for outbred populations and their crosses [<xref ref-type="bibr" rid="CR13">13</xref>] and even for crosses of inbred lines when the purpose is to focus on individual variation in ASE for breeding [<xref ref-type="bibr" rid="CR14">14</xref>] or population genetics inferences [<xref ref-type="bibr" rid="CR15">15</xref>].</p><p>In the above cases, genotypes are called first from RNAseq using models designed for calling SNP from genomic sequence data [<xref ref-type="bibr" rid="CR16">16</xref>-<xref ref-type="bibr" rid="CR19">19</xref>], but there is a concern that extreme allelic imbalance could cause a heterozygous SNP to be mislabeled as homozygous or even not called at all, especially when coverage is low, as happens with low expressed genes [<xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR15">15</xref>]. This type of error is also present when calling SNP from pooled DNA samples where the expected allele frequency differs from 0, 0.5 and 1, as modeled in most SNP calling programs [<xref ref-type="bibr" rid="CR20">20</xref>]. Moreover, while mislabeling a heterozygote as homozygote will not affect the estimation of the ASE ratio, it leads to loss in power. This is particularly important when working with outbred populations or their crosses, where the number of heterozygote individuals may be limited if the frequency of the minor allele is low. As a way to mitigate this problem, the use of phased haplotypes has been proposed [<xref ref-type="bibr" rid="CR11">11</xref>], with the purpose of more reliably calling genotypes by exploiting linkage disequilibrium and minimizing the chances of missing heterozygote individuals. Exploitation of linkage disequilibrium is important because it has the potential to call SNP genotypes more accurately even with low expressed genes due to low sequence coverage.</p><p>In this paper, we concentrate on the problem of ascertaining the cSNP genotype when ASE is likely to be present. The HMM methods we propose improve genotyping accuracy by accounting for allelic imbalance, exploiting LD and allowing for mapping error. The hidden Markov approach has several advantages. First, it can model multiple SNPs simultaneously and their dependence through underlying hidden variables. Simultaneous modeling allows the HMM to make use of more data to estimate global parameters than a single SNP method. This results in increased accuracy in SNP calling especially in low expressed transcripts with low coverage. Second, the HMM is easy to implement through an Expectation-Maximization (EM) algorithm. Third, the HMM is very flexible. For example, it can be adapted to all kinds of modeling to account for individual variation in ASE ratios and sequence mapping errors. Fourth, the HMM is a likelihood based approach that can be easily used to make statistical inference. Consistency and asymptotic normality [<xref ref-type="bibr" rid="CR21">21</xref>] can be established under some regularity conditions. The likelihood ratio approach may also be applied directly. Although HMM has been used successfully to identify copy number variations [<xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR23">23</xref>], it has not been applied to identify genotypes from RNA sequence data when allele specific expression exists. The proposed HMMs are immediately applicable after the SNPs are identified and locations are ascertained by existing software (e.g. VarScan). A comparison of existing software can be found in [<xref ref-type="bibr" rid="CR18">18</xref>]</p><p>This paper is organized as follows. In the <xref rid="Sec2" ref-type="sec">Methods</xref> section, we introduce HMM-ASE for calling the underlying genotype while predicting the ASE status; HMM-NASE will be introduced as a special case. In the Results section, we present simulation results for the prediction of the underlying SNP, using HMM-ASE and HMM-NASE first. Then a real data analysis is used to demonstrate the method proposed and compare it to other popular methods such as VarScan [<xref ref-type="bibr" rid="CR17">17</xref>], BCFtools [<xref ref-type="bibr" rid="CR19">19</xref>] and Beagle [<xref ref-type="bibr" rid="CR24">24</xref>]. Concluding remarks are given in the Conclusion and Discussion section. We also provide Additional file <xref rid="MOESM1" ref-type="media">1</xref> for additional details of the EM algorithms and some additional numerical results. A manual for the R package HMMASE can be found at http://www.stt.msu.edu/users/pszhong/HMMASE.html.</p></sec><sec id="Sec2"><title>Methods</title><p>The purpose of this Section is to introduce HMM-ASE, which can infer the underlying genotypes and predict SNP with ASE simultaneously using the RNA counts from the next generation sequence data. The introduction of HMM-NASE will be given as a special case at the end of this Section. Let <bold>X</bold>
<sub><italic>il</italic></sub>=(<italic>X</italic>
<sub><italic>i</italic><italic>l</italic>1</sub>,<italic>X</italic>
<sub><italic>i</italic><italic>l</italic>2</sub>,<italic>X</italic>
<sub><italic>i</italic><italic>l</italic>3</sub>,<italic>X</italic>
<sub><italic>i</italic><italic>l</italic>4</sub>)<sup><italic>T</italic></sup> be observed allele specific RNA counts of the <italic>l</italic>-th SNP for <italic>l</italic>=1,&#x022ef;,<italic>L</italic> and the <italic>i</italic>-th individual (<italic>i</italic>=1,&#x022ef;,<italic>n</italic>), where <italic>X</italic>
<sub><italic>i</italic><italic>l</italic>1</sub>,<italic>X</italic>
<sub><italic>i</italic><italic>l</italic>2</sub>,<italic>X</italic>
<sub><italic>i</italic><italic>l</italic>3</sub>,<italic>X</italic>
<sub><italic>i</italic><italic>l</italic>4</sub> represent observed counts for <italic>A</italic>,<italic>C</italic>,<italic>G</italic> and <italic>T</italic>, respectively. Let <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$n_{\textit {il}}=\sum _{j=1}^{4}X_{\textit {ilj}}$
\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ilj</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_479_IEq1.gif"/></alternatives></inline-formula> be the total counts at the <italic>l</italic>-th SNP of the <italic>i</italic>-th individual.</p><p>To simplify the notation, we will introduce the proposed HMM-ASE method for a bi-allelic SNP. The extension to other cases can be done in a similar manner. Without loss of generality, consider two possible alleles A and T. There are three possible genotypes, two homozygous AA and TT, and one heterozygous AT. For the heterozygous genotype, we also wish to predict if an allelic specific expression exists for alleles A and T. Specifically, we want to further classify the heterozygous genotypes AT into three states AT-NASE (heterozygous without ASE), AT-ASE-HIGH (heterozygous with ASE, with reads of A more than T) and AT-ASE-LOW (heterozygous with ASE, with reads of T more than A). For convenience, let <italic>G</italic>
<sub><italic>il</italic></sub> represent the (hidden) combination of genotype and allelic specific status at the position <italic>l</italic> (<italic>l</italic>=1,&#x022ef;,<italic>L</italic>) for the <italic>i</italic>-th individual where <disp-formula id="Equ1"><label>(0.1)</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ G_{il}=\left\{ \begin{array}{cl} 1 &#x00026; \text{for} ``\text{AA}^{\prime\prime};\\ 2 &#x00026; \text{for} ``\mathrm{AT-NASE}^{\prime\prime};\\ 3 &#x00026; \text{for} ``\mathrm{AT-ASE-HIGH}^{\prime\prime};\\ 4 &#x00026; \text{for} ``\mathrm{AT-ASE-LOW}^{\prime\prime};\\ 5 &#x00026; \text{for} ``\text{TT}^{\prime\prime}\\ \end{array} \right.  $$
\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mtext>for</mml:mtext><mml:mo>&#x0201c;</mml:mo><mml:msup><mml:mrow><mml:mtext>AA</mml:mtext></mml:mrow><mml:mrow><mml:mi>&#x02032;&#x02032;</mml:mi></mml:mrow></mml:msup><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd><mml:mtd><mml:mtext>for</mml:mtext><mml:mo>&#x0201c;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">AT</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mtext mathvariant="italic">NASE</mml:mtext></mml:mrow><mml:mrow><mml:mi>&#x02032;&#x02032;</mml:mi></mml:mrow></mml:msup><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>3</mml:mn></mml:mtd><mml:mtd><mml:mtext>for</mml:mtext><mml:mo>&#x0201c;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">AT</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mtext mathvariant="italic">ASE</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mtext mathvariant="italic">HIGH</mml:mtext></mml:mrow><mml:mrow><mml:mi>&#x02032;&#x02032;</mml:mi></mml:mrow></mml:msup><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>4</mml:mn></mml:mtd><mml:mtd><mml:mtext>for</mml:mtext><mml:mo>&#x0201c;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">AT</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mtext mathvariant="italic">ASE</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mtext mathvariant="italic">LOW</mml:mtext></mml:mrow><mml:mrow><mml:mi>&#x02032;&#x02032;</mml:mi></mml:mrow></mml:msup><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>5</mml:mn></mml:mtd><mml:mtd><mml:mtext>for</mml:mtext><mml:mo>&#x0201c;</mml:mo><mml:msup><mml:mrow><mml:mtext>TT</mml:mtext></mml:mrow><mml:mrow><mml:mi>&#x02032;&#x02032;</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2015_479_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p><p>where &#x0201c;AT-NASE&#x0201d; means the combination of genotype &#x0201c;AT&#x0201d; and non-allelic specific expression (NASE); &#x0201c;AT-ASE&#x0201d; means the combination of genotype &#x0201c;AT&#x0201d; and allelic specific expression (ASE). Given the observed RNA counts {<bold>X</bold>
<sub><italic>il</italic></sub>:<italic>i</italic>=1,&#x022ef;,<italic>n</italic>;<italic>l</italic>=1,&#x022ef;,<italic>L</italic>}, we wish to predict the underlying genotypes <italic>G</italic>
<sub><italic>il</italic></sub> for all <italic>i</italic> and <italic>l</italic>. This prediction simultaneously determines the genotypes and the ASE status of each SNP.</p><p>Assume that sequence error exists in <bold>X</bold>
<sub><italic>il</italic></sub> so that all alleles are possibly observed. The read counts <bold>X</bold>
<sub><italic>il</italic></sub> are generated from a hierarchical model, which is determined by a hidden genotype <italic>G</italic>
<sub><italic>il</italic></sub> and allele specific ratio <italic>&#x003b4;</italic>
<sub><italic>il</italic></sub>. That is, given <italic>n</italic>
<sub><italic>il</italic></sub> and <italic>&#x003b4;</italic>
<sub><italic>il</italic></sub>, <bold>X</bold>
<sub><italic>il</italic></sub>=(<italic>X</italic>
<sub><italic>i</italic><italic>l</italic>1</sub>,<italic>X</italic>
<sub><italic>i</italic><italic>l</italic>2</sub>,<italic>X</italic>
<sub><italic>i</italic><italic>l</italic>3</sub>,<italic>X</italic>
<sub><italic>i</italic><italic>l</italic>4</sub>)<sup><italic>T</italic></sup> follows a multinomial distribution, i.e., <disp-formula id="Equ2"><label>(0.2)</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{@{}rcl@{}} \mathbf{X}_{il}|\delta_{il}&#x00026; \sim &#x00026; \text{Multinomial}(n_{il}, p(\delta_{il},e)); \end{array} $$
\end{document}</tex-math><mml:math id="M6"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>&#x0223c;</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mtext>Multinomial</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>;</mml:mo></mml:mtd><mml:mtd><mml:mtext/><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_479_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p><p>where <italic>p</italic>(<italic>&#x003b4;</italic>
<sub><italic>il</italic></sub>,<italic>e</italic>) represents the probability vector of multinomial distribution, <italic>&#x003b4;</italic>
<sub><italic>il</italic></sub> represents the allelic specific ratio, <italic>e</italic> is used to account for the mapping error. Given <italic>&#x003b4;</italic>
<sub><italic>il</italic></sub>, the probabilities of observing a read as A, C, G or T are specified in the following probability vector <disp-formula id="Equ3"><label>(0.3)</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ p(\delta_{il},e)=\left(\!\left(\!1-\frac{4e}{3}\right)\delta_{il}+\frac{e}{3},\frac{e}{3},\frac{e}{3},\left(\!\frac{4e}{3}-1\!\right)\delta_{il}+1-e\!\right)\!.  $$
\end{document}</tex-math><mml:math id="M8"><mml:mspace width="-14.0pt"/><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mspace width="0.3em"/><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mspace width="0.3em"/><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mspace width="0.3em"/><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>e</mml:mi><mml:mspace width="0.3em"/></mml:mrow></mml:mfenced><mml:mspace width="0.3em"/><mml:mi>.</mml:mi></mml:math><graphic xlink:href="12859_2015_479_Equ3.gif" position="anchor"/></alternatives></disp-formula>
</p><p>The ASE ratios <italic>&#x003b4;</italic>
<sub><italic>il</italic></sub> is a random variable that is generated from a distribution depending on <italic>G</italic>
<sub><italic>il</italic></sub>=<italic>k</italic> in the following ways <disp-formula id="Equ4"><label>(0.4)</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \delta_{il}|G_{il}=k\sim\left\{ \begin{array}{ll} I_{\{\delta_{il}=1\}} &#x00026; \text{for \(k=1\);}\\ I_{\{\delta_{il}=0.5\}} &#x00026; \text{for \(k=2\);}\\ \mathbf{B}_{(0.5,1)}(\alpha_{1},\beta_{1}) &#x00026; \text{for \(k=3\);}\\ \mathbf{B}_{(0,0.5)}(\alpha_{2},\beta_{2}) &#x00026; \text{for \(k=4\);}\\ I_{\{\delta_{il}=0\}} &#x00026; \text{for \(k=5\);}\\ \end{array}\right.  $$
\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x0223c;</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mtext>;</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mtext>;</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mtext>;</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mtext>;</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mtext>;</mml:mtext></mml:mtd></mml:mtr><mml:mtr/></mml:mtable></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12859_2015_479_Equ4.gif" position="anchor"/></alternatives></disp-formula>
</p><p>where <inline-formula id="IEq2"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$I_{\{\delta _{\textit {il}}=a\}}$
\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_479_IEq2.gif"/></alternatives></inline-formula> represents a discrete random variable with probability mass one on point <italic>a</italic>, and <bold>B</bold>
<sub>(<italic>S</italic>,<italic>U</italic>)</sub>(<italic>&#x003b1;</italic>,<italic>&#x003b2;</italic>) (<italic>S</italic>&#x0003c;<italic>U</italic>) is a rescaled beta distribution taking values within (<italic>S</italic>,<italic>U</italic>) which has a probability density function <disp-formula id="Equ5"><label>(0.5)</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ \begin{aligned}  f_{\delta}(x)&#x00026;= \frac{1}{(U-S)^{\alpha+\beta-1}\mathbf{Beta}(\alpha,\beta)}(x-S)^{\alpha-1}(U-x)^{\beta-1}\\ &#x00026;\hfill\;\text{for \(S&#x0003c;x&#x0003c;U\)} \end{aligned}  $$
\end{document}</tex-math><mml:math id="M14"><mml:mtable><mml:mtr><mml:mtd><mml:mspace width="-12.0pt"/><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>U</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">Beta</mml:mi><mml:mo>(</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>S</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>U</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2.77626pt"/><mml:mtext>for</mml:mtext><mml:mspace width="1em"/><mml:mi>S</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mi>x</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mi>U</mml:mi><mml:mtext/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_479_Equ5.gif" position="anchor"/></alternatives></disp-formula>
</p><p>where <bold>B</bold>
<bold>e</bold>
<bold>t</bold>
<bold>a</bold>(<italic>&#x003b1;</italic>,<italic>&#x003b2;</italic>) is the beta function with parameters <italic>&#x003b1;</italic> and <italic>&#x003b2;</italic>. Further, we assume that <italic>&#x003b4;</italic>
<sub><italic>il</italic></sub> are independent given <italic>G</italic>
<sub><italic>il</italic></sub>. As a usual HMM model, we assume the hidden states {<italic>G</italic>
<sub><italic>il</italic></sub>:<italic>l</italic>=1,&#x022ef;,<italic>L</italic>} follows a Markov process to allow dependence among the observed counts <bold>X</bold>
<sub><italic>il</italic></sub>s. The transition probability among underlying genotypes <italic>G</italic>
<sub><italic>il</italic></sub> is assumed to be <disp-formula id="Equ6"><label>(0.6)</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$ P\left(G_{il}=k'|G_{i(l-1)}=k\right)=a_{kk'}\;\text{for}\; k,k'=1,\cdots,M  $$
\end{document}</tex-math><mml:math id="M16"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mspace width="2.77626pt"/><mml:mtext>for</mml:mtext><mml:mspace width="2.77626pt"/><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:math><graphic xlink:href="12859_2015_479_Equ6.gif" position="anchor"/></alternatives></disp-formula>
</p><p>with initial probabilities <italic>P</italic>(<italic>G</italic>
<sub><italic>i</italic>1</sub>=<italic>k</italic>)=<italic>&#x003c0;</italic>
<sub><italic>ik</italic></sub> and <italic>M</italic>=5. One may note that the transition probabilities in (<xref rid="Equ6" ref-type="">0.6</xref>) do not depend on the distances between SNPs, which motivates us to extend the transition probability matrix as a function of the distance between adjacent SNPs. The details of this extension and the associated algorithm are summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p><p>Denote the observed RNA counts data (incomplete) to be <bold>X</bold>
<sub><italic>i</italic></sub>={<bold>X</bold>
<sub><italic>i</italic>1</sub>,&#x022ef;,<bold>X</bold>
<sub><italic>iL</italic></sub>} for <italic>i</italic>=1,&#x022ef;,<italic>n</italic>. Then the posterior probability of <italic>G</italic>
<sub><italic>il</italic></sub>=<italic>k</italic> given <bold>X</bold>={<bold>X</bold>
<sub>1</sub>,&#x022ef;,<bold>X</bold>
<sub><italic>n</italic></sub>}, i.e., <italic>P</italic>(<italic>G</italic>
<sub><italic>il</italic></sub>=<italic>k</italic>|<bold>X</bold>), will be used for predicting the underlying genotypes and simultaneously infer the allelic specific status at the <italic>l</italic>-th SNP for the <italic>i</italic>-th individual. The posterior probability <italic>P</italic>(<italic>G</italic>
<sub><italic>il</italic></sub>|<bold>X</bold>) can be computed by Bayes&#x02019; formula <disp-formula id="Equ7"><label>(0.7)</label><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{array}{*{20}l} \mathcal{L}_{i,k}(l):\!&#x00026;=P(G_{il}=k|{\mathbf{X}})=\sum_{\mathbf{G}_{i}}P(G_{i}|{\mathbf{X}})I(G_{il}=k)\\ &#x00026;=\sum_{\mathbf{G}_{i}}\frac{P({\mathbf{X}},G_{i})}{P({\mathbf{X}})}I(G_{il}=k) \end{array} $$
\end{document}</tex-math><mml:math id="M18"><mml:mtable class="align" columnalign="left"><mml:mtr><mml:mtd class="align-1"><mml:msub><mml:mrow><mml:mi mathvariant="script">&#x02112;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:mspace width="0.3em"/></mml:mtd><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>)</mml:mo><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mspace width="2em"/></mml:mtd><mml:mtd><mml:mspace width="2em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="align-1"/><mml:mtd class="align-2"><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mi>I</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mspace width="2em"/></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2015_479_Equ7.gif" position="anchor"/></alternatives></disp-formula>
</p><p>where <bold>G</bold>
<sub><italic>i</italic></sub>=(<italic>G</italic>
<sub><italic>i</italic>1</sub>,&#x022ef;,<italic>G</italic>
<sub><italic>iL</italic></sub>)<sup><italic>T</italic></sup> is all the possible underlying genotypes combinations on the <italic>L</italic> positions.</p><p>To obtain the posterior probability in (<xref rid="Equ7" ref-type="">0.7</xref>), we note the probabilities <italic>P</italic>(<bold>X</bold>,<italic>G</italic>
<sub><italic>i</italic></sub>) and <italic>P</italic>(<bold>X</bold>) depend on a vector of unknown parameters <bold><italic>&#x003b8;</italic></bold>=(<italic>&#x003b1;</italic>
<sub>1</sub>,<italic>&#x003b2;</italic>
<sub>1</sub>,<italic>&#x003b1;</italic>
<sub>2</sub>,<italic>&#x003b2;</italic>
<sub>2</sub>,<italic>e</italic>,<bold>A</bold>)<sup><italic>T</italic></sup>, where <bold>A</bold>=(<italic>a</italic>
<sub><italic>k</italic><italic>k</italic>&#x02032;</sub>) are parameters in the transition matrix. We will use maximum likelihood estimates (MLE) to estimate <bold><italic>&#x003b8;</italic></bold>. We can find the MLEs of <bold><italic>&#x003b8;</italic></bold> by an EM algorithm [<xref ref-type="bibr" rid="CR25">25</xref>,<xref ref-type="bibr" rid="CR26">26</xref>]. To this end, we introduce the following complete data corresponding to the observed data <bold>X</bold>, <disp-formula id="Equa"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$${\mathbf{Y}}=\{G_{il},\delta_{il}, \mathbf{X}_{il}: l=1,\cdots, L\} \;\text{for}\; i=1,\cdots,n. $$
\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b4;</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>}</mml:mo><mml:mspace width="2.77626pt"/><mml:mtext>for</mml:mtext><mml:mspace width="2.77626pt"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:mi>n.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2015_479_Equa.gif" position="anchor"/></alternatives></disp-formula>
</p><p>The likelihood function for the complete data is <disp-formula id="Equb"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{aligned}  L(\boldsymbol{\theta}|{\mathbf{Y}})&#x00026;=f({\mathbf{Y}}|\boldsymbol{\theta})=f({\mathbf{X}}|\mathbf{G})f(\mathbf{G}|\boldsymbol{\theta})\\ &#x00026;=\prod\limits_{i=1}^{n}\prod\limits_{l=1}^{L}f_{X}(\mathbf{X}_{il}|G_{il})\prod\limits_{i=1}^{n}\prod\limits_{l=2}^{L}a_{G_{i(l-1)},G_{il}}(\boldsymbol{\theta})\pi_{G_{i1}}(\boldsymbol{\theta}) \end{aligned} $$
\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mspace width="-12.0pt"/><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">G</mml:mi><mml:mo>)</mml:mo><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold">G</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x0220f;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2015_479_Equb.gif" position="anchor"/></alternatives></disp-formula> where <italic>f</italic>
<sub><italic>X</italic></sub>(<bold>X</bold>
<sub><italic>il</italic></sub>|<italic>G</italic>
<sub><italic>il</italic></sub>) is the conditional density of <bold>X</bold>
<sub><italic>il</italic></sub> given <italic>G</italic>
<sub><italic>il</italic></sub> obtained from (<xref rid="Equ2" ref-type="">0.2</xref>) and (<xref rid="Equ4" ref-type="">0.4</xref>) whose explicit forms can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref> and <bold>G</bold>=(<bold>G</bold>
<sub>1</sub>,&#x022ef;,<bold>G</bold>
<sub><italic>n</italic></sub>)<sup><italic>T</italic></sup>. It follows that the log-likelihood function of <italic>L</italic>(<bold><italic>&#x003b8;</italic></bold>|<bold>Y</bold>) is given by <disp-formula id="Equc"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{aligned} \log L(\boldsymbol{\theta}|{\mathbf{Y}})=&#x00026;\;\sum\limits_{i=1}^{n}\sum\limits_{l=1}^{L}\log f_{X}(\mathbf{X}_{il}|G_{il})\\ &#x00026;+\sum\limits_{i=1}^{n}\sum\limits_{l=2}^{L}\log\left\{a_{G_{i(l-1)},G_{il}}(\boldsymbol{\theta})\right\}\\ &#x00026;+\sum\limits_{i=1}^{n}\log \left\{\pi_{G_{i1}}(\boldsymbol{\theta})\right\}. \end{aligned} $$
\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>log</mml:mo><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mspace width="2.77626pt"/><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>(</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2015_479_Equc.gif" position="anchor"/></alternatives></disp-formula>
</p><p>Given <bold><italic>&#x003b8;</italic></bold>
<sup>(<italic>m</italic>)</sup>, the update <bold><italic>&#x003b8;</italic></bold>
<sup>(<italic>m</italic>+1)</sup> is found by maximizing <italic>E</italic>{log<italic>L</italic>(<bold><italic>&#x003b8;</italic></bold>|<bold>Y</bold>)|<bold>X</bold>,<bold><italic>&#x003b8;</italic></bold>
<sup>(<italic>m</italic>)</sup>}. The details of the EM algorithm can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. We implemented the EM algorithm by a forward and backward method [<xref ref-type="bibr" rid="CR27">27</xref>]. Further details about the forward and backward algorithm can be found in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>.</p><p>The HMM-NASE method could be considered as a simplification of the HMM-ASE method. The difference between HMM-NASE and HMM-ASE is that HMM-NASE does not consider the possible existence of ASE. As a result, the underlying genotypes of HMM-NASE only contain three states AA,TT and AT-NASE, which means that <italic>G</italic>
<sub><italic>il</italic></sub> in (<xref rid="Equ1" ref-type="">0.1</xref>) can only have three possible values 1,2 and 5. The emission probability will be (<xref rid="Equ3" ref-type="">0.3</xref>) with <italic>k</italic> set to be 1,2 and 5 in (<xref rid="Equ4" ref-type="">0.4</xref>). Then the above forward backward algorithm is still applicable except that the unknown parameter is reduced to <bold><italic>&#x003b8;</italic></bold>=(<italic>e</italic>,<bold>A</bold>)<sup><italic>T</italic></sup>.</p><p>The real data analyzed in this paper were collected by [<xref ref-type="bibr" rid="CR28">28</xref>]. The experimental procedures were approved by the All University Committee on Animal Use and Care at Michigan State University (AUF# 09/03-114-00).</p></sec><sec id="Sec3" sec-type="results"><title>Results</title><sec id="Sec4"><title>&#x0115f;</title><sec id="Sec5"><title>Simulation study</title><p>We performed a simulation study to demonstrate the proposed HMM-ASE and HMM-NASE methods. The underlying genotypes of SNPs were generated with the linkage disequilibrium (LD) information. Assume that LD(<italic>d</italic>) is the LD between two SNPs with distance <italic>d</italic>, which is a known function of <italic>d</italic>. For simplicity, in this simulation, we assume that the LD is a constant function of <italic>d</italic> and each SNP has only two possible alleles: either A or T. The genotypes were generated by combining two independent haplotypes.</p><p>Let <italic>S</italic>
<sub><italic>il</italic></sub> be the allele (either <italic>A</italic> or <italic>T</italic>) at the <italic>l</italic>-th SNP for the <italic>i</italic>-th individual. The marginal probabilities for <italic>A</italic> and <italic>T</italic> are <italic>P</italic>(<italic>S</italic>
<sub><italic>i</italic><italic>l</italic></sub>=<italic>A</italic>)=<italic>p</italic>
<sub><italic>A</italic>&#x000b7;</sub>=<italic>p</italic>
<sub>&#x000b7;<italic>A</italic></sub> and <italic>P</italic>(<italic>S</italic>
<sub><italic>il</italic></sub>=<italic>T</italic>)=<italic>p</italic>
<sub><italic>T</italic>&#x000b7;</sub>=<italic>p</italic>
<sub>&#x000b7;<italic>T</italic></sub> respectively. For any pair of SNPs which are next to each other in the position, the joint probability mass is defined as <italic>P</italic>(<italic>S</italic>
<sub><italic>il</italic></sub>=<italic>x</italic>,<italic>S</italic>
<sub><italic>i</italic>(<italic>l</italic>+1)</sub>=<italic>y</italic>)=<italic>p</italic>
<sub><italic>x</italic><italic>y</italic></sub> where <italic>x</italic>,<italic>y</italic> are either <italic>A</italic> or <italic>T</italic>.</p><p>Note that the LD(<italic>d</italic>) is then defined as <disp-formula id="Equd"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$LD(d)=\frac{(p_{AA}-p_{A\cdot}p_{\cdot A})^{2}}{{(p_{A\cdot}p_{T\cdot})(p_{\cdot A}p_{\cdot T})}}. $$
\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mtext mathvariant="italic">LD</mml:mtext><mml:mo>(</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">AA</mml:mtext></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>&#x000b7;</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>&#x000b7;</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>&#x000b7;</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2015_479_Equd.gif" position="anchor"/></alternatives></disp-formula>
</p><p>Hence <italic>p</italic>
<sub><italic>AA</italic></sub>,<italic>p</italic>
<sub><italic>AT</italic></sub>,<italic>p</italic>
<sub><italic>TA</italic></sub> and <italic>p</italic>
<sub><italic>TT</italic></sub> can be computed once LD(<italic>d</italic>),<italic>p</italic>
<sub><italic>A</italic>&#x000b7;</sub> and <italic>p</italic>
<sub>&#x000b7;<italic>A</italic></sub> are given. We generated each side (a haplotype) of the SNP sequences independently. Both sides are generated by the following three steps: <list list-type="bullet"><list-item><p>Set <italic>l</italic>=1 and generate a random variable <italic>b</italic>
<sub><italic>l</italic>1</sub>&#x0223c;Bernoulli(<italic>p</italic>
<sub><italic>A</italic>&#x000b7;</sub>). If <italic>b</italic>
<sub><italic>il</italic></sub>=1 then we set <italic>S</italic>
<sub><italic>il</italic></sub>=<italic>A</italic>, otherwise <italic>S</italic>
<sub><italic>il</italic></sub>=<italic>T</italic>.</p></list-item><list-item><p>Let <italic>l</italic>=<italic>l</italic>+1. Generating allele at <italic>l</italic>+1 position conditional on the <italic>l</italic> position. Namely, <italic>P</italic>(<italic>S</italic>
<sub><italic>i</italic>(<italic>l</italic>+1)</sub>=<italic>A</italic>|<italic>S</italic>
<sub><italic>il</italic></sub>=<italic>x</italic>)=<italic>p</italic>
<sub><italic>xA</italic></sub>/<italic>p</italic>
<sub><italic>x</italic>&#x000b7;</sub>, where <italic>x</italic> could be either <italic>A</italic> or <italic>T</italic>.</p></list-item><list-item><p>Repeating step (b) until we get <italic>L</italic> SNPs.</p></list-item></list>
</p><p>We then generated total read counts <inline-formula id="IEq3"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$n_{\textit {il}}=\sum _{k=1}^{4} X_{\textit {ilk}}$
\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">il</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ilk</mml:mtext></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2015_479_IEq3.gif"/></alternatives></inline-formula> from a Negative Binomial (NB) distribution independently for at each SNP <italic>l</italic>=1,&#x022ef;,<italic>L</italic> and individual <italic>i</italic>=1,&#x022ef;,<italic>n</italic>. Conditional on the underlying genotype and the total RNA counts, we generated the allele specific RNA counts <bold>X</bold>
<sub><italic>il</italic></sub> through the hierarchical model given in (<xref rid="Equ2" ref-type="">0.2</xref>) through (<xref rid="Equ4" ref-type="">0.4</xref>). For illustration purpose, we considered a data set that was generated only by 4 underlying states in the simulation. Namely, AA, AT-NASE, AT-ASE-HIGH and TT, where the distribution of the allele specific ratio <italic>&#x003b4;</italic>
<sub><italic>il</italic></sub> for the AT-ASE-HIGH state was changed to a Beta(<italic>&#x003b1;</italic>,<italic>&#x003b2;</italic>) distribution where we set <italic>&#x003b1;</italic>=30,<italic>&#x003b2;</italic>=10 such that the mode and center of the beta distribution is concentrated around 0.75.</p><p>The following scenarios were used in the simulation. We designed three different numbers of individuals (<italic>n</italic>): 6, 12 and 24, and two different numbers of SNP (<italic>L</italic>): 10 and 100. For each of the above six individual/SNP combinations, the total number of reads were simulated from negative binomial distributions NB(<italic>&#x003bb;</italic>,0.4) with five different <italic>&#x003bb;</italic> values: 8, 16, 24, 32 and 56 as well as two different values for LD: 0.5 and 0.8. We did 10 replications for each of the above combinations. We measured the performance of the proposed method by empirical false discovery rate (EFDR) and empirical false negative rate (EFNR), where were defined, respectively, as <disp-formula id="Eque"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\begin{aligned} \text{EFDR}&#x00026;=\frac{\text{\# Homozygotes called heterozygotes}}{\text{Total \# of called heterozygous}};\\ \text{EFNR}&#x00026;=\frac{\text{\# Heterozygotes called homozygotes}}{\text{Total \# of called homozygous}}. \end{aligned} $$
\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>EFDR</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext># Homozygotes called heterozygotes</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Total # of called heterozygous</mml:mtext></mml:mrow></mml:mfrac><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>EFNR</mml:mtext></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext># Heterozygotes called homozygotes</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Total # of called homozygous</mml:mtext></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2015_479_Eque.gif" position="anchor"/></alternatives></disp-formula>
</p><p>The proposed HMM-ASE and HMM-NASE were applied to the above scenarios. Table <xref rid="Tab1" ref-type="table">1</xref> and Table <xref rid="Tab2" ref-type="table">2</xref> summarize the EFDR and EFNR for both methods in the case with 10 SNPs. The first and second columns of both tables represent the values of <italic>&#x003bb;</italic> and LD. The larger the value of <italic>&#x003bb;</italic>, the larger the average of the RNA counts. On one hand, HMM-ASE and HMM-NASE share some similarity. By increasing the value of <italic>&#x003bb;</italic>, the EFDR and EFNR of both HMMs were smaller with lower variability (smaller standard deviation). Increasing the LD value led to better predictions, which shows that both HMMs made use of the LD information in predicting genotypes. Specifically, one can see that the EFDR and EFNR rates were improved with increased LD when <italic>&#x003bb;</italic> is relative small. On the other hand, the EFNR rates of HMM-NASE in Table <xref rid="Tab2" ref-type="table">2</xref> were almost always consistently larger than the EFNR rates from HMM-ASE in the same table while the EFDR (Table <xref rid="Tab1" ref-type="table">1</xref>) of HMM-ASE were slightly higher than those of HMM-NASE when <italic>&#x003bb;</italic> is relative small. This demonstrates that HMM-ASE has better sensitivity than HMM-NASE in heterozygote SNP genotypes from RNAseq data when ASE is likely present because ASE is considered in HMM-ASE. To better illustrate these two methods, Figure <xref rid="Fig1" ref-type="fig">1</xref> compared the EFDR and EFNR for HMM-ASE and HMM-NASE methods when <italic>n</italic>=24. <table-wrap id="Tab1"><label>Table 1</label><caption><p>
<bold>EFDR (homozygotes called heterozygotes) in blocks of 10 SNP using HMM-ASE and HMM-NASE</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">
<bold>(</bold>
<bold><italic>&#x003bb;</italic></bold>
<bold>, LD)</bold>
</th><th align="left"/><th align="left" colspan="3">
<bold>Number of individuals</bold>
</th></tr><tr><th align="left"/><th align="left"/><th align="left">
<bold>6</bold>
</th><th align="left">
<bold>12</bold>
</th><th align="left">
<bold>24</bold>
</th></tr></thead><tbody><tr><td align="left">(8,0.5)</td><td align="left">ASE</td><td align="left">0.0167 (0.017)</td><td align="left">0.0117 (0.010)</td><td align="left">0.0308 (0.020)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0033 (0.007)</td><td align="left">0.0050 (0.006)</td><td align="left">0.0071 (0.004)</td></tr><tr><td align="left">(8,0.8)</td><td align="left">ASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0150 (0.007)</td><td align="left">0.0133 (0.005)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0017 (0.005)</td><td align="left">0.0050 (0.006)</td><td align="left">0.0029 (0.004)</td></tr><tr><td align="left">(16,0.5)</td><td align="left">ASE</td><td align="left">0.0100 (0.009)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0058 (0.004)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0017 (0.005)</td><td align="left">0.0008 (0.003)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left">(16,0.8)</td><td align="left">ASE</td><td align="left">0.0033 (0.008)</td><td align="left">0.0017 (0.004)</td><td align="left">0.0033 (0.004)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0008 (0.003)</td><td align="left">0.0004 (0.001)</td></tr><tr><td align="left">(24,0.5)</td><td align="left">ASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0033 (0.005)</td><td align="left">0.0008 (0.002)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left">(24,0.8)</td><td align="left">ASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0033 (0.004)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left">(32,0.5)</td><td align="left">ASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0058 (0.006)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left">(32,0.8)</td><td align="left">ASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0017 (0.004)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left">(56,0.5)</td><td align="left">ASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0008 (0.002)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left">(56,0.8)</td><td align="left">ASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr></tbody></table><table-wrap-foot><p>Standard deviations are included in parenthesis.</p></table-wrap-foot></table-wrap>
<table-wrap id="Tab2"><label>Table 2</label><caption><p>
<bold>EFNR (heterozygotes called homozygotes) in blocks of 10 SNP using HMM-ASE and HMM-NASE</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">
<bold>(</bold>
<bold><italic>&#x003bb;</italic></bold>
<bold>, LD)</bold>
</th><th align="left"/><th align="left" colspan="3">
<bold>Number of individuals</bold>
</th></tr><tr><th align="left"/><th align="left"/><th align="left">
<bold>6</bold>
</th><th align="left">
<bold>12</bold>
</th><th align="left">
<bold>24</bold>
</th></tr></thead><tbody><tr><td align="left">(8,0.5)</td><td align="left">ASE</td><td align="left">0.0367 (0.018)</td><td align="left">0.0217 (0.013)</td><td align="left">0.0242 (0.028)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0833 (0.038)</td><td align="left">0.0733 (0.019)</td><td align="left">0.0675 (0.015)</td></tr><tr><td align="left">(8,0.8)</td><td align="left">ASE</td><td align="left">0.0100 (0.009)</td><td align="left">0.0033 (0.005)</td><td align="left">0.0075 (0.005)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0450 (0.046)</td><td align="left">0.0533 (0.026)</td><td align="left">0.0700 (0.020)</td></tr><tr><td align="left">(16,0.5)</td><td align="left">ASE</td><td align="left">0.0133 (0.014)</td><td align="left">0.0067 (0.004)</td><td align="left">0.0075 (0.004)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0567 (0.036)</td><td align="left">0.0433 (0.025)</td><td align="left">0.0479 (0.016)</td></tr><tr><td align="left">(16,0.8)</td><td align="left">ASE</td><td align="left">0.0067 (0.015)</td><td align="left">0.0067 (0.011)</td><td align="left">0.0033 (0.004)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0467 (0.046)</td><td align="left">0.0367 (0.023)</td><td align="left">0.0396 (0.011)</td></tr><tr><td align="left">(24,0.5)</td><td align="left">ASE</td><td align="left">0.0033 (0.008)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0017 (0.002)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0233 (0.025)</td><td align="left">0.0308 (0.020)</td><td align="left">0.0379 (0.014)</td></tr><tr><td align="left">(24,0.8)</td><td align="left">ASE</td><td align="left">0.0033 (0.008)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0042 (0.007)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0383 (0.022)</td><td align="left">0.0392 (0.026)</td><td align="left">0.0296 (0.016)</td></tr><tr><td align="left">(32,0.5)</td><td align="left">ASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0033 (0.005)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0300 (0.019)</td><td align="left">0.0375 (0.021)</td><td align="left">0.0396 (0.019)</td></tr><tr><td align="left">(32,0.8)</td><td align="left">ASE</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0417 (0.043)</td><td align="left">0.0208 (0.013)</td><td align="left">0.0346 (0.018)</td></tr><tr><td align="left">(56,0.5)</td><td align="left">ASE</td><td align="left">0.0033 (0.008)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0233 (0.014)</td><td align="left">0.0275 (0.013)</td><td align="left">0.0288 (0.009)</td></tr><tr><td align="left">(56,0.8)</td><td align="left">ASE</td><td align="left">0.0033 (0.008)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0200 (0.019)</td><td align="left">0.0200 (0.015)</td><td align="left">0.0196 (0.009)</td></tr></tbody></table><table-wrap-foot><p>Standard deviations are included in parentheses.</p></table-wrap-foot></table-wrap>
<fig id="Fig1"><label>Figure 1</label><caption><p>
<bold>A comparison of the EFDR and EFNR for the HMM-ASE vs HMM-NASE for</bold>
<bold><italic>n=24,L=10</italic></bold>
<bold> with LD=</bold>
<bold><italic>0.5</italic></bold>
<bold> and 0.8.</bold>
</p></caption><graphic xlink:href="12859_2015_479_Fig1_HTML" id="MO1"/></fig>
</p><p>Finally, we assessed the effect of increasing the size of the SNP block on HMM-ASE and HMM-NASE results. We repeated the simulations using 100 SNP blocks. The results are presented in Tables <xref rid="Tab3" ref-type="table">3</xref> and <xref rid="Tab4" ref-type="table">4</xref>. For the LD structure, coverage and sample sizes used in this simulation, there was virtually no significant difference in error rates compared to the results using a smaller SNP block. This suggests that small SNP blocks are as efficient as larger blocks in utilizing the advantage of LD. Thus, we prefer using small blocks to reduce the computation load. In addition, we also observed that the number of individuals used in the simulation only had minor effects on the EFDR and EFNR with differences well within the range of standard errors.<table-wrap id="Tab3"><label>Table 3</label><caption><p>
<bold>The EFDR (homozygous called heterozygous) and EFNR (heterozygous called homozygous) with 100 SNPs for HMM-ASE</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">
<bold>(</bold>
<bold><italic>&#x003bb;</italic></bold>
<bold>, LD)</bold>
</th><th align="left" colspan="3">
<bold>Number of individuals</bold>
</th></tr><tr><th align="left"/><th align="left">
<bold>6</bold>
</th><th align="left">
<bold>12</bold>
</th><th align="left">
<bold>24</bold>
</th></tr></thead><tbody><tr><td align="left"/><td align="left"/><td align="center">
<bold>EFDR</bold>
</td><td align="left"/></tr><tr><td align="left">(8,0.5)</td><td align="left">0.0163 (0.009)</td><td align="left">0.0163 (0.003)</td><td align="left">0.0230 (0.004)</td></tr><tr><td align="left">(8,0.8)</td><td align="left">0.0067 (0.003)</td><td align="left">0.0050 (0.002)</td><td align="left">0.0068 (0.003)</td></tr><tr><td align="left">(16,0.5)</td><td align="left">0.0050 (0.002)</td><td align="left">0.0053 (0.001)</td><td align="left">0.0068 (0.001)</td></tr><tr><td align="left">(16,0.8)</td><td align="left">0.0033 (0.002)</td><td align="left">0.0025 (0.001)</td><td align="left">0.0030 (0.001)</td></tr><tr><td align="left">(24,0.5)</td><td align="left">0.0027 (0.002)</td><td align="left">0.0017 (0.001)</td><td align="left">0.0030 (0.002)</td></tr><tr><td align="left">(24,0.8)</td><td align="left">0.0017 (0.002)</td><td align="left">0.0002 (0.000)</td><td align="left">0.0009 (0.001)</td></tr><tr><td align="left">(32,0.5)</td><td align="left">0.0017 (0.002)</td><td align="left">0.0008 (0.001)</td><td align="left">0.0008 (0.001)</td></tr><tr><td align="left">(32,0.8)</td><td align="left">0.0007 (0.001)</td><td align="left">0.0008 (0.001)</td><td align="left">0.0008 (0.000)</td></tr><tr><td align="left">(56,0.5)</td><td align="left">0.0007 (0.001)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0008 (0.000)</td></tr><tr><td align="left">(56,0.8)</td><td align="left">0.0003 (0.001)</td><td align="left">0.0002 (0.000)</td><td align="left">0.0002 (0.000)</td></tr><tr><td align="left"/><td align="left"/><td align="center">
<bold>EFNR</bold>
</td><td/></tr><tr><td align="left">(8,0.5)</td><td align="left">0.0230 (0.003)</td><td align="left">0.0218 (0.007)</td><td align="left">0.0138 (0.003)</td></tr><tr><td align="left">(8,0.8)</td><td align="left">0.0113 (0.005)</td><td align="left">0.0088 (0.004)</td><td align="left">0.0071 (0.003)</td></tr><tr><td align="left">(16,0.5)</td><td align="left">0.0080 (0.004)</td><td align="left">0.0063 (0.003)</td><td align="left">0.0047 (0.002)</td></tr><tr><td align="left">(16,0.8)</td><td align="left">0.0033 (0.001)</td><td align="left">0.0032 (0.002)</td><td align="left">0.0028 (0.001)</td></tr><tr><td align="left">(24,0.5)</td><td align="left">0.0017 (0.002)</td><td align="left">0.0028 (0.002)</td><td align="left">0.0022 (0.001)</td></tr><tr><td align="left">(24,0.8)</td><td align="left">0.0020 (0.001)</td><td align="left">0.0017 (0.001)</td><td align="left">0.0010 (0.001)</td></tr><tr><td align="left">(32,0.5)</td><td align="left">0.0013 (0.001)</td><td align="left">0.0005 (0.001)</td><td align="left">0.0011 (0.001)</td></tr><tr><td align="left">(32,0.8)</td><td align="left">0.0003 (0.001)</td><td align="left">0.0005 (0.001)</td><td align="left">0.0004 (0.000)</td></tr><tr><td align="left">(56,0.5)</td><td align="left">0.0003 (0.001)</td><td align="left">0.0005 (0.001)</td><td align="left">0.0001 (0.000)</td></tr><tr><td align="left">(56,0.8)</td><td align="left">0.0003 (0.001)</td><td align="left">0.0002 (0.000)</td><td align="left">0.0000 (0.000)</td></tr></tbody></table><table-wrap-foot><p>Their standard deviations are shown in the parentheses.</p></table-wrap-foot></table-wrap>
<table-wrap id="Tab4"><label>Table 4</label><caption><p>
<bold>The EFDR (homozygous called heterozygous) and EFNR (heterozygous called homozygous) with 100 SNPs for HMM-NASE</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">
<bold>(</bold>
<bold><italic>&#x003bb;</italic></bold>
<bold>, LD)</bold>
</th><th align="left" colspan="3">
<bold>Number of individuals</bold>
</th></tr><tr><th align="left"/><th align="left">
<bold>6</bold>
</th><th align="left">
<bold>12</bold>
</th><th align="left">
<bold>24</bold>
</th></tr></thead><tbody><tr><td align="left"/><td align="left"/><td align="center">
<bold>EFDR</bold>
</td><td/></tr><tr><td align="left">(8,0.5)</td><td align="left">0.0053 (0.005)</td><td align="left">0.0035 (0.001)</td><td align="left">0.0045 (0.001)</td></tr><tr><td align="left">(8,0.8)</td><td align="left">0.0025 (0.002)</td><td align="left">0.0015 (0.001)</td><td align="left">0.0020 (0.001)</td></tr><tr><td align="left">(16,0.5)</td><td align="left">0.0005 (0.001)</td><td align="left">0.0003 (0.001)</td><td align="left">0.0005 (0.000)</td></tr><tr><td align="left">(16,0.8)</td><td align="left">0.0002 (0.001)</td><td align="left">0.0002 (0.000)</td><td align="left">0.0001 (0.000)</td></tr><tr><td align="left">(24,0.5)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left">(24,0.8)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left">(32,0.5)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left">(32,0.8)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left">(56,0.5)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left">(56,0.8)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td><td align="left">0.0000 (0.000)</td></tr><tr><td align="left"/><td align="left"/><td align="center">
<bold>EFNR</bold>
</td><td/></tr><tr><td align="left">(8,0.5)</td><td align="left">0.0728 (0.015)</td><td align="left">0.0740 (0.009)</td><td align="left">0.0701 (0.005)</td></tr><tr><td align="left">(8,0.8)</td><td align="left">0.0533 (0.011)</td><td align="left">0.0498 (0.014)</td><td align="left">0.0520 (0.005)</td></tr><tr><td align="left">(16,0.5)</td><td align="left">0.0557 (0.012)</td><td align="left">0.0466 (0.009)</td><td align="left">0.0467 (0.005)</td></tr><tr><td align="left">(16,0.8)</td><td align="left">0.0358 (0.010)</td><td align="left">0.0364 (0.008)</td><td align="left">0.0401 (0.009)</td></tr><tr><td align="left">(24,0.5)</td><td align="left">0.0412 (0.011)</td><td align="left">0.0398 (0.007)</td><td align="left">0.0407 (0.003)</td></tr><tr><td align="left">(24,0.8)</td><td align="left">0.0347 (0.006)</td><td align="left">0.0298 (0.008)</td><td align="left">0.0305 (0.004)</td></tr><tr><td align="left">(32,0.5)</td><td align="left">0.0280 (0.007)</td><td align="left">0.0338 (0.004)</td><td align="left">0.0313 (0.005)</td></tr><tr><td align="left">(32,0.8)</td><td align="left">0.0292 (0.010)</td><td align="left">0.0304 (0.007)</td><td align="left">0.0285 (0.003)</td></tr><tr><td align="left">(56,0.5)</td><td align="left">0.0257 (0.007)</td><td align="left">0.0268 (0.004)</td><td align="left">0.0265 (0.003)</td></tr><tr><td align="left">(56,0.8)</td><td align="left">0.0203 (0.008)</td><td align="left">0.0218 (0.003)</td><td align="left">0.0213 (0.002)</td></tr></tbody></table><table-wrap-foot><p>Their standard deviations shown in the parenthesis.</p></table-wrap-foot></table-wrap>
</p></sec><sec id="Sec6"><title>Simulation conditional on haplotypes from real data</title><p>To make the haplotype structures in the simulation data more realistic, we randomly selected hayplotype structures from a real data in the pig resource population [<xref ref-type="bibr" rid="CR28">28</xref>] to create the genotypes. Conditional on the genotypes, we generated the counts data using the same methods as those in Tables <xref rid="Tab1" ref-type="table">1</xref>, <xref rid="Tab2" ref-type="table">2</xref>, <xref rid="Tab3" ref-type="table">3</xref> and <xref rid="Tab4" ref-type="table">4</xref>. Results of the EFDR and EFNR of the HMM-ASE and HMM-NASE methods are shown in Table <xref rid="Tab5" ref-type="table">5</xref>. HMM-ASE still maintained a low level EFDR and EFNR indicating that the HMM-ASE method is robust to the change of underlying haplotype structures. But the EFNR of the HMM-NASE method was higher in Table <xref rid="Tab5" ref-type="table">5</xref>, because HMM-NASE did not account for the ASE, which exists in the simulated data. To confirm this, we further generated counts without ASE (ASE ratios =0.5), the results are summarized in Table <xref rid="Tab6" ref-type="table">6</xref>. Both the HMM-ASE and HMM-NASE methods performed well in this case, suggesting that the HMM-NASE method is robust to the change of haplotype structures but not to the existence of ASE. This confirms the importance of developing the HMM-ASE method.<table-wrap id="Tab5"><label>Table 5</label><caption><p>
<bold>The EFDR (homozygous called heterozygous) and EFNR (heterozygous called homozygous) with 100 SNPs using the haplotype structures from real data</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">
<bold><italic>&#x003bb;</italic></bold>
</th><th align="left"/><th align="left" colspan="3">
<bold>Number of individuals</bold>
</th></tr><tr><th align="left"/><th align="left"/><th align="left">
<bold>6</bold>
</th><th align="left">
<bold>12</bold>
</th><th align="left">
<bold>24</bold>
</th></tr></thead><tbody><tr><td align="left"/><td align="left"/><td align="center" colspan="3"> EFDR</td></tr><tr><td align="left">8</td><td align="left">ASE</td><td align="left">0.0784 (0.0234)</td><td align="left">0.0729 (0.0093)</td><td align="left">0.0752 (0.0089)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0235 (0.0150)</td><td align="left">0.0276 (0.0119)</td><td align="left">0.0267 (0.0111)</td></tr><tr><td align="left">16</td><td align="left">ASE</td><td align="left">0.0328 (0.0099)</td><td align="left">0.0338 (0.0088)</td><td align="left">0.0331 (0.0086)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0016 (0.0027)</td><td align="left">0.0028 (0.0036)</td><td align="left">0.0019 (0.0017)</td></tr><tr><td align="left">24</td><td align="left">ASE</td><td align="left">0.0153 (0.0070)</td><td align="left">0.0137 (0.0064)</td><td align="left">0.0164 (0.0054)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0012 (0.0026)</td><td align="left">0.0008 (0.0013)</td><td align="left">0.0004 (0.0006)</td></tr><tr><td align="left">32</td><td align="left">ASE</td><td align="left">0.0118 (0.0087)</td><td align="left">0.0110 (0.0031)</td><td align="left">0.0076 (0.0033)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0001 (0.0003)</td></tr><tr><td align="left">56</td><td align="left">ASE</td><td align="left">0.0022 (0.0033)</td><td align="left">0.0030 (0.0028)</td><td align="left">0.0019 (0.0011)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td></tr><tr><td align="left"/><td align="left"/><td align="center" colspan="3">
<bold>EFNR</bold>
</td></tr><tr><td align="left">8</td><td align="left">ASE</td><td align="left">0.0418 (0.0169)</td><td align="left">0.0479 (0.0129)</td><td align="left">0.0502 (0.0098)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.2161 (0.0533)</td><td align="left">0.2084 (0.0434)</td><td align="left">0.2075 (0.0410)</td></tr><tr><td align="left">16</td><td align="left">ASE</td><td align="left">0.0239 (0.0095)</td><td align="left">0.0214 (0.0109)</td><td align="left">0.0211 (0.0056)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.1888 (0.0517)</td><td align="left">0.1986 (0.0455)</td><td align="left">0.1762 (0.0360)</td></tr><tr><td align="left">24</td><td align="left">ASE</td><td align="left">0.0161 (0.0077)</td><td align="left">0.0164 (0.0093)</td><td align="left">0.0143 (0.0032)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.1523 (0.0584)</td><td align="left">0.1788 (0.0503)</td><td align="left">0.1577 (0.0246)</td></tr><tr><td align="left">32</td><td align="left">ASE</td><td align="left">0.0060 (0.0071)</td><td align="left">0.0079 (0.0063)</td><td align="left">0.0088 (0.0036)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.1434 (0.0839)</td><td align="left">0.1367 (0.0507)</td><td align="left">0.1368 (0.0227)</td></tr><tr><td align="left">56</td><td align="left">ASE</td><td align="left">0.0040 (0.0057)</td><td align="left">0.0031 (0.0028)</td><td align="left">0.0025 (0.0012)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.1339 (0.1005)</td><td align="left">0.1178 (0.0348)</td><td align="left">0.1332 (0.0287)</td></tr></tbody></table><table-wrap-foot><p>Their standard deviations shown in the parenthesis.</p></table-wrap-foot></table-wrap>
<table-wrap id="Tab6"><label>Table 6</label><caption><p>
<bold>The EFDR (homozygous called heterozygous) and EFNR (heterozygous called homozygous) with 100 SNPs using the haplotype structures from real data</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">
<bold><italic>&#x003bb;</italic></bold>
</th><th align="left"/><th align="left" colspan="3">
<bold>Number of individuals</bold>
</th></tr><tr><th align="left"/><th align="left"/><th align="left">
<bold>6</bold>
</th><th align="left">
<bold>12</bold>
</th><th align="left">
<bold>24</bold>
</th></tr></thead><tbody><tr><td align="left"/><td align="left"/><td align="center" colspan="3">
<bold>EFDR</bold>
</td></tr><tr><td align="left">8</td><td align="left">ASE</td><td align="left">0.0222 (0.0100)</td><td align="left">0.0264 (0.0091)</td><td align="left">0.0243 (0.0038)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0250 (0.0064)</td><td align="left">0.0313 (0.0103)</td><td align="left">0.0297 (0.0060)</td></tr><tr><td align="left">16</td><td align="left">ASE</td><td align="left">0.0026 (0.0032)</td><td align="left">0.0023 (0.0020)</td><td align="left">0.0043 (0.0033)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0023 (0.0025)</td><td align="left">0.0023 (0.0027)</td><td align="left">0.0040 (0.0033)</td></tr><tr><td align="left">24</td><td align="left">ASE</td><td align="left">0.0006 (0.0013)</td><td align="left">0.0003 (0.0008)</td><td align="left">0.0006 (0.0005)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0006 (0.0013)</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0003 (0.0005)</td></tr><tr><td align="left">32</td><td align="left">ASE</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0002 (0.0006)</td><td align="left">0.0004 (0.0005)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td></tr><tr><td align="left">56</td><td align="left">ASE</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td></tr><tr><td align="left"/><td align="left"/><td align="center" colspan="3">
<bold>EFNR</bold>
</td></tr><tr><td align="left">8</td><td align="left">ASE</td><td align="left">0.0375 (0.0224)</td><td align="left">0.0295 (0.0090)</td><td align="left">0.0259 (0.0072)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0322 (0.0193)</td><td align="left">0.0251 (0.0080)</td><td align="left">0.0219 (0.0048)</td></tr><tr><td align="left">16</td><td align="left">ASE</td><td align="left">0.0028 (0.0032)</td><td align="left">0.0030 (0.0024)</td><td align="left">0.0033 (0.0020)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0037 (0.0043)</td><td align="left">0.0027 (0.0021)</td><td align="left">0.0028 (0.0019)</td></tr><tr><td align="left">24</td><td align="left">ASE</td><td align="left">0.0002 (0.0008)</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0006 (0.0006)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0006 (0.0007)</td></tr><tr><td align="left">32</td><td align="left">ASE</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0003 (0.0011)</td><td align="left">0.0002 (0.0005)</td><td align="left">0.0000 (0.0000)</td></tr><tr><td align="left">56</td><td align="left">ASE</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td></tr><tr><td align="left"/><td align="left">NASE</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td><td align="left">0.0000 (0.0000)</td></tr></tbody></table><table-wrap-foot><p>The data were generated without ASE, namely, all the heterozygous genes have ASE ratio 0.5. Their standard deviations shown in the parenthesis.</p></table-wrap-foot></table-wrap>
</p></sec><sec id="Sec7"><title>Real data analysis</title><p>
<bold>Assessing accuracy of heterozygote calling rates</bold> Called cSNP genotypes were compared to gold-standards or true genotypes. In the simulation, the true genotype was readily available. For the real data analysis, genotypes obtained from a DNA SNP chip were used as a gold standard to evaluate the performance of cSNP calling and genotyping. The EFDR and Sensitivity were computed to assess the accuracy of genotype calling where <disp-formula id="Equf"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}
$$\text{Sensitivity} =\frac{\text{\# Heterozygotes called heterozygotes}}{\text{Total \# of heterozygotes}}. $$
\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mtext>Sensitivity</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mtext># Heterozygotes called heterozygotes</mml:mtext></mml:mrow><mml:mrow><mml:mtext>Total # of heterozygotes</mml:mtext></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic xlink:href="12859_2015_479_Equf.gif" position="anchor"/></alternatives></disp-formula>
</p><p>These measures are especially relevant when the intent of genotype calling is to perform ASE testing, because they focus on key heterozygous genotypes. EFDR and Sensitivity can be computed globally across all sites and individuals on a cSNP site basis.</p><p>
<bold>Comparison with alternative methods</bold> We applied the proposed HMMs, HMM-ASE and HMM-NASE, to a real RNAseq dataset and compared SNP genotype calls with those from VarScan, SAMtools+BCFtools and BEAGLE, well-known methods for SNP and mutation calling from sequence data. RNAseq data were available for 24 female pigs from an F2 cross of Duroc and Pietrain in our pig resource population [<xref ref-type="bibr" rid="CR29">29</xref>-<xref ref-type="bibr" rid="CR32">32</xref>]. Pig breeds are outbred and show substantial variation in allele frequency, high linkage disequilibrium within breed and limited phase agreement between breeds [<xref ref-type="bibr" rid="CR33">33</xref>]. These animals were part of a larger transcriptional profiling study [<xref ref-type="bibr" rid="CR34">34</xref>] and had been selected because they showed extreme phenotypes for loin eye area (a trait of economic value) compared to their litter mates. SNP chip data were available from the 60K illumina chip [<xref ref-type="bibr" rid="CR35">35</xref>] from a recent study. Genotype data from the chip were treated as a gold standard against which cSNP called with RNAseq were validated. RNA from each sample was reverse transcribed into cDNA, fragmented and labeled to generate 24 barcoded libraries that were sequenced on an Illumina HiSeq 2000 (100 bp, paired-end reads). Each library was sequenced in four lanes with the raw read data consisting of 96 pairs of fastq files (4 per sample) containing approximately 15million short-reads (100 bp) each. Those fastq files were pre-processed using FASTX toolkit (<ext-link ext-link-type="uri" xlink:href="http://hannonlab.cshl.edu/fastx_toolkit/">http://hannonlab.cshl.edu/fastx_toolkit/</ext-link>) and FASTQC (http://www.bioinformatics.babraham.ac.uk/projects/fastqc/) to assess read quality. Then, Tophat [<xref ref-type="bibr" rid="CR36">36</xref>] was used for mapping the reads to the reference genome (Sus scrofa 10.2.69 retrieved from the Ensembl database) using an index generated by Bowtie2 [<xref ref-type="bibr" rid="CR37">37</xref>]. The aligned records were stored in BAM/SAM format [<xref ref-type="bibr" rid="CR38">38</xref>]. Alignment statistics and base coverage were calculated for each file using SAMTools [<xref ref-type="bibr" rid="CR38">38</xref>]. Initially coding SNP discovery and genotyping were done with VarScan [<xref ref-type="bibr" rid="CR17">17</xref>]. First, a base alignment file (.mpileup) for each covered position was obtained for each chromosome using the mpileup option of SAMTools [<xref ref-type="bibr" rid="CR19">19</xref>] and subsequently VarScan [<xref ref-type="bibr" rid="CR17">17</xref>] was used to call genotypes and count reads mapping to each segregating allele. We focused on chromosome 13 and extracted counts of reads agreeing with reference (R) or alternative (A) allele with respect to the reference genome at putative 5364 cSNP discovered by VarScan, which included 65 SNPs represented in the 60K chip for which we had reliable genotype data. We segmented the SNP data into 65 brackets that included each of those SNP and their surrounding cSNPs. Each bracket was analyzed separately with our program because we expect that only closely linked cSNPs will benefit from our multi-SNP HMM model.</p><p>There were a total of 1560 genotypes to impute (24 animals and 65 SNPs), 591 heterozygotes and 969 homozygotes. VarScan (Table <xref rid="Tab7" ref-type="table">7</xref>) did not impute any homozygotes as heterozygotes (EFDR = 0), but it only correctly identified 449 of the 591 heterozygotes (Sensitivity = 0.76). This drop in sensitivity to detect heterozygotes was accounted for by the non-call rate (64/591 =0.11) and wrongly calling 78 heterozygotes as homozygotes (0.14). The HMM-ASE and HMM-NASE had an EFDR =0.015 (9/(571 + 9)) and 2/(570 + 2) =0.0035, respectively. But the sensitivities were 1.0 (detected all Heterozygotes) and 0.998, respectively if the restriction of having at least one read was imposed. Remarkably, even some genotypes without any reads were imputed correctly due to exploitation of zygotic disequilibrium. In this particular data set, HMM-ASE did not show additional advantage by considering ASE effects, indicating that modeling dependence is more important than modeling ASE. We also called cSNPs using two widely used algorithms: SAMtools+BCFtools and SAMtools+BCFtools+Beagle. SAMtools+BCFtools is probably the most commonly used algorithm for calling SNP, it calls SNP genotypes independently and its likelihood function assumes no ASE. When read counts are very low, SAMtools+BCFtools may not call SNP genotypes. Alternatively, BEAGLE uses the output from the previous algorithm and performs SNP calling by accounting for LD. Table <xref rid="Tab7" ref-type="table">7</xref> shows that these two methods were very similar to the proposed methods in terms of EFDR, which were 0.007 and 0.010, respectively. These two methods performed slightly better than HMM-ASE and HMM-NASE for SNPs with zero counts. But the proposed methods were slightly better than the SAMtools+BCFtools and Beagle methods for SNPs with non-zero counts (See Table S.2 in Section 3 of the Additional file <xref rid="MOESM1" ref-type="media">1</xref>). Since the performance of HMM-ASE, HMM-NASE, SAMtools+BCFtools and Beagle methods were very similar in discovering heterozygous SNPs, we decided to proceed with HMM-ASE analysis after assigning non-calls to those genotypes without any read.<table-wrap id="Tab7"><label>Table 7</label><caption><p>
<bold>Contingency tables of genotype calling with five methods (columns) versus actual genotypes (rows)</bold>
</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">
<bold>Actual</bold>
</th><th align="left" colspan="3">
<bold>VarScan Genotype</bold>
</th><th align="left" colspan="3">
<bold>HMM-ASE</bold>
</th><th align="left" colspan="3">
<bold>HMM-NASE</bold>
</th></tr></thead><tbody><tr><td align="left">genotype</td><td align="left">He</td><td align="left">Ho</td><td align="left">NC</td><td align="left">He</td><td align="left">Ho</td><td align="left">NC</td><td align="left">He</td><td align="left">Ho</td><td align="left">NC</td></tr><tr><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left"/><td align="left">(Reads =0)</td><td align="left"/><td align="left"/><td align="left">(Reads =0)</td></tr><tr><td align="left">He</td><td align="left">449</td><td align="left">78</td><td align="left">64</td><td align="left">
<bold>571</bold>
</td><td align="left">0</td><td align="left">20</td><td align="left">
<bold>570</bold>
</td><td align="left">1</td><td align="left">20</td></tr><tr><td align="left">Ho</td><td align="left">0</td><td align="left">886</td><td align="left">83</td><td align="left">9</td><td align="left">
<bold>914</bold>
</td><td align="left">46</td><td align="left">2</td><td align="left">
<bold>921</bold>
</td><td align="left">46</td></tr><tr><td align="left">
<bold>Actual</bold>
</td><td align="center" colspan="3">
<bold>SAMTOOLS + BCFTOOLS</bold>
</td><td align="center" colspan="3">
<bold>BEAGLE</bold>
</td><td align="center" colspan="3"/></tr><tr><td align="left">genotype</td><td align="left">He</td><td align="left">Ho</td><td align="left">NC</td><td align="left">He</td><td align="left">Ho</td><td align="left">NC</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">He</td><td align="left">
<bold>576</bold>
</td><td align="left">9</td><td align="left">6</td><td align="left">
<bold>583</bold>
</td><td align="left">8</td><td align="left">0</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left">Ho</td><td align="left">4</td><td align="left">
<bold>957</bold>
</td><td align="left">8</td><td align="left">6</td><td align="left">
<bold>963</bold>
</td><td align="left">0</td><td align="left"/><td align="left"/><td align="left"/></tr></tbody></table><table-wrap-foot><p>Values in bold represent counts of correct calls. The other values are incorrect calls or Non-called (NC).</p></table-wrap-foot></table-wrap>
</p><p>Upon a SNP-by-SNP analysis of genotype calls, the low sensitivities obtained with the two programs (HMM-ASE and VarScan) for some markers can be largely explained by low coverage (Figure <xref rid="Fig2" ref-type="fig">2</xref>). In our HMM-ASE model, having at least 200 total reads (across all 24 individuals) produced sensitivities over 0.8 but the effect of these errors in final inferences is not clear. For example, if inferred genotypes are used for ASE, the effect of missing a heterozygote is lower power, while the effect of incorrectly imputing a homozygote as heterozygote could be biases in the estimated ASE (and false positive rate of ASE tests). Conversely, the two errors could potentially cancel out when using genotypes to estimate minor allelic frequency (MAF). Consequently, we proceeded to estimate MAF using ascertained genotypes and confirmed that HMM-ASE estimated MAF very precisely (Figure <xref rid="Fig3" ref-type="fig">3</xref>) with a correlation of 0.94 with DNA chip based estimates.<fig id="Fig2"><label>Figure 2</label><caption><p>
<bold>Sensitivity (proportion of Heterozygotes genotypes called by each program) as a function of total read count.</bold>
</p></caption><graphic xlink:href="12859_2015_479_Fig2_HTML" id="MO2"/></fig>
<fig id="Fig3"><label>Figure 3</label><caption><p>
<bold>Estimated minor allele frequency using genotypes from DNA chip or from called cSNP.</bold>
</p></caption><graphic xlink:href="12859_2015_479_Fig3_HTML" id="MO3"/></fig>
</p><p>In order to assess the effect of genotype ascertainment on estimation and testing of ASE, we used heterozygous genotypes (either observed with chip or ascertained) and fit a beta-binomial model [<xref ref-type="bibr" rid="CR39">39</xref>] to read counts. In fact, when working with HMM-ASE this would not be necessary because our method produced estimates of ASE parameters, but we used the beta-binomial model in order to separately assess the effect of genotype calling errors. In Figure <xref rid="Fig4" ref-type="fig">4</xref> we observe that using genotypes ascertained with the HMM-ASE produced very accurate estimates of ASE. On the other hand, using heterozygote genotypes ascertained with VarScan also produced good agreement with those from chip data, except when the sensitivity was very low either because of calling heterozygotes as homozygotes or because of non-calling a genotype (horizontal points close to zero). These effects were even more obvious when looking at associated p-values. In that case, missing heterozygotes from the single SNP analysis program (in this case VarScan) substantially reduced significance (Figure <xref rid="Fig5" ref-type="fig">5</xref>).<fig id="Fig4"><label>Figure 4</label><caption><p>
<bold>log-ASE ratio of fitting beta-binomial model on counts from Heterozygous individuals.</bold> Heterozygous status was either taken from chip data (x-axis) or from genotypes called from sequence data (y-axis).</p></caption><graphic xlink:href="12859_2015_479_Fig4_HTML" id="MO4"/></fig>
<fig id="Fig5"><label>Figure 5</label><caption><p>
<bold><italic>log10</italic></bold>
<bold>(p-value) of fitting beta-binomial model on counts from Heterozygous individuals.</bold> Heterozygous status was either taken from chip data (x-axis) or from genotypes called from sequence data (y-axis).</p></caption><graphic xlink:href="12859_2015_479_Fig5_HTML" id="MO5"/></fig>
</p></sec></sec></sec><sec id="Sec10"><title>Conclusion and discussion</title><p>In this paper, we present HMM methods to call SNP genotypes in the presence of allelic imbalance by exploiting zygotic disequilibrium. In its present form, HMM-ASE and HMM-NASE require that cSNP locations have been previously ascertained and conditional on those it can accurately call their genotypes. Our program is particularly useful for cSNP genotyping after a SNP discovery step has been applied [<xref ref-type="bibr" rid="CR18">18</xref>]. This is important because while many programs are tailored for cSNP discovery [<xref ref-type="bibr" rid="CR18">18</xref>] and genotyping assuming allelic balance in heterozygotes, there is a need for accurate genotype calling by exploiting linkage disequilibrium in the presence of ASE in individuals from outbred populations [<xref ref-type="bibr" rid="CR15">15</xref>]. HMM-ASE and HMM-NASE can use read counts of 4 bases or pre-filtered biallelic counts. The biallelic option was used in the real data case because previous cSNP discovery using VarScan produced counts of reference and alternative alleles. A similar pre-processing step can be performed with a number of available programs [<xref ref-type="bibr" rid="CR18">18</xref>]. The strength of HMM compared to other methods is that it can reliably call heterozygous cSNP genotypes even in the presence of ASE and under low sequencing coverage. Furthermore, by comparing to DNA-chip genotypes, genotypes produced using the proposed methods resulted in good estimates of ASE and MAF. This is important in population genetics that can use low-coverage sequence of many individuals in order to accurately estimate MAF, linkage disequilibrium and other population genomics parameters [<xref ref-type="bibr" rid="CR33">33</xref>]. Another potential use of genotypes obtained from HMMs is to perform ASE testing [<xref ref-type="bibr" rid="CR13">13</xref>]. Although not extensively studied in this first paper, HMM-ASE could be used to derive not only the cSNP genotypes but their ASE ratios. In its current form, HMM-ASE integrates out such information when calling genotypes, but further work in this area is warranted.</p><p>An important part of implementing our HMM algorithm in HMM-ASE and HMM-NASE consists of segmenting the SNPs in groups that are tractable and informative. From the simulation study and real data analysis, we found that the HMM-NASE was very robust in terms of group segmentation but HMM-ASE was slightly more sensitive to the number of SNPs and the length of the segment. In particular, EFDR (genotyping homozygotes as heterozygotes) was slightly lower when the segment was 1kb long compared to 4 kb long. We experimented with many criteria to partition the SNPs in the real data set and found that the inferences were robust to the number of SNPs in the segment for a range of 2 to 25 SNPs over a 1/2 kb to 2 kb long segments. We only observed one SNP within a 1 kb segment containing 35 SNPs had slightly higher EFDR. Further inspection of the segment indicated that this region likely included SNPs from several transcripts and that the zygotic disequilibrium seemed to be low for SNPs on different transcripts. A possibility to mitigate this problem could be to group SNP by transcript by using bioinformatics tools such as the ensemble variation API [<xref ref-type="bibr" rid="CR40">40</xref>]. Since this problem was sporadic (one segment) in our data set we believe that such an approach was not needed.</p><p>In summary, in this paper we present and evaluate an algorithm for calling SNP genotypes in the presence of allelic imbalance by exploiting linkage disequilibrium. The method is particularly suitable for calling cSNP from low-coverage RNA-seq data and the resulting genotypes show good properties for estimation of genetic parameters and allelic ratios. We provide HMMASE, an R package to implement the proposed algorithm (http://www.stt.msu.edu/users/pszhong/HMMASE.html). Our algorithm performed better than VarScan and similarly to BCFtools and Beagle, indicating that the joint modeling of ASE and LD recovered important information although our algorithm did not use haplotypes information. Furthermore, our promising results encourage further research on extending the algorithm to incorporate haplotype structures and performing the ASE testing.</p></sec><sec id="Sec11"><title>Availability of supporting data</title><p>The data set and the R package HMMASE supporting the results of this article are available in http://www.stt.msu.edu/users/pszhong/HMMASE.html.</p></sec></body><back><app-group><app id="App1"><sec id="Sec12"><title>Additional file</title><p>
<media position="anchor" xlink:href="12859_2015_479_MOESM1_ESM.pdf" id="MOESM1"><label>Additional file 1</label><caption><p>
<bold>Supplemental.</bold> Contains a detailed algorithm of the proposed HMM-ASE algorithm <bold>(Section 1)</bold>, with an extension to the case with distance dependent transition matrix <bold>(Section 2)</bold>. In <bold>Section 3</bold>, we include some additional real data analysis results using distance dependent transition matrix and the comparison with BCFtools and Beagle after excluding the zero counts in the data set. In <bold>Section 4</bold>, two additional tables for simulation studies with haplotypes generated from the real data are also included.</p></caption></media>
</p></sec></app></app-group><fn-group><fn><p><bold>Competing interests</bold></p><p>The authors declare that they have no competing interests.</p></fn><fn><p><bold>Authors&#x02019; contributions</bold></p><p>Development of the method (PSZ &#x00026; JPS); Developing the software (HW); Writing the manuscript (PSZ &#x00026; JPS). All authors read and approved the final manuscript.</p></fn></fn-group><ack><title>Acknowledgements</title><p>The authors thank the Associate Editor and three referees for constructive comments and suggestions. We also acknowledge the supports from NSF grants DMS-1209112, DMS-1309156, NIFA-AFRI 2010-65205-20342 and NIFA-AFRI 2011-07015-30338.</p></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Gerstein</surname><given-names>M</given-names></name><name><surname>Snyder</surname><given-names>M</given-names></name></person-group><article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title><source>Nat Rev Genet</source><year>2009</year><volume>10</volume><fpage>57</fpage><lpage>63</lpage><pub-id pub-id-type="doi">10.1038/nrg2484</pub-id><pub-id pub-id-type="pmid">19015660</pub-id></element-citation></ref><ref id="CR2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>139</fpage><lpage>40</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id><pub-id pub-id-type="pmid">19910308</pub-id></element-citation></ref><ref id="CR3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>C&#x000e1;novas</surname><given-names>A</given-names></name><name><surname>Rincon</surname><given-names>G</given-names></name><name><surname>Islas-Trejo</surname><given-names>A</given-names></name><name><surname>Wickramasinghe</surname><given-names>S</given-names></name><name><surname>Medrano</surname><given-names>JF</given-names></name></person-group><article-title>SNP discovery in the bovine milk transcriptome using RNA-Seq technology</article-title><source>Mammalian Genome</source><year>2010</year><volume>21</volume><fpage>592</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1007/s00335-010-9297-z</pub-id><pub-id pub-id-type="pmid">21057797</pub-id></element-citation></ref><ref id="CR4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nielsen</surname><given-names>R</given-names></name><name><surname>Korneliussen</surname><given-names>T</given-names></name><name><surname>Albrechtsen</surname><given-names>A</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group><article-title>SNP calling, genotype calling, and sample allele frequency estimation from New-Generation sequencing data</article-title><source>PLoS One</source><year>2012</year><volume>7</volume><fpage>37558</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0037558</pub-id></element-citation></ref><ref id="CR5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Montgomery</surname><given-names>S</given-names></name><name><surname>Sammeth</surname><given-names>M</given-names></name><name><surname>Gutierrez-Arcelus</surname><given-names>M</given-names></name><name><surname>Lach</surname><given-names>R</given-names></name><name><surname>Ingle</surname><given-names>C</given-names></name><name><surname>Nisbett</surname><given-names>J</given-names></name><etal/></person-group><article-title>Transcriptome genetics using second generation sequencing in a Caucasian population</article-title><source>Nature</source><year>2010</year><volume>464</volume><fpage>773</fpage><lpage>77</lpage><pub-id pub-id-type="doi">10.1038/nature08903</pub-id><pub-id pub-id-type="pmid">20220756</pub-id></element-citation></ref><ref id="CR6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pickrell</surname><given-names>J</given-names></name><name><surname>Marioni Pai</surname><given-names>A</given-names></name><name><surname>Degner</surname><given-names>J</given-names></name><name><surname>Engelhardt</surname><given-names>B</given-names></name><name><surname>Nkadori</surname><given-names>E</given-names></name><name><surname>Veyrieras</surname><given-names>J</given-names></name><etal/></person-group><article-title>Understanding mechanisms underlying human gene expression variation with RNA sequencing</article-title><source>Nature</source><year>2010</year><volume>464</volume><fpage>768</fpage><lpage>72</lpage><pub-id pub-id-type="doi">10.1038/nature08872</pub-id><pub-id pub-id-type="pmid">20220758</pub-id></element-citation></ref><ref id="CR7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pastinen</surname><given-names>T</given-names></name></person-group><article-title>Genome-wide allele-specific analysis: insights into regulatory variation</article-title><source>Nat Rev Genet</source><year>2010</year><volume>11</volume><fpage>533</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1038/nrg2815</pub-id><pub-id pub-id-type="pmid">20567245</pub-id></element-citation></ref><ref id="CR8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>W</given-names></name></person-group><article-title>A statistical framework for eQTL mapping using RNA-seq data</article-title><source>Biometrics</source><year>2012</year><volume>68</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1111/j.1541-0420.2011.01654.x</pub-id><pub-id pub-id-type="pmid">21838806</pub-id></element-citation></ref><ref id="CR9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pandey</surname><given-names>R</given-names></name><name><surname>Franssen</surname><given-names>S</given-names></name><name><surname>Futschik</surname><given-names>A</given-names></name><name><surname>Schlotterer</surname><given-names>C</given-names></name></person-group><article-title>Allelic imbalance metre (Allim), a new tool for measuring allele-specific gene expression with RNA-seq data</article-title><source>Mol Ecol Resour</source><year>2013</year><volume>13</volume><issue>4</issue><fpage>740</fpage><lpage>5</lpage><pub-id pub-id-type="doi">10.1111/1755-0998.12110</pub-id><pub-id pub-id-type="pmid">23615333</pub-id></element-citation></ref><ref id="CR10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rozowsky</surname><given-names>J</given-names></name><name><surname>Abyzoy</surname><given-names>A</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Alves</surname><given-names>P</given-names></name><name><surname>Raha</surname><given-names>D</given-names></name><name><surname>Harmanci</surname><given-names>A</given-names></name><etal/></person-group><article-title>AlleleSeq: analysis of allele-specific expression and binding in a network framework</article-title><source>Mol Syst Biol</source><year>2011</year><volume>7</volume><fpage>522</fpage><pub-id pub-id-type="doi">10.1038/msb.2011.54</pub-id><pub-id pub-id-type="pmid">21811232</pub-id></element-citation></ref><ref id="CR11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turro</surname><given-names>E</given-names></name><name><surname>Su</surname><given-names>S</given-names></name><name><surname>Gon&#x000e7;alves</surname><given-names>A</given-names></name><name><surname>Coin</surname><given-names>L</given-names></name><name><surname>Richardson</surname><given-names>S</given-names></name><name><surname>Lewin</surname><given-names>A</given-names></name></person-group><article-title>Haplotype and isoform specific expression estimation using multi-mapping RNA-seq reads</article-title><source>Genome Biol</source><year>2011</year><volume>12</volume><fpage>R13</fpage><pub-id pub-id-type="doi">10.1186/gb-2011-12-2-r13</pub-id><pub-id pub-id-type="pmid">21310039</pub-id></element-citation></ref><ref id="CR12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Skelly</surname><given-names>D</given-names></name><name><surname>Johansson</surname><given-names>M</given-names></name><name><surname>Madeoy</surname><given-names>J</given-names></name><name><surname>Wakefield</surname><given-names>J</given-names></name><name><surname>Akey</surname><given-names>J</given-names></name></person-group><article-title>A powerful and flexible statistical framework for testing hypotheses of allele-specific gene expression from RNA-seq data</article-title><source>Genome Res</source><year>2011</year><volume>21</volume><fpage>1728</fpage><lpage>37</lpage><pub-id pub-id-type="doi">10.1101/gr.119784.110</pub-id><pub-id pub-id-type="pmid">21873452</pub-id></element-citation></ref><ref id="CR13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ernst</surname><given-names>CW</given-names></name><name><surname>Steibel</surname><given-names>JP</given-names></name></person-group><article-title>Molecular advances in QTL discovery and application in pig breeding</article-title><source>Trends Genet</source><year>2013</year><volume>29</volume><fpage>215</fpage><lpage>224</lpage><pub-id pub-id-type="doi">10.1016/j.tig.2013.02.002</pub-id><pub-id pub-id-type="pmid">23498076</pub-id></element-citation></ref><ref id="CR14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perumbakkam Muir</surname><given-names>W</given-names></name><name><surname>Black-Pyrkosz</surname><given-names>A</given-names></name><name><surname>Okimoto</surname><given-names>R</given-names></name><name><surname>Cheng</surname><given-names>H</given-names></name></person-group><article-title>Comparison and contrast of genes and biological pathways responding to Marek&#x02019;s disease virus infection using allele-specific expression and differential expression in broiler and layer chickens</article-title><source>BMC Genomics</source><year>2013</year><volume>14</volume><fpage>64</fpage><pub-id pub-id-type="doi">10.1186/1471-2164-14-64</pub-id><pub-id pub-id-type="pmid">23363372</pub-id></element-citation></ref><ref id="CR15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singhal</surname><given-names>S</given-names></name></person-group><article-title>De novo transcriptomic analyses for non-model organisms: an evaluation of methods across a multi-species data set</article-title><source>Mol Ecol Resources</source><year>2013</year><volume>13</volume><fpage>403</fpage><lpage>16</lpage><pub-id pub-id-type="doi">10.1111/1755-0998.12077</pub-id></element-citation></ref><ref id="CR16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DePristo</surname><given-names>M</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><name><surname>Poplin</surname><given-names>R</given-names></name><name><surname>Garimella</surname><given-names>K</given-names></name><name><surname>Maguire</surname><given-names>J</given-names></name><name><surname>Hartl</surname><given-names>C</given-names></name><etal/></person-group><article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title><source>Nat Genet</source><year>2011</year><volume>43</volume><fpage>491</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1038/ng.806</pub-id><pub-id pub-id-type="pmid">21478889</pub-id></element-citation></ref><ref id="CR17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koboldt</surname><given-names>D</given-names></name><name><surname>Chen</surname><given-names>K</given-names></name><name><surname>Wylie</surname><given-names>T</given-names></name><name><surname>Larson</surname><given-names>D</given-names></name><name><surname>McLellan</surname><given-names>M</given-names></name><name><surname>Mardis</surname><given-names>E</given-names></name><etal/></person-group><article-title>VarScan: variant detection in massively parallel sequencing of individual and pooled samples</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2283</fpage><lpage>85</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp373</pub-id><pub-id pub-id-type="pmid">19542151</pub-id></element-citation></ref><ref id="CR18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>You</surname><given-names>N</given-names></name><name><surname>Murillo</surname><given-names>G</given-names></name><name><surname>Su</surname><given-names>X</given-names></name><name><surname>Zeng</surname><given-names>X</given-names></name><name><surname>Ning</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>S</given-names></name><etal/></person-group><article-title>SNP calling using genotype model selection on high-throughput sequencing data</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>643</fpage><lpage>50</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts001</pub-id><pub-id pub-id-type="pmid">22253293</pub-id></element-citation></ref><ref id="CR19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><fpage>2987</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btr509</pub-id><pub-id pub-id-type="pmid">21903627</pub-id></element-citation></ref><ref id="CR20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raineri</surname><given-names>E</given-names></name><name><surname>Ferretti</surname><given-names>L</given-names></name><name><surname>Esteve-Codina</surname><given-names>A</given-names></name><name><surname>Nevado</surname><given-names>B</given-names></name><name><surname>Heath</surname><given-names>S</given-names></name><name><surname>P&#x000e9;rez-Enciso</surname><given-names>M</given-names></name></person-group><article-title>SNP calling by sequencing pooled samples</article-title><source>BMC Bioinformatics</source><year>2012</year><volume>13</volume><fpage>239</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-13-239</pub-id><pub-id pub-id-type="pmid">22992255</pub-id></element-citation></ref><ref id="CR21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bickel</surname><given-names>PJ</given-names></name><name><surname>Ritov</surname><given-names>Y</given-names></name><name><surname>Ryd&#x000e9;n</surname><given-names>T</given-names></name></person-group><article-title>Asymptotic normality of the maximum-likelihood estimator for general hidden Markov models</article-title><source>Ann Stat</source><year>1998</year><volume>26</volume><fpage>1614</fpage><lpage>1635</lpage><pub-id pub-id-type="doi">10.1214/aos/1024691255</pub-id></element-citation></ref><ref id="CR22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>H</given-names></name><name><surname>Xing</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>N</given-names></name></person-group><article-title>Estimation of parent specific DNA copy number in tumors using high-density genotyping arrays</article-title><source>PLoS Comput Biol</source><year>2011</year><volume>7</volume><issue>1</issue><fpage>e1001060</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1001060</pub-id><pub-id pub-id-type="pmid">21298078</pub-id></element-citation></ref><ref id="CR23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>M</given-names></name><name><surname>Hadley</surname><given-names>D</given-names></name><name><surname>Liu</surname><given-names>R</given-names></name><name><surname>Glessner</surname><given-names>J</given-names></name><name><surname>Grant</surname><given-names>S</given-names></name><etal/></person-group><article-title>PennCNV: An integrated hidden Markov model designed for high-resolution copy number variation detection in whole-genome SNP genotyping data</article-title><source>Genome Res</source><year>2007</year><volume>17</volume><issue>11</issue><fpage>1665</fpage><lpage>74</lpage><pub-id pub-id-type="doi">10.1101/gr.6861907</pub-id><pub-id pub-id-type="pmid">17921354</pub-id></element-citation></ref><ref id="CR24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname><given-names>SR</given-names></name><name><surname>Browning</surname><given-names>BL</given-names></name></person-group><article-title>Rapid and accurate haplotype phasing and missing data inference for whole genome association studies by use of localized haplotype clustering</article-title><source>Am J Hum Genet</source><year>2007</year><volume>81</volume><fpage>1084</fpage><lpage>97</lpage><pub-id pub-id-type="doi">10.1086/521987</pub-id><pub-id pub-id-type="pmid">17924348</pub-id></element-citation></ref><ref id="CR25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baum</surname><given-names>L</given-names></name><name><surname>Petrie</surname><given-names>T</given-names></name><name><surname>Soules</surname><given-names>G</given-names></name><name><surname>Weiss</surname><given-names>N</given-names></name></person-group><article-title>A maximization technique occurring in the statistical analysis of probabilistic functions of Markov chains</article-title><source>Ann Math Stat</source><year>1970</year><volume>41</volume><fpage>164</fpage><lpage>71</lpage><pub-id pub-id-type="doi">10.1214/aoms/1177697196</pub-id></element-citation></ref><ref id="CR26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dempster</surname><given-names>A</given-names></name><name><surname>Laird</surname><given-names>N</given-names></name><name><surname>Rubin</surname><given-names>D</given-names></name></person-group><article-title>Maximum likelihood from incomplete data via the EM algorithm (With discussion)</article-title><source>J R Stat Soc Ser B</source><year>1977</year><volume>39</volume><fpage>1</fpage><lpage>38</lpage></element-citation></ref><ref id="CR27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rabiner</surname><given-names>L</given-names></name></person-group><article-title>A tutorial on Hidden Markov models and selected applications in speech recognition</article-title><source>Proc IEEE</source><year>1989</year><volume>77</volume><fpage>257</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1109/5.18626</pub-id></element-citation></ref><ref id="CR28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gualdr&#x000f3;n Duarte</surname><given-names>J</given-names></name><name><surname>Bates</surname><given-names>R</given-names></name><name><surname>Ernst</surname><given-names>C</given-names></name><name><surname>Raney</surname><given-names>N</given-names></name><name><surname>Cantet</surname><given-names>R</given-names></name><name><surname>Steibel</surname><given-names>J</given-names></name></person-group><article-title>Genotype imputation accuracy in a F2 pig population using high density and low density SNP panels</article-title><source>BMC Genet</source><year>2013</year><volume>14</volume><fpage>38</fpage><pub-id pub-id-type="doi">10.1186/1471-2156-14-38</pub-id><pub-id pub-id-type="pmid">23651538</pub-id></element-citation></ref><ref id="CR29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choi</surname><given-names>I</given-names></name><name><surname>Bates</surname><given-names>R</given-names></name><name><surname>Raney</surname><given-names>N</given-names></name><name><surname>Steibel</surname><given-names>J</given-names></name><name><surname>Ernst</surname><given-names>C</given-names></name></person-group><article-title>Evaluation of QTL for carcass merit and meat quality traits in a US commercial Duroc population</article-title><source>Meat Sci</source><year>2012</year><volume>92</volume><fpage>132</fpage><lpage>8</lpage><pub-id pub-id-type="doi">10.1016/j.meatsci.2012.04.023</pub-id><pub-id pub-id-type="pmid">22578477</pub-id></element-citation></ref><ref id="CR30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Choi</surname><given-names>I</given-names></name><name><surname>Steibel</surname><given-names>J</given-names></name><name><surname>Bates</surname><given-names>R</given-names></name><name><surname>Raney</surname><given-names>N</given-names></name><name><surname>Rumph</surname><given-names>J</given-names></name><name><surname>Ernst</surname><given-names>C</given-names></name></person-group><article-title>Identification of Carcass and Meat Quality QTL in an F(2) Duroc x Pietrain pig resource population using different least-squares analysis models</article-title><source>Front Genet</source><year>2011</year><volume>2</volume><fpage>18</fpage><pub-id pub-id-type="doi">10.3389/fgene.2011.00018</pub-id><pub-id pub-id-type="pmid">22303314</pub-id></element-citation></ref><ref id="CR31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edwards</surname><given-names>D</given-names></name><name><surname>Ernst</surname><given-names>C</given-names></name><name><surname>Raney</surname><given-names>N</given-names></name><name><surname>Doumit</surname><given-names>M</given-names></name><name><surname>Hoge</surname><given-names>M</given-names></name><name><surname>Bates</surname><given-names>R</given-names></name></person-group><article-title>Quantitative trait loci mapping in an F2 Duroc x Pietrain resource population</article-title><source>I. Growth traits. J Anim Sci.</source><year>2008</year><volume>86</volume><fpage>241</fpage><lpage>53</lpage><pub-id pub-id-type="pmid">17965327</pub-id></element-citation></ref><ref id="CR32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edwards</surname><given-names>D</given-names></name><name><surname>Ernst</surname><given-names>C</given-names></name><name><surname>Raney</surname><given-names>N</given-names></name><name><surname>Doumit</surname><given-names>M</given-names></name><name><surname>Hoge</surname><given-names>M</given-names></name><name><surname>Bates</surname><given-names>R</given-names></name></person-group><article-title>Quantitative trait locus mapping in an F2 Duroc x Pietrain resource population</article-title><source>II. Carcass and meat quality traits, J Anim Sci</source><year>2008</year><volume>86</volume><fpage>254</fpage><lpage>66</lpage><pub-id pub-id-type="pmid">17965326</pub-id></element-citation></ref><ref id="CR33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Badke</surname><given-names>Y</given-names></name><name><surname>Bates</surname><given-names>R</given-names></name><name><surname>Ernst</surname><given-names>C</given-names></name><name><surname>Schwab</surname><given-names>C</given-names></name><name><surname>Steibel</surname><given-names>J</given-names></name></person-group><article-title>Estimation of linkage disequilibrium in four US pig breeds</article-title><source>BMC Genomics</source><year>2012</year><volume>13</volume><fpage>24</fpage><pub-id pub-id-type="doi">10.1186/1471-2164-13-24</pub-id><pub-id pub-id-type="pmid">22252454</pub-id></element-citation></ref><ref id="CR34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Steibel</surname><given-names>J</given-names></name><name><surname>Bates</surname><given-names>R</given-names></name><name><surname>Rosa</surname><given-names>G</given-names></name><name><surname>Tempelman</surname><given-names>R</given-names></name><name><surname>Rilington</surname><given-names>V</given-names></name><name><surname>Ragavendran</surname><given-names>A</given-names></name><etal/></person-group><article-title>Genome-wide linkage analysis of global gene expression in loin muscle tissue identifies candiyear genes in pigs</article-title><source>PLoS One</source><year>2011</year><volume>6</volume><fpage>e16766</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0016766</pub-id><pub-id pub-id-type="pmid">21346809</pub-id></element-citation></ref><ref id="CR35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramos</surname><given-names>A</given-names></name><name><surname>Crooijmans</surname><given-names>R</given-names></name><name><surname>Affara</surname><given-names>N</given-names></name><name><surname>Amaral</surname><given-names>A</given-names></name><name><surname>Archibald</surname><given-names>A</given-names></name><name><surname>Beeyer</surname><given-names>J</given-names></name><etal/></person-group><article-title>Design of a high density SNP genotyping assay in the pig using SNPs identified and characterized by next generation sequencing technology</article-title><source>PLoS One</source><year>2009</year><volume>4</volume><fpage>e6524</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0006524</pub-id><pub-id pub-id-type="pmid">19654876</pub-id></element-citation></ref><ref id="CR36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>TopHat: discovering splice junctions with RNA-Seq</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><issue>9</issue><fpage>1105</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp120</pub-id><pub-id pub-id-type="pmid">19289445</pub-id></element-citation></ref><ref id="CR37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>Fast gapped-read alignment with Bowtie 2</article-title><source>Nat Methods</source><year>2012</year><volume>9</volume><fpage>357</fpage><lpage>59</lpage><pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id><pub-id pub-id-type="pmid">22388286</pub-id></element-citation></ref><ref id="CR38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Handsaker</surname><given-names>B</given-names></name><name><surname>Fennell</surname><given-names>T</given-names></name><name><surname>Ruan</surname><given-names>J</given-names></name><name><surname>Homer</surname><given-names>N</given-names></name><name><surname>Marth</surname><given-names>G</given-names></name><etal/></person-group><article-title>The sequence alignment/Map format and SAMtools</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2078</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id><pub-id pub-id-type="pmid">19505943</pub-id></element-citation></ref><ref id="CR39"><label>39</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Griffiths</surname><given-names>DA</given-names></name></person-group><article-title>Maximum likelihood estimation for the beta-binomial distribution and an application to the household distribution of the total number of cases of disease</article-title><source>Biometrics</source><year>1973</year><volume>29</volume><fpage>637</fpage><lpage>48</lpage><pub-id pub-id-type="doi">10.2307/2529131</pub-id><pub-id pub-id-type="pmid">4785230</pub-id></element-citation></ref><ref id="CR40"><label>40</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McLaren</surname><given-names>W</given-names></name></person-group><article-title>Deriving the consequences of genomic variants with the Ensembl API and SNP effect predictor</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>2069</fpage><lpage>70</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq330</pub-id><pub-id pub-id-type="pmid">20562413</pub-id></element-citation></ref></ref-list></back></article>