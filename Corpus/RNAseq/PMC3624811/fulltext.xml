<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3624811</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btt099</article-id><article-id pub-id-type="publisher-id">btt099</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Papers</subject><subj-group><subject>Systems Biology</subject></subj-group></subj-group></article-categories><title-group><article-title>Robust data-driven incorporation of prior knowledge into the inference of dynamic regulatory networks</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Greenfield</surname><given-names>Alex</given-names></name><xref ref-type="aff" rid="btt099-AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="btt099-COR2"><sup>&#x02020;</sup></xref></contrib><contrib contrib-type="author"><name><surname>Hafemeister</surname><given-names>Christoph</given-names></name><xref ref-type="aff" rid="btt099-AFF1"><sup>2</sup></xref><xref ref-type="corresp" rid="btt099-COR2"><sup>&#x02020;</sup></xref></contrib><contrib contrib-type="author"><name><surname>Bonneau</surname><given-names>Richard</given-names></name><xref ref-type="aff" rid="btt099-AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="btt099-AFF1"><sup>2</sup></xref><xref ref-type="aff" rid="btt099-AFF1"><sup>3</sup></xref><xref ref-type="corresp" rid="btt099-COR1">*</xref></contrib></contrib-group><aff id="btt099-AFF1"><sup>1</sup>Computational Biology Program, New York University Sackler School of Medicine, New York, NY 10065, <sup>2</sup>Department of Biology, Center for Genomics and Systems Biology, New York, NY 10003 and <sup>3</sup>Computer Science Department, Courant Institute of Mathematical Sciences, New York University, New York, NY 10012, USA</aff><author-notes><corresp id="btt099-COR1">*To whom correspondence should be addressed.</corresp><corresp id="btt099-COR2"><sup>&#x02020;</sup>The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.</corresp><fn id="btt099-FN1"><p>Associate Editor: Martin Bishop</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>4</month><year>2013</year></pub-date><pub-date pub-type="epub"><day>21</day><month>3</month><year>2013</year></pub-date><pub-date pub-type="pmc-release"><day>21</day><month>3</month><year>2013</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the							<pub-date pub-type="epub"/>. --><volume>29</volume><issue>8</issue><fpage>1060</fpage><lpage>1067</lpage><history><date date-type="received"><day>24</day><month>10</month><year>2012</year></date><date date-type="rev-recd"><day>28</day><month>1</month><year>2013</year></date><date date-type="accepted"><day>17</day><month>2</month><year>2013</year></date></history><permissions><copyright-statement>&#x000a9; The Author 2013. Published by Oxford University Press.</copyright-statement><copyright-year>2013</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/3.0/"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p><bold>Motivation:</bold> Inferring global regulatory networks (GRNs) from genome-wide data is a computational challenge central to the field of systems biology. Although the primary data currently used to infer GRNs consist of gene expression and proteomics measurements, there is a growing abundance of alternate data types that can reveal regulatory interactions, e.g. ChIP-Chip, literature-derived interactions, protein&#x02013;protein interactions. GRN inference requires the development of integrative methods capable of using these alternate data as priors on the GRN structure. Each source of structure priors has its unique biases and inherent potential errors; thus, GRN methods using these data must be robust to noisy inputs.</p><p><bold>Results:</bold> We developed two methods for incorporating structure priors into GRN inference. Both methods [Modified Elastic Net (MEN) and Bayesian Best Subset Regression (<monospace>BBSR</monospace>)] extend the previously described Inferelator framework, enabling the use of prior information. We test our methods on one synthetic and two bacterial datasets, and show that both <monospace>MEN</monospace> and <monospace>BBSR</monospace> infer accurate GRNs even when the structure prior used has significant amounts of error (&#x0003e;90% erroneous interactions). We find that <monospace>BBSR</monospace> outperforms <monospace>MEN</monospace> at inferring GRNs from expression data and noisy structure priors.</p><p><bold>Availability and implementation:</bold> Code, datasets and networks presented in this article are available at <ext-link ext-link-type="uri" xlink:href="http://bonneaulab.bio.nyu.edu/software.html">http://bonneaulab.bio.nyu.edu/software.html</ext-link>.</p><p><bold>Contact:</bold>
<email>bonneau@nyu.edu</email></p><p><bold>Supplementary information:</bold>
<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt099/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract><counts><page-count count="8"/></counts></article-meta></front><body><sec id="SEC1"><title>1 INTRODUCTION</title><p>Understanding how global regulatory networks (GRNs) coordinate systems-level response of a cell or organism to a new environmental state or perturbation is a key problem in systems biology, with applications spanning biofuels (<xref ref-type="bibr" rid="btt099-B3">Bonneau <italic>et al.</italic>, 2007</xref>), novel therapeutic targets (<xref ref-type="bibr" rid="btt099-B4">Carro <italic>et al.</italic>, 2010</xref>) and the discovery of novel pathways involved in cellular differentiation (<xref ref-type="bibr" rid="btt099-B5">Ciofani <italic>et al.</italic>, 2012</xref>). The cellular response is governed by multiple regulatory mechanisms that can be encapsulated by large network models. Recent advances in the quality and availability of high-throughput technologies enable measurement of different components of the GRN including mRNA transcript levels, protein levels, post-translational modifications, as well as DNA characteristics such as transcription factor-binding regions and open chromatin locations (<xref ref-type="bibr" rid="btt099-B6">ENCODE Project Consortium, 2012</xref>). These multi-level and multi-scale datasets have made the inference of integrative GRNs possible.</p><p>As high-throughput data capturing the abundance of mRNA transcripts are the most mature and readily available, many methods focus only on this single level of regulation, learning transcriptional regulatory networks. In transcriptional GRNs, the regulators are transcription factors (TFs, either previously known or predicted), and the targets are genes. Time-series data, capturing the temporal changes in transcript abundance, allow for the inference of the strength and direction of regulatory interactions, which can be used to predict how the system will behave under previously unmeasured conditions (<xref ref-type="bibr" rid="btt099-B3">Bonneau <italic>et al.</italic>, 2007</xref>). Here, we are primarily interested in methods for learning regulatory networks from compendia of expression data, and combining this data with complementary data sources that provide priors on network structure. Importantly, the priors we use in this work provide information about connectivity but do not provide any information about the relative strength, importance or dynamic properties of each known regulatory edge (these we atempt to learn from the data).</p><p>Learning networks from single data types has severe limitations, as GRNs operate on multiple levels in addition to the transcriptome; thus, alternate data types are needed to form a complete picture of cellular circuits. Even if one is interested in learning the purely transcriptional layer of a cell&#x02019;s regulatory network, many TFs are post-transcriptionally modified in ways that confound single data-type network inference (the transcript abundance of a TF is not necessarily correlated with its protein abundance nor activity), and some regulatory sub circuits produce transcriptional output that is consistent with multiple models.</p><p>One way to mitigate these pitfalls is to use publicly available sources of complementary data with bearing on regulation. We term any data that contains direct TF-target information (either predicted, or experimentally validated) as structure priors. One source of such prior information is an ever-growing collection of experimentally validated and manually curated databases of regulatory interactions. These databases are especially rich for model organisms (<xref ref-type="bibr" rid="btt099-B8">Florez <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="btt099-B10">Gallo <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="btt099-B11">Gama-Castro <italic>et al.</italic>, 2011</xref>; <xref ref-type="bibr" rid="btt099-B18">Lammers <italic>et al.</italic>, 2010</xref>), and the sets of known regulatory interactions are considered to be accurate and precise (though not complete). Additionally, the <xref ref-type="bibr" rid="btt099-B6">ENCODE Project Consortium (2012)</xref> (a high-profile effort to build an encyclopedia of coding DNA elements) has generated a wealth of DNA-binding information that can be used to generate priors on mammalian regulatory network structure. These are only a few examples of an ever growing number of sources of GRN structure priors, and it can be seen that they differ substantially from organism to organism.</p><p>Each source of prior information on GRN structure is an incomplete recapitulation of the underlying network, and may contain many incorrect or irrelevant interactions. Thus, incorporating structure priors into expression-based GRN inference poses several interesting algorithmic challenges. Successful methods for integrative GRN inference must possess the following key properties: (i) The method must only include the part of the prior with support from the data. This is important, as the prior information typically is a collection of possible regulatory interactions, of which only a subset might be relevant in a given dataset. Also, this implies robustness to erroneous interactions in the prior, which can have various sources, such as non-functional TF binding reported by ChIP-Seq. (ii) Using a structure prior must not limit the ability to learn the part of the network for which no prior information exists. (iii) The user must be able to control the weight given to the prior. This feature allows the user to tune the method based on the believed completeness and accuracy of the prior, while respecting the first two properties over a wide range of parameters. In this work, we introduce two methods for incorporating structure priors that possess all three criteria.</p><sec id="SEC1.1"><title>1.1 Prior work</title><p>A lot of effort has been put into learning GRNs from gene expression time-series data and prior knowledge. For recent reviews on the topic we refer to <xref ref-type="bibr" rid="btt099-B1">Bar-Joseph <italic>et al.</italic> (2012)</xref> and <xref ref-type="bibr" rid="btt099-B15">Hecker <italic>et al.</italic> (2009)</xref>.</p><p>Some of the first GRN inference methods allowed for the inclusion of additional data as structure priors (<xref ref-type="bibr" rid="btt099-B17">Imoto <italic>et al.</italic>, 2003</xref>; <xref ref-type="bibr" rid="btt099-B31">Tamada <italic>et al.</italic>, 2003</xref>). However, they allowed only for a very limited number of nodes in the network. <xref ref-type="bibr" rid="btt099-B32">Werhli and Husmeier (2007)</xref> and <xref ref-type="bibr" rid="btt099-B16">Husmeier and Werhli (2007)</xref> build on that work and express the available prior knowledge in terms of an energy function, from which a prior distribution over network structures is obtained. The complexity of these methods limits their application beyond small networks. More computational convenient methods use the static representation of known regulatory interactions to derive condition-specific topological changes in network structure (<xref ref-type="bibr" rid="btt099-B7">Ernst <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="btt099-B20">Luscombe <italic>et al.</italic>, 2004</xref>; <xref ref-type="bibr" rid="btt099-B26">Schulz <italic>et al.</italic>, 2012</xref>). Other methods combine expression data with prior knowledge to estimate transcription factor activities, which then allow to draw conclusions about the underlying network structure (<xref ref-type="bibr" rid="btt099-B9">Fu <italic>et al.</italic>, 2011</xref>; <xref ref-type="bibr" rid="btt099-B28">Seok <italic>et al.</italic>, 2009</xref>). Another method, similar to <monospace>MEN</monospace> proposed in this work, uses a network-constrained regularization procedure for linear models to incorporate prior information (<xref ref-type="bibr" rid="btt099-B19">Li and Li, 2008</xref>). However, in all these cases, it is not clear how sensitive these methods are to errors in the priors.</p><p>The need for benchmarking general methods for GRN inference using similar datasets and gold standard sets led to the organization of a field-wide test, the Dialogue for Reverse Engineering Assessments and Methods (DREAM) (<xref ref-type="bibr" rid="btt099-B23">Marbach <italic>et al.</italic>, 2012</xref>; <xref ref-type="bibr" rid="btt099-B25">Prill <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="btt099-B29">Stolovitzky <italic>et al.</italic>, 2007</xref>, <xref ref-type="bibr" rid="btt099-B30">2009</xref>). The competitions have shown that methods that incorporated multiple data types in a mutually reinforcing manner typically performed better. However, in DREAM, all information about the networks, including gene names, were obfuscated from the participants; thus, methods that use any sort of prior information could not be tested.</p></sec><sec id="SEC1.2"><title>1.2 Our approach</title><p>We extend the recently published Inferelator approach for GRN inference (<xref ref-type="bibr" rid="btt099-B2">Bonneau <italic>et al.</italic>, 2006</xref>, <xref ref-type="bibr" rid="btt099-B3">2007</xref>; <xref ref-type="bibr" rid="btt099-B12">Greenfield <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="btt099-B21">Madar <italic>et al.</italic>, 2010</xref>) to incorporate structure priors into the inference procedure. We retain the core Inferelator ordinary differential equation model and introduce two separate model selection approaches that can use structure priors. One involves a modification of the Elastic-Net model selection approach, and we refer to it as Modified Elastic Net (<monospace>MEN</monospace>). This method has been introduced previously (<xref ref-type="bibr" rid="btt099-B33">Yong-a poi <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="btt099-B36">Zou and Zhang, 2009</xref>), and here we incorporate it into the Inferelator, and rigorously evaluate its performance. Additionally, we developed a novel model selection approach, which uses a Bayesian regression framework with Zellner&#x02019;s g prior (<xref ref-type="bibr" rid="btt099-B34">Zellner, 1983</xref>) along with best subset selection for model selection. We refer to this method as Bayesian Best Subset Regression (<monospace>BBSR</monospace>).</p><p>We test <monospace>MEN&#x02019;s</monospace> and <monospace>BBSR&#x02019;s</monospace> ability to incorporate structure priors on three datasets: (i) the DREAM4 one-hundred node <italic>in silico</italic> challenge, (ii) the DREAM5 <italic>Escherichia coli</italic> dataset and (iii) a recently published <italic>Bacillus subtilis</italic> dataset (<xref ref-type="bibr" rid="btt099-B24">Nicolas <italic>et al.</italic>, 2012</xref>) (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt099/-/DC1">Supplementary Material</ext-link> for additional description). As suggested by the DREAM consortium (<xref ref-type="bibr" rid="btt099-B23">Marbach <italic>et al.</italic>, 2012</xref>; <xref ref-type="bibr" rid="btt099-B25">Prill <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="btt099-B29">Stolovitzky <italic>et al.</italic>, 2007</xref>, <xref ref-type="bibr" rid="btt099-B30">2009</xref>), we use area under the precision recall curve (AUPR) as the measure of performance. Importantly, for the <italic>E.</italic><italic>coli</italic> and <italic>B.</italic><italic>subtilis</italic> datasets, we evaluate performance only over the subset of genes and TFs that have at least one known interaction. We test the robustness of each method by supplying sets of structure priors that have incorrect prior information added. In doing so, we simulate the biologically relevant environment where literature- and experiment-derived priors will have incorrect and irrelevant information.</p></sec></sec><sec id="SEC2"><title>2 METHODS</title><p>We will first define our core model, a simple ordinary differential equation (ODE) model where transcription factors effect transcription rate, and where mRNA degradation rate is proportional to mRNA level. Following the description of our core model, we introduce two extensions, <monospace>MEN</monospace> and <monospace>BBSR</monospace>, to our prior method, the Inferelator, that enable the use of known regulatory edges to influence model selection.</p><sec id="SEC2.1"><title>2.1 Problem set-up</title><p>We define <inline-formula><inline-graphic xlink:href="btt099i2.jpg"/></inline-formula> to be the observed mRNA expression levels of <italic>N</italic> genes, as measured by microarray (or RNAseq). The datasets contain two distinct sets of experiments: (i) time-series (<italic>X<sup>ts</sup></italic>), and (ii) steady-state (<italic>X<sup>ss</sup></italic>). In a time-series experiment, mRNA expression is measured at consecutive time points after some stimulus. To simplify notation, and without loss of generality, we assume that <italic>X<sup>ts</sup></italic> is one such time series experiment, with <italic>K</italic> observations, <inline-formula><inline-graphic xlink:href="btt099i3.jpg"/></inline-formula> [i.e. <inline-formula><inline-graphic xlink:href="btt099i4.jpg"/></inline-formula>
<inline-formula><inline-graphic xlink:href="btt099i4a.jpg"/></inline-formula> are the columns of <italic>X<sup>ts</sup></italic>]. In a steady-state experiment, the mRNA expression is observed once, when the system has reached steady state. We consider all steady state experiments as <italic>X<sup>ss</sup></italic> with <italic>L</italic> observations, <inline-formula><inline-graphic xlink:href="btt099i5.jpg"/></inline-formula> [i.e. <inline-formula><inline-graphic xlink:href="btt099i6.jpg"/></inline-formula> are the columns of <italic>X<sup>ss</sup></italic>]. The method takes as input <italic>X<sup>ts</sup></italic> and <italic>X<sup>ss</sup></italic> and the output is a matrix <italic>S</italic>, where each entry <inline-formula><inline-graphic xlink:href="btt099i7.jpg"/></inline-formula> corresponds to the confidence that there exists a regulatory interaction between gene <italic>x<sub>j</sub></italic> and gene <italic>x<sub>i</sub></italic> (i.e. <inline-formula><inline-graphic xlink:href="btt099i8.jpg"/></inline-formula>). <italic>S</italic> can be thought of as a ranking of every possible regulatory interaction, where a higher value of <inline-formula><inline-graphic xlink:href="btt099i9.jpg"/></inline-formula> indicates a stronger confidence in <inline-formula><inline-graphic xlink:href="btt099i10.jpg"/></inline-formula>. A flowchart summarizing our approach is depicted in <xref ref-type="fig" rid="btt099-F1">Figure 1</xref>.
<fig id="btt099-F1" position="float"><label>Fig. 1.</label><caption><p>Method flow chart. Our method takes as input an expression dataset. To build a mechanistic model of gene expression, we create time-lagged response and design variables, such that the expression of the TF is time-lagged with respect to the expression of the target. We then resample the response and designing matrices, running model selection (using either <monospace>MEN</monospace> or <monospace>BBSR</monospace>) for each resample. This generates an ensemble of networks, which we rank combine into one final network</p></caption><graphic xlink:href="btt099f1p"/></fig></p></sec><sec id="SEC2.2"><title>2.2 Limiting the number of regulators for each gene</title><p>When we infer transcriptional regulatory networks, we consider only <italic>a-priori</italic> known (or predicted) transcription factors as potential regulators. We define <italic>P</italic> to be the set of indices of the regulators in <italic>x</italic>. For each gene <italic>i</italic>, we have a specific set of regulators <inline-formula><inline-graphic xlink:href="btt099i11.jpg"/></inline-formula>. The members of <italic>P<sub>i</sub></italic> are determined using tlCLR as in (<xref ref-type="bibr" rid="btt099-B12">Greenfield <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="btt099-B21">Madar <italic>et al.</italic>, 2010</xref>), and limited to the union of the 10 highest-scoring predictors and all predictors with prior knowledge. Note that we do not attempt to infer self-regulation in either method presented here, i.e. <inline-formula><inline-graphic xlink:href="btt099i12.jpg"/></inline-formula>.</p></sec><sec id="SEC2.3"><title>2.3 Core model</title><p>We assume that the time evolution of the <inline-formula><inline-graphic xlink:href="btt099i13.jpg"/></inline-formula> is governed by the following ODE
<disp-formula id="btt099-M1"><label>(1)</label><graphic xlink:href="btt099m1"/></disp-formula>
Where <inline-formula><inline-graphic xlink:href="btt099i14.jpg"/></inline-formula> is the first order degradation rate [estimated from literature (<xref ref-type="bibr" rid="btt099-B14">Hambraeus <italic>et al.</italic>, 2003</xref>; <xref ref-type="bibr" rid="btt099-B27">Selinger <italic>et al.</italic>, 2003</xref>)], &#x003b2; is a set of parameters to be estimated and <italic>P<sub>i</sub></italic> is the set of potential regulators for <italic>x<sub>i</sub></italic>. For clarity, we describe the model formulation only for a linear combination of regulators, and note that as in <xref ref-type="bibr" rid="btt099-B2">Bonneau <italic>et al.</italic> (2006)</xref>, this is easily extended to combinatorial interactions, and other non-linear functional forms. Recall that <italic>x<sub>i</sub></italic> contains both time-series and steady-state observations, which we describe separately.</p><p>In the case of time-series data, we proceed by applying the finite difference approximation to the left hand side of <xref ref-type="disp-formula" rid="btt099-M1">Equation (1)</xref>, isolating the unknown parameters &#x003b2; on the right hand side, and dividing both sides by <inline-formula><inline-graphic xlink:href="btt099i15.jpg"/></inline-formula>. We can now write <xref ref-type="disp-formula" rid="btt099-M1">Equation (1)</xref> as
<disp-formula id="btt099-M2"><label>(2)</label><graphic xlink:href="btt099m2"/></disp-formula>
Where <inline-formula><inline-graphic xlink:href="btt099i16.jpg"/></inline-formula> is related to the half-life <inline-formula><inline-graphic xlink:href="btt099i17.jpg"/></inline-formula> by <inline-formula><inline-graphic xlink:href="btt099i18.jpg"/></inline-formula>. Note that here the design variable <inline-formula><inline-graphic xlink:href="btt099i19.jpg"/></inline-formula> is time-lagged relative to the response variable <inline-formula><inline-graphic xlink:href="btt099i20.jpg"/></inline-formula> by one time point. This can easily be extended to consider a lag of multiple time points; however, multiple time-lags did not increase performance on the datasets tested here.</p><p>We summarize the left-hand side of the equation as <italic>y<sub>i</sub></italic>, which we refer to as the time-series response variable, and approximate it as a linear combination of the <italic>x<sub>j</sub></italic>&#x02019;s, which we refer to as the time-series predictor (i.e. design variable). Over the time series conditions:
<disp-formula id="btt099-M3"><label>(3)</label><graphic xlink:href="btt099m3"/></disp-formula>
</p><p>Note that the design and response variables are indexed only over the time-series conditions, and the design variables (<italic>x<sub>j</sub></italic>&#x02019;s) are time-lagged with respect to the response variable.</p><p>In the case of steady-state observations, <inline-formula><inline-graphic xlink:href="btt099i21.jpg"/></inline-formula>, and <xref ref-type="disp-formula" rid="btt099-M1">Equation (1)</xref> becomes
<disp-formula id="btt099-M4"><label>(4)</label><graphic xlink:href="btt099m4"/></disp-formula>
</p><p>The two sides of the equation correspond to the steady-state response and design variables. To construct the final response and design variables, we concatenate the response and design variables over time-series and steady-state observations. The final step before model selection is to normalize and scale the response and design variables such that they have zero mean and variance of 1.</p><p>There are many ways to solve <xref ref-type="disp-formula" rid="btt099-M3">Equation (3)</xref>, including regression. It was previously shown that sparse models of regulatory networks can accurately capture the topology and dynamics, and that using L1 shrinkage (and variations such as the Elastic-Net) can be used to enforce model parsimony (<xref ref-type="bibr" rid="btt099-B12">Greenfield <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="btt099-B13">Gustafsson and H&#x000f6;rnquist, 2010</xref>). Below, we describe <monospace>MEN</monospace> and <monospace>BBSR</monospace>, two different model selection procedures, both of which treat <italic>y</italic> as the response variables and the <italic>x</italic> as the predictor variables, learn parsimonious models, and have the ability to incorporate prior information.</p></sec><sec id="SEC2.4"><title>2.4 Modified elastic net</title><p><italic>Algorithm Overview</italic> Here we describe the <monospace>MEN</monospace> approach for estimating the parameters <inline-formula><inline-graphic xlink:href="btt099i22.jpg"/></inline-formula> in <xref ref-type="disp-formula" rid="btt099-M3">Equation (3)</xref>. We use <monospace>MEN</monospace> to both: (i) enforce a sparsity constraint on the parameters <inline-formula><inline-graphic xlink:href="btt099i23.jpg"/></inline-formula>, and (ii) incorporate prior knowledge of regulatory interactions <inline-formula><inline-graphic xlink:href="btt099i24.jpg"/></inline-formula>. This approach has been previously described, but has never been rigorously tested in the context of incorporating constraints into GRN inference. We begin by describing the application of the Elastic-Net to model selection in the context of the core model described in <xref ref-type="disp-formula" rid="btt099-M3">Equation 3</xref>.</p><p><italic>Elastic-Net regression</italic> The Elastic-Net (<xref ref-type="bibr" rid="btt099-B35">Zou and Hastie, 2005</xref>) finds a parsimonious solution to a regression problem [e.g. <xref ref-type="disp-formula" rid="btt099-M3">Equation (3)</xref>], and enforces sparsity through a penalty on the regression coefficients, which is a combination of the <italic>l</italic><sub>1</sub> lasso penalty, and the <italic>l</italic><sub>2</sub> ridge penalty. Let <italic>R</italic> be the total number of elements in response and design variable. We estimate the parameters <inline-formula><inline-graphic xlink:href="btt099i25.jpg"/></inline-formula> in <xref ref-type="disp-formula" rid="btt099-M3">Equation (3)</xref> by minimizing the following objective function (i.e. the sum of squares of the residuals).
<disp-formula id="btt099-M5"><label>(5)</label><graphic xlink:href="btt099m5"/></disp-formula>
under the elastic net penalty on regression coefficients,
<disp-formula id="btt099-M6"><label>(6)</label><graphic xlink:href="btt099m6"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="btt099i26.jpg"/></inline-formula> is the value of <inline-formula><inline-graphic xlink:href="btt099i27.jpg"/></inline-formula> determined by ordinary least squares regression. &#x003be; determines the balance between the lasso and ridge penalties, where <inline-formula><inline-graphic xlink:href="btt099i28.jpg"/></inline-formula> amounts to lasso regression, and <inline-formula><inline-graphic xlink:href="btt099i29.jpg"/></inline-formula> amounts to ridge regression. In practice, &#x003be; is a vector, for each value of which we use 10-fold CV to pick <italic>s<sub>i</sub></italic>. The final model for <italic>y<sub>i</sub></italic> is determined by the value &#x003be; and <italic>s<sub>i</sub></italic>, which minimize the prediction error. This approach amounts to a grid search of the parameter space as described in <xref ref-type="bibr" rid="btt099-B35">Zou and Hastie (2005)</xref>.</p><p><italic>Modified Elastic Net</italic> To incorporate prior information directly into the model selection approach, we minimize <xref ref-type="disp-formula" rid="btt099-M5">Equation (5)</xref> subject to a new penalty function, closely related to <xref ref-type="disp-formula" rid="btt099-M6">Equation (6)</xref>
<disp-formula id="btt099-M7"><label>(7)</label><graphic xlink:href="btt099m7"/></disp-formula>
Where <inline-formula><inline-graphic xlink:href="btt099i30.jpg"/></inline-formula> is a modifier on the shrinkage incurred on each parameter. If there is prior belief for a regulatory interaction <inline-formula><inline-graphic xlink:href="btt099i31.jpg"/></inline-formula>, then <inline-formula><inline-graphic xlink:href="btt099i32.jpg"/></inline-formula> corresponds to less shrinkage being incurred on the corresponding <inline-formula><inline-graphic xlink:href="btt099i33.jpg"/></inline-formula>, hence making it more likely that this parameter is not shrunk out of the model. Note that only the degree of shrinkage of a parameter is modified, not the correlation between a target, TF pair, nor the order in which predictors are selected by the model. In cases where multiple predictors are correlated (a common occurrence in biology), <inline-formula><inline-graphic xlink:href="btt099i34.jpg"/></inline-formula> will cause predictors with no prior information to be shrunk from the model before predictors with prior information. Note that the <inline-formula><inline-graphic xlink:href="btt099i35.jpg"/></inline-formula> modifies only the <italic>l</italic><sub>1</sub> norm, as in <xref ref-type="bibr" rid="btt099-B36">Zou and Zhang (2009)</xref>. This implementation is based on the elasticnet R package (<xref ref-type="bibr" rid="btt099-B36">Zou and Zhang, 2009</xref>).</p></sec><sec id="SEC2.5"><title>2.5 Bayesian best subset regression</title><p>We now describe the <monospace>BBSR</monospace> method, an alternative inference method that computes all possible regression models for a given gene corresponding to the inclusion and exclusion of each predictor. Prior knowledge is incorporated by using informative priors for the regression parameters, and sparsity is enforced by a model selection step based on the Bayesian Information Criterion (BIC).</p><p><italic>Bayesian Regression With Informative Prior</italic> Here we introduce the linear regression we use during the model building step of the algorithm. We assume the prediction error
<disp-formula id="btt099-M8"><label>(8)</label><graphic xlink:href="btt099m8"/></disp-formula>
to be independent and identically distributed with mean 0 and variance <inline-formula><inline-graphic xlink:href="btt099i36.jpg"/></inline-formula>. The response variable of gene <italic>i</italic> is denoted as <italic>y<sub>i</sub></italic>, the design variables of TFs as <italic>X</italic> and the regression solution as <inline-formula><inline-graphic xlink:href="btt099i37.jpg"/></inline-formula>. For clarity, we will omit the index <italic>i</italic> for the remainder of this section. We assume that the target gene response is distributed according to a multivariate normal
<disp-formula id="btt099-M9"><label>(9)</label><graphic xlink:href="btt099m9"/></disp-formula>
with the predicted response as mean, and a variance co-variance matrix that has the error variance <inline-formula><inline-graphic xlink:href="btt099i38.jpg"/></inline-formula> on its diagonal and is 0 otherwise. In this formulation, <italic>n</italic> is the number of observations (experiments). This can be solved by a Bayesian regression where we can incorporate existing knowledge by tuning the prior on &#x003b2;.</p><p>We use a modification of Zellner&#x02019;s <italic>g</italic> Prior (<xref ref-type="bibr" rid="btt099-B34">Zellner, 1983</xref>) to include subjective information in our Bayesian regression problem. In the original formulation, the prior distribution of &#x003b2; has the following form
<disp-formula id="btt099-M10"><label>(10)</label><graphic xlink:href="btt099m10"/></disp-formula>
i.e. a distribution proportional to a multivariate normal with an initial guess <inline-formula><inline-graphic xlink:href="btt099i39.jpg"/></inline-formula> as mean and a data-dependent covariance matrix that is scaled by a user chosen factor of <inline-formula><inline-graphic xlink:href="btt099i40.jpg"/></inline-formula>. The prior distribution of <inline-formula><inline-graphic xlink:href="btt099i41.jpg"/></inline-formula> is the same as is typically used with the non-informative prior, <inline-formula><inline-graphic xlink:href="btt099i42.jpg"/></inline-formula>. The choice of a large value for <italic>g</italic> will lead to results centred around the ordinary least squares solution, and the error variance will be the lowest. Values of <italic>g</italic> close to 0 on the other hand will lead to solutions that are centred around <inline-formula><inline-graphic xlink:href="btt099i43.jpg"/></inline-formula> with higher error variance.</p><p>The joint posterior distribution has the functional form
<disp-formula id="btt099-M11"><label>(11)</label><graphic xlink:href="btt099m11"/></disp-formula>
and the marginal posterior distributions are
<disp-formula id="btt099-M12"><label>(12)</label><graphic xlink:href="btt099m12"/></disp-formula>
<disp-formula id="btt099-M13"><label>(13)</label><graphic xlink:href="btt099m13"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="btt099i44.jpg"/></inline-formula> is the Inverse Gamma distribution with shape and scale parameter, and <italic>SSR</italic> is the sum of squares of the residuals of the ordinary least squares solution <inline-formula><inline-graphic xlink:href="btt099i45.jpg"/></inline-formula>.</p><p>With this set-up, we can propose a prior guess <inline-formula><inline-graphic xlink:href="btt099i46.jpg"/></inline-formula> of the vector of regression coefficients, and encode our belief in this guess with <italic>g</italic>. To allow for different levels of confidence in the different elements of <inline-formula><inline-graphic xlink:href="btt099i47.jpg"/></inline-formula>, we extend the original formulation of the <italic>g</italic> prior to use a vector <inline-formula><inline-graphic xlink:href="btt099i48.jpg"/></inline-formula> with one entry per predictor. The scale parameter of the Inverse Gamma distribution of the marginal posterior distribution of <inline-formula><inline-graphic xlink:href="btt099i49.jpg"/></inline-formula> then becomes
<disp-formula id="btt099-M14"><label>(14)</label><graphic xlink:href="btt099m14"/></disp-formula>
where <italic>G</italic> is a square diagonal matrix whose diagonal entries starting in the upper left corner are <inline-formula><inline-graphic xlink:href="btt099i50.jpg"/></inline-formula> and all remaining entries are 0.</p><p>In practice, we choose <inline-formula><inline-graphic xlink:href="btt099i51.jpg"/></inline-formula> to be a vector with all entries having the value 0. This reflects our prior belief that the regulatory network is generally quite sparse. We set the vector <inline-formula><inline-graphic xlink:href="btt099i52.jpg"/></inline-formula> to values of <italic>g</italic> for those predictors that we have additional knowledge for and believe that they regulate gene <italic>i</italic>, and to <inline-formula><inline-graphic xlink:href="btt099i53.jpg"/></inline-formula> for the other predictors. A value of <inline-formula><inline-graphic xlink:href="btt099i54.jpg"/></inline-formula> treats all predictors equally and we refer to it as &#x02018;no priors&#x02019;, whereas <inline-formula><inline-graphic xlink:href="btt099i55.jpg"/></inline-formula> allows the predictors with priors to explain for more of the variance of the response.</p><p><italic>Model Selection</italic> We use the BIC to select the final model from the <inline-formula><inline-graphic xlink:href="btt099i56.jpg"/></inline-formula> possible regression models for a gene <italic>i</italic>. For a given model <italic>m</italic>, the BIC is defined as
<disp-formula id="btt099-M15"><label>(15)</label><graphic xlink:href="btt099m15"/></disp-formula>
where <italic>n</italic> is the number of observations and <italic>k</italic> the number of predictors. To be more robust, we avoid using a point estimator for <inline-formula><inline-graphic xlink:href="btt099i57.jpg"/></inline-formula> directly, but use the expected value of <inline-formula><inline-graphic xlink:href="btt099i58.jpg"/></inline-formula> based on the posterior distribution of <inline-formula><inline-graphic xlink:href="btt099i59.jpg"/></inline-formula>
<disp-formula id="btt099-M16"><label>(16)</label><graphic xlink:href="btt099m16"/></disp-formula>
<disp-formula id="btt099-M17"><label>(17)</label><graphic xlink:href="btt099m17"/></disp-formula>
where <italic>shape</italic> and <italic>scale</italic> parameterize the marginal posterior distribution of <inline-formula><inline-graphic xlink:href="btt099i60.jpg"/></inline-formula> as in <xref ref-type="disp-formula" rid="btt099-M14">Equation 14</xref>. As a final step, the predictors of the model with the lowest <inline-formula><inline-graphic xlink:href="btt099i61.jpg"/></inline-formula> are selected as the TFs regulating gene <italic>i</italic>. If <italic>p</italic> is large (<inline-formula><inline-graphic xlink:href="btt099i62.jpg"/></inline-formula>), we use an initial filtration step to discover the 10 most promising predictors (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt099/-/DC1">Supplementary Material</ext-link> for details).</p></sec><sec id="SEC2.6"><title>2.6 Ranking interactions and bootstrapping</title><p>After model selection is carried out by either <monospace>MEN</monospace> or <monospace>BBSR</monospace>, the output is a matrix of dynamical parameters <inline-formula><inline-graphic xlink:href="btt099i63.jpg"/></inline-formula>, where each <inline-formula><inline-graphic xlink:href="btt099i64.jpg"/></inline-formula> corresponds to the direction (i.e. activation or repression) and strength (i.e. magnitude) of a regulatory interaction. These parameters can be used to predict the response of the system to new perturbations. If the goal is to rank regulatory interactions based on a confidence measure, simply ranking by <inline-formula><inline-graphic xlink:href="btt099i65.jpg"/></inline-formula> is not the best scheme, as this does not take into account the overall performance of the model for <italic>y<sub>i</sub></italic>. As a result we re-rank interactions, taking into account the relative performance of each model, and the proportion of variance explained by each <inline-formula><inline-graphic xlink:href="btt099i66.jpg"/></inline-formula>. The result is a matrix <italic>S</italic> where the final confidence score for <inline-formula><inline-graphic xlink:href="btt099i67.jpg"/></inline-formula> is given by
<disp-formula id="btt099-M18"><label>(18)</label><graphic xlink:href="btt099m18"/></disp-formula>
</p><p>To further improve inference and become more robust against over-fitting and sampling errors, we use a bootstrapping strategy. We resample the input conditions with replacement and run model selection on the new dataset. This procedure is repeated 20 times, and the resulting lists of interactions (<italic>S</italic> matrices) are rank combined to a final ranked list as in <xref ref-type="bibr" rid="btt099-B22">Marbach <italic>et al.</italic> (2010)</xref>.</p></sec></sec><sec id="SEC3"><title>3 RESULTS</title><p>We have conducted systematic thorough testing of the ability of both <monospace>MEN</monospace> and <monospace>BBSR</monospace> to accurately reconstruct GRNs using prior information in biologically relevant settings. We tested both methods with respect to the number and accuracy of prior known interactions (PKIs), and the effect of the weight of the PKIs. Performance is validated against the set of gold standard interactions (GSIs).</p><sec id="SEC3.1"><title>3.1 Effect of varying weight on priors</title><p>We assessed how sensitive our performance is to the choice of the weight parameter (&#x003b8; for <monospace>MEN</monospace> and <italic>g</italic> for <monospace>BBSR</monospace>). For this initial investigation of parameter sensitivity, we used the entire gold standard as input (the set of PKIs covers all GSIs), and assessed performance over the set of GSIs. Though this design is circular, the purpose was to characterize the sensitivity of our method to the choice of &#x003b8; and <italic>g</italic>, the parameters that control the relative influence of the structure prior for <monospace>MEN</monospace> and <monospace>BBSR</monospace> respectively (see Section 2). In <xref ref-type="fig" rid="btt099-F2">Figure 2</xref>, we see the performance of each method (in terms of AUPR) as a function of the weight parameter. As the value of &#x003b8; is decreased, the performance of <monospace>MEN</monospace> increases to a certain point, followed by a decrease in performance for all datasets (<xref ref-type="fig" rid="btt099-F2">Fig. 2</xref>, right panel). This is true for all tested datasets, and it seems that <monospace>MEN</monospace> has a &#x02018;sweet-spot&#x02019;around <inline-formula><inline-graphic xlink:href="btt099i68.jpg"/></inline-formula>, which results in best performance for all tested datasets. On the other hand, <monospace>BBSR</monospace> has a predictable behaviour for all tested datasets: performance increases for increasingly large values of <italic>g</italic>, limiting to an AUPR of 1 as <italic>g</italic> approaches infinity. This trend holds true for all datasets (left panel of <xref ref-type="fig" rid="btt099-F2">Fig. 2</xref>).
<fig id="btt099-F2" position="float"><label>Fig. 2.</label><caption><p>Effect of weight parameter on performance. We use all GSIs as the set of PKIs, and evaluate performance (in terms of AUPR) against the set of GSIs. We evaluate this performance for a variety of choices of the weight parameter for both methods</p></caption><graphic xlink:href="btt099f2p"/></fig></p></sec><sec id="SEC3.2"><title>3.2 Incorporation of prior interactions is data driven</title><p>We next investigated which of the known edges were included in the resulting network models. We used all GSIs as PKIs and selected a prior weight of <inline-formula><inline-graphic xlink:href="btt099i69.jpg"/></inline-formula> for all datasets for MEN, and values for <italic>g</italic> that resulted in similar AUPRs for BBSR (<inline-formula><inline-graphic xlink:href="btt099i70.jpg"/></inline-formula>, 2.2 and 1.6 for Dream4, <italic>E.coli</italic> and <italic>B.subtilis</italic>, respectively). We split the predicted interactions in two sets, high-ranked (recall <inline-formula><inline-graphic xlink:href="btt099i71.jpg"/></inline-formula>) and low-ranked (recall <inline-formula><inline-graphic xlink:href="btt099i72.jpg"/></inline-formula> AND in set of PKIs), and compared the two sets with regard to the signal in the data. Signal for an interaction (TF-target pair) is defined as the time-lagged correlation for that pair. We chose this metric, as we use the time-lagged response and design matrices for model building (see Section 2).</p><p>For both methods and all datasets, we can see that high-ranked interactions have more signal (fewer near-zero correlations) than low-ranked interactions (densities peaked around zero), see <xref ref-type="fig" rid="btt099-F3">Figure 3</xref>. However, for smaller values of &#x003b8;, this trend is less pronounced for MEN, where more high-ranked interactions show time-lagged correlation of 0 (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt099/-/DC1">Supplementary Material</ext-link>).
<fig id="btt099-F3" position="float"><label>Fig. 3.</label><caption><p>Incorporation of prior interactions is data driven. For all three datasets, we used all GSIs as PKIs. Here, we display the distribution of time-lagged correlation of predicted TF-target pairs at a recall level of <inline-formula><inline-graphic xlink:href="btt099i73.jpg"/></inline-formula> (higher ranked, blue), and low ranked interactions that are in the gold standard (lower ranked, red). Note that high ranked interactions are less likely to have low absolute time-lagged correlation, and the low ranked GSIs are centred around 0</p></caption><graphic xlink:href="btt099f3p"/></fig></p></sec><sec id="SEC3.3"><title>3.3 Performance on the leave-out set: using constraints does not damage our ability to learn new interactions</title><p>Here we assess if knowing part of the true regulatory network limits our ability to learn new regulatory interactions. We define the leave-out set as the set of GSIs that are not input as PKIs into our methods. For this experiment, we sampled PKI sets randomly resulting in subsets that consisted of 20, 40, 60 and 80% of the GSIs for each of the three datasets (we carried out five repetitions of this random sampling). We used the same weight parameters as in the previous section. AUPR of the leave-out set was computed when using PKIs and compared with the performance when no PKIs were used (<xref ref-type="fig" rid="btt099-F4">Fig. 4</xref>). We observe similar trends for the six dataset&#x02013;method combinations. Neither one method shows a consistent trend, and using prior information does not significantly help or damage performance on the leave-out set. However, very high weights for <monospace>BBSR</monospace> lead to a detectable performance decrease, whereas <monospace>MEN</monospace> is less affected by the prior weight (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt099/-/DC1">Supplementary Material</ext-link>). Overall, performance on the leave-out set changes only slightly when priors are used.
<fig id="btt099-F4" position="float"><label>Fig. 4.</label><caption><p>Performance change on the leave-out set. PKIs were sampled randomly from 20%, 40%, 60% and 80% of the GSIs in five repetitions. We define the leave-out set as the set of GSIs that are not PKIs. Here, we compare the AUPR of the leave-out set when using PKIs (<italic>y</italic>-axis) to the AUPR when not using PKIs (<italic>x</italic>-axis). Points above the line indicate a performance increase when PKIs are used</p></caption><graphic xlink:href="btt099f4p"/></fig></p><p>In line with these observations, we can observe that overall performance increases linearly as the fraction of GSIs that is given as PKIs increases (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt099/-/DC1">Supplementary Material</ext-link>). This trend is true for all three datasets and both methods.</p></sec><sec id="SEC3.4"><title>3.4 Robustness to false prior information</title><p>As sources of biological prior knowledge (e.g. literature-derived regulatory relationships, protein&#x02013;protein interactions, ChIP-seq-detected binding events) are expected to have large numbers of incorrect (false prior) interactions, or interactions not relevant in a given dataset, it is important that methods for incorporating prior knowledge are robust to these cases. To test the robustness of <monospace>MEN</monospace> and <monospace>BBSR</monospace> to incorrect prior information, for each network, we considered half of the GSIs as true prior interactions (TPIs), and added a varying number of random false prior interactions (FPIs). We evaluated performance on the complete set of GSIs, and used as PKIs sets of interactions that have TPI:FPI ratios of 1:0, 1:2, 1:5, 1:10. A choice of 1:10 TPI:FPI for the <italic>E.coli</italic> dataset, for example, results in a set of PKIs that contains 1033 true interactions that are GSIs, and 10 330 false interactions which are not GSIs. FPIs were drawn randomly in five repetitions, and results showed a consistently low variance, so only mean values are presented here. We tested the performance of both <monospace>MEN</monospace> and <monospace>BBSR</monospace> on these PKI sets with increasing error for two choices of the respective weight parameters as follows. Low weights: &#x003b8; for <monospace>MEN</monospace> is 0.5 for all datasets, and <italic>g</italic> for <monospace>BBSR</monospace> is 1.26, 2.2, 1.6 for Dream4, <italic>E.</italic><italic>coli</italic>, <italic>B.</italic><italic>subtilis</italic>. High weights: &#x003b8; is 0.01 for all datasets, and <italic>g</italic> is 2.8, 13, 10. To compare our results with other methods, we used the web platform GenePattern (<ext-link ext-link-type="uri" xlink:href="http://dream.broadinstitute.org/">http://dream.broadinstitute.org/</ext-link>) and ran CLR, GENIE3 and TIGRESS on our data with default parameters. Additionally, we computed the AUPR of a simple interaction ranking method which places all PKIs at the top of the list. In general, high weight parameters make the methods more susceptible to noise, but for the two large datasets, <italic>E.coli</italic> and <italic>B.</italic><italic>subtilis</italic>, performance throughout all noise levels is still better than any method without PKIs. For low weight parameters, and the Dream4 and <italic>B.</italic><italic>subtilis</italic> datasets, <monospace>BBSR</monospace> is less susceptible to noise, and results in higher AUPRs than <monospace>MEN</monospace> (<xref ref-type="fig" rid="btt099-F5">Fig. 5</xref>). For all three datasets, performance of both methods is always higher than the naive ranking scheme when false priors are present.
<fig id="btt099-F5" position="float"><label>Fig. 5.</label><caption><p>Robustness to incorrect prior information. For each dataset, we considered half of the GSIs as TPIs, and added varying numbers of FPIs that were not GSIs. We show the AUPR of both methods for multiple choices of the respective weight parameters, as well as methods that do not use any PKIs (horizontal lines). Additionally, we show the performance of a naive interaction ranking method, which places all PKIs at the top of the list (gray bars)</p></caption><graphic xlink:href="btt099f5p"/></fig></p></sec></sec><sec id="SEC4"><title>4 DISCUSSION</title><p>We developed two methods for incorporating prior knowledge into GRN inference. Both methods use the same underlying ODE model of regulation (see Section 2), but use different model selection approaches. MEN uses an adaptive weight on the penalty function to incorporate prior knowledge. BBSR uses the Bayesian formulation of linear regression, together with Zellner&#x02019;s g-prior to incorporate prior information, and best subset regression with the BIC for sparse model selection.</p><p>A key difference between <monospace>MEN</monospace> and <monospace>BBSR</monospace> is how the choice of weight (how much influence to give to the prior) effects performance. Results presented in <xref ref-type="fig" rid="btt099-F2">Figure 2</xref> show that for <monospace>BBSR</monospace> higher values of <italic>g</italic> result in overall higher confidence in PKIs, and reduced confidence in all unknown interactions. As such, <italic>g</italic> can be interpreted as a confidence measure in the accuracy and completeness of PKIs, and be chosen accordingly. It is also possible to introduce multiple sources of prior information, each with a different weight (value of <italic>g</italic>). For MEN, the prior weight parameter &#x003b8; exhibits a less predictable behaviour. Lower values of &#x003b8; generally lead to higher confidence in PKIs. However, for all datasets, we observed a performance peak around <inline-formula><inline-graphic xlink:href="btt099i74.jpg"/></inline-formula>. This non-linear property could be the result of cross-validation model selection procedure.</p><p>We tested the performance of both methods on different subsets of the GSIs. We see that increasing the number of PKIs increases performance in a linear manner for all datasets and both methods (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt099/-/DC1">Supplementary Fig. S2</ext-link>). This is in concordance with the results on the leave-out set (the set of GSIs that are not PKIs), where both methods showed only minor performance change in the presence of PKIs, regardless of dataset or number of PKIs used (<xref ref-type="fig" rid="btt099-F4">Fig. 4</xref>).</p><p>Finally, and most importantly for application to biological systems where only incomplete and noisy sets of PKIs are available, we assessed the robustness of both methods to FPIs. Both methods are robust to FPIs, and outperform the naive ranking scheme, which assigns high confidence to all PKIs (<xref ref-type="fig" rid="btt099-F5">Fig. 5</xref>). More specifically, for both large real datasets (<italic>E.</italic><italic>coli</italic> and <italic>B.</italic><italic>subtilis</italic>), both methods perform better than various baselines (no PKIs), with up to 10 FPIs for each true prior interaction. This means that both methods, given sufficient genomic data, are able to act as filters to distinguish between true and false prior interactions. However, <monospace>BBSR</monospace> is slightly more robust to the presence of FPIs.</p><p>A key consideration for any practical application of network inference methods with prior information is the trade-off between recapitulating the prior, and discovering novel biology. Intuitively, as the degree of belief in the prior is increased (by increasing the weight of the prior information), more of the interactions in the prior will be ranked highly by the inference method. Thus, high weights can lead to the incorporation of false interactions in the case of inaccurate PKIs (<monospace>MEN</monospace> more prone than <monospace>BBSR</monospace>), and impair performance on the leave-out set (as seen in <monospace>BBSR</monospace>). We suggest to the reader to set the weight parameter for incorporating prior knowledge based on the expected completeness and accuracy of the PKIs, and, when in doubt, to choose a low weight.</p></sec><sec id="SEC5"><title>5 CONCLUSION</title><p>In this work, we have presented two methods for incorporating additional knowledge to constrain GRN inference by adding priors on the network structure. In the analysis of the methods, we focused on parameter choice and robustness to false priors, and show that both methods are remarkably tolerant to error in the priors. The inclusion of prior knowledge significantly improves the quality of inferred networks without damaging our ability to learn new interactions. Of our two methods, the <monospace>BBSR</monospace> inferred more accurate networks than the <monospace>MEN</monospace> in the presence of noise in the set of network priors used, and provides an intuitive weight parameter to control the strength of priors. This makes <monospace>BBSR</monospace> an appropriate method for integrating potentially noisy complementary data such as ChIP-Chip, ChIP-Seq, protein&#x02013;protein interactions, literature-derived regulatory interactions and regulatory hypothesis derived from DNA-binding motifs into a data-driven regulatory network inference process.</p></sec>
<sec sec-type="supplementary-material">
<title>Supplementary Material</title>
<supplementary-material id="PMC_1" content-type="local-data">
<caption>
<title>Supplementary Data</title>
</caption>
<media mimetype="text" mime-subtype="html" xlink:href="supp_29_8_1060__index.html"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_btt099_priorsPaperSup.pdf"/>
</supplementary-material>
</sec>
</body><back><ack><title>ACKNOWLEDGEMENTS</title><p>We thank Karl Ward for effective and innovative system administration. We thank Patrick Eichenberger, Ashley Rose Bate, Aviv Madar and Dennis Shasha for helpful discussions.</p><p><italic>Funding:</italic>
<funding-source>NIH</funding-source> grants (<award-id>RC1 AI087266</award-id>, <award-id>RC4 AI092765</award-id>, <award-id>PN2 EY016586</award-id>, <award-id>IU54CA143907-01</award-id>, <award-id>EY016586-06</award-id>).</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="btt099-B1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bar-Joseph</surname><given-names>Z</given-names></name><etal/></person-group><article-title>Studying and modelling dynamic biological processes using time-series gene expression data</article-title><source>Nat. Rev. Genet.</source><year>2012</year><volume>13</volume><fpage>552</fpage><lpage>564</lpage><pub-id pub-id-type="pmid">22805708</pub-id></element-citation></ref><ref id="btt099-B2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonneau</surname><given-names>R</given-names></name><etal/></person-group><article-title>The Inferelator: an algorithm for learning parsimonious regulatory networks from systems-biology data sets <italic>de novo</italic></article-title><source>Genome Biol.</source><year>2006</year><volume>7</volume><fpage>R36</fpage><pub-id pub-id-type="pmid">16686963</pub-id></element-citation></ref><ref id="btt099-B3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bonneau</surname><given-names>R</given-names></name><etal/></person-group><article-title>A predictive model for transcriptional control of physiology in a free living cell</article-title><source>Cell</source><year>2007</year><volume>131</volume><fpage>1354</fpage><lpage>1365</lpage><pub-id pub-id-type="pmid">18160043</pub-id></element-citation></ref><ref id="btt099-B4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carro</surname><given-names>MS</given-names></name><etal/></person-group><article-title>The transcriptional network for mesenchymal transformation of brain tumours</article-title><source>Nature</source><year>2010</year><volume>463</volume><fpage>318</fpage><lpage>325</lpage><pub-id pub-id-type="pmid">20032975</pub-id></element-citation></ref><ref id="btt099-B5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ciofani</surname><given-names>M</given-names></name><etal/></person-group><article-title>A validated regulatory network for Th17 cell specification</article-title><source>Cell</source><year>2012</year><volume>151</volume><fpage>289</fpage><lpage>303</lpage><pub-id pub-id-type="pmid">23021777</pub-id></element-citation></ref><ref id="btt099-B6"><element-citation publication-type="journal"><collab>ENCODE Project Consortium</collab><article-title>An integrated encyclopedia of DNA elements in the human genome</article-title><source>Nature</source><year>2012</year><volume>489</volume><fpage>57</fpage><lpage>74</lpage><pub-id pub-id-type="pmid">22955616</pub-id></element-citation></ref><ref id="btt099-B7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ernst</surname><given-names>J</given-names></name><etal/></person-group><article-title>A semi-supervised method for predicting transcription factor-gene interactions in <italic>Escherichia coli</italic></article-title><source>PLoS Comput. Biol.</source><year>2008</year><volume>4</volume><fpage>e1000044</fpage><pub-id pub-id-type="pmid">18369434</pub-id></element-citation></ref><ref id="btt099-B8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Florez</surname><given-names>LA</given-names></name><etal/></person-group><article-title>A community-curated consensual annotation that is continuously updated: the <italic>Bacillus Subtilis</italic> centred wiki subtiwiki</article-title><source>Database</source><year>2009</year><volume>2009</volume><fpage>bap012</fpage><pub-id pub-id-type="pmid">20157485</pub-id></element-citation></ref><ref id="btt099-B9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Reconstructing genome-wide regulatory network of <italic>E. coli</italic> using transcriptome data and predicted transcription factor activities</article-title><source>BMC Bioinformatics</source><year>2011</year><volume>12</volume><fpage>233</fpage><pub-id pub-id-type="pmid">21668997</pub-id></element-citation></ref><ref id="btt099-B10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gallo</surname><given-names>SM</given-names></name><etal/></person-group><article-title>Redfly v3.0: toward a comprehensive database of transcriptional regulatory elements in <italic>Drosophila</italic></article-title><source>Nucleic Acids Res.</source><year>2010</year><volume>39</volume><fpage>D118</fpage><lpage>D123</lpage><pub-id pub-id-type="pmid">20965965</pub-id></element-citation></ref><ref id="btt099-B11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gama-Castro</surname><given-names>S</given-names></name><etal/></person-group><article-title>Regulondb version 7.0: transcriptional regulation of <italic>Escherichia Coli</italic> k-12 integrated within genetic sensory response units (gensor units)</article-title><source>Nucleic Acids Res.</source><year>2011</year><volume>39</volume><fpage>D98</fpage><lpage>D105</lpage><pub-id pub-id-type="pmid">21051347</pub-id></element-citation></ref><ref id="btt099-B12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenfield</surname><given-names>A</given-names></name><etal/></person-group><article-title>Dream4: combining genetic and dynamic information to identify biological networks and dynamical models</article-title><source>PLoS One</source><year>2010</year><volume>5</volume><fpage>e13397</fpage><pub-id pub-id-type="pmid">21049040</pub-id></element-citation></ref><ref id="btt099-B13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gustafsson</surname><given-names>M</given-names></name><name><surname>H&#x000f6;rnquist</surname><given-names>M</given-names></name></person-group><article-title>Gene expression prediction by soft integration and the elastic netbest performance of the dream3 gene expression challenge</article-title><source>PLoS One</source><year>2010</year><volume>5</volume><fpage>e9134</fpage><pub-id pub-id-type="pmid">20169069</pub-id></element-citation></ref><ref id="btt099-B14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hambraeus</surname><given-names>G</given-names></name><etal/></person-group><article-title>Genome-wide survey of mRNA half-lives in <italic>Bacillus Subtilis</italic> identifies extremely stable mRNAs</article-title><source>Mol. Genet. Genomics</source><year>2003</year><volume>269</volume><fpage>706</fpage><lpage>714</lpage><pub-id pub-id-type="pmid">12884008</pub-id></element-citation></ref><ref id="btt099-B15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hecker</surname><given-names>M</given-names></name><etal/></person-group><article-title>Gene regulatory network inference: data integration in dynamic models-a review</article-title><source>Biosystems</source><year>2009</year><volume>96</volume><fpage>86</fpage><lpage>103</lpage><pub-id pub-id-type="pmid">19150482</pub-id></element-citation></ref><ref id="btt099-B16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Husmeier</surname><given-names>D</given-names></name><name><surname>Werhli</surname><given-names>AV</given-names></name></person-group><article-title>Bayesian integration of biological prior knowledge into the reconstruction of gene regulatory networks with Bayesian networks</article-title><source>Comput. Syst. Bioinformatics Conf.</source><year>2007</year><volume>6</volume><fpage>85</fpage><lpage>95</lpage><pub-id pub-id-type="pmid">17951815</pub-id></element-citation></ref><ref id="btt099-B17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Imoto</surname><given-names>S</given-names></name><etal/></person-group><article-title>Combining microarrays and biological knowledge for estimating gene networks via Bayesian networks</article-title><source>Proc. IEEE Comput. Soc. Bioinform. Conf.</source><year>2003</year><volume>2</volume><fpage>104</fpage><lpage>13</lpage><pub-id pub-id-type="pmid">16452784</pub-id></element-citation></ref><ref id="btt099-B18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lammers</surname><given-names>CR</given-names></name><etal/></person-group><article-title>Connecting parts with processes: Subtiwiki and Subtipathways integrate gene and pathway annotation for <italic>Bacillus subtilis</italic></article-title><source>Microbiology</source><year>2010</year><volume>156</volume><fpage>849</fpage><lpage>859</lpage><pub-id pub-id-type="pmid">19959575</pub-id></element-citation></ref><ref id="btt099-B19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>C</given-names></name><name><surname>Li</surname><given-names>H</given-names></name></person-group><article-title>Network-constrained regularization and variable selection for analysis of genomic data</article-title><source>Bioinformatics</source><year>2008</year><volume>24</volume><fpage>1175</fpage><lpage>1182</lpage><pub-id pub-id-type="pmid">18310618</pub-id></element-citation></ref><ref id="btt099-B20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luscombe</surname><given-names>NM</given-names></name><etal/></person-group><article-title>Genomic analysis of regulatory network dynamics reveals large topological changes</article-title><source>Nature</source><year>2004</year><volume>431</volume><fpage>308</fpage><lpage>312</lpage><pub-id pub-id-type="pmid">15372033</pub-id></element-citation></ref><ref id="btt099-B21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Madar</surname><given-names>A</given-names></name><etal/></person-group><article-title>DREAM3: network inference using dynamic context likelihood of relatedness and the inferelator</article-title><source>PloS One</source><year>2010</year><volume>5</volume><fpage>e9803</fpage><pub-id pub-id-type="pmid">20339551</pub-id></element-citation></ref><ref id="btt099-B22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marbach</surname><given-names>D</given-names></name><etal/></person-group><article-title>Revealing strengths and weaknesses of methods for gene network inference</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2010</year><volume>107</volume><fpage>6286</fpage><lpage>6291</lpage><pub-id pub-id-type="pmid">20308593</pub-id></element-citation></ref><ref id="btt099-B23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marbach</surname><given-names>D</given-names></name><etal/></person-group><article-title>Wisdom of crowds for robust gene network inference</article-title><source>Nat. Methods</source><year>2012</year><volume>9</volume><fpage>796</fpage><lpage>804</lpage><pub-id pub-id-type="pmid">22796662</pub-id></element-citation></ref><ref id="btt099-B24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nicolas</surname><given-names>P</given-names></name><etal/></person-group><article-title>Condition-dependent transcriptome reveals high-level regulatory architecture in <italic>Bacillus subtilis</italic></article-title><source>Science</source><year>2012</year><volume>335</volume><fpage>1103</fpage><lpage>1106</lpage><pub-id pub-id-type="pmid">22383849</pub-id></element-citation></ref><ref id="btt099-B25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Prill</surname><given-names>RJ</given-names></name><etal/></person-group><article-title>Towards a rigorous assessment of systems biology models: the DREAM3 challenges</article-title><source>PLoS ONE</source><year>2010</year><volume>5</volume><fpage>e9202</fpage><pub-id pub-id-type="pmid">20186320</pub-id></element-citation></ref><ref id="btt099-B26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulz</surname><given-names>MH</given-names></name><etal/></person-group><article-title>DREM 2.0: improved reconstruction of dynamic regulatory networks from time-series expression data</article-title><source>BMC Syst. Biol.</source><year>2012</year><volume>6</volume><fpage>104</fpage><pub-id pub-id-type="pmid">22897824</pub-id></element-citation></ref><ref id="btt099-B27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Selinger</surname><given-names>D</given-names></name><etal/></person-group><article-title>Global RNA half-life analysis in <italic>Escherichia coli</italic> reveals positional patterns of transcript degradation</article-title><source>Genome Res.</source><year>2003</year><volume>13</volume><fpage>216</fpage><lpage>223</lpage><pub-id pub-id-type="pmid">12566399</pub-id></element-citation></ref><ref id="btt099-B28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seok</surname><given-names>J</given-names></name><etal/></person-group><article-title>A dynamic network of transcription in LPS-treated human subjects</article-title><source>BMC Syst. Biol.</source><year>2009</year><volume>3</volume><fpage>78</fpage><pub-id pub-id-type="pmid">19638230</pub-id></element-citation></ref><ref id="btt099-B29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stolovitzky</surname><given-names>G</given-names></name><etal/></person-group><article-title>Dialogue on reverse-engineering assessment and methods: the DREAM of high-throughput pathway inference</article-title><source>Ann. NY Acad. Sci.</source><year>2007</year><volume>1115</volume><fpage>1</fpage><lpage>22</lpage><pub-id pub-id-type="pmid">17925349</pub-id></element-citation></ref><ref id="btt099-B30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stolovitzky</surname><given-names>G</given-names></name><etal/></person-group><article-title>Lessons from the DREAM2 challenges</article-title><source>Ann. NY Acad. Sci.</source><year>2009</year><volume>1158</volume><fpage>159</fpage><lpage>195</lpage><pub-id pub-id-type="pmid">19348640</pub-id></element-citation></ref><ref id="btt099-B31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tamada</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Estimating gene networks from gene expression data by combining Bayesian network model with promoter element detection</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><issue>Suppl. 2</issue><fpage>ii227</fpage><lpage>ii236</lpage><pub-id pub-id-type="pmid">14534194</pub-id></element-citation></ref><ref id="btt099-B32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Werhli</surname><given-names>AV</given-names></name><name><surname>Husmeier</surname><given-names>D</given-names></name></person-group><article-title>Reconstructing gene regulatory networks with bayesian networks by combining expression data with multiple sources of prior knowledge</article-title><source>Stat. Appl. Genet. Mol. Biol.</source><year>2007</year><volume>6</volume><comment>Article15</comment></element-citation></ref><ref id="btt099-B33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yong-A-Poi</surname><given-names>J</given-names></name><etal/></person-group><article-title>Adaptive least absolute regression network analysis improves genetic network reconstruction by employing prior knowledge</article-title><year>2008</year><comment>PhD Thesis, Delft University of Technology</comment></element-citation></ref><ref id="btt099-B34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zellner</surname><given-names>A</given-names></name></person-group><article-title>Applications of Bayesian analysis in econometrics</article-title><source>Statistician</source><year>1983</year><volume>32</volume><fpage>23</fpage></element-citation></ref><ref id="btt099-B35"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>H</given-names></name><name><surname>Hastie</surname><given-names>T</given-names></name></person-group><article-title>Regularization and variable selection via the elastic net</article-title><source>J. R. Stat. Soc. B Stat. Methodol.</source><year>2005</year><volume>67</volume><fpage>301</fpage><lpage>320</lpage></element-citation></ref><ref id="btt099-B36"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>H</given-names></name><name><surname>Zhang</surname><given-names>HH</given-names></name></person-group><article-title>On the adaptive elasticnet with a diverging number of parameters</article-title><source>Ann. Stat.</source><year>2009</year><volume>37</volume><fpage>1733</fpage><lpage>1751</lpage><pub-id pub-id-type="pmid">20445770</pub-id></element-citation></ref></ref-list></back></article>