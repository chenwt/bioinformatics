<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 39.96?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4896364</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btv510</article-id><article-id pub-id-type="publisher-id">btv510</article-id><article-categories><subj-group subj-group-type="heading"><subject>Recomb-Seq/Recomb-Cbb</subject><subj-group subj-group-type="heading"><subject>Sequence Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>Utilizing de Bruijn graph of metagenome assembly for metatranscriptome analysis</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ye</surname><given-names>Yuzhen</given-names></name><xref ref-type="corresp" rid="btv510-COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Tang</surname><given-names>Haixu</given-names></name></contrib><aff/></contrib-group><author-notes><corresp id="btv510-COR1">*To whom correspondence should be addressed.</corresp><fn id="btv510-FN1"><p>Associate Editor: Jan Korbel</p></fn></author-notes><pub-date pub-type="ppub"><day>01</day><month>4</month><year>2016</year></pub-date><pub-date pub-type="epub"><day>29</day><month>8</month><year>2015</year></pub-date><pub-date pub-type="pmc-release"><day>29</day><month>8</month><year>2015</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the							<pub-date pub-type="epub"/>. --><volume>32</volume><issue>7</issue><fpage>1001</fpage><lpage>1008</lpage><history><date date-type="received"><day>10</day><month>3</month><year>2015</year></date><date date-type="rev-recd"><day>3</day><month>6</month><year>2015</year></date><date date-type="accepted"><day>24</day><month>8</month><year>2015</year></date></history><permissions><copyright-statement>&#x000a9; The Author 2015. Published by Oxford University Press.</copyright-statement><copyright-year>2015</copyright-year><license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p></license></permissions><abstract><p><bold>Motivation:</bold> Metagenomics research has accelerated the studies of microbial organisms, providing insights into the composition and potential functionality of various microbial communities. Metatranscriptomics (studies of the transcripts from a mixture of microbial species) and other meta-omics approaches hold even greater promise for providing additional insights into functional and regulatory characteristics of the microbial communities. Current metatranscriptomics projects are often carried out without matched metagenomic datasets (of the same microbial communities). For the projects that produce both metatranscriptomic and metagenomic datasets, their analyses are often not integrated. Metagenome assemblies are far from perfect, partially explaining why metagenome assemblies are not used for the analysis of metatranscriptomic datasets.</p><p><bold>Results:</bold> Here, we report a reads mapping algorithm for mapping of short reads onto a de Bruijn graph of assemblies. A hash table of junction <italic>k</italic>-mers (<italic>k</italic>-mers spanning branching structures in the de Bruijn graph) is used to facilitate fast mapping of reads to the graph. We developed an application of this mapping algorithm: a reference-based approach to metatranscriptome assembly using graphs of metagenome assembly as the reference. Our results show that this new approach (called TAG) helps to assemble substantially more transcripts that otherwise would have been missed or truncated because of the fragmented nature of the reference metagenome.</p><p><bold>Availability and implementation:</bold> TAG was implemented in C++ and has been tested extensively on the Linux platform. It is available for download as open source at <ext-link ext-link-type="uri" xlink:href="http://omics.informatics.indiana.edu/TAG">http://omics.informatics.indiana.edu/TAG</ext-link>.</p><p><bold>Contact:</bold>
<email>yye@indiana.edu</email></p></abstract><counts><page-count count="8"/></counts></article-meta></front><body><sec><title>1 Introduction</title><p>Metagenomes are being generated at an accelerating pace, revealing important properties of microbiomes. Other meta-omic (e.g. metatranscriptomic and metaproteomic) techniques can provide additional insights, in particular into functional characteristics of microbial communities, such as gene activities and their regulatory mechanisms. Bacteria have low inventories of short-lived mRNAs; as such, fluctuations in their mRNA pools provide a highly sensitive bioassay for environmental signals [e.g. the concentrations of dissolved organic carbon (<xref rid="btv510-B39" ref-type="bibr">Shi <italic>et</italic>
<italic>al.</italic>, 2012</xref>) and pollutant concentrations (<xref rid="btv510-B5" ref-type="bibr">de Menezes <italic>et</italic>
<italic>al.</italic>, 2012</xref>) relevant to microbes (<xref rid="btv510-B28" ref-type="bibr">Moran <italic>et</italic>
<italic>al.</italic>, 2013</xref>)]. The acquisition of meta-omics data on human microbiomes will enable us to refine the annotations of the metagenomes [the ENCODE (<xref rid="btv510-B7" ref-type="bibr">Dunham <italic>et</italic>
<italic>al.</italic>, 2012</xref>) and modENCODE (<xref rid="btv510-B36" ref-type="bibr">Roy <italic>et</italic>
<italic>al.</italic>, 2010</xref>) projects are great exemplars], and more importantly to study gene activity and its regulation (<xref rid="btv510-B26" ref-type="bibr">Maurice <italic>et</italic>
<italic>al.</italic>, 2013</xref>) in complex microbial communities in order to understand how microbial organisms work as a community in response to changes in their environment, e.g. health conditions of their human hosts (<xref rid="btv510-B16" ref-type="bibr">Jorth <italic>et</italic>
<italic>al.</italic>, 2014</xref>). A recent metatranscriptomic study of the human oral microbiome using patient-matched healthy and diseased (periodontal) samples revealed that health- and disease-associated communities exhibit defined differences in metabolism that are conserved between patients while the metabolic gene expression of individual species was highly variable between patients (<xref rid="btv510-B16" ref-type="bibr">Jorth <italic>et</italic>
<italic>al.</italic>, 2014</xref>).</p><p>In a metatranscriptomic RNA-seq study, total RNA is first isolated from the sample (with rRNAs removed to enrich for mRNA), which is then reverse transcribed into cDNA, and subjected to sequencing using next-generation sequencing platforms (<xref rid="btv510-B11" ref-type="bibr">Gosalbes <italic>et</italic>
<italic>al.</italic>, 2011</xref>). Unlike metagenomics, which reveals potential activity (as reflected in genes or pathways that can be coded for by metagenomic sequences), metatranscriptomic data indicate which of the genes/metabolic pathways are actually active (and the level of their activities) on the basis of their transcription within the community. <xref rid="btv510-B9" ref-type="bibr">Giannoukos <italic>et&#x000a0;al.</italic> (2012)</xref> presented a protocol for metatranscriptomic analysis of bacterial communities that accommodates both intact and fragmented RNA and combines efficient rRNA removal with strand-specific RNA-seq. Currently, only a handful of metatranscriptomic datasets are available (and metaproteomic datasets are even scarcer), but we envision a flood of metatranscriptomic data in the near future, as experimental techniques mature (<xref rid="btv510-B8" ref-type="bibr">Franzosa <italic>et&#x000a0;al.</italic>, 2014</xref>; <xref rid="btv510-B9" ref-type="bibr">Giannoukos <italic>et</italic>
<italic>al.</italic>, 2012</xref>).</p><p>Metatranscriptome analyses typically include the assignment of the predicted function and taxonomic origin of RNA-seq reads, by directly searching metatranscriptomic sequences (bags of reads) against prokaryotic genomes (the reference genomes) (<xref rid="btv510-B19" ref-type="bibr">Leimena <italic>et</italic>
<italic>al.</italic>, 2013</xref>) or known protein sequences (<xref rid="btv510-B8" ref-type="bibr">Franzosa <italic>et</italic>
<italic>al.</italic>, 2014</xref>). This way, tools and pipelines&#x02014;including MG-RAST (<xref rid="btv510-B27" ref-type="bibr">Meyer <italic>et</italic>
<italic>al.</italic>, 2008</xref>), MEGAN (<xref rid="btv510-B13" ref-type="bibr">Huson <italic>et</italic>
<italic>al.</italic>, 2011</xref>) and HUMAnN (<xref rid="btv510-B1" ref-type="bibr">Abubucker <italic>et</italic>
<italic>al.</italic>, 2012</xref>)&#x02014;that have been developed for metagenome data analysis can be utilized for analyzing metatranscriptomic datasets. For example, <xref rid="btv510-B8" ref-type="bibr">Franzosa <italic>et&#x000a0;al</italic><italic>.</italic> (2014)</xref> analysed metagenomic and metatranscriptomic datasets of human gut microbiomes using the HUMAnN pipeline, revealing that metatranscriptional profiles were significantly more individualized than DNA-level functional profiles. One potential pitfall of such approaches is that they cannot identify transcripts of new genes, which however may be better annotated using assembly approaches (<italic>de novo</italic> or reference based). A recent study (<xref rid="btv510-B3" ref-type="bibr">Celaj <italic>et</italic>
<italic>al.</italic>, 2014</xref>) compared the performances of currently employed transcriptome assemblers&#x02014;including Trinity (<xref rid="btv510-B12" ref-type="bibr">Grabherr <italic>et</italic>
<italic>al.</italic>, 2011</xref>), Oases (<xref rid="btv510-B37" ref-type="bibr">Schulz <italic>et</italic>
<italic>al.</italic>, 2012a</xref>), Metavelvet (<xref rid="btv510-B30" ref-type="bibr">Namiki <italic>et</italic>
<italic>al.</italic>, 2012</xref>) and IDBA-MT (<xref rid="btv510-B20" ref-type="bibr">Leung <italic>et</italic>
<italic>al.</italic>, 2013</xref>)&#x02014;and showed that assembly helps to improve the rate of functional annotation for metatranscriptomic datasets.</p><p>A matched metagenome can be helpful for the analysis of metatranscriptomic dataset. Metagenomes are often represented as contigs and scaffolds (although de Bruijn graphs are often the underlying data structure of the assemblers that were used), and are fragmented, limiting the utilization of metagenome for metatranscriptome analysis. There are pros and cons with the contig (and scaffold) representations of metagenomes. Most existing computational tools for sequence analysis work with linear representations of assemblies, so these tools (or modified versions) can be employed to analyse these representations of metagenomes. However, metagenomes are often very fragmented, and the connections between contigs or scaffolds are not captured in linear representations, which otherwise could be utilized later. For example, after we assembled two metagenomic datasets of stool samples from the Human Microbiome Project (<xref rid="btv510-B14" ref-type="bibr">Huttenhower <italic>et</italic>
<italic>al.</italic>, 2012</xref>), the total lengths of scaffolds and contigs (&#x02265;300&#x02009;bp) reported by SOAPdenovo2 (<xref rid="btv510-B25" ref-type="bibr">Luo <italic>et</italic>
<italic>al.</italic>, 2012</xref>) were about 85 and 90&#x02009;Mb, respectively, whereas the total length of the edge sequences in the de Bruijn graph from the same assembly was 150&#x02009;Mb for each. This comparison indicates that the de Bruijn graph representation of the assembly contains 50% more sequences than scaffolds reported from the assembler: most of these extra sequences are relatively fragmented sequences connecting long contigs. Furthermore, many short contigs contain only gene fragments; even long contigs contain broken genes at their ends due to the complexity of metagenome assembly (<xref rid="btv510-B43" ref-type="bibr">Wu <italic>et</italic>
<italic>al.</italic>, 2012b</xref>).</p><p>Here, we propose a novel application of de Bruijn graphs for metatranscriptomic data analyses, taking advantage of the fact that de Bruijn graph representations of metagenome assemblies contain more information than the contigs and scaffolds reported by assemblers. The de Bruijn graph was first proposed for <italic>de novo</italic> genome assembly in EULER, replacing the traversal of Hamiltonian paths in the overlap graph by the traversal of Eulerian paths (<xref rid="btv510-B34" ref-type="bibr">Pevzner <italic>et</italic>
<italic>al.</italic>, 2001</xref>), and is now employed as an efficient data structure in most short-read assemblers [e.g. Velvet (<xref rid="btv510-B44" ref-type="bibr">Zerbino and Birney, 2008</xref>), ALLPATHS-LG (<xref rid="btv510-B10" ref-type="bibr">Gnerre <italic>et</italic>
<italic>al.</italic>, 2011</xref>), SOAPdenovo (<xref rid="btv510-B24" ref-type="bibr">Li <italic>et</italic>
<italic>al.</italic>, 2010</xref>) and IDBA-UD (<xref rid="btv510-B33" ref-type="bibr">Peng <italic>et</italic>
<italic>al.</italic>, 2012</xref>)] for single genomes and metagenomes. Our approaches based on de Bruijn graph representation of metagenomes provide a natural way of compressing the data, and, more importantly, allow direct utilization of the graphs. We note that we have developed several applications previously, based on de Bruijn graph representation of genomes and metagenomes, for mining of functional elements (<xref rid="btv510-B42" ref-type="bibr">Wu <italic>et</italic>
<italic>al.</italic>, 2012a</xref>) and reads mapping (<xref rid="btv510-B41" ref-type="bibr">Wang <italic>et</italic>
<italic>al.</italic>, 2012</xref>), demonstrating the utility of direct computation on de Bruijn graphs. Application of our method to simulated and real metatranscriptomic datasets showed that our approach can significantly improve the assembly of metatranscriptomic datasets, resulting in substantially more transcripts that otherwise would have been missed or truncated because of the fragmented nature of the reference metagenome.</p></sec><sec><title>2 Methods</title><p>In this article, we propose a novel algorithm (i.e. <italic>read2graph</italic>) for aligning short reads from RNA-seq experiments to de Bruijn graphs of assemblies. We note in this article we focused on de Bruijn graphs of metagenome assemblies, but the mapping algorithm can be applied to mapping short reads to any de Bruijn graph of assembly. We also developed an application of the mapping algorithm for metatranscriptome assembly using matched metagenomes as the reference. Based on reads mapping results, we will derive putative transcripts (encoding a single bacterial gene or multiple genes within an operon), using paired-end RNA-seq reads to traverse the de Bruijn graph. We named our transcript assembly approach TAG, in which TA stands for Transcript Assembly, and G is used to emphasize the fact that our approach utilizes the graph of metagenome assembly instead of the linear sequences. We note that our method is different from the <italic>de novo</italic> approaches to transcriptome assembly, including Trinity (<xref rid="btv510-B12" ref-type="bibr">Grabherr <italic>et</italic>
<italic>al.</italic>, 2011</xref>), IDBA-MT (<xref rid="btv510-B20" ref-type="bibr">Leung <italic>et</italic>
<italic>al.</italic>, 2013</xref>) [and also a hybrid approach (<xref rid="btv510-B21" ref-type="bibr">Leung <italic>et</italic>
<italic>al.</italic>, 2014</xref>) that utilizes known protein sequences], and that it is different from the traditional reference-based assembly approaches. In our method, metatranscriptomic sequences are mapped onto matched metagenomes represented as de Bruijn graphs. So our method represents a new variant of the reference-based approaches, which uses the de Bruijn graph of matched metagenome, instead of a genome (or a collection of genomes), as the reference.</p><sec><title>2.1 Fast reads mapping onto de Bruijn graph using a hash table of <italic>k</italic>-mers spanning branching structure in the graph</title><p>Given a de Bruijn graph, more exactly, a <italic>contracted</italic> de Bruijn graph (<xref rid="btv510-B2" ref-type="bibr">Cazaux <italic>et</italic>
<italic>al.</italic>, 2014</xref>; <xref rid="btv510-B4" ref-type="bibr">Chang <italic>et</italic>
<italic>al.</italic>, 2015</xref>), in which each edge represents an assembled unique sequence from metagenomic reads, and a set of short reads from an RNA-seq experiment, the goal of our read2graph algorithm is to find the location of each read on the graph. Because bacterial genes do not have split gene structure, we can assume each read should be contained in the graph as a whole; equivalently, each read, if its location in the graph is known, can be represented as a path (i.e. sequence of edges) in the graph. The reads, therefore, can be classified into two groups depending on the path length: some reads are located within a single edge, whereas many others may cross one or more vertices in the graph. The first class of reads can be mapped to the graph using conventional fast reads mapping algorithms by using all edge sequences longer than the read length as the target sequences. In this article, we used Bowtie 2 (<xref rid="btv510-B18" ref-type="bibr">Langmead and Salzberg, 2012</xref>) for this purpose; but other mapping algorithms including BWA (<xref rid="btv510-B22" ref-type="bibr">Li and Durbin, 2009</xref>) can be used. Here, we focus on the methods for mapping reads spanning multiple edges (i.e. <italic>multi-edge-spanning reads</italic>; see <xref ref-type="fig" rid="btv510-F1">Fig. 1</xref>), which cannot be mapped using conventional mapping algorithms. A substantial number of reads may belong to this class, due to the incompleteness of metagenome assembly.
<fig id="btv510-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>A schematic illustration of the algorithm for mapping reads onto de Bruijn graphs. (<bold>a</bold>) A toy example showing four reads spanning <italic>junction k-mers</italic> in the graph (shown as the vertices). (<bold>b</bold>) Using a hash table of junction <italic>k</italic>-mers, candidates of reads that span multiple edges can be retrieved by looking up in the table. (<bold>c</bold>) For each candidate, a matched <italic>k</italic>-mer determines a unique putative location of the read in the graph (i.e. a seed match). The seed match will then be used to constrain the alignment between the read and the graph by a dynamic programming algorithm</p></caption><graphic xlink:href="btv510f1p"/></fig>
</p><p>Recall that each vertex in the de Bruijn graph represents a <italic>k</italic>-mer in metagenomic reads [typically <italic>k</italic>&#x02009;=&#x02009;23&#x02013;31 for metagenome assembly (<xref rid="btv510-B14" ref-type="bibr">Huttenhower <italic>et</italic>
<italic>al.</italic>, 2012</xref>; <xref rid="btv510-B35" ref-type="bibr">Qin <italic>et</italic>
<italic>al.</italic>, 2010</xref>)]. Therefore, as illustrated in <xref ref-type="fig" rid="btv510-F1">Figure 1</xref>, each multi-edge-spanning read contains one or more junction <italic>k</italic>-mers (i.e. corresponding to vertices with either indegree or outdegree &#x0003e;1): reads A and D span three edges in the graph, and thus each contains two such <italic>k</italic>-mers, whereas reads B and C span two edges, and thus each contains one such <italic>k</italic>-mer (<xref ref-type="fig" rid="btv510-F2">Fig. 2</xref>a). Hence, we can build a hash table for all <italic>junction k-mers</italic> that span branching structures in the de Bruijn graph assembly and then search for their exact occurrences in each putative multi-edge-spanning read (i.e., those that cannot be mapped to the edge sequences) with the assistance of the hash table (<xref ref-type="fig" rid="btv510-F1">Fig. 1</xref>b). Because each <italic>k</italic>-mer in the de Bruijn graph is unique (<xref rid="btv510-B34" ref-type="bibr">Pevzner <italic>et</italic>
<italic>al.</italic>, 2001</xref>), every <italic>k</italic>-mer in a read matches at most one <italic>k</italic>-mer stored in the hash table. Each matched <italic>k</italic>-mer determines a unique putative location of the multi-edge-spanning read in the graph (i.e. a seed match between the read and the graph), and simultaneously breaks the read into two or more segments (<xref ref-type="fig" rid="btv510-F1">Fig. 1</xref>c). The seed match will then be used to constrain the alignment between the read and the graph, starting from the seed match, going in opposite directions, using a constrained dynamic programming algorithm allowing only a small number of indels and mismatches. The bandwidth for constrained alignment is set to 7 by default for metatranscriptome assembly using matched metagenome as the reference, and this parameter can be changed by users for other purposes.
<fig id="btv510-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>A schematic example illustrating the induced transcript graph derived from four reads (A&#x02013;D) mapped to a de Bruijn graph of metagenome assembly</p></caption><graphic xlink:href="btv510f2p"/></fig>
</p><p>The mapping of multi-edge-spanning reads should run fast and consume reasonable memory because usually there are only hundreds of thousands of junction <italic>k</italic>-mers in a typical metagenome assembly in practice. We note that the multi-edge-spanning reads considered here are different from the split reads considered in transcript assembly for eukaryotes (<xref rid="btv510-B12" ref-type="bibr">Grabherr <italic>et</italic>
<italic>al.</italic>, 2011</xref>), and in rare cases for archaeal species (due to tRNA splicing and self-splicing introns) (<xref rid="btv510-B6" ref-type="bibr">Doose <italic>et</italic>
<italic>al.</italic>, 2013</xref>). Since strand-specific RNA-seq protocols are often used in metatranscriptome analysis (<xref rid="btv510-B9" ref-type="bibr">Giannoukos <italic>et</italic>
<italic>al.</italic>, 2012</xref>), our algorithm can consider the strand information and map reads to one appropriate strand in the de Bruijn graph that contains sequences from both DNA strands (and thus is symmetric).</p></sec><sec><title>2.2 Construction of transcripts from mapped reads</title><p>Once all RNA-seq reads including multi-edge-spanning reads are mapped to the graph, each read can be represented by a path (referred to as the <italic>read path</italic>) traversing the graph <inline-formula><mml:math id="MM1"><mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003e;</mml:mo></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="MM2"><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are edges; for non-multi-edge-spanning reads, path length <italic>l</italic>&#x02009;=&#x02009;1) as well as two offset values representing the locations of the read in the first and last edges in the graph. Furthermore, in most cases, two paired-end reads can also be represented as a path (i.e. the <italic>read-pair path</italic>) if there exists a unique path in the graph whose length is consistent with the expected insert size. As a result, the assembly of RNA-seq reads is equivalent to the superpath problem, which attempts to find a minimal set of superpaths (each corresponding to a transcript) that covers a given set of paths in a de Bruijn graph (<xref rid="btv510-B29" ref-type="bibr">Nagarajan and Pop, 2009</xref>). Although this problem is generally hard, we can represent the solutions of the problem in a much simpler subgraph (the transcript graph) that contains only the edges present in at least one of the read paths or read-pair paths. <xref ref-type="fig" rid="btv510-F2">Figure 2</xref> shows such an example: assuming four read paths (A, B, C and D) are derived from multi-edge-spanning reads, we will induce the transcript graph by retaining all edges in these paths, and then contracting all vertices with both indegree and outdegree of 1. We note that many read paths may contract into a single edge in the transcript graph if they are not tangled with reads from another transcript (e.g. k1 and k4 in <xref ref-type="fig" rid="btv510-F2">Fig. 2</xref> can be contracted because there are no conflicting transcript reads traversing through these nodes); as a result, the corresponding transcript sequences can be retrieved as a subsequence of an edge sequence in the transcript graph. In other cases, read paths remain spanning multiple edges in the transcript graph. These read paths sometimes can be used to further simplify transcript graph, as illustrated in the heuristic algorithms in genome assembly (<xref rid="btv510-B34" ref-type="bibr">Pevzner <italic>et&#x000a0;al.</italic>, 2001</xref>; <xref rid="btv510-B44" ref-type="bibr">Zerbino and Birney, 2008</xref>). For instance, in the example shown in <xref ref-type="fig" rid="btv510-F2">Figure 2</xref>, if we have two read-pair paths spanning AC and BD, respectively, we can obtain two resolved transcripts from the graph. Otherwise, we can only obtain partial transcript sequences. We note that, even if the transcripts cannot be fully resolved, the transcript graph is still useful for inferring the abundances of putative transcripts in a metatranscriptome sample based on the counts of reads on the edges in the transcript graph, a problem similar to the inference of splicing variants in eukaryotic RNA-seq experiments (see <xref rid="btv510-B32" ref-type="bibr">Pachter, 2011</xref> for a review).</p></sec><sec><title>2.3 Metatranscriptome assembly using metagenome assembly graph as the reference</title><p>Our approach for metatranscriptome assembly (called TAG) is based on the read2graph mapping algorithm and the transcript construction approach as described above. Given a metatranscriptomic dataset and a matched metagenomic dataset, SOAPdenovo2 (<xref rid="btv510-B25" ref-type="bibr">Luo <italic>et</italic>
<italic>al.</italic>, 2012</xref>), one commonly used assembler in metagenomic shotgun sequencing, is used to assemble the metagenomic dataset. Notably, SOAPdenovo2 is a de Bruijn graph-based assembler, and in its final output, both the de Bruijn assembly graph and the contig sequences (representing the <italic>edges</italic> in the graph) are produced. The mapping of metatranscriptomic sequences to the de Bruijn graph is conducted in two consecutive steps: (1) all reads are first mapped to the edges (i.e. contigs) in the de Bruijn graph using Bowtie 2 (version 2.2.3) (<xref rid="btv510-B18" ref-type="bibr">Langmead and Salzberg, 2012</xref>), and then, (2) the un-mapped reads in the previous step are further mapped to the graph based on the matching with junction <italic>k</italic>-mers. Next, TAG traverses the de Bruijn graph along with the mapped metatranscriptomic reads, and reports the transcripts that may span multiple edges in the assembly graph. To use the strand-specific information, the mapping of a metatranscriptomic sequence is only considered for the strand of the read that represents the transcript (i.e. the forward strand of R2 reads and the reverse-complement strand of R1 reads for the datasets we have tested). We note that other short read assemblers [such as IDBA (<xref rid="btv510-B33" ref-type="bibr">Peng <italic>et</italic>
<italic>al.</italic>, 2012</xref>)] and mapping tools [such as BWA (<xref rid="btv510-B22" ref-type="bibr">Li and Durbin, 2009</xref>)] can be utilized for generating the inputs (i.e. the de Bruijn assembly graph and the mapping of metatranscriptomic reads to contigs) for TAG. For the rest of this article, we will focus on the utility of TAG on improving the assembly of transcripts, which will be demonstrated by using the SOAPdenovo2 and Bowtie2 tools. The construction of an optimal pipeline (in particular the selection of upstream software tools) utilizing TAG is beyond the scope of this article.</p></sec></sec><sec><title>3 Results</title><p>We tested our tool (TAG) on two metatranscriptomic datasets (<xref rid="btv510-B9" ref-type="bibr">Giannoukos <italic>et</italic>
<italic>al.</italic>, 2012</xref>): one derived from a mock microbial community consisting of three bacterial species, and the other derived from a real microbiome sample in human stool. Results showed that our graph-based reads mapping algorithm (read2graph) is efficient, and TAG, which is based on the mapping algorithm, significantly improves the assembly of metatranscriptomes by considering reads mapping to branching structures in de Bruijn graphs of matched metagenomes.</p><sec><title>3.1 Evaluation of assembly accuracy on a mock dataset</title><p>We first tested TAG using a metranscriptomic data from the mock bacterial community of three species (<xref rid="btv510-B9" ref-type="bibr">Giannoukos <italic>et</italic>
<italic>al.</italic>, 2012</xref>). The &#x02018;matched&#x02019; metagenomic dataset used in TAG were simulated from the reference genomes of these bacteria [<italic>Escherichia</italic>
<italic>coli</italic> (GenBank: NC_000913.3), <italic>Perkinsus</italic><italic> marinus</italic> (GenBank: NC_005072.1) and <italic>Rhodobacter</italic><italic> sphaeroides</italic> (GenBank: NC_007493.2)] using NeSSM (<xref rid="btv510-B15" ref-type="bibr">Jia <italic>et</italic>
<italic>al.</italic>, 2013</xref>) with the Illumina error model. We used this <italic>hybrid</italic> approach here because (1) there is currently no metatranscriptomic dataset from a mock community with a matched metagenomic dataset available, and (2) there is no proper software tool for simulating metatranscriptomic dataset. (Flex Simulator is a tool for simulating RNAseq data for single species, and it has been mainly used for eukaryotic species. Bacteria have complicated transcription regulation mechanisms, which are not completely understood.) In total, 1&#x02009;M paired-end reads of length 101&#x02009;bp (i.e. &#x0223c;20&#x02009;&#x000d7;&#x02009;coverage) were simulated from the three species with equal abundances. SOAPdenov2 (version 2.04-r240) (<italic>k</italic>&#x02009;=&#x02009;31; see below for the choice of <italic>k</italic>-mer size) was used to assemble the simulated reads, and the assembly results (including the contigs and the de Bruijn assembly graph) were then used as the inputs to TAG. Because this is a simple community with bacterial species that are phylogenetically distant (<xref rid="btv510-B9" ref-type="bibr">Giannoukos <italic>et</italic>
<italic>al.</italic>, 2012</xref>), the assembly graph of the metagenome is not very tangled, and thus we do not anticipate that many transcripts reported by TAG will span multiple edges (referred to as the <italic>multi-edge transcripts</italic>) in the assembly graph. In fact, TAG reported a total of 9428 transcripts (of &#x02265;100&#x02009;bp), among which only 138 are multi-edge spanning transcripts.</p><sec><title>3.1.1 Accuracy evaluation for the TAG transcripts</title><p>We blasted transcripts assembled by TAG against the three reference genomes to evaluate the accuracy of metatranscriptome assembly. Our results showed that only 16 out of 9428 (0.17%) transcripts cannot be perfectly aligned back to the reference genomes: among the 16 transcripts, 14 can be aligned with minor differences, and only two contain potentially serious problems (see <xref ref-type="table" rid="btv510-T1">Table 1</xref>). We note that there are two types of potential errors in the transcripts assembled by TAG: the errors introduced by TAG, and the errors inherited from the metagenome assembly (i.e. the mis-assemblies present in the metagenome assembly that propagates into the transcript). One of the problematic transcript is single-edge transcript, suggesting that this assembly error was propagated from the metagenome assembly. The other problematic transcript (of 390&#x02009;bp) is a multi-edge spanning transcript, and the error was introduced by TAG (as no matching sequence can be found in the metagenome assembly). Our results suggest that TAG achieves high assembly accuracy overall with an error rate of &#x0003c;&#x0003c;1%. If we only focused on multi-edge spanning transcripts (which are more difficult to assemble than transcripts contained within edges and therefore more error prone), the assembly error rate is still very low: only one out of 138 multi-edge transcripts contains such large assembly problem (the error rate is 0.7%).
<table-wrap id="btv510-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Performance comparison of TAG and other assemblers on the mock dataset</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Oases</th><th rowspan="1" colspan="1">Trinity</th><th rowspan="1" colspan="1">TAG</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">No. of transcripts<xref ref-type="table-fn" rid="btv510-TF1"><sup>a</sup></xref></td><td align="char" char="(" rowspan="1" colspan="1">12598</td><td align="char" char="(" rowspan="1" colspan="1">24804<xref ref-type="table-fn" rid="btv510-TF2"><sup>b</sup></xref></td><td align="char" char="(" rowspan="1" colspan="1">9428</td></tr><tr><td rowspan="1" colspan="1">Perfectly aligned transcripts (percentage)<xref ref-type="table-fn" rid="btv510-TF3"><sup>c</sup></xref></td><td align="char" char="(" rowspan="1" colspan="1">5483 (43.5%)</td><td align="char" char="(" rowspan="1" colspan="1">12392 (50.0%)</td><td align="char" char="(" rowspan="1" colspan="1">9412 (99.8%)</td></tr><tr><td rowspan="1" colspan="1">Transcripts with minor problems (percentage)<xref ref-type="table-fn" rid="btv510-TF3"><sup>c</sup></xref></td><td align="char" char="(" rowspan="1" colspan="1">2724 (21.6%)</td><td align="char" char="(" rowspan="1" colspan="1">2725 (11.0%)</td><td align="char" char="(" rowspan="1" colspan="1">14 (0.15%)</td></tr><tr><td rowspan="1" colspan="1">Problematic transcripts (percentage)<xref ref-type="table-fn" rid="btv510-TF3"><sup>c</sup></xref></td><td align="char" char="(" rowspan="1" colspan="1">4391 (34.9%)<xref ref-type="table-fn" rid="btv510-TF4"><sup>d</sup></xref></td><td align="char" char="(" rowspan="1" colspan="1">9687 (39.1%)<xref ref-type="table-fn" rid="btv510-TF4"><sup>d</sup></xref></td><td align="char" char="(" rowspan="1" colspan="1">2 (0.02%)</td></tr><tr><td rowspan="1" colspan="1">Total length of the transcripts</td><td align="center" rowspan="1" colspan="1">6860841&#x02009;bp</td><td align="center" rowspan="1" colspan="1">7428187&#x02009;bp</td><td align="center" rowspan="1" colspan="1">7020975&#x02009;bp</td></tr><tr><td rowspan="1" colspan="1">Total length of perfectly aligned transcripts</td><td align="center" rowspan="1" colspan="1">2265224&#x02009;bp</td><td align="center" rowspan="1" colspan="1">3858486&#x02009;bp</td><td align="center" rowspan="1" colspan="1">7002290&#x02009;bp</td></tr><tr><td rowspan="1" colspan="1">Total length of good transcripts</td><td align="center" rowspan="1" colspan="1">4076481&#x02009;bp</td><td align="center" rowspan="1" colspan="1">5025072&#x02009;bp</td><td align="center" rowspan="1" colspan="1">7020484&#x02009;bp</td></tr></tbody></table><table-wrap-foot><fn id="btv510-TF1"><p><sup>a</sup>Only transcripts of at least 100&#x02009;bp were considered for all programs.</p></fn><fn id="btv510-TF2"><p><sup>b</sup>Trinity has many more transcripts, but their total length is comparable to the other methods.</p></fn><fn id="btv510-TF3"><p><sup>c</sup>A transcript that is perfectly aligned to one of the reference genomes (with an alignment covering the entire transcript at 100% sequence identity) is considered to be correctly assembled. We consider the problem of a transcript is &#x02018;minor&#x02019; if its longest alignment with the reference genomes is not 10&#x02009;nt shorter than the transcript and the alignment has 95% sequence identity or better. Other transcripts that do not meet these criteria are considered to be problematic.</p></fn><fn id="btv510-TF4"><p><sup>d</sup>A large fraction of the problematic transcripts for Oases and Trinity are likely caused by the presence of contaminated sequences or other artifacts so should not be considered as mis-assemblies. For example, 3494 (out of 4391) Oases transcripts have no significant alignments with the reference genomes with <italic>E</italic>-values better than 1e&#x02009;&#x02212;&#x02009;4, and therefore are unlikely transcripts from the reference genomes.</p></fn></table-wrap-foot></table-wrap></p></sec><sec><title>3.1.2 Comparison with de novo assembly</title><p>We further compared the performance of TAG with Oases (version 1.2.10) (<xref rid="btv510-B37" ref-type="bibr">Schulz <italic>et</italic>
<italic>al.,</italic> 2012a</xref>) and Trinity (release 2014-07-17) (<xref rid="btv510-B12" ref-type="bibr">Grabherr <italic>et</italic>
<italic>al.,</italic> 2011</xref>), <italic>de novo</italic> assemblers for transcriptomic sequences. (<bold>Trinity has been applied to analyse metatranscriptomic datasets (</bold><xref rid="btv510-B3" ref-type="bibr"><bold>Celaj <italic>et&#x000a0;al.</italic></bold><bold>, 2014</bold></xref><bold>), although the program was developed targeting splicing isoforms in Eukaryotes.</bold>) For Oases, we used merged results from assemblies using <italic>k</italic>-mer sizes ranging from 19 to 31. <xref ref-type="table" rid="btv510-T1">Table 1</xref> summarizes the comparison results. Although Oases and Trinity produced larger numbers of transcripts than TAG, the total bases in the transcripts assembled by these three methods are comparable (i.e. TAG assembled longer transcripts). If we considered only the &#x02018;good&#x02019; transcripts by excluding the transcripts that cannot be aligned well to the reference genomes [which are likely misassembles, or assemblies from contaminated sequences or other artifacts commonly found in RNA-seq experiments (<xref rid="btv510-B17" ref-type="bibr">Lahens <italic>et</italic>
<italic>al.</italic>, 2014</xref>)], the difference in the total lengths of transcripts is even more significant. TAG produced a total of 9426 good transcripts with a total of 7020484&#x02009;bp, while Oases and Trinity assembled transcripts of 407648 and 5025072 total bases, respectively. This result shows that using reference genomes for metatranscriptome assembly helps to improve the coverage and quality of the assemblies.</p><p>We ran CD-HIT-EST (version 4.6) (<xref rid="btv510-B23" ref-type="bibr">Li and Godzik, 2006</xref>) to cluster the good transcripts from all programs at 95% sequence identity cutoff (&#x02212;c 0.95), resulting in 10 &#x02009;944 clusters: only a modest number of clusters (2309) are shared by all methods, 2965 clusters are shared by two methods (1399 shared Trinity and Oases; 1369 by Trinity and TAG; and 116 by TAG and Oases), and the remaining clusters are unique to one method (TAG: 2571, Trinity: 2983, and Oases: 197). We quantified the abundances of the transcripts by mapping metatranscriptomic sequences onto the transcripts using Bowtie2. The transcripts that are shared by all methods are highly abundant with an average coverage of 28.2 (i.e. on average, each position is covered by 28.2 reads). In contrast, the average abundances of the transcripts that can be assembled by Oases, Trinity and TAG are 11.4, 8.0 and 6.4, respectively. This result suggests that <italic>de novo</italic> assembly and reference-based approaches can complement each other: transcripts of highly expressed genes in rare species (and therefore less well represented in metagenomes) may be assembled by <italic>de novo</italic> assembly, while transcripts of low expression level can be better identified using reference-based approaches.</p></sec></sec><sec><title>3.2 Application of TAG to a real metatranscriptomic dataset</title><p>We applied TAG to analysing a metatranscriptomic dataset derived from a human stool sample, using its matched metagenomic dataset as the reference (<xref rid="btv510-B9" ref-type="bibr">Giannoukos <italic>et</italic>
<italic>al.</italic>, 2012</xref>). (We combined the metatranscriptomic reads from four fractions of sequencing of the same sample, downloaded from SRA (SRX130930, SRX130937, SRX130922 and SRX130928), and the metagenomic reads from four fractions of sequencing, also downloaded from SRA (SRX130930, SRX130954, SRX130936 and SRX130949). Note that we used the metatranscriptomic dataset sequenced on 5 &#x000b5;g RNA extracted from an individual&#x02019;s stool microbiome, which was shown to yield the best sequencing results (<xref rid="btv510-B9" ref-type="bibr">Giannoukos <italic>et&#x000a0;al.</italic>, 2012</xref>).) As described above, the metagenomic sequences were first assembled using SOAPdenovo2, and the metagenome assembly was then used as the reference for the metatranscriptome assembly by TAG.</p><sec><title>3.2.1 Time and memory cost of the reads mapping to the de Bruijn graph</title><p>Metatranscriptome assembly by TAG (including reads mapping onto the graph and the transcript inference afterwards) for this dataset takes about 7&#x02009;min to complete on a Linux computer with Intel(R) Xeon(R) CPU E5-2680 v2 @ 2.80&#x02009;GHz (using single processor). The actual reads mapping step takes about 1&#x02009;min to complete&#x02014;the remaining 6&#x02009;min were spent on other I/O steps including processing the input SAM alignment file (from Bowtie2) and reads files. This indicates that our graph-based reads mapping algorithm (read2graph) is efficient. TAG adds only a small amount of computational time to the whole pipeline for the metatranscriptome analysis&#x02014;SOAPdenovo2 takes several hours to assemble the metagenome, and mapping metatranscriptomic reads onto the metagenome contigs by Bowtie2 takes about 1700 CPU minutes (the actual job was done in parallel using 32 processors).</p><p>The memory consumption by TAG is bounded by the size of the input metagenome assembly (which is used as the reference). TAG consumed &#x0003c;2 GB RAM for the stool dataset. It shows another advantage of using metagenome assembly as the reference for metatranscriptome analysis, since de Bruijn graph provides a compact representation of the metagenome assembly (but still keeps the uncertainties of the assembly in the graph for future applications).</p></sec><sec><title>3.2.2 Exploiting tangles in de Bruijn graph to improve metatranscriptome assembly</title><p>We tested the performance of TAG using reference metagenomes assembled with different <italic>k</italic>-mer sizes, considering that the choice of <italic>k</italic>-mer size is important for the metagenome assembly (<xref rid="btv510-B24" ref-type="bibr">Li <italic>et</italic>
<italic>al.,</italic> 2010</xref>; <xref rid="btv510-B44" ref-type="bibr">Zerbino and Birney, 2008</xref>) and therefore metatranscriptome assembly. As shown in <xref ref-type="fig" rid="btv510-F3">Figure 3</xref>, when a relatively small <italic>k</italic>-mer (e.g. 25) was used, the metagenome assemblies are more tangled, and as a result, fewer transcripts can be assembled using the contigs as the reference. This pitfall, however, can be alleviated by retaining the tangled structure (i.e. the ambiguous connection caused by short repeats) in the metagenome assembly in the de Bruijn graph, which can be exploited by TAG to connect metatranscriptomic reads into complete transcripts, resulting in improved assembly of metatranscriptome.
<fig id="btv510-F3" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>The impact of <italic>k</italic>-mer size on the performance of TAG. When the <italic>k</italic>-mer size increases from 25 to 31 in SOAPdenovo2 assembly, the performance of TAG remains the same: a substantial fraction of multi-edge transcripts can be assembled by TAG. However, when further increasing the <italic>k</italic>-mer size to 35, most transcripts assembled by TAG are single-edge transcripts, indicating the TAG algorithm is not effective when a large <italic>k</italic>-mer is used. This is probably because, in this case, the metagenome assembly is fragmented rather than tangled, and as a result the total length of the transcript also decreases. Therefore, in the experiments of this article, we choose <italic>k</italic>&#x02009;=&#x02009;31 in SOAPdenovo2 assembly, which seems to yield the best results here</p></caption><graphic xlink:href="btv510f3p"/></fig>
</p><p>As shown in <xref ref-type="fig" rid="btv510-F3">Figure 3</xref>, the total length of the assembled transcripts by TAG decreases slowly when <italic>k</italic>-mer size increases from 25 to 31. Considering that most transcripts are longer at <italic>k</italic>-mer&#x02009;=&#x02009;31 as compared with smaller <italic>k</italic>-mers (e.g. average lengths of the transcripts are 264 and 273 for <italic>k</italic>-mer&#x02009;=&#x02009;25 and 31, respectively), we selected <italic>k</italic>-mer&#x02009;=&#x02009;31 to demonstrate the improvement of metatranscriptome assembly by using TAG. <xref ref-type="fig" rid="btv510-F4">Figure 4</xref> shows the distribution of the path lengths (i.e. the number of edges that are traversed in the de Bruijn graph to form a transcript by TAG) of the transcripts assembled by TAG: most of the multi-edge transcripts span two edges (contigs), although a single transcript may span as many as seven edges.
<fig id="btv510-F4" orientation="portrait" position="float"><label>Fig. 4.</label><caption><p>The path length distribution for <italic>multi-edge-spanning reads</italic> that span two or more edges when mapped to the de Bruijn graph by TAG. The <italic>X</italic>-axis represents the length of multi-edge-spanning read paths (i.e. the number of edges that the multi-edge-spanning reads span) and the <italic>Y</italic>-axis represents the total number of multi-edge-spanning reads spanning the paths of certain lengths. Paths of length 1 represent the cases when the seed extension in one direction resulted in an alignment of at most 7&#x02009;bp, and thus were considered insignificant and discarded</p></caption><graphic xlink:href="btv510f4p"/></fig>
</p><p><xref ref-type="table" rid="btv510-T2">Table 2</xref> summarizes the metatranscriptome assembly results by TAG. A majority of the metagenomic reads can be mapped to metagenomic assembly: for 68.8% of read pairs, both reads can be mapped to contigs by Bowtie2, whereas an additional 13.6% reads can be mapped to contigs although their mate-pairs cannot be mapped. Among the &#x02248;9.8<italic>M</italic> remaining unmapped reads, &#x02248;1.9<italic>M</italic> (18.9%) can be mapped to multiple edges (i.e. through one or more junction <italic>k</italic>-mers in the de Bruijn graph) by TAG. Thanks to these reads, TAG was able to improve the metagenomic assembly significantly. In total, TAG assembled about 177K transcripts, among which about 21K (15.7%) are multi-edge transcripts. These multi-edge transcripts cannot be fully assembled if only those reads mapped to contigs are considered in the metatranscriptome assembly; instead, they are likely to be broken into <italic>partial</italic> transcripts, each contained in a separate contig (i.e. the edge in the de Bruijn graph). We note that TAG did not resolve all transcripts. A small fraction of TAG-assembled transcripts are <italic>partial</italic> transcripts, each of which represents a unique edge in the tangled <italic>transcript graph</italic>, formed by two or more transcripts sharing some common segments (see Section 2 for details) that cannot be resolved without additional information. About 2.6% (552 out of 21455) of the multi-edge transcripts were not fully resolved by TAG and remained as partial transcripts. Similarly, 2.2% (2573 out of 115100) of the single-edge transcripts are also partial transcript as some multi-edge-spanning reads connect them with other partial transcripts, although their actual connections remain ambiguous. We note that these two numbers increase substantially (to 21.1 and 8.1%, respectively) when there is no minimum length applied for output transcripts.
<table-wrap id="btv510-T2" orientation="portrait" position="float"><label>Table 2.</label><caption><p>Some statistics of TAG assembly on the human stool metatranscriptomics dataset</p></caption><table frame="hsides" rules="groups"><tbody align="left"><tr><td rowspan="1" colspan="1">Total number of reads</td><td rowspan="1" colspan="1">27962127&#x02009;&#x000d7;&#x02009;2 (paired)</td></tr><tr><td rowspan="1" colspan="1">Number of reads mapped to contigs</td><td rowspan="1" colspan="1">19233474&#x02009;&#x000d7;&#x02009;2&#x02009;+&#x02009;7645742 (single)</td></tr><tr><td rowspan="1" colspan="1">Number of multi-edge-spanning reads</td><td rowspan="1" colspan="1">1893157</td></tr><tr><td rowspan="1" colspan="1">Number of <italic>resolved</italic><xref ref-type="table-fn" rid="btv510-TF5"><sup>a</sup></xref> single-edge transcripts (length)</td><td rowspan="1" colspan="1">112527&#x02009;(32216351&#x02009;bp)</td></tr><tr><td rowspan="1" colspan="1">Number of <italic>partial</italic>
<xref ref-type="table-fn" rid="btv510-TF5"><sup>a</sup></xref> single-edge transcripts (length)</td><td rowspan="1" colspan="1">2573 (340276&#x02009;bp)</td></tr><tr><td rowspan="1" colspan="1">Total number of <italic>single-edge</italic><xref ref-type="table-fn" rid="btv510-TF6"><sup>b</sup></xref> transcripts (length)</td><td rowspan="1" colspan="1">115100 (32556627&#x02009;bp)</td></tr><tr><td rowspan="1" colspan="1">Number of <italic>resolved</italic> of multi-edge transcripts (length)</td><td rowspan="1" colspan="1">20903&#x02009;(4596622&#x02009;bp)</td></tr><tr><td rowspan="1" colspan="1">Number of <italic>partial</italic> multi-edge transcripts (length)</td><td rowspan="1" colspan="1">552 (110063&#x02009;bp)</td></tr><tr><td rowspan="1" colspan="1">Total number of <italic>multi-edge</italic><xref ref-type="table-fn" rid="btv510-TF6"><sup>b</sup></xref> (length) transcripts (length)</td><td rowspan="1" colspan="1">21455 (4706685&#x02009;bp)</td></tr><tr><td rowspan="1" colspan="1">Total number of transcripts (length)</td><td rowspan="1" colspan="1">177463 (40456052&#x02009;bp)</td></tr><tr><td rowspan="1" colspan="1">Proportion of multi-edge transcripts (in length)</td><td rowspan="1" colspan="1">15.7% (11.6%)</td></tr></tbody></table><table-wrap-foot><fn id="btv510-TF5"><p>Only transcripts of at least 100&#x02009;bp were considered in this summary.</p></fn><fn id="btv510-TF6"><p><sup>a</sup>Partial transcripts: the transcripts that are not fully resolved by TAG (i.e. the edge sequences); Resolved transcripts: the transcripts that are resolved by TAG and therefore likely represent full-length transcripts.</p></fn><fn id="btv510-TF7"><p><sup>b</sup>Single-edge transcripts: the transcripts reported by TAG that are fully contained within edges (contig) in the de Bruijn graph of the metagenome assembly (they can be considered as the results of a baseline reference-based metatranscriptome assembly approach that uses the contigs as the reference); Multi-edge transcripts: the transcripts reported by TAG that span multiple edges in the de Bruijn graph.</p></fn></table-wrap-foot></table-wrap>
</p><p>We also compared the TAG assemblies with the <italic>de novo</italic> transcript assemblies from Trinity. We note that this is a real metatranscriptomic dataset, so that we cannot compare the results in terms of the accuracy of the assembly as we did for the mock dataset (but we have shown using the mock dataset that <italic>de novo</italic> assembly tends to produce more problematic transcripts). In total, TAG produced 136&#x02009;555 transcripts with a total of 37.4&#x02009;Mb, whereas Trinity generated 207697 transcripts with a total of 44.8&#x02009;Mb. Similar to the results on the mock dataset, TAG transcripts are longer than Trinity transcripts: the average lengths of the transcripts are 273 and 216&#x02009;bp, for TAG and Trinity, respectively. Combining the transcripts from both assemblers (and removing redundant transcripts at 95% sequence identity by CD-HIT-EST) resulted in 233 &#x02009;201 transcripts with a total of &#x0223c;55.8&#x02009;Mb, again demonstrating that reference-based and <italic>de novo</italic> approaches can complement with each other to improve the coverage of transcript assembly.</p></sec></sec></sec><sec><title>4 Discussion</title><p>Even though thousands of complete prokaryotic genomes and many more draft genomes are available, metagenomes are constantly found to contain many new species and new genes (<xref rid="btv510-B14" ref-type="bibr">Huttenhower <italic>et</italic>
<italic>al.</italic>, 2012</xref>; <xref rid="btv510-B35" ref-type="bibr">Qin <italic>et&#x000a0;al.</italic>, 2010</xref>; <xref rid="btv510-B40" ref-type="bibr">Vital <italic>et</italic>
<italic>al.</italic>, 2014</xref>). It is therefore important to develop methodologies for metatranscriptome data analysis that are not constrained by the sequenced genomes. With &#x02018;matched&#x02019; metagenomic and metatranscriptomic datasets, we believe that proper utilization of the metagenome data will help greatly the analysis of metatranscriptomic data (and <italic>vice versa</italic>). The eventual integration of these datasets (as well as other meta-omic datasets) will provide new insights on the composition, function and regulation of microbiomes. Well-assembled transcripts are important for the function annotation of the metatranscriptome, and also for inferring gene regulatory mechanisms such as the operons.</p><p>We developed a novel reads mapping algorithm (read2graph) that allows fast mapping of short reads from transcriptome sequencing onto the assembly graphs of reference genomes. We applied this mapping algorithm for metatranscriptome assembly, showing the utility of the de Bruijn assembly graph of the metagenome in downstream applications such as the metatranscriptome analysis. Our mapping tool is fast and can be applied to other applications, for example, mapping metagenomic sequencing reads onto the de Bruijn graph of closely related species for estimating the relative abundances of these species (<xref rid="btv510-B41" ref-type="bibr">Wang <italic>et</italic>
<italic>al.</italic>, 2012</xref>). We have shown in a related research that genes are often broken into fragments in metagenome assembly, and multi-edge-spanning reads can stitch them together (<xref rid="btv510-B43" ref-type="bibr">Wu <italic>et</italic>
<italic>al.</italic>, 2012b</xref>). The mapping of multi-edge-spanning reads will also improve quantification of gene expression based on read counts, in particular for genes (from the same or different organisms) sharing highly similar sequences. In reality, however, we may still miss the mapping of a small fraction of multi-edge-spanning reads: if a read contains a sequencing error in the occurrence of a branching <italic>k</italic>-mer, we cannot find its location in the graph. Because of the low error rate (&#x0003c;1%) in Illumina reads, we believe this fraction of reads is indeed negligible in metatranscriptomic data analysis.</p><p>We note that de Bruijn graphs will naturally capture the genomic variations of the metagenomes in the graphs [e.g. the single-nucleotide variations are represented as bulges (<xref rid="btv510-B31" ref-type="bibr">Nijkamp <italic>et</italic>
<italic>al.</italic>, 2013</xref>), the variations in tandem repeats are represented as wheels, and structural variations are represented long loops (<xref rid="btv510-B34" ref-type="bibr">Pevzner <italic>et</italic>
<italic>al.</italic>, 2001</xref>)], which is yet another advantage of using graphs instead of contigs to represent metagenomes. Genomic variations in metagenomes are naturally handled by our graph-centric mapping approach.</p><p>We expect that a combination of different approaches (reference-based and <italic>de novo</italic>) need to be applied to accomplish the comprehensive metatranscriptome analysis. As the references for metatranscriptome analysis, the matched metagenome will never be perfect, due to biological (rare species may be poorly sampled), experimental (some genomic regions may not be covered well) and computational (assemblers are not perfect) reasons. Integration of known reference genomes, matched metagenomes and even non-matched metagenomes can maximize the coverage of references for reference-based approaches. On the other hand, if a microbial community contains new, rare but highly expressed microbial species, their transcripts can only be revealed by <italic>de novo</italic> metatranscriptome assembly (<xref rid="btv510-B38" ref-type="bibr">Schulz <italic>et</italic>
<italic>al.</italic>, 2012b</xref>) but not by the reference-based approaches such as the one presented in this article.</p></sec></body><back><ack><sec><title>Funding</title><p>This research was supported by <funding-source>National Institutes of Health (NIH)</funding-source> grant <funding-source>1R01AI108888-01A1</funding-source>.</p><p><italic>Conflicts of Interest</italic>: none declared.</p></sec></ack><ref-list><title>References</title><ref id="btv510-B1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abubucker</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Metabolic reconstruction for metagenomic data and its application to the human microbiome</article-title>. <source>PLoS Comput. Biol.</source>, <volume>8</volume>, <fpage>e1002358</fpage>.<pub-id pub-id-type="pmid">22719234</pub-id></mixed-citation></ref><ref id="btv510-B2"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cazaux</surname><given-names>B.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>From indexing data structures to de bruijn graphs</article-title>. In:<person-group person-group-type="editor"><name><surname>Kulikov</surname><given-names>A.</given-names></name><name><surname>Kuznetsov</surname><given-names>S.</given-names></name><name><surname>Pevzner</surname><given-names>P.</given-names></name></person-group> (eds.), <source>Combinatorial Pattern Matching</source>, <comment>volume 8486 <italic>of Lecture Notes in Computer Science</italic>, pages 89&#x02013;99. Springer International Publishing</comment>.</mixed-citation></ref><ref id="btv510-B3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Celaj</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>Comparison of assembly algorithms for improving rate of metatranscriptomic functional annotation</article-title>. <source>Microbiome</source>, <volume>2</volume>, <fpage>39</fpage>.<pub-id pub-id-type="pmid">25411636</pub-id></mixed-citation></ref><ref id="btv510-B4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>Z.</given-names></name><etal/></person-group> (<year>2015</year>). <article-title>Bridger: a new framework for de novo transcriptome assembly using RNA-seq data</article-title>. <source>Genome Biol.</source>, <volume>16</volume>, <fpage>30</fpage>.<pub-id pub-id-type="pmid">25723335</pub-id></mixed-citation></ref><ref id="btv510-B5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Menezes</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Comparative metatranscriptomics reveals widespread community responses during phenanthrene degradation in soil</article-title>. <source>Environ. Microbiol.</source>, <volume>14</volume>, <fpage>2577</fpage>&#x02013;<lpage>2588</lpage>.<pub-id pub-id-type="pmid">22625871</pub-id></mixed-citation></ref><ref id="btv510-B6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Doose</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>Mapping the RNA-Seq trash bin: unusual transcripts in prokaryotic transcriptome sequencing data</article-title>. <source>RNA Biol.</source>, <volume>10</volume>, <fpage>1204</fpage>&#x02013;<lpage>1210</lpage>.<pub-id pub-id-type="pmid">23702463</pub-id></mixed-citation></ref><ref id="btv510-B7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunham</surname><given-names>I.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>, <volume>489</volume>, <fpage>57</fpage>&#x02013;<lpage>74</lpage>.<pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation></ref><ref id="btv510-B8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Franzosa</surname><given-names>E.A.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>Relating the metatranscriptome and metagenome of the human gut</article-title>. <source>Proc. Natl Acad. Sci. U. S. A.</source>, <volume>111</volume>, <fpage>E2329</fpage>&#x02013;<lpage>E2338</lpage>.<pub-id pub-id-type="pmid">24843156</pub-id></mixed-citation></ref><ref id="btv510-B9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giannoukos</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Efficient and robust RNA-seq process for cultured bacteria and complex community transcriptomes</article-title>. <source>Genome Biol.</source>, <volume>13</volume>, <fpage>R23</fpage>.<pub-id pub-id-type="pmid">22455878</pub-id></mixed-citation></ref><ref id="btv510-B10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gnerre</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>High-quality draft assemblies of mammalian genomes from massively parallel sequence data</article-title>. <source>Proc. Natl Acad. Sci. U. S. A.</source>, <volume>108</volume>, <fpage>1513</fpage>&#x02013;<lpage>1518</lpage>.<pub-id pub-id-type="pmid">21187386</pub-id></mixed-citation></ref><ref id="btv510-B11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gosalbes</surname><given-names>M.J.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>Metatranscriptomic approach to analyze the functional human gut microbiota</article-title>. <source>PLoS One</source>, <volume>6</volume>, <fpage>e17447</fpage>.<pub-id pub-id-type="pmid">21408168</pub-id></mixed-citation></ref><ref id="btv510-B12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grabherr</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>Trinity: reconstructing a full-length transcriptome without a genome from RNA-Seq data</article-title>. <source>Nat. Biotechnol.</source>, <volume>29</volume>, <fpage>644</fpage>&#x02013;<lpage>652</lpage>.<pub-id pub-id-type="pmid">21572440</pub-id></mixed-citation></ref><ref id="btv510-B13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huson</surname><given-names>D.H.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>Integrative analysis of environmental sequences using MEGAN4</article-title>. <source>Genome Res.</source>, <volume>21</volume>, <fpage>1552</fpage>&#x02013;<lpage>1560</lpage>.<pub-id pub-id-type="pmid">21690186</pub-id></mixed-citation></ref><ref id="btv510-B14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huttenhower</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source>, <volume>486</volume>, <fpage>207</fpage>&#x02013;<lpage>214</lpage>.<pub-id pub-id-type="pmid">22699609</pub-id></mixed-citation></ref><ref id="btv510-B15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jia</surname><given-names>B.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>NeSSM: a Next-generation sequencing simulator for metagenomics</article-title>. <source>PLoS One</source>, <volume>8</volume>, <fpage>e75448</fpage>.<pub-id pub-id-type="pmid">24124490</pub-id></mixed-citation></ref><ref id="btv510-B16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jorth</surname><given-names>P.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>Metatranscriptomics of the human oral microbiome during health and disease</article-title>. <source>MBio</source>, <volume>5</volume>, <fpage>e01012</fpage>&#x02013;<lpage>e01014</lpage>.<pub-id pub-id-type="pmid">24692635</pub-id></mixed-citation></ref><ref id="btv510-B17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lahens</surname><given-names>N.F.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>IVT-seq reveals extreme bias in RNA sequencing</article-title>. <source>Genome Biol.</source>, <volume>15</volume>, <fpage>R86</fpage>.<pub-id pub-id-type="pmid">24981968</pub-id></mixed-citation></ref><ref id="btv510-B18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B.</given-names></name><name><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group> (<year>2012</year>). <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>357</fpage>&#x02013;<lpage>359</lpage>.<pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation></ref><ref id="btv510-B19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leimena</surname><given-names>M.M.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>A comprehensive metatranscriptome analysis pipeline and its validation using human small intestine microbiota datasets</article-title>. <source>BMC Genomics</source>, <volume>14</volume>, <fpage>530</fpage>.<pub-id pub-id-type="pmid">23915218</pub-id></mixed-citation></ref><ref id="btv510-B20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leung</surname><given-names>H.C.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>IDBA-MT: de novo assembler for metatranscriptomic data generated from next-generation sequencing technology</article-title>. <source>J. Comput. Biol.</source>, <volume>20</volume>, <fpage>540</fpage>&#x02013;<lpage>550</lpage>.<pub-id pub-id-type="pmid">23829653</pub-id></mixed-citation></ref><ref id="btv510-B21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leung</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>IDBA-MTP: A hybrid metatranscriptomic assembler based on protein information</article-title>. <source>Res. Comput. Mol. Biol.. Lect. Notes Comput. Sci.</source>, <volume>8394</volume>, <fpage>160</fpage>&#x02013;<lpage>172</lpage>.</mixed-citation></ref><ref id="btv510-B22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H.</given-names></name><name><surname>Durbin</surname><given-names>R.</given-names></name></person-group> (<year>2009</year>). <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1754</fpage>&#x02013;<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation></ref><ref id="btv510-B23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>W.</given-names></name><name><surname>Godzik</surname><given-names>A.</given-names></name></person-group> (<year>2006</year>). <article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>. <source>Bioinformatics</source>, <volume>22</volume>, <fpage>1658</fpage>&#x02013;<lpage>1659</lpage>.<pub-id pub-id-type="pmid">16731699</pub-id></mixed-citation></ref><ref id="btv510-B24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2010</year>). <article-title>De&#x000a0;novo assembly of human genomes with massively parallel short read sequencing</article-title>. <source>Genome Res.</source>, <volume>20</volume>, <fpage>265</fpage>&#x02013;<lpage>272</lpage>.<pub-id pub-id-type="pmid">20019144</pub-id></mixed-citation></ref><ref id="btv510-B25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>SOAPdenovo2: an empirically improved memory-efficient short-read de novo assembler</article-title>. <source>Gigascience</source>, <volume>1</volume>, <fpage>18</fpage>.<pub-id pub-id-type="pmid">23587118</pub-id></mixed-citation></ref><ref id="btv510-B26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maurice</surname><given-names>C.F.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>Xenobiotics shape the physiology and gene expression of the active human gut microbiome</article-title>. <source>Cell</source>, <volume>152</volume>, <fpage>39</fpage>&#x02013;<lpage>50</lpage>.<pub-id pub-id-type="pmid">23332745</pub-id></mixed-citation></ref><ref id="btv510-B27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyer</surname><given-names>F.</given-names></name><etal/></person-group> (<year>2008</year>). <article-title>The metagenomics RAST server&#x02014;a public resource for the automatic phylogenetic and functional analysis of metagenomes</article-title>. <source>BMC Bioinformatics</source>, <volume>9</volume>, <fpage>386</fpage>.<pub-id pub-id-type="pmid">18803844</pub-id></mixed-citation></ref><ref id="btv510-B28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moran</surname><given-names>M.A.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>Sizing up metatranscriptomics</article-title>. <source>ISME J.</source>, <volume>7</volume>, <fpage>237</fpage>&#x02013;<lpage>243</lpage>.<pub-id pub-id-type="pmid">22931831</pub-id></mixed-citation></ref><ref id="btv510-B29"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagarajan</surname><given-names>N.</given-names></name><name><surname>Pop</surname><given-names>M.</given-names></name></person-group> (<year>2009</year>). <article-title>Parametric complexity of sequence assembly: theory and applications to next generation sequencing</article-title>. <source>J. Comput. Biol.</source>, <volume>16</volume>, <fpage>897</fpage>&#x02013;<lpage>908</lpage>.<pub-id pub-id-type="pmid">19580519</pub-id></mixed-citation></ref><ref id="btv510-B30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Namiki</surname><given-names>T.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>MetaVelvet: an extension of Velvet assembler to de novo metagenome assembly from short sequence reads</article-title>. <source>Nucleic Acids Res.</source>, <volume>40</volume>, <fpage>e155</fpage>.<pub-id pub-id-type="pmid">22821567</pub-id></mixed-citation></ref><ref id="btv510-B31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nijkamp</surname><given-names>J.F.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>Exploring variation-aware contig graphs for (comparative) metagenomics using MaryGold</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>2826</fpage>&#x02013;<lpage>2834</lpage>.<pub-id pub-id-type="pmid">24058058</pub-id></mixed-citation></ref><ref id="btv510-B32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pachter</surname><given-names>L.</given-names></name></person-group> (<year>2011</year>). <article-title>Models for transcript quantification from rna-seq</article-title>. <source>arXiv preprint arXiv:1104.3889</source>.</mixed-citation></ref><ref id="btv510-B33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>Y.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>IDBA-UD: a de novo assembler for single-cell and metagenomic sequencing data with highly uneven depth</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1420</fpage>&#x02013;<lpage>1428</lpage>.<pub-id pub-id-type="pmid">22495754</pub-id></mixed-citation></ref><ref id="btv510-B34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pevzner</surname><given-names>P.A.</given-names></name><etal/></person-group> (<year>2001</year>). <article-title>An Eulerian path approach to DNA fragment assembly</article-title>. <source>Proc. Natl Acad. Sci. U. S. A.</source>, <volume>98</volume>, <fpage>9748</fpage>&#x02013;<lpage>9753</lpage>.<pub-id pub-id-type="pmid">11504945</pub-id></mixed-citation></ref><ref id="btv510-B35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qin</surname><given-names>J.</given-names></name><etal/></person-group> (<year>2010</year>). <article-title>A human gut microbial gene catalogue established by metagenomic sequencing</article-title>. <source>Nature</source>, <volume>464</volume>, <fpage>59</fpage>&#x02013;<lpage>65</lpage>.<pub-id pub-id-type="pmid">20203603</pub-id></mixed-citation></ref><ref id="btv510-B36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roy</surname><given-names>S.</given-names></name><etal/></person-group> (<year>2010</year>). <article-title>Identification of functional elements and regulatory circuits by Drosophila modENCODE</article-title>. <source>Science</source>, <volume>330</volume>, <fpage>1787</fpage>&#x02013;<lpage>1797</lpage>.<pub-id pub-id-type="pmid">21177974</pub-id></mixed-citation></ref><ref id="btv510-B37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulz</surname><given-names>M.H.</given-names></name><etal/></person-group> (<year>2012a</year>). <article-title>Oases: robust de novo RNA-seq assembly across the dynamic range of expression levels</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1086</fpage>&#x02013;<lpage>1092</lpage>.<pub-id pub-id-type="pmid">22368243</pub-id></mixed-citation></ref><ref id="btv510-B38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulz</surname><given-names>M.H.</given-names></name><etal/></person-group> (<year>2012b</year>). <article-title>Oases: robust de novo rna-seq assembly across the dynamic range of expression levels</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1086</fpage>&#x02013;<lpage>1092</lpage>.<pub-id pub-id-type="pmid">22368243</pub-id></mixed-citation></ref><ref id="btv510-B39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shi</surname><given-names>Y.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Transcriptional responses of surface water marine microbial assemblages to deep-sea water amendment</article-title>. <source>Environ. Microbiol.</source>, <volume>14</volume>, <fpage>191</fpage>&#x02013;<lpage>206</lpage>.<pub-id pub-id-type="pmid">21981709</pub-id></mixed-citation></ref><ref id="btv510-B40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vital</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>Revealing the bacterial butyrate synthesis pathways by analyzing (meta)genomic data</article-title>. <source>MBio</source>, <volume>5</volume>, <fpage>e00889</fpage>.<pub-id pub-id-type="pmid">24757212</pub-id></mixed-citation></ref><ref id="btv510-B41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>A de Bruijn graph approach to the quantification of closely-related genomes in a microbial community</article-title>. <source>J. Comput. Biol.</source>, <volume>19</volume>, <fpage>814</fpage>&#x02013;<lpage>825</lpage>.<pub-id pub-id-type="pmid">22697249</pub-id></mixed-citation></ref><ref id="btv510-B42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y.W.</given-names></name><etal/></person-group> (<year>2012a</year>). <article-title>Oral spirochetes implicated in dental diseases are widespread in normal human subjects and carry extremely diverse integron gene cassettes</article-title>. <source>Appl. Environ. Microbiol.</source>, <volume>78</volume>, <fpage>5288</fpage>&#x02013;<lpage>5296</lpage>.<pub-id pub-id-type="pmid">22635997</pub-id></mixed-citation></ref><ref id="btv510-B43"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y.W.</given-names></name><etal/></person-group> (<year>2012b</year>). <article-title>Stitching gene fragments with a network matching algorithm improves gene assembly for metagenomics</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>i363</fpage>&#x02013;<lpage>i369</lpage>.<pub-id pub-id-type="pmid">22962453</pub-id></mixed-citation></ref><ref id="btv510-B44"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zerbino</surname><given-names>D.R.</given-names></name><name><surname>Birney</surname><given-names>E.</given-names></name></person-group> (<year>2008</year>). <article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>. <source>Genome Res.</source>, <volume>18</volume>, <fpage>821</fpage>&#x02013;<lpage>829</lpage>.<pub-id pub-id-type="pmid">18349386</pub-id></mixed-citation></ref></ref-list></back></article>