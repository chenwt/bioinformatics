<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinform Biol Insights</journal-id><journal-id journal-id-type="iso-abbrev">Bioinform Biol Insights</journal-id><journal-id journal-id-type="publisher-id">Bioinformatics and Biology Insights</journal-id><journal-title-group><journal-title>Bioinformatics and Biology Insights</journal-title></journal-title-group><issn pub-type="epub">1177-9322</issn><publisher><publisher-name>Libertas Academica</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4972127</article-id><article-id pub-id-type="doi">10.4137/BBI.S38193</article-id><article-id pub-id-type="publisher-id">bbi-10-2016-133</article-id><article-categories><subj-group subj-group-type="heading"><subject>Technical Advance</subject></subj-group></article-categories><title-group><article-title>OSG-GEM: Gene Expression Matrix Construction Using the Open Science Grid</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Poehlman</surname><given-names>William L.</given-names></name><xref ref-type="aff" rid="af1-bbi-10-2016-133">1</xref></contrib><contrib contrib-type="author"><name><surname>Rynge</surname><given-names>Mats</given-names></name><xref ref-type="aff" rid="af2-bbi-10-2016-133">2</xref></contrib><contrib contrib-type="author"><name><surname>Branton</surname><given-names>Chris</given-names></name><xref ref-type="aff" rid="af3-bbi-10-2016-133">3</xref></contrib><contrib contrib-type="author"><name><surname>Balamurugan</surname><given-names>D.</given-names></name><xref ref-type="aff" rid="af4-bbi-10-2016-133">4</xref></contrib><contrib contrib-type="author"><name><surname>Feltus</surname><given-names>Frank A.</given-names></name><xref ref-type="aff" rid="af1-bbi-10-2016-133">1</xref><xref ref-type="corresp" rid="c1-bbi-10-2016-133"/></contrib></contrib-group><aff id="af1-bbi-10-2016-133"><label>1</label>Department of Genetics and Biochemistry, Clemson University, SC, USA.</aff><aff id="af2-bbi-10-2016-133"><label>2</label>Information Sciences Institute, University of Southern California, Marina Del Rey, CA, USA.</aff><aff id="af3-bbi-10-2016-133"><label>3</label>Center for Computation and Technology, Louisiana State University, Baton Rouge, LA, USA.</aff><aff id="af4-bbi-10-2016-133"><label>4</label>Computation Institute, University of Chicago, Chicago, IL, USA.</aff><author-notes><corresp id="c1-bbi-10-2016-133">CORRESPONDENCE: <email>FFELTUS@clemson.edu</email></corresp></author-notes><pub-date pub-type="collection"><year>2016</year></pub-date><pub-date pub-type="epub"><day>02</day><month>8</month><year>2016</year></pub-date><volume>10</volume><fpage>133</fpage><lpage>141</lpage><history><date date-type="received"><day>01</day><month>6</month><year>2016</year></date><date date-type="rev-recd"><day>11</day><month>7</month><year>2016</year></date><date date-type="accepted"><day>12</day><month>7</month><year>2016</year></date></history><permissions><copyright-statement>&#x000a9; 2016 the author(s), publisher and licensee Libertas Academica Ltd.</copyright-statement><copyright-year>2016</copyright-year><license license-type="open-access"><license-p>This is an open-access article distributed under the terms of the Creative Commons CC-BY-NC 3.0 License.</license-p></license></permissions><abstract><p>High-throughput DNA sequencing technology has revolutionized the study of gene expression while introducing significant computational challenges for biologists. These computational challenges include access to sufficient computer hardware and functional data processing workflows. Both these challenges are addressed with our scalable, open-source Pegasus workflow for processing high-throughput DNA sequence datasets into a gene expression matrix (GEM) using computational resources available to U.S.-based researchers on the Open Science Grid (OSG). We describe the usage of the workflow (OSG-GEM), discuss workflow design, inspect performance data, and assess accuracy in mapping paired-end sequencing reads to a reference genome. A target OSG-GEM user is proficient with the Linux command line and possesses basic bioinformatics experience. The user may run this workflow directly on the OSG or adapt it to novel computing environments.</p></abstract><kwd-group><kwd>DNA sequence analysis</kwd><kwd>RNAseq</kwd><kwd>Open Science Grid</kwd><kwd>Pegasus</kwd><kwd>distributed computing</kwd></kwd-group></article-meta></front><body><sec sec-type="intro"><title>Introduction</title><p>A molecular detection revolution is underway in the field of biology. High-throughput sequencing (HTS) of DNA<xref rid="b1-bbi-10-2016-133" ref-type="bibr">1</xref> is steadily becoming a cost-effective way to achieve diverse tasks, including comparing DNA sequences of individuals for genetic analysis (genotyping by sequencing<xref rid="b2-bbi-10-2016-133" ref-type="bibr">2</xref>), sequencing and counting RNA molecules after conversion to DNA to measure steady-state RNA expression through the construction of a gene expression matrix (GEM) (RNAseq<xref rid="b3-bbi-10-2016-133" ref-type="bibr">3</xref>,<xref rid="b4-bbi-10-2016-133" ref-type="bibr">4</xref>), identifying organisms in environmental samples (metagenomics<xref rid="b5-bbi-10-2016-133" ref-type="bibr">5</xref>,<xref rid="b6-bbi-10-2016-133" ref-type="bibr">6</xref>), and many other applications.</p><p>In the case of RNAseq, biologists can now determine the dynamics of gene expression by counting millions of RNA molecules using HTS technology. RNA is extracted and converted to DNA, resulting in a set of DNA molecules that are sequenced and quantified. This avoids issues of cross-hybridization on molecular probe technologies such as microarray, and uncharacterized RNA transcripts can be detected.<xref rid="b7-bbi-10-2016-133" ref-type="bibr">7</xref> In essence, biologists can now &#x0201c;observe&#x0201d; molecular information flow from genomes that will have as much impact in understanding biological systems as the microscopy revolution of the 17th century.</p><p>There are several HTS platforms, including those from Illumina,<xref rid="b8-bbi-10-2016-133" ref-type="bibr">8</xref> Ion Torrent,<xref rid="b9-bbi-10-2016-133" ref-type="bibr">9</xref>,<xref rid="b10-bbi-10-2016-133" ref-type="bibr">10</xref> and Pacific Biosciences,<xref rid="b11-bbi-10-2016-133" ref-type="bibr">11</xref> each with their own nuances. For example, Illumina creates a large quantity (often in the millions) of short DNA sequences of various lengths (36&#x02013;300 base pairs) that are encoded in chromosomal intervals (ie, genes) with specific sequences that are unique to the species and individual. It would be ideal to capture the sequence of the entire DNA molecule without errors, but high-quality sequences are often obtained from one end of the molecule (single-end reads) or as pairs from both ends of the molecule (paired-end reads). Thus, a key aspect of HTS DNA analysis involves aligning a large number of short DNA sequences to a smaller number of large-reference genome DNA sequences. The HTS DNA data lifecycle and the typical computational workflow are shown in <xref ref-type="fig" rid="f1-bbi-10-2016-133">Figure 1</xref>.</p><p>HTS DNA data files can be quite large and require complex computational workflows that extract a quantitative biological measurement. After sequencing is complete, an HTS DNA dataset is a concatenation of DNA sequence strings and metadata that include base pair call accuracy encoding (quality scores) as well as sample and instrument information. The datasets are stored in standard formats including FASTQ<xref rid="b12-bbi-10-2016-133" ref-type="bibr">12</xref> and SRA.<xref rid="b13-bbi-10-2016-133" ref-type="bibr">13</xref> Of note, SRA files can be manipulated and converted into FASTQ with the NCBI <italic>sra-toolkit</italic>.<xref rid="b14-bbi-10-2016-133" ref-type="bibr">14</xref> Raw DNA reads often contain sequence contamination and poor quality reads and must be cleaned before downstream processing. A Java application called <italic>Trimmomatic</italic><xref rid="b15-bbi-10-2016-133" ref-type="bibr">15</xref> performs this preprocessing task.</p><p>Once cleaned, reads are mapped to a reference genome<xref rid="b16-bbi-10-2016-133" ref-type="bibr">16</xref> or transcriptome sequence set.<xref rid="b17-bbi-10-2016-133" ref-type="bibr">17</xref> Several short-read genome aligners may be used for this, including bowtie2,<xref rid="b18-bbi-10-2016-133" ref-type="bibr">18</xref> bwa,<xref rid="b19-bbi-10-2016-133" ref-type="bibr">19</xref>&#x02013;<xref rid="b21-bbi-10-2016-133" ref-type="bibr">21</xref> SOAP,<xref rid="b22-bbi-10-2016-133" ref-type="bibr">22</xref> and others, all of which create an alignment file, often in the SAM/BAM format.<xref rid="b23-bbi-10-2016-133" ref-type="bibr">23</xref> The SAM/BAM file can be processed to extract sequence variants to the reference genome as well as count molecules that were sequenced at specific positions in the reference sequence. In the case of the RNAseq workflow, a GEM can be constructed where each row is a known gene transcript and a column is a vector of gene expression intensities (ie, RNA molecule count output detected for all genes in the sample). Molecule count information can be determined by the &#x0201c;tuxedo&#x0201d; suite of software that include Tophat,<xref rid="b24-bbi-10-2016-133" ref-type="bibr">24</xref> Cufflinks,<xref rid="b25-bbi-10-2016-133" ref-type="bibr">25</xref> HISAT,<xref rid="b26-bbi-10-2016-133" ref-type="bibr">26</xref> and StringTie.<xref rid="b27-bbi-10-2016-133" ref-type="bibr">27</xref> It should be noted that there is a plethora of software platforms that process HTS reads, including GATK,<xref rid="b28-bbi-10-2016-133" ref-type="bibr">28</xref> Galaxy,<xref rid="b29-bbi-10-2016-133" ref-type="bibr">29</xref> and R/Bioconductor<xref rid="b30-bbi-10-2016-133" ref-type="bibr">30</xref> to name but a few.</p><p>Processing HTS DNA datasets requires significant hardware resources. While it is possible to process these datasets on lab workstations, high-performance computing, high-throughput computing, and even big data systems may be required as the end user scales up the number of samples, while datasets get richer and larger. One system that is highly scalable for HTS DNA workflow execution is the Open Science Grid (OSG<xref rid="b31-bbi-10-2016-133" ref-type="bibr">31</xref>), a U.S.-based consortium of over 100 universities and national laboratories set up to share distributed high-throughput computing resources. The OSG provides free access to these resources for U.S.-based researchers and supports projects of varied scale. For example, a major stakeholder community of the OSG includes Large Hadron Collider physicists. As the OSG has matured, the benefits of the infrastructure have become apparent to experiments in other fields of science, including genomics, as well as universities to serve their local users&#x02019; computational needs.</p><p>When the OSG resource contributors do not need their full capacity &#x02013; for example, when an instrument is down for maintenance and no new data are produced &#x02013; the unused cycles on the compute resource can be shared back to the OSG community. These opportunistic cycles add up to over 100 million core hours annually, and these cycles are used for our OSG-GEM workflow. To access the OSG, our project utilized OSG Connect, which provides a simple but feature-rich interface to the OSG. Services used in this work include submit hosts, used to submit and manage jobs, and Stash, which is a multi-petabyte file-storage service. Stash is a centralized storage system that provides a number of access methods such as web portal, Globus,<xref rid="b32-bbi-10-2016-133" ref-type="bibr">32</xref> standard file-transfer mechanisms, and sharing tools such as distributed data caching close to the compute resources.</p><p>The OSG supports high throughput computing (HTC) via HTCondor.<xref rid="b33-bbi-10-2016-133" ref-type="bibr">33</xref> HTCondor is a high-throughput batch system for managing jobs on distributed resources. In a typical HTC workflow, several tasks are concurrently executed on independent machines that are connected through a network. Many scientific computations, including molecular screening, parameter sweeps, and statistical sampling, are suitable for HTC. HTC systems have the potential to accelerate GEM construction, as large quantities of short sequences from HTS are processed. The GEM workflow developed for the OSG may be modified to enable transfer of any HTC systems, including a local campus cluster, grid, or cloud.</p><p>The Pegasus Workflow Management System enables the execution of large-scale computational workflows on a variety of infrastructures.<xref rid="b34-bbi-10-2016-133" ref-type="bibr">34</xref> Pegasus workflows are described as abstract directed acyclic graphs (DAG), which describe the tasks and data dependencies but not the execution environment specifics. The reason for this abstract representation is that it provides portability for the workflow. The same workflow can be modified suitably as an executable workflow for use in different resources at different times. This modifying step of changing an abstract DAG to an executable workflow is where Pegasus adds nodes to the graph, such as data management nodes, and applies transformations to the graph, such as task clustering and workflow reduction based on already existing data products.</p><p>The OSG Gene Expression Matrix (OSG-GEM) workflow described in this article is a distributed computing mechanism to generate GEMs using the tuxedo suite of software. We provide details on how the Pegasus-based workflow is organized as well as information on the usage and evaluation of OSG-GEM. While the workflow is currently designed to process paired-end Illumina-sequencing datasets for RNA transcript quantification, OSG-GEM is adaptable to alternative methods of processing of HTS DNA datasets, as well as tuning or replacing the described software applications. OSG-GEM is available under the GNU GPL License v2 at <ext-link ext-link-type="uri" xlink:href="https://github.com/feltus/OSG-GEM">https://github.com/feltus/OSG-GEM</ext-link>.</p></sec><sec><title>Workflow Usage</title><sec><title>OSG-GEM workflow overview</title><p>The OSG-GEM workflow is capable of processing hundreds to thousands of paired-end Illumina HTS DNA datasets in the FASTQ format on the OSG. Output is a two-column matrix of gene identifiers and normalized RNA expression intensities. Multiple workflows can be launched in parallel and the resulting matrices can be stitched together to create larger GEMs for an organism, suitable for downstream analysis including gene co-expression matrix construction<xref rid="b35-bbi-10-2016-133" ref-type="bibr">35</xref>,<xref rid="b36-bbi-10-2016-133" ref-type="bibr">36</xref> (GCN in <xref ref-type="fig" rid="f1-bbi-10-2016-133">Fig. 1</xref>) and differential gene expression profiling<xref rid="b37-bbi-10-2016-133" ref-type="bibr">37</xref> (DEG in <xref ref-type="fig" rid="f1-bbi-10-2016-133">Fig. 1</xref>). In order to execute the workflow, the user will need an account on the OSG,<xref rid="b38-bbi-10-2016-133" ref-type="bibr">38</xref> HTS DNA datasets in the FASTQ format, and a reference genome or transcript assembly with associated gene annotations in the GTF/GFF3 format. These files are placed either in a specific OSG-GEM directory or via paths defined in the <italic>osg-gem.config</italic> file. The OSG-GEM workflow can be obtained from github,<xref rid="b39-bbi-10-2016-133" ref-type="bibr">39</xref> which contains the most up-to-date documentation on this workflow. A test dataset is cloned with the workflow, which utilizes human chromosome 21 from the GRCh38 build of the human-reference genome<xref rid="b40-bbi-10-2016-133" ref-type="bibr">40</xref> along with a small dataset containing 200,000 human sequences (from SRR1825962<xref rid="b41-bbi-10-2016-133" ref-type="bibr">41</xref>). The user can submit this reduced test dataset to become familiar with workflow setup and execution.</p></sec><sec><title>Pre-workflow steps</title><p>As shown in <xref ref-type="fig" rid="f2-bbi-10-2016-133">Figure 2</xref>, the first end-user decision to be made is with regard to whether the Hisat2 or the Tophat2 method will be used. We recommend Hisat2, since the developers are no longer supporting further development of Tophat2 (according to their website). We also recommend that the user becomes familiar with the application documentation for each method. If the Hisat2 method is chosen, the user must obtain the reference genome sequence file in the FASTA format<xref rid="b42-bbi-10-2016-133" ref-type="bibr">42</xref> and gene-location annotations in the GTF format.<xref rid="b43-bbi-10-2016-133" ref-type="bibr">43</xref> If the Tophat2 method is selected, the user must accumulate the reference genome sequence file in the FASTA format and gene-location annotations in the GFF format.<xref rid="b43-bbi-10-2016-133" ref-type="bibr">43</xref> Reference genome indices must be constructed using <italic>hisat2-build</italic><xref rid="b44-bbi-10-2016-133" ref-type="bibr">44</xref> or <italic>bowtie2-build</italic>.<xref rid="b45-bbi-10-2016-133" ref-type="bibr">45</xref> In order to guide the accurate mapping of sequencing reads independently from one another, annotated splice site information must be provided. For Hisat2, the built-in <italic>hisat</italic>2<italic>_extract_splice_sites.py</italic> script generates a tab-delimited list of splice junctions that allow the user to disable discovery of novel splice junctions.<xref rid="b26-bbi-10-2016-133" ref-type="bibr">26</xref> Tophat2 can map reads directly to a reference transcriptome by generating index files of all sequences that are present in the reference genome annotation.<xref rid="b24-bbi-10-2016-133" ref-type="bibr">24</xref> A reference genome annotation file in the GFF3 format is provided to guide RNA molecule counting using either StringTie<xref rid="b27-bbi-10-2016-133" ref-type="bibr">27</xref> or Cufflinks.<xref rid="b25-bbi-10-2016-133" ref-type="bibr">25</xref></p></sec><sec><title>OSG-GEM workflow setup</title><p>To set up an OSG-GEM workflow, the user must modify the <italic>osg-gem.config</italic> file to select software options and point to input data for recognition by Pegasus. First, the user must identify a reference prefix ($REF_PREFIX) that will be used to name all reference genome files used by the workflow. Next, the user must provide the file path to a forward FASTQ file and to a reverse FASTQ file. FASTQ filenames must end with .forward_1.fastq.gz or .forward_1.fastq to signify forward-sequencing reads, and .reverse_2.fastq.gz or .reverse_2.fastq to signify reverse-sequencing reads. Finally, the user must select &#x0201c;True&#x0201d; or &#x0201c;False&#x0201d; for each software option. Once the <italic>osg-gem.config</italic> file is appropriately modified, the user must place the necessary reference genome files in the <italic>reference</italic> directory of the workflow with filenames containing the $REF_PREFIX that was specified in the <italic>osg-gem.config</italic> file.</p><p>If the user selects Hisat2 as &#x0201c;True,&#x0201d; the following files must be present in the <italic>reference</italic> directory:
<list list-type="simple"><list-item><p><italic>$REF_PREFIX.fa</italic>,</p></list-item><list-item><p><italic>$REF_PREFIX.</italic>1.<italic>ht</italic>2 <italic>&#x02026; $REF_PREFIX.N.ht</italic>2,</p></list-item><list-item><p><italic>$REF_PREFIX.Splice_Sites.txt</italic>,</p></list-item><list-item><p><italic>$REF_PREFIX.gff</italic>3</p></list-item></list></p><p>If the user selects Tophat2 as &#x0201c;True,&#x0201d; the following files must be present in the <italic>reference</italic> directory:
<list list-type="simple"><list-item><p><italic>$REF_PREFIX.fa</italic>,</p></list-item><list-item><p><italic>$REF_PREFIX.</italic>1.<italic>bt</italic>2 <italic>&#x02026; $REF_PREFIX.N.bt</italic>2,</p></list-item><list-item><p><italic>$REF_PREFIX.rev.</italic>1.<italic>bt</italic>2</p></list-item><list-item><p><italic>$REF_PREFIX.rev.</italic>2.<italic>bt</italic>2,</p></list-item><list-item><p><italic>$REF_PREFIX.transcriptome_data.tar.gz</italic>,</p></list-item><list-item><p><italic>$REF_PREFIX.gff</italic>3</p></list-item></list></p><p>For example, a user cloned OSG-GEM into &#x0201c;/stash2/user/username/GEM_test&#x0201d;, and placed input FASTQ files for dataset &#x0201c;TEST&#x0201d; in &#x02018;/stash2/user/username/Data&#x02019;. To process this dataset using Hisat2 and StringTie with the GRCh38 build of the human-reference genome, the <italic>osg-gem.config</italic> file would be modified as follows:
<list list-type="simple"><list-item><p>[reference]</p></list-item><list-item><p><italic>reference_prefix</italic> = <italic>GRCh</italic>38</p></list-item><list-item><p>[inputs]</p></list-item><list-item><p><italic>forward</italic>=/<italic>stash</italic>2/<italic>user</italic>/<italic>username</italic>/<italic>Data</italic>/<italic>TEST_1.fastq.gz</italic></p></list-item><list-item><p><italic>reverse</italic>=/<italic>stash</italic>2/<italic>user</italic>/<italic>username</italic>/<italic>Data</italic>/<italic>TEST_2.fastq.gz</italic></p></list-item><list-item><p>[config]</p></list-item><list-item><p><italic>tophat2</italic> = <italic>False</italic></p></list-item><list-item><p><italic>hisat2</italic> = <italic>True</italic></p></list-item><list-item><p><italic>cufflinks</italic> = <italic>False</italic></p></list-item><list-item><p><italic>stringtie</italic> = <italic>True</italic></p></list-item></list></p></sec><sec><title>OSG-GEM workflow execution</title><p>Once the user submits the workflow by running the <italic>submit</italic> script, a list of all reference files recognized by Pegasus will be displayed on the screen, including the commands that can be used to monitor the workflow. If no reference files were found or multiple software options for alignment or quantification were selected, Pegasus will produce an error message.</p><p>The Pegasus workflow manager directs the execution of tasks in the workflow. In order to parallelize the execution of read trimming and mapping while keeping hardware requirements low, the workflow splits input FASTQ files into files of 20,000 sequences on the OSG stash filesystem. To minimize filesystem I/O, input is read from the disk and written only once by piping compressed input to <italic>gunzip</italic> and by piping the results to a python script that splits the files. To keep the number of files within each file-system directory manageable, the hierarchical structure of the workflow is established at this step. Each sub-workflow manages the processing of 1,000 forward and 1,000 reverse FASTQ files.</p><p>An example input dataset contains 80 million sequences split into 1,000 chunks (20,000 sequences each) that will be managed by four DAG sub-workflows (<xref ref-type="fig" rid="f3-bbi-10-2016-133">Fig. 3</xref>). For each subworkflow, Pegasus creates a set of job-submission scripts whose execution is managed by DAGMan and implemented by the HTCondor job submission system. A job consists of trimming (<italic>Trimmomatic</italic>) and mapping (<italic>Hisat</italic>2 or <italic>Tophat</italic>2) sequences to the reference genome. A Pegasus job cluster size of five results in five tasks being performed by each job. After a job is completed, BAM-format alignment results are transferred to a temporary OSG filesystem and then submitted to an OSG compute node for an initial merge. Upon completion of all DAG subworkflows, a BAM file from each DAG sub-workflow is transferred to an OSG compute node to generate the final <italic>merged.bam</italic> file. The final BAM file is then used to generate molecule counts, which are represented as a column in a GEM.</p><p>Pegasus provides a set of commands that can be used to monitor the progression of the workflow. In the event of a failed job, DAGMan will relaunch the job two more times. Upon the third failure, the workflow will end without producing an output matrix. The <italic>pegasus-analyzer</italic> command can be called within the workflow directory to inform the user of information relating to any failed jobs. The workflow output directory will contain standard output files resulting from <italic>Trimmomatic</italic> and <italic>Hisat</italic>2/<italic>Tophat</italic>2. Information about the read trimming and mapping rates can be extracted from these files to indicate quality of the data.</p></sec><sec><title>OSG-GEM workflow customization</title><p>OSG-GEM can be easily modified to support specific research needs. Command-line parameters that are passed to each software can be customized by modifying the job wrapper scripts in the <italic>tools</italic> directory of the workflow. It is important to note that discovery of novel splice junctions is disabled in both the <italic>hisat2</italic> and <italic>tophat</italic> job wrappers, since reads are not mapped independently of one another with default parameters. Memory and disk space on compute nodes requested by the workflow can also be changed by modifying the <italic>submit</italic> script in the base of the OSG-GEM workflow. Further guidance on customizing software and hardware options in the workflow is provided in the README.md file at <ext-link ext-link-type="uri" xlink:href="https://github.com/feltus/OSG-GEM">https://github.com/feltus/OSG-GEM</ext-link>.</p></sec></sec><sec><title>Workflow Evaluation</title><sec><title>Workflow speed</title><p>The total OSG-GEM workflow run-time was compared with the total runtime of an equivalent workflow processed on the Clemson University Palmetto Cluster (<xref ref-type="fig" rid="f4-bbi-10-2016-133">Fig. 4</xref>). The first 5,000,000 sequences of dataset NCBI SRR1825962 were mapped against the GRCh38 build of the human-reference genome. The corresponding comprehensive gene model annotation was downloaded<xref rid="b40-bbi-10-2016-133" ref-type="bibr">40</xref> (Gencode Release 24) as GTF and GFF3 files. This dataset was processed using either a combination of Tophat2-Cufflinks or Hisat2-StringTie. The OSG-GEM workflows were submitted with requests of 6 GB of RAM and 30 GB of disk storage per job. An IBM DX340 machine with an allocation of 14 GB of RAM and 111 GB of available local_scratch node storage was requested for each job on the Palmetto Cluster. For OSG-GEM workflows, files were split into 20,000 sequence pieces as described previously, while the jobs on the Palmetto Cluster processed the dataset as complete FASTQ files. The total OSG-GEM walltime was documented using the <italic>pegasus-statistics</italic> command, and the job walltime on the Palmetto Cluster was documented using the <italic>qstat</italic> command. The cumulative job walltime for each OSG-GEM subcomponent in an example workflow is shown in <xref ref-type="fig" rid="f5-bbi-10-2016-133">Figure 5</xref>.</p></sec><sec><title>Workflow accuracy</title><p>The first 5,000,000 sequences of NCBI dataset SRR1825962 were processed as described above. To confirm the accuracy of the OSG-GEM workflow, gene expression values generated by each workflow were compared with results from the same tasks performed on the Palmetto Cluster without splitting the input file (<xref ref-type="fig" rid="f6-bbi-10-2016-133">Fig. 6</xref>). A tab-delimited list of splice sites was provided to guide mapping of reads using Hisat2 with novel splice junction discovery disabled. Reads were mapped to the reference transcriptome directly using Tophat2, with novel splice junction and insertion&#x02013;deletion discovery disabled. The Hisat2-StringTie OSG-GEM workflow produced identical results with the Palmetto Cluster, while the Tophat2-Cufflinks workflow resulted in a high correlation (Pearson&#x02019;s R = 0.99). These results indicate no loss of accuracy using the OSG-GEM workflow.</p></sec></sec><sec sec-type="discussion"><title>Discussion</title><p>We have described an open-source OSG-GEM workflow to process HTS DNA datasets in the OSG-distributed computing environment. The output of OSG-GEM, the GEM, is a focal data structure for multiple downstream analyses that could also be adapted to the OSG. Given the nature of the OSG, the workflow is highly scalable, adaptable, and available to a broad research community. OSG-GEM is in an active state of development, and we are continually working to synchronize OSG-GEM with new software applications and hardware resources available for OSG job submission.</p><p>This workflow serves as a valuable resource in a variety of situations. First, scientists without institutional access to high-performance computing clusters may utilize the OSG to process RNASeq datasets without paying the cost of commercial cloud providers. Second, there is a significant development period to create and tune a complex workflow on the OSG or local computer. OSG-GEM is a solid baseline to use as it is or extend it to other purposes. Third, as input dataset size continues to swell in size and quantity, hardware requirements will become more challenging, especially with competition for resource allocation on campus-computing clusters. The ability to split large input datasets to process in parallel on the OSG will alleviate some of these issues by democratizing the resources available to analyze large datasets.</p><p>The goal of OSG-GEM is to construct accurate GEMs as quickly as possible for which there is potential for optimization in the balance between resources requested, queue time, and job failure rate, all of which can potentially increase the performance of this workflow for a given dataset size. Resources can be adjusted by requesting more RAM or more disk space that should result in fewer failed jobs but could result in longer queue times. Job failure can be caused by requesting insufficient resources or by encountering problems on one or more nodes such as exceeding local disk storage or hardware failure. In addition to failed jobs, we have found &#x0201c;run-away&#x0201d; jobs that complete in an exceptionally long time, thereby greatly influencing the final wall time (<xref ref-type="fig" rid="f5-bbi-10-2016-133">Fig. 5</xref> inset). If problematic nodes are avoided, OSG-GEM should complete in a fraction of the time shown in <xref ref-type="fig" rid="f5-bbi-10-2016-133">Figure 5</xref>.</p><p>As shown in <xref ref-type="fig" rid="f4-bbi-10-2016-133">Figure 4</xref>, the total workflow walltime of OSG-GEM workflows was greater than that of equivalent workflows processed on the campus Palmetto Cluster. Basic properties of the OSG make comparison to cluster resources difficult. We used the OSG via the OSG Connect system and thus had opportunistic access to the currently unused computing resources. A small percentage of our opportunistic jobs had to be restarted as resource owners reclaim the resources for their own work. Such restarts might increase the overall walltime of the workflow. In addition, there is a large set of variables for the resource supply and demand equation on the OSG, including the number of available resources with varying system properties, the number of active users and what resources they require, and HTCondor user priorities. All of these variables change over time. However, it is only when doing performance tests that a user has to be concerned about these variables. For data processing, OSG users enjoy an automatic fair-share&#x02013;based work to resource matching.</p><p>Data access is also a factor when comparing the execution on a campus resource versus the OSG. The campus resources usually have a local file system connected with a high-speed, low-latency network. The distributed nature of OSG means that jobs starting up on some remote resource will have to transfer or access data remotely over a wide area network. In the case of the OSG-GEM workflow, Pegasus handles these transfers transparently. Input data to a job are pulled in via parallel HTTP connections to the OSG Connect Stash filesystem, and potential output data are transferred back to Stash over SSH. These transfers do not show up in the runtime of the individual tasks but can add up and affect the overall walltime.</p><p>In conclusion, the OSG-GEM workflow is a robust method for processing RNASeq datasets to generate GEMs that serve as input for downstream applications. In the future, we intend to develop linked workflows that build upon the GEM datatype. OSG-GEM is fully functional and under active development as we adapt to evolving OSG infrastructure and tune the workflow to our needs. Therefore, we point the reader to examine the current software version and up-to-date documentation at <ext-link ext-link-type="uri" xlink:href="https://github.com/feltus/OSG-GEM">https://github.com/feltus/OSG-GEM</ext-link>.</p></sec></body><back><ack><title>Acknowledgments</title><p>Clemson University is acknowledged for generous allotment of compute time on the Palmetto Cluster.</p></ack><fn-group><fn id="fn1-bbi-10-2016-133"><p><bold>SOFTWARE AVAILABILITY:</bold> OSG-GEM is available as open-source software under the GNU GPL License v2 and available at <ext-link ext-link-type="uri" xlink:href="https://github.com/feltus/OSG-GEM">https://github.com/feltus/OSG-GEM</ext-link>.</p></fn><fn id="fn2-bbi-10-2016-133"><p><bold>ACADEMIC EDITOR:</bold> J. T. Efird, Associate Editor</p></fn><fn id="fn3-bbi-10-2016-133"><p><bold>PEER REVIEW:</bold> Four peer reviewers contributed to the peer review report. Reviewers&#x02019; reports totaled 1403 words, excluding any confidential comments to the academic editor.</p></fn><fn id="fn4-bbi-10-2016-133"><p><bold>FUNDING:</bold> This research was supported by the U.S. National Science Foundation Award #1447771 entitled &#x0201c;PXFS: ParalleX Based Transformative I/O System for Big Data&#x0201d; and by Clemson University Experiment Station Project SC-1700492 &#x0201c;Big Data Analysis Tools for Agricultural Genomics&#x0201d; under TC#6445. This research was done using resources provided by the OSG, which is supported by the National Science Foundation and the U.S. Department of Energy&#x02019;s Office of Science. The authors confirm that the funder had no influence over the study design, content of the article, or selection of this journal.</p></fn><fn id="fn5-bbi-10-2016-133"><p><bold>COMPETING INTERESTS:</bold> Authors disclose no potential conflicts of interest.</p></fn><fn id="fn6-bbi-10-2016-133"><p>Paper subject to independent expert blind peer review. All editorial decisions made by independent academic editor. Upon submission manuscript was subject to anti-plagiarism scanning. Prior to publication all authors have given signed confirmation of agreement to article publication and compliance with all applicable ethical and legal requirements, including the accuracy of author and contributor information, disclosure of competing interests and funding sources, compliance with ethical requirements relating to human and animal study participants, and compliance with any copyright requirements of third parties. This journal is a member of the Committee on Publication Ethics (COPE). Provenance: the authors were invited to submit this paper.</p></fn><fn id="fn7-bbi-10-2016-133"><p><bold>Author Contributions</bold></p><p>Conceived and designed the experiments: WLP, MR, CB, DB, FAF. Analyzed the data: WLP, MR, CB, FAF. Wrote the first draft of the manuscript: WLP, MR, CB, DB, FAF. Contributed to the writing of the manuscript: WLP, MR, CB, DB, FAF. Agree with manuscript results and conclusions: WLP, MR, CB, DB, FAF. Jointly developed the structure and arguments for the paper: WLP, MR, FAF. Made critical revisions and approved final version: WLP, MR, CB, DB, FAF. All authors reviewed and approved of the final manuscript.</p></fn></fn-group><ref-list><title>REFERENCES</title><ref id="b1-bbi-10-2016-133"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altman</surname><given-names>RB</given-names></name><name><surname>Prabhu</surname><given-names>S</given-names></name><name><surname>Sidow</surname><given-names>A</given-names></name><etal/></person-group><article-title>A research roadmap for next-generation sequencing informatics</article-title><source>Sci Transl Med</source><year>2016</year><volume>8</volume><issue>335</issue><fpage>335 s310</fpage></element-citation></ref><ref id="b2-bbi-10-2016-133"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elshire</surname><given-names>RJ</given-names></name><name><surname>Glaubitz</surname><given-names>JC</given-names></name><name><surname>Sun</surname><given-names>Q</given-names></name><etal/></person-group><article-title>A robust, simple genotyping-by-sequencing (GBS) approach for high diversity species</article-title><source>PLoS One</source><year>2011</year><volume>6</volume><issue>5</issue><fpage>e19379</fpage><pub-id pub-id-type="pmid">21573248</pub-id></element-citation></ref><ref id="b3-bbi-10-2016-133"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dillies</surname><given-names>MA</given-names></name><name><surname>Rau</surname><given-names>A</given-names></name><name><surname>Aubert</surname><given-names>J</given-names></name><etal/></person-group><article-title>A comprehensive evaluation of normalization methods for Illumina high-throughput RNA sequencing data analysis</article-title><source>Brief Bioinform</source><year>2013</year><volume>14</volume><issue>6</issue><fpage>671</fpage><lpage>83</lpage><pub-id pub-id-type="pmid">22988256</pub-id></element-citation></ref><ref id="b4-bbi-10-2016-133"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conesa</surname><given-names>A</given-names></name><name><surname>Madrigal</surname><given-names>P</given-names></name><name><surname>Tarazona</surname><given-names>S</given-names></name><etal/></person-group><article-title>A survey of best practices for RNA-seq data analysis</article-title><source>Genome Biol</source><year>2016</year><volume>17</volume><issue>1</issue><fpage>13</fpage><pub-id pub-id-type="pmid">26813401</pub-id></element-citation></ref><ref id="b5-bbi-10-2016-133"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Warnecke</surname><given-names>F</given-names></name><name><surname>Luginbuhl</surname><given-names>P</given-names></name><name><surname>Ivanova</surname><given-names>N</given-names></name><etal/></person-group><article-title>Metagenomic and functional analysis of hindgut microbiota of a wood-feeding higher termite</article-title><source>Nature</source><year>2007</year><volume>450</volume><issue>7169</issue><fpage>560</fpage><lpage>5</lpage><pub-id pub-id-type="pmid">18033299</pub-id></element-citation></ref><ref id="b6-bbi-10-2016-133"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wooley</surname><given-names>JC</given-names></name><name><surname>Godzik</surname><given-names>A</given-names></name><name><surname>Friedberg</surname><given-names>I</given-names></name></person-group><article-title>A primer on metagenomics</article-title><source>PLoS Comput Biol</source><year>2010</year><volume>6</volume><issue>2</issue><fpage>e1000667</fpage><pub-id pub-id-type="pmid">20195499</pub-id></element-citation></ref><ref id="b7-bbi-10-2016-133"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>S</given-names></name><name><surname>Fung-Leung</surname><given-names>WP</given-names></name><name><surname>Bittner</surname><given-names>A</given-names></name><name><surname>Ngo</surname><given-names>K</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name></person-group><article-title>Comparison of RNA-Seq and microarray in transcriptome profiling of activated T cells</article-title><source>PLoS One</source><year>2014</year><volume>9</volume><issue>1</issue><fpage>e78644</fpage><pub-id pub-id-type="pmid">24454679</pub-id></element-citation></ref><ref id="b8-bbi-10-2016-133"><label>8</label><element-citation publication-type="webpage"><source>Illumina</source><year>2016</year><comment>Available at: <ext-link ext-link-type="uri" xlink:href="http://www.illumina.com/">http://www.illumina.com/</ext-link></comment></element-citation></ref><ref id="b9-bbi-10-2016-133"><label>9</label><element-citation publication-type="webpage"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>T</given-names></name></person-group><year>2016</year><comment>Available at: <ext-link ext-link-type="uri" xlink:href="https://www.thermofisher.com/us/en/home/brands/ion-torrent.html">https://www.thermofisher.com/us/en/home/brands/ion-torrent.html</ext-link></comment></element-citation></ref><ref id="b10-bbi-10-2016-133"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeo</surname><given-names>ZX</given-names></name><name><surname>Wong</surname><given-names>JC</given-names></name><name><surname>Rozen</surname><given-names>SG</given-names></name><name><surname>Lee</surname><given-names>AS</given-names></name></person-group><article-title>Evaluation and optimisation of indel detection workflows for ion torrent sequencing of the BRCA1 and BRCA2 genes</article-title><source>BMC Genomics</source><year>2014</year><volume>15</volume><fpage>516</fpage><pub-id pub-id-type="pmid">24962530</pub-id></element-citation></ref><ref id="b11-bbi-10-2016-133"><label>11</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>PacBio</collab></person-group><year>2016</year><comment>Available at: <ext-link ext-link-type="uri" xlink:href="http://www.pacb.com/">http://www.pacb.com/</ext-link></comment></element-citation></ref><ref id="b12-bbi-10-2016-133"><label>12</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>Wikipedia</collab></person-group><source>FASTQ Format</source><year>2016</year><comment>Available at: <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/FASTQ_format">https://en.wikipedia.org/wiki/FASTQ_format</ext-link></comment></element-citation></ref><ref id="b13-bbi-10-2016-133"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kodama</surname><given-names>Y</given-names></name><name><surname>Shumway</surname><given-names>M</given-names></name><name><surname>Leinonen</surname><given-names>R</given-names></name><collab>International Nucleotide Sequence Database Collaboration</collab></person-group><article-title>The Sequence Read Archive: explosive growth of sequencing data</article-title><source>Nucleic Acids Res</source><year>2012</year><volume>40</volume><issue>Database issue</issue><fpage>D54</fpage><lpage>6</lpage><pub-id pub-id-type="pmid">22009675</pub-id></element-citation></ref><ref id="b14-bbi-10-2016-133"><label>14</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>sra-tools</collab></person-group><year>2016</year><comment>Available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/ncbi/sra-tools">https://github.com/ncbi/sra-tools</ext-link></comment></element-citation></ref><ref id="b15-bbi-10-2016-133"><label>15</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>Trimmomatic</collab></person-group><year>2013</year><comment>Available at: <ext-link ext-link-type="uri" xlink:href="http://www.usadellab.org/cms/?page=trimmomatic">www.usadellab.org/cms/?page=trimmomatic</ext-link>; <ext-link ext-link-type="uri" xlink:href="http://www.usadellab.org/cms/index.php?page=trimmomatic">http://www.usadellab.org/cms/index.php?page=trimmomatic</ext-link></comment></element-citation></ref><ref id="b16-bbi-10-2016-133"><label>16</label><element-citation publication-type="journal"><article-title>ReferenceGenome. E pluribus unum</article-title><source>Nat Methods</source><year>2010</year><volume>7</volume><fpage>331</fpage><pub-id pub-id-type="pmid">20440876</pub-id></element-citation></ref><ref id="b17-bbi-10-2016-133"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Haas</surname><given-names>BJ</given-names></name><name><surname>Papanicolaou</surname><given-names>A</given-names></name><name><surname>Yassour</surname><given-names>M</given-names></name><etal/></person-group><article-title>De novo transcript sequence reconstruction from RNA-seq using the Trinity platform for reference generation and analysis</article-title><source>Nat Protoc</source><year>2013</year><volume>8</volume><issue>8</issue><fpage>1494</fpage><lpage>512</lpage><pub-id pub-id-type="pmid">23845962</pub-id></element-citation></ref><ref id="b18-bbi-10-2016-133"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>Fast gapped-read alignment with Bowtie 2</article-title><source>Nat Methods</source><year>2012</year><volume>9</volume><issue>4</issue><fpage>357</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">22388286</pub-id></element-citation></ref><ref id="b19-bbi-10-2016-133"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abuin</surname><given-names>JM</given-names></name><name><surname>Pichel</surname><given-names>JC</given-names></name><name><surname>Pena</surname><given-names>TF</given-names></name><name><surname>Amigo</surname><given-names>J</given-names></name></person-group><article-title>SparkBWA: speeding up the alignment of high-throughput DNA sequencing data</article-title><source>PLoS One</source><year>2016</year><volume>11</volume><issue>5</issue><fpage>e0155461</fpage><pub-id pub-id-type="pmid">27182962</pub-id></element-citation></ref><ref id="b20-bbi-10-2016-133"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jo</surname><given-names>H</given-names></name><name><surname>Koh</surname><given-names>G</given-names></name></person-group><article-title>Faster single-end alignment generation utilizing multi-thread for BWA</article-title><source>Biomed Mater Eng</source><year>2015</year><volume>26</volume><issue>suppl 1</issue><fpage>S1791</fpage><lpage>6</lpage><pub-id pub-id-type="pmid">26405948</pub-id></element-citation></ref><ref id="b21-bbi-10-2016-133"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><issue>14</issue><fpage>1754</fpage><lpage>60</lpage><pub-id pub-id-type="pmid">19451168</pub-id></element-citation></ref><ref id="b22-bbi-10-2016-133"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>Y</given-names></name><name><surname>Kristiansen</surname><given-names>K</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name></person-group><article-title>SOAP: short oligonucleotide alignment program</article-title><source>Bioinformatics</source><year>2008</year><volume>24</volume><issue>5</issue><fpage>713</fpage><lpage>4</lpage><pub-id pub-id-type="pmid">18227114</pub-id></element-citation></ref><ref id="b23-bbi-10-2016-133"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Handsaker</surname><given-names>B</given-names></name><name><surname>Wysoker</surname><given-names>A</given-names></name><etal/></person-group><article-title>The sequence alignment/map format and SAMtools</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><issue>16</issue><fpage>2078</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">19505943</pub-id></element-citation></ref><ref id="b24-bbi-10-2016-133"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Pachter</surname><given-names>L</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>TopHat: discovering splice junctions with RNA-Seq</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><issue>9</issue><fpage>1105</fpage><lpage>11</lpage><pub-id pub-id-type="pmid">19289445</pub-id></element-citation></ref><ref id="b25-bbi-10-2016-133"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Williams</surname><given-names>BA</given-names></name><name><surname>Pertea</surname><given-names>G</given-names></name><etal/></person-group><article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title><source>Nat Biotechnol</source><year>2010</year><volume>28</volume><issue>5</issue><fpage>511</fpage><lpage>5</lpage><pub-id pub-id-type="pmid">20436464</pub-id></element-citation></ref><ref id="b26-bbi-10-2016-133"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>D</given-names></name><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>HISAT: a fast spliced aligner with low memory requirements</article-title><source>Nat Methods</source><year>2015</year><volume>12</volume><issue>4</issue><fpage>357</fpage><lpage>60</lpage><pub-id pub-id-type="pmid">25751142</pub-id></element-citation></ref><ref id="b27-bbi-10-2016-133"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pertea</surname><given-names>M</given-names></name><name><surname>Pertea</surname><given-names>GM</given-names></name><name><surname>Antonescu</surname><given-names>CM</given-names></name><name><surname>Chang</surname><given-names>TC</given-names></name><name><surname>Mendell</surname><given-names>JT</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>StringTie enables improved reconstruction of a transcriptome from RNA-seq reads</article-title><source>Nat Biotechnol</source><year>2015</year><volume>33</volume><issue>3</issue><fpage>290</fpage><lpage>5</lpage><pub-id pub-id-type="pmid">25690850</pub-id></element-citation></ref><ref id="b28-bbi-10-2016-133"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A</given-names></name><name><surname>Hanna</surname><given-names>M</given-names></name><name><surname>Banks</surname><given-names>E</given-names></name><etal/></person-group><article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title><source>Genome Res</source><year>2010</year><volume>20</volume><issue>9</issue><fpage>1297</fpage><lpage>303</lpage><pub-id pub-id-type="pmid">20644199</pub-id></element-citation></ref><ref id="b29-bbi-10-2016-133"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hillman-Jackson</surname><given-names>J</given-names></name><name><surname>Clements</surname><given-names>D</given-names></name><name><surname>Blankenberg</surname><given-names>D</given-names></name><name><surname>Taylor</surname><given-names>J</given-names></name><name><surname>Nekrutenko</surname><given-names>A</given-names></name><collab>Galaxy Team</collab></person-group><article-title>Using Galaxy to perform large-scale interactive data analyses</article-title><source>Curr Protoc Bioinformatics</source><year>2012</year><comment>Chapter 10:Unit10.5</comment></element-citation></ref><ref id="b30-bbi-10-2016-133"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gentleman</surname><given-names>RC</given-names></name><name><surname>Carey</surname><given-names>VJ</given-names></name><name><surname>Bates</surname><given-names>DM</given-names></name><etal/></person-group><article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title><source>Genome Biol</source><year>2004</year><volume>5</volume><issue>10</issue><fpage>R80</fpage><pub-id pub-id-type="pmid">15461798</pub-id></element-citation></ref><ref id="b31-bbi-10-2016-133"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pordes</surname><given-names>R</given-names></name><name><surname>Petravick</surname><given-names>D</given-names></name><name><surname>Kramer</surname><given-names>B</given-names></name><etal/></person-group><article-title>The open science grid</article-title><source>J Phys Conf Ser</source><year>2007</year><volume>78</volume><issue>1</issue><fpage>012057</fpage></element-citation></ref><ref id="b32-bbi-10-2016-133"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Foster</surname><given-names>I</given-names></name></person-group><article-title>Globus online: accelerating and democratizing science through cloud-based services</article-title><source>IEEE Internet Comput</source><year>2011</year><volume>15</volume><issue>03</issue><fpage>70</fpage><lpage>3</lpage></element-citation></ref><ref id="b33-bbi-10-2016-133"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thain</surname><given-names>D</given-names></name><name><surname>Tannenbaum</surname><given-names>T</given-names></name><name><surname>Livny</surname><given-names>M</given-names></name></person-group><article-title>Distributed computing in practice: the Condor experience</article-title><source>Concurr Comput</source><year>2005</year><volume>17</volume><issue>2&#x02013;4</issue><fpage>323</fpage><lpage>56</lpage></element-citation></ref><ref id="b34-bbi-10-2016-133"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Deelman</surname><given-names>E</given-names></name><name><surname>Vahi</surname><given-names>K</given-names></name><name><surname>Juve</surname><given-names>G</given-names></name><etal/></person-group><article-title>Pegasus: a workflow management system for science automation</article-title><source>Future Gener Comput Syst</source><year>2015</year><volume>46</volume><fpage>17</fpage><lpage>35</lpage></element-citation></ref><ref id="b35-bbi-10-2016-133"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feltus</surname><given-names>FA</given-names></name><name><surname>Ficklin</surname><given-names>SP</given-names></name><name><surname>Gibson</surname><given-names>SM</given-names></name><name><surname>Smith</surname><given-names>MC</given-names></name></person-group><article-title>Maximizing capture of gene co-expression relationships through pre-clustering of input expression samples: an Arabidopsis case study</article-title><source>BMC Syst Biol</source><year>2013</year><volume>7</volume><fpage>44</fpage><pub-id pub-id-type="pmid">23738693</pub-id></element-citation></ref><ref id="b36-bbi-10-2016-133"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langfelder</surname><given-names>P</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name></person-group><article-title>WGCNA: an R package for weighted correlation network analysis</article-title><source>BMC Bioinformatics</source><year>2008</year><volume>9</volume><fpage>559</fpage><pub-id pub-id-type="pmid">19114008</pub-id></element-citation></ref><ref id="b37-bbi-10-2016-133"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vu</surname><given-names>TN</given-names></name><name><surname>Wills</surname><given-names>QF</given-names></name><name><surname>Kalari</surname><given-names>KR</given-names></name><etal/></person-group><article-title>Beta-Poisson model for single-cell RNA-seq data analyses</article-title><source>Bioinformatics</source><year>2016</year><volume>32</volume><fpage>2128</fpage><lpage>35</lpage><pub-id pub-id-type="pmid">27153638</pub-id></element-citation></ref><ref id="b38-bbi-10-2016-133"><label>38</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>OSG</collab></person-group><year>2016</year><comment>Available at: <ext-link ext-link-type="uri" xlink:href="https://www.opensciencegrid.org/">https://www.opensciencegrid.org/</ext-link></comment></element-citation></ref><ref id="b39-bbi-10-2016-133"><label>39</label><element-citation publication-type="webpage"><person-group person-group-type="author"><name><surname>Poehlman</surname><given-names>W</given-names></name></person-group><collab>OSG-GEM</collab><year>2016</year><comment>Available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/feltus/OSG-GEM">https://github.com/feltus/OSG-GEM</ext-link></comment></element-citation></ref><ref id="b40-bbi-10-2016-133"><label>40</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>GENCODE</collab><collab>GENCODE</collab></person-group><year>2016</year><comment>Available at: <ext-link ext-link-type="uri" xlink:href="http://www.gencodegenes.org">http://www.gencodegenes.org</ext-link></comment></element-citation></ref><ref id="b41-bbi-10-2016-133"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blakeley</surname><given-names>P</given-names></name><name><surname>Fogarty</surname><given-names>NM</given-names></name><name><surname>del Valle</surname><given-names>I</given-names></name><etal/></person-group><article-title>Defining the three cell lineages of the human blastocyst by single-cell RNA-seq</article-title><source>Development</source><year>2015</year><volume>142</volume><issue>18</issue><fpage>3151</fpage><lpage>65</lpage><pub-id pub-id-type="pmid">26293300</pub-id></element-citation></ref><ref id="b42-bbi-10-2016-133"><label>42</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>Wikipedia</collab></person-group><source>FASTA Format</source><year>2016</year><comment>Available at: <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/FASTA_format">https://en.wikipedia.org/wiki/FASTA_format</ext-link></comment></element-citation></ref><ref id="b43-bbi-10-2016-133"><label>43</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>ENSEMBL</collab><collab>GTF/GFF Format</collab></person-group><year>2016</year><comment>Available at: <ext-link ext-link-type="uri" xlink:href="http://useast.ensembl.org/info/website/upload/gff.html">http://useast.ensembl.org/info/website/upload/gff.html</ext-link></comment></element-citation></ref><ref id="b44-bbi-10-2016-133"><label>44</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>HISAT2_BUILD</collab></person-group><year>2016</year><comment>Available at: <ext-link ext-link-type="uri" xlink:href="https://ccb.jhu.edu/software/hisat2/manual.shtml#the-hisat2-build-indexer">https://ccb.jhu.edu/software/hisat2/manual.shtml#the-hisat2-build-indexer</ext-link></comment></element-citation></ref><ref id="b45-bbi-10-2016-133"><label>45</label><element-citation publication-type="webpage"><person-group person-group-type="author"><collab>BOWTIE2-BUILD</collab></person-group><year>2016</year><comment>Available at: <ext-link ext-link-type="uri" xlink:href="http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#the-bowtie2-build-indexer">http://bowtie-bio.sourceforge.net/bowtie2/manual.shtml#the-bowtie2-build-indexer</ext-link></comment></element-citation></ref></ref-list></back><floats-group><fig id="f1-bbi-10-2016-133" position="float"><label>Figure 1</label><caption><p>DNA sequence file lifecycle. A DNA sequence starts its life as a TIFF image stack from a DNA-sequencing instrument. Raw images are converted to a FASTQ text file and preprocessed or deposited into repositories such as the National Center for Biotechnology Information (NCBI) as Short Read Archive (SRA) files. Cleaned FASTQ files are mapped to a reference genome and converted to a BAM alignment file. BAM files can be mined for gene expression vectors that can be bundled into a gene expression matrix (GEM). GEMs are a stable data structure that can be mined for differentially expressed genes (DEGs) or used to construct Gene Co-expression Networks (GCNs) and processed by other workflows.</p></caption><graphic xlink:href="bbi-10-2016-133f1"/></fig><fig id="f2-bbi-10-2016-133" position="float"><label>Figure 2</label><caption><p>Preparation of input files for the gene expression matrix construction workflow on the Open Science Grid (OSG-GEM). Required input files for either the Hisat2 or the Tophat2 method are shown in boxes. The user provides paired-end DNA sequences in the FASTQ format (forward/reverse), which can be extracted from SRA format files with the NCBI SRA toolkit. The reference genome (genome) in the FASTA format must be indexed using either the Hisat2 or the Bowtie2 application. Built into the Hisat2 software package, the hisat2_extract_splice_sites.py script can generate a tab-delimited list of splice sites using a reference annotation file in the GTF format. Tophat2 can generate a set of gene model indices from GFF3 or GTF format files that contain splice site information in the form of a reference transcriptome. FASTQ file locations are defined in the osg-gem.config file and all other files are placed in the reference directory of the OSG-GEM workflow.</p></caption><graphic xlink:href="bbi-10-2016-133f2"/></fig><fig id="f3-bbi-10-2016-133" position="float"><label>Figure 3</label><caption><p>OSG-GEM Pegasus workflow diagram for a representative HTS DNA sequence dataset. The workflow is managed by Pegasus and divided into two phases called levels 1 and 2. In level 1, input FASTQ files are split into an appropriate size for OSG compute nodes. In level 2, a specific quantity of split sequence files are managed by a finite number of DAGMan sub-workflows based on input file size. DAGMan manages the submission of jobs in the workflow, which results in the trimming of FASTQ files, mapping to a reference sequence, merging alignment files, and quantifying RNA expression levels. Upon completion of all DAG subworkflows, a final merged.bam file is created. The final BAM file is used to count molecules for parsing into a gene expression matrix (GEM).</p></caption><graphic xlink:href="bbi-10-2016-133f3"/></fig><fig id="f4-bbi-10-2016-133" position="float"><label>Figure 4</label><caption><p>Walltime comparison between the OSG and Palmetto Cluster. Total workflow walltime of OSG-GEM workflows was compared with the total walltime of equivalent workflows processed as single jobs on Clemson University&#x02019;s Palmetto Cluster. A representative dataset containing 5,000,000 paired-end sequencing reads was mapped to the human-reference genome followed by RNA molecule quantification using a combination of Hisat2-StringTie or Tophat2-Cufflinks. Error bars represent the standard error of the mean (n = 3).</p></caption><graphic xlink:href="bbi-10-2016-133f4"/></fig><fig id="f5-bbi-10-2016-133" position="float"><label>Figure 5</label><caption><p>OSG-GEM component performance. A 5,000,000 sequence dataset was processed using the Hisat2-StringTie and Tophat2-Cufflinks methods of OSG-GEM. The cumulative walltime for each step of the workflow is shown for TopHat2-Cufflinks (gray bars) and Hisat2-StringTie (black bars). The inset scatterplot presents the walltime of each Hisat2 job in the Hisat2-StringTie workflow.</p></caption><graphic xlink:href="bbi-10-2016-133f5"/></fig><fig id="f6-bbi-10-2016-133" position="float"><label>Figure 6</label><caption><p>GEM accuracy after preprocessing. Gene expression vectors generated by processing a 5,000,000 sequence dataset using either the Hisat2-StringTie or the Tophat2-Cufflinks method on the Open Science Grid (OSG-GEM workflow) and single jobs on the Palmetto Cluster were compared. FPKM = Fragments Per Kilobase of Exon per Million Mapped Reads. Pearson correlation coefficients were calculated for each comparison.</p></caption><graphic xlink:href="bbi-10-2016-133f6"/></fig></floats-group></article>