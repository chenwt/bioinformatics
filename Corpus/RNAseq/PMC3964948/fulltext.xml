<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d3 20150301//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><?epub October-16-2013?><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id><journal-id journal-id-type="publisher-id">nar</journal-id><journal-id journal-id-type="hwp">nar</journal-id><journal-title-group><journal-title>Nucleic Acids Research</journal-title></journal-title-group><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3964948</article-id><article-id pub-id-type="pmid">24136997</article-id><article-id pub-id-type="doi">10.1093/nar/gkt919</article-id><article-id pub-id-type="publisher-id">gkt919</article-id><article-categories><subj-group subj-group-type="heading"><subject>IV. Viruses, bacteria, protozoa and fungi</subject></subj-group></article-categories><title-group><article-title>IMG/M 4 version of the integrated metagenome comparative analysis system</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Markowitz</surname><given-names>Victor M.</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="gkt919-COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Chen</surname><given-names>I-Min A.</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Chu</surname><given-names>Ken</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Szeto</surname><given-names>Ernest</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Palaniappan</surname><given-names>Krishna</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Pillay</surname><given-names>Manoj</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Ratner</surname><given-names>Anna</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Huang</surname><given-names>Jinghua</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Pagani</surname><given-names>Ioanna</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Tringe</surname><given-names>Susannah</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Huntemann</surname><given-names>Marcel</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Billis</surname><given-names>Konstantinos</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Varghese</surname><given-names>Neha</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Tennessen</surname><given-names>Kristin</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Mavromatis</surname><given-names>Konstantinos</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Pati</surname><given-names>Amrita</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Ivanova</surname><given-names>Natalia N.</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Kyrpides</surname><given-names>Nikos C.</given-names></name><xref ref-type="aff" rid="gkt919-AFF1"><sup>2</sup></xref><xref ref-type="corresp" rid="gkt919-COR1">*</xref></contrib><aff id="gkt919-AFF1"><sup>1</sup>Biological Data Management and Technology Center, Computational Research Division Lawrence Berkeley National Laboratory, 1 Cyclotron Road, Berkeley, 94720 USA and <sup>2</sup>Microbial Genome and Metagenome Program, Department of Energy Joint Genome Institute, 2800 Mitchell Drive, Walnut Creek, CA, 94598 USA</aff></contrib-group><author-notes><corresp id="gkt919-COR1">*To whom correspondence should be addressed. Tel: <phone>+1 510 486 7073</phone>; Fax: <fax>+1 510 486 5812</fax>; Email: <email>VMMarkowitz@lbl.gov</email></corresp><corresp id="gkt919-COR2">Correspondence may also be addressed to Nikos C. Kyrpides. Tel: <phone>+1 925 296 5718</phone>; Fax: <fax>+1 925 296 5666</fax>; Email: <email>nckyrpides@lbl.gov</email></corresp></author-notes><pub-date pub-type="ppub"><day>1</day><month>1</month><year>2014</year></pub-date><pub-date pub-type="epub"><day>16</day><month>10</month><year>2013</year></pub-date><pub-date pub-type="pmc-release"><day>16</day><month>10</month><year>2013</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the							<pub-date pub-type="epub"/>. --><volume>42</volume><issue>Database issue</issue><issue-title>Database issue</issue-title><fpage>D568</fpage><lpage>D573</lpage><history><date date-type="received"><day>16</day><month>9</month><year>2013</year></date><date date-type="accepted"><day>19</day><month>9</month><year>2013</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2013. Published by Oxford University Press.</copyright-statement><copyright-year>2013</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/3.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<uri xlink:type="simple" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</uri>), which permits non-commercial reuse, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p></license></permissions><abstract><p>IMG/M (<ext-link ext-link-type="uri" xlink:href="http://img.jgi.doe.gov/m">http://img.jgi.doe.gov/m</ext-link>) provides support for comparative analysis of microbial community aggregate genomes (metagenomes) in the context of a comprehensive set of reference genomes from all three domains of life, as well as plasmids, viruses and genome fragments. IMG/M&#x02019;s data content and analytical tools have expanded continuously since its first version was released in 2007. Since the last report published in the 2012 NAR Database Issue, IMG/M&#x02019;s database architecture, annotation and data integration pipelines and analysis tools have been extended to copewith the rapid growth in the number and size of metagenome data sets handled by the system. IMG/M data marts provide support for the analysis of publicly available genomes, expert review of metagenome annotations (IMG/M ER: <ext-link ext-link-type="uri" xlink:href="http://img.jgi.doe.gov/mer">http://img.jgi.doe.gov/mer</ext-link>) and Human Microbiome Project (HMP)-specific metagenome samples (IMG/M HMP: <ext-link ext-link-type="uri" xlink:href="http://img.jgi.doe.gov/imgm_hmp">http://img.jgi.doe.gov/imgm_hmp</ext-link>).</p></abstract><counts><page-count count="6"/></counts><custom-meta-group><custom-meta><meta-name>cover-date</meta-name><meta-value>1 January 2014</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec><title>DATA SOURCES AND PROCESSING</title><p>Metagenome analysis involves examining the phylogenetic composition and functional or metabolic potential of microbiomes in the context of a large set of reference genomes. Consequently, IMG/M consists of samples of microbial community (microbiome) aggregate genomes (metagenomes) integrated with IMG&#x02019;s comprehensive set of genomes from all three domains of life: plasmids, viruses and genome fragments (<xref rid="gkt919-B1" ref-type="bibr">1</xref>). The IMG ER Submission system (<ext-link ext-link-type="uri" xlink:href="http://img.jgi.doe.gov/submit">http://img.jgi.doe.gov/submit</ext-link>) is used for managing the processing and integration of metagenome data sets. First, the metagenome data sets submitted for inclusion into IMG/M ER are associated in GOLD (<xref rid="gkt919-B2" ref-type="bibr">2</xref>) with metadata attributes following the Genome Standards Consortium guidelines (<xref rid="gkt919-B3" ref-type="bibr">3</xref>) and classified using a multi-tiered system. Thus, all metagenome data sets are organized in three main <italic>ecosystem classes</italic>, <italic>environmental</italic>, <italic>host associated</italic> and <italic>engineered</italic>, and then further divided in subclasses characterized by <italic>ecosystem categories</italic> (e.g. aquatic, terrestrial, air for environmental metagenomes), <italic>ecosystem type</italic> (e.g. freshwater, marine), <italic>ecosystem subtype</italic> (e.g. groundwater, drinking water) and <italic>specific ecosystem</italic> (e.g. cave water, coalbed water). The GOLD metagenome classification and metadata attributes are included into IMG/M where they are essential for selecting metagenome data sets for comparative analysis.</p><p>For both genomes and metagenomes, IMG/M records their primary sequence information, their organization in scaffolds and/or contigs, as well as computationally predicted protein-coding sequences, some RNA-coding genes and protein product names. Metagenome sequences are prepared for annotation by (i) removing commonly occurring discrepancies in the input sequence files, such as duplicate sequence identifiers, and by replacing ambiguous nucleotides by Ns, while sequences with characters not occurring in {A,C,G,T,N} are not considered further; (ii) trimming sequences to remove low-quality regions and trailing &#x02018;N&#x02019;s; (iii) masking low-complexity regions identified using DUST (<xref rid="gkt919-B4" ref-type="bibr">4</xref>); (iv) retaining only one copy when two or more sequences are &#x0003e;95% identical (dereplication).</p><p>Metagenome gene prediction starts with the detection of CRISPR elements using CRT (<xref rid="gkt919-B5" ref-type="bibr">5</xref>) and PILERCR (<xref rid="gkt919-B6" ref-type="bibr">6</xref>). Predictions from both methods are concatenated, and in case of overlapping elements, the shorter one is removed. Identification of tRNAs is performed using tRNAScan-SE-1.23 (<xref rid="gkt919-B7" ref-type="bibr">7</xref>). A metagenome is a potential mixture of the three domains of life, so the program is run three times, one for each domain (<italic>Bacteria</italic>, <italic>Archaea, Eukaryota</italic>), with custom parameters for each. The best scoring predictions are then selected. Since the program cannot detect fragmented tRNAs at the ends of sequences, sequences are compared with a database of nt sequences of tRNAs identified in all isolate genomes (For sequences longer than 300 bp, only the first 150 bp and the last 150 bp are matched). Hits with high similarity (at least 85% identity and a minimum alignment length of 40) are kept. Protein-coding genes are identified using four <italic>ab initio</italic> gene calling tools: GeneMark (<xref rid="gkt919-B8" ref-type="bibr">8</xref>), Metagene (<xref rid="gkt919-B9" ref-type="bibr">9</xref>), Prodigal (<xref rid="gkt919-B10" ref-type="bibr">10</xref>) and FragGeneScan (<xref rid="gkt919-B11" ref-type="bibr">11</xref>). A majority rule-based decision system is followed to select protein-coding genes, which are then consolidated in terms of resolution of overlaps. In the event of an overlap between a protein-coding gene and an RNA gene or CRISPR element, the RNA gene or CRISPR element is retained, while allowing small 3&#x02032;-3&#x02032; overlaps between protein coding and RNA genes.</p><p>Metagenome protein-coding genes are compared with protein families and the proteome of selected publicly available &#x02018;core&#x02019; genomes, with product names assigned based on the results of these comparisons. First, protein sequences are compared with COG (<xref rid="gkt919-B12" ref-type="bibr">12</xref>) using RPS-BLAST and Pfam-A (<xref rid="gkt919-B13" ref-type="bibr">13</xref>) using HMMER 3. Metagenome protein-coding genes are associated with KEGG Orthology terms (<xref rid="gkt919-B14" ref-type="bibr">14</xref>), EC numbers and phylogeny using USEARCH (<xref rid="gkt919-B15" ref-type="bibr">15</xref>) similarity searches against a reference database consisting of all nonredundant protein sequences from the public genomes available in IMG and the KEGG database (<xref rid="gkt919-B14" ref-type="bibr">14</xref>). The integration of new metagenomes into IMG/M involves computing protein sequence similarities between their genes and genes of all reference genomes in the system and assigning protein product names to the genes of the new metagenomes based on their associated COGs or Pfams.</p></sec><sec><title>DATA CONTENT</title><sec><title>Metagenome and reference genome data</title><p>The number of metagenome data sets in IMG/M has increased substantially since the last published report on IMG/M (<xref rid="gkt919-B16" ref-type="bibr">16</xref>). The current version of IMG/M (as of September 10, 2013) contains 3328 metagenome data sets from 460 metagenome studies, with &#x0003e;19.5 billion protein coding genes [IMG/M contained 870 metagenome data sets from 227 studies with 163 million protein coding genes in October 2011 at the time the last published report on the system was prepared (<xref rid="gkt919-B16" ref-type="bibr">16</xref>)]. About 2093 metagenome data sets are publicly available to all users via the IMG/M datamart (<ext-link ext-link-type="uri" xlink:href="http://img.jgi.doe.gov/m">http://img.jgi.doe.gov/m</ext-link>). These data sets are organized using a habitat-based classification (<xref rid="gkt919-B17" ref-type="bibr">17</xref>) and include 80 engineered, 1144 environmental and 869 host-associated metagenomes (<xref ref-type="table" rid="gkt919-T1">Table 1</xref>).
<table-wrap id="gkt919-T1" position="float"><label>Table 1.</label><caption><p>Habitat-based metagenomic classification in IMG/M</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Engineered</th><th rowspan="1" colspan="1">80</th><th rowspan="1" colspan="1">Environmental</th><th rowspan="1" colspan="1">1144</th><th rowspan="1" colspan="1">Host-associated</th><th rowspan="1" colspan="1">869</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Bioremediation</td><td rowspan="1" colspan="1">17</td><td rowspan="1" colspan="1">Air</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">Arthropoda</td><td rowspan="1" colspan="1">53</td></tr><tr><td rowspan="1" colspan="1">Biotransformation</td><td rowspan="1" colspan="1">9</td><td rowspan="1" colspan="1">Aquatic</td><td rowspan="1" colspan="1">779</td><td rowspan="1" colspan="1">Birds</td><td rowspan="1" colspan="1">6</td></tr><tr><td rowspan="1" colspan="1">Solid waste</td><td rowspan="1" colspan="1">25</td><td rowspan="1" colspan="1">Terrestrial</td><td rowspan="1" colspan="1">363</td><td rowspan="1" colspan="1">Human</td><td rowspan="1" colspan="1">753</td></tr><tr><td rowspan="1" colspan="1">Wastewater</td><td rowspan="1" colspan="1">29</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">Mammals</td><td rowspan="1" colspan="1">18</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">Microbial</td><td rowspan="1" colspan="1">1</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">Mollusca</td><td rowspan="1" colspan="1">9</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">Plants</td><td rowspan="1" colspan="1">27</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">Porifera</td><td rowspan="1" colspan="1">2</td></tr></tbody></table></table-wrap></p><p>Metagenome data sets that have not been yet published (also known as &#x02018;private&#x02019;) are password protected and available only to the scientists who study (&#x02018;own&#x02019;) them through the IMG/M ER (&#x02018;Expert Review&#x02019;) datamart (<ext-link ext-link-type="uri" xlink:href="http://img.jgi.doe.gov/mer">http://img.jgi.doe.gov/mer</ext-link>). Private metagenome data sets are usually publicly released 12 months after they become available in IMG/M.</p><p>Metagenome data sets are integrated with IMG&#x02019;s set of publicly available reference genomes. The current version of IMG (as of September 10, 2013) contains &#x0003e;13 300 reference genomes consisting of 8761 bacterial, archaeal and eukaryotic genomes, as well as 2848 viral genomes, 1198 plasmids that did not come from a specific microbial genome sequencing project and 581 genome fragments, with &#x0223c;33 million protein-coding genes. Genomes generated as part of the Microbial Dark Matter project (<xref rid="gkt919-B18" ref-type="bibr">18</xref>), which aims to use single cell genomics to expand the Genomic Encyclopedia of Bacteria and Archaea (<xref rid="gkt919-B19" ref-type="bibr">19</xref>) by targeting single cell representatives of uncultured candidate phyla are of particular importance to the breadth of the reference set of genomes involved in metagenome analysis. The number of single-cell genomes available in IMG has increased from only 21 available in August 2011 to &#x0003e;1340 in September 2013.</p><p>A Human Microbiome Project (HMP) IMG/M data mart (<ext-link ext-link-type="uri" xlink:href="http://img.jgi.doe.gov/imgm_hmp">http://img.jgi.doe.gov/imgm_hmp</ext-link>) contains 748 metagenome data sets generated by sequencing samples collected from various body sites (airways, gastrointestinal, oral, skin, urogenital), as part of the HMP initiative (<xref rid="gkt919-B20" ref-type="bibr">20</xref>). In addition to the HMP-specific data sets, IMG/M contains &#x0003e;130 additional human-associated metagenome samples that are part of various studies. Metagenome and genome data sets in IMG/M-HMP are grouped both by body site category and by taxonomy, while metagenome data sets are also grouped according to the primary body site and human subjects sampled. HMP-specific analysis &#x02018;workflows&#x02019; are discussed in (<xref rid="gkt919-B21" ref-type="bibr">21</xref>).</p></sec><sec><title>Metatranscriptome data</title><p>The first metatranscriptomic (RNA-Seq) data sets were included into IMG/M in 2012, with IMG/M currently (as of August 2013) containing &#x0003e;160 samples across 16 RNASeq studies. Metatranscriptome studies are sequencing projects that have one or more samples associated with different conditions. A metatranscriptome study may be part of a systematic study with a metagenome counterpart or it may be an isolated study involving just the metatranscriptome. Samples undergo RNASeq sequencing analysis, where reads are mapped to the reference isolate or metagenome(s) described in the study, and the expressed genes in each sample are recorded with their observed reads count, mean, median and strand. Additionally, reads from every metatranscriptome are assembled <italic>de novo</italic>, and the assembly is annotated with the regular metagenome pipeline. Transcripts are then mapped onto this assembly. RNA reads are mapped to reference genomes/assemblies using Bowtie2 (<xref rid="gkt919-B22" ref-type="bibr">22</xref>). The scope of mapping is determined by the type of cDNA sample (sscDNA/dscDNA) and the directionality of the libraries, whereby reads may map to a single strand or both strands of the reference sequence. Expression levels are normalized by computing reads per kilobase per million quantile or affine transformations. For genomes involved in RNASeq studies, the experiments/samples are recorded in IMG together with experimental conditions, and the read counts are organized per expressed gene, as illustrated in <xref ref-type="fig" rid="gkt919-F1">Figure 1</xref>.
<fig id="gkt919-F1" position="float"><label>Figure 1.</label><caption><p>RNA-Seq data organization. (i) Metatranscriptomic (RNA-Seq) data sets can be accessed from &#x02018;IMG Statistics&#x02019; on IMG/M&#x02019;s front page, following the experiments link available on the &#x02018;IMG Statistics&#x02019; page. (ii) An RNA-Seq study is associated with a metagenome project (assembly onto which the RNA-Seq reads have been mapped) and a number of samples. (iii) RNA-Seq studies associated with a metagenome project can be accessed from its &#x02018;Microbiome Details&#x02019;, with each study associated with (iv) a list of RNA-Seq experiments (samples). Individual samples can be selected for further analysis, such as (v) examining its expressed genes as a list.</p></caption><graphic xlink:href="gkt919f1p"/></fig></p></sec></sec><sec><title>DATA ANALYSIS</title><p>Browsers and search tools allow finding and selecting metagenome samples, genomes, genes and functions of interest, which can then be examined individually or analyzed in a comparative context. The composition of analysis operations is facilitated by (meta)genome, scaffold, gene and function &#x02018;carts&#x02019; that handle lists of genomes, scaffolds, genes and functions, respectively. The phylogenetic composition of a metagenome sample is provided by computing the distribution of the best BLAST hits of the protein-coding genes in the sample against the reference genomes.</p><p>Function-based comparison of metagenome samples and genomes is provided by analysis tools that allow examining the relative abundance of protein families (COGs, Pfams, TIGRfams), functional families (enzymes) or functional categories (COG Pathway, KEGG Pathway, KEGG Pathway Category, Pfam Category) across metagenome samples and genomes. These comparisons take into account the stochastic nature of metagenome data sets and test whether differences in abundance can be ascribed to chance variation or not.</p><p>Metagenome analysis tools have been discussed in previous reports on IMG/M. The new metagenome analysis tools developed since the last published report on IMG/M (<xref rid="gkt919-B16" ref-type="bibr">16</xref>) are briefly reviewed below. These tools focus on handling substantially larger metagenome data sets, are available only to registered users as part of the &#x02018;My IMG&#x02019; toolkit, as illustrated in <xref ref-type="fig" rid="gkt919-F2">Figure 2</xref>(i), and support specifying, managing and analyzing persistent sets of genes, functions, genomes or metagenome samples and scaffolds.
<fig id="gkt919-F2" position="float"><label>Figure 2.</label><caption><p>Using workspace tools to analyze metagenome samples. (i) &#x02018;Workspace&#x02019; is part of the &#x02018;MyIMG&#x02019; toolkit and consists of user-specified &#x02018;Gene Sets&#x02019;, &#x02018;Genome Sets&#x02019;, &#x02018;Function Sets&#x02019; and &#x02018;Scaffold Sets&#x02019;, which can be created by (ii) transferring objects from the corresponding &#x02018;Carts&#x02019; or from the lists of objects retrieved by IMG analysis tools, such as similarity searches or &#x02018;Phylogenetic Distribution of Genes&#x02019;. (iii) &#x02018;Workspace&#x02019; supports profile operations between different sets of objects, with (iv) the results used to define new sets of genes and functions. (v) &#x02018;Workspace&#x02019; operations on sets of objects include union, intersection and subtraction, with the results saved as new sets of objects.</p></caption><graphic xlink:href="gkt919f2p"/></fig></p><p>Sets of genes, functions, genomes/metagenome samples and scaffolds can be specified using the &#x02018;Gene Cart&#x02019;, &#x02018;Function Cart&#x02019;, &#x02018;Genome Cart&#x02019; and &#x02018;Scaffold Cart&#x02019;, respectively. For example, two sets of metagenome samples are first specified using the &#x02018;Genome Cart&#x02019; and then saved as named files into a user-specific &#x02018;Workspace&#x02019;, as illustrated in <xref ref-type="fig" rid="gkt919-F2">Figure 2</xref>(ii).</p><p>Sets of genes, functions, genomes/metagenome samples and scaffolds can be exported from (downloaded) or imported (uploaded) into IMG&#x02019;s &#x02018;Workspace&#x02019;, and can be involved in set-based &#x02018;Function Profile&#x02019;, as illustrated in <xref ref-type="fig" rid="gkt919-F2">Figure 2</xref>(iii) where two sets of metagenome samples are compared in terms of a predefined set of (<italic>Arginine biosynthesis</italic>) COG functions. The &#x02018;Function Profile&#x02019; result shown in <xref ref-type="fig" rid="gkt919-F2">Figure 2</xref>(iv) displays the number of genes associated with a specific function (COG) in the function set, across all the samples in the set of metagenome samples. The genes associated with a specific function can be used to specify a new set of genes in the user&#x02019;s &#x02018;Workspace&#x02019;, as shown in the bottom part of <xref ref-type="fig" rid="gkt919-F2">Figure 2</xref>(iv). Set operations (intersection, union, difference) can be applied on sets of genes, functions, genomes and scaffolds, as illustrated in <xref ref-type="fig" rid="gkt919-F2">Figure 2</xref>(v) where union is applied on two sets of metagenome samples to create a new set of samples.</p><p>The workspace tools can be used for specifying metagenome or genome &#x02018;bins<bold>&#x02019;</bold> consisting of subsets of scaffolds. For example, single-cell genomes are typically screened for potential contamination, with scaffold sets used for separating &#x02018;contaminated&#x02019; scaffolds from &#x02018;clean&#x02019; scaffolds (<ext-link ext-link-type="uri" xlink:href="http://img.jgi.doe.gov/w/doc/SingleCellDataDecontamination.pdf">http://img.jgi.doe.gov/w/doc/SingleCellDataDecontamination.pdf</ext-link>). For metagenomes, scaffold sets can be used for specifying genomes detected within/isolated from a microbial community. A scaffold set can be converted into a Fasta file using the &#x02018;Workspace&#x02019; &#x02018;Data Export&#x02019; tool and then resubmitted for data annotation and integration into IMG as a new data set.</p><p>With the rapid growth of the number of genes in individual metagenome data sets, analysis operations may involve large sets (e.g. millions) of genes or a large number (e.g. hundreds) of scaffolds. Such operations require a long time (tens of minutes to hours) to complete, may time out in interactive mode, and therefore need to be executed off line as background computations. The mechanism for performing analysis operations as background computations is available as part of IMG&#x02019;s &#x02018;Workspace&#x02019; to IMG registered users. Background computations are supported for &#x02018;Gene Function Profile&#x02019;, &#x02018;Scaffold Function Profile&#x02019; and &#x02018;Scaffold Phylogenetic Distribution&#x02019; analyses, as illustrated in <xref ref-type="fig" rid="gkt919-F3">Figure 3</xref>.
<fig id="gkt919-F3" position="float"><label>Figure 3.</label><caption><p>Background computations support analysis involving large sets of genes, functions and scaffolds, which can be specified using &#x02018;Workspace&#x02019; (i) &#x02018;Gene Sets&#x02019;, (ii) &#x02018;Function Sets&#x02019; and &#x02018;Scaffold Sets&#x02019;. Thus, (iii) a &#x02018;Function Profile&#x02019; can be submitted as a background computation, whereby (iv) its status can be checked with &#x02018;MyJob&#x02019;. (v) For completed computations links are provided for accessing the analysis results, and (vii) associated details.</p></caption><graphic xlink:href="gkt919f3p"/></fig></p><p>For example, consider a function profile involving a gene set consisting of &#x0003e;64 000 human anterior microbiome genes, as illustrated in <xref ref-type="fig" rid="gkt919-F3">Figure 3</xref>(i), across a large number of COG and Pfam functions related to amino acid transport and metabolism, as illustrated in <xref ref-type="fig" rid="gkt919-F3">Figure 3</xref>(ii). After selecting the &#x02018;Human_Anterior&#x02019; gene set in the &#x02018;Gene Sets&#x02019; section of IMG&#x02019;s &#x02018;Workspace&#x02019;, &#x02018;Function Profile&#x02019; involving &#x02018;Amino_acid_transport&#x02019; as a function set is submitted as a background computation, as illustrated in <xref ref-type="fig" rid="gkt919-F3">Figure 3</xref>(iii).</p><p>The status of a background computation is provided via the &#x02018;MyJob&#x02019; section of the &#x02018;MyIMG&#x02019; menu option, as illustrated in <xref ref-type="fig" rid="gkt919-F3">Figure 3</xref>(iv). When a computation (e.g. job 2) is &#x02018;completed&#x02019;, as illustrated in <xref ref-type="fig" rid="gkt919-F3">Figure 3</xref>(v), links are provided for accessing the analysis results, as illustrated in <xref ref-type="fig" rid="gkt919-F3">Figure 3</xref>(vi), and associated details, as illustrated in <xref ref-type="fig" rid="gkt919-F3">Figure 3</xref>(vii). The results of background computations are saved until users either explicitly delete the jobs using the &#x02018;Delete&#x02019; option in the &#x02018;Computation Jobs&#x02019; page, or override them with new jobs using the &#x02018;Replace the selected job&#x02019; option.</p></sec><sec><title>FUTURE PLANS</title><p>The current version of IMG/M (as of August 24, 2013) contains 3308 metagenome data sets from 460 metagenome studies. These data sets can be analyzed in the context of &#x0003e;13 000 bacterial, archaeal, eukaryotic and virus reference genomes. New metagenome data sets are continuously included into IMG/M from metagenome studies conducted at JGI and other institutes, while new isolate reference genomes are included from IMG on a regular basis. The number of metatranscriptomics data sets included into IMG/M is expected to grow rapidly in the next 2 years, with metaproteomics data sets also becoming available.</p><p>IMG&#x02019;s maintenance involves continuously adjusting the underlying data management infrastructure to cope with the rapid increase in the number and size of the genome and metagenome data sets and to accommodate new data types. As we expect a steady growth in the number and size of metagenome data sets processed by and integrated into IMG/M, we continue to explore new data management techniques for organizing metagenome data sets and for providing support of effective metagenome data analysis.</p></sec><sec><title>FUNDING</title><p><funding-source>Director, Office of Science, Office of Biological and Environmental Research, Life Sciences Division, US Department of Energy</funding-source> under Contract No. [<award-id>DE-AC02-05CH11231</award-id>]. This research used resources of the <funding-source>National Energy Research Scientific Computing Center</funding-source>, which is supported by the <funding-source>Office of Science of the US Department of Energy</funding-source> under Contract No. [<award-id>DE-AC02-05CH11231</award-id>]. The IMG/M-HMP system is supported by the <funding-source>US National Institutes of Health Data Analysis and Coordination Center</funding-source> contract [<award-id>U01-HG004866</award-id>]. Funding for open access charge: University of California.</p><p><italic>Conflict of interest statement</italic>. None declared.</p></sec></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>The authors thank Shane Cannon and Seung-Jin Sul of Lawrence Berkeley National Lab&#x02019;s National Energy Research Scientific Computing Center (NERSC) for their help in developing the mechanism for background computations supporting metagenome analysis.</p></ack><ref-list><title>REFERENCES</title><ref id="gkt919-B1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markowitz</surname><given-names>VM</given-names></name><name><surname>Chen</surname><given-names>IA</given-names></name><name><surname>Palaniappan</surname><given-names>K</given-names></name><name><surname>Chu</surname><given-names>K</given-names></name><name><surname>Szeto</surname><given-names>E</given-names></name><name><surname>Pillay</surname><given-names>M</given-names></name><name><surname>Ratner</surname><given-names>A</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Hunteman</surname><given-names>M</given-names></name><name><surname>Anderson</surname><given-names>I</given-names></name><etal/></person-group><article-title>IMG 4 version of the integrated microbial genomes comparative analysis system</article-title><source>Nucleic Acids Res.</source><year>2013</year><comment>(in press)</comment></element-citation></ref><ref id="gkt919-B2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pagani</surname><given-names>I</given-names></name><name><surname>Liolios</surname><given-names>K</given-names></name><name><surname>Jansson</surname><given-names>J</given-names></name><name><surname>Chen</surname><given-names>IM</given-names></name><name><surname>Smirnova</surname><given-names>T</given-names></name><name><surname>Nosrat</surname><given-names>B</given-names></name><name><surname>Markowitz</surname><given-names>VM</given-names></name><name><surname>Kyrpides</surname><given-names>NC</given-names></name></person-group><article-title>The Genomes On Line Database (GOLD) v.4: status of genomic and metagenomic projects and their associated metadata</article-title><source>Nucleic Acids Res.</source><year>2012</year><volume>40</volume><fpage>D571</fpage><lpage>D579</lpage><pub-id pub-id-type="pmid">22135293</pub-id></element-citation></ref><ref id="gkt919-B3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Field</surname><given-names>D</given-names></name><name><surname>Garrity</surname><given-names>G</given-names></name><name><surname>Gray</surname><given-names>T</given-names></name><name><surname>Morrison</surname><given-names>N</given-names></name><name><surname>Selengut</surname><given-names>J</given-names></name><name><surname>Sterk</surname><given-names>P</given-names></name><etal/></person-group><article-title>Towards a richer description of our complete collection of genomes and metagenomes: the &#x02018;Minimum Information about a Genome Sequence&#x02019; (MIGS) specification</article-title><source>Nat. Biotechnol.</source><year>2008</year><volume>26</volume><fpage>541</fpage><lpage>547</lpage><pub-id pub-id-type="pmid">18464787</pub-id></element-citation></ref><ref id="gkt919-B4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morgulis</surname><given-names>A</given-names></name><name><surname>Gertz</surname><given-names>EM</given-names></name><name><surname>Schaffer</surname><given-names>AA</given-names></name><name><surname>Agarwala</surname><given-names>R</given-names></name></person-group><article-title>A fast and symmetric DUST implementation to mask low-complexity DNA sequences</article-title><source>J. Comput. Biol.</source><year>2006</year><volume>13</volume><fpage>1028</fpage><lpage>1040</lpage><pub-id pub-id-type="pmid">16796549</pub-id></element-citation></ref><ref id="gkt919-B5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bland</surname><given-names>C</given-names></name><name><surname>Ramsey</surname><given-names>TL</given-names></name><name><surname>Sabree</surname><given-names>F</given-names></name><name><surname>Lowe</surname><given-names>M</given-names></name><name><surname>Brown</surname><given-names>K</given-names></name><name><surname>Kyrpides</surname><given-names>NC</given-names></name><name><surname>Hugenholtz</surname><given-names>P</given-names></name></person-group><article-title>CRISPR Recognition Tool (CRT): a tool for automatic detection of clustered regularly interspaced palindromic repeats</article-title><source>BMC Bioinformatics</source><year>2007</year><volume>8</volume><fpage>209</fpage><pub-id pub-id-type="pmid">17577412</pub-id></element-citation></ref><ref id="gkt919-B6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>RC</given-names></name></person-group><article-title>PILER-CR: fast and accurate identification of CRISPR repeats</article-title><source>BMC Bioinformatics</source><year>2007</year><volume>8</volume><fpage>18</fpage><pub-id pub-id-type="pmid">17239253</pub-id></element-citation></ref><ref id="gkt919-B7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lowe</surname><given-names>TM</given-names></name><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group><article-title>tRNAscan-SE: a program for improved detection of transfer RNA genes in genomic sequence</article-title><source>Nucleic Acids Res.</source><year>1997</year><volume>25</volume><fpage>955</fpage><lpage>964</lpage><pub-id pub-id-type="pmid">9023104</pub-id></element-citation></ref><ref id="gkt919-B8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhu</surname><given-names>W</given-names></name><name><surname>Lomsadze</surname><given-names>A</given-names></name><name><surname>Borodovsky</surname><given-names>M</given-names></name></person-group><article-title><italic>Ab initio</italic> gene identification in metagenomic sequences</article-title><source>Nucleic Acids Res.</source><year>2010</year><volume>38</volume><fpage>e132</fpage><pub-id pub-id-type="pmid">20403810</pub-id></element-citation></ref><ref id="gkt919-B9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Noguchi</surname><given-names>H</given-names></name><name><surname>Park</surname><given-names>J</given-names></name><name><surname>Takagi</surname><given-names>T</given-names></name></person-group><article-title>MetaGene: prokaryotic gene finding from environmental genome shotgun sequences</article-title><source>Nucleic Acids Res.</source><year>2006</year><volume>34</volume><fpage>5623</fpage><lpage>5630</lpage><pub-id pub-id-type="pmid">17028096</pub-id></element-citation></ref><ref id="gkt919-B10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hyatt</surname><given-names>D</given-names></name><name><surname>Che</surname><given-names>GL</given-names></name><name><surname>LoCascio</surname><given-names>PF</given-names></name><name><surname>Land</surname><given-names>ML</given-names></name><name><surname>Larimer</surname><given-names>FW</given-names></name><name><surname>Hauser</surname><given-names>LJ</given-names></name></person-group><article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title><source>BMC Bioinformatics</source><year>2010</year><volume>11</volume><fpage>119</fpage><pub-id pub-id-type="pmid">20211023</pub-id></element-citation></ref><ref id="gkt919-B11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rho</surname><given-names>M</given-names></name><name><surname>Tang</surname><given-names>H</given-names></name><name><surname>Ye</surname><given-names>Y</given-names></name></person-group><article-title>FragGeneScan: predicting genes in short and error-prone reads</article-title><source>Nucleic Acids Res.</source><year>2010</year><volume>38</volume><fpage>e191</fpage><pub-id pub-id-type="pmid">20805240</pub-id></element-citation></ref><ref id="gkt919-B12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tatusov</surname><given-names>RL</given-names></name><name><surname>Fedorova</surname><given-names>ND</given-names></name><name><surname>Jackson</surname><given-names>JD</given-names></name><name><surname>Jacobs</surname><given-names>AR</given-names></name><name><surname>Kiryutin</surname><given-names>B</given-names></name><name><surname>Koonin</surname><given-names>EV</given-names></name><name><surname>Krylov</surname><given-names>DM</given-names></name><name><surname>Mazumder</surname><given-names>R</given-names></name><name><surname>Mekhedov</surname><given-names>SL</given-names></name><name><surname>Nikolskaya</surname><given-names>AN</given-names></name><etal/></person-group><article-title>The COG database: an updated version includes eukaryotes</article-title><source>BMC Bioinformatics</source><year>2003</year><volume>4</volume><fpage>41</fpage><pub-id pub-id-type="pmid">12969510</pub-id></element-citation></ref><ref id="gkt919-B13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Punta</surname><given-names>M</given-names></name><name><surname>Coggill</surname><given-names>PC</given-names></name><name><surname>Eberhardt</surname><given-names>RY</given-names></name><name><surname>Mistry</surname><given-names>J</given-names></name><name><surname>Tate</surname><given-names>J</given-names></name><name><surname>Boursnell</surname><given-names>C</given-names></name><name><surname>Pang</surname><given-names>N</given-names></name><name><surname>Forslund</surname><given-names>K</given-names></name><name><surname>Ceric</surname><given-names>G</given-names></name><name><surname>Celments</surname><given-names>J</given-names></name><etal/></person-group><article-title>The Pfam protein families database</article-title><source>Nucleic Acids Res.</source><year>2012</year><volume>40</volume><fpage>D290</fpage><lpage>D301</lpage><pub-id pub-id-type="pmid">22127870</pub-id></element-citation></ref><ref id="gkt919-B14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanehisa</surname><given-names>M</given-names></name><name><surname>Goto</surname><given-names>S</given-names></name><name><surname>Sato</surname><given-names>Y</given-names></name><name><surname>Furumichi</surname><given-names>M</given-names></name><name><surname>Tanabe</surname><given-names>M</given-names></name></person-group><article-title>KEGG for integration and interpretation of large scale molecular data sets</article-title><source>Nucleic Acids Res.</source><year>2012</year><volume>40</volume><fpage>D109</fpage><lpage>D114</lpage><pub-id pub-id-type="pmid">22080510</pub-id></element-citation></ref><ref id="gkt919-B15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>RC</given-names></name></person-group><article-title>Search and clustering orders of magnitude faster than BLAST</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>2460</fpage><lpage>2461</lpage><pub-id pub-id-type="pmid">20709691</pub-id></element-citation></ref><ref id="gkt919-B16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markowitz</surname><given-names>VM</given-names></name><name><surname>Chen</surname><given-names>IA</given-names></name><name><surname>Chu</surname><given-names>K</given-names></name><name><surname>Szeto</surname><given-names>E</given-names></name><name><surname>Palaniappan</surname><given-names>K</given-names></name><name><surname>Grechkin</surname><given-names>Y</given-names></name><name><surname>Ratner</surname><given-names>A</given-names></name><name><surname>Biju</surname><given-names>J</given-names></name><name><surname>Pati</surname><given-names>A</given-names></name><name><surname>Hunteman</surname><given-names>M</given-names></name><etal/></person-group><article-title>IMG/M: the integrated metagenome data management and comparative analysis system</article-title><source>Nucleic Acids Res.</source><year>2012</year><volume>40</volume><fpage>D123</fpage><lpage>D129</lpage><pub-id pub-id-type="pmid">22086953</pub-id></element-citation></ref><ref id="gkt919-B17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ivanova</surname><given-names>N</given-names></name><name><surname>Tringe</surname><given-names>SG</given-names></name><name><surname>Liolios</surname><given-names>K</given-names></name><name><surname>Liu</surname><given-names>WT</given-names></name><name><surname>Morrison</surname><given-names>N</given-names></name><name><surname>Hugenholtz</surname><given-names>P</given-names></name><name><surname>Kyrpides</surname><given-names>NC</given-names></name></person-group><article-title>A call for standardized classification of metagenome projects</article-title><source>Environ. Microbiol.</source><year>2010</year><volume>12</volume><fpage>1803</fpage><lpage>1805</lpage><pub-id pub-id-type="pmid">20653767</pub-id></element-citation></ref><ref id="gkt919-B18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rinke</surname><given-names>C</given-names></name><name><surname>Schwientek</surname><given-names>P</given-names></name><name><surname>Sczyrba</surname><given-names>A</given-names></name><name><surname>Ivanova</surname><given-names>NN</given-names></name><name><surname>Anderson</surname><given-names>IJ</given-names></name><name><surname>Cheng</surname><given-names>JF</given-names></name><name><surname>Darling</surname><given-names>A</given-names></name><name><surname>Malfatti</surname><given-names>S</given-names></name><name><surname>Swan</surname><given-names>BK</given-names></name><name><surname>Gies</surname><given-names>EA</given-names></name><etal/></person-group><article-title>Insights into the phylogeny and coding potential of microbial dark matter</article-title><source>Nature</source><year>2013</year><volume>499</volume><fpage>431</fpage><lpage>437</lpage><pub-id pub-id-type="pmid">23851394</pub-id></element-citation></ref><ref id="gkt919-B19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>D</given-names></name><name><surname>Hugenholtz</surname><given-names>P</given-names></name><name><surname>Mavromatis</surname><given-names>K</given-names></name><name><surname>Pukall</surname><given-names>R</given-names></name><name><surname>Dalin</surname><given-names>E</given-names></name><name><surname>Ivanova</surname><given-names>NN</given-names></name><name><surname>Kunin</surname><given-names>V</given-names></name><name><surname>Goodwin</surname><given-names>L</given-names></name><name><surname>Wu</surname><given-names>M</given-names></name><name><surname>Tindall</surname><given-names>BJ</given-names></name><etal/></person-group><article-title>A phylogeny-driven genomic encyclopaedia of Bacteria and Archaea</article-title><source>Nature</source><year>2009</year><volume>462</volume><fpage>1056</fpage><lpage>1060</lpage><pub-id pub-id-type="pmid">20033048</pub-id></element-citation></ref><ref id="gkt919-B20"><label>20</label><element-citation publication-type="journal"><collab>The Human Microbiome Consortium</collab><article-title>A framework for human microbiome research</article-title><source>Nature</source><year>2012</year><volume>486</volume><fpage>215</fpage><lpage>221</lpage><pub-id pub-id-type="pmid">22699610</pub-id></element-citation></ref><ref id="gkt919-B21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Markowitz</surname><given-names>VM</given-names></name><name><surname>Chen</surname><given-names>IM</given-names></name><name><surname>Chu</surname><given-names>K</given-names></name><name><surname>Szeto</surname><given-names>E</given-names></name><name><surname>Palaniappan</surname><given-names>K</given-names></name><name><surname>Jacob</surname><given-names>B</given-names></name><name><surname>Ratner</surname><given-names>A</given-names></name><name><surname>Liolios</surname><given-names>K</given-names></name><name><surname>Pagani</surname><given-names>I</given-names></name><name><surname>Hunteman</surname><given-names>M</given-names></name><etal/></person-group><article-title>IMG/M-HMP: a metagenome comparative analysis system for the human microbiome project</article-title><source>PLoS One</source><year>2012</year><volume>7</volume><fpage>e40151</fpage><pub-id pub-id-type="pmid">22792232</pub-id></element-citation></ref><ref id="gkt919-B22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B</given-names></name><name><surname>Salzberg</surname><given-names>SI</given-names></name></person-group><article-title>Fast gapped-read alignment with Bowtie 2</article-title><source>Nat. Methods</source><year>2012</year><volume>9</volume><fpage>357</fpage><lpage>359</lpage><pub-id pub-id-type="pmid">22388286</pub-id></element-citation></ref></ref-list></back></article>