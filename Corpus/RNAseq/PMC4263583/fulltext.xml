<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Biosensors (Basel)</journal-id><journal-id journal-id-type="iso-abbrev">Biosensors (Basel)</journal-id><journal-id journal-id-type="publisher-id">Biosensors</journal-id><journal-title-group><journal-title>Biosensors</journal-title></journal-title-group><issn pub-type="epub">2079-6374</issn><publisher><publisher-name>MDPI</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4263583</article-id><article-id pub-id-type="doi">10.3390/bios3030238</article-id><article-id pub-id-type="publisher-id">biosensors-03-00238</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>A Comparison of Methods for RNA-Seq Differential Expression Analysis and a New Empirical Bayes Approach</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Wesolowski</surname><given-names>Sergiusz</given-names></name><xref ref-type="aff" rid="af1-biosensors-03-00238">1</xref></contrib><contrib contrib-type="author"><name><surname>Birtwistle</surname><given-names>Marc R.</given-names></name><xref ref-type="aff" rid="af2-biosensors-03-00238">2</xref></contrib><contrib contrib-type="author"><name><surname>Rempala</surname><given-names>Grzegorz A.</given-names></name><xref ref-type="aff" rid="af3-biosensors-03-00238">3</xref><xref ref-type="corresp" rid="c1-biosensors-03-00238">*</xref></contrib></contrib-group><aff id="af1-biosensors-03-00238"><label>1</label>Department of Mathematics, Florida State University, Tallahassee, FL 32306, <country>USA</country>; E-Mail: <email>wesserg@gmail.com</email></aff><aff id="af2-biosensors-03-00238"><label>2</label>Department of Pharmacology and Systems Therapeutics, Mount Sinai School of Medicine, New York, NY 10029, 
<country>USA</country>; E-Mail: <email>marc.birtwistle@mssm.edu</email></aff><aff id="af3-biosensors-03-00238"><label>3</label>Division of Biostatistics, The Ohio State University, Columbus, OH 43210, 
<country>USA</country></aff><author-notes><corresp id="c1-biosensors-03-00238"><label>*</label>Author to whom correspondence should be addressed; E-Mail: <email>grempala@cph.osu.edu</email>.</corresp></author-notes><pub-date pub-type="collection"><month>9</month><year>2013</year></pub-date><pub-date pub-type="epub"><day>28</day><month>6</month><year>2013</year></pub-date><volume>3</volume><issue>3</issue><fpage>238</fpage><lpage>258</lpage><history><date date-type="received"><day>12</day><month>5</month><year>2013</year></date><date date-type="rev-recd"><day>09</day><month>6</month><year>2013</year></date><date date-type="accepted"><day>12</day><month>6</month><year>2013</year></date></history><permissions><copyright-statement>&#x000a9; 2013 by the authors; licensee MDPI, Basel, Switzerland</copyright-statement><copyright-year>2013</copyright-year><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/3.0/"><license-p><!--CREATIVE COMMONS-->This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution license (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</ext-link>).</license-p></license></permissions><abstract><p>Transcriptome-based biosensors are expected to have a large impact on the future of biotechnology. However, a central aspect of transcriptomics is differential expression analysis, where, currently, deep RNA sequencing (RNA-seq) has the potential to replace the microarray as the standard assay for RNA quantification. Our contributions here to RNA-seq differential expression analysis are two-fold. First, given the high cost of an RNA-seq run, biological replicates are rare, and therefore, information sharing across genes to obtain variance estimates is crucial. To handle such information sharing in a rigorous manner, we propose an hierarchical, empirical Bayes approach (R-EBSeq) that combines the Cufflinks model for generating relative transcript abundance measurements, known as FPKM (fragments per kilobase of transcript length per million mapped reads) with the EBArrays framework, which was previously developed for empirical Bayes analysis of microarray data. A desirable feature of R-EBSeq is easy-to-implement analysis of more than pairwise comparisons, as we illustrate with experimental data. Secondly, we develop the standard RNA-seq test data set, on the level of reads, where 79 transcripts are artificially differentially expressed and, therefore, explicitly known. This test data set allows us to compare the performance, in terms of the true discovery rate, of R-EBSeq to three other widely used RNAseq data analysis packages: Cuffdiff, DEseq and BaySeq. Our analysis indicates that DESeq identifies the first half of the differentially expressed transcripts well, but then is outperformed by Cuffdiff and R-EBSeq. Cuffdiff and R-EBSeq are the two top performers. Thus, R-EBSeq offers good performance, while allowing flexible and rigorous comparison of multiple biological conditions.</p></abstract><kwd-group><kwd>next-generation sequencing</kwd><kwd>empirical Bayes</kwd><kwd>gene expression data</kwd></kwd-group></article-meta></front><body><sec sec-type="intro"><label>1.</label><title>Introduction</title><p>Next generation sequencing generally refers to the massively parallel identification of the bases that make up nucleotide sequences and has revolutionized the way we can look at biology. Obtaining the sequence of a human genome once cost on the order of $100,000,000 dollars and took years; now, with next generation sequencing techniques, we obtain such a sequence for on the order of $10,000 to $1,000 in days/weeks [<xref rid="b1-biosensors-03-00238" ref-type="bibr">1</xref>,<xref rid="b2-biosensors-03-00238" ref-type="bibr">2</xref>,<xref rid="b3-biosensors-03-00238" ref-type="bibr">3</xref>,<xref rid="b4-biosensors-03-00238" ref-type="bibr">4</xref>,<xref rid="b5-biosensors-03-00238" ref-type="bibr">5</xref>]. This rate of cost decrease is amazingly exceeding that of Moore&#x02019;s law for semiconductors [<xref rid="b5-biosensors-03-00238" ref-type="bibr">5</xref>].</p><p>One application of next generation sequencing is transcriptomics, where an entire set of mRNAs is sequenced [<xref rid="b6-biosensors-03-00238" ref-type="bibr">6</xref>,<xref rid="b7-biosensors-03-00238" ref-type="bibr">7</xref>]. This application is known as RNA-seq, and the process, from cells to data and differential expression analysis, may be thought of as a pipeline, as shown in <xref rid="f1-biosensors-03-00238" ref-type="fig">Figure 1</xref>. Although a wide variety of next generation sequencing platforms exist, they are generally based on slight variations of this core pipeline.</p><fig id="f1-biosensors-03-00238" position="float"><label>Figure 1</label><caption><p>The RNA-seq pipeline. This schematic illustrates the process of going from cells to RNA-seq data, with potential sources of bias and variability noted along the way. See the Introduction for details.</p></caption><graphic xlink:href="biosensors-03-00238-g001"/></fig><p>The process, of course, starts with cells, from which mRNA is extracted. Note that, due to the biological variability, the extracted mRNA levels may differ considerably among different biological samples. Then, a so-called library is created from the isolated mRNA. The library typically consists of nucleic acid fragments, but can also consist of full-length nucleic acid molecules [<xref rid="b2-biosensors-03-00238" ref-type="bibr">2</xref>,<xref rid="b8-biosensors-03-00238" ref-type="bibr">8</xref>]. It is this library that is the direct input to the next generation sequencer. During library generation, the samples are subject to both fragmentation and amplification variability and bias [<xref rid="b2-biosensors-03-00238" ref-type="bibr">2</xref>,<xref rid="b9-biosensors-03-00238" ref-type="bibr">9</xref>]. Because the library generation protocol is sequencing platform-specific, these forms of variability and bias will be platform-dependent (and, even, non-existent in some cases).</p><p>A subset of the library molecules is then sequenced, producing what are called reads or DNA sequences. Because only a subset of the library molecules is chosen for sequencing, there is variability and potential bias in the selection process [<xref rid="b9-biosensors-03-00238" ref-type="bibr">9</xref>]. Furthermore, due to the nature of the sequencing process, the identity of each nucleotide in the read is only known in a probabilistic sense, resulting in variability and bias, due to base-calling errors [<xref rid="b2-biosensors-03-00238" ref-type="bibr">2</xref>].</p><p>With this sample of reads, one can either align them to a reference genome or perform a <italic>de novo</italic> assembly and, subsequently, count the number of reads that align to particular genes. Such aligned reads are also termed mapped reads. Regardless of which of these two are done (alignment or assembly); however, there will inevitably be uncertainty in assigning a read to a particular gene; a single read may well align to multiple genes.</p><p>Some researchers consider these count data to be the final product of an RNA-seq experiment. However, such count data are not usually linearly proportional to the original number of full length transcripts for two main reasons. First, longer transcripts generate more reads simply due to their length. Second, because a single gene typically codes for multiple transcripts with different lengths, a gene&#x02019;s expression in terms of the expected number of counts may remain constant even while the number of transcripts being produced from that gene changes. Moreover, since one eventually wants to compare the results of two or more different sequencing runs, it is also necessary to correct for the total sequencing depth, which is related to how large the subset of the sequenced library molecules is. These reasons are why many people take an additional step to transform these gene counts to units of reads (R) or fragments (F) per kilobase of transcript length per million mapped reads (RPKM or FPKM), which are linearly proportional to original transcript levels [<xref rid="b6-biosensors-03-00238" ref-type="bibr">6</xref>,<xref rid="b7-biosensors-03-00238" ref-type="bibr">7</xref>].</p><p>Finally, one can assign an FPKM value to each individual transcript for every gene. This transcript assignment process also introduces uncertainty, because only reads that happen to contain exons or exon-exon boundaries that are unique to particular transcripts can inform this transcript assignment process and such reads may be rare [<xref rid="b7-biosensors-03-00238" ref-type="bibr">7</xref>]. It is with these FPKM data for individual transcripts that we would like to perform differential expression analysis.</p><p>In what follows, we first analyze the RNA-seq process described by <xref rid="f1-biosensors-03-00238" ref-type="fig">Figure 1</xref> in a statistical sense, to determine how it may be best modeled. Next, we propose a new empirical Bayes framework for differential expression testing, which uses the well-known and established Cufflinks software [<xref rid="b7-biosensors-03-00238" ref-type="bibr">7</xref>,<xref rid="b9-biosensors-03-00238" ref-type="bibr">9</xref>] to generate FPKM measurements, and, subsequently, couples to a modified version of the EBArrays framework, which was originally developed for microarray data analysis [<xref rid="b10-biosensors-03-00238" ref-type="bibr">10</xref>,<xref rid="b11-biosensors-03-00238" ref-type="bibr">11</xref>]. The advantages of this so-called R-EBSeq approach are (1) a rigorous treatment of information sharing across genes, which allows for better variance estimates, given the fact that one rarely has biological replicates, due to cost considerations; and (2) the ability to do simultaneous differential expression comparisons with arbitrary many expression patterns. Unlike another EBArrays-based method for the RNA-seq analysis [<xref rid="b12-biosensors-03-00238" ref-type="bibr">12</xref>], ours works with FPKM measurements, which seem more appropriate for the across-gene information-sharing framework of EBArrays. To illustrate the advantages of our approach, we compare R-EBSeq method with three other established differential expression methods: FPKM-based Cuffdiff and count-based DESeq and BaySeq [<xref rid="b7-biosensors-03-00238" ref-type="bibr">7</xref>,<xref rid="b9-biosensors-03-00238" ref-type="bibr">9</xref>,<xref rid="b13-biosensors-03-00238" ref-type="bibr">13</xref>,<xref rid="b14-biosensors-03-00238" ref-type="bibr">14</xref>].</p></sec><sec sec-type="methods"><label>2.</label><title>Methods</title><sec><label>2.1.</label><title>EBarrays</title><p>The method developed in [<xref rid="b10-biosensors-03-00238" ref-type="bibr">10</xref>,<xref rid="b11-biosensors-03-00238" ref-type="bibr">11</xref>] characterizes the distribution of expression measurements for a single gene (or transcript) in a certain condition. Here, we present a brief overlook of the idea behind the framework and how we adapt it to our problem. Similar empirical-based approach, but for count-based RNA-seq analysis, has been recently developed in [<xref rid="b12-biosensors-03-00238" ref-type="bibr">12</xref>]. We refer to their software documentation for additional EBArrays model details.</p><p>Let <italic>j</italic> indicate <italic>j</italic>-th transcript and <bold>x</bold><sub>j</sub> = <italic>x<sub>j</sub></italic><sub>1</sub>,...,<italic>x<sub>jI</sub></italic> be the expressions in the particular condition denoted: <italic>x</italic>, where <italic>I</italic> is the number of expression measurements we can take in this condition. The method treats <bold>x<sub>j</sub></bold> as a random sample with a transcript- and condition-specific mean. Thus, we have that <italic>X<sub>ij</sub>|&#x003bc;<sub>j</sub></italic> are iid with a pdf given as <italic>f</italic><sub><italic>X</italic><sub><italic>ij</italic></sub><italic>|&#x003bc;</italic><sub><italic>j</italic></sub></sub> (<italic>x<sub>ij</sub></italic>). To allow information sharing among all transcripts and conditions, a prior distribution, <italic>&#x003c0;</italic>, is assumed on <italic>&#x003bc;<sub>j</sub></italic>.</p><p>In a simple setting, if we investigate differences in expression between only two conditions, the index set {1,...,<italic>I</italic>} is partitioned into two subsets, <italic>s</italic><sub>1</sub><italic>,s</italic><sub>2</sub>, each containing indices for a corresponding condition (<bold>x</bold><italic><sub>j</sub></italic> = (<bold>x</bold><sub><italic>js</italic><sub>1</sub></sub>, <bold>x</bold><sub><italic>js</italic><sub>2</sub></sub>)). For each transcript, we aim to investigate a null hypothesis that assumes equivalent expression (<italic>EE<sub>j</sub></italic>) among conditions, against the alternative that a transcript is differentially expressed (<italic>DE<sub>j</sub></italic>) in one of conditions.</p><p>The pdf in each expression pattern (&#x02019;EE&#x02019; or &#x02019;DE&#x02019;) can be written as follows:</p><p><italic>EE<sub>j</sub></italic>:
<disp-formula id="FD1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p><italic>DE<sub>j</sub></italic>:
<disp-formula id="FD2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Let <italic>p</italic> and 1 <italic>&#x02212; p</italic> denote the fraction of all genes that are differentially expressed and equivalently expressed among conditions. Then, the pdf for <bold>x</bold><italic><sub>j</sub></italic> takes the following form:
<disp-formula id="FD3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>X</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Using Bayes&#x02019; formula, we can write the pdfs for each hypothesis:
<disp-formula id="FD4"><label>(4)</label><mml:math id="m4"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">DE</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD5"><label>(5)</label><mml:math id="m5"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>The form of both the conditional distribution of <italic>x<sub>j</sub></italic> and its conjugate prior to the mean are usually known. EBarrays uses the EM algorithm to compute the estimates of parameters for both distributions, as well as mixing proportions of genes supporting the investigated hypothesis.</p><p>This method is easily generalized for more than two expression patterns. A pattern corresponding to the null hypothesis, where each sample has the same underlying mean, is always distinguished. Consider <italic>m</italic> DE patterns, which yield a total of <italic>m</italic>+1 patterns (including the null pattern&#x02014;Equivalent Expression).</p><p>The formula for the marginal distribution of <bold>x<sub>j</sub></bold>, corresponding to <xref ref-type="disp-formula" rid="FD3">Equation (3)</xref>, is:
<disp-formula id="FD6"><label>(6)</label><mml:math id="m6"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <italic>f<sub>k</sub></italic> is density corresponding to the <italic>k</italic>-th pattern, as in [<xref rid="b10-biosensors-03-00238" ref-type="bibr">10</xref>], and <italic>p<sub>k</sub></italic> is the fraction of genes supporting the corresponding pattern (hypothesis). Consequently, the posterior probability of expression pattern, <italic>k</italic>, for gene, <italic>j</italic>, is:
<disp-formula id="FD7"><label>(7)</label><mml:math id="m7"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p></sec><sec><label>2.2.</label><title>EBarrays Model for Cufflinks-Processed Data</title><p>Usually, Cufflinks-processed data does not have replicates. To use the EBarray framework, replicates need to be generated from the Cufflinks-specified normal distribution [<xref rid="b7-biosensors-03-00238" ref-type="bibr">7</xref>] for gene- or transcript-specific FPKM values (see below for discussion of normal approximation). They are then fed into EBarrays. The number of replicates to use is a free parameter of R-EBSeq, and its effect of differential expression analysis is explored in the main text. Since expression measurements approximately follow a normal distribution, the conjugate prior distribution for means is also normal. Thus, it is natural to assume a normal-normal model for the EBarrays estimation procedure:
<disp-formula id="FD8"><label>(8)</label><mml:math id="m8"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>In this setting, <italic>&#x003c0;</italic> &#x0223c; <italic>N</italic>(<italic>&#x003bc;</italic><sub>0</sub><italic>,&#x003c4;</italic><sub>0</sub>) and an <italic>n</italic>-dimensional input for gene <italic>j</italic>, after evaluating the integral as detailed in [<xref rid="b11-biosensors-03-00238" ref-type="bibr">11</xref>], follows a marginal pdf, <italic>f</italic>, which is the pdf of a normal distribution with mean, <italic>&#x003bc;</italic> = (<italic>&#x003bc;</italic><sub>0</sub>,...,<italic>&#x003bc;</italic><sub>0</sub>), and covariance matrix:
<disp-formula id="FD9"><label>(9)</label><mml:math id="m9"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003a3;</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x1d540;</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></disp-formula>where &#x1d540;<italic><sub>n&#x000d7;n</sub></italic> is an identity matrix and <italic>M<sub>n&#x000d7;n</sub></italic> is a matrix of ones.</p><p>We adapted the EBarrays R code to account for the normal-normal model with modified variances by modifying the previously built-in LNNMV model (available as <xref ref-type="supplementary-material" rid="biosensors-03-00238-s001">Supplemental File</xref>). This normal-normal model with modified variances code was created using the tools provided in EBarrays R package [<xref rid="b10-biosensors-03-00238" ref-type="bibr">10</xref>,<xref rid="b11-biosensors-03-00238" ref-type="bibr">11</xref>].</p></sec><sec><label>2.3.</label><title>Justification for a Normal Distribution Model for Transcript Abundances A<sub>t</sub></title><p>According to <xref ref-type="disp-formula" rid="FD15">Equation (15)</xref>, the transcript abundance, <italic>&#x000c2;<sub>t</sub></italic>, is a product of two maximal likelihood estimates and is approximated in the model by a Gaussian variate. Here, we derive a brief justification, which works for any products of asymptotically Gaussian estimators. Consider two parameters, <italic>&#x003b8;</italic> and <italic>&#x003b7;</italic>, with their respective estimates, <italic>&#x003b8;&#x00302;<sub>n</sub></italic> and <italic>&#x003b7;&#x00302;<sub>n</sub></italic>, which satisfy jointly the multivariate CLT, that is, as <italic>n</italic> &#x02192; <italic>&#x0221e;</italic>
<disp-formula><mml:math id="m10"><mml:mrow><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02192;</mml:mo><mml:mi>B</mml:mi><mml:mi>V</mml:mi><mml:mi>&#x02009;</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003c1;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>in distribution, where <italic>BV N</italic>(0,<italic>&#x003c3;</italic><sub>1</sub>,<italic>&#x003c3;</italic><sub>2</sub>,<italic>&#x003c1;</italic>) is a bivariate normal random variate with zero marginal means, marginal standard deviations, <italic>&#x003c3;</italic><sub>1</sub> and <italic>&#x003c3;</italic><sub>2</sub>, and the correlation coefficient, <italic>&#x003c1;</italic>. In the case of the abundance model, <italic>A<sub>t</sub></italic> considered in the paper, the vector, (<italic>&#x003b8;&#x00302;<sub>n</sub></italic>, <italic>&#x003b7;&#x00302;<sub>n</sub></italic>) = (<italic>&#x00058;&#x00302;<sub>g</sub>, &#x003b3;&#x00302;<sub>t</sub></italic>), is a joined MLE and the convergence above follows from the general theory of the likelihood-based estimation (see, e.g., [<xref rid="b15-biosensors-03-00238" ref-type="bibr">15</xref>] Chapter 4), where, now, <italic>n</italic> stands for the sampling depth (or the overall number of transcripts). Since
<disp-formula><mml:math id="m11"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mi>&#x003b7;</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mi>&#x003b7;</mml:mi><mml:mo>-</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>and <italic>&#x003b7;&#x00302;<sub>n</sub></italic> &#x02192; <italic>&#x003b7;</italic> in probability, therefore, due to Slutsky&#x02019;s theorem (see, e.g., [<xref rid="b15-biosensors-03-00238" ref-type="bibr">15</xref>] chapter 1), we see that in distribution,
<disp-formula><mml:math id="m12"><mml:mrow><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02192;</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>where <italic>N</italic>(0,<italic>&#x003b3;</italic>) is a zero mean normal variate with the standard deviation, <italic>&#x003b3;</italic>, such that
<disp-formula><mml:math id="m13"><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>&#x003b7;</mml:mi><mml:mi>&#x003b8;</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mi>&#x003c1;</mml:mi></mml:mrow></mml:math></disp-formula></p></sec><sec><label>2.4.</label><title>Simulating Data Sets for Use with R-EBSeq</title><p>In order to evaluate the performance of our method, we investigated its ROC plots for several different parameter settings under the normal-normal model assumption. The control dataset was created by generating a 1, 000 <italic>&#x000d7; n</italic> measurement matrix, according to the Normal-Normal model&#x02014;reflecting 1,000 transcripts under one condition with <italic>n</italic> replicates. The number of replicates is also referred to as the sample size.</p><p>The treatment dataset was created in the same way, but expression values for 10% of the transcripts (randomly chosen) were generated with altered parameters in order to simulate the differential expression. Only over-expression was considered.</p><p>To make the simulations as close to real data as possible, the parameters in the control setting (the mean and the variance) for the generation from the normal-normal model were taken from real data (we have chosen a fixed sample of 1, 000 transcripts from Cufflinks-processed yeast data [<xref rid="b16-biosensors-03-00238" ref-type="bibr">16</xref>]).</p><p>The following three settings were investigated:
<list list-type="simple"><list-item><p><bold>Mean difference in expression:</bold>
<list list-type="simple"><list-item><p>Fixed: variance&#x02014;taken from Cufflinks, sample size: 10</p></list-item><list-item><p>Investigated: influence of difference in expression in 10% of transcripts (&#x0201c;treatment&#x0201d; group). Different levels of differential expression were generated according to the following: 5% of transcripts had <italic>x</italic> mean difference, and the remaining 5% had 2<italic>x</italic> mean difference in expression from the &#x0201c;control&#x0201d; group. The value of <italic>x</italic> was varied from 0, 5, 10,..., 50, and these different values yield ten ROCs visible in <xref rid="f2-biosensors-03-00238" ref-type="fig">Figure 2</xref>(A).</p></list-item></list></p></list-item><list-item><p><bold>Variance:</bold>
<list list-type="simple"><list-item><p>Fixed: mean difference in expression for DE pattern: 5% of transcripts: 50, 5% of transcripts: 100. Sample size: 10</p></list-item><list-item><p>Investigated: influence of variance. For the whole &#x0201c;treatment&#x0201d; dataset, we created the ROCs for different additional variance levels. The cufflinks variance was increased by <italic>x</italic> &#x02208;{0, 5,..., 50}, yielding 10 ROCs in <xref rid="f2-biosensors-03-00238" ref-type="fig">Figure 2</xref>(B).</p></list-item></list></p></list-item><list-item><p><bold>Sample size:</bold>
<list list-type="simple"><list-item><p>Fixed: Mean difference in expression for DE pattern: 5% of transcripts 50, 5% of transcripts 100. Variance: Cufflinks variance</p></list-item><list-item><p>Investigated: Influence of the sample size. The sample size <italic>n</italic> was investigated at 10 values: <italic>n</italic> &#x02208; {2, 4,..., 22}, each corresponding to a line in <xref rid="f2-biosensors-03-00238" ref-type="fig">Figure 2</xref>(C).</p></list-item></list></p></list-item></list></p><fig id="f2-biosensors-03-00238" position="float"><label>Figure 2</label><caption><p>Relative operating characteristic curves (ROC) for the R-EBSeq Method. The false positive rate (FPR) is plotted <italic>vs.</italic> the true positive rate (TPR). Test data sets were generated as described in Methods. Effects of <bold>(A)</bold> the difference of means between two conditions; <bold>(B)</bold> transcript variance; or <bold>(C)</bold> the number of replicates, <italic>M</italic>, on the performance of R-EBSeq.</p></caption><graphic xlink:href="biosensors-03-00238-g002"/></fig></sec><sec><label>2.5.</label><title>Generating an RNA-Seq Benchmark Dataset for Comparing Various Differential Expression Testing Methods</title><p>In order to make comparisons between methods, we needed a benchmark dataset that would provide a common base for all methods. To ensure similarity with experimental conditions, we started with real data published in [<xref rid="b13-biosensors-03-00238" ref-type="bibr">13</xref>,<xref rid="b16-biosensors-03-00238" ref-type="bibr">16</xref>]. The control (sam file format) dataset is Tophat processed SRA output [<xref rid="b7-biosensors-03-00238" ref-type="bibr">7</xref>]. For annotation, we used a GTF file provided by a UCSC database, and to facilitate a direct comparison of various software packages operating on transcript or gene level, we only included in the modified dataset transcripts matching uniquely to particular genes.</p><p>The treatment (sam file format) dataset was created by first randomly choosing 100 reads from the control (sam) file. Each of those reads was replicated a number of times corresponding to its order: the first read was copied once, the second twice, and so on, until the 100th was copied 100 times.</p><p>To retrieve count datasets for DESeq and BaySeq methods, the created control and treatment files (sam file format) have to be further processed. We used the HTSeq software [<xref rid="b17-biosensors-03-00238" ref-type="bibr">17</xref>] recommended for DESeq, with default settings. To ensure that all methods will be capable of detecting replicated reads, we have been choosing only reads that had NH:i:1 flag in the sam file, which indicates unique mapping to a particular transcript [<xref rid="b18-biosensors-03-00238" ref-type="bibr">18</xref>].</p><p>The final step of creating the datasets was adding different level of noise to the reads, as described in the following section.</p></sec><sec><label>2.6.</label><title>Adding Noise to the RNA-Seq Benchmark Dataset</title><p>For the benchmark datasets, to reflect real data, we are adding noise to the RNA-seq data by considering separately reads mapping uniquely to gene, <italic>g</italic>. For each read in this subset, we replicate this read <italic>y<sub>g</sub></italic> times, where <italic>y<sub>g</sub></italic> is taken from a negative binomial distribution, that is, <italic>y<sub>g</sub></italic>
<italic>&#x0223c;</italic>
<italic>NB</italic>(<italic>r<sub>g</sub>, p<sub>g</sub></italic>). The new noisy number of reads for a particular gene, <italic>X<sub>g</sub></italic>, given that this gene had <italic>N</italic> original reads, is therefore given as:
<disp-formula id="FD10"><label>(10)</label><mml:math id="m14"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula></p><p>It is well-known that a sum of independent negative binomial random variables is itself negative binomially distributed, with a new <italic>r</italic> parameter that is equal to the sum of the individual <italic>r</italic> parameters. Therefore:
<disp-formula id="FD11"><label>(11)</label><mml:math id="m15"><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>&#x02261;</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Given this, along with the properties of expected values and variances of random variables, we have the following:
<disp-formula id="FD12"><label>(12)</label><mml:math id="m16"><mml:mrow><mml:mi mathvariant="italic">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">Nr</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD13"><label>(13)</label><mml:math id="m17"><mml:mrow><mml:mi mathvariant="italic">Var</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>It can be shown that when <italic>Var</italic>(<italic>X<sub>g</sub></italic>) = <italic>E</italic>(<italic>X<sub>g</sub></italic>):
<disp-formula id="FD14"><label>(14)</label><mml:math id="m18"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x02261;</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="italic">Var</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula></p><p>Thus, given this negative binomial noise generation model, we can determine the mean and then choose <italic>r<sub>g</sub></italic>
<italic>&#x0003c; r<sub>c</sub></italic> for underdispersion or <italic>r<sub>g</sub></italic>
<italic>&#x0003e;r<sub>c</sub></italic> for overdispersion. Because RNA-Seq data are typically overdispersed (<italic>Var</italic>(<italic>X<sub>g</sub></italic>) <italic>&#x0003e; E</italic>(<italic>X<sub>g</sub></italic>))[<xref rid="b13-biosensors-03-00238" ref-type="bibr">13</xref>,<xref rid="b14-biosensors-03-00238" ref-type="bibr">14</xref>,<xref rid="b19-biosensors-03-00238" ref-type="bibr">19</xref>], to ensure it, for each gene, <italic>g</italic>, we used the following scheme for obtaining proper <italic>p<sub>g</sub>, r<sub>g</sub></italic> parameters:
<list list-type="simple"><list-item><label>(1)</label><p>Generate <italic>p<sub>g</sub></italic> uniformly from distributions <italic>U</italic>[(0.9, 1)].</p></list-item><list-item><label>(2)</label><p>Use <italic>p<sub>g</sub></italic> to generate appropriate <italic>r<sub>c</sub></italic> uniformly, according to distribution <italic>U</italic>[(1.2, 2)].</p></list-item></list></p></sec></sec><sec><label>3.</label><title>Results and Discussion</title><sec><label>3.1.</label><title>Gene Count as a Negative Binomial Random Variable</title><p>Most of the existing models for RNA-seq analysis employ some form of a parametric distribution of gene counts, typically a gamma-Poisson or a negative binomial, like, e.g., Bioconductor software [<xref rid="b20-biosensors-03-00238" ref-type="bibr">20</xref>] suites: edgeR, DSS, DESeq or BaySeq). Below, we briefly explain the main reasons for this particular model.</p><p>We begin by exploring what an appropriate description of the gene count data may be, and we focus first on the capture step, where members of the library are chosen for sequencing. Let the total number of molecules in a library be <italic>N</italic>, the total number of mapped reads, <italic>n</italic>, and the number of molecules in the library corresponding to the gene, <italic>i</italic>, be <italic>m<sub>i</sub></italic>. If the capture process is unbiased (we consider capture bias and its variability later), then the probability of capturing a molecule that corresponds to gene <italic>i</italic>, which we denote as the probability of success for gene <italic>i</italic>, is <italic>p<sub>i</sub></italic> = <italic>m<sub>i</sub>/N</italic>. Because by experimental construction the library size is very large compared to the total number of mapped fragments (<italic>N</italic> &#x0226b; <italic>n</italic>) and only in very exceptional circumstances is an <italic>expressed</italic> biological entity represented very few times in the library (<italic>m<sub>i</sub></italic> &#x0226b; 1), then for all practical purposes, the probability of success is constant for all capture events. Thus, from the viewpoint of gene <italic>i</italic>, one can cast this RNA-seq experiment as a series of <italic>n</italic> trials, where in each trial, there is some probability of success, <italic>p<sub>i</sub></italic>. Now, if we denote by <italic>x<sub>i</sub></italic> the number of reads that map to gene <italic>i</italic>, given the properties of the RNA-seq experiment as outlined above, the probability of gene <italic>i</italic> having <italic>x<sub>i</sub></italic> reads follows a binomial distribution [<xref rid="b21-biosensors-03-00238" ref-type="bibr">21</xref>].</p><p>Given the large number of genes in any organism, in general, <italic>p<sub>i</sub></italic> &#x0226a; 1. Since the mean and variance of this aforementioned binomial distribution would be, respectively, <italic>&#x003bc;</italic> = <italic>Np<sub>i</sub></italic> and <italic>&#x003c3;</italic><sup>2</sup> = <italic>Np<sub>i</sub></italic>(1 <italic>&#x02212; p<sub>i</sub></italic>) [<xref rid="b21-biosensors-03-00238" ref-type="bibr">21</xref>], the Fano factor (<italic>&#x003c3;</italic><sup>2</sup><italic>/&#x003bc;</italic> =(1 <italic>&#x02212; p<sub>i</sub></italic>)) would be approximately one for most genes, similar to that predicted by a Poisson distribution (mean equals variance). Therefore, in a situation where the same library is sequenced multiple times with the same total number of mapped reads <italic>n</italic>, a Poisson distribution should be an adequate representation for most gene counts. This was indeed found to be the case for 99.5% of genes from human tissue samples [<xref rid="b19-biosensors-03-00238" ref-type="bibr">19</xref>].</p><p>This binomial model also suggests that as the mean number of counts, or, analogously, <italic>p<sub>i</sub></italic>, increases, then the Fano factor should decrease, leading to so-called &#x0201c;underdispersion&#x0201d; relative to a Poisson model. However, technical replicate data from sequencing runs using the same library show that the opposite is true; as the mean number of counts increases, so too does the Fano factor (<xref rid="f3-biosensors-03-00238" ref-type="fig">Figure 3</xref>)[<xref rid="b19-biosensors-03-00238" ref-type="bibr">19</xref>]. This is not evident for the majority of genes with relatively low means (<xref rid="f3-biosensors-03-00238" ref-type="fig">Figure 3</xref>(A)), but becomes apparent when higher mean genes are considered (<xref rid="f3-biosensors-03-00238" ref-type="fig">Figure 3</xref>(B,C)). Thus, even when one considers only capture variability, a so-called &#x0201c;overdispersion&#x0201d; relative to a Poisson model is evident. Such overdispersion is likely due to bias in the capture process that varies from run to run.</p><p>A negative binomial model can adequately capture such overdispersion [<xref rid="b13-biosensors-03-00238" ref-type="bibr">13</xref>,<xref rid="b14-biosensors-03-00238" ref-type="bibr">14</xref>], and it describes the probability of needing a particular, but random total number of trials to get a fixed number of failures, given a constant probability of success in each trial. Thus, for a negative binomial model, the experimentally-fixed total number of mapped reads, <italic>N</italic>, has no clear physical interpretation. Therefore, the negative binomial distribution may be thought of as giving an empirical description of RNA-seq count data.</p><fig id="f3-biosensors-03-00238" position="float"><label>Figure 3</label><caption><p>Noise properties of RNA-seq technical replicate data. In every panel, the mean <italic>vs.</italic> the Fano factor for individual genes is plotted. Data were taken from [<xref rid="b19-biosensors-03-00238" ref-type="bibr">19</xref>]. Black circles correspond to individual genes, and the red line corresponds to a linear regression of the mean <italic>vs.</italic> the Fano factor for the indicated number of genes. Behavior of the <bold>(A)</bold> first <bold>15,000</bold> genes; <bold>(B)</bold> first <bold>19,000</bold> genes; or <bold>(C)</bold> first <bold>19,600</bold> genes as ranked by increasing mean.</p></caption><graphic xlink:href="biosensors-03-00238-g003"/></fig></sec><sec><label>3.2.</label><title>An Empirical Bayes Framework to Detect Differential Expression from RNA-Seq Data</title><p>One goal of an RNA-seq experiment is to determine what transcripts (or genes) have significantly different expression levels between various biologically-meaningful conditions. In developing a new method for differential expression analysis, we kept in mind the following three key features of current RNA-seq experiments. First, because count data are not always linearly proportional to the original number of transcripts in the biological sample, converting counts to FPKM measurements for the purposes of differential expression testing is warranted when information sharing across genes is desired, and we wish to remove the size effect. Second, the monetary cost of a single RNA-seq run is high, so having a large number of biological replicates is unlikely. However, differential expression analysis relies on a precise estimate of a transcript&#x02019;s variance, which is problematic with few replicates and impossible with no replicates. Therefore, information sharing across transcripts to improve variance estimates is necessary. Third, often, one would like to compare more than two biological conditions, so it is preferable to have the ability to do more than pairwise comparisons. Here, we integrate two previously developed software packages, Tophat-Cufflinks [<xref rid="b7-biosensors-03-00238" ref-type="bibr">7</xref>,<xref rid="b9-biosensors-03-00238" ref-type="bibr">9</xref>] and EBArrays [<xref rid="b10-biosensors-03-00238" ref-type="bibr">10</xref>,<xref rid="b11-biosensors-03-00238" ref-type="bibr">11</xref>], to create an empirical Bayes framework for differential expression analysis of RNA-seq data. We call this hybrid software R-EBSeq, as it incorporates these three key features mentioned above. Since the EBarrays software employs a Bayesian hierarchical model, it may be used with limited (possibly a single) biological replicates. We note that most other methods of differential expression analysis for microarray data, like limma or SAM [<xref rid="b20-biosensors-03-00238" ref-type="bibr">20</xref>], rely on in-sample variance estimation (limma&#x02019;s moderated <italic>t</italic>-test) or permutation testing (SAM) and are, therefore, more vulnerable to the small sample size effects.</p><p>Before formulating an empirical Bayes approach to differential expression analysis, we must first consider how to convert the raw RNA-seq data into FPKM. The Tophat-Cufflinks pipeline is well-suited for this task, taking into account all the forms of bias and variability shown in <xref rid="f1-biosensors-03-00238" ref-type="fig">Figure 1</xref> with a rigorous, model-based formulation [<xref rid="b7-biosensors-03-00238" ref-type="bibr">7</xref>,<xref rid="b9-biosensors-03-00238" ref-type="bibr">9</xref>]. Cufflinks returns an estimated expression value,<italic>&#x000c2;<sub>t</sub></italic>, in FPKM for each transcript, <italic>t</italic>, which is given as:
<disp-formula id="FD15"><label>(15)</label><mml:math id="m19"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>A</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mtext>t</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>g</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b3;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>where <italic>C<sub>t</sub></italic> is a normalizing constant for transcript, <italic>t</italic> (which includes the total, genome-wide number of mapped fragments and adjusted transcript length), <italic>&#x00058;&#x00302;<sub>g</sub></italic> is the number of fragments mapping to gene, <italic>g</italic> (to which transcript <italic>t</italic> belongs), and <italic>&#x003b3;&#x00302;<sub>t</sub></italic> is the fraction of <italic>&#x00058;&#x00302;<sub>g</sub></italic> attributable to transcript, <italic>t</italic> (0 <italic>&#x02264; &#x003b3;&#x00302;</italic><sub>t</sub> &#x02264; 1). Cufflinks also returns an estimated confidence interval for <italic>&#x000c2;<sub>t</sub></italic>, from which, based on the approximately normal behavior of <italic>A<sub>t</sub></italic> (see [<xref rid="b7-biosensors-03-00238" ref-type="bibr">7</xref>] and Methods), the variance of <italic>A<sub>t</sub></italic>, which we denote as <italic>V</italic><sub><italic>A</italic><sub><italic>t</italic></sub></sub>, can be estimated. Thus, by using the Tophat-Cufflinks pipeline, we obtain estimates of the mean and variance of each transcript&#x02019;s expression level (in FPKM).</p><p>A concern of some researchers is that transforming discrete count data into continuous FPKM data results in a loss of information related to the magnitude of the number of counts. To illustrate this concern, consider the case when transcript <italic>a</italic> with length 1 kb has two counts in Condition 1 and four counts in Condition 2, whereas transcript <italic>b</italic> with length 5 kb has 10 counts in Condition 1 and 20 counts in Condition 2. If Condition 1 and Condition 2 have the same number of total, genome-wide mapped reads, then in terms of FPKM, the expression patterns of transcript <italic>a</italic> and <italic>b</italic> are identical. However, on the level of counts, the differential expression of transcript <italic>b</italic> is clearly more significant than that of <italic>a</italic>. This is consistent with the well-known fact that there is a length bias for detecting differential expression in RNA-seq experiments [<xref rid="b22-biosensors-03-00238" ref-type="bibr">22</xref>,<xref rid="b23-biosensors-03-00238" ref-type="bibr">23</xref>], which could possibly interfere with the information sharing across transcripts in the EBArrays model. Unfortunately, when converting counts to FPKM, the only way to retain the read length information is to propagate the variance of <italic>X<sub>g</sub></italic> into the variance of <italic>A<sub>t</sub></italic>, and Cufflink&#x02019;s estimate of this variance, <italic>&#x00056;&#x00302;</italic><sub><italic>A</italic><sub><italic>t</italic></sub></sub>, indeed does this [<xref rid="b7-biosensors-03-00238" ref-type="bibr">7</xref>].</p><p>A previously developed software package called EBArrays uses a hierarchical, empirical Bayes model to analyze differential expression analysis in microarray studies [<xref rid="b10-biosensors-03-00238" ref-type="bibr">10</xref>,<xref rid="b11-biosensors-03-00238" ref-type="bibr">11</xref>]. This model is described in detail in [<xref rid="b10-biosensors-03-00238" ref-type="bibr">10</xref>,<xref rid="b11-biosensors-03-00238" ref-type="bibr">11</xref>] and also in the Methods. Conveniently, this software and model address the last two key features mentioned above: information sharing to improve variance estimates and the ability to do more than pairwise comparisons between arbitrary many expression patterns. Thus, by combining the Tophat-Cufflinks pipeline for generating FPKM along with the EBArrays software, we can obtain a hybrid package that is suitable for analysis of RNA-Seq data given the three key features listed above.</p><p>The output of the Tophat-Cufflinks pipeline for every condition are estimates of the mean and variance of <italic>A<sub>t</sub></italic> for each transcript <italic>t</italic> (<italic>&#x000c2;<sub>t</sub></italic> and <italic>&#x00056;&#x00302;</italic><sub><italic>A</italic><sub><italic>t</italic></sub></sub>), which specify an associated normal distribution. However, these parameters cannot be used as a direct input to EBArrays, as it expects expression values for various conditions. Therefore, to couple these two pieces of software, for each transcript, we generate <italic>M</italic> replicates from a normal distribution with mean, <italic>&#x000c2;<sub>t</sub></italic>, and variance, <italic>&#x00056;&#x00302;</italic><sub><italic>A</italic><sub><italic>t</italic></sub></sub>, and, then, use these replicates as the input to EBArrays (see Methods). As indicated already above, we call this combined pipeline R-EBSeq.</p><p>To evaluate how R-EBSeq performs, we generated a test data set according to the underlying empirical Bayes model, imposed differential expression on a subset of transcripts from this data set and, then, calculated the performance of R-EBSeq in terms of true positive and false positive identifications (see Methods). Such plots of the false positive rate <italic>vs.</italic> the true positive rate are called receiver operator characteristic (ROC) curves. An ROC curve along the <italic>x</italic> = <italic>y</italic> line implies a very poor algorithm that performs no better than random choice, whereas an ROC curve that peaks high above the <italic>x</italic> = <italic>y</italic> line, at low <italic>x</italic> values, implies a very good algorithm. We investigated how three characteristics of a transcript affect the ROC curves: the difference of means between two conditions (<xref rid="f4-biosensors-03-00238" ref-type="fig">Figure 4</xref>(A)), the variance of the transcript expression level (<xref rid="f4-biosensors-03-00238" ref-type="fig">Figure 4</xref>(B)), and the number of replicates, <italic>M</italic>, used as input to the software (<xref rid="f4-biosensors-03-00238" ref-type="fig">Figure 4</xref>(C)). In general, we see that R-EBSeq is capable of very good behavior in terms of the ROC curves. As expected, as we increase the difference of means between two conditions and/or decrease the variance, the ability of R-EBSeq to identify truly differentially expressed genes improves. Increasing the number of replicates, <italic>M</italic>, also improves the performance of R-EBSeq, likely because R-EBSeq is able to get a better estimate of a transcript&#x02019;s variance.</p><fig id="f4-biosensors-03-00238" position="float"><label>Figure 4</label><caption><p>Comparison of true discovery rates for various RNA-Seq differential expression testing methods. The test data sets were generated and various software suites implemented, as described in Methods. Each panel contains two plots; the plot on the right is a zoomed-in version of the plot on the left. On the y-axis is the number of correctly-identified transcripts, and on the x-axis is the number of transcripts selected (in order of increasing <italic>p</italic>-value). DE stands for differentially expressed. In every plot, the thick black line corresponds to Cufflinks, the thick red line to R-EBSeq, the large-dashed black line to DESeq and the small-dashed black line to BaySeq. These lines are also labeled as indicated. The shaded region surrounding the R-EBSeq curve depicts the range of 20 independent runs. <bold>(A)</bold> Performance of the various methods with noise-free data; <bold>(B)</bold> Performance of the various methods with noisy data. Noise was added as described in Methods, and the data are overdispersed, as typical for RNA-seq data.</p></caption><graphic xlink:href="biosensors-03-00238-g004"/></fig></sec><sec><label>3.3.</label><title>Comparison of the R-EBSeq Approach to Published Differential Expression Software</title><p>There are several packages that currently exist for performing differential expression analysis on RNA-seq data. One method that is also based on FPKM is Cuffdiff, which is part of the Cufflinks pipeline [<xref rid="b7-biosensors-03-00238" ref-type="bibr">7</xref>]. We also want to consider count-based methods; two highly-used ones are DESeq [<xref rid="b13-biosensors-03-00238" ref-type="bibr">13</xref>] and BaySeq [<xref rid="b14-biosensors-03-00238" ref-type="bibr">14</xref>]. To determine how R-EBSeq compares to these three established methods, we need a common benchmark data set where the differentially expressed transcripts are known. However, generation of such a data set is not a trivial task, because using Cuffdiff requires altering a data set on the level of sequencer reads, whereas the input to count-based methods simply require a table of counts. To our knowledge, there is no publicly available benchmark dataset for such purposes. We have therefore modified a previously published RNA-seq dataset on <italic>S. cerevisiae</italic> [<xref rid="b16-biosensors-03-00238" ref-type="bibr">16</xref>] at the level of reads so as to create a new dataset in which the differentially expressed transcripts are precisely known (<xref rid="t1-biosensors-03-00238" ref-type="table">Table 1</xref>).</p><p>Before comparing the four software packages, we had to select operating parameters for R-EBSeq. Although above idealized data (<italic>i.e.</italic>, those not coming from sequencing reads), we found that increasing the number of &#x0201c;replicate&#x0201d; (model parameter reflecting our confidence in Cufflinks variance, not to be confused with technical or biological replicates of RNASeq data) used for R-EBSeq always resulted in better performance; with this real data, there is an optimum number of &#x0201c;replicates&#x0201d; (<xref ref-type="app" rid="app1-biosensors-03-00238">Figure S1</xref>). Decreasing the number of replicates allows for better performance in detecting strongly differentially expressed transcripts (at the beginning/left part of the curves) at the expense of detecting weakly differentially expressed transcripts (at the end/right part of the curves). This optimum number depends on the level of noise (compare <xref ref-type="app" rid="app1-biosensors-03-00238">Figure S1(A) to S1(B))</xref>; and in our specific example, it is found to be <italic>&#x02248;</italic>1,000 replicates for noise-free data and <italic>&#x02248;</italic>100 replicates for noisy data. We reasoned that this behavior is likely due to mismatch between the assumed normal model for FPKM values and the actual distribution, which can be skewed particularly when transcript fractions, <italic>&#x003b3;<sub>t</sub></italic>&#x02019;s, are close to 1 (truncation effects). Most of the investigated differentially expressed transcripts have <italic>&#x003b3;<sub>t</sub></italic> =1 (data not shown). Thus, a potential direction for future work with R-EBSeq is to improve the normal distribution assumption for FPKM data. However, changing the normal assumption may slow down the software significantly, since using the normal distribution allows for a clean analytic solution of the posterior distribution in the EBArray model and, therefore, fast computation. It is not clear whether appropriate changes to the FPKM distribution assumption would also be solvable analytically. In a practical setting, we recommend that one selects the number of replicates based on some self-consistency test, like e.g., the cross-validation Shao [<xref rid="b15-biosensors-03-00238" ref-type="bibr">15</xref>].</p><p>Another item to consider before comparison is filtering; that is, throwing away lowly and highly expressed transcripts that are likely to &#x0201c;confuse&#x0201d; EBArrays software, as the differential expression model could become unstable for very low or very high values of <italic>p</italic> and limited biological replicates [<xref rid="b11-biosensors-03-00238" ref-type="bibr">11</xref>]. Although we could not apply such filtering for Cuffdiff (it is done internally), we could apply filters to R-EBSeq, DESeq and BaySeq. We set these filters to remove 1% of the most lowly expressed transcripts and 0.1% of the most highly expressed transcripts and verified that changing these filter levels only served to degrade performance (data not shown). While these levels are arbitrary and may be dataset-dependent, such a thresholding is a necessary part of differential expression analysis, and future research in this direction is warranted.</p><table-wrap id="t1-biosensors-03-00238" position="float"><label>Table 1</label><caption><p>Benchmark dataset for software comparison. The 79 artificially modified transcripts in RNA-seq dataset on <italic>S. cerevisiae</italic> [<xref rid="b16-biosensors-03-00238" ref-type="bibr">16</xref>] used to generate two artificial datasets (denoted here as Ctrl and Treat) for our software performance comparison study. For each transcript listed in the first column, the specific number of reads listed in the second column is manually added to force differential expression in the Treat group. All the remaining transcripts are left unchanged. Last two columns provide the observed counts as reported by the software.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" valign="middle" rowspan="1" colspan="1"><bold>Transcript ID</bold></th><th align="center" valign="middle" rowspan="1" colspan="1"><bold>Added</bold></th><th align="center" valign="middle" rowspan="1" colspan="1"><bold>FPKM-Ctrl</bold></th><th align="center" valign="middle" rowspan="1" colspan="1"><bold>FPKM-Treat</bold></th><th align="center" valign="middle" rowspan="1" colspan="1"><bold>Counts-Ctrl</bold></th><th align="center" valign="middle" rowspan="1" colspan="1"><bold>Counts-Treat</bold></th></tr></thead><tbody><tr><td align="center" valign="top" rowspan="1" colspan="1">YHR099W</td><td align="right" valign="top" rowspan="1" colspan="1">4</td><td align="right" valign="top" rowspan="1" colspan="1">7.67</td><td align="right" valign="top" rowspan="1" colspan="1">8.02</td><td align="right" valign="top" rowspan="1" colspan="1">42</td><td align="right" valign="top" rowspan="1" colspan="1">42</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YOR096W</td><td align="right" valign="top" rowspan="1" colspan="1">5</td><td align="right" valign="top" rowspan="1" colspan="1">7,180.96</td><td align="right" valign="top" rowspan="1" colspan="1">7,163.06</td><td align="right" valign="top" rowspan="1" colspan="1">1,306</td><td align="right" valign="top" rowspan="1" colspan="1">1,306</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YPL131W</td><td align="right" valign="top" rowspan="1" colspan="1">6</td><td align="right" valign="top" rowspan="1" colspan="1">3,665.72</td><td align="right" valign="top" rowspan="1" colspan="1">3,658.45</td><td align="right" valign="top" rowspan="1" colspan="1">1,645</td><td align="right" valign="top" rowspan="1" colspan="1">1,645</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YJR091C</td><td align="right" valign="top" rowspan="1" colspan="1">10</td><td align="right" valign="top" rowspan="1" colspan="1">24.82</td><td align="right" valign="top" rowspan="1" colspan="1">28.1</td><td align="right" valign="top" rowspan="1" colspan="1">45</td><td align="right" valign="top" rowspan="1" colspan="1">45</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDR098C</td><td align="right" valign="top" rowspan="1" colspan="1">11</td><td align="right" valign="top" rowspan="1" colspan="1">239.1</td><td align="right" valign="top" rowspan="1" colspan="1">255.49</td><td align="right" valign="top" rowspan="1" colspan="1">86</td><td align="right" valign="top" rowspan="1" colspan="1">97</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YAL042W</td><td align="right" valign="top" rowspan="1" colspan="1">14</td><td align="right" valign="top" rowspan="1" colspan="1">150.18</td><td align="right" valign="top" rowspan="1" colspan="1">163.53</td><td align="right" valign="top" rowspan="1" colspan="1">102</td><td align="right" valign="top" rowspan="1" colspan="1">116</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YKL160W</td><td align="right" valign="top" rowspan="1" colspan="1">20</td><td align="right" valign="top" rowspan="1" colspan="1">527.66</td><td align="right" valign="top" rowspan="1" colspan="1">613.6</td><td align="right" valign="top" rowspan="1" colspan="1">89</td><td align="right" valign="top" rowspan="1" colspan="1">109</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YGR192C</td><td align="right" valign="top" rowspan="1" colspan="1">21</td><td align="right" valign="top" rowspan="1" colspan="1">21,270.8</td><td align="right" valign="top" rowspan="1" colspan="1">21,176.2</td><td align="right" valign="top" rowspan="1" colspan="1">7,392</td><td align="right" valign="top" rowspan="1" colspan="1">7,413</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YGL076C</td><td align="right" valign="top" rowspan="1" colspan="1">22</td><td align="right" valign="top" rowspan="1" colspan="1">2,797.82</td><td align="right" valign="top" rowspan="1" colspan="1">2,828.35</td><td align="right" valign="top" rowspan="1" colspan="1">575</td><td align="right" valign="top" rowspan="1" colspan="1">575</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YER178W</td><td align="right" valign="top" rowspan="1" colspan="1">23</td><td align="right" valign="top" rowspan="1" colspan="1">580.38</td><td align="right" valign="top" rowspan="1" colspan="1">600.36</td><td align="right" valign="top" rowspan="1" colspan="1">348</td><td align="right" valign="top" rowspan="1" colspan="1">348</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YER136W</td><td align="right" valign="top" rowspan="1" colspan="1">24</td><td align="right" valign="top" rowspan="1" colspan="1">193.87</td><td align="right" valign="top" rowspan="1" colspan="1">214.65</td><td align="right" valign="top" rowspan="1" colspan="1">119</td><td align="right" valign="top" rowspan="1" colspan="1">143</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YAL017W</td><td align="right" valign="top" rowspan="1" colspan="1">25</td><td align="right" valign="top" rowspan="1" colspan="1">27.83</td><td align="right" valign="top" rowspan="1" colspan="1">34.43</td><td align="right" valign="top" rowspan="1" colspan="1">67</td><td align="right" valign="top" rowspan="1" colspan="1">92</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDL040C</td><td align="right" valign="top" rowspan="1" colspan="1">29</td><td align="right" valign="top" rowspan="1" colspan="1">77.41</td><td align="right" valign="top" rowspan="1" colspan="1">89.84</td><td align="right" valign="top" rowspan="1" colspan="1">96</td><td align="right" valign="top" rowspan="1" colspan="1">125</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YMR315W</td><td align="right" valign="top" rowspan="1" colspan="1">35</td><td align="right" valign="top" rowspan="1" colspan="1">337.83</td><td align="right" valign="top" rowspan="1" colspan="1">379.29</td><td align="right" valign="top" rowspan="1" colspan="1">178</td><td align="right" valign="top" rowspan="1" colspan="1">196</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YHR158C</td><td align="right" valign="top" rowspan="1" colspan="1">37</td><td align="right" valign="top" rowspan="1" colspan="1">26.66</td><td align="right" valign="top" rowspan="1" colspan="1">38.24</td><td align="right" valign="top" rowspan="1" colspan="1">48</td><td align="right" valign="top" rowspan="1" colspan="1">85</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YHR159W</td><td align="right" valign="top" rowspan="1" colspan="1">38</td><td align="right" valign="top" rowspan="1" colspan="1">12.74</td><td align="right" valign="top" rowspan="1" colspan="1">42.8</td><td align="right" valign="top" rowspan="1" colspan="1">11</td><td align="right" valign="top" rowspan="1" colspan="1">11</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YML024W</td><td align="right" valign="top" rowspan="1" colspan="1">41</td><td align="right" valign="top" rowspan="1" colspan="1">10,985.1</td><td align="right" valign="top" rowspan="1" colspan="1">11,140.6</td><td align="right" valign="top" rowspan="1" colspan="1">1,191</td><td align="right" valign="top" rowspan="1" colspan="1">1,232</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YEL034C-A</td><td align="right" valign="top" rowspan="1" colspan="1">44</td><td align="right" valign="top" rowspan="1" colspan="1">1,638.82</td><td align="right" valign="top" rowspan="1" colspan="1">1,756.89</td><td align="right" valign="top" rowspan="1" colspan="1">534</td><td align="right" valign="top" rowspan="1" colspan="1">578</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YBL030C</td><td align="right" valign="top" rowspan="1" colspan="1">45</td><td align="right" valign="top" rowspan="1" colspan="1">357.3</td><td align="right" valign="top" rowspan="1" colspan="1">417.75</td><td align="right" valign="top" rowspan="1" colspan="1">140</td><td align="right" valign="top" rowspan="1" colspan="1">140</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YAR014C</td><td align="right" valign="top" rowspan="1" colspan="1">46</td><td align="right" valign="top" rowspan="1" colspan="1">33.18</td><td align="right" valign="top" rowspan="1" colspan="1">33.03</td><td align="right" valign="top" rowspan="1" colspan="1">48</td><td align="right" valign="top" rowspan="1" colspan="1">94</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDR037W</td><td align="right" valign="top" rowspan="1" colspan="1">47</td><td align="right" valign="top" rowspan="1" colspan="1">734.6</td><td align="right" valign="top" rowspan="1" colspan="1">762.37</td><td align="right" valign="top" rowspan="1" colspan="1">664</td><td align="right" valign="top" rowspan="1" colspan="1">664</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YOL086C</td><td align="right" valign="top" rowspan="1" colspan="1">48</td><td align="right" valign="top" rowspan="1" colspan="1">11,798</td><td align="right" valign="top" rowspan="1" colspan="1">11,745.5</td><td align="right" valign="top" rowspan="1" colspan="1">4,996</td><td align="right" valign="top" rowspan="1" colspan="1">5,044</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YJR109C</td><td align="right" valign="top" rowspan="1" colspan="1">49</td><td align="right" valign="top" rowspan="1" colspan="1">82.5</td><td align="right" valign="top" rowspan="1" colspan="1">98.29</td><td align="right" valign="top" rowspan="1" colspan="1">132</td><td align="right" valign="top" rowspan="1" colspan="1">181</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDR448W</td><td align="right" valign="top" rowspan="1" colspan="1">51</td><td align="right" valign="top" rowspan="1" colspan="1">17.06</td><td align="right" valign="top" rowspan="1" colspan="1">65.11</td><td align="right" valign="top" rowspan="1" colspan="1">16</td><td align="right" valign="top" rowspan="1" colspan="1">42</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDR209C</td><td align="right" valign="top" rowspan="1" colspan="1">52</td><td align="right" valign="top" rowspan="1" colspan="1">758.86</td><td align="right" valign="top" rowspan="1" colspan="1">1,043.42</td><td align="right" valign="top" rowspan="1" colspan="1">82</td><td align="right" valign="top" rowspan="1" colspan="1">134</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDR105C</td><td align="right" valign="top" rowspan="1" colspan="1">53</td><td align="right" valign="top" rowspan="1" colspan="1">59.9842</td><td align="right" valign="top" rowspan="1" colspan="1">104.932</td><td align="right" valign="top" rowspan="1" colspan="1">51</td><td align="right" valign="top" rowspan="1" colspan="1">104</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDL130W</td><td align="right" valign="top" rowspan="1" colspan="1">54</td><td align="right" valign="top" rowspan="1" colspan="1">6,880.78</td><td align="right" valign="top" rowspan="1" colspan="1">7,315.38</td><td align="right" valign="top" rowspan="1" colspan="1">596</td><td align="right" valign="top" rowspan="1" colspan="1">596</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YBR191W</td><td align="right" valign="top" rowspan="1" colspan="1">55</td><td align="right" valign="top" rowspan="1" colspan="1">6,798.73</td><td align="right" valign="top" rowspan="1" colspan="1">6,972.36</td><td align="right" valign="top" rowspan="1" colspan="1">752</td><td align="right" valign="top" rowspan="1" colspan="1">807</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDR083W</td><td align="right" valign="top" rowspan="1" colspan="1">55</td><td align="right" valign="top" rowspan="1" colspan="1">93.1</td><td align="right" valign="top" rowspan="1" colspan="1">122.52</td><td align="right" valign="top" rowspan="1" colspan="1">61</td><td align="right" valign="top" rowspan="1" colspan="1">116</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YBR110W</td><td align="right" valign="top" rowspan="1" colspan="1">58</td><td align="right" valign="top" rowspan="1" colspan="1">107.46</td><td align="right" valign="top" rowspan="1" colspan="1">159.57</td><td align="right" valign="top" rowspan="1" colspan="1">66</td><td align="right" valign="top" rowspan="1" colspan="1">124</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YBL092W</td><td align="right" valign="top" rowspan="1" colspan="1">59</td><td align="right" valign="top" rowspan="1" colspan="1">10,264</td><td align="right" valign="top" rowspan="1" colspan="1">10,540.1</td><td align="right" valign="top" rowspan="1" colspan="1">1,530</td><td align="right" valign="top" rowspan="1" colspan="1">1,589</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YCR012W</td><td align="right" valign="top" rowspan="1" colspan="1">61</td><td align="right" valign="top" rowspan="1" colspan="1">3,729.34</td><td align="right" valign="top" rowspan="1" colspan="1">3,796.95</td><td align="right" valign="top" rowspan="1" colspan="1">3,705</td><td align="right" valign="top" rowspan="1" colspan="1">3,766</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YOR378W</td><td align="right" valign="top" rowspan="1" colspan="1">63</td><td align="right" valign="top" rowspan="1" colspan="1">6.59</td><td align="right" valign="top" rowspan="1" colspan="1">56.45</td><td align="right" valign="top" rowspan="1" colspan="1">2</td><td align="right" valign="top" rowspan="1" colspan="1">2</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YML063W</td><td align="right" valign="top" rowspan="1" colspan="1">64</td><td align="right" valign="top" rowspan="1" colspan="1">4,559.77</td><td align="right" valign="top" rowspan="1" colspan="1">4,657.21</td><td align="right" valign="top" rowspan="1" colspan="1">1,545</td><td align="right" valign="top" rowspan="1" colspan="1">1,609</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YOR224C</td><td align="right" valign="top" rowspan="1" colspan="1">65</td><td align="right" valign="top" rowspan="1" colspan="1">840.65</td><td align="right" valign="top" rowspan="1" colspan="1">1,120.23</td><td align="right" valign="top" rowspan="1" colspan="1">119</td><td align="right" valign="top" rowspan="1" colspan="1">184</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YLR109W</td><td align="right" valign="top" rowspan="1" colspan="1">66</td><td align="right" valign="top" rowspan="1" colspan="1">7,990.36</td><td align="right" valign="top" rowspan="1" colspan="1">7,954.82</td><td align="right" valign="top" rowspan="1" colspan="1">1,601</td><td align="right" valign="top" rowspan="1" colspan="1">1,667</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YFR031C-A</td><td align="right" valign="top" rowspan="1" colspan="1">67</td><td align="right" valign="top" rowspan="1" colspan="1">2,903.13</td><td align="right" valign="top" rowspan="1" colspan="1">3,014.11</td><td align="right" valign="top" rowspan="1" colspan="1">531</td><td align="right" valign="top" rowspan="1" colspan="1">598</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YGR148C</td><td align="right" valign="top" rowspan="1" colspan="1">67</td><td align="right" valign="top" rowspan="1" colspan="1">3,850.87</td><td align="right" valign="top" rowspan="1" colspan="1">4,096.11</td><td align="right" valign="top" rowspan="1" colspan="1">450</td><td align="right" valign="top" rowspan="1" colspan="1">450</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDL073W</td><td align="right" valign="top" rowspan="1" colspan="1">68</td><td align="right" valign="top" rowspan="1" colspan="1">36.83</td><td align="right" valign="top" rowspan="1" colspan="1">62.37</td><td align="right" valign="top" rowspan="1" colspan="1">75</td><td align="right" valign="top" rowspan="1" colspan="1">143</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YML059C</td><td align="right" valign="top" rowspan="1" colspan="1">69</td><td align="right" valign="top" rowspan="1" colspan="1">5.8334</td><td align="right" valign="top" rowspan="1" colspan="1">20.6487</td><td align="right" valign="top" rowspan="1" colspan="1">19</td><td align="right" valign="top" rowspan="1" colspan="1">19</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YPR089W</td><td align="right" valign="top" rowspan="1" colspan="1">70</td><td align="right" valign="top" rowspan="1" colspan="1">31.3807</td><td align="right" valign="top" rowspan="1" colspan="1">60.7936</td><td align="right" valign="top" rowspan="1" colspan="1">58</td><td align="right" valign="top" rowspan="1" colspan="1">128</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDR226W</td><td align="right" valign="top" rowspan="1" colspan="1">71</td><td align="right" valign="top" rowspan="1" colspan="1">1,914.74</td><td align="right" valign="top" rowspan="1" colspan="1">2,064.52</td><td align="right" valign="top" rowspan="1" colspan="1">544</td><td align="right" valign="top" rowspan="1" colspan="1">579</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YPL104W</td><td align="right" valign="top" rowspan="1" colspan="1">71</td><td align="right" valign="top" rowspan="1" colspan="1">23.56</td><td align="right" valign="top" rowspan="1" colspan="1">65.08</td><td align="right" valign="top" rowspan="1" colspan="1">27</td><td align="right" valign="top" rowspan="1" colspan="1">98</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YOR122C</td><td align="right" valign="top" rowspan="1" colspan="1">72</td><td align="right" valign="top" rowspan="1" colspan="1">3,148.49</td><td align="right" valign="top" rowspan="1" colspan="1">3,553.19</td><td align="right" valign="top" rowspan="1" colspan="1">386</td><td align="right" valign="top" rowspan="1" colspan="1">458</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YHR102W</td><td align="right" valign="top" rowspan="1" colspan="1">73</td><td align="right" valign="top" rowspan="1" colspan="1">14.09</td><td align="right" valign="top" rowspan="1" colspan="1">14.03</td><td align="right" valign="top" rowspan="1" colspan="1">33</td><td align="right" valign="top" rowspan="1" colspan="1">106</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDR023W</td><td align="right" valign="top" rowspan="1" colspan="1">74</td><td align="right" valign="top" rowspan="1" colspan="1">524.92</td><td align="right" valign="top" rowspan="1" colspan="1">587.48</td><td align="right" valign="top" rowspan="1" colspan="1">409</td><td align="right" valign="top" rowspan="1" colspan="1">409</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YBL055C</td><td align="right" valign="top" rowspan="1" colspan="1">75</td><td align="right" valign="top" rowspan="1" colspan="1">97.12</td><td align="right" valign="top" rowspan="1" colspan="1">170.68</td><td align="right" valign="top" rowspan="1" colspan="1">45</td><td align="right" valign="top" rowspan="1" colspan="1">45</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YBL091C</td><td align="right" valign="top" rowspan="1" colspan="1">76</td><td align="right" valign="top" rowspan="1" colspan="1">204.38</td><td align="right" valign="top" rowspan="1" colspan="1">277.81</td><td align="right" valign="top" rowspan="1" colspan="1">125</td><td align="right" valign="top" rowspan="1" colspan="1">125</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YJL090C</td><td align="right" valign="top" rowspan="1" colspan="1">77</td><td align="right" valign="top" rowspan="1" colspan="1">17.48</td><td align="right" valign="top" rowspan="1" colspan="1">55.69</td><td align="right" valign="top" rowspan="1" colspan="1">25</td><td align="right" valign="top" rowspan="1" colspan="1">25</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YJL188C</td><td align="right" valign="top" rowspan="1" colspan="1">78</td><td align="right" valign="top" rowspan="1" colspan="1">5,103.93</td><td align="right" valign="top" rowspan="1" colspan="1">5,614.29</td><td align="right" valign="top" rowspan="1" colspan="1">802</td><td align="right" valign="top" rowspan="1" colspan="1">880</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YGR106C</td><td align="right" valign="top" rowspan="1" colspan="1">79</td><td align="right" valign="top" rowspan="1" colspan="1">728.12</td><td align="right" valign="top" rowspan="1" colspan="1">724.89</td><td align="right" valign="top" rowspan="1" colspan="1">277</td><td align="right" valign="top" rowspan="1" colspan="1">356</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YJR072C</td><td align="right" valign="top" rowspan="1" colspan="1">79</td><td align="right" valign="top" rowspan="1" colspan="1">200.13</td><td align="right" valign="top" rowspan="1" colspan="1">285.26</td><td align="right" valign="top" rowspan="1" colspan="1">138</td><td align="right" valign="top" rowspan="1" colspan="1">138</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YOR123C</td><td align="right" valign="top" rowspan="1" colspan="1">81</td><td align="right" valign="top" rowspan="1" colspan="1">110.42</td><td align="right" valign="top" rowspan="1" colspan="1">180.59</td><td align="right" valign="top" rowspan="1" colspan="1">93</td><td align="right" valign="top" rowspan="1" colspan="1">174</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YPL154C</td><td align="right" valign="top" rowspan="1" colspan="1">82</td><td align="right" valign="top" rowspan="1" colspan="1">398.23</td><td align="right" valign="top" rowspan="1" colspan="1">480.465</td><td align="right" valign="top" rowspan="1" colspan="1">203</td><td align="right" valign="top" rowspan="1" colspan="1">203</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YPR074C</td><td align="right" valign="top" rowspan="1" colspan="1">83</td><td align="right" valign="top" rowspan="1" colspan="1">404.86</td><td align="right" valign="top" rowspan="1" colspan="1">449.98</td><td align="right" valign="top" rowspan="1" colspan="1">384</td><td align="right" valign="top" rowspan="1" colspan="1">384</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YFL039C</td><td align="right" valign="top" rowspan="1" colspan="1">84</td><td align="right" valign="top" rowspan="1" colspan="1">2,343.94</td><td align="right" valign="top" rowspan="1" colspan="1">2,427.94</td><td align="right" valign="top" rowspan="1" colspan="1">1,093</td><td align="right" valign="top" rowspan="1" colspan="1">1,177</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDR050C</td><td align="right" valign="top" rowspan="1" colspan="1">85</td><td align="right" valign="top" rowspan="1" colspan="1">9,632.29</td><td align="right" valign="top" rowspan="1" colspan="1">9,751.83</td><td align="right" valign="top" rowspan="1" colspan="1">3,113</td><td align="right" valign="top" rowspan="1" colspan="1">3,198</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YMR142C</td><td align="right" valign="top" rowspan="1" colspan="1">85</td><td align="right" valign="top" rowspan="1" colspan="1">4,407.12</td><td align="right" valign="top" rowspan="1" colspan="1">4,387.52</td><td align="right" valign="top" rowspan="1" colspan="1">1,041</td><td align="right" valign="top" rowspan="1" colspan="1">1,126</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDL191W</td><td align="right" valign="top" rowspan="1" colspan="1">86</td><td align="right" valign="top" rowspan="1" colspan="1">7,255.86</td><td align="right" valign="top" rowspan="1" colspan="1">7,223.59</td><td align="right" valign="top" rowspan="1" colspan="1">272</td><td align="right" valign="top" rowspan="1" colspan="1">272</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YGL102C</td><td align="right" valign="top" rowspan="1" colspan="1">87</td><td align="right" valign="top" rowspan="1" colspan="1">3,688.69</td><td align="right" valign="top" rowspan="1" colspan="1">3,785.85</td><td align="right" valign="top" rowspan="1" colspan="1">1,686</td><td align="right" valign="top" rowspan="1" colspan="1">1,773</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YHR193C</td><td align="right" valign="top" rowspan="1" colspan="1">88</td><td align="right" valign="top" rowspan="1" colspan="1">2,017.73</td><td align="right" valign="top" rowspan="1" colspan="1">2,008.75</td><td align="right" valign="top" rowspan="1" colspan="1">547</td><td align="right" valign="top" rowspan="1" colspan="1">547</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YKL145W</td><td align="right" valign="top" rowspan="1" colspan="1">89</td><td align="right" valign="top" rowspan="1" colspan="1">360.33</td><td align="right" valign="top" rowspan="1" colspan="1">436.22</td><td align="right" valign="top" rowspan="1" colspan="1">227</td><td align="right" valign="top" rowspan="1" colspan="1">316</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YMR012W</td><td align="right" valign="top" rowspan="1" colspan="1">90</td><td align="right" valign="top" rowspan="1" colspan="1">95.84</td><td align="right" valign="top" rowspan="1" colspan="1">121.20</td><td align="right" valign="top" rowspan="1" colspan="1">191</td><td align="right" valign="top" rowspan="1" colspan="1">281</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YOR298C-A</td><td align="right" valign="top" rowspan="1" colspan="1">92</td><td align="right" valign="top" rowspan="1" colspan="1">1,066.95</td><td align="right" valign="top" rowspan="1" colspan="1">1,439.52</td><td align="right" valign="top" rowspan="1" colspan="1">190</td><td align="right" valign="top" rowspan="1" colspan="1">282</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YGL012W</td><td align="right" valign="top" rowspan="1" colspan="1">93</td><td align="right" valign="top" rowspan="1" colspan="1">297.35</td><td align="right" valign="top" rowspan="1" colspan="1">375.37</td><td align="right" valign="top" rowspan="1" colspan="1">169</td><td align="right" valign="top" rowspan="1" colspan="1">169</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YDR212W</td><td align="right" valign="top" rowspan="1" colspan="1">94</td><td align="right" valign="top" rowspan="1" colspan="1">263.12</td><td align="right" valign="top" rowspan="1" colspan="1">328.14</td><td align="right" valign="top" rowspan="1" colspan="1">219</td><td align="right" valign="top" rowspan="1" colspan="1">313</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YBR048W</td><td align="right" valign="top" rowspan="1" colspan="1">95</td><td align="right" valign="top" rowspan="1" colspan="1">3,710.64</td><td align="right" valign="top" rowspan="1" colspan="1">4,062</td><td align="right" valign="top" rowspan="1" colspan="1">353</td><td align="right" valign="top" rowspan="1" colspan="1">448</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YBL052C</td><td align="right" valign="top" rowspan="1" colspan="1">96</td><td align="right" valign="top" rowspan="1" colspan="1">28.92</td><td align="right" valign="top" rowspan="1" colspan="1">74.09</td><td align="right" valign="top" rowspan="1" colspan="1">47</td><td align="right" valign="top" rowspan="1" colspan="1">47</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YAL041W</td><td align="right" valign="top" rowspan="1" colspan="1">97</td><td align="right" valign="top" rowspan="1" colspan="1">50.87</td><td align="right" valign="top" rowspan="1" colspan="1">50.65</td><td align="right" valign="top" rowspan="1" colspan="1">65</td><td align="right" valign="top" rowspan="1" colspan="1">65</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YAL038W</td><td align="right" valign="top" rowspan="1" colspan="1">98</td><td align="right" valign="top" rowspan="1" colspan="1">3,610.93</td><td align="right" valign="top" rowspan="1" colspan="1">3,613.65</td><td align="right" valign="top" rowspan="1" colspan="1">4,517</td><td align="right" valign="top" rowspan="1" colspan="1">4,555</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YPL220W</td><td align="right" valign="top" rowspan="1" colspan="1">98</td><td align="right" valign="top" rowspan="1" colspan="1">5,828.52</td><td align="right" valign="top" rowspan="1" colspan="1">6,028.35</td><td align="right" valign="top" rowspan="1" colspan="1">312</td><td align="right" valign="top" rowspan="1" colspan="1">410</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YKL060C</td><td align="right" valign="top" rowspan="1" colspan="1">99</td><td align="right" valign="top" rowspan="1" colspan="1">17,531.1</td><td align="right" valign="top" rowspan="1" colspan="1">17,570.5</td><td align="right" valign="top" rowspan="1" colspan="1">9,999</td><td align="right" valign="top" rowspan="1" colspan="1">9,999</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YPR145W</td><td align="right" valign="top" rowspan="1" colspan="1">99</td><td align="right" valign="top" rowspan="1" colspan="1">563.698</td><td align="right" valign="top" rowspan="1" colspan="1">629.111</td><td align="right" valign="top" rowspan="1" colspan="1">526</td><td align="right" valign="top" rowspan="1" colspan="1">526</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YOR369C</td><td align="right" valign="top" rowspan="1" colspan="1">100</td><td align="right" valign="top" rowspan="1" colspan="1">18,149.4</td><td align="right" valign="top" rowspan="1" colspan="1">18,068.7</td><td align="right" valign="top" rowspan="1" colspan="1">3,126</td><td align="right" valign="top" rowspan="1" colspan="1">3,226</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YER165W</td><td align="right" valign="top" rowspan="1" colspan="1">101</td><td align="right" valign="top" rowspan="1" colspan="1">418.29</td><td align="right" valign="top" rowspan="1" colspan="1">485.05</td><td align="right" valign="top" rowspan="1" colspan="1">421</td><td align="right" valign="top" rowspan="1" colspan="1">472</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YLR359W</td><td align="right" valign="top" rowspan="1" colspan="1">101</td><td align="right" valign="top" rowspan="1" colspan="1">985.91</td><td align="right" valign="top" rowspan="1" colspan="1">1,065.82</td><td align="right" valign="top" rowspan="1" colspan="1">664</td><td align="right" valign="top" rowspan="1" colspan="1">765</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YBR121C</td><td align="right" valign="top" rowspan="1" colspan="1">113</td><td align="right" valign="top" rowspan="1" colspan="1">402.57</td><td align="right" valign="top" rowspan="1" colspan="1">466.61</td><td align="right" valign="top" rowspan="1" colspan="1">385</td><td align="right" valign="top" rowspan="1" colspan="1">498</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YML009C</td><td align="right" valign="top" rowspan="1" colspan="1">123</td><td align="right" valign="top" rowspan="1" colspan="1">691.233</td><td align="right" valign="top" rowspan="1" colspan="1">2,465.9</td><td align="right" valign="top" rowspan="1" colspan="1">29</td><td align="right" valign="top" rowspan="1" colspan="1">91</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">YNL178W</td><td align="right" valign="top" rowspan="1" colspan="1">146</td><td align="right" valign="top" rowspan="1" colspan="1">8,261.72</td><td align="right" valign="top" rowspan="1" colspan="1">8,516.73</td><td align="right" valign="top" rowspan="1" colspan="1">2,245</td><td align="right" valign="top" rowspan="1" colspan="1">2,300</td></tr></tbody></table></table-wrap><p>After determining the number of replicates to use for R-EBSeq and the filtering parameters, we proceeded to compare the performance of these four software packages (<xref rid="f4-biosensors-03-00238" ref-type="fig">Figure 4</xref>). We first considered the case of noise-free data (<xref rid="f4-biosensors-03-00238" ref-type="fig">Figure 4</xref>(A)). Cuffdiff performs the best and is followed closely by R-EBSeq. For the top 100 selected transcripts (right plot), DESeq performs very well for slightly over half of the differentially expressed transcripts, but struggles finding the others. Additional simulations showed that this inability of DESeq is actually due to a problem with the conversion of the read level data to count level data with the software HTSeq, as opposed to that of DESeq itself, in that HTSeq simply failed to convert a subset of transcripts (data not shown). When we eliminated transcripts based on the ability of HTSeq to process them, DESeq performs markedly better (data not shown); however, eliminating transcripts in such a biased manner is undesirable, and we therefore proceeded without this elimination. Importantly, we also tested these software packages with noisy data, ensuring that such noise is overdispersed, as is typical for RNA-seq data (see Methods). Although the noise clearly had an effect on the total number of transcripts that could be identified within the top 1,000, this noise did not change the relative performance of the four methods. Thus, we conclude that Cuffdiff offers the best performance, and R-EBSeq is a very close second. The count-based methods, DESeq and BaySeq, did not perform as well as the FPKM-based methods.</p></sec><sec><label>3.4.</label><title>Application of R-EBSeq to Experimental Data-Illustration of Multiple Conditions Comparison</title><p>A convenient feature of R-EBSeq that was inherited from EBArrays is the ability to easily specify patterns for multiple condition comparison. We illustrate this feature here using RNA-seq datasets for a DNA damage response with or without <italic>tp53</italic>, a gene that is lost in over 50% of human cancers and is a central player in the DNA damage response (reviewed in [<xref rid="b24-biosensors-03-00238" ref-type="bibr">24</xref>]). RKO colon carcinoma cells, which are wild-type for p53 protein (WT), or RKO cells where both copies of <italic>tp53</italic> have been knocked-out (KO) were treated with etoposide, a DNA-damaging agent, or DMSO (control) and then assayed for gene expression via RNA-seq [<xref rid="b25-biosensors-03-00238" ref-type="bibr">25</xref>]. One biological question of interest is to identify which genes change as a function of etoposide without regard to p53-status and which genes are p53-dependent without regard to etoposide-status. It is difficult to identify such genes with traditional pairwise differential expression analysis, particularly because etoposide is used to upregulate p53 expression [<xref rid="b26-biosensors-03-00238" ref-type="bibr">26</xref>,<xref rid="b27-biosensors-03-00238" ref-type="bibr">27</xref>,<xref rid="b28-biosensors-03-00238" ref-type="bibr">28</xref>,<xref rid="b29-biosensors-03-00238" ref-type="bibr">29</xref>].</p><p>To determine potential p53- and etoposide-specific genes, we first specified &#x0201c;patterns&#x0201d;. Pattern specification is the aspect of R-EBSeq (and formerly EBArrays) where one defines how many unique population means we expect and which sample we would expect which population mean to correspond to. In our case, we have four samples and three different conditions we are interested in: p53-specific, etoposide-specific and non-specific (null). To specify these conditions, we consider two different population means, 1 and 2, which are distributed as &#x0201c;patterns&#x0201d; among the conditions according to <xref rid="t2-biosensors-03-00238" ref-type="table">Table 2</xref>. For the pattern etoposide, we require that a gene have a different mean in all etoposide-treated samples. For the pattern, p53, we require that a gene only have a different mean in the WT cells (upon etoposide treatment, which increases p53 levels that are otherwise negligible). For the pattern null, we require that genes have the same mean in all populations. Running R-EBSeq with this setup results in each gene having a posterior probability for each pattern. Thus, the higher the posterior probability, the more likely a gene belongs to a particular pattern.</p><p>To analyze the results, we first identified genes having greater than 0.99 posterior probability of belonging to either the etoposide or p53 pattern (<xref ref-type="supplementary-material" rid="biosensors-03-00238-s001">Supplemental Table S1</xref>). We then compared the high posterior probability gene lists to those in the MSigDB to find those which exhibited significant overlap [<xref rid="b30-biosensors-03-00238" ref-type="bibr">30</xref>]. The top two hits for the etoposide pattern are <italic>PEREZ_TP53_TARGETS</italic> and <italic>PUJANA_ATM_PCC_NETWORK</italic>. Although it may seem illogical that a list of p53 targets have significant overlap with a list of etoposide-specific genes, this is actually not that surprising and, in fact, expected. There are many proteins that have functional redundancy with p53, so if p53 is not there, it is likely other proteins serve to provide a compensatory effect in the presence of etoposide. Because many p53 targets have been defined as those which respond to DNA damage and many of these targets are likely regulated by compensatory actions, one would expect a large overlap. For the second hit, ATM is a well known DNA-damage related protein, and therefore, its presence is understandably etoposide-related. Some top hits for the p53 pattern are UV response sets (<italic>DACOSTA_UV_RESPONSE_VIA_ERCC3_UP</italic> and <italic>ENK_UV_RESPONSE_KERATINOCYTE_UP</italic>) and stem cell related sets (<italic>NUYTTEN_EZH2_TARGETS_DN</italic> and <italic>BENPORATH_NANOG_TARGETS</italic>). The presence of the UV sets imply that there may be some distinct pathways that are utilized in response to etoposide-mediated DNA damage <italic>vs.</italic> UV-mediated DNA damage and that p53 allows response to both types. The presence of the stem cell sets are in line with current thoughts that p53 plays a large role in stem cell function (reviewed in [<xref rid="b31-biosensors-03-00238" ref-type="bibr">31</xref>]). Thus, by performing this multiple condition comparison with an appropriately chosen pattern, we were able to find a p53 function related to stem-cells that did not depend on DNA damage.</p><table-wrap id="t2-biosensors-03-00238" position="float"><label>Table 2</label><caption><p>Patterns for multiple conditions comparison. Entries correspond to the population mean which sample is assumed to come from, given the pattern indicated. Pattern names are indicated in the row, whereas samples are indicated in the columns. WT: wild-type; KO: knock-out; D: DMSO (control); E: etoposide.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" valign="middle" rowspan="1" colspan="1"/><th align="center" valign="middle" rowspan="1" colspan="1"><bold>WT-D</bold></th><th align="center" valign="middle" rowspan="1" colspan="1"><bold>WT-E</bold></th><th align="center" valign="middle" rowspan="1" colspan="1"><bold>KO-D</bold></th><th align="center" valign="middle" rowspan="1" colspan="1"><bold>KO-E</bold></th></tr></thead><tbody><tr><td align="center" valign="top" rowspan="1" colspan="1">Etoposide</td><td align="center" valign="top" rowspan="1" colspan="1">1</td><td align="center" valign="top" rowspan="1" colspan="1">2</td><td align="center" valign="top" rowspan="1" colspan="1">1</td><td align="center" valign="top" rowspan="1" colspan="1">2</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">p53</td><td align="center" valign="top" rowspan="1" colspan="1">1</td><td align="center" valign="top" rowspan="1" colspan="1">2</td><td align="center" valign="top" rowspan="1" colspan="1">1</td><td align="center" valign="top" rowspan="1" colspan="1">1</td></tr><tr><td align="center" valign="top" rowspan="1" colspan="1">Null</td><td align="center" valign="top" rowspan="1" colspan="1">1</td><td align="center" valign="top" rowspan="1" colspan="1">1</td><td align="center" valign="top" rowspan="1" colspan="1">1</td><td align="center" valign="top" rowspan="1" colspan="1">1</td></tr></tbody></table></table-wrap></sec></sec><sec sec-type="conclusions"><label>4.</label><title>Conclusions</title><p>Here we have investigated several aspects of RNA-seq differential expression analysis. In the first part of the paper, we have suggested the empirical Bayes method for RNA-seq data analysis based on FPKM measurements (called R-EBSeq), which combines two previously developed and powerful software suits: Cufflinks and EBarrays. R-EBSeq has two important features. First, it shares information across genes (or transcripts) to get better variances estimates when there are few or no replicates. The use of FPKM makes the sharing straightforward and, unlike in some other empirical Bayes RNA-seq software, does not require additional pre-processing. Second, it is capable of doing multiple conditions comparisons in an easy-to-implement manner, as we demonstrate with experimental data. In the second part of the paper, we created the benchmark dataset for RNA-seq differential expression analysis and used it to compare R-EBSeq to Cuffdiff, DESeq and BaySeq software suits developed for RNA-seq analysis. We find that FPKM-based Cuffdiff gives the best performance, followed closely by R-EBSeq. DESeq and BaySeq, which are count-based methods and do not perform as well. Overall, R-EBSeq seems to offer reasonable performance with the flexibility of multiple comparisons and rigorous treatment of information sharing when there are few replicates.</p></sec></body><back><ack><title>Acknowledgments</title><p>The authors are grateful to Philip Buckhaults for allowing the use of his experimental data. The research was partially supported by the grants R01CA152158 and DMS1106485 to GAR.</p></ack><app-group><app><title>Supplementary Files</title><supplementary-material content-type="local-data" id="biosensors-03-00238-s001"><label>Supplementary File 1</label><caption><p>Supplementary (ZIP, 852 KB)</p></caption><media xlink:href="biosensors-03-00238-s001.zip"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></app></app-group><notes><title>Conflict of Interest</title><p>The authors declare no conflict of interest.</p></notes><ref-list><title>References</title><ref id="b1-biosensors-03-00238"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mardis</surname><given-names>E.R.</given-names></name></person-group><article-title>A decade&#x02019;s perspective on DNA sequencing technology</article-title><source>Nature</source><year>2011</year><volume>470</volume><fpage>198</fpage><lpage>203</lpage><pub-id pub-id-type="pmid">21307932</pub-id></element-citation></ref><ref id="b2-biosensors-03-00238"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Metzker</surname><given-names>M.L.</given-names></name></person-group><article-title>Sequencing technologies&#x02014;The next generation</article-title><source>Nat. Rev. Genet</source><year>2010</year><volume>11</volume><fpage>31</fpage><lpage>46</lpage><pub-id pub-id-type="pmid">19997069</pub-id></element-citation></ref><ref id="b3-biosensors-03-00238"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Venter</surname><given-names>J.C.</given-names></name><name><surname>Adams</surname><given-names>M.D.</given-names></name><name><surname>Myers</surname><given-names>E.W.</given-names></name><name><surname>Li</surname><given-names>P.W.</given-names></name><name><surname>Mural</surname><given-names>R.J.</given-names></name><name><surname>Sutton</surname><given-names>G.G.</given-names></name><name><surname>Smith</surname><given-names>H.O.</given-names></name><name><surname>Yandell</surname><given-names>M.</given-names></name><name><surname>Evans</surname><given-names>C.A.</given-names></name><name><surname>Holt</surname><given-names>R.A.</given-names></name><etal/></person-group><article-title>The sequence of the human genome</article-title><source>Science</source><year>2001</year><volume>291</volume><fpage>1304</fpage><lpage>1351</lpage><pub-id pub-id-type="pmid">11181995</pub-id></element-citation></ref><ref id="b4-biosensors-03-00238"><label>4.</label><element-citation publication-type="journal"><collab>International Human Genome Sequencing Consortium</collab><article-title>Finishing the euchromatic sequence of the human genome</article-title><source>Nature</source><year>2004</year><volume>431</volume><fpage>931</fpage><lpage>45</lpage><pub-id pub-id-type="pmid">15496913</pub-id></element-citation></ref><ref id="b5-biosensors-03-00238"><label>5.</label><element-citation publication-type="webpage"><person-group person-group-type="author"><name><surname>Wetterstrand</surname><given-names>K.</given-names></name></person-group><article-title>DNA Sequencing Costs: Data from the NHGRI Large-Scale Genome Sequencing Program</article-title><comment>Available online: <ext-link ext-link-type="uri" xlink:href="http://www.genome.gov/sequencingcosts/">http://www.genome.gov/sequencingcosts/</ext-link></comment><date-in-citation>(accessed on 13 June 2013)</date-in-citation></element-citation></ref><ref id="b6-biosensors-03-00238"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mortazavi</surname><given-names>A.</given-names></name><name><surname>Williams</surname><given-names>B.A.</given-names></name><name><surname>McCue</surname><given-names>K.</given-names></name><name><surname>Schaeffer</surname><given-names>L.</given-names></name><name><surname>Wold</surname><given-names>B.</given-names></name></person-group><article-title>Mapping and quantifying mammalian transcriptomes by RNA-seq</article-title><source>Nat. Methods</source><year>2008</year><volume>5</volume><fpage>621</fpage><lpage>628</lpage><pub-id pub-id-type="pmid">18516045</pub-id></element-citation></ref><ref id="b7-biosensors-03-00238"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C.</given-names></name><name><surname>Williams</surname><given-names>B.A.</given-names></name><name><surname>Pertea</surname><given-names>G.</given-names></name><name><surname>Mortazavi</surname><given-names>A.</given-names></name><name><surname>Kwan</surname><given-names>G.</given-names></name><name><surname>van Baren</surname><given-names>M.J.</given-names></name><name><surname>Salzberg</surname><given-names>S.L.</given-names></name><name><surname>Wold</surname><given-names>B.J.</given-names></name><name><surname>Pachter</surname><given-names>L.</given-names></name></person-group><article-title>Transcript assembly and quantification by RNA-seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title><source>Nat. Biotechnol</source><year>2010</year><volume>28</volume><fpage>511</fpage><lpage>515</lpage><pub-id pub-id-type="pmid">20436464</pub-id></element-citation></ref><ref id="b8-biosensors-03-00238"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eid</surname><given-names>J.</given-names></name><name><surname>Fehr</surname><given-names>A.</given-names></name><name><surname>Gray</surname><given-names>J.</given-names></name><name><surname>Luong</surname><given-names>K.</given-names></name><name><surname>Lyle</surname><given-names>J.</given-names></name><name><surname>Otto</surname><given-names>G.</given-names></name><name><surname>Peluso</surname><given-names>P.</given-names></name><name><surname>Rank</surname><given-names>D.</given-names></name><name><surname>Baybayan</surname><given-names>P.</given-names></name><name><surname>Bettman</surname><given-names>B.</given-names></name><etal/></person-group><article-title>Real-time DNA sequencing from single polymerase molecules</article-title><source>Science</source><year>2009</year><volume>323</volume><fpage>133</fpage><lpage>138</lpage><pub-id pub-id-type="pmid">19023044</pub-id></element-citation></ref><ref id="b9-biosensors-03-00238"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roberts</surname><given-names>A.</given-names></name><name><surname>Trapnell</surname><given-names>C.</given-names></name><name><surname>Donaghey</surname><given-names>J.</given-names></name><name><surname>Rinn</surname><given-names>J.L.</given-names></name><name><surname>Pachter</surname><given-names>L.</given-names></name></person-group><article-title>Improving RNA-seq expression estimates by correcting for fragment bias</article-title><source>Genome Biol</source><year>2011</year><volume>12</volume><pub-id pub-id-type="doi">10.1186/gb-2011-12-3-r22</pub-id></element-citation></ref><ref id="b10-biosensors-03-00238"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kendziorski</surname><given-names>C.M.</given-names></name><name><surname>Newton</surname><given-names>M.A.</given-names></name><name><surname>Lan</surname><given-names>H.</given-names></name><name><surname>Gould</surname><given-names>M.N.</given-names></name></person-group><article-title>On parametric empirical Bayes methods for comparing multiple groups using replicated gene expression profiles</article-title><source>Stat. Med</source><year>2003</year><volume>22</volume><fpage>3899</fpage><lpage>3914</lpage><pub-id pub-id-type="pmid">14673946</pub-id></element-citation></ref><ref id="b11-biosensors-03-00238"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newton</surname><given-names>M.A.</given-names></name><name><surname>Noueiry</surname><given-names>A.</given-names></name><name><surname>Sarkar</surname><given-names>D.</given-names></name><name><surname>Ahlquist</surname><given-names>P.</given-names></name></person-group><article-title>Detecting differential gene expression with a semiparametric hierarchical mixture method</article-title><source>Biostatistics</source><year>2004</year><volume>5</volume><fpage>155</fpage><lpage>176</lpage><pub-id pub-id-type="pmid">15054023</pub-id></element-citation></ref><ref id="b12-biosensors-03-00238"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leng</surname><given-names>N.</given-names></name><name><surname>Dawson</surname><given-names>J.A.</given-names></name><name><surname>Thomson</surname><given-names>J.A.</given-names></name><name><surname>Ruotti</surname><given-names>V.</given-names></name><name><surname>Rissman</surname><given-names>A.</given-names></name><name><surname>Smits</surname><given-names>B.</given-names></name><name><surname>Haag</surname><given-names>J.</given-names></name><name><surname>Gould</surname><given-names>M.N.</given-names></name><name><surname>Stewart</surname><given-names>R.M.</given-names></name><name><surname>Kendziorski</surname><given-names>C.</given-names></name></person-group><article-title>EBSeq: An empirical Bayes hierarchical model for inference in RNA-seq experiments</article-title><source>Bioinformatics</source><year>2013</year><volume>29</volume><fpage>1035</fpage><lpage>1043</lpage><pub-id pub-id-type="pmid">23428641</pub-id></element-citation></ref><ref id="b13-biosensors-03-00238"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S.</given-names></name><name><surname>Huber</surname><given-names>W.</given-names></name></person-group><article-title>Differential expression analysis for sequence count data</article-title><source>Genome Biol.</source><year>2010</year><volume>11</volume><pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id></element-citation></ref><ref id="b14-biosensors-03-00238"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardcastle</surname><given-names>T.J.</given-names></name><name><surname>Kelly</surname><given-names>K.A.</given-names></name></person-group><article-title>BaySeq: Empirical Bayesian methods for identifying differential expression in sequence count data</article-title><source>BMC Bioinformatics</source><year>2010</year><volume>11</volume><fpage>422</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-11-422</pub-id><pub-id pub-id-type="pmid">20698981</pub-id></element-citation></ref><ref id="b15-biosensors-03-00238"><label>15.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Shao</surname><given-names>J.</given-names></name></person-group><source>Mathematical Statistics</source><edition>2nd ed</edition><comment>Springer Texts in Statistics</comment><publisher-name>Springer-Verlag</publisher-name><publisher-loc>New York, NY, USA</publisher-loc><year>2003</year></element-citation></ref><ref id="b16-biosensors-03-00238"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagalakshmi</surname><given-names>U.</given-names></name><name><surname>Wang</surname><given-names>Z.</given-names></name><name><surname>Waern</surname><given-names>K.</given-names></name><name><surname>Shou</surname><given-names>C.</given-names></name><name><surname>Raha</surname><given-names>D.</given-names></name><name><surname>Gerstein</surname><given-names>M.</given-names></name><name><surname>Snyder</surname><given-names>M.</given-names></name></person-group><article-title>The transcriptional landscape of the yeast genome defined by RNA sequencing</article-title><source>Science</source><year>2008</year><volume>320</volume><fpage>1344</fpage><lpage>1349</lpage><pub-id pub-id-type="pmid">18451266</pub-id></element-citation></ref><ref id="b17-biosensors-03-00238"><label>17.</label><element-citation publication-type="webpage"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S.</given-names></name></person-group><article-title>Htseq: Analysing High-Throughput Sequencing Data with Python</article-title><comment>Available online: <ext-link ext-link-type="uri" xlink:href="http://www-huber.embl.de/users/anders/HTSeq/doc/overview.html">http://www-huber.embl.de/users/anders/HTSeq/doc/overview.html</ext-link></comment><date-in-citation>(accessed on 13 June 2013)</date-in-citation></element-citation></ref><ref id="b18-biosensors-03-00238"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H.</given-names></name><name><surname>Handsaker</surname><given-names>B.</given-names></name><name><surname>Wysoker</surname><given-names>A.</given-names></name><name><surname>Fennell</surname><given-names>T.</given-names></name><name><surname>Ruan</surname><given-names>J.</given-names></name><name><surname>Homer</surname><given-names>N.</given-names></name><name><surname>Marth</surname><given-names>G.</given-names></name><name><surname>Abecasis</surname><given-names>G.</given-names></name><name><surname>Durbin</surname><given-names>R.</given-names></name></person-group><article-title>1,000 Genome Project Data Processing Subgroup. The sequence alignment/map format and SAMtools</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2078</fpage><lpage>2079</lpage><pub-id pub-id-type="pmid">19505943</pub-id></element-citation></ref><ref id="b19-biosensors-03-00238"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marioni</surname><given-names>J.C.</given-names></name><name><surname>Mason</surname><given-names>C.E.</given-names></name><name><surname>Mane</surname><given-names>S.M.</given-names></name><name><surname>Stephens</surname><given-names>M.</given-names></name><name><surname>Gilad</surname><given-names>Y.</given-names></name></person-group><article-title>RNA-Seq: An assessment of technical reproducibility and comparison with gene expression arrays</article-title><source>Genome Res</source><year>2008</year><volume>18</volume><fpage>1509</fpage><lpage>1517</lpage><pub-id pub-id-type="pmid">18550803</pub-id></element-citation></ref><ref id="b20-biosensors-03-00238"><label>20.</label><element-citation publication-type="webpage"><comment>Bioconductor: Open Software Development for Computational Biology and Bioinformatics. Available online: <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org">http://www.bioconductor.org</ext-link></comment><date-in-citation>(accessed on 18 June 2013)</date-in-citation></element-citation></ref><ref id="b21-biosensors-03-00238"><label>21.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Ogunnaike</surname><given-names>B.A.</given-names></name></person-group><source>Random Phenomena: Fundamentals of Probability and Statistics for Engineers</source><publisher-name>CRC Press</publisher-name><publisher-loc>Boca Raton, FL, USA</publisher-loc><year>2010</year></element-citation></ref><ref id="b22-biosensors-03-00238"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oshlack</surname><given-names>A.</given-names></name><name><surname>Wakefield</surname><given-names>M.J.</given-names></name></person-group><article-title>Transcript length bias in RNA-seq data confounds systems biology</article-title><source>Biol. Direct</source><year>2009</year><volume>4</volume><pub-id pub-id-type="doi">10.1186/1745-6150-4-14</pub-id></element-citation></ref><ref id="b23-biosensors-03-00238"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>L.</given-names></name><name><surname>Fang</surname><given-names>Z.</given-names></name><name><surname>Zhang</surname><given-names>K.</given-names></name><name><surname>Zhi</surname><given-names>D.</given-names></name><name><surname>Cui</surname><given-names>X.</given-names></name></person-group><article-title>Length bias correction for RNA-seq data in gene set analyses</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><fpage>662</fpage><lpage>669</lpage><pub-id pub-id-type="pmid">21252076</pub-id></element-citation></ref><ref id="b24-biosensors-03-00238"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Riley</surname><given-names>T.</given-names></name><name><surname>Sontag</surname><given-names>E.</given-names></name><name><surname>Chen</surname><given-names>P.</given-names></name><name><surname>Levine</surname><given-names>A.</given-names></name></person-group><article-title>Transcriptional control of human p53-regulated genes</article-title><source>Nat. Rev. Mol. Cell Biol</source><year>2008</year><volume>9</volume><fpage>402</fpage><lpage>412</lpage><pub-id pub-id-type="pmid">18431400</pub-id></element-citation></ref><ref id="b25-biosensors-03-00238"><label>25.</label><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Birtwistle</surname><given-names>M.R.</given-names></name><name><surname>Berrong</surname><given-names>Z.</given-names></name><name><surname>Duff</surname><given-names>K.</given-names></name><name><surname>Cloessner</surname><given-names>E.</given-names></name><name><surname>Tidwell</surname><given-names>J.</given-names></name><name><surname>Clendenning</surname><given-names>M.</given-names></name><name><surname>Wilkerson</surname><given-names>B.</given-names></name><name><surname>Farrell</surname><given-names>C.</given-names></name><name><surname>Ji</surname><given-names>H.</given-names></name><name><surname>Shtutman</surname><given-names>M.</given-names></name><etal/></person-group><source>The p53Pro72Arg polymorphism may specify a balance between stem cell renewal and cancer progression</source><comment>Unpublished work</comment><year>2013</year></element-citation></ref><ref id="b26-biosensors-03-00238"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fritsche</surname><given-names>M.</given-names></name><name><surname>Haessler</surname><given-names>C.</given-names></name><name><surname>Brandner</surname><given-names>G.</given-names></name></person-group><article-title>Induction of nuclear accumulation of the tumor-suppressor protein p53 by DNA-damaging agents</article-title><source>Oncogene</source><year>1993</year><volume>8</volume><fpage>307</fpage><lpage>318</lpage><pub-id pub-id-type="pmid">8426740</pub-id></element-citation></ref><ref id="b27-biosensors-03-00238"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clarke</surname><given-names>A.R.</given-names></name><name><surname>Purdie</surname><given-names>C.A.</given-names></name><name><surname>Harrison</surname><given-names>D.J.</given-names></name><name><surname>Morris</surname><given-names>R.G.</given-names></name><name><surname>Bird</surname><given-names>C.C.</given-names></name><name><surname>Hooper</surname><given-names>M.L.</given-names></name><name><surname>Wyllie</surname><given-names>A.H.</given-names></name></person-group><article-title>Thymocyte apoptosis induced by p53-dependent and independent pathways</article-title><source>Nature</source><year>1993</year><volume>362</volume><fpage>849</fpage><lpage>852</lpage><pub-id pub-id-type="pmid">8479523</pub-id></element-citation></ref><ref id="b28-biosensors-03-00238"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tishler</surname><given-names>R.B.</given-names></name><name><surname>Calderwood</surname><given-names>S.K.</given-names></name><name><surname>Coleman</surname><given-names>C.N.</given-names></name><name><surname>Price</surname><given-names>B.D.</given-names></name></person-group><article-title>Increases in sequence specific DNA binding by p53 following treatment with chemotherapeutic and DNA damaging agents</article-title><source>Cancer Res</source><year>1993</year><volume>53</volume><fpage>2212</fpage><lpage>2216</lpage><pub-id pub-id-type="pmid">8485705</pub-id></element-citation></ref><ref id="b29-biosensors-03-00238"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lowe</surname><given-names>S.W.</given-names></name><name><surname>Ruley</surname><given-names>H.E.</given-names></name><name><surname>Jacks</surname><given-names>T.</given-names></name><name><surname>Housman</surname><given-names>D.E.</given-names></name></person-group><article-title>p53-dependent apoptosis modulates the cytotoxicity of anticancer agents</article-title><source>Cell</source><year>1993</year><volume>74</volume><fpage>957</fpage><lpage>967</lpage><pub-id pub-id-type="pmid">8402885</pub-id></element-citation></ref><ref id="b30-biosensors-03-00238"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liberzon</surname><given-names>A.</given-names></name><name><surname>Subramanian</surname><given-names>A.</given-names></name><name><surname>Pinchback</surname><given-names>R.</given-names></name><name><surname>Thorvaldsd&#x000f3;ttir</surname><given-names>H.</given-names></name><name><surname>Tamayo</surname><given-names>P.</given-names></name><name><surname>Mesirov</surname><given-names>J.P.</given-names></name></person-group><article-title>Molecular signatures database (MSigDB) 3.0</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><fpage>1739</fpage><lpage>1740</lpage><pub-id pub-id-type="pmid">21546393</pub-id></element-citation></ref><ref id="b31-biosensors-03-00238"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>T.</given-names></name><name><surname>Xu</surname><given-names>Y.</given-names></name></person-group><article-title>p53 and stem cells: New developments and new concerns</article-title><source>Trends Cell Biol</source><year>2010</year><volume>20</volume><fpage>170</fpage><lpage>175</lpage><pub-id pub-id-type="pmid">20061153</pub-id></element-citation></ref></ref-list><app-group><app id="app1-biosensors-03-00238"><title>Appendix</title><fig id="fa1-biosensors-03-00238" position="anchor"><label>Figure S1</label><caption><p>Performance of R-EBSeq Against Other Methods as a Function of th Number of Replicates. In all panels, the thick black line is Cuffdiff, the solid red is R-EBSeq, the large dashed black line is DESeq and the samll dashed black line is Bayseq. The number of replicates for each plot is indicated by the value for <italic>n</italic> above the graph. In each panel, the bottom row (top 100) is zoomed-in version of the top row (top 1,000). <bold>(A)</bold> Performance in the case of noise-free data; <bold>(B)</bold> Performance in the case of overdispersed, noise augmented data.</p></caption><graphic xlink:href="biosensors-03-00238-g005"/></fig><p>For the description of the EBarrays LNNMV code, see <italic>nolog.R</italic> file.</p></app></app-group></back></article>