<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Evol Bioinform Online</journal-id><journal-id journal-id-type="iso-abbrev">Evol. Bioinform. Online</journal-id><journal-id journal-id-type="publisher-id">101256319</journal-id><journal-title-group><journal-title>Evolutionary Bioinformatics Online</journal-title></journal-title-group><issn pub-type="epub">1176-9343</issn><publisher><publisher-name>Libertas Academica</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3836564</article-id><article-id pub-id-type="doi">10.4137/EBO.S13099</article-id><article-id pub-id-type="publisher-id">ebo-9-2013-467</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology</subject></subj-group></article-categories><title-group><article-title>Grouped False-Discovery Rate for Removing the Gene-Set-Level Bias of RNA-seq</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Yang</surname><given-names>Tae Young</given-names></name><xref ref-type="aff" rid="af1-ebo-9-2013-467">1</xref><xref ref-type="corresp" rid="c1-ebo-9-2013-467">*</xref></contrib><contrib contrib-type="author"><name><surname>Jeong</surname><given-names>Seongmun</given-names></name><xref ref-type="aff" rid="af1-ebo-9-2013-467">1</xref></contrib></contrib-group><aff id="af1-ebo-9-2013-467"><label>1</label>Department of Mathematics, Myongji University, Yongin, Kyonggi, Korea 449-728.</aff><author-notes><corresp id="c1-ebo-9-2013-467"><label>*</label>Corresponding author email: <email>tyang@mju.ac.kr</email></corresp></author-notes><pub-date pub-type="collection"><year>2013</year></pub-date><pub-date pub-type="epub"><day>13</day><month>11</month><year>2013</year></pub-date><volume>9</volume><fpage>467</fpage><lpage>478</lpage><permissions><copyright-statement>&#x000a9; 2013 the author(s), publisher and licensee Libertas Academica Ltd.</copyright-statement><copyright-year>2013</copyright-year><license license-type="open-access"><license-p>This is an open access article published under the Creative Commons CC-BY-NC 3.0 license.</license-p></license></permissions><abstract><p>In recent years, RNA-seq has become a very competitive alternative to microarrays. In RNA-seq experiments, the expected read count for a gene is proportional to its expression level multiplied by its transcript length. Even when two genes are expressed at the same level, differences in length will yield differing numbers of total reads. The characteristics of these RNA-seq experiments create a <italic>gene-level bias</italic> such that the proportion of significantly differentially expressed genes increases with the transcript length, whereas such bias is not present in microarray data. Gene-set analysis seeks to identify the gene sets that are enriched in the list of the identified significant genes. In the gene-set analysis of RNA-seq, the gene-level bias subsequently yields the <italic>gene-set-level bias</italic> that a gene set with genes of long length will be more likely to show up as enriched than will a gene set with genes of shorter length. Because gene expression is not related to its transcript length, any gene set containing long genes is not of biologically greater interest than gene sets with shorter genes. Accordingly the gene-set-level bias should be removed to accurately calculate the statistical significance of each gene-set enrichment in the RNA-seq.</p><p>We present a new gene set analysis method of RNA-seq, called FDRseq, which can accurately calculate the statistical significance of a gene-set enrichment score by the grouped false-discovery rate. Numerical examples indicated that FDRseq is appropriate for controlling the transcript length bias in the gene-set analysis of RNA-seq data. To implement FDRseq, we developed the <italic>R</italic> program, which can be downloaded at no cost from <ext-link ext-link-type="uri" xlink:href="http://home.mju.ac.kr/home/index.action?siteId=tyang">http://home.mju.ac.kr/home/index.action?siteId=tyang</ext-link>.</p></abstract><kwd-group><kwd>FDRseq</kwd><kwd>gene-level bias</kwd><kwd>gene-set analysis</kwd><kwd>gene-set-level bias</kwd><kwd>grouped false-discovery rate</kwd><kwd>RNA-seq</kwd></kwd-group></article-meta></front><body><sec><title>Introduction</title><p>Over the past decade, microarrays have been the primary choice for genome-wide gene expression analysis. In recent years, RNA-seq has become a very competitive alternative to the microarray approach. RNA-seq refers to the use of high-throughput sequencing technologies to sequence cDNA to obtain information about a sample&#x02019;s RNA content (<ext-link ext-link-type="uri" xlink:href="http://en.wikipedia.org/wiki/RNA-Seq">http://en.wikipedia.org/wiki/RNA-Seq</ext-link>). In the RNA-seq experiment, purified RNA is amplified, shattered, and reverse transcribed into cDNA. These short pieces of cDNA are sequenced on a high-throughput platform such as Illumina HiSeq, SOLiD, or Roche 454, providing a list of short sequences called reads. Millions of short reads (25 to 300 bp) are then mapped to a library in which reference sequences are constructed, showing us which region each read comes from.<xref ref-type="bibr" rid="b1-ebo-9-2013-467">1</xref> Note that the library can use the genome itself, annotated exons, or the dataset as its reference sequences. Because reads show higher reproducibility between technical replicates than microarray-based approaches do,<xref ref-type="bibr" rid="b2-ebo-9-2013-467">2</xref>,<xref ref-type="bibr" rid="b3-ebo-9-2013-467">3</xref> RNA-seq data are less noisy and thus more precise at detecting expression differences than microarrays are.</p><p>In the RNA-seq experiment, for a set of regions of interest on the genome, we count the number of reads mapped unambiguously to each region and use this count as a measure of expression of that region. For simplicity, we refer to such regions as genes. The expression levels of genes for RNA-seq datasets are represented as discrete read counts, arising from either a Poisson density or a negative binomial density, whereas those for microarrays are represented as continuous numbers. A gene-level <italic>P</italic>-value for differential expression among different conditions is obtained by several methods including edgeR,<xref ref-type="bibr" rid="b4-ebo-9-2013-467">4</xref>&#x02013;<xref ref-type="bibr" rid="b6-ebo-9-2013-467">6</xref> DEGseq,<xref ref-type="bibr" rid="b7-ebo-9-2013-467">7</xref> DESeq,<xref ref-type="bibr" rid="b8-ebo-9-2013-467">8</xref> baySeq,<xref ref-type="bibr" rid="b9-ebo-9-2013-467">9</xref> and RPKM (reads per kilobase of exon model per million mapped reads)<xref ref-type="bibr" rid="b10-ebo-9-2013-467">10</xref> which are available in the <italic>R</italic> program software package. Kvam et al<xref ref-type="bibr" rid="b11-ebo-9-2013-467">11</xref> compared the performance of these methods and insisted that baySeq has the highest true-positive rates at low rates of false positives.</p><p>A gene set of interest is a group of genes that share a common biological function, chromosomal location, or regulation. Gene sets are always given a priori according to the information provided by public databases such as Gene Ontology,<xref ref-type="bibr" rid="b12-ebo-9-2013-467">12</xref> KEGG,<xref ref-type="bibr" rid="b13-ebo-9-2013-467">13</xref> Biocarta (<ext-link ext-link-type="uri" xlink:href="http://www.biocarta.com">http://www.biocarta.com</ext-link>), and GenMAPP (<ext-link ext-link-type="uri" xlink:href="http://www.genmapp.org">http://www.genmapp.org</ext-link>), by cytogenetic bands, by region of genomic sequence, or by the functional relationships among genes. The main purpose of gene-set analysis (GSA) seeks to identify the gene sets that are enriched in the list of the identified significant genes. The conventional GSA methods use either a gene-set enrichment score or gene-set-level statistic to measure the degree of enrichment, and compute its significance by comparison with random sampling.</p><p>In GSA, many tests are carried out to find the list of significant genes and the list of enriched gene sets so that the statistical significance of each gene-level test and each gene-set-level test is adjusted for multiple testing by controlling the false-discovery rate (FDR), which is defined as the proportion of null hypotheses that are rejected incorrectly.<xref ref-type="bibr" rid="b14-ebo-9-2013-467">14</xref> This is a necessary step in high-dimensional testing problems in genomic data analysis.</p><p>In RNA-seq experiments, the expected read count for a transcript is proportional to the gene&#x02019;s expression level multiplied by its transcript length. Even when two transcripts are expressed at the same level, the differences in length will yield differing numbers of total reads. The characteristics of these RNA-seq experiments cause the <italic>gene-level-bias</italic> in which the proportion of significantly differentially expressed genes increases with the transcript length, as shown in <xref ref-type="fig" rid="f1-ebo-9-2013-467">Figure 1A&#x02013;C</xref> and <xref ref-type="fig" rid="f2-ebo-9-2013-467">Figure 2</xref>. However, such increasing bias is not present in microarray data,<xref ref-type="bibr" rid="b15-ebo-9-2013-467">15</xref>,<xref ref-type="bibr" rid="b16-ebo-9-2013-467">16</xref> as shown in <xref ref-type="fig" rid="f1-ebo-9-2013-467">Figure 1D</xref>.</p><p>The gene-level bias subsequently yields the <italic>gene-set- level bias</italic> in which a gene set with genes of long length will be more likely to show up as enriched than will a gene set with genes of shorter length. For instance, Fisher&#x02019;s exact test is a commonly used method for identifying the enriched gene sets of microarray data. The test is based on the hypergeometric density as its null distribution under the standard assumption that all genes are independent and equally likely to be selected as differentially expressed under the null hypothesis.</p><p>Because the standard assumption does not hold for the RNA-seq data due to the gene-level bias, Fisher&#x02019;s exact test clearly shows the gene-set-level bias (<xref ref-type="fig" rid="f3-ebo-9-2013-467">Fig. 3</xref>). Because the analysis of the microarray datasets (<xref ref-type="fig" rid="f1-ebo-9-2013-467">Fig. 1D</xref>) shows no evidence of gene-level bias,<xref ref-type="bibr" rid="b15-ebo-9-2013-467">15</xref>,<xref ref-type="bibr" rid="b16-ebo-9-2013-467">16</xref> gene sets containing long genes are not of biologically greater interest than gene sets with shorter genes. For accurately calculating the statistical significance of a gene-set enrichment score in RNA-seq, the gene-set-level bias should be removed. Ignorance of the gene-set-level bias in the GSA of the RNA-seq can be dangerous.</p><p>In this paper, we present a new GSA method of RNA-seq, called FDRseq, which can properly remove the gene-set-level bias of the RNA-seq using the grouped FDR method. The statistical significance of each gene-set enrichment score is adjusted for multiple testing using the FDR. When calculating the FDR of each gene-set enrichment score, we sequentially order all gene sets according to their median gene lengths and then split these gene sets into four subgroups: short, moderately short, moderately long, and long genes. A gene set is only compared to gene sets in the same subgroup that have similar transcript lengths.</p><p>Controlling grouped FDR would give a similar number of enriched gene sets in each group so that the gene sets containing long genes are not more enriched than those with shorter genes. Therefore, the gene-set-level bias can be properly removed.</p></sec><sec><title>FDRseq</title><p>In FDRseq, when calculating the FDR of each gene-set enrichment score, we sequentially ordered all gene sets according to their median gene lengths and then split these gene sets into four subgroups: short, moderately short, moderately long, and long genes. We separately conducted FDR analysis within each subgroup at the same FDR level <italic>&#x003b1;</italic>, and then combined the test results from individual analyses. Sun et al<xref ref-type="bibr" rid="b17-ebo-9-2013-467">17</xref> and Efron<xref ref-type="bibr" rid="b18-ebo-9-2013-467">18</xref> showed that when FDR in each subgroup is controlled at the same level <italic>&#x003b1;</italic>, the overall FDR is controlled at <italic>&#x003b1;</italic>. Because a gene set is only compared with gene sets in the same subgroup that have similar median transcript lengths, controlling the FDR by grouping would give a similar number of enriched gene sets in each group. Several authors<xref ref-type="bibr" rid="b19-ebo-9-2013-467">19</xref>&#x02013;<xref ref-type="bibr" rid="b22-ebo-9-2013-467">22</xref> have discussed the legitimacy of the grouped FDR method.</p><sec><title>Random sampling with selection probability</title><p>With the list of significant genes, we determined which genes are significantly differentially expressed. Each gene is then respectively assigned 0 or 1, according to whether or not the gene is found to be significant. When <italic>N</italic> genes in the RNA-seq experiment are ordered sequentially according to their transcript lengths, genes can be divided into 10 bins, which are separated by the 10th, 20th, &#x02026;, and 90th percentiles in the distribution of the transcript lengths of all genes. For each bin <italic>i</italic> (for <italic>i</italic> = 1, &#x02026;, 10), we count <italic>&#x003bd;</italic><italic><sub>i</sub></italic>, which is the number of significant genes in bin <italic>i</italic>. Let <italic>&#x003bd;</italic> = <italic>&#x003bd;</italic><sub>1</sub> + &#x02026; + <italic>&#x003bd;</italic><sub>10</sub> be the total number of significant genes. To quantify the weight probability of selecting bin <italic>i</italic>, we standardize the value by <italic>&#x003bd;</italic><italic><sub>i</sub></italic>/<italic>&#x003bd;</italic>. We call this the selection probability of bin <italic>i</italic>. It is the empirical weight probability that each gene will be included in the significant gene list by its transcript length. The probability is incorporated into the random sampling as follows. We first select a bin according to the selection probabilities. A gene is then randomly chosen from the selected bin. This implies that genes with similar length have an equal probability of being chosen as differentially expressed, but genes with differing lengths have different probabilities according to the empirical selection probability.</p></sec><sec><title>Gene-set enrichment score</title><p>We define a simple gene-set enrichment score to measure the degree of enrichment. Suppose that <italic>K</italic> predefined gene sets of <italic>S</italic><sub>1</sub>, &#x02026;, <italic>S</italic><italic><sub>K</sub></italic> are under consideration. If there exist <italic>r</italic><italic><sub>k</sub></italic> significant genes of <italic>m</italic><italic><sub>k</sub></italic> genes in a gene set <italic>S</italic><italic><sub>k</sub></italic> (<italic>k</italic> = 1, &#x02026;, <italic>K</italic>), then the gene-set enrichment score is defined as</p><disp-formula id="fd1-ebo-9-2013-467"><mml:math id="mm1"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>;</mml:mo></mml:mrow></mml:math></disp-formula><p>this measures the size of the overlap between <italic>S</italic><italic><sub>k</sub></italic> and the list of significant genes. Because GSA aims to identify the gene sets that are enriched in the list of the identified significant genes, a larger <italic>E</italic><italic><sub>k</sub></italic> indicates greater enrichment of <italic>S</italic><italic><sub>k</sub></italic>.</p></sec><sec><title>Grouped false-discovery rate to remove gene-set level bias</title><p>We sequentially ordered <italic>K</italic> pre-defined gene sets according to their median gene lengths. These <italic>K</italic> gene sets were then divided into C1 to C4, which were further divided into the 25th, 50th, and 75th percentiles in the distribution of the median transcript lengths of all the gene sets. Thus, C1, C2, C3, and C4 represent the subgroup of gene sets with short, moderately short, moderately long, and long genes, respectively. Then each gene set is compared with gene sets in the same subgroup that have a similar transcript length to that gene set.</p><p>The statistical significance of each gene-set enrichment score is corrected for multiple testing by controlling the FDR. To estimate FDR of <italic>E</italic><italic><sub>k</sub></italic>, we implement the permutation plug-in method.<xref ref-type="bibr" rid="b1-ebo-9-2013-467">1</xref>,<xref ref-type="bibr" rid="b23-ebo-9-2013-467">23</xref>,<xref ref-type="bibr" rid="b24-ebo-9-2013-467">24</xref> In <italic>R</italic> random samples, each random sample is obtained by randomly selecting a set of genes, as many as the number of observed significant genes, according to the proposed selection probability. Let <italic>E</italic><italic><sub>k</sub></italic><italic><sup>x</sup></italic> (<italic>x</italic>=1&#x02026;,<italic>R</italic>) represent the <italic>E</italic><italic><sub>k</sub></italic> value in the x-th randomization of <italic>R</italic> random experiments, and let <italic>E</italic><italic><sub>k</sub></italic><sup>0</sup> be the observed value <italic>E</italic><italic><sub>k</sub></italic>. When <italic>S</italic><italic><sub>k</sub></italic> &#x003b5; <italic>C</italic><italic><sub>i</sub></italic><italic>,</italic> the grouped FDR of <italic>E</italic><italic><sub>k</sub></italic> is given by</p><disp-formula id="fd2-ebo-9-2013-467"><label>(1)</label><mml:math id="mm2"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>FDR</mml:mtext></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>y</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo>&#x02264;</mml:mo><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>y</mml:mi><mml:mi>x</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mtext>Rank&#x02009;of&#x02009;</mml:mtext><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mi>&#x02009;</mml:mi><mml:mtext>in&#x02009;</mml:mtext><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><p>The numerator represents a count of how many simulated <italic>E</italic><italic><sub>k</sub></italic> values are greater than or equal to the observed experimental <italic>E</italic><italic><sub>k</sub></italic><sup>0</sup> value occurring in a list of gene sets of <italic>C</italic><italic><sub>i</sub></italic>. From this, the average expected value is calculated. The denominator denotes the position of gene set <italic>S</italic><italic><sub>k</sub></italic> in <italic>C</italic><italic><sub>i</sub></italic><italic>,</italic> that is, it is the number of gene sets considered as enriched in <italic>C</italic><italic><sub>i</sub></italic></p><p>When FDR<italic><sub>k</sub></italic>,&#x0003c; <italic>&#x003b1;</italic>, the gene set <italic>S</italic><italic><sub>k</sub></italic> is enriched at the level of <italic>&#x003b1;</italic>. When FDR in each <italic>C</italic><italic><sub>i</sub></italic> is controlled at the same level <italic>&#x003b1;</italic>, the overall FDR is controlled at <italic>&#x003b1;</italic>.<xref ref-type="bibr" rid="b17-ebo-9-2013-467">17</xref>,<xref ref-type="bibr" rid="b18-ebo-9-2013-467">18</xref> Finally, we combine the obtained false-discovery rates over C1&#x02013;C4 to rank <italic>K</italic> gene sets.</p></sec></sec><sec sec-type="results"><title>Results</title><p>For numerical examples, we used the two RNA-seq datasets of Marioni et al<xref ref-type="bibr" rid="b2-ebo-9-2013-467">2</xref> and Li et al,<xref ref-type="bibr" rid="b25-ebo-9-2013-467">25</xref> which have been widely used in the literature on RNA-seq data analysis.</p><sec sec-type="methods"><title>Marioni et al dataset</title><p>The study by Marioni et al<xref ref-type="bibr" rid="b2-ebo-9-2013-467">2</xref> was designed to compare the RNA-seq experiment with the microarray experiment.</p><p>The microarray data were generated from human kidney and liver tissues, with each tissue profiled on Affymetrix HG-U133 Plus 2.0 arrays in three technical replicates. The microarray dataset contained 17,708 genes. For identifying differentially expressed genes between the kidney and liver, we used the <italic>P</italic>-values from simple <italic>t</italic>-test statistics. We then generated a list of 8,730 significant genes with a false-discovery rate of 0.01. For comparison purposes, the Affymetrix gene IDs of the microarray dataset were mapped to the Ensembl gene IDs of the RNA-seq dataset using the biomaRt (<ext-link ext-link-type="uri" xlink:href="http://www.biomart.org">http://www.biomart.org</ext-link>). When multiple Affymetrix probe sets had the same Ensembl gene ID, the median expression of these probe sets was used as the expression level for the Ensembl gene ID.</p><p>An RNA-seq dataset was generated for the same human liver and kidney tissues with five runs per tissue using the Illumina Genome Analyzer. The RNA-seq dataset contained 32,000 genes, but many of them had no more than five reads in total. These genes were removed. We also removed genes that were not on the Affymetrix U133 plus 2.0 microarray for comparison purposes.</p><p>Human gene lengths were obtained from the UCSC genome browser (<ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu/cgibin/hgTables">http://genome.ucsc.edu/cgibin/hgTables</ext-link>). We used R-package &#x02018;geneLen DataBase&#x02019;, which provides the mapping between an Ensembl gene ID of the RNA-seq dataset and its associated transcripts. Genes were removed if their transcript lengths were not available in the database. Finally, 15,097 genes were left for analysis.</p><p>Each gene-level <italic>P</italic>-value for differential expression between the liver and kidney tissue was obtained using edger.<xref ref-type="bibr" rid="b4-ebo-9-2013-467">4</xref>&#x02013;<xref ref-type="bibr" rid="b6-ebo-9-2013-467">6</xref> These <italic>P</italic>-values were corrected for multiple testing, and the FDR was set to 0.01. We obtained a list of 10,697 significant genes in the RNA-seq dataset. For comparison, DESeq<xref ref-type="bibr" rid="b8-ebo-9-2013-467">8</xref> and RPKM<xref ref-type="bibr" rid="b10-ebo-9-2013-467">10</xref> were also applied to the dataset. In <xref ref-type="fig" rid="f1-ebo-9-2013-467">Figure 1</xref>, the percentages of significant genes from the RNA-seq and the microarray dataset are respectively plotted as a function of gene length. Each point represents a bin of 300 genes with similar transcript length. <xref ref-type="fig" rid="f1-ebo-9-2013-467">Figure 1A&#x02013;C</xref> show a strong increasing pattern representing the gene-level bias of the RNA-seq, whereas <xref ref-type="fig" rid="f1-ebo-9-2013-467">Figure 1D</xref> shows no systematic increasing trend between the square root of the gene length and the differential expression in the microarray data. Rather, <xref ref-type="fig" rid="f1-ebo-9-2013-467">Figure 1D</xref> interestingly shows a weak decreasing trend, which is the opposite pattern to the gene-level bias in the RNA-seq data.</p><p>Hereafter, the following results were based on the significant genes obtained from edgeR. We found 14,681 gene sets matched with human genes from the Gene Ontology Consortium database and discarded the gene sets with fewer than five and those with more than 500 genes, because gene sets that are too small or too large are often excluded from analyses in practice.<xref ref-type="bibr" rid="b26-ebo-9-2013-467">26</xref> We then analyzed 6,805 gene sets from the database. With these gene sets, we applied (I) Fisher&#x02019;s exact test using a hypergeometric distribution test to the microarray dataset, (II) Fisher&#x02019;s exact test using hypergeometric distribution testing to the RNA-seq dataset, (III) GOseq<xref ref-type="bibr" rid="b27-ebo-9-2013-467">27</xref> using the Wallenius distribution to the RNA-seq dataset, (IV) GOseq using probability weighting function to the RNA-seq dataset, (V) Gao et al&#x02019;s method<xref ref-type="bibr" rid="b26-ebo-9-2013-467">26</xref> to the RNA-seq dataset, and (VI) FDRseq to the RNA-seq dataset. For (I)&#x02013;(VI), the gene sets were ranked based on the FDRs, and the top 600 gene sets were respectively selected as enriched. In <xref ref-type="fig" rid="f4-ebo-9-2013-467">Figures 4</xref> and <xref ref-type="fig" rid="f5-ebo-9-2013-467">5</xref>, we considered (I) as the standard method and compared (I) with (II)&#x02013;(VI).</p><p>In (III) and (IV), GOseq (<ext-link ext-link-type="uri" xlink:href="http://bioinf.wehi.edu.au/software/goseq">http://bioinf.wehi.edu.au/software/goseq</ext-link>)<xref ref-type="bibr" rid="b27-ebo-9-2013-467">27</xref> respectively used the Wallenius distribution and the probability weighting function rather than the hypergeometric distribution as the null distribution for Fisher&#x02019;s exact test. The Wallenius distribution is a generalization of the hypergeometric distribution in the case where the probability of choosing a gene within or outside of a gene set is defined as the non-central parameter within and outside of that gene set. It indicates that all genes within the gene set have the same probability of being chosen, but this probability is different from the probability of choosing genes outside of this gene set. In (V), the Gao et al&#x02019;s method<xref ref-type="bibr" rid="b26-ebo-9-2013-467">26</xref> used the square root of the gene length as Wallenius&#x02019;s non-central parameter which is different from GOseq.<xref ref-type="bibr" rid="b27-ebo-9-2013-467">27</xref></p><p>We sequentially ordered 6,805 gene sets according to their median gene lengths and then divided these gene sets into C1 through C4, which were separated further at the 25th, 50th, and 75th percentiles in the distribution of the median transcript lengths of all gene sets. <xref ref-type="fig" rid="f4-ebo-9-2013-467">Figure 4</xref> shows the percentages of enriched gene sets plotted as a function of the median transcript length of the gene sets, where C1&#x02013;C4 represent the gene sets with short, moderately short, moderately long, and long genes, respectively. We calculated the sum of proportion differences over C1&#x02013;C4 between the standard method (I) vs. each of (II)&#x02013;(VI), yielding results of 0.204 (I vs. II), 0.118 (I vs. III), 0.114 (I vs. IV), 0.076 (I vs. V), and 0.080 (I vs. VI). FDRseq (VI) and Gao et al&#x02019;s method (V) have lower values of 0.080 and 0.076, respectively, indicating that FDRseq and Gao et al&#x02019;s method are, overall, closer to the standard method than are other methods. Furthermore, FDRseq has approximately 25% enriched gene sets over the range of C1&#x02013;C4, which indicates that FDRseq properly controls the gene-set-level bias of RNA-seq data.</p><p>In <xref ref-type="fig" rid="f5-ebo-9-2013-467">Figure 5</xref>, the proportions of overlapping gene sets between (I) vs. each of (II)&#x02013;(VI) are plotted for the 50 top-ranked gene sets. The figure represents that FDRseq and the Gao et al method<xref ref-type="bibr" rid="b26-ebo-9-2013-467">26</xref> had more overlap with the standard method (I) than did the other methods.</p></sec><sec sec-type="methods"><title>Li et al dataset</title><p>In the RNAseq dataset of Li et al,<xref ref-type="bibr" rid="b25-ebo-9-2013-467">25</xref> the prostate cancer cell line LNCap was treated with mock/DHT. For the mock-treated cells, there were four runs totaling 10 million reads. For the DHT-treated cells, there were three runs totaling 7 million reads. All seven runs were technical replicates.</p><p>The dataset originally contained 49,506 human genes, but many of them had no more than five reads total. These genes were removed, leaving 16,141 genes for further analysis. Each gene-level <italic>P</italic>-value for differential expression between the treated and untreated samples was obtained using edgeR.<xref ref-type="bibr" rid="b4-ebo-9-2013-467">4</xref>&#x02013;<xref ref-type="bibr" rid="b6-ebo-9-2013-467">6</xref> The <italic>P</italic>-values from edgeR were adjusted for multiple testing, and the FDR was set to 0.05. We then obtained a list of 2,986 significant genes in the RNA-seq dataset. The genes were grouped according to their transcript length, with 300 genes in each bin. For comparison, DESeq<xref ref-type="bibr" rid="b8-ebo-9-2013-467">8</xref> and RPKM<xref ref-type="bibr" rid="b10-ebo-9-2013-467">10</xref> were also applied to the dataset. <xref ref-type="fig" rid="f2-ebo-9-2013-467">Figure 2</xref> shows the percentages of significant genes from the RNAseq data plotted as a function of the gene length. The figure clearly shows the gene-level bias; the probability of significant genes increased with the gene length.</p><p>Hereafter, the following results were based on the significant genes obtained from edgeR. We found 13,929 matched gene sets with the human genes from the Gene Ontology Consortium database and discarded the gene sets with fewer than five or more than 500 genes; gene sets too small or too large are often excluded from analyses in practice.<xref ref-type="bibr" rid="b26-ebo-9-2013-467">26</xref> We then analyzed 6,187 gene sets further. To calculate the statistical significance of each gene-set enrichment, (I) Fisher&#x02019;s exact test using the hypergeometric distribution, (II) the typical gene-randomization sampling (described in Discussion Section) with 100,000 repetitions, (III) GOseq<xref ref-type="bibr" rid="b27-ebo-9-2013-467">27</xref> using the Wallenius distribution to the RNA-seq dataset, (IV) GOseq using a probability weighting function, (V) Gao et al&#x02019;s method,<xref ref-type="bibr" rid="b26-ebo-9-2013-467">26</xref> and (VI) FDRseq were applied to the 6,187 gene sets. For (I)&#x02013;(VI), the gene sets were ranked based on the FDRs, and the top 500 gene sets were selected as enriched.</p><p>In (I), Fisher&#x02019;s exact test was based on the hypergeometric density under the standard assumption that the probability of each gene entering the significant gene list was the same. <xref ref-type="fig" rid="f3-ebo-9-2013-467">Figure 3</xref> shows the percentages of enriched gene sets plotted as a function of the median transcript length of the gene sets. Because the equal selection probability does not hold for the RNA-seq data due to the gene-level bias as shown in <xref ref-type="fig" rid="f2-ebo-9-2013-467">Figure 2</xref>, the test tends to be enriched for the gene sets with longer genes, and <xref ref-type="fig" rid="f3-ebo-9-2013-467">Figure 3</xref> clearly shows the gene-set-level bias of the RNA-seq data.</p><p><xref ref-type="fig" rid="f6-ebo-9-2013-467">Figure 6</xref> shows the percentages of enriched gene sets plotted over the range C1&#x02013;C4. As we expected, FDRseq provides a closer approximation to 25% of the enriched gene sets across C1&#x02013;C4 than the other methods do. This indicates that FDRseq gives a similar number of enriched gene sets to each group, which properly controls the gene-set-level bias of the RNA-seq data.</p></sec></sec><sec><title>Simulation study for the performance of FDRseq</title><p>We conducted a simulation study to compare FDRseq with the other methods, with respect to their suitability for removing the gene-set-level bias. In this study, we used 16,075 genes and 6,805 gene sets as given in the numerical example of Marioni et al.<xref ref-type="bibr" rid="b2-ebo-9-2013-467">2</xref> Human gene lengths were obtained from the UCSC genome browser (<ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu/cgibin/hgTables">http://genome.ucsc.edu/cgibin/hgTables</ext-link>) for each combination of human genome and Ensembl gene ID of the RNAseq.</p><p>We randomly sampled 16,075 gene-level <italic>P</italic>-values according to the gene length; 0.1 * Uniform (0, 0.01) +0.9 * Uniform (0.01, 1) in the first quartile of the gene length distribution (C1); 0.2 * Uniform (0, 0.01) + 0.8 * Uniform (0.01, 1) in the middle two quartiles of the distribution (C2 and C3); 0.3 * Uniform (0, 0.01) +0.7 * Uniform (0.01, 1) in the fourth quartile (C4), where Uniform(a,b) represents uniform density within the two boundaries of a and b. The FDR for testing the significance of each gene was set at 0.01. The simulated <italic>P</italic>-values clearly represent the bias pattern that the proportion of significantly differentially expressed genes increases with the gene length. With these simulated <italic>P</italic>-values, we analyzed 6,805 gene sets by applying (I) Fisher&#x02019;s exact test using the hypergeometric distribution, (II) GOseq using the Wallenius distribution to the RNA-seq dataset, (III) GOseq using a probability weighting function for the RNA-seq dataset, (IV) Gao et al&#x02019;s method to the RNA-seq dataset, and (V) FDRseq. Then, the top 500 ranked gene sets were selected as enriched.</p><p>One thousand simulations were executed to obtain the empirical distribution for the proportion of enriched gene sets as a function of the median transcript length of the gene sets. <xref ref-type="fig" rid="f7-ebo-9-2013-467">Figure 7</xref> shows the simulated results for the percentages of enriched gene sets plotted as a function of the median transcript length of the gene sets. FDRseq has approximately 25% enriched gene sets over the range of C1&#x02013;C4. This indicates that FDRseq more appropriately controls the gene-set-level bias of RNA-seq data than GOseq and Fisher&#x02019;s exact test do.</p></sec><sec sec-type="discussion"><title>Discussion</title><p>In the typical gene-randomization sampling scheme, the <italic>P</italic>-value for enrichment of a gene set of interest, <italic>S</italic><italic><sub>k</sub></italic> (for a total of <italic>m</italic><italic><sub>k</sub></italic> genes), was generated using random sampling of <italic>m</italic><italic><sub>k</sub></italic> genes from the full set of all genes, with an equal selection weight for each gene. For each of the <italic>R</italic> repetitions, we counted the number of significant genes in the generated gene set by comparison with the number of observed significant genes of <italic>S</italic><italic><sub>k</sub></italic>. The <italic>P</italic>-value for enrichment of <italic>S</italic><italic><sub>k</sub></italic> was calculated as a fraction of the resampled gene sets in that the number of significant genes was greater than or equal to the number of observed significant genes. The statistical significance of each <italic>P</italic>-value was corrected for multiple testing by controlling the FDR. The total number of random samples of typical sampling was <italic>K</italic> (number of gene sets) &#x000d7; <italic>R</italic> (number of repetitions). When <italic>K</italic> is large, the typical scheme requires heavy, time- consuming computation. In contrast, FDRseq performed only <italic>R</italic> repetitions, where each random sample was obtained by randomly selecting a set of genes as large as the observed significant genes according to the proposed selection probability. The computational reduction afforded by FDRseq is formidable.</p><p>The gene-length bias is inherent to the nature of RNA-seq because there are essentially more reads for longer genes. In GSA, the gene-level bias clearly yields the gene-set-level bias in which a gene set with genes of long length will be more likely to show up as enriched than will a gene set with genes of shorter length. Correction for the gene-length-bias is necessary. For calculating the statistical significance of each gene-set enrichment score, the conventional GSA methods established for the microarray data, such as Fisher&#x02019;s exact test, gave biased results for RNA-seq data. We have provided a new GSA to properly take into account the bias of RNA-seq data. Numerical results and simulations indicated that FDRseq is appropriate for controlling bias in the gene-set analysis of RNA-seq data. Because the main purpose of executing GSA analysis is to rank the gene sets based on pathways or GO terms for follow-up research, FDRseq would provide an accurate list of enriched gene sets.</p><p>Although FDRseq was originally developed to accurately calculate the statistical significance of each gene-set enrichment in the RNA-seq data, the technique can also be applied directly to the gene-set analysis of the microarray data. In this sense, FDRseq is a unified gene-set analysis method for assessing gene-set enrichment in either microarray data or RNA-seq data.</p><p>Zheng et al<xref ref-type="bibr" rid="b28-ebo-9-2013-467">28</xref> interestingly insisted that gene expression levels of RNA-seq are also biased with respect to other factors, such as GC content and dinucleotide frequencies. However, it is not clear to us how GC content and dinucleotide frequencies affect the GSA of RNA-seq or how to remove their corresponding bias in conducting the GSA of RNA-seq. More research is needed on this topic.</p></sec></body><back><fn-group><fn id="fn1-ebo-9-2013-467"><p><bold>Author Contributions</bold></p><p>Conceived the proposed method: TYY. Designed the experiments: TYY. Analyzed the data: SJ. Wrote the first draft of the manuscript: TYY. Contributed to the writing of the manuscript: TYY. Agree with manuscript results and conclusions: TYY, SJ. Made critical revisions and approved final revision: TYY, SJ. All authors reviewed and approved of the final manuscript.</p></fn><fn id="fn2-ebo-9-2013-467"><p><bold>Competing Interests</bold></p><p>Author(s) disclose no potential conflicts of interest.</p></fn><fn id="fn3-ebo-9-2013-467"><p><bold>Disclosures</bold></p><p>As a requirement of publication the authors have provided signed confirmation of their compliance with ethical and legal obligations including but not limited to compliance with ICMJE authorship and competing interests guidelines, that the article is neither under consideration for publication nor published elsewhere, of their compliance with legal and ethical guidelines concerning human and animal research participants (if applicable), and that permission has been obtained for reproduction of any copyrighted material. This article was subject to blind, independent, expert peer review. The reviewers reported no competing interests.</p></fn><fn id="fn4-ebo-9-2013-467"><p><bold>Funding</bold></p><p>This research was supported by Basic Science Research Program (NRF-2011-0016383) through the National Research Foundation of Korea (NRF) funded by the Ministry of Science, ICT &#x00026; Future Planning.</p></fn></fn-group><ref-list><title>References</title><ref id="b1-ebo-9-2013-467"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><article-title>Finding consistent patterns: a nonparametric approach for identifying differential expression in RNA-seq data</article-title><source>Stat Methods Med Res</source><year>2011</year></element-citation></ref><ref id="b2-ebo-9-2013-467"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marioni</surname><given-names>JC</given-names></name><name><surname>Mason</surname><given-names>CE</given-names></name><name><surname>Mane</surname><given-names>SM</given-names></name><name><surname>Stephens</surname><given-names>M</given-names></name><name><surname>Gilad</surname><given-names>Y</given-names></name></person-group><article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title><source>Genome Res</source><year>2008</year><volume>18</volume><fpage>1509</fpage><lpage>17</lpage><pub-id pub-id-type="pmid">18550803</pub-id></element-citation></ref><ref id="b3-ebo-9-2013-467"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>t Hoen</surname><given-names>PA</given-names></name><name><surname>Ariyurek</surname><given-names>Y</given-names></name><name><surname>Thygesen</surname><given-names>HH</given-names></name><etal/></person-group><article-title>Deep sequencing-based expression analysis shows major advances in robustness, resolution and inter-lab portability over five microarray platforms</article-title><source>Nucleic Acids Res</source><year>2008</year><volume>36</volume><fpage>e141</fpage><pub-id pub-id-type="pmid">18927111</pub-id></element-citation></ref><ref id="b4-ebo-9-2013-467"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>Moderated statistical tests for assessing difference in tag abundance</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><fpage>2881</fpage><lpage>7</lpage><pub-id pub-id-type="pmid">17881408</pub-id></element-citation></ref><ref id="b5-ebo-9-2013-467"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>Small-sample estimation of negative binomial dispersion, with applications to SAGE data</article-title><source>Biostat</source><year>2008</year><volume>9</volume><fpage>321</fpage><lpage>32</lpage></element-citation></ref><ref id="b6-ebo-9-2013-467"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>MD</given-names></name><name><surname>McCarthy</surname><given-names>DJ</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><issue>1</issue><fpage>139</fpage><lpage>40</lpage><pub-id pub-id-type="pmid">19910308</pub-id></element-citation></ref><ref id="b7-ebo-9-2013-467"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Feng</surname><given-names>Z</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Zhang</surname><given-names>X</given-names></name></person-group><article-title>DEGseq: an R package for identifying differentially expressed genes from RNA-seq data</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>136</fpage><lpage>8</lpage><pub-id pub-id-type="pmid">19855105</pub-id></element-citation></ref><ref id="b8-ebo-9-2013-467"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name><name><surname>Huber</surname><given-names>W</given-names></name></person-group><article-title>Differential expression analysis for sequence count data</article-title><source>Genome Biol</source><year>2010</year><volume>11</volume><fpage>R106</fpage><pub-id pub-id-type="pmid">20979621</pub-id></element-citation></ref><ref id="b9-ebo-9-2013-467"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardcastle</surname><given-names>TJ</given-names></name><name><surname>Kelly</surname><given-names>KA</given-names></name></person-group><article-title>baySeq: Empirical Bayesian methods for identifying differential expression in sequence count data</article-title><source>BMC Bioinforma</source><year>2010</year><volume>11</volume><fpage>422</fpage></element-citation></ref><ref id="b10-ebo-9-2013-467"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mortazavi</surname><given-names>A</given-names></name><name><surname>Williams</surname><given-names>BA</given-names></name><name><surname>McCue</surname><given-names>K</given-names></name><name><surname>Schaeffer</surname><given-names>L</given-names></name><name><surname>Wold</surname><given-names>B</given-names></name></person-group><article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title><source>Nat Methods</source><year>2008</year><volume>7</volume><fpage>621</fpage><lpage>8</lpage><pub-id pub-id-type="pmid">18516045</pub-id></element-citation></ref><ref id="b11-ebo-9-2013-467"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kvam</surname><given-names>VM</given-names></name><name><surname>Liu</surname><given-names>P</given-names></name><name><surname>Si</surname><given-names>Y</given-names></name></person-group><article-title>A comparison of statistical methods for detecting differentially expressed genes from RNA-seq data</article-title><source>Am J Bot</source><year>2012</year><volume>99</volume><issue>2</issue><fpage>248</fpage><lpage>56</lpage><pub-id pub-id-type="pmid">22268221</pub-id></element-citation></ref><ref id="b12-ebo-9-2013-467"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashburner</surname><given-names>M</given-names></name><name><surname>Ball</surname><given-names>CA</given-names></name><name><surname>Blake</surname><given-names>JA</given-names></name><etal/></person-group><article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium</article-title><source>Nat Genet</source><year>2000</year><volume>25</volume><fpage>25</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">10802651</pub-id></element-citation></ref><ref id="b13-ebo-9-2013-467"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ogata</surname><given-names>H</given-names></name><name><surname>Goto</surname><given-names>S</given-names></name><name><surname>Sato</surname><given-names>K</given-names></name><name><surname>Fujibuchi</surname><given-names>W</given-names></name><name><surname>Bono</surname><given-names>H</given-names></name><name><surname>Kanehisa</surname><given-names>M</given-names></name></person-group><article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title><source>Nucleic Acids Res</source><year>1999</year><volume>27</volume><fpage>29</fpage><lpage>34</lpage><pub-id pub-id-type="pmid">9847135</pub-id></element-citation></ref><ref id="b14-ebo-9-2013-467"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y</given-names></name><name><surname>Hochberg</surname><given-names>Y</given-names></name></person-group><article-title>Controlling the false discovery rate: a pratical and powerful approach to multiple testing</article-title><source>J R Statist Soc B</source><year>1995</year><volume>57</volume><fpage>289</fpage><lpage>300</lpage></element-citation></ref><ref id="b15-ebo-9-2013-467"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bullard</surname><given-names>JH</given-names></name><name><surname>Purdom</surname><given-names>E</given-names></name><name><surname>Hansen</surname><given-names>KD</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name></person-group><article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title><source>BMC Bioinforma</source><year>2010</year><volume>11</volume><fpage>94</fpage></element-citation></ref><ref id="b16-ebo-9-2013-467"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oshlack</surname><given-names>A</given-names></name><name><surname>Wakefield</surname><given-names>MJ</given-names></name></person-group><article-title>Transcript length bias in RNA-seq data confounds systems biology</article-title><source>Biol Direct</source><year>2009</year><volume>4</volume><fpage>14</fpage><pub-id pub-id-type="pmid">19371405</pub-id></element-citation></ref><ref id="b17-ebo-9-2013-467"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>L</given-names></name><name><surname>Craiu</surname><given-names>RV</given-names></name><name><surname>Paterson</surname><given-names>AD</given-names></name><name><surname>Bull</surname><given-names>SB</given-names></name></person-group><article-title>Stratified false discovery control for large-scale hypothesis testing with application to genome-wide association studies</article-title><source>Genet Epidemiol</source><year>2006</year><volume>30</volume><fpage>519</fpage><lpage>30</lpage><pub-id pub-id-type="pmid">16800000</pub-id></element-citation></ref><ref id="b18-ebo-9-2013-467"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Efron</surname><given-names>B</given-names></name></person-group><article-title>Large-scale simultaneous hypothesis testing: the choice of a null hypothesis</article-title><source>J Am Stat Ass</source><year>2004</year><volume>99</volume><fpage>96</fpage><lpage>104</lpage></element-citation></ref><ref id="b19-ebo-9-2013-467"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roeder</surname><given-names>K</given-names></name><name><surname>Devlin</surname><given-names>B</given-names></name><name><surname>Wasserman</surname><given-names>L</given-names></name></person-group><article-title>Improving power in genome-wide association studies: weights tip the scale</article-title><source>Genet Epidemiol</source><year>2007</year><volume>31</volume><issue>7</issue><fpage>741</fpage><lpage>7</lpage><pub-id pub-id-type="pmid">17549760</pub-id></element-citation></ref><ref id="b20-ebo-9-2013-467"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cai</surname><given-names>T</given-names></name><name><surname>Sun</surname><given-names>W</given-names></name></person-group><article-title>Simultaneous Testing of Grouped Hypotheses: Finding Needles in Multiple Haystacks</article-title><source>J Am Stat Ass</source><year>2009</year><volume>104</volume><fpage>1467</fpage><lpage>81</lpage></element-citation></ref><ref id="b21-ebo-9-2013-467"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>JX</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name><name><surname>Zhou</surname><given-names>HH</given-names></name></person-group><article-title>False Discovery Rate Control With Groups</article-title><source>J Am Stat Ass</source><year>2010</year><volume>105</volume><fpage>1215</fpage><lpage>27</lpage><pub-id pub-id-type="pmid">21931466</pub-id></element-citation></ref><ref id="b22-ebo-9-2013-467"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Genovese</surname><given-names>CR</given-names></name><name><surname>Roeder</surname><given-names>K</given-names></name><name><surname>Wasserman</surname><given-names>L</given-names></name></person-group><article-title>False discovery control with <italic>P</italic>-value weighting</article-title><source>Biometrika</source><year>2006</year><volume>93</volume><fpage>509</fpage><lpage>24</lpage></element-citation></ref><ref id="b23-ebo-9-2013-467"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Storey</surname><given-names>J</given-names></name></person-group><article-title>The positive false discovery rate: A Bayesian interpretation and the q-value</article-title><source>Ann Stat</source><year>2003</year><volume>31</volume><fpage>2013</fpage><lpage>25</lpage></element-citation></ref><ref id="b24-ebo-9-2013-467"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tusher</surname><given-names>V</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name><name><surname>Chu</surname><given-names>C</given-names></name></person-group><article-title>Significance analysis of microarrays applied to the ionizing radiation response</article-title><source>Proc Natl Acad Sci U S A</source><year>2001</year><volume>98</volume><fpage>5116</fpage><lpage>21</lpage><pub-id pub-id-type="pmid">11309499</pub-id></element-citation></ref><ref id="b25-ebo-9-2013-467"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Lovci</surname><given-names>MT</given-names></name><name><surname>Kwon</surname><given-names>YS</given-names></name><name><surname>Rosenfeld</surname><given-names>MG</given-names></name><name><surname>Fu</surname><given-names>XD</given-names></name><name><surname>Yeo</surname><given-names>GW</given-names></name></person-group><article-title>Determination of tag density required for digital transcriptome analysis: application to an androgen-sensitive prostate cancer model</article-title><source>Proc Natl Acad Sci U S A</source><year>2008</year><volume>105</volume><fpage>20179</fpage><lpage>84</lpage><pub-id pub-id-type="pmid">19088194</pub-id></element-citation></ref><ref id="b26-ebo-9-2013-467"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>L</given-names></name><name><surname>Fang</surname><given-names>Z</given-names></name><name><surname>Zhang</surname><given-names>K</given-names></name><name><surname>Zhi</surname><given-names>D</given-names></name><name><surname>Cui</surname><given-names>X</given-names></name></person-group><article-title>Length bias correction for RNA-seq data in gene set analyses</article-title><source>Bioinformatics</source><year>2010</year><volume>27</volume><issue>5</issue><fpage>662</fpage><lpage>9</lpage><pub-id pub-id-type="pmid">21252076</pub-id></element-citation></ref><ref id="b27-ebo-9-2013-467"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Young</surname><given-names>MD</given-names></name><name><surname>Wakefield</surname><given-names>MJ</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name><name><surname>Oshlack</surname><given-names>A</given-names></name></person-group><article-title>Gene ontology analysis for RNA-seq: accounting for selection bias</article-title><source>Genome Biol</source><year>2010</year><volume>11</volume><fpage>R14</fpage><pub-id pub-id-type="pmid">20132535</pub-id></element-citation></ref><ref id="b28-ebo-9-2013-467"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>W</given-names></name><name><surname>Chung</surname><given-names>L</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name></person-group><article-title>Bias Detection and Correction in RNA-Sequencing Data</article-title><source>BMC Bioinforma</source><year>2011</year><volume>12</volume><fpage>290</fpage></element-citation></ref></ref-list></back><floats-group><fig id="f1-ebo-9-2013-467" position="float"><label>Figure 1</label><caption><p>Proportion of significant genes as a function of gene length (bases) for the dataset of Marioni et al. (<bold>A</bold>) edgeR with RNA-seq data, (<bold>B</bold>) DEGseq with RNA-seq data, (<bold>C</bold>) RPKM with RNA-seq data, and (<bold>D</bold>) <italic>t</italic>-test with microarray data. The proportion of significantly differentially expressed genes increases with the transcript length in RNA-seq data; such bias is not present in microarray data.</p></caption><graphic xlink:href="ebo-9-2013-467f1"/></fig><fig id="f2-ebo-9-2013-467" position="float"><label>Figure 2</label><caption><p>Gene-level bias of the Li et al&#x02019;s RNA-seq datasets. (<bold>A</bold>) edgeR, (<bold>B</bold>) DEGseq, (<bold>C</bold>) RPKM. The percentages of significant genes from the RNAseq data plotted as a function of the gene length bases. The probability of significant genes increases with the gene length.</p></caption><graphic xlink:href="ebo-9-2013-467f2"/></fig><fig id="f3-ebo-9-2013-467" position="float"><label>Figure 3</label><caption><p>Gene-set-level bias of the Li et al&#x02019;s RNA-seq data. Percentages of enriched gene sets plotted as a function of the median transcript length of the gene sets. Gene sets with longer genes tend to be enriched.</p></caption><graphic xlink:href="ebo-9-2013-467f3"/></fig><fig id="f4-ebo-9-2013-467" position="float"><label>Figure 4</label><caption><p>Proportion of enriched gene sets as a function of the median transcript length of gene sets. (I) &#x02018;Microarray&#x02019; represents Fisher&#x02019;s exact test using a hypergeometric distribution test to the microarray dataset, (II) &#x02018;Fisher&#x02019; represents Fisher&#x02019;s exact test using hypergeometric distribution testing to the RNA-seq dataset, (III) &#x02018;GOseq I&#x02019; represents GOseq using the Wallenius distribution to the RNA-seq dataset, (IV) &#x02018;GOseq II&#x02019; represents GOseq using a probability weighting function to the RNA-seq dataset, (V) &#x02018;Gao&#x02019; represents Gao et al&#x02019;s method applied to the RNA-seq dataset, and (VI) &#x02018;FDRseq&#x02019; represents FDRseq applied to the RNAseq dataset. <bold>C1</bold>, <bold>C2</bold>, <bold>C3</bold>, and <bold>C4</bold> respectively represent the category of gene sets with short, moderately short, moderately long, and long genes. FDRseq and Gao are closer to the standard method (I) than the other methods are. Furthermore, FDRseq has approximately 25% enriched gene sets over the range of <bold>C1</bold>&#x02013;<bold>C4</bold>. This indicates that FDRseq properly controls the gene-set-level bias of the RNA-seq data.</p></caption><graphic xlink:href="ebo-9-2013-467f4"/></fig><fig id="f5-ebo-9-2013-467" position="float"><label>Figure 5</label><caption><p>Proportion of overlapping gene sets between the microarray and RNA-seq. (I) &#x02018;Standard&#x02019; represents Fisher&#x02019;s exact test using a hypergeometric distribution test for the microarray dataset, (II) &#x02018;Fisher&#x02019; represents Fisher&#x02019;s exact test using hypergeometric distribution testing for the RNA-seq dataset, (III) &#x02018;GOseq I&#x02019; represents GOseq using the Wallenius distribution to the RNA-seq dataset, (IV) &#x02018;GOseq II&#x02019; represents GOseq using a probability weighting function for the RNAseq dataset, (V) &#x02018;Gao&#x02019; represents Gao et al&#x02019;s method applied to the RNA-seq dataset, and (VI) &#x02018;FDRseq&#x02019; represents FDRseq applied to the RNA-seq dataset. FDRseq and Gao had more overlap with (I) the standard method than with the other methods.</p></caption><graphic xlink:href="ebo-9-2013-467f5"/></fig><fig id="f6-ebo-9-2013-467" position="float"><label>Figure 6</label><caption><p>Proportion of enriched gene sets as a function of the median transcript length of the gene sets. (I) &#x02018;Fisher&#x02019; represents Fisher&#x02019;s exact test using the hypergeometric distribution, (II) the typical gene-randomization sampling (described in the Discussion) with 100,000 repetitions, (III) &#x02018;GOseq I&#x02019; represents GOseq using the Wallenius distribution, (IV) &#x02018;GOseq II&#x02019; represents GOseq using a probability weighting function, (V) &#x02018;Gao&#x02019; represents Gao et al&#x02019;s method, and (IV) &#x02018;FDRseq&#x02019;. <bold>C1</bold>, <bold>C2</bold>, <bold>C3</bold>, and <bold>C4</bold> represent the category of gene sets with short, moderately short, moderately long, and long genes, respectively. The percentages of enriched gene sets plotted over the range <bold>C1</bold>&#x02013;<bold>C4</bold>. FDRseq provides a closer approximation to 25% of the enriched gene sets across <bold>C1</bold>&#x02013;<bold>C4</bold> than the other three methods do. FDRseq gives a similar number of enriched gene sets to each group, which allows proper control over the gene-set- level bias of the RNA-seq data.</p></caption><graphic xlink:href="ebo-9-2013-467f6"/></fig><fig id="f7-ebo-9-2013-467" position="float"><label>Figure 7</label><caption><p>Simulated results for gene-set-level bias. (I) &#x02018;Fisher&#x02019; represents Fisher&#x02019;s exact test using the hypergeometric distribution, (II) the typical gene-randomization sampling (described in the Discussion) with 100,000 repetitions, (III) &#x02018;GOseq I&#x02019; represents GOseq using the Wallenius distribution, (IV) &#x02018;GOseq II&#x02019; represents GOseq using probability weighting function, (V) Gao represents &#x02018;Gao et al&#x02019;s method&#x02019;<xref ref-type="bibr" rid="b26-ebo-9-2013-467">26</xref>, and (IV) FDRseq. Proportion of enriched gene sets as a function of the median transcript length of the gene sets. <bold>C1</bold>, <bold>C2</bold>, <bold>C3</bold>, and <bold>C4</bold> represent the category of gene sets with short, moderately short, moderately long, and long genes, respectively. FDRseq has approximately 25% enriched gene sets over the range of <bold>C1</bold>&#x02013;<bold>C4</bold>. This indicates that FDRseq more appropriately controls the gene-set-level bias of RNA-seq data compared with other methods.</p></caption><graphic xlink:href="ebo-9-2013-467f7"/></fig></floats-group></article>