<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing3.dtd?><?SourceDTD.Version 3.0?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3715474</article-id><article-id pub-id-type="publisher-id">PONE-D-13-15655</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0068141</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Computational Biology</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome Analysis Tools</subject><subj-group><subject>Trait Locus Analysis</subject><subject>Transcriptomes</subject></subj-group></subj-group><subj-group><subject>Genome Expression Analysis</subject></subj-group></subj-group><subj-group><subject>Molecular Genetics</subject><subj-group><subject>Gene Regulation</subject><subject>Gene Expression</subject></subj-group></subj-group><subj-group><subject>Systems Biology</subject></subj-group></subj-group><subj-group><subject>Genomics</subject><subj-group><subject>Genome Analysis Tools</subject><subject>Genome Expression Analysis</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer Science</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Mathematics</subject><subj-group><subject>Applied Mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></article-categories><title-group><article-title>Normalizing RNA-Sequencing Data by Modeling Hidden Covariates with Prior Knowledge</article-title><alt-title alt-title-type="running-head">Normalizing RNA-Seq Data with Hidden Covariates</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Mostafavi</surname><given-names>Sara</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Battle</surname><given-names>Alexis</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Zhu</surname><given-names>Xiaowei</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Urban</surname><given-names>Alexander E.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Levinson</surname><given-names>Douglas</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Montgomery</surname><given-names>Stephen B.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Koller</surname><given-names>Daphne</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Computer Science, Stanford University, Stanford, California, United States of America</addr-line></aff><aff id="aff2"><label>2</label><addr-line>Department of Psychiatry &#x00026; Behavioral Science, Stanford University, Stanford, California, United States of America</addr-line></aff><aff id="aff3"><label>3</label><addr-line>Department of Pathology, Stanford University, Stanford, California, United States of America</addr-line></aff><contrib-group><contrib contrib-type="editor"><name><surname>Benos</surname><given-names>Panayiotis V.</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1"><addr-line>University of Pittsburgh, United States of America</addr-line></aff><author-notes><corresp id="cor1">* E-mail: <email>koller@cs.stanford.edu</email></corresp><fn fn-type="conflict"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><fn fn-type="con"><p>Conceived and designed the experiments: SM AB DK. Performed the experiments: SM. Analyzed the data: SM. Contributed reagents/materials/analysis tools: SBM XZ AEU DL. Wrote the paper: SM AB.</p></fn></author-notes><pub-date pub-type="collection"><year>2013</year></pub-date><pub-date pub-type="epub"><day>18</day><month>7</month><year>2013</year></pub-date><volume>8</volume><issue>7</issue><elocation-id>e68141</elocation-id><history><date date-type="received"><day>16</day><month>4</month><year>2013</year></date><date date-type="accepted"><day>25</day><month>5</month><year>2013</year></date></history><permissions><copyright-year>2013</copyright-year><copyright-holder>Mostafavi et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Transcriptomic assays that measure expression levels are widely used to study the manifestation of environmental or genetic variations in cellular processes. RNA-sequencing in particular has the potential to considerably improve such understanding because of its capacity to assay the entire transcriptome, including novel transcriptional events. However, as with earlier expression assays, analysis of RNA-sequencing data requires carefully accounting for factors that may introduce systematic, confounding variability in the expression measurements, resulting in spurious correlations. Here, we consider the problem of modeling and removing the effects of known and hidden confounding factors from RNA-sequencing data. We describe a unified residual framework that encapsulates existing approaches, and using this framework, present a novel method, HCP (Hidden Covariates with Prior). HCP uses a more informed assumption about the confounding factors, and performs as well or better than existing approaches while having a much lower computational cost. Our experiments demonstrate that accounting for known and hidden factors with appropriate models improves the quality of RNA-sequencing data in two very different tasks: detecting genetic variations that are associated with nearby expression variations (cis-eQTLs), and constructing accurate co-expression networks.</p></abstract><funding-group><funding-statement>Support for this work was provided by National Institute of Mental Health (grant RC2MH089916 to D.F.L) and National Institute of Health (grant ED-8767-69-ST2 and 152016.5057381.0008 to D.K). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="10"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>The transcriptional landscape of a cell is complex and with the help of RNA-sequencing technology (RNA-seq) we are now starting to characterize it. In particular, RNA-seq technology can assay the entire transcriptome, including known isoforms of each gene and even novel transcripts. Combined with genotyping assays, we can more accurately elucidate the genetics of the transcriptome by identifying diverse transcriptional events that are associated with genetic variants. (Such associated variants are referred to as eQTLs). In this way we can begin to precisely identify the molecular mechanisms that underlie functional genetic variations, including implicated disease loci from genome-wide association studies, and prioritize implicated hits for follow-up experiments <xref ref-type="bibr" rid="pone.0068141-Montgomery1">[1]</xref>.</p><p>However, quantifying expression levels from RNA-seq data is not a trivial task: the output of an RNA-seq assay is millions of short RNA sequences, which then must be mapped to the genome and aggregated to quantify the expression level of each transcript. The accuracy of the resulting expression level estimates depends not only on the mapping and quantification algorithms, but also on carefully correcting for several technological biases that result in unwanted variability in the number of reads for each transcript. For example, technical factors involved in sample collection, library preparation, and sequencing may manifest as variation that depends on the batch, date, or sequencing lane of a sample. Other well-known examples of unwanted technical variability include sequencing biases related to GC content <xref ref-type="bibr" rid="pone.0068141-Pickrell1">[2]</xref>, and variation due to limited sequencing depths (SD) <xref ref-type="bibr" rid="pone.0068141-Toung1">[3]</xref>.</p><p>In addition to technical artifacts from measured, known, covariates such as sequencing depth, it may be useful to account for &#x0201c;hidden&#x0201d; covariates (or factors) that can introduce variability into the transcriptome. Hidden factors may comprise technical artifacts from unmeasured differences in sample preparation, while others arise from factors not specific to RNA-seq technology <xref ref-type="bibr" rid="pone.0068141-Hansen1">[4]</xref>. For example, unwanted, or unknown biological variations in the subject pool, such as in BMI, can have broad effects on gene expression <xref ref-type="bibr" rid="pone.0068141-Xu1">[5]</xref>, resulting in biological variability that confounds identification of the effectors of interest, such as disease causing genes or eQTLs <xref ref-type="bibr" rid="pone.0068141-Leek1">[6]</xref>.</p><p>Such known and hidden systematic biases result in spurious correlations between subjects or certain transcripts, and depending on the type of analysis that is performed, lead to increased false positives or false negatives. For instance, it is well known that spurious correlations among subjects decreases the power to detect eQTLs <xref ref-type="bibr" rid="pone.0068141-Stegle1">[7]</xref>, <xref ref-type="bibr" rid="pone.0068141-Listgarten1">[8]</xref>, and can also result in false associations <xref ref-type="bibr" rid="pone.0068141-Kang1">[9]</xref>. Similarly, co-expression networks constructed from uncorrected data will likely include many false positive edges due to broad trends in the data <xref ref-type="bibr" rid="pone.0068141-Furlotte1">[10]</xref>. Normalizing RNA-seq measurements to account for both known and hidden biases is a central task in the analysis of such data. Indeed, several methods have been proposed for normalizing microarray data by attempting to account for both known and hidden covariates, and these methods have been shown to dramatically improve various down-stream analyses <xref ref-type="bibr" rid="pone.0068141-Leek1">[6]</xref>&#x02013;<xref ref-type="bibr" rid="pone.0068141-Listgarten1">[8]</xref>, <xref ref-type="bibr" rid="pone.0068141-Furlotte1">[10]</xref>, <xref ref-type="bibr" rid="pone.0068141-GagnonBartsch1">[11]</xref> &#x02013; resulting, for example, in a two- to three-fold increase in the number of statistically significant associations between SNPs and nearby transcripts (known as cis-eQTL) <xref ref-type="bibr" rid="pone.0068141-Stegle1">[7]</xref>, <xref ref-type="bibr" rid="pone.0068141-Stranger1">[12]</xref>, as well as significantly enhanced reproducibility of results among different datasets <xref ref-type="bibr" rid="pone.0068141-Stranger1">[12]</xref>. However, to date, such methods have not been applied to RNA-seq data.</p><p>In this paper, we first describe a unified <italic>residual</italic> normalization framework encompassing most existing methods that attempt to account for both known and hidden covariates. In particular, existing normalization methods essentially combine a linear dimensionality reduction step to estimate the hidden covariates through matrix factorization, and a regression of the expression data onto covariates constructed from both known and hidden covariates. The way in which each of these two steps are optimized, and combined, differentiates the various approaches. This unified framework allows us to better compare existing approaches, and identify components whose variation is linked to specific underlying biological assumptions. For example, all methods derived from this framework assume that hidden covariates, like principal components, represent broad patterns in expression that affect many genes in the same way &#x02013; an assumption likely to fail when the phenotype of interest is also expected to have a strong effect on expression patterns (e.g., <xref ref-type="bibr" rid="pone.0068141-Fusi1">[13]</xref>).</p><p>To go beyond the limiting assumption of existing methods, we formulate a new model of hidden co-variation, and develop the HCP (Hidden Covariates with Prior) method to renormalize the two largest RNA-seq data sets constructed to date <xref ref-type="bibr" rid="pone.0068141-Pickrell1">[2]</xref>, <xref ref-type="bibr" rid="pone.0068141-Montgomery2">[14]</xref>. HCP infers a set of artifactual covariates, by modeling such covariates using a prior that depends on linear combinations of known covariates. In a sense, by using the known covariates as training examples, HCP attempts to learn variability <italic>patterns</italic> that are likely to be artifactual, instead of merely finding factors that can explain the most variability. Based on the strength of the prior, HCP can balance the tradeoff between removing &#x0201c;narrow&#x0201d; and &#x0201c;broad&#x0201d; components that exhibit similar patterns to the covariates', and more major components that do not. Further, HCP's inferred covariates can also capture additive relationships between technical covariates that lead to spurious correlations (e.g., additive effects of gender and age).</p><p>Using the two RNA-seq datasets, we apply HCP and existing normalization methods to two tasks: (1) cis-eQTL detection, and (2) co-expression estimation. In accordance with previous studies with microarrays (e.g., <xref ref-type="bibr" rid="pone.0068141-Stegle1">[7]</xref>), our experiments confirm that all methods that remove hidden covariates greatly improve both the power of and consistency of cis-eQTL detection with RNA-seq data &#x02013; with some small differences in performance. However, on a second task of constructing meaningful co-expression networks, blindly removing hidden components is not ideal &#x02013; in this scenario, HCP outperforms simpler methods that make less stringent assumptions about the hidden covariates.</p></sec><sec sec-type="methods" id="s2"><title>Methods</title><p>In the following section, we will first introduce terminology for defining the expression normalization problem, and then present a unified residual framework for understanding the existing approaches. Then we present our new normalization method as derived from a natural extension to this framework.</p><sec id="s2a"><title>Unified Representation of Existing Normalization Methods</title><p>The goal of normalization is to decouple the true expression signal from known and unknown artifacts in the data. To do so, most existing methods (e.g., <xref ref-type="bibr" rid="pone.0068141-Leek1">[6]</xref>&#x02013;<xref ref-type="bibr" rid="pone.0068141-Listgarten1">[8]</xref>, <xref ref-type="bibr" rid="pone.0068141-Furlotte1">[10]</xref>, <xref ref-type="bibr" rid="pone.0068141-GagnonBartsch1">[11]</xref>, <xref ref-type="bibr" rid="pone.0068141-Fusi1">[13]</xref>, <xref ref-type="bibr" rid="pone.0068141-Johnson1">[15,]</xref>) assume that the observed expression measurements can be modeled in log-space (logarithm of read counts) using a Gaussian distribution with an expectation that depends linearly on the known and hidden covariates. Using this framework, the &#x0201c;true&#x0201d; expression measurements can be obtained by subtracting off the effects of such known and hidden covariates. Specifically, an expression dataset over <inline-formula><inline-graphic xlink:href="pone.0068141.e001.jpg"/></inline-formula> subjects and <inline-formula><inline-graphic xlink:href="pone.0068141.e002.jpg"/></inline-formula> genes (or transcripts), as summarized in the <inline-formula><inline-graphic xlink:href="pone.0068141.e003.jpg"/></inline-formula> matrix <inline-formula><inline-graphic xlink:href="pone.0068141.e004.jpg"/></inline-formula>, is modeled as follows:<disp-formula id="pone.0068141.e005"><graphic xlink:href="pone.0068141.e005"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0068141.e006.jpg"/></inline-formula> is a matrix of known covariates (also referred to as factors), <inline-formula><inline-graphic xlink:href="pone.0068141.e007.jpg"/></inline-formula> is the true, and unobserved, expression dataset, <inline-formula><inline-graphic xlink:href="pone.0068141.e008.jpg"/></inline-formula> is a matrix of hidden covariates, and <inline-formula><inline-graphic xlink:href="pone.0068141.e009.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e010.jpg"/></inline-formula> are matrices that model the effect of known and hidden covariates for each gene. In this setting <inline-formula><inline-graphic xlink:href="pone.0068141.e011.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e012.jpg"/></inline-formula> are unknown and must be estimated. Once the unknowns are estimated, they are removed from the data, and the true expression signal is computed as the residual <inline-formula><inline-graphic xlink:href="pone.0068141.e013.jpg"/></inline-formula>. The primary differences between the existing methods are in (i) the types of covariates that are included in <inline-formula><inline-graphic xlink:href="pone.0068141.e014.jpg"/></inline-formula>, (ii) the assumed priors (or equivalently, the regularization form) on <inline-formula><inline-graphic xlink:href="pone.0068141.e015.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e016.jpg"/></inline-formula>, and (iii) the optimization algorithm used to fit the model parameters.</p><p>We note in the case of RNA-seq data, several authors have proposed to model the raw read counts using Poisson or negative binomial distributions (e.g., <xref ref-type="bibr" rid="pone.0068141-Andres1">[16]</xref>); however, as described in the next section, we chose to model the logarithm of counts with a Gaussian distribution, as a well-studied downstream analyses that we consider is performed on ranks and not the actual number of reads (e.g., using Spearman correlation to identify eQTLs, see Methods). Additionally, Gaussian likelihood is widely used by practitioners (after suitable data transformation, e.g., <xref ref-type="bibr" rid="pone.0068141-Pickrell1">[2]</xref>, <xref ref-type="bibr" rid="pone.0068141-Langmead1">[17]</xref>&#x02013;<xref ref-type="bibr" rid="pone.0068141-Cloonan1">[19]</xref>) as it results in analytic solutions for the model parameters, considerably reducing the computational complexity. Similar analysis and insights could be applied to other distributional choices for the likelihood.</p><p>As further detailed in the Extended Methods, most existing methods can be derived from one of three special cases of the above formulation: (i) assuming only known covariates, (ii) assuming only unknown covariates, and (iii) assuming both known and unknown covariates. In each case, once the relevant unknown parameters are estimated, the corresponding artifactual effects are subtracted from the data.</p><p>For example, in the simplest scenario where we assume no hidden covariates, as in the ComBat method <xref ref-type="bibr" rid="pone.0068141-Johnson1">[15]</xref> or the regression method in <xref ref-type="bibr" rid="pone.0068141-Zheng1">[20]</xref>, we only need to estimate the matrix <inline-formula><inline-graphic xlink:href="pone.0068141.e017.jpg"/></inline-formula>, which models the effect of known covariates on the expression of each gene. Known covariates can include technical factors such as batch or sequencing lane, or biological factors such as age, or gender. The main limitation of the known-covariates-only methods is by relying solely on accurate measurements of known covariates, they cannot remove artifactual patterns that are not measured. In the second scenario, where we only assume the presence of hidden covariates, as in SVA <xref ref-type="bibr" rid="pone.0068141-Leek1">[6]</xref>, RUV <xref ref-type="bibr" rid="pone.0068141-GagnonBartsch1">[11]</xref>, or sparse factor analysis <xref ref-type="bibr" rid="pone.0068141-Engelhardt1">[21]</xref>, we need to estimate hidden covariates (<inline-formula><inline-graphic xlink:href="pone.0068141.e018.jpg"/></inline-formula>) and their effects on each gene (<inline-formula><inline-graphic xlink:href="pone.0068141.e019.jpg"/></inline-formula>). Depending on the priors placed on these parameters, we can derive various versions of the matrix factorization problem, including singular value decomposition (SVD), and factor analysis. The goal of matrix factorization in general is to find a low-dimensional representation of a high-dimensional dataset. In this way, the inferred hidden covariates summarize broad patterns that effect a large number of genes in the same way. Other related approaches include various Linear Mixed Models (LMMs), such as EMMAX <xref ref-type="bibr" rid="pone.0068141-Kang1">[9]</xref> or PANAMA <xref ref-type="bibr" rid="pone.0068141-Fusi1">[13]</xref>, that model the effect of hidden covariates implicitly by instead representing the broad correlation structure across individuals (see Extended Methods).</p><p>Finally, when assuming both known and hidden covariates (e.g. <xref ref-type="bibr" rid="pone.0068141-Stegle1">[7]</xref>) we need to simultaneously estimate hidden covariates (<inline-formula><inline-graphic xlink:href="pone.0068141.e020.jpg"/></inline-formula>), their effect on each gene (summarized by columns of <inline-formula><inline-graphic xlink:href="pone.0068141.e021.jpg"/></inline-formula>), and the effect of known covariates on each gene (<inline-formula><inline-graphic xlink:href="pone.0068141.e022.jpg"/></inline-formula>). In this setting, including the known covariates allows the model to also remove narrower artifactual patterns (in addition to the broad patterns captured by the hidden covariates), as long as such patterns are exactly captured by the known covariates and result in variability in the expression measurements. For example, PEER <xref ref-type="bibr" rid="pone.0068141-Stegle1">[7]</xref> is a special case of this scenario. An additional assumption of PEER is that each gene is affected by a limited (&#x0201c;sparse&#x0201d;) set of hidden covariates. This assumption is represented by a particular form of prior, known as the ARD prior, on the matrix <inline-formula><inline-graphic xlink:href="pone.0068141.e023.jpg"/></inline-formula>.</p><p>In summary, it is important to note that methods that do attempt to infer hidden covariates (scenarios (ii) and (iii)) do so by assuming that such covariates represent broad patterns that affect many genes in the same way. This assumption leads to a matrix factorization problem where the goal is to find a low-dimensional representation of a high-dimensional dataset (either the original data, or the residual after correcting for known covariates). Effectively controlling for the complexity of such models then becomes the main determinant of their performance, since such models, in theory, are flexible enough to explain all the variability in the data by means of the hidden covariates alone. In the simplest form of matrix factorization such as SVD, model complexity is controlled by just one parameter <inline-formula><inline-graphic xlink:href="pone.0068141.e024.jpg"/></inline-formula> that determines the number of hidden covariates. Other models can have additional parameters that also penalize the norms of each hidden covariate or their effects, and in such models, complexity is not only determined by <inline-formula><inline-graphic xlink:href="pone.0068141.e025.jpg"/></inline-formula> but by the simultaneous setting of all the parameters.</p></sec><sec id="s2b"><title>Hidden Covariates with Prior (HCP)</title><p>The statistical model behind HCP is motivated by two observations. First, in expression data in general, known artifacts are often correlated with multiple non-consecutive principal components (PCs), reflecting the fact that artifacts can have both broad and narrow effects on expression; this observation has motivated post-hoc methods that preferentially remove PCs that are to some extent correlated with known confounders. Second, a possible scenario that the existing methods do not address is partial (or &#x0201c;noisy&#x0201d;) prior knowledge about possible confounding effects. For example, assume that we would like to account for smoking, and remove its effect, but our prior knowledge about the subjects' smoking behavior is incomplete because of reporting bias (some subjects do not report their smoking activity). Similar motivations have recently also inspired a method <xref ref-type="bibr" rid="pone.0068141-Parts1">[22]</xref> for inferring the activity of cellular processes in individuals while using possibly noisy knowledge about pathway membership for genes.</p><p>Specifically, HCP infers a set of of artifactual covariates, by modeling such covariates using a prior that depends on linear combinations of known covariates: <inline-formula><inline-graphic xlink:href="pone.0068141.e026.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0068141.e027.jpg"/></inline-formula> is an estimated matrix with <inline-formula><inline-graphic xlink:href="pone.0068141.e028.jpg"/></inline-formula> columns. By adjusting the strength of this prior, HCP's objective function allows us to represent the tradeoff between removing major trends in the expression patterns, and preferring the removal of known covariates. Importantly, HCP can also learn <italic>patterns</italic> of variation that are likely to be artifactual (either broad or narrow), based on the types of variability patterns that are captured by the known covariates. Using this prior, HCP will preferentially remove components with similar patterns to the covariates, allowing us to remove narrower components that are known to be artifactual, and more major components that are not (within a parameterized tradeoff scheme).</p><p>An alternative to the above approach would be to only assume that each hidden covariate has a prior Gaussian distribution with an expectation that depends on a known covariate (as opposed to linear combinations of known covariates), which gives rise to the expression <inline-formula><inline-graphic xlink:href="pone.0068141.e029.jpg"/></inline-formula>. However, HCP has two main advantages over such a model: (i) HCP can summarize and collapse a possible set of redundant covariates to a smaller set of relevant covariates, and (ii) HCP can detect patterns that are associated with linear combinations of known covariates (e.g., additive effects of age and gender), that could also result in spurious correlations in the data.</p><p>HCP accepts a set of known covariates in order to estimate hidden covariates. Such known covariates can be any measurable factors that can introduce variability in expression measurements (for example, sequencing depth). As with the PEER method <xref ref-type="bibr" rid="pone.0068141-Stegle1">[7]</xref>, it is also possible to use HCP without any known covariates: in such a scenario, both methods become equivalent to a matrix factorization method that infers principle components with broad effects on expression measurements. An additional advantage of HCP is its low computational cost: though the resulting objective is not jointly convex in <inline-formula><inline-graphic xlink:href="pone.0068141.e030.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0068141.e031.jpg"/></inline-formula>, it is convex in each alone given a fixed setting of the rest. Therefore, this objective can be efficiently optimized by using a simple coordinate descent algorithm. In all of our experiments, computing the HCP solution required less than one minute of computational time on a standard desktop computer.</p></sec></sec><sec id="s3"><title>Results</title><sec id="s3a"><title>RNA-seq Datasets</title><p>In our experiments we use two RNA-seq datasets; we will refer to these as Pickrell data <xref ref-type="bibr" rid="pone.0068141-Pickrell1">[2]</xref> and Montgomery data <xref ref-type="bibr" rid="pone.0068141-Montgomery2">[14]</xref>.</p><p>The Pickrell RNA-seq data consists of data for 69 Yoruba HapMap cell lines (LCLs), and is available from <ext-link ext-link-type="uri" xlink:href="http://eqtl.uchicago.edu/RNA_Seq_data/">http://eqtl.uchicago.edu/RNA_Seq_data/</ext-link>. We obtained the raw number of reads per exon, and aggregated the reads for each gene by taking the union of all reads mapped to its exons (for details of the read mapping procedure see <xref ref-type="bibr" rid="pone.0068141-Pickrell1">[2]</xref>). All samples were done in replicates; in our analysis, we consider the replicate that has the largest number of mapped reads. We only considered genes with at least 30 reads in 10 individuals, which resulted in 12,569 expressed genes. The genotype data for 54 of these individuals is available from the pilot 1000 Genome project: <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.1000genomes.ebi/ac.uk/vol1/ftp/pilot_data">ftp://ftp.1000genomes.ebi/ac.uk/vol1/ftp/pilot_data</ext-link>.</p><p>The Montgomery RNA-seq data consists of 60 Caucasian (i.e., the CEU population) HapMap cell lines (LCLs), and is available from <ext-link ext-link-type="uri" xlink:href="http://jungle.unige.ch/rnaseq_CEU60/">http://jungle.unige.ch/rnaseq_CEU60/</ext-link>. Mapping and read quantification per exon was done as in <xref ref-type="bibr" rid="pone.0068141-Montgomery3">[23]</xref>. As above, we obtained the raw number of reads per exon, and aggregated the reads for each gene by taking the union of all reads mapped to its exons. We only considered genes with at least 30 reads in 10 individuals, which resulted in 14,573 expressed genes. The genotype data for 58 of these individuals is available from the pilot 1000 Genome project: <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.1000genomes.ebi/ac.uk/vol1/ftp/pilot_data">ftp://ftp.1000genomes.ebi/ac.uk/vol1/ftp/pilot_data</ext-link>.</p><p>For visualization purposes, we applied k-means clustering to each dataset, using standardized, logarithm-transformed RPKM values, where each gene has zero mean and constant variance, to cluster subjects and genes. As shown in <xref ref-type="fig" rid="pone-0068141-g001">Figure 1</xref>, we observe strong trends in the data, represented by broad clustering patterns in both datasets. These clusters are present in both raw and RPKM data. As it turns out, SD is the main covariate that significantly correlates with this broad pattern (e.g., <inline-formula><inline-graphic xlink:href="pone.0068141.e032.jpg"/></inline-formula> with the first, fourth, and twelfth PCs in the Pickrell data). Obviously, removing such artifactual trends will reduce, or remove, spurious correlations, and is thus a key aspect of any analysis that involves generalizing over genes or subjects. We note that from <xref ref-type="fig" rid="pone-0068141-g001">Figure 1</xref>, though, it is evident that simple scaling normalization methods such as RPKM or TMM <xref ref-type="bibr" rid="pone.0068141-Robinson1">[24]</xref>, or rank-based normalization (e.g., Quantile normalization), cannot remove such broad clusters, as these methods preserve the ranking of the genes in each subject. One major explanation for this is that SD appears to affect different genes differently, which cannot be accounted for by such methods.</p><fig id="pone-0068141-g001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0068141.g001</object-id><label>Figure 1</label><caption><title>Heatmap of RNA-seq data from (a) Pickrell data and (b) Montgomery data.</title><p>Rows represent subjects (or individuals) and columns represent genes. Using k-means clustering on corresponding RPKM normalized data, subjects are grouped in three clusters and genes are also grouped into three clusters. As observed later, these broad clustering patterns are primarily driven by confounding factors such as sequencing depth.</p></caption><graphic xlink:href="pone.0068141.g001"/></fig></sec><sec id="s3b"><title>Known Technical Covariates</title><p>As we describe in the next section, we applied HCP and several other methods that can be derived from the unified framework in <xref ref-type="disp-formula" rid="pone.0068141.e005">Equation (1</xref>) to normalize Pickrell and Montgomery RNA-seq datasets. For methods that can use known covariates (like HCP, PEER <xref ref-type="bibr" rid="pone.0068141-Stegle1">[7]</xref>, and a simple ridge regression method), we identified three technical covariates that can introduce subject-specific variability: (i) total number of reads (i.e., SD), (ii) subject-specific GC bias, and (iii) subject-specific gene-length bias. We describe each of these covariates below. (These three covariates are over subjects (or individuals), and constitute the columns of the matrix <inline-formula><inline-graphic xlink:href="pone.0068141.e033.jpg"/></inline-formula> with dimensionality <inline-formula><inline-graphic xlink:href="pone.0068141.e034.jpg"/></inline-formula> where <inline-formula><inline-graphic xlink:href="pone.0068141.e035.jpg"/></inline-formula> is the number of individuals and <inline-formula><inline-graphic xlink:href="pone.0068141.e036.jpg"/></inline-formula> is the number of known covariates, which is 3 in our case).</p><p>We note that the models we consider correct systematic biases that vary over subjects (i.e., subject-specific covariates), and do not consider covariates that only vary over genes and are constant for the same gene in different subjects (e.g., direct effect of gene length on reads mapped to each gene which is considered in RPKM correction <xref ref-type="bibr" rid="pone.0068141-Mortazavi1">[25]</xref>). This is because we are not interested in the absolute expression level of each gene, and our analyses consist of identifying biological variability over <italic>subjects</italic>. Therefore, any bias that affects all subjects by the same factor (e.g., constant gene length for a given gene which affect the number of mapped reads) will not impact the results, and will simply be subtracted out when standardizing each gene.</p><p>We construct SD as the total number of mapped reads to exons per-subject. We obtain subject-specific GC as the total variation in read counts (in log space), per-subject, that can be explained by GC content. To do so, we compute the correlation coefficient between <inline-formula><inline-graphic xlink:href="pone.0068141.e038.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e039.jpg"/></inline-formula> for each subject <inline-formula><inline-graphic xlink:href="pone.0068141.e040.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0068141.e041.jpg"/></inline-formula> is a vector with elements representing the logarithm read count per gene, and <inline-formula><inline-graphic xlink:href="pone.0068141.e042.jpg"/></inline-formula> is a vector with elements representing the percent GC content per gene (i.e., <inline-formula><inline-graphic xlink:href="pone.0068141.e043.jpg"/></inline-formula> is percent GC content of gene <inline-formula><inline-graphic xlink:href="pone.0068141.e044.jpg"/></inline-formula>). We considered subject-specific GC bias as a covariate as it was previously shown that GC bias can vary based on sequencing lane and so can be thought of as a subject-specific covariate <xref ref-type="bibr" rid="pone.0068141-Pickrell1">[2]</xref>. We also suspected that a subject-specific gene-length covariate may capture technical differences in terms of the initial RNA quality. Similarly to the subject-specific GC bias, we obtain subject-specific length bias, for subject <inline-formula><inline-graphic xlink:href="pone.0068141.e045.jpg"/></inline-formula>, by correlating <inline-formula><inline-graphic xlink:href="pone.0068141.e046.jpg"/></inline-formula> with <inline-formula><inline-graphic xlink:href="pone.0068141.e047.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0068141.e048.jpg"/></inline-formula> is a vector representing the length (in bases) for each of the genes.</p><p>The specific choice of the three known covariates was due to limited knowledge about other measured covariates in these two datasets, and that previous publications have shown that these types of covariates result in expression variability in RNA-seq data (in particular sequencing depth, and per-subject GC bias). There are many other technical or biological covariates, such as RIN, batch number, time of day, BMI and so on, that can affect expression, and should be utilized if available. Additionally, one can also include non-linear functions of the available covariates so as to be able to detect non-linear effects of the confounding factors.</p></sec></sec><sec id="s4"><title>Evaluating Normalization Methods</title><p>In the following section, we compare various normalization methods in two different tasks: (i) identifying cis-eQTLs (ii) and constructing accurate co-expression networks.</p><sec id="s4a"><title>Identifying cis-eQTLs Using RNA-seq Data</title><p>We evaluated the residuals resulting from each normalization method by computing the number of significant associations between genes and SNPs that lie within 100Kb from the gene's transcription start site (TSS) (i.e., cis-eQTL analysis). SNPs that are within 100Kb of multiple genes as assigned to the closest gene. This type of evaluation based on cis-eQTL discovery is used in many previous eQTL studies <xref ref-type="bibr" rid="pone.0068141-Stegle1">[7]</xref>, <xref ref-type="bibr" rid="pone.0068141-Listgarten1">[8]</xref>, <xref ref-type="bibr" rid="pone.0068141-Stranger1">[12]</xref>; unlike trans-eQTLs (association between SNP and distal genes), an increase in the overall number of significant cis-eQTLs is unlikely to arise from systematic artifacts because the particular genetic variation that impacts each gene is specific to the gene (i.e., a &#x0201c;narrow&#x0201d; component), and further, normalization procedures <italic>remove</italic> variable components of the data (and do not add variability), and therefore it is very unlikely to falsely introduce spurious associations. Following standard procedure <xref ref-type="bibr" rid="pone.0068141-Stranger1">[12]</xref>, <xref ref-type="bibr" rid="pone.0068141-Montgomery2">[14]</xref>, we computed a p-value for the Spearman correlation coefficient for each gene and each nearby (cis) SNP. We accounted for multiple hypothesis testing using false discovery rate (FDR) <xref ref-type="bibr" rid="pone.0068141-Benjamini1">[26]</xref> (applied to all tested SNP-gene pairs), and report the number of discoveries at 1%, 5%, and 10% FDR.</p><p><xref ref-type="fig" rid="pone-0068141-g002">Figure 2</xref> shows the number of cis-eQTLs that were detected using (i) the raw data, (ii) RPKM data, (iii) ridge regression (as in <xref ref-type="disp-formula" rid="pone.0068141.e069">Equation 2</xref>), (iv) SVD, (v) ridge regression to remove known covariates followed by SVD (SVD + tech) (a simplified approximation to PEER) (vi) PEER, and (vii) our HCP method. We set the model parameters on one dataset (Montgomery), and use the same setting on the other dataset &#x02013; we obtained similar parameter settings when using Pickrell data as the &#x0201c;training data&#x0201d; for choosing the parameter settings. For SVD, we investigated several settings for <inline-formula><inline-graphic xlink:href="pone.0068141.e049.jpg"/></inline-formula> (the number of components that are removed), and observed the best performance for <inline-formula><inline-graphic xlink:href="pone.0068141.e050.jpg"/></inline-formula> (shown in <xref ref-type="fig" rid="pone-0068141-g002">Figure 2</xref>). PEER also requires setting <inline-formula><inline-graphic xlink:href="pone.0068141.e051.jpg"/></inline-formula>, however, we noticed negligible difference for settings of <inline-formula><inline-graphic xlink:href="pone.0068141.e052.jpg"/></inline-formula> and so selected <inline-formula><inline-graphic xlink:href="pone.0068141.e053.jpg"/></inline-formula> for both datasets. For our HCP method, we set <inline-formula><inline-graphic xlink:href="pone.0068141.e054.jpg"/></inline-formula>, based on cross-validation on Montgomery data, and use the same settings of the parameters for all experiments.</p><fig id="pone-0068141-g002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0068141.g002</object-id><label>Figure 2</label><caption><title>Detection of cis-eQTL on (a) Pickrell and data (b) Montgomery data.</title><p>Correlation between (c) SNP-level p-values and (d) gene-level p-values in Montgomery and Pickrell datasets. P-values for the correlation coefficients for SNP-level comparisons are show on top of each bar. For the gene-level comparison, all p-values for the correlation coefficients are smaller than <inline-formula><inline-graphic xlink:href="pone.0068141.e055.jpg"/></inline-formula>. Error bars show the 90% confidence intervals for the correlation coefficients.</p></caption><graphic xlink:href="pone.0068141.g002"/></fig><p>As shown in <xref ref-type="fig" rid="pone-0068141-g002">Figures 2a and 2b</xref>, HCP improves slightly on PEER, and both methods increase the number of detected cis-eQTL by three to four folds compared to the RPKM data. Although the improvement of HCP over PEER is small, HCP is much faster: whereas PEER required at least 20 minutes of computation time (we used the C implementation of PEER provided by the authors, using the default thresholds on convergence), we can solve for the HCP solution in less than a minute on a standard desktop computer. This figure also illustrates that simpler methods, like ridge regression, that do not attempt to remove hidden covariates perform much worse than the other methods. In addition to ridge regression, we also investigated the performance of other &#x0201c;known covariates only&#x0201d; approaches that use different priors on <inline-formula><inline-graphic xlink:href="pone.0068141.e056.jpg"/></inline-formula>. In particular, an element-wise sparsity prior, using the <inline-formula><inline-graphic xlink:href="pone.0068141.e057.jpg"/></inline-formula> norm to regularize <inline-formula><inline-graphic xlink:href="pone.0068141.e058.jpg"/></inline-formula>, or low dimensionality prior, using the nuclear norm to regularize <inline-formula><inline-graphic xlink:href="pone.0068141.e059.jpg"/></inline-formula>, did not improve the performance of the &#x0201c;known covariates only&#x0201d; approach (data not shown). As demonstrated by <xref ref-type="fig" rid="pone-0068141-g002">Figures 2a and 2b</xref>, joint estimation of known and hidden covariates (as in PEER and HCP) tends to result in better performance compared to simply removing the top principal components of the data.</p><p>Using the HCP model, we find that 74% of the variance of removed expression (<inline-formula><inline-graphic xlink:href="pone.0068141.e060.jpg"/></inline-formula>) can be explained by known factors, where 35&#x02013;75% of variance of each hidden factor can be explained by a combination of known technical factors, and an additional 5&#x02013;20% of some factors can be explained by non-linear combination of these factors (based on five fold cross-validation). The remaining variance is likely to be due to other technical or biological factors that are not directly measured.</p><p>In addition to the eQTL test, we also compared the consistency of the eQTL discovery in the two datasets. To do so, we computed the Spearman correlation coefficient between the vectors of SNP (and also gene) p-values in the two datasets. There are 75,358 shared SNPs that are associated with a gene (i.e., cis-SNP), corresponding to 7,751 genes. As shown in <xref ref-type="fig" rid="pone-0068141-g002">Figures 2c and 2d</xref>, HCP along with PEER and SVD greatly improve the consistency of discoveries between these two studies.</p><sec id="s4a1"><title>Differences in cis-eQTL Discovery Based on Normalization</title><p>Having shown that accounting for both known and hidden factors greatly improves cis-eQTL discovery, two related questions naturally follow: (1) to what extent do the cis-eQTLs discovered by various methods overlap, and (2) to what extent are newly discovered cis-eQTLs detectable in the original, unnormalized dataset? To answer these questions, we first investigated the concordance between the list of cis-eQTLs produced by the different normalization methods. As a first analysis, we assessed the fraction of shared cis-eQTLs at 10% FDR between all pairs of normalized datasets. As shown in <xref ref-type="table" rid="pone-0068141-t001">Table 1</xref>, all normalization methods re-discover a large fraction of cis-eQTLs that are discovered in the most basic version of the data (e.g., RPKM normalized). However, removing hidden covariates does not uniformly decrease the p-values and the discrepancy is not merely a thresholding issue. This is evident from from the low Spearman correlation coefficients between vectors of gene-SNP p-values obtained for RPKM and various versions of normalized data: the Spearman correlation coefficient between RPKM and SVD, PEER, and HCP, are 0.17, 0.29, and 0.3, respectively. Finally, though there is a large overlap between the discoveries made when using different normalization methods that estimate hidden covariates (e.g., <xref ref-type="table" rid="pone-0068141-t001">Table 1:</xref> 73% of cis-eQTLs discovered by PEER are also discovered by HCP), normalization does result in differences in lists of prioritized cis-eQTLs (e.g., 30% of cis-eQTLs discovered by HCP are not discovered by PEER). So in short, the methods that account for hidden covariates do not produce completely different results compared to those that don't, and most of the discoveries made in baseline models (e.g., RPKM or Ridge) are also rediscovered by the more complex models. However, in additions to the baseline discoveries, hidden covariates methods discover statistically significant associations that were perhaps impacted by unknown confounding factors, which reduced the detection power.</p><table-wrap id="pone-0068141-t001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0068141.t001</object-id><label>Table 1</label><caption><title>Fraction of shared cis-eQTLs at 10% FDR between pairs of various versions of normalized Pickrell RNA-seq data.</title></caption><alternatives><graphic id="pone-0068141-t001-1" xlink:href="pone.0068141.t001"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">RPKM</td><td align="left" rowspan="1" colspan="1">Raw</td><td align="left" rowspan="1" colspan="1">Ridge</td><td align="left" rowspan="1" colspan="1">SVD</td><td align="left" rowspan="1" colspan="1">SVD + tech</td><td align="left" rowspan="1" colspan="1">PEER</td><td align="left" rowspan="1" colspan="1">HCP</td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">RPKM</td><td align="left" rowspan="1" colspan="1">1.00</td><td align="left" rowspan="1" colspan="1">0.83</td><td align="left" rowspan="1" colspan="1">0.78</td><td align="left" rowspan="1" colspan="1">0.83</td><td align="left" rowspan="1" colspan="1">0.84</td><td align="left" rowspan="1" colspan="1">0.91</td><td align="left" rowspan="1" colspan="1">0.86</td></tr><tr><td align="left" rowspan="1" colspan="1">Raw</td><td align="left" rowspan="1" colspan="1">0.35</td><td align="left" rowspan="1" colspan="1">1.00</td><td align="left" rowspan="1" colspan="1">0.78</td><td align="left" rowspan="1" colspan="1">0.78</td><td align="left" rowspan="1" colspan="1">0.77</td><td align="left" rowspan="1" colspan="1">0.90</td><td align="left" rowspan="1" colspan="1">0.90</td></tr><tr><td align="left" rowspan="1" colspan="1">Ridge</td><td align="left" rowspan="1" colspan="1">0.18</td><td align="left" rowspan="1" colspan="1">0.43</td><td align="left" rowspan="1" colspan="1">1.00</td><td align="left" rowspan="1" colspan="1">0.65</td><td align="left" rowspan="1" colspan="1">0.60</td><td align="left" rowspan="1" colspan="1">0.82</td><td align="left" rowspan="1" colspan="1">0.88</td></tr><tr><td align="left" rowspan="1" colspan="1">SVD</td><td align="left" rowspan="1" colspan="1">0.09</td><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0.31</td><td align="left" rowspan="1" colspan="1">1.00</td><td align="left" rowspan="1" colspan="1">0.77</td><td align="left" rowspan="1" colspan="1">0.83</td><td align="left" rowspan="1" colspan="1">0.77</td></tr><tr><td align="left" rowspan="1" colspan="1">SVD + tech</td><td align="left" rowspan="1" colspan="1">0.08</td><td align="left" rowspan="1" colspan="1">0.18</td><td align="left" rowspan="1" colspan="1">0.25</td><td align="left" rowspan="1" colspan="1">0.70</td><td align="left" rowspan="1" colspan="1">1.00</td><td align="left" rowspan="1" colspan="1">0.74</td><td align="left" rowspan="1" colspan="1">0.70</td></tr><tr><td align="left" rowspan="1" colspan="1">PEER</td><td align="left" rowspan="1" colspan="1">0.07</td><td align="left" rowspan="1" colspan="1">0.16</td><td align="left" rowspan="1" colspan="1">0.28</td><td align="left" rowspan="1" colspan="1">0.60</td><td align="left" rowspan="1" colspan="1">0.58</td><td align="left" rowspan="1" colspan="1">1.00</td><td align="left" rowspan="1" colspan="1">0.73</td></tr><tr><td align="left" rowspan="1" colspan="1">HCP</td><td align="left" rowspan="1" colspan="1">0.06</td><td align="left" rowspan="1" colspan="1">0.16</td><td align="left" rowspan="1" colspan="1">0.29</td><td align="left" rowspan="1" colspan="1">0.53</td><td align="left" rowspan="1" colspan="1">0.53</td><td align="left" rowspan="1" colspan="1">0.70</td><td align="left" rowspan="1" colspan="1">1.00</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>Each row depicts the fraction of cis-eQTLs discovered using a particular normalization method that are also discovered in another normalized version. For example, the element at row <italic>i</italic> and column <italic>j</italic> (the <inline-formula><inline-graphic xlink:href="pone.0068141.e037.jpg"/></inline-formula> element) depicts the proportion of cis-eQTLs discovered using normalization method <italic>i</italic> that are also discovered in normalization method <italic>j</italic>.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s4b"><title>Accuracy in Co-expression Network Analysis</title><p>A correlation between two genes is often indicative of co-regulation, co-functionality, or a regulatory relationship. In fact, the &#x0201c;guilt-by-association&#x0201d; principle <xref ref-type="bibr" rid="pone.0068141-Marcotte1">[27]</xref> is routinely applied to co-expression networks to identify genes with similar functionalities, or to predict function for unknown genes. However, technical artifacts in expression data that lead to spurious correlations between the subjects result in false positive associations between genes, reducing the accuracy of guilt-by-association based approaches.</p><p>As we showed in the last section, a normalization step that removes confounding variability in the RNA-seq data greatly improves the power of cis-eQTL detection. On the other hand, the correlation between genotype and expression are expected to be much narrower and weaker than correlations between expression levels of two co-functional or co-regulated genes, and it is not clear if an un-guided removal of the top principal components will also remove true biological variability that is not evident in the cis-eQTL detection task. In this section, we investigate the accuracy of co-expression networks constructed from Montgomery and Pickrell datasets in terms of reflecting co-functionality between genes, after the application of several normalization methods.</p><p>In particular, we investigate the consistency of the constructed co-expression networks with prior knowledge about co-functionality of genes, by attempting to use these networks as input to a gene function prediction algorithm. More specifically, we follow a standard approach (as in <xref ref-type="bibr" rid="pone.0068141-Mostafavi1">[28]</xref>, also see <xref ref-type="bibr" rid="pone.0068141-PenaCastillo1">[29]</xref>): we first construct a co-expression network from each dataset using the Pearson correlation coefficient. We then attempt to predict gene function from each network using a label propagation algorithm <xref ref-type="bibr" rid="pone.0068141-Zhou1">[30]</xref>. Specifically, from each network, we predict gene function for Gene Ontology (GO) <xref ref-type="bibr" rid="pone.0068141-Consortium1">[31]</xref> categories (downloaded September 2010) that have between 30&#x02013;300 annotations. We excluded all annotations with an IEA evidence code, as these annotations are less reliable and not manually curated. We evaluated the performance using average area under the precision recall curve (AUP) in predicting each gene function in 5-fold cross-validation.</p><p>As a first analysis, for all the normalization methods we used the same parameter setting as in the previous section; by doing so, we also investigate the robustness of these methods with respect to the type of down-stream analysis performed on the normalized data. <xref ref-type="fig" rid="pone-0068141-g003">Figure 3</xref> shows AUPs for each of the co-expression networks. Since the performance of SVD significantly varies based on the setting of its parameter <inline-formula><inline-graphic xlink:href="pone.0068141.e061.jpg"/></inline-formula> (shown in <xref ref-type="fig" rid="pone-0068141-g004">Figure 4</xref>), the final performance comparison in <xref ref-type="fig" rid="pone-0068141-g003">Figure 3</xref> shows both the best setting of <inline-formula><inline-graphic xlink:href="pone.0068141.e062.jpg"/></inline-formula> for cis-eQTL detection, and for the GO prediction test (SVD (2) and SVD (10), respectively). Unlike the cis-eQTL detection task, an unguided removal of top principal components, where <inline-formula><inline-graphic xlink:href="pone.0068141.e063.jpg"/></inline-formula> is maximized for the performance on cis-eQTL task, significantly reduces the accuracy of co-expression networks compared to the RPKM data. In contrast, PEER and HCP still remove hidden covariates using the same setting optimized for the cis-eQTL task, resulting in prediction of gene function. Therefore, compared to principal components, the hidden components that are removed by PEER and HCP are more likely to be artifacts, and these methods are less prone to overfitting.</p><fig id="pone-0068141-g003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0068141.g003</object-id><label>Figure 3</label><caption><title>Mean average precision (AUP) in predicting gene function from co-expression networks constructed from various normalization methods, on (a) Pickrell, and (b) Montgomery data.</title><p>The figure shows the performance of SVD at two different parameter settings (SVD (10) with <inline-formula><inline-graphic xlink:href="pone.0068141.e064.jpg"/></inline-formula>, and SVD (2) with <inline-formula><inline-graphic xlink:href="pone.0068141.e065.jpg"/></inline-formula>). Error bars show the standard errors. Figure shows the cumulative performance for (c) Pickrell, (d) and Montgomery, datasets for the top 50 best predicted GO categories for each method.</p></caption><graphic xlink:href="pone.0068141.g003"/></fig><fig id="pone-0068141-g004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0068141.g004</object-id><label>Figure 4</label><caption><title>Performance of SVD on the GO prediction test with varying number of removed PCs (i.e., setting of <inline-formula><inline-graphic xlink:href="pone.0068141.e066.jpg"/></inline-formula>) on (left) Pickrell and (right) Montgomery data.</title><p>The red star marks the optimal setting of <inline-formula><inline-graphic xlink:href="pone.0068141.e067.jpg"/></inline-formula> for the cis-eQTL task.</p></caption><graphic xlink:href="pone.0068141.g004"/></fig></sec></sec><sec id="s5"><title>Discussion and Conclusion</title><p>RNA-sequencing is becoming widely adopted in large-scale transcriptomic studies, and specifically in genetics of gene expression studies (eQTL studies) (e.g., Geuvadis project <ext-link ext-link-type="uri" xlink:href="http://www.geuvadis.org/web/geuvadis/RNAseq-project">http://www.geuvadis.org/web/geuvadis/RNAseq-project</ext-link> and GTEx project <xref ref-type="bibr" rid="pone.0068141-Lonsdale1">[32]</xref>). A major factor in deriving <italic>meaningful</italic> biological knowledge from transcriptomic studies that are based on healthy subjects or unstimulated data, where there is no apparent response component, is correcting for unwanted variability that stems from technical factors or unwanted biological variation. The impact of such factors on expression variability is often larger than those that derive the biological questions of interest, and if unaccounted for, results in spurious associations, or a loss in power. For instance, previous eQTLs studies have shown that, depending on the size of the study, removing even up to 50 PCs of expression data improves identification of genetic associations between cis-SNPs and expression variability of <italic>local</italic> genes <xref ref-type="bibr" rid="pone.0068141-Fehrmann1">[33]</xref>.</p><p>Consistently with previous studies on microarrays, we find that when using RNA-seq data, removing broad expression trends (either PCs of expression data, HCP or PEER hidden factors) results in a drastic increase in the number of cis-eQTL discoveries (between 2 to 3 fold). Further, we find that the improvement in the number of cis-eQTL discoveries is not very sensitive to the exact number of PCs that are removed, so long as a sufficiently large number of PCs are removed (e.g., accounting for 60&#x02013;80% variance in expression) &#x02013; for example, here, we saw that removing between 8&#x02013;16 PCs resulted in similar performance. For the cis-eQTL analysis, we inferred and removed 20 HCP factors. However, the same conclusion is unlikely to hold for identification of trans-eQTLs. In this study, we did not have sufficient power to identify trans-eQTLs, and as an alternative, we investigated the effect of normalization on accurate estimation of co-expression networks. Because <italic>master regulators</italic>, or <italic>hub</italic> genes, impact the expression levels of many target genes, their expression profiles are likely to be correlated with the expression PCs. This is also expected to hold for trans-eQTLs, because they are likely to impact the expression levels of many target genes. In our co-expression network analysis, we found that accurate estimation of co-expression between genes is much more sensitive to removing expression PCs; for instance removing 10 expression PCs (as done for cis-eQTL analysis) resulted in a drastic loss of accuracy in identifying known co-functional interactions (<xref ref-type="fig" rid="pone-0068141-g004">Figure 4</xref>). On the other hand, the parameter settings of HCP and PEER are more robust across the two types of downstream analyses that we investigated; removing the same number of hidden components improves performance in both analyses. This observation indicates that the hidden components removed by HCP or PEER more precisely capture the artifactual component, and are less likely to remove biological signal. However, from a technical perspective, there are several fundamental difference between PEER and HCP. First, HCP prefers to identify components that resemble known artifacts, either linearly or non-linearly. This distinction will be important when we have a <italic>noisy</italic> knowledge of the true artifacts. Second, HCP can potentially account for a large set of correlated known covariates, and summarize their impact on expression variability by a few HCP factors.</p><p>In summary, we have presented a unified residual normalization framework that encompasses most existing methods that attempt to account for known and/or hidden confounding covariates, and to remove their effects from expression data. As discussed, the framework enables a better understanding of the similarities and differences between the various existing approaches. Further, using this framework, we presented a novel normalization method called HCP. Whereas the existing approaches assume that one of the most distinguishing features of the hidden covariates is that they capture very broad patterns in the data, HCP attempts to learn the types of patterns (either broad or subtle) that can be artifactual. Based on the experiments conducted, we see that normalization models that account for both known and hidden covariates drastically reduce spurious correlations, and lead to more accurate co-expression networks and cis-eQTLs. Further, a model like that of HCP, that can account for both broad and subtle <italic>patterns</italic> of correlation in order to infer hidden covariates yields an effective and flexible method for correcting systematic biases.</p></sec><sec id="s6"><title>Extended Methods</title><p>In the next few sections we consider special cases of the unified normalization framework, summarized by <xref ref-type="disp-formula" rid="pone.0068141.e005">Equation (1</xref>): (i) no hidden covariates, (ii) no known covariates, (iii) and both known and hidden covariates, and discuss the resulting normalization methods. As we will show, most existing normalization methods fall under one of these scenarios.</p><sec id="s6a"><title>Known Covariates</title><p>In the simplest case where we assume no hidden covariates, we can solve for <inline-formula><inline-graphic xlink:href="pone.0068141.e068.jpg"/></inline-formula> by minimizing the negative log likelihood of the data:<disp-formula id="pone.0068141.e069"><graphic xlink:href="pone.0068141.e069"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0068141.e070.jpg"/></inline-formula> is the squared Frobenius norm of <inline-formula><inline-graphic xlink:href="pone.0068141.e071.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0068141.e072.jpg"/></inline-formula> is the penalty placed on <inline-formula><inline-graphic xlink:href="pone.0068141.e073.jpg"/></inline-formula>. For example, placing a Gaussian prior on <inline-formula><inline-graphic xlink:href="pone.0068141.e074.jpg"/></inline-formula> (also known as the ridge penalty), equivalent to <inline-formula><inline-graphic xlink:href="pone.0068141.e075.jpg"/></inline-formula>, often alleviates over-fitting and results in better performance on test data. Here, we can analytically solve for <inline-formula><inline-graphic xlink:href="pone.0068141.e076.jpg"/></inline-formula> and obtain the residual <inline-formula><inline-graphic xlink:href="pone.0068141.e077.jpg"/></inline-formula>.</p><p>The RPKM normalization method <xref ref-type="bibr" rid="pone.0068141-Mortazavi1">[25]</xref>, a standard method for RNA-seq data, along with TMM <xref ref-type="bibr" rid="pone.0068141-Robinson1">[24]</xref>, can be expressed as a solution to the above problem. In particular, RPKM normalization accounts for SD and gene length bias by dividing all reads assigned to a gene <inline-formula><inline-graphic xlink:href="pone.0068141.e078.jpg"/></inline-formula> (or transcript) in subject <inline-formula><inline-graphic xlink:href="pone.0068141.e079.jpg"/></inline-formula> by (i) <inline-formula><inline-graphic xlink:href="pone.0068141.e080.jpg"/></inline-formula>, the SD of subject <inline-formula><inline-graphic xlink:href="pone.0068141.e081.jpg"/></inline-formula> (in millions) and (ii) <inline-formula><inline-graphic xlink:href="pone.0068141.e082.jpg"/></inline-formula>, the length of gene <inline-formula><inline-graphic xlink:href="pone.0068141.e083.jpg"/></inline-formula> (in thousands of base pairs). Therefore, the logarithm of the RPKM value is given by <inline-formula><inline-graphic xlink:href="pone.0068141.e084.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0068141.e085.jpg"/></inline-formula> is the logarithm of number of reads mapped to gene <inline-formula><inline-graphic xlink:href="pone.0068141.e086.jpg"/></inline-formula> in subject <inline-formula><inline-graphic xlink:href="pone.0068141.e087.jpg"/></inline-formula>. So we can derive the RPKM values from the residual model by assuming that sequencing depth has a constant effect (i.e., the same regression coefficient) on all genes. Unlike the RPKM normalization, the regression problem posed in <xref ref-type="disp-formula" rid="pone.0068141.e069">Equation (2</xref>) allows the total number of reads and gene length to affect different genes differently, which will turn out to be important. Other related approaches that can be derived from <xref ref-type="disp-formula" rid="pone.0068141.e069">Equation (2</xref>) include the linear regression framework proposed by <xref ref-type="bibr" rid="pone.0068141-Zheng1">[20]</xref>, and the Empirical Bayes regression method in ComBat <xref ref-type="bibr" rid="pone.0068141-Johnson1">[15]</xref>. In the latter, the regularization term <inline-formula><inline-graphic xlink:href="pone.0068141.e088.jpg"/></inline-formula> is designed so that multiple genes share the same parameter. This choice helps avoid over-fitting in small <inline-formula><inline-graphic xlink:href="pone.0068141.e089.jpg"/></inline-formula> regime.</p></sec><sec id="s6b"><title>Hidden Covariates</title><p>In the second scenario, where we only assume the presence of hidden covariates, depending on the constraints placed on <inline-formula><inline-graphic xlink:href="pone.0068141.e090.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e091.jpg"/></inline-formula>, we can derive various versions of the matrix factorization problem, including singular value decomposition (SVD), factor analysis (FA), and non-negative matrix factorization (NNMF). For example, for SVD optimizes:<disp-formula id="pone.0068141.e092"><graphic xlink:href="pone.0068141.e092"/><label>(3)</label></disp-formula><disp-formula id="pone.0068141.e093"><graphic xlink:href="pone.0068141.e093"/></disp-formula><disp-formula id="pone.0068141.e094"><graphic xlink:href="pone.0068141.e094"/></disp-formula></p><p>In this setting, the number of columns of <inline-formula><inline-graphic xlink:href="pone.0068141.e095.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0068141.e096.jpg"/></inline-formula>, is unknown. Typically, <inline-formula><inline-graphic xlink:href="pone.0068141.e097.jpg"/></inline-formula> is set by the user to achieve a fixed level of &#x0201c;explained variability&#x0201d;. Alternatively, <inline-formula><inline-graphic xlink:href="pone.0068141.e098.jpg"/></inline-formula> can also be tuned simultaneously as part of the same optimization problem (e.g., by introducing a group penalty on <inline-formula><inline-graphic xlink:href="pone.0068141.e099.jpg"/></inline-formula> that penalizes the sum of norms of columns of <inline-formula><inline-graphic xlink:href="pone.0068141.e100.jpg"/></inline-formula><xref ref-type="bibr" rid="pone.0068141-Fusi1">[13]</xref>), or can be set based on a significance test (e.g., permutation test in SVA <xref ref-type="bibr" rid="pone.0068141-Leek1">[6]</xref>, or significance of principal components in PCAsig <xref ref-type="bibr" rid="pone.0068141-Stegle1">[7]</xref>). Other related approaches to SVD include SVA <xref ref-type="bibr" rid="pone.0068141-Leek1">[6]</xref> and RUV <xref ref-type="bibr" rid="pone.0068141-GagnonBartsch1">[11]</xref> which explicitly use prior knowledge to determine which principle components are artifactual. For example, SVA consists of a regression step first to remove the effects of interest from the observed expression dataset, and then it performs an SVD on the residual dataset &#x02013; in this way, the effect of interest are not accidentally removed by the Principle Components. RUV uses control genes, which, to some extend, are expected to have constant expression across individuals, to identify variability patterns that are likely to be artifactual. In addition, minor alterations to the above allow us to derive several variations of the FA model. For example, FA assumes <inline-formula><inline-graphic xlink:href="pone.0068141.e101.jpg"/></inline-formula> with a diagonal matrix <inline-formula><inline-graphic xlink:href="pone.0068141.e102.jpg"/></inline-formula> that is estimated along with <inline-formula><inline-graphic xlink:href="pone.0068141.e103.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e104.jpg"/></inline-formula>, and sparse FA assumes an additional sparse penalty on <inline-formula><inline-graphic xlink:href="pone.0068141.e105.jpg"/></inline-formula> (e.g., element-wise <inline-formula><inline-graphic xlink:href="pone.0068141.e106.jpg"/></inline-formula> penalty on <inline-formula><inline-graphic xlink:href="pone.0068141.e107.jpg"/></inline-formula>) <xref ref-type="bibr" rid="pone.0068141-Engelhardt1">[21]</xref>.</p></sec><sec id="s6c"><title>Known and Hidden Covariates</title><p>Finally, assuming both known and hidden covariates, we need to estimate <inline-formula><inline-graphic xlink:href="pone.0068141.e108.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e109.jpg"/></inline-formula>:<disp-formula id="pone.0068141.e110"><graphic xlink:href="pone.0068141.e110"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0068141.e111.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e112.jpg"/></inline-formula> are the penalties on <inline-formula><inline-graphic xlink:href="pone.0068141.e113.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e114.jpg"/></inline-formula>, respectively. Assuming the same orthogonal constraints on <inline-formula><inline-graphic xlink:href="pone.0068141.e115.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e116.jpg"/></inline-formula> as in <xref ref-type="disp-formula" rid="pone.0068141.e092">Equation (3</xref>), we can solve <xref ref-type="disp-formula" rid="pone.0068141.e110">Equation (4</xref>) by iterating between (i) solving for <inline-formula><inline-graphic xlink:href="pone.0068141.e117.jpg"/></inline-formula> using the current estimate of <inline-formula><inline-graphic xlink:href="pone.0068141.e118.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e119.jpg"/></inline-formula>, and (ii) solving for the SVD of <inline-formula><inline-graphic xlink:href="pone.0068141.e120.jpg"/></inline-formula> to set <inline-formula><inline-graphic xlink:href="pone.0068141.e121.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e122.jpg"/></inline-formula>. As another example, the PEER <xref ref-type="bibr" rid="pone.0068141-Stegle1">[7]</xref> method essentially solves the above objective, while assuming prior Gaussian distributions with zero-means on <inline-formula><inline-graphic xlink:href="pone.0068141.e123.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e124.jpg"/></inline-formula>, and a sparsity-type prior on <inline-formula><inline-graphic xlink:href="pone.0068141.e125.jpg"/></inline-formula>.</p><p>We can also derive various forms of Linear Mixed Models (LMMs) such as EMMAX <xref ref-type="bibr" rid="pone.0068141-Kang2">[34]</xref>, and PANAMA <xref ref-type="bibr" rid="pone.0068141-Fusi1">[13]</xref> from the same framework. In particular, LMMs optimize a slightly different objective, by first specifying a Gaussian prior on <inline-formula><inline-graphic xlink:href="pone.0068141.e126.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e127.jpg"/></inline-formula> and then integrating out <inline-formula><inline-graphic xlink:href="pone.0068141.e128.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068141.e129.jpg"/></inline-formula> from the likelihood <inline-formula><inline-graphic xlink:href="pone.0068141.e130.jpg"/></inline-formula> to obtain the final objective function. Recall that optimizing the likelihood <inline-formula><inline-graphic xlink:href="pone.0068141.e131.jpg"/></inline-formula> with respect to <inline-formula><inline-graphic xlink:href="pone.0068141.e132.jpg"/></inline-formula> is equivalent to finding the solution to <xref ref-type="disp-formula" rid="pone.0068141.e110">Equation (4</xref>). LMMs model the effect of <inline-formula><inline-graphic xlink:href="pone.0068141.e133.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0068141.e134.jpg"/></inline-formula>, implicitly through the initial integration of the likelihood. Such approaches are typically used to detect eQTLs while correcting for population structure in genome wide association studies (GWAS), where columns of <inline-formula><inline-graphic xlink:href="pone.0068141.e135.jpg"/></inline-formula> represent the first few principal components of the SNP data.</p></sec><sec id="s6d"><title>Hidden Covariates with Prior</title><p>HCP can also be derived as a natural extension of this unified framework that is not fully encapsulated by the existing methods. In particular, optimizing the log likelihood of the data, as modeled by HCP, results in the following objective:<disp-formula id="pone.0068141.e136"><graphic xlink:href="pone.0068141.e136"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0068141.e137.jpg"/></inline-formula> is the unknown matrix of effect of known factors <inline-formula><inline-graphic xlink:href="pone.0068141.e138.jpg"/></inline-formula> on unknown factors <inline-formula><inline-graphic xlink:href="pone.0068141.e139.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0068141.e140.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0068141.e141.jpg"/></inline-formula> are the model parameters. Like any hidden factor model, increasing <inline-formula><inline-graphic xlink:href="pone.0068141.e142.jpg"/></inline-formula> increases the variability in <inline-formula><inline-graphic xlink:href="pone.0068141.e143.jpg"/></inline-formula> that can be explained by the model. However, in addition to the setting of <inline-formula><inline-graphic xlink:href="pone.0068141.e144.jpg"/></inline-formula>, the model's capacity and performance depends on <inline-formula><inline-graphic xlink:href="pone.0068141.e145.jpg"/></inline-formula>. In our experiments, we set the model parameters using cross-validation based on a particular task of interest (e.g., set the parameters to maximize the number of recovered cis-eQTL on some portion of the genes, and use the same setting for all other genes); for comparison we use the same procedure for setting <inline-formula><inline-graphic xlink:href="pone.0068141.e146.jpg"/></inline-formula> and other relevant parameters for the other models (e.g., SVD and PEER) that estimate hidden covariates. In all of our experiments, computing the HCP solution required less than one minute of computational time on a standard desktop computer.</p></sec><sec id="s6e"><title>Availability</title><p>Software is available from authors by request.</p></sec></sec></body><back><ref-list><title>References</title><ref id="pone.0068141-Montgomery1"><label>1</label><mixed-citation publication-type="other">Montgomery SB, Dermitzakis ET (2011) From expression qtls to personalized transcriptomics. Nat Rev Genet 12.</mixed-citation></ref><ref id="pone.0068141-Pickrell1"><label>2</label><mixed-citation publication-type="other">Pickrell J, Marioni J, Pai A, Degner J, Engelhardt B, <etal>et al</etal>. (2010) Understanding mechanisms underlying human gene expression variation with RNA sequencing. Nature 464.</mixed-citation></ref><ref id="pone.0068141-Toung1"><label>3</label><mixed-citation publication-type="other">Toung J, Morley M, Li M, Cheung V (2011) RNA-sequence analysis of human b-cells. Genome Research.</mixed-citation></ref><ref id="pone.0068141-Hansen1"><label>4</label><mixed-citation publication-type="journal"><name><surname>Hansen</surname><given-names>KD</given-names></name>, <name><surname>Wu</surname><given-names>Z</given-names></name>, <name><surname>Irizarry</surname><given-names>RA</given-names></name>, <name><surname>Leek</surname><given-names>JT</given-names></name> (<year>2011</year>) <article-title>Sequencing technology does not eliminate biological variability</article-title>. <source>Nat Biotech</source><volume>29</volume>: <fpage>572</fpage>&#x02013;<lpage>573</lpage></mixed-citation></ref><ref id="pone.0068141-Xu1"><label>5</label><mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>Q</given-names></name>, <name><surname>Ni</surname><given-names>S</given-names></name>, <name><surname>Wu</surname><given-names>F</given-names></name>, <name><surname>Liu</surname><given-names>F</given-names></name>, <name><surname>Ye</surname><given-names>X</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Investigation of variation in gene expression profiling of human blood by extended Principle Component Analysis</article-title>. <source>PLoS ONE</source><volume>6</volume>: <fpage>e26905</fpage><pub-id pub-id-type="pmid">22046403</pub-id></mixed-citation></ref><ref id="pone.0068141-Leek1"><label>6</label><mixed-citation publication-type="other">Leek J, Storey J (2007) Capturing heterogeneity in gene expression studies by Surrogate Variable Analysis. PLoS Genetics 3.</mixed-citation></ref><ref id="pone.0068141-Stegle1"><label>7</label><mixed-citation publication-type="other">Stegle O, Parts L, Durbin R, Winn J (2010) A Bayesian framework to account for complex non-genetic factors in gene expression levels greatly increases power in eQTL studies. PLoS Computational Biology 6.</mixed-citation></ref><ref id="pone.0068141-Listgarten1"><label>8</label><mixed-citation publication-type="other">Listgarten J, Kadie C, Schadt E, Heckerman D (2010) Correction for hidden confounders in the genetic analysis of gene expression. Proceedings of National Academy of Science (PNAS) 107.</mixed-citation></ref><ref id="pone.0068141-Kang1"><label>9</label><mixed-citation publication-type="journal"><name><surname>Kang</surname><given-names>HM</given-names></name>, <name><surname>Ye</surname><given-names>C</given-names></name>, <name><surname>Eskin</surname><given-names>E</given-names></name> (<year>2008</year>) <article-title>Accurate discovery of Expression Quantitative Trait Loci under confounding from spurious and genuine regulatory hotspots</article-title>. <source>Genetics</source><volume>180</volume>: <fpage>1909</fpage>&#x02013;<lpage>1925</lpage><pub-id pub-id-type="pmid">18791227</pub-id></mixed-citation></ref><ref id="pone.0068141-Furlotte1"><label>10</label><mixed-citation publication-type="other">Furlotte N, Kang H, Ye C, Eskin E (2011) Mixed-model coexpression: calculating gene coexpression while accounting for expression heterogeneity. Bioinformatics 27.</mixed-citation></ref><ref id="pone.0068141-GagnonBartsch1"><label>11</label><mixed-citation publication-type="other">Gagnon-Bartsch J, Speed T (2011) Using control genes to correct for unwanted variation in microarray data. Bio-statistics.</mixed-citation></ref><ref id="pone.0068141-Stranger1"><label>12</label><mixed-citation publication-type="other">Stranger BE, Montgomery SB, Dimas AS, Parts L, Stegle O, <etal>et al</etal>. (2012) Patterns of cis regulatory variation in diverse human populations. PLoS Genet 8.</mixed-citation></ref><ref id="pone.0068141-Fusi1"><label>13</label><mixed-citation publication-type="other">Fusi N, Stegle O, Lawrence N (2012) Joint modeling of confounding factors and prominent genetic regulators provides increased accuracy in genetical genomics studies. PLoS Computational Biology 8.</mixed-citation></ref><ref id="pone.0068141-Montgomery2"><label>14</label><mixed-citation publication-type="other">Montgomery S, Sammeth M, Gutierrez-Arcelus M, Lach R, Ingle C, <etal>et al</etal>. (2010) Transcriptome genetics using second generation sequencing in a caucasian population. Nature 464.</mixed-citation></ref><ref id="pone.0068141-Johnson1"><label>15</label><mixed-citation publication-type="other">Johnson W, Li C, Rabinovic A (2007) Adjusting batch effects in microarray expression data using empirical Bayes methods. Biostatistics 8.</mixed-citation></ref><ref id="pone.0068141-Andres1"><label>16</label><mixed-citation publication-type="other">Andres S, Wolfgang H (1999) Differential expression analysis for sequence count data. Genome Biology 11.</mixed-citation></ref><ref id="pone.0068141-Langmead1"><label>17</label><mixed-citation publication-type="other">Langmead B, Hansen K, Leek J (2010) Cloud-scale rna-sequencing differential expression analysis with myrna. Genome Biology 11.</mixed-citation></ref><ref id="pone.0068141-Bullard1"><label>18</label><mixed-citation publication-type="other">Bullard J, Purdom E, Hansen K, Dut D (2010) Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments. BMC Bioinformatics 11.</mixed-citation></ref><ref id="pone.0068141-Cloonan1"><label>19</label><mixed-citation publication-type="other">Cloonan N, Forrest A, Kolle G, Gardiner B, Faulkner G, <etal>et al</etal>. (2008) Stem cell transcriptome profiling via massive-scale mRNA sequencing. Nature Methods 5.</mixed-citation></ref><ref id="pone.0068141-Zheng1"><label>20</label><mixed-citation publication-type="journal"><name><surname>Zheng</surname><given-names>W</given-names></name>, <name><surname>Chung</surname><given-names>L</given-names></name>, <name><surname>Zhao</surname><given-names>H</given-names></name> (<year>2011</year>) <article-title>Bias detection and correction in RNA-sequencing data</article-title>. <source>BMC Bioinformatics</source><volume>12</volume>: <fpage>290</fpage><pub-id pub-id-type="pmid">21771300</pub-id></mixed-citation></ref><ref id="pone.0068141-Engelhardt1"><label>21</label><mixed-citation publication-type="other">Engelhardt B, Stephens M (2010) Analysis of Population Structure: A Unifying Framework and Novel Methods Based on Sparse Factor Analysis. PLoS Genetics 6.</mixed-citation></ref><ref id="pone.0068141-Parts1"><label>22</label><mixed-citation publication-type="other">Parts L, Stegle O, Winn J, Durbin R (2011) Joint genetic analysis of gene expression data with inferred cellular phenotypes. PLoS Genet 7.</mixed-citation></ref><ref id="pone.0068141-Montgomery3"><label>23</label><mixed-citation publication-type="other">Montgomery S, Lappalainen T, Gutierrez-Arcelus M, Dermitzakis E (2011) Rare and common regulatory variation in population-scale sequenced human genomes. PLoS Genetics 7.</mixed-citation></ref><ref id="pone.0068141-Robinson1"><label>24</label><mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>M</given-names></name>, <name><surname>Oshlack</surname><given-names>A</given-names></name> (<year>2010</year>) <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>. <source>Genome Biology</source><volume>11</volume>: <fpage>R25</fpage><pub-id pub-id-type="pmid">20196867</pub-id></mixed-citation></ref><ref id="pone.0068141-Mortazavi1"><label>25</label><mixed-citation publication-type="other">Mortazavi A, Williams B, McCue K, Schaeffer L,Wold B (2008) Mapping and quantifying mammalian transcriptomes by RNA-Seq. Nature Methods 5.</mixed-citation></ref><ref id="pone.0068141-Benjamini1"><label>26</label><mixed-citation publication-type="other">Benjamini Y, Hochberg Y (1995) Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal Statistical Society, Series B 1.</mixed-citation></ref><ref id="pone.0068141-Marcotte1"><label>27</label><mixed-citation publication-type="journal"><name><surname>Marcotte</surname><given-names>E</given-names></name>, <name><surname>Pellegrini</surname><given-names>M</given-names></name>, <name><surname>Thompson</surname><given-names>M</given-names></name>, <name><surname>Yeates</surname><given-names>T</given-names></name>, <name><surname>Eisenberg</surname><given-names>D</given-names></name> (<year>1999</year>) <article-title>A combined algorithm for genome-wide prediction of protein function</article-title>. <source>Nature</source><volume>42</volume>: <fpage>83</fpage>&#x02013;<lpage>86</lpage><pub-id pub-id-type="pmid">10573421</pub-id></mixed-citation></ref><ref id="pone.0068141-Mostafavi1"><label>28</label><mixed-citation publication-type="journal"><name><surname>Mostafavi</surname><given-names>S</given-names></name>, <name><surname>Ray</surname><given-names>D</given-names></name>, <name><surname>Warde-Farley</surname><given-names>D</given-names></name>, <name><surname>Grouios</surname><given-names>C</given-names></name>, <name><surname>Morris</surname><given-names>Q</given-names></name> (<year>2008</year>) <article-title>GeneMANIA: a real-time multiple association network integration algorithm for predicting gene function</article-title>. <source>Genome Biology</source><volume>9</volume>: <fpage>S4</fpage><pub-id pub-id-type="pmid">18613948</pub-id></mixed-citation></ref><ref id="pone.0068141-PenaCastillo1"><label>29</label><mixed-citation publication-type="journal"><name><surname>Pena-Castillo</surname><given-names>L</given-names></name>, <name><surname>Tasan</surname><given-names>M</given-names></name>, <name><surname>Myers</surname><given-names>C</given-names></name>, <name><surname>Lee</surname><given-names>H</given-names></name>, <name><surname>Joshi</surname><given-names>T</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>A critical assessment of Mus musculus gene function prediction using integrated genomic evidence</article-title>. <source>Genome Biology</source><volume>9</volume>: <fpage>S2</fpage><pub-id pub-id-type="pmid">18613946</pub-id></mixed-citation></ref><ref id="pone.0068141-Zhou1"><label>30</label><mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>D</given-names></name>, <name><surname>Bousquet</surname><given-names>O</given-names></name>, <name><surname>Weston</surname><given-names>J</given-names></name>, <name><surname>Scholkopf</surname><given-names>B</given-names></name> (<year>2004</year>) <article-title>Learning with local and global consistency</article-title>. <source>Advances in Neural Information Processing Systems</source><volume>16</volume>: <fpage>321</fpage>&#x02013;<lpage>328</lpage></mixed-citation></ref><ref id="pone.0068141-Consortium1"><label>31</label><mixed-citation publication-type="journal"><name><surname>Consortium</surname><given-names>GO</given-names></name> (<year>2000</year>) <article-title>Gene Ontology: tool for unification of biology</article-title>. <source>Nature Genetics</source><volume>25</volume>: <fpage>25</fpage>&#x02013;<lpage>29</lpage><pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation></ref><ref id="pone.0068141-Lonsdale1"><label>32</label><mixed-citation publication-type="other">Lonsdale J, Thomas J, Salvatore M, Philips R, Lo E, <etal>et al</etal>. (2013) The Genotype-Tissue Expression (GTEx) project. Nature Genetics 45.</mixed-citation></ref><ref id="pone.0068141-Fehrmann1"><label>33</label><mixed-citation publication-type="other">Fehrmann R, Jansen R, Veldink J, Westra H, Arends D, <etal>et al</etal>. (2011) Trans-eQTLs reveal that independent genetic variants associated with a complex phenotype converge on intermediate genes, with a major role for the hla. PLoS Genetics 7.</mixed-citation></ref><ref id="pone.0068141-Kang2"><label>34</label><mixed-citation publication-type="journal"><name><surname>Kang</surname><given-names>HM</given-names></name>, <name><surname>Sul</surname><given-names>JH</given-names></name>, <collab>Service SK, Zaitlen NA, Kong Sy, et al.</collab> (<year>2010</year>) <article-title>Variance component model to account for sample structure in genome-wide association studies</article-title>. <source>Nat Genet</source><volume>42</volume>: <fpage>348</fpage>&#x02013;<lpage>354</lpage><pub-id pub-id-type="pmid">20208533</pub-id></mixed-citation></ref></ref-list></back></article>