<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing3.dtd?><?SourceDTD.Version 3.0?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4122380</article-id><article-id pub-id-type="publisher-id">PONE-D-14-06711</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0103812</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and Life Sciences</subject><subj-group><subject>Computational Biology</subject><subj-group><subject>Genome Analysis</subject><subj-group><subject>Genetic Networks</subject></subj-group></subj-group></subj-group><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject></subj-group></subj-group><subj-group><subject>Systems Biology</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer and Information Sciences</subject><subj-group><subject>Network Analysis</subject><subj-group><subject>Regulatory Networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Research and Analysis Methods</subject><subj-group><subject>Bioassays and Physiological Analysis</subject><subj-group><subject>Microarrays</subject></subj-group></subj-group></subj-group></article-categories><title-group><article-title>Ensemble Inference and Inferability of Gene Regulatory Networks</article-title><alt-title alt-title-type="running-head">Ensemble Inference and Inferability of Gene Regulatory Networks</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ud-Dean</surname><given-names>S. M. Minhaz</given-names></name><xref ref-type="aff" rid="aff1"/></contrib><contrib contrib-type="author"><name><surname>Gunawan</surname><given-names>Rudiyanto</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><addr-line>Institute for Chemical and Bioengineering, ETH Zurich, Zurich, Switzerland</addr-line></aff><contrib-group><contrib contrib-type="editor"><name><surname>Benos</surname><given-names>Panayiotis V.</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1"><addr-line>University of Pittsburgh, United States of America</addr-line></aff><author-notes><corresp id="cor1">* E-mail: <email>rudi.gunawan@chem.ethz.ch</email></corresp><fn fn-type="conflict"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><fn fn-type="con"><p>Conceived and designed the experiments: SMMU RG. Performed the experiments: SMMU. Analyzed the data: SMMU RG. Contributed reagents/materials/analysis tools: SMMU RG. Wrote the paper: SMMU RG.</p></fn></author-notes><pub-date pub-type="collection"><year>2014</year></pub-date><pub-date pub-type="epub"><day>5</day><month>8</month><year>2014</year></pub-date><volume>9</volume><issue>8</issue><elocation-id>e103812</elocation-id><history><date date-type="received"><day>12</day><month>2</month><year>2014</year></date><date date-type="accepted"><day>5</day><month>7</month><year>2014</year></date></history><permissions><copyright-year>2014</copyright-year><copyright-holder>Ud-Dean, Gunawan</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>The inference of gene regulatory network (GRN) from gene expression data is an unsolved problem of great importance. This inference has been stated, though not proven, to be underdetermined implying that there could be many equivalent (indistinguishable) solutions. Motivated by this fundamental limitation, we have developed new framework and algorithm, called TRaCE, for the ensemble inference of GRNs. The ensemble corresponds to the inherent uncertainty associated with discriminating direct and indirect gene regulations from steady-state data of gene knock-out (KO) experiments. We applied TRaCE to analyze the inferability of random GRNs and the GRNs of <italic>E. coli</italic> and yeast from single- and double-gene KO experiments. The results showed that, with the exception of networks with very few edges, GRNs are typically not inferable even when the data are ideal (unbiased and noise-free). Finally, we compared the performance of TRaCE with top performing methods of DREAM4 <italic>in silico</italic> network inference challenge.</p></abstract><funding-group><funding-statement>The work was supported by funding from the Swiss National Science Foundation (grant 137614, <ext-link ext-link-type="uri" xlink:href="http://www.snf.ch">http://www.snf.ch</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="16"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>The discovery and analysis of biological networks have important applications, from finding treatment of diseases to engineering of microbes for the production of drugs and biofuels <xref rid="pone.0103812-Apic1" ref-type="bibr">[1]</xref>&#x02013;<xref rid="pone.0103812-Zhao1" ref-type="bibr">[4]</xref>. With continued advances in high throughput and omics technology, the inference of biological networks from omics data has received a great deal of interest. In particular, the inference of gene regulatory networks from gene expression data constitutes a major research topic in systems biology. In the last decade, the number of methodologies that are dedicated for the GRN inference has increased tremendously <xref rid="pone.0103812-Hecker1" ref-type="bibr">[5]</xref>&#x02013;<xref rid="pone.0103812-Smet1" ref-type="bibr">[7]</xref>.</p><p>The Dialogue for Reverse Engineering Assessments and Methods (DREAM) project is a community-wide effort initiated to fulfill the need for a rigorous and fair comparison of the strengths and weaknesses of methods for the reverse engineering of biological networks from data. To this end, challenges involving the inference of cellular networks are organized on a yearly basis (<ext-link ext-link-type="uri" xlink:href="http://www.the-dream-project.org/challenges">http://www.the-dream-project.org/challenges</ext-link>). Specifically, the inference of GRN has become a major focus of several DREAM challenges. The outcomes of these challenges indicate that the state-of-the-art algorithms for GRN inference are unable to provide accurate and reliable network predictions, even when large expression datasets are available and the number of genes is small (10&#x02013;100 genes) <xref rid="pone.0103812-Stolovitzky1" ref-type="bibr">[8]</xref>&#x02013;<xref rid="pone.0103812-Marbach2" ref-type="bibr">[10]</xref>. Nonetheless, a crowd-sourcing strategy that combines the predictions of different inference methods has been shown to be more reliable than any individual method <xref rid="pone.0103812-Marbach2" ref-type="bibr">[10]</xref>.</p><p>Whether or not a direct regulation of one gene by another can be correctly inferred depends not only on the ability of an inference method to extract the relevant information from data, but also on the availability of such information in the data. In general, the information content of data is determined first and foremost by the conditions of the experiments. If the required information is unavailable or incompletely available, then the inference problem is underdetermined. In such a case, the network is not inferable from the data regardless of the method used.</p><p>The underdetermined nature is not exclusive to the inference of GRNs. Much of the difficulty in the inverse modeling of signaling and metabolic networks can also be attributed to the lack of inferability or identifiability of model structure and parameters <xref rid="pone.0103812-Gadkar1" ref-type="bibr">[11]</xref>&#x02013;<xref rid="pone.0103812-Szederknyi1" ref-type="bibr">[14]</xref>. As the inference problem is underdetermined, there exist multiple solutions which are indistinguishable. The lack of model identifiability has motivated a paradigm shift toward ensemble modeling <xref rid="pone.0103812-Kuepfer1" ref-type="bibr">[15]</xref>&#x02013;<xref rid="pone.0103812-Jia1" ref-type="bibr">[18]</xref>. While such a strategy has begun to gain traction in the modeling of signaling and metabolic networks, the ensemble paradigm has not been widely used in the inference of GRNs. Also, since the network representation and data for GRNs differ markedly from those for signaling and metabolic networks, existing algorithms for ensemble modeling cannot be directly applied for the inference of GRN.</p><p>In this work, we introduce new framework and algorithms, called <bold>T</bold>ransitive <bold>R</bold>eduction <bold>a</bold>nd <bold>C</bold>losure <bold>E</bold>nsemble (TRaCE), for the ensemble inference of GRNs. Specifically, TRaCE produces the lower and upper bounds of the ensemble, i.e. the smallest network and the largest network that limit the complexity of networks in the ensemble. As the size of the ensemble reflects the uncertainty about the GRN inference, the bounds can also be used to analyze the inferability of GRNs. In this study, we have used TRaCE in two applications. First, we investigated the inferability of random GRNs and the GRNs of <italic>E. coli</italic> and <italic>S. cereviseae</italic> given steady-state gene expression data of single- and double-gene KO experiments. Then, we applied TRaCE to simulated gene expression data, generated in the same manner as the DREAM 4 <italic>in silico</italic> network inference challenge, and compared the performance of TRaCE with existing methods.</p></sec><sec sec-type="methods" id="s2"><title>Methods</title><sec id="s2a"><title>Theoretical Foundation</title><sec id="s2a1"><title>Definitions</title><p>Here, we provide a short synopsis of basic concepts in graph theory that are necessary for the development of our algorithm. A <italic>graph</italic><inline-formula><inline-graphic xlink:href="pone.0103812.e001.jpg"/></inline-formula> is an ordered pair <inline-formula><inline-graphic xlink:href="pone.0103812.e002.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0103812.e003.jpg"/></inline-formula> is the set of vertices (or nodes) and <inline-formula><inline-graphic xlink:href="pone.0103812.e004.jpg"/></inline-formula> is the set of edges. The number of vertices <inline-formula><inline-graphic xlink:href="pone.0103812.e005.jpg"/></inline-formula> and the number of edges <inline-formula><inline-graphic xlink:href="pone.0103812.e006.jpg"/></inline-formula> are called the order and the size of the graph, respectively. An edge <inline-formula><inline-graphic xlink:href="pone.0103812.e007.jpg"/></inline-formula> is defined by the pair <inline-formula><inline-graphic xlink:href="pone.0103812.e008.jpg"/></inline-formula>, describing the existence of a relationship between two vertices <inline-formula><inline-graphic xlink:href="pone.0103812.e009.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e010.jpg"/></inline-formula>. In this case, the edge <inline-formula><inline-graphic xlink:href="pone.0103812.e011.jpg"/></inline-formula> is said to be <italic>incident</italic> to the vertices <inline-formula><inline-graphic xlink:href="pone.0103812.e012.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e013.jpg"/></inline-formula>. The set of edges of a graph <inline-formula><inline-graphic xlink:href="pone.0103812.e014.jpg"/></inline-formula> that are incident to a vertex <inline-formula><inline-graphic xlink:href="pone.0103812.e015.jpg"/></inline-formula> is denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e016.jpg"/></inline-formula>, while the cardinality of <inline-formula><inline-graphic xlink:href="pone.0103812.e017.jpg"/></inline-formula> is called the degree of the vertex <inline-formula><inline-graphic xlink:href="pone.0103812.e018.jpg"/></inline-formula>. Similarly, the set of edges that are incident to a set of vertices <inline-formula><inline-graphic xlink:href="pone.0103812.e019.jpg"/></inline-formula> is denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e020.jpg"/></inline-formula>. A graph <inline-formula><inline-graphic xlink:href="pone.0103812.e021.jpg"/></inline-formula> is a <italic>subgraph</italic> of <inline-formula><inline-graphic xlink:href="pone.0103812.e022.jpg"/></inline-formula>, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e023.jpg"/></inline-formula>, if <inline-formula><inline-graphic xlink:href="pone.0103812.e024.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e025.jpg"/></inline-formula>. In this case, <inline-formula><inline-graphic xlink:href="pone.0103812.e026.jpg"/></inline-formula> is called the <italic>supergraph</italic> of <inline-formula><inline-graphic xlink:href="pone.0103812.e027.jpg"/></inline-formula>, and is also said to contain <inline-formula><inline-graphic xlink:href="pone.0103812.e028.jpg"/></inline-formula>. Furthermore, the union of two graphs <inline-formula><inline-graphic xlink:href="pone.0103812.e029.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e030.jpg"/></inline-formula> is denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e031.jpg"/></inline-formula> where <inline-formula><inline-graphic xlink:href="pone.0103812.e032.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e033.jpg"/></inline-formula>. The intersection of two graphs <inline-formula><inline-graphic xlink:href="pone.0103812.e034.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e035.jpg"/></inline-formula> is denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e036.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0103812.e037.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e038.jpg"/></inline-formula>. Finally, the difference between two graphs <inline-formula><inline-graphic xlink:href="pone.0103812.e039.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e040.jpg"/></inline-formula> with <inline-formula><inline-graphic xlink:href="pone.0103812.e041.jpg"/></inline-formula> is denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e042.jpg"/></inline-formula> and defined as the set of edges in the graph <inline-formula><inline-graphic xlink:href="pone.0103812.e043.jpg"/></inline-formula> that do not belong to the graph <inline-formula><inline-graphic xlink:href="pone.0103812.e044.jpg"/></inline-formula>, i.e. edges in the set difference <inline-formula><inline-graphic xlink:href="pone.0103812.e045.jpg"/></inline-formula>.</p><p>A <italic>directed edge</italic> is an ordered pair <inline-formula><inline-graphic xlink:href="pone.0103812.e046.jpg"/></inline-formula>, representing an edge from the vertex <inline-formula><inline-graphic xlink:href="pone.0103812.e047.jpg"/></inline-formula> pointing to the vertex <inline-formula><inline-graphic xlink:href="pone.0103812.e048.jpg"/></inline-formula>. A <italic>directed graph</italic> or <italic>digraph</italic>
<inline-formula><inline-graphic xlink:href="pone.0103812.e049.jpg"/></inline-formula> is a graph in which all of its edges are directed. A <italic>directed path</italic> is a sequence of vertices such that there exists a directed edge from one vertex to the next vertex in the graph. The first vertex in a directed path is called the <italic>start vertex</italic>, and the last is called the <italic>end vertex</italic>. A <italic>directed cycle</italic> is a directed path where the start and the end vertices are the same. A <italic>directed acyclic graph</italic> (DAG) is a digraph which does not contain any cycle. The <italic>adjacency matrix</italic> of a digraph <inline-formula><inline-graphic xlink:href="pone.0103812.e050.jpg"/></inline-formula> of order <inline-formula><inline-graphic xlink:href="pone.0103812.e051.jpg"/></inline-formula>, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e052.jpg"/></inline-formula>, is an <inline-formula><inline-graphic xlink:href="pone.0103812.e053.jpg"/></inline-formula> matrix with <inline-formula><inline-graphic xlink:href="pone.0103812.e054.jpg"/></inline-formula> when <inline-formula><inline-graphic xlink:href="pone.0103812.e055.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0103812.e056.jpg"/></inline-formula> otherwise. In other words, the non-zero elements of the adjacency matrix represent all directed edges from any node <inline-formula><inline-graphic xlink:href="pone.0103812.e057.jpg"/></inline-formula> to another node <inline-formula><inline-graphic xlink:href="pone.0103812.e058.jpg"/></inline-formula> in the graph <inline-formula><inline-graphic xlink:href="pone.0103812.e059.jpg"/></inline-formula>. Meanwhile, the <italic>accessibility matrix</italic> of <inline-formula><inline-graphic xlink:href="pone.0103812.e060.jpg"/></inline-formula>, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e061.jpg"/></inline-formula>, is an <inline-formula><inline-graphic xlink:href="pone.0103812.e062.jpg"/></inline-formula> matrix with <inline-formula><inline-graphic xlink:href="pone.0103812.e063.jpg"/></inline-formula> when there exists a directed path from node <inline-formula><inline-graphic xlink:href="pone.0103812.e064.jpg"/></inline-formula> to node <inline-formula><inline-graphic xlink:href="pone.0103812.e065.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0103812.e066.jpg"/></inline-formula> otherwise. When <inline-formula><inline-graphic xlink:href="pone.0103812.e067.jpg"/></inline-formula>, vertex <inline-formula><inline-graphic xlink:href="pone.0103812.e068.jpg"/></inline-formula> is said to be <italic>accessible</italic> from the vertex <inline-formula><inline-graphic xlink:href="pone.0103812.e069.jpg"/></inline-formula>.</p><p>A strongly connected component or strong component of a digraph <inline-formula><inline-graphic xlink:href="pone.0103812.e070.jpg"/></inline-formula> is a maximal subset of nodes in <inline-formula><inline-graphic xlink:href="pone.0103812.e071.jpg"/></inline-formula> where any two nodes in the subset are mutually accessible. Every pair of nodes that are part of a directed cycle belong to the same strong component, while any node that is not part of a cycle is a strong component of its own. The <italic>condensation</italic> of a digraph <inline-formula><inline-graphic xlink:href="pone.0103812.e072.jpg"/></inline-formula> is the DAG of the strong components of <inline-formula><inline-graphic xlink:href="pone.0103812.e073.jpg"/></inline-formula>, which is generated by lumping the nodes belonging to a cycle into a single node and replicating the edges that are incident to any of these nodes onto the lumped node <xref rid="pone.0103812-Wagner1" ref-type="bibr">[19]</xref>.</p><p>A digraph is <italic>transitive</italic> if for every pair of vertices <inline-formula><inline-graphic xlink:href="pone.0103812.e074.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e075.jpg"/></inline-formula>, there exists an edge <inline-formula><inline-graphic xlink:href="pone.0103812.e076.jpg"/></inline-formula> when there is a directed path from <inline-formula><inline-graphic xlink:href="pone.0103812.e077.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0103812.e078.jpg"/></inline-formula>. The <italic>transitive closure</italic> of a digraph <inline-formula><inline-graphic xlink:href="pone.0103812.e079.jpg"/></inline-formula>, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e080.jpg"/></inline-formula>, is the smallest transitive supergraph of <inline-formula><inline-graphic xlink:href="pone.0103812.e081.jpg"/></inline-formula> (with the fewest edges) <xref rid="pone.0103812-Aho1" ref-type="bibr">[20]</xref>. When <inline-formula><inline-graphic xlink:href="pone.0103812.e082.jpg"/></inline-formula> is a DAG, we denote the transitive closure of <inline-formula><inline-graphic xlink:href="pone.0103812.e083.jpg"/></inline-formula> as <inline-formula><inline-graphic xlink:href="pone.0103812.e084.jpg"/></inline-formula>. As shown in <xref ref-type="fig" rid="pone-0103812-g001">Fig. 1(a)-(b)</xref>, the transitive closure of a digraph can be generated by adding a directed edge <inline-formula><inline-graphic xlink:href="pone.0103812.e085.jpg"/></inline-formula>, whenever a directed path exists from vertex <inline-formula><inline-graphic xlink:href="pone.0103812.e086.jpg"/></inline-formula> to vertex <inline-formula><inline-graphic xlink:href="pone.0103812.e087.jpg"/></inline-formula>. Note that the accessibility matrix of a digraph is the adjacency matrix of its transitive closure, i.e. <inline-formula><inline-graphic xlink:href="pone.0103812.e088.jpg"/></inline-formula>. For a digraph <inline-formula><inline-graphic xlink:href="pone.0103812.e089.jpg"/></inline-formula>, the set of digraphs that have the same transitive closure <inline-formula><inline-graphic xlink:href="pone.0103812.e090.jpg"/></inline-formula> is denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e091.jpg"/></inline-formula>. The <italic>transitive reduction</italic> of <inline-formula><inline-graphic xlink:href="pone.0103812.e092.jpg"/></inline-formula>, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e093.jpg"/></inline-formula>, is defined as the smallest member of <inline-formula><inline-graphic xlink:href="pone.0103812.e094.jpg"/></inline-formula> in size (i.e. the graph with the fewest edges). The transitive reduction of a DAG is unique, given by <inline-formula><inline-graphic xlink:href="pone.0103812.e095.jpg"/></inline-formula>
<xref rid="pone.0103812-Aho1" ref-type="bibr">[20]</xref>. An algorithm for obtaining transitive reduction has been previously developed <xref rid="pone.0103812-Wagner1" ref-type="bibr">[19]</xref>, in which any directed edge <inline-formula><inline-graphic xlink:href="pone.0103812.e096.jpg"/></inline-formula> is pruned whenever there exists a directed path from <inline-formula><inline-graphic xlink:href="pone.0103812.e097.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0103812.e098.jpg"/></inline-formula> that does not include <inline-formula><inline-graphic xlink:href="pone.0103812.e099.jpg"/></inline-formula> (for example, see <xref ref-type="fig" rid="pone-0103812-g001">Fig. 1(c)</xref>). Note that the transitive reduction of a digraph with cycles is not unique.</p><fig id="pone-0103812-g001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.g001</object-id><label>Figure 1</label><caption><title>(a) An example of a directed graph <inline-formula><inline-graphic xlink:href="pone.0103812.e100.jpg"/></inline-formula>.</title><p>(b) The transitive closure <inline-formula><inline-graphic xlink:href="pone.0103812.e101.jpg"/></inline-formula> (in this case, <inline-formula><inline-graphic xlink:href="pone.0103812.e102.jpg"/></inline-formula> since <inline-formula><inline-graphic xlink:href="pone.0103812.e103.jpg"/></inline-formula> is a DAG). (c) The transitive reduction <inline-formula><inline-graphic xlink:href="pone.0103812.e104.jpg"/></inline-formula> of <inline-formula><inline-graphic xlink:href="pone.0103812.e105.jpg"/></inline-formula>. (d) The directed graph <inline-formula><inline-graphic xlink:href="pone.0103812.e106.jpg"/></inline-formula> associated with <inline-formula><inline-graphic xlink:href="pone.0103812.e107.jpg"/></inline-formula>. (e) The transitive closure <inline-formula><inline-graphic xlink:href="pone.0103812.e108.jpg"/></inline-formula>. In this case, the transitive reduction <inline-formula><inline-graphic xlink:href="pone.0103812.e109.jpg"/></inline-formula> happens to be the graph <inline-formula><inline-graphic xlink:href="pone.0103812.e110.jpg"/></inline-formula>. (f) The ensemble upper bound <inline-formula><inline-graphic xlink:href="pone.0103812.e111.jpg"/></inline-formula> obtained from <inline-formula><inline-graphic xlink:href="pone.0103812.e112.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e113.jpg"/></inline-formula>. The ensemble lower bound <inline-formula><inline-graphic xlink:href="pone.0103812.e114.jpg"/></inline-formula> obtained from <inline-formula><inline-graphic xlink:href="pone.0103812.e115.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e116.jpg"/></inline-formula> happens to be the graph <inline-formula><inline-graphic xlink:href="pone.0103812.e117.jpg"/></inline-formula>.</p></caption><graphic xlink:href="pone.0103812.g001"/></fig></sec><sec id="s2a2"><title>Inference of Network Ensemble Bounds</title><p>In this work, we consider the inference of GRNs as digraphs, where the nodes correspond to the genes and the directed edges represent the gene regulatory interactions. An edge <inline-formula><inline-graphic xlink:href="pone.0103812.e118.jpg"/></inline-formula> implies that the expression of gene <inline-formula><inline-graphic xlink:href="pone.0103812.e119.jpg"/></inline-formula> influences the expression of gene <inline-formula><inline-graphic xlink:href="pone.0103812.e120.jpg"/></inline-formula>. In the following, the GRN of interest is denoted by the digraph <inline-formula><inline-graphic xlink:href="pone.0103812.e121.jpg"/></inline-formula>. For any set of genes <inline-formula><inline-graphic xlink:href="pone.0103812.e122.jpg"/></inline-formula>, we use <inline-formula><inline-graphic xlink:href="pone.0103812.e123.jpg"/></inline-formula> to denote a subgraph of <inline-formula><inline-graphic xlink:href="pone.0103812.e124.jpg"/></inline-formula> that results from removing all edges incident to the genes in the set <inline-formula><inline-graphic xlink:href="pone.0103812.e125.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0103812.e126.jpg"/></inline-formula>. In other words, <inline-formula><inline-graphic xlink:href="pone.0103812.e127.jpg"/></inline-formula> is the digraph with <inline-formula><inline-graphic xlink:href="pone.0103812.e128.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e129.jpg"/></inline-formula>. For example, <inline-formula><inline-graphic xlink:href="pone.0103812.e130.jpg"/></inline-formula> associated with <inline-formula><inline-graphic xlink:href="pone.0103812.e131.jpg"/></inline-formula> in <xref ref-type="fig" rid="pone-0103812-g001">Fig. 1(a)</xref> is the graph with all edges incident to gene <inline-formula><inline-graphic xlink:href="pone.0103812.e132.jpg"/></inline-formula> removed, as shown in <xref ref-type="fig" rid="pone-0103812-g001">Fig. 1(d)</xref>. Here, we interchangeably use the notations for a graph <inline-formula><inline-graphic xlink:href="pone.0103812.e133.jpg"/></inline-formula> and its adjacency matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e134.jpg"/></inline-formula>.</p><p>Gene KO experiments are commonly performed for the purpose of GRN inference. In these experiments, the resulting data typically consist of gene expression profiles taken after the effects of the gene perturbation have reached steady state. While temporal gene expressions are increasingly measured, here we focus on using more commonly available steady-state expression data. The treatments of time-series measurements and observational data are left to future publications. Many network inference algorithms have been developed for using data of gene KOs <xref rid="pone.0103812-Smet1" ref-type="bibr">[7]</xref>, <xref rid="pone.0103812-Marbach1" ref-type="bibr">[9]</xref>, and most of these algorithms produce a single network prediction. In contrast, an ensemble inference strategy is adopted in this work.</p><p>In order to illustrate the limitation of using steady-state gene expression data for GRN inference, we consider a GRN <inline-formula><inline-graphic xlink:href="pone.0103812.e135.jpg"/></inline-formula> described by the graph in <xref ref-type="fig" rid="pone-0103812-g001">Fig. 1(a)</xref>. Here, KO of gene <inline-formula><inline-graphic xlink:href="pone.0103812.e136.jpg"/></inline-formula> is expected to cause changes in the expression of genes <inline-formula><inline-graphic xlink:href="pone.0103812.e137.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0103812.e138.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0103812.e139.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e140.jpg"/></inline-formula> at steady state, even though <inline-formula><inline-graphic xlink:href="pone.0103812.e141.jpg"/></inline-formula> directly regulates only <inline-formula><inline-graphic xlink:href="pone.0103812.e142.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e143.jpg"/></inline-formula>. This simple illustration demonstrates that we cannot in principle discriminate direct and indirect gene regulations from steady-state gene KO expression data <xref rid="pone.0103812-Wagner1" ref-type="bibr">[19]</xref>. In general, genes that are differentially expressed upon knocking out gene <inline-formula><inline-graphic xlink:href="pone.0103812.e144.jpg"/></inline-formula> in the GRN correspond to those that are directly and indirectly regulated by gene <inline-formula><inline-graphic xlink:href="pone.0103812.e145.jpg"/></inline-formula>, i.e. vertices in <inline-formula><inline-graphic xlink:href="pone.0103812.e146.jpg"/></inline-formula> that are accessible from the vertex <inline-formula><inline-graphic xlink:href="pone.0103812.e147.jpg"/></inline-formula>. Motivated by such a limitation, in TRaCE we first convert gene KO data into gene accessibility lists or matrices. As the minimum input, TRaCE requires the complete dataset of single-gene KO experiments, from which one can construct the accessibility matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e148.jpg"/></inline-formula>. More specifically, the <inline-formula><inline-graphic xlink:href="pone.0103812.e149.jpg"/></inline-formula>-th element in the <inline-formula><inline-graphic xlink:href="pone.0103812.e150.jpg"/></inline-formula>-th row of <inline-formula><inline-graphic xlink:href="pone.0103812.e151.jpg"/></inline-formula> (i.e. <inline-formula><inline-graphic xlink:href="pone.0103812.e152.jpg"/></inline-formula>) is set to 1 when gene <inline-formula><inline-graphic xlink:href="pone.0103812.e153.jpg"/></inline-formula> is differentially expressed in the KO experiment of gene <inline-formula><inline-graphic xlink:href="pone.0103812.e154.jpg"/></inline-formula>. The other elements of <inline-formula><inline-graphic xlink:href="pone.0103812.e155.jpg"/></inline-formula> are set to <inline-formula><inline-graphic xlink:href="pone.0103812.e156.jpg"/></inline-formula>. The detailed procedure of differential expression analysis adopted in this work is described in the Numerical Implementation section.</p><p>For data of multi-gene KO experiments, we consider the accessibility matrix of <inline-formula><inline-graphic xlink:href="pone.0103812.e157.jpg"/></inline-formula> for an appropriately chosen set of genes <inline-formula><inline-graphic xlink:href="pone.0103812.e158.jpg"/></inline-formula>. In principle, we can determine <inline-formula><inline-graphic xlink:href="pone.0103812.e159.jpg"/></inline-formula> from the complete set of experiments involving KOs of the genes in the set <inline-formula><inline-graphic xlink:href="pone.0103812.e160.jpg"/></inline-formula> and an additional gene <inline-formula><inline-graphic xlink:href="pone.0103812.e161.jpg"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="pone.0103812.e162.jpg"/></inline-formula>. These experiments are equivalent to performing single-gene KOs of the GRN <inline-formula><inline-graphic xlink:href="pone.0103812.e163.jpg"/></inline-formula>, and therefore <inline-formula><inline-graphic xlink:href="pone.0103812.e164.jpg"/></inline-formula> can be obtained by following the same procedure as that for <inline-formula><inline-graphic xlink:href="pone.0103812.e165.jpg"/></inline-formula> above. As an illustration, consider the GRN in <xref ref-type="fig" rid="pone-0103812-g001">Fig. 1(a)</xref> with <inline-formula><inline-graphic xlink:href="pone.0103812.e166.jpg"/></inline-formula>. The graph <inline-formula><inline-graphic xlink:href="pone.0103812.e167.jpg"/></inline-formula> is given in <xref ref-type="fig" rid="pone-0103812-g001">Fig. 1(d)</xref>. In this case, we can construct the accessibility matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e168.jpg"/></inline-formula> from the data of two-gene KO experiments, namely <inline-formula><inline-graphic xlink:href="pone.0103812.e169.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0103812.e170.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0103812.e171.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e172.jpg"/></inline-formula> KOs. As these experiments differ from each other in only one gene while sharing the KO of gene <inline-formula><inline-graphic xlink:href="pone.0103812.e173.jpg"/></inline-formula>, the differential expression analysis of the data thus correspond to changes in the expression of the GRN <inline-formula><inline-graphic xlink:href="pone.0103812.e174.jpg"/></inline-formula> caused by a single-gene KO. Consequently, in this analysis, genes that are found to be differentially expressed in the KO of <inline-formula><inline-graphic xlink:href="pone.0103812.e175.jpg"/></inline-formula> are those that are accessible from gene <inline-formula><inline-graphic xlink:href="pone.0103812.e176.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0103812.e177.jpg"/></inline-formula>) in the graph <inline-formula><inline-graphic xlink:href="pone.0103812.e178.jpg"/></inline-formula>. For example, the KO of <inline-formula><inline-graphic xlink:href="pone.0103812.e179.jpg"/></inline-formula> is expected to cause differential expression in genes <inline-formula><inline-graphic xlink:href="pone.0103812.e180.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e181.jpg"/></inline-formula>. The full accessibility matrix of <inline-formula><inline-graphic xlink:href="pone.0103812.e182.jpg"/></inline-formula> is illustrated by the digraph in <xref ref-type="fig" rid="pone-0103812-g001">Fig. 1(e)</xref>.</p><p>We can generalize the simple example above to any set of genes <inline-formula><inline-graphic xlink:href="pone.0103812.e183.jpg"/></inline-formula> that could be derived from the available multi-gene KO experiments. More specifically, we set <inline-formula><inline-graphic xlink:href="pone.0103812.e184.jpg"/></inline-formula> to 1 when knocking-out <inline-formula><inline-graphic xlink:href="pone.0103812.e185.jpg"/></inline-formula> leads to a differential expression of gene <inline-formula><inline-graphic xlink:href="pone.0103812.e186.jpg"/></inline-formula> with respect to its expression level in <inline-formula><inline-graphic xlink:href="pone.0103812.e187.jpg"/></inline-formula>. The remaining elements of <inline-formula><inline-graphic xlink:href="pone.0103812.e188.jpg"/></inline-formula> are set to 0. Unfortunately, the construction of <inline-formula><inline-graphic xlink:href="pone.0103812.e189.jpg"/></inline-formula> of a large GRN <inline-formula><inline-graphic xlink:href="pone.0103812.e190.jpg"/></inline-formula> would proportionally require a high number of KO experiments (the number of KO experiments is <inline-formula><inline-graphic xlink:href="pone.0103812.e191.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0103812.e192.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e193.jpg"/></inline-formula> is the number of genes in <inline-formula><inline-graphic xlink:href="pone.0103812.e194.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e195.jpg"/></inline-formula>, respectively). However, when <inline-formula><inline-graphic xlink:href="pone.0103812.e196.jpg"/></inline-formula> is sparse, <inline-formula><inline-graphic xlink:href="pone.0103812.e197.jpg"/></inline-formula> differs from <inline-formula><inline-graphic xlink:href="pone.0103812.e198.jpg"/></inline-formula> for only a few elements and importantly, these elements can be determined from <inline-formula><inline-graphic xlink:href="pone.0103812.e199.jpg"/></inline-formula> (see the next section).</p><p>In the theoretical development below, we assume that the accessibility matrices <inline-formula><inline-graphic xlink:href="pone.0103812.e200.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e201.jpg"/></inline-formula> for <inline-formula><inline-graphic xlink:href="pone.0103812.e202.jpg"/></inline-formula> have already been obtained from the expression data. Here, <inline-formula><inline-graphic xlink:href="pone.0103812.e203.jpg"/></inline-formula> denotes the total number of accessibility matrices involving subgraphs of the GRN <inline-formula><inline-graphic xlink:href="pone.0103812.e204.jpg"/></inline-formula> that can be constructed from data. For example, from the dataset of the complete double-gene KO experiments, we can obtain the accessibility matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e205.jpg"/></inline-formula> for <inline-formula><inline-graphic xlink:href="pone.0103812.e206.jpg"/></inline-formula> (here, <inline-formula><inline-graphic xlink:href="pone.0103812.e207.jpg"/></inline-formula>). In TRaCE, we consider the ensemble containing all digraphs that are consistent with the accessibility matrices <inline-formula><inline-graphic xlink:href="pone.0103812.e208.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e209.jpg"/></inline-formula>'s, which is the set:<disp-formula id="pone.0103812.e210"><graphic xlink:href="pone.0103812.e210.jpg" position="anchor" orientation="portrait"/><label>(1)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0103812.e211.jpg"/></inline-formula> is the digraph with <inline-formula><inline-graphic xlink:href="pone.0103812.e212.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e213.jpg"/></inline-formula>. Note that the GRN <inline-formula><inline-graphic xlink:href="pone.0103812.e214.jpg"/></inline-formula> is a member of the ensemble <inline-formula><inline-graphic xlink:href="pone.0103812.e215.jpg"/></inline-formula>. The size of the ensemble is a direct measure of uncertainty in the network inference problem. A GRN is therefore deemed inferable when the ensemble only contains a single (unique) network.</p><p>As the number of digraphs in the ensemble is often very large, in TRaCE we generate only the lower and upper bounds of the ensemble, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e216.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e217.jpg"/></inline-formula>, respectively. The bounds are defined such that each digraph in the ensemble is a supergraph of <inline-formula><inline-graphic xlink:href="pone.0103812.e218.jpg"/></inline-formula> and a subgraph of <inline-formula><inline-graphic xlink:href="pone.0103812.e219.jpg"/></inline-formula>. For GRNs without any cycle (i.e. DAGs), the lower and upper bound GRNs can be obtained from the accessibility matrices of <inline-formula><inline-graphic xlink:href="pone.0103812.e220.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e221.jpg"/></inline-formula>'s (i.e. <inline-formula><inline-graphic xlink:href="pone.0103812.e222.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e223.jpg"/></inline-formula>'s) and their transitive reductions (i.e. <inline-formula><inline-graphic xlink:href="pone.0103812.e224.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e225.jpg"/></inline-formula>'s), using the following equations (for details see the Numerical Implementation section):<disp-formula id="pone.0103812.e226"><graphic xlink:href="pone.0103812.e226.jpg" position="anchor" orientation="portrait"/><label>(2)</label></disp-formula><disp-formula id="pone.0103812.e227"><graphic xlink:href="pone.0103812.e227.jpg" position="anchor" orientation="portrait"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0103812.e228.jpg"/></inline-formula> denotes the digraph with vertices <inline-formula><inline-graphic xlink:href="pone.0103812.e229.jpg"/></inline-formula> and edges <inline-formula><inline-graphic xlink:href="pone.0103812.e230.jpg"/></inline-formula>. Without any <inline-formula><inline-graphic xlink:href="pone.0103812.e231.jpg"/></inline-formula>, the upper bound of the ensemble is simply given by the accessibility matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e232.jpg"/></inline-formula> and the lower bound is the transitive reduction <inline-formula><inline-graphic xlink:href="pone.0103812.e233.jpg"/></inline-formula>. As <inline-formula><inline-graphic xlink:href="pone.0103812.e234.jpg"/></inline-formula> is a subgraph of <inline-formula><inline-graphic xlink:href="pone.0103812.e235.jpg"/></inline-formula>, the transitive closure <inline-formula><inline-graphic xlink:href="pone.0103812.e236.jpg"/></inline-formula> is also a subgraph of <inline-formula><inline-graphic xlink:href="pone.0103812.e237.jpg"/></inline-formula>. In Eq. (3), the upper bound is constructed starting from <inline-formula><inline-graphic xlink:href="pone.0103812.e238.jpg"/></inline-formula> in which edges are removed based on <inline-formula><inline-graphic xlink:href="pone.0103812.e239.jpg"/></inline-formula>. Here, edges incident to <inline-formula><inline-graphic xlink:href="pone.0103812.e240.jpg"/></inline-formula> are not altered during the intersection of the accessibility matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e241.jpg"/></inline-formula>. For example, consider again the GRN in <xref ref-type="fig" rid="pone-0103812-g001">Fig. 1(a)</xref> with the accessibility matrices <inline-formula><inline-graphic xlink:href="pone.0103812.e242.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e243.jpg"/></inline-formula> in <xref ref-type="fig" rid="pone-0103812-g001">Figs. 1(b) and 1(e)</xref>. The resulting upper bound <inline-formula><inline-graphic xlink:href="pone.0103812.e244.jpg"/></inline-formula> from the combination of these accessibility matrices will have one fewer edge than <inline-formula><inline-graphic xlink:href="pone.0103812.e245.jpg"/></inline-formula>, which is the edge <inline-formula><inline-graphic xlink:href="pone.0103812.e246.jpg"/></inline-formula> (see <xref ref-type="fig" rid="pone-0103812-g001">Fig. 1(f)</xref>). Thus, the size of the upper bound is generally reduced with the incorporation of <inline-formula><inline-graphic xlink:href="pone.0103812.e247.jpg"/></inline-formula>'s. On the other hand, according to Eq. (2), the lower bound becomes larger with the inclusion of every available <inline-formula><inline-graphic xlink:href="pone.0103812.e248.jpg"/></inline-formula>. In the same example above, the transitive reduction of <inline-formula><inline-graphic xlink:href="pone.0103812.e249.jpg"/></inline-formula> happens to be the graph <inline-formula><inline-graphic xlink:href="pone.0103812.e250.jpg"/></inline-formula> (i.e. in this case <inline-formula><inline-graphic xlink:href="pone.0103812.e251.jpg"/></inline-formula>). Here, the combination of <inline-formula><inline-graphic xlink:href="pone.0103812.e252.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e253.jpg"/></inline-formula> in <xref ref-type="fig" rid="pone-0103812-g001">Figs. 1(c) and 1(d)</xref>, respectively, gives the lower bound <inline-formula><inline-graphic xlink:href="pone.0103812.e254.jpg"/></inline-formula> that is equal to <inline-formula><inline-graphic xlink:href="pone.0103812.e255.jpg"/></inline-formula>. However, in general, <inline-formula><inline-graphic xlink:href="pone.0103812.e256.jpg"/></inline-formula> is a subgraph of <inline-formula><inline-graphic xlink:href="pone.0103812.e257.jpg"/></inline-formula>.</p><p>Theorem 1 establishes <inline-formula><inline-graphic xlink:href="pone.0103812.e258.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e259.jpg"/></inline-formula> in Eqs. (2)-(3) as valid lower and upper bounds of the set <inline-formula><inline-graphic xlink:href="pone.0103812.e260.jpg"/></inline-formula> for DAGs.</p><p><bold>Theorem 1:</bold> For <inline-formula><inline-graphic xlink:href="pone.0103812.e261.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e262.jpg"/></inline-formula> described in Eqs. (2)-(3), the following relationship applies:<disp-formula id="pone.0103812.e263"><graphic xlink:href="pone.0103812.e263.jpg" position="anchor" orientation="portrait"/></disp-formula></p><p><italic>Proof of</italic>
<inline-formula><inline-graphic xlink:href="pone.0103812.e264.jpg"/></inline-formula> For any edge <inline-formula><inline-graphic xlink:href="pone.0103812.e265.jpg"/></inline-formula>, Eq. (2) implies that either <inline-formula><inline-graphic xlink:href="pone.0103812.e266.jpg"/></inline-formula> or <inline-formula><inline-graphic xlink:href="pone.0103812.e267.jpg"/></inline-formula>. Therefore, we have either:</p><list list-type="bullet"><list-item><p><inline-formula><inline-graphic xlink:href="pone.0103812.e268.jpg"/></inline-formula>, or</p></list-item><list-item><p><inline-formula><inline-graphic xlink:href="pone.0103812.e269.jpg"/></inline-formula>. <inline-formula><inline-graphic xlink:href="pone.0103812.e270.jpg"/></inline-formula></p></list-item></list><p><italic>Proof of</italic>
<inline-formula><inline-graphic xlink:href="pone.0103812.e271.jpg"/></inline-formula> If <inline-formula><inline-graphic xlink:href="pone.0103812.e272.jpg"/></inline-formula> for some <inline-formula><inline-graphic xlink:href="pone.0103812.e273.jpg"/></inline-formula>, then <inline-formula><inline-graphic xlink:href="pone.0103812.e274.jpg"/></inline-formula>. In addition, this edge satisfies either: <disp-formula id="pone.0103812.e275"><graphic xlink:href="pone.0103812.e275.jpg" position="anchor" orientation="portrait"/></disp-formula><disp-formula id="pone.0103812.e276"><graphic xlink:href="pone.0103812.e276.jpg" position="anchor" orientation="portrait"/></disp-formula></p><p>Therefore, <inline-formula><inline-graphic xlink:href="pone.0103812.e277.jpg"/></inline-formula>. <inline-formula><inline-graphic xlink:href="pone.0103812.e278.jpg"/></inline-formula></p><p><bold>Remark</bold>: Since <inline-formula><inline-graphic xlink:href="pone.0103812.e279.jpg"/></inline-formula> is a member of <inline-formula><inline-graphic xlink:href="pone.0103812.e280.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0103812.e281.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e282.jpg"/></inline-formula> can also be thought as the lower and upper bounds of <inline-formula><inline-graphic xlink:href="pone.0103812.e283.jpg"/></inline-formula>, i.e. <inline-formula><inline-graphic xlink:href="pone.0103812.e284.jpg"/></inline-formula>. For DAGs, the members of the set <inline-formula><inline-graphic xlink:href="pone.0103812.e285.jpg"/></inline-formula> can be obtained by combinatorially adding edges in the set <inline-formula><inline-graphic xlink:href="pone.0103812.e286.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0103812.e287.jpg"/></inline-formula>. Therefore, the dimension of <inline-formula><inline-graphic xlink:href="pone.0103812.e288.jpg"/></inline-formula> is equal to <inline-formula><inline-graphic xlink:href="pone.0103812.e289.jpg"/></inline-formula> where <inline-formula><inline-graphic xlink:href="pone.0103812.e290.jpg"/></inline-formula> is the difference between the number of edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e291.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e292.jpg"/></inline-formula>. Finally, Theorem 1 guarantees that when <inline-formula><inline-graphic xlink:href="pone.0103812.e293.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0103812.e294.jpg"/></inline-formula> is fully identifiable, i.e. <inline-formula><inline-graphic xlink:href="pone.0103812.e295.jpg"/></inline-formula>.</p><p>For digraphs with cycles, the upper bound can still be constructed using Eq. 3 with <inline-formula><inline-graphic xlink:href="pone.0103812.e296.jpg"/></inline-formula> replacing <inline-formula><inline-graphic xlink:href="pone.0103812.e297.jpg"/></inline-formula>. In this more general case, the relationship <inline-formula><inline-graphic xlink:href="pone.0103812.e298.jpg"/></inline-formula> in Theorem 1 is still valid. However, as mentioned earlier, the transitive reduction of digraphs with cycles is not unique. In a previous publication <xref rid="pone.0103812-Wagner1" ref-type="bibr">[19]</xref>, Wagner proposed a procedure in which digraphs are first condensed into DAGs before constructing the transitive reduction <xref rid="pone.0103812-Wagner1" ref-type="bibr">[19]</xref>. Similarly, in TRaCE, each input accessibility matrix is first condensed and the transitive reduction algorithm is subsequently applied to the DAG of the strong components. Here, edges incident to the condensations of cycles are also removed. Afterwards, the transitive reduction graph is expanded, reversing the condensation step. Except for cycles involving two nodes, edges of any directed cycle cannot be uniquely prescribed and are therefore pruned. The above procedure for reducing digraphs with cycles is referred to as <bold>Con</bold>densation, <bold>T</bold>ransitive <bold>R</bold>eduction and <bold>Ex</bold>pansion (ConTREx). The ConTREx of an accessibility matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e299.jpg"/></inline-formula>, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e300.jpg"/></inline-formula>, may no longer be a valid transitive reduction (i.e. <inline-formula><inline-graphic xlink:href="pone.0103812.e301.jpg"/></inline-formula> may not necessarily be equal to <inline-formula><inline-graphic xlink:href="pone.0103812.e302.jpg"/></inline-formula>). Nonetheless, the lower bound constructed using Eq. (2) with <inline-formula><inline-graphic xlink:href="pone.0103812.e303.jpg"/></inline-formula>'s replacing <inline-formula><inline-graphic xlink:href="pone.0103812.e304.jpg"/></inline-formula>'s, satisfies <inline-formula><inline-graphic xlink:href="pone.0103812.e305.jpg"/></inline-formula>. The proof of this relationship is analogous to the one presented for Theorem 1. However, <inline-formula><inline-graphic xlink:href="pone.0103812.e306.jpg"/></inline-formula> may not be a member of <inline-formula><inline-graphic xlink:href="pone.0103812.e307.jpg"/></inline-formula> (see <xref ref-type="supplementary-material" rid="pone.0103812.s001">Fig. S1</xref>). Finally, the enumeration of digraphs with cycles from <inline-formula><inline-graphic xlink:href="pone.0103812.e308.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e309.jpg"/></inline-formula> is more complicated than that for DAGs. The main difference is in the generation of all possible cycles among nodes belonging to a particular strong component, constrained by <inline-formula><inline-graphic xlink:href="pone.0103812.e310.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e311.jpg"/></inline-formula> (see an example in <xref ref-type="supplementary-material" rid="pone.0103812.s002">Fig. S2</xref>).</p></sec><sec id="s2a3"><title>Error Correction and Filter</title><p>In practice, the accessibility matrices constructed from data contain errors. Some elements of the accessibility matrices maybe identified as 1 when they should be 0 (i.e. false positive, FP), and some maybe identified as 0 when they should be 1 (i.e. false negative, FN). These errors can affect the lower and upper bound constructed by Eqs. (2)-(3). We denote the erroneous lower and upper bound by <inline-formula><inline-graphic xlink:href="pone.0103812.e312.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e313.jpg"/></inline-formula>, respectively. In this case, neither <inline-formula><inline-graphic xlink:href="pone.0103812.e314.jpg"/></inline-formula> is guaranteed to be a subgraph of <inline-formula><inline-graphic xlink:href="pone.0103812.e315.jpg"/></inline-formula>, nor <inline-formula><inline-graphic xlink:href="pone.0103812.e316.jpg"/></inline-formula> a supergraph of <inline-formula><inline-graphic xlink:href="pone.0103812.e317.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e318.jpg"/></inline-formula>.</p><p>There are several types of errors affecting <inline-formula><inline-graphic xlink:href="pone.0103812.e319.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e320.jpg"/></inline-formula>. In the first case (Type A error), an edge which is not present in <inline-formula><inline-graphic xlink:href="pone.0103812.e321.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0103812.e322.jpg"/></inline-formula>) erroneously appears in <inline-formula><inline-graphic xlink:href="pone.0103812.e323.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e324.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0103812.e325.jpg"/></inline-formula>). Or, an edge in <inline-formula><inline-graphic xlink:href="pone.0103812.e326.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0103812.e327.jpg"/></inline-formula>) is missing from both <inline-formula><inline-graphic xlink:href="pone.0103812.e328.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e329.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0103812.e330.jpg"/></inline-formula>). As such error affects both <inline-formula><inline-graphic xlink:href="pone.0103812.e331.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e332.jpg"/></inline-formula> in the same manner, this error is not detectable from <inline-formula><inline-graphic xlink:href="pone.0103812.e333.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e334.jpg"/></inline-formula>. The second case (Type B error) involves either a FP in the accessibility matrix or a FN in the ConTREx matrix. In this case, the resulting bounds are still consistent with each other and are still valid for <inline-formula><inline-graphic xlink:href="pone.0103812.e335.jpg"/></inline-formula>. However, the ensemble size and the network uncertainty increase due to this error. In the third case (Type C error), an edge erroneously appears only in <inline-formula><inline-graphic xlink:href="pone.0103812.e336.jpg"/></inline-formula>, or vice versa, an edge is errorneously missing only from <inline-formula><inline-graphic xlink:href="pone.0103812.e337.jpg"/></inline-formula> (<inline-formula><inline-graphic xlink:href="pone.0103812.e338.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="pone.0103812.e339.jpg"/></inline-formula> denote the complement of a set). Here, the bounds become inconsistent with each other (i.e., <inline-formula><inline-graphic xlink:href="pone.0103812.e340.jpg"/></inline-formula>). Thus, we refer such errors as <italic>inconsistent edges</italic>, which can be identified by searching for edges belonging to <inline-formula><inline-graphic xlink:href="pone.0103812.e341.jpg"/></inline-formula> that are not in <inline-formula><inline-graphic xlink:href="pone.0103812.e342.jpg"/></inline-formula> (i.e., from <inline-formula><inline-graphic xlink:href="pone.0103812.e343.jpg"/></inline-formula>). <xref ref-type="table" rid="pone-0103812-t001">Table 1</xref> illustrates the three types of errors mentioned above.</p><table-wrap id="pone-0103812-t001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.t001</object-id><label>Table 1</label><caption><title>Types of Errors in <inline-formula><inline-graphic xlink:href="pone.0103812.e344.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e345.jpg"/></inline-formula>.</title></caption><alternatives><graphic id="pone-0103812-t001-1" xlink:href="pone.0103812.t001"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1"/><td colspan="2" align="left" rowspan="1">Error</td><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/></tr><tr><td align="left" rowspan="1" colspan="1"/><td colspan="2" align="left" rowspan="1">Type A</td><td align="left" rowspan="1" colspan="1">Type B</td><td align="left" rowspan="1" colspan="1">Type C</td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e346.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">0 or 1</td><td align="left" rowspan="1" colspan="1">0 or 1</td></tr><tr><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e347.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">0</td></tr><tr><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e348.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">1</td></tr></tbody></table></alternatives></table-wrap><p>A closer scrutiny of Eqs. (2)-(3) reveals that errors from the input accessibility matrices are passed on and compounded in the bounds. For example, FN errors in <inline-formula><inline-graphic xlink:href="pone.0103812.e349.jpg"/></inline-formula> or any <inline-formula><inline-graphic xlink:href="pone.0103812.e350.jpg"/></inline-formula> will end up in <inline-formula><inline-graphic xlink:href="pone.0103812.e351.jpg"/></inline-formula>, while FPs in <inline-formula><inline-graphic xlink:href="pone.0103812.e352.jpg"/></inline-formula> and any <inline-formula><inline-graphic xlink:href="pone.0103812.e353.jpg"/></inline-formula> will also appear in <inline-formula><inline-graphic xlink:href="pone.0103812.e354.jpg"/></inline-formula>. In order to reduce the transmission of errors, we have developed a filter such that only a subset of edges of <inline-formula><inline-graphic xlink:href="pone.0103812.e355.jpg"/></inline-formula> are used for the construction of <inline-formula><inline-graphic xlink:href="pone.0103812.e356.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e357.jpg"/></inline-formula>. The filter is based on the concept of <italic>testable edges</italic>. Specifically, the testable edges of <inline-formula><inline-graphic xlink:href="pone.0103812.e358.jpg"/></inline-formula> are any edge <inline-formula><inline-graphic xlink:href="pone.0103812.e359.jpg"/></inline-formula> with <inline-formula><inline-graphic xlink:href="pone.0103812.e360.jpg"/></inline-formula>, such that there exists a directed path from <inline-formula><inline-graphic xlink:href="pone.0103812.e361.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0103812.e362.jpg"/></inline-formula> involving one or more genes in <inline-formula><inline-graphic xlink:href="pone.0103812.e363.jpg"/></inline-formula>. As directed paths involving genes in <inline-formula><inline-graphic xlink:href="pone.0103812.e364.jpg"/></inline-formula> are disconnected in <inline-formula><inline-graphic xlink:href="pone.0103812.e365.jpg"/></inline-formula>, we can potentially verify the existence of the testable edges from <inline-formula><inline-graphic xlink:href="pone.0103812.e366.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e367.jpg"/></inline-formula>. For example, the existence of the edge <inline-formula><inline-graphic xlink:href="pone.0103812.e368.jpg"/></inline-formula> in <xref ref-type="fig" rid="pone-0103812-g001">Fig. 1(a)</xref> can be verified using the transitive reduction of <inline-formula><inline-graphic xlink:href="pone.0103812.e369.jpg"/></inline-formula>, which is the graph shown in <xref ref-type="fig" rid="pone-0103812-g001">Fig. 1(d)</xref>. Meanwhile, we can establish the absence of the edge <inline-formula><inline-graphic xlink:href="pone.0103812.e370.jpg"/></inline-formula> in <inline-formula><inline-graphic xlink:href="pone.0103812.e371.jpg"/></inline-formula> using the accessibility matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e372.jpg"/></inline-formula> (see <xref ref-type="fig" rid="pone-0103812-g001">Fig. 1(e)</xref>). The number of testable edges can also be used to estimate the information content of a <inline-formula><inline-graphic xlink:href="pone.0103812.e373.jpg"/></inline-formula>, where a higher number of testable edges indicates more informative <inline-formula><inline-graphic xlink:href="pone.0103812.e374.jpg"/></inline-formula>.</p><p>For a given <inline-formula><inline-graphic xlink:href="pone.0103812.e375.jpg"/></inline-formula>, it is straightforward to show that the testable edges are the non-zero entries of the testability matrix:<disp-formula id="pone.0103812.e376"><graphic xlink:href="pone.0103812.e376.jpg" position="anchor" orientation="portrait"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0103812.e377.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e378.jpg"/></inline-formula> are the <italic>i</italic>-th column and <italic>i</italic>-th row of <inline-formula><inline-graphic xlink:href="pone.0103812.e379.jpg"/></inline-formula>, respectively, and <inline-formula><inline-graphic xlink:href="pone.0103812.e380.jpg"/></inline-formula> denotes the outer product. During the construction of the lower and upper bound GRNs, the incorporation of each <inline-formula><inline-graphic xlink:href="pone.0103812.e381.jpg"/></inline-formula> will only need to be performed for the associated testable edges, i.e. non-zero elements of <inline-formula><inline-graphic xlink:href="pone.0103812.e382.jpg"/></inline-formula>. Moreover, as the number of testable edges corresponding to <inline-formula><inline-graphic xlink:href="pone.0103812.e383.jpg"/></inline-formula> is typically small and as such edges can be determined from <inline-formula><inline-graphic xlink:href="pone.0103812.e384.jpg"/></inline-formula>, only a few rows of <inline-formula><inline-graphic xlink:href="pone.0103812.e385.jpg"/></inline-formula> need to be determined from data, i.e. rows of <inline-formula><inline-graphic xlink:href="pone.0103812.e386.jpg"/></inline-formula> with non-zero entries. Thus, the number of KO experiments for constructing <inline-formula><inline-graphic xlink:href="pone.0103812.e387.jpg"/></inline-formula> could be relaxed by considering only testable edges.</p></sec></sec><sec id="s2b"><title>Numerical Implementation</title><p>The pseudo-codes and the MATLAB implementations of TRaCE are provided in the supporting material and the following website (<ext-link ext-link-type="uri" xlink:href="http://www.cabsel.ethz.ch/tools/trace">http://www.cabsel.ethz.ch/tools/trace</ext-link>). Given steady-state gene expression data, we first group the data into datasets according to the KO experiments required for the construction of the accessibility matrices. We perform differential expression analysis for each dataset using Z-score transformation and obtain the corresponding accessibility matrix. We provide two implementations of TRaCE, one with and another without error correction. TRaCE without error correction should only be applied when the input accessibility matrices are error free (e.g. for inferability analysis). In any other scenario, TRaCE with error correction should be used. If desired, a ranked list of gene regulatory predictions can also be generated using the lower and upper bounds of the ensemble and the differential expression analysis.</p><sec id="s2b1"><title>Constructing Accessibility Matrices from Expression Data</title><p>In the case studies, we have employed the Z-score transformation for differential gene expression analysis <xref rid="pone.0103812-Jackson1" ref-type="bibr">[21]</xref>. Without loss of generality, we describe below the procedure for constructing <inline-formula><inline-graphic xlink:href="pone.0103812.e388.jpg"/></inline-formula> from the complete set of single-gene KOs of <inline-formula><inline-graphic xlink:href="pone.0103812.e389.jpg"/></inline-formula>, i.e. all possible combinations of <inline-formula><inline-graphic xlink:href="pone.0103812.e390.jpg"/></inline-formula> genes KOs. The gene expression dataset is organized into a matrix in which the rows correspond to the experiments and the columns correspond to the genes. Technical replicates are arranged into separate data matrices. For microarray data, the gene expression is typically represented by log-10 transformed fluorescence intensity data. The following procedure is also illustrated in <xref ref-type="fig" rid="pone-0103812-g002">Fig. 2</xref>.</p><fig id="pone-0103812-g002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.g002</object-id><label>Figure 2</label><caption><title>Construction of accessibility matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e414.jpg"/></inline-formula> from expression data.</title><p>The data come from KOs of genes in the set <inline-formula><inline-graphic xlink:href="pone.0103812.e415.jpg"/></inline-formula> and an additional gene <inline-formula><inline-graphic xlink:href="pone.0103812.e416.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0103812.e417.jpg"/></inline-formula>. For each replicate, the expression data are arranged into a matrix where the rows correspond to the experiments and the columns correspond to the genes. (1) The sample mean and standard deviation of the expression of gene <inline-formula><inline-graphic xlink:href="pone.0103812.e418.jpg"/></inline-formula>, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e419.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e420.jpg"/></inline-formula>, respectively, are obtained using the expression data in the <inline-formula><inline-graphic xlink:href="pone.0103812.e421.jpg"/></inline-formula>-th column of the data matrix. (2) For each replicate, a z-score matrix is computed according to Eq. (5). (3) Subsequently, the z-score matrices are averaged over the technical replicates to give <inline-formula><inline-graphic xlink:href="pone.0103812.e422.jpg"/></inline-formula>. (4) The accessibility matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e423.jpg"/></inline-formula> is determined from <inline-formula><inline-graphic xlink:href="pone.0103812.e424.jpg"/></inline-formula> based on a threshold criterion in Eq. (6).</p></caption><graphic xlink:href="pone.0103812.g002"/></fig><list list-type="order"><list-item><p>We first obtain the sample mean <inline-formula><inline-graphic xlink:href="pone.0103812.e391.jpg"/></inline-formula> and standard deviation <inline-formula><inline-graphic xlink:href="pone.0103812.e392.jpg"/></inline-formula> of the expression of each gene <inline-formula><inline-graphic xlink:href="pone.0103812.e393.jpg"/></inline-formula> in the dataset. More specifically, for each technical replicate, we calculate the sample mean and standard deviation of the <inline-formula><inline-graphic xlink:href="pone.0103812.e394.jpg"/></inline-formula>-th column in the data matrix. Then, we identify expressions that differ from the mean by more than a specified multiple <inline-formula><inline-graphic xlink:href="pone.0103812.e395.jpg"/></inline-formula> of the standard deviation. We subsequently recompute the sample mean and standard deviation <inline-formula><inline-graphic xlink:href="pone.0103812.e396.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e397.jpg"/></inline-formula> by excluding the data beyond <inline-formula><inline-graphic xlink:href="pone.0103812.e398.jpg"/></inline-formula>. When available, we also use the expression data from the KO experiment of genes <inline-formula><inline-graphic xlink:href="pone.0103812.e399.jpg"/></inline-formula> in calculating <inline-formula><inline-graphic xlink:href="pone.0103812.e400.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e401.jpg"/></inline-formula>.</p></list-item><list-item><p>For each replicate, we compute a z-score matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e402.jpg"/></inline-formula> for <inline-formula><inline-graphic xlink:href="pone.0103812.e403.jpg"/></inline-formula> according to <xref rid="pone.0103812-Jackson1" ref-type="bibr">[21]</xref></p><p><disp-formula id="pone.0103812.e404"><graphic xlink:href="pone.0103812.e404.jpg" position="anchor" orientation="portrait"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0103812.e405.jpg"/></inline-formula> is the expression level of gene <inline-formula><inline-graphic xlink:href="pone.0103812.e406.jpg"/></inline-formula> associated with knocking out gene <inline-formula><inline-graphic xlink:href="pone.0103812.e407.jpg"/></inline-formula> and genes in <inline-formula><inline-graphic xlink:href="pone.0103812.e408.jpg"/></inline-formula>. These z-scores reflect the significance of changes in the gene expression with respect to the GRN <inline-formula><inline-graphic xlink:href="pone.0103812.e409.jpg"/></inline-formula>.</p></list-item><list-item><p>Subsequently, we average the z-score matrices over the technical replicates, producing the overall z-score matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e410.jpg"/></inline-formula>.</p></list-item><list-item><p>We determine the accessibility matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e411.jpg"/></inline-formula> from <inline-formula><inline-graphic xlink:href="pone.0103812.e412.jpg"/></inline-formula> using a threshold, as follows:<disp-formula id="pone.0103812.e413"><graphic xlink:href="pone.0103812.e413.jpg" position="anchor" orientation="portrait"/><label>(6)</label></disp-formula></p></list-item></list><p>In our experience, <inline-formula><inline-graphic xlink:href="pone.0103812.e425.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e426.jpg"/></inline-formula> provide reliable network ensembles. In general, choosing higher <inline-formula><inline-graphic xlink:href="pone.0103812.e427.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e428.jpg"/></inline-formula> will lead to fewer FPs but more FNs in the accessibility matrix. For the GRN examples considered in this work, the performance of TRaCE does not vary considerably within the selected ranges of <inline-formula><inline-graphic xlink:href="pone.0103812.e429.jpg"/></inline-formula> between 1.5 and 2.5 and <inline-formula><inline-graphic xlink:href="pone.0103812.e430.jpg"/></inline-formula> between 2 and 3 (see <xref ref-type="sec" rid="s3">Results</xref>).</p></sec><sec id="s2b2"><title>TRaCE without error correction</title><p>TRaCE without error correction is implemented as matrix-operations of Eqs. (2) and (3). Briefly, the upper bound <inline-formula><inline-graphic xlink:href="pone.0103812.e431.jpg"/></inline-formula> is constructed by performing Hadamard (element wise) multiplications of the accessibility matrices, excluding the rows and columns corresponding to genes in <inline-formula><inline-graphic xlink:href="pone.0103812.e432.jpg"/></inline-formula>. On the other hand, the transitive reduction is based on the algorithm by Wagner <xref rid="pone.0103812-Wagner1" ref-type="bibr">[19]</xref>, which has been re-implemented using matrix operations. When there is no cycle in <inline-formula><inline-graphic xlink:href="pone.0103812.e433.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e434.jpg"/></inline-formula>'s, the transitive reduction algorithm is applied to each accessibility matrix and the construction of <inline-formula><inline-graphic xlink:href="pone.0103812.e435.jpg"/></inline-formula> is done by binary additions of the transitive reductions, following Eq. (2). Cycles and genes involved in cycles can be detected from entries of <inline-formula><inline-graphic xlink:href="pone.0103812.e436.jpg"/></inline-formula>
<xref rid="pone.0103812-Harray1" ref-type="bibr">[22]</xref>. For GRNs with cycles, the ConTREx procedure is applied to each available accessibility matrix, and the resulting <inline-formula><inline-graphic xlink:href="pone.0103812.e437.jpg"/></inline-formula> matrices are again combined using binary additions to produce <inline-formula><inline-graphic xlink:href="pone.0103812.e438.jpg"/></inline-formula>. The schematic diagram of the error-free implementation is shown in <xref ref-type="fig" rid="pone-0103812-g003">Fig. 3(a)</xref>.</p><fig id="pone-0103812-g003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.g003</object-id><label>Figure 3</label><caption><title>Schematic diagrams of TRaCE with and without error correction.</title><p>(a) Construction of the lower bound <inline-formula><inline-graphic xlink:href="pone.0103812.e439.jpg"/></inline-formula> and upper bound <inline-formula><inline-graphic xlink:href="pone.0103812.e440.jpg"/></inline-formula> from <inline-formula><inline-graphic xlink:href="pone.0103812.e441.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e442.jpg"/></inline-formula>'s using TRaCE without error correction. Expression data from gene KO experiments are first converted into accessibility matrices. ConTREx is then applied to each accessibility matrix, removing feed-forward edges and edges incident to vertices belonging cycles with more than 2 nodes. The upper bound is constructed by taking the intersection of the accessibility matrices, while the lower bound is constructed by taking the union of the ConTREx outputs. (b) Construction of the lower bound <inline-formula><inline-graphic xlink:href="pone.0103812.e443.jpg"/></inline-formula> and upper bound <inline-formula><inline-graphic xlink:href="pone.0103812.e444.jpg"/></inline-formula> from <inline-formula><inline-graphic xlink:href="pone.0103812.e445.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e446.jpg"/></inline-formula>'s using TRaCE with error correction. Expression data from gene KO experiments are converted into accessibility matrices <inline-formula><inline-graphic xlink:href="pone.0103812.e447.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e448.jpg"/></inline-formula>'s, where the superscript <inline-formula><inline-graphic xlink:href="pone.0103812.e449.jpg"/></inline-formula> indicates that these matrices may not be transitive due to noise in the measured gene expression levels. Subsequently, the transitive closures of <inline-formula><inline-graphic xlink:href="pone.0103812.e450.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e451.jpg"/></inline-formula>'s are created, denoted respectively by <inline-formula><inline-graphic xlink:href="pone.0103812.e452.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e453.jpg"/></inline-formula>'s, and the ConTREx of these closures are evaluated. TRaCE with error correction begins with the preprocessing of <inline-formula><inline-graphic xlink:href="pone.0103812.e454.jpg"/></inline-formula>'s and <inline-formula><inline-graphic xlink:href="pone.0103812.e455.jpg"/></inline-formula>'s to produce the corrected matrices <inline-formula><inline-graphic xlink:href="pone.0103812.e456.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e457.jpg"/></inline-formula>, which are required to determine testable edges. For the construction of the lower and upper bounds, the union and intersection of matrices are performed with filtering, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e458.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e459.jpg"/></inline-formula>, respectively, where only the relevant testable edges are updated. Two candidate upper bounds are obtained, the first from the matrices <inline-formula><inline-graphic xlink:href="pone.0103812.e460.jpg"/></inline-formula>'s, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e461.jpg"/></inline-formula>, and the second from the matrices <inline-formula><inline-graphic xlink:href="pone.0103812.e462.jpg"/></inline-formula>'s, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e463.jpg"/></inline-formula>. Meanwhile, the initial lower bound estimate, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e464.jpg"/></inline-formula>, is obtained from the ConTREx matrices. The consistency check (CC) is first applied to the pair <inline-formula><inline-graphic xlink:href="pone.0103812.e465.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e466.jpg"/></inline-formula> to produce the corrected lower bound <inline-formula><inline-graphic xlink:href="pone.0103812.e467.jpg"/></inline-formula>, and then to the pair <inline-formula><inline-graphic xlink:href="pone.0103812.e468.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e469.jpg"/></inline-formula> to produce the final estimates of the bounds <inline-formula><inline-graphic xlink:href="pone.0103812.e470.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e471.jpg"/></inline-formula>. More detailed descriptions of the filtering and consistency check can be found in supporting material (<xref ref-type="supplementary-material" rid="pone.0103812.s007">text S1</xref> and <xref ref-type="supplementary-material" rid="pone.0103812.s008">text S2</xref>).</p></caption><graphic xlink:href="pone.0103812.g003"/></fig></sec><sec id="s2b3"><title>TRaCE with error correction</title><p>The procedure for TRaCE with error correction is illustrated in <xref ref-type="fig" rid="pone-0103812-g003">Fig. 3(b)</xref>. There are two main steps in this procedure: (1) the construction of lower and upper bounds with filtering and (2) the correction of inconsistent edges. The first main step refers to an implementation of Eqs. (2) and (3) in which the intersection and union operations involving <inline-formula><inline-graphic xlink:href="pone.0103812.e472.jpg"/></inline-formula> are performed only for testable edges associated with non-zero entries of <inline-formula><inline-graphic xlink:href="pone.0103812.e473.jpg"/></inline-formula>. As testable edges are determined from <inline-formula><inline-graphic xlink:href="pone.0103812.e474.jpg"/></inline-formula>, a pre-processing step is performed to reduce errors in <inline-formula><inline-graphic xlink:href="pone.0103812.e475.jpg"/></inline-formula>. The premise behind the pre-processing step is that an error unlikely affects the same edge, and that testable edges of any <inline-formula><inline-graphic xlink:href="pone.0103812.e476.jpg"/></inline-formula> constitute only a small subset of edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e477.jpg"/></inline-formula> (i.e. the network is sparse). Following this premise, edges that appear in a majority of the accessibility matrices (above a certain threshold) are kept, but are otherwise removed. In our experience, a threshold of 65% gives a good and reliable performance, but any value between 50% to 80% works quite well in the case studies (see <xref ref-type="sec" rid="s3">Results</xref>). A more detailed description of the pre-processing method can be found in <xref ref-type="supplementary-material" rid="pone.0103812.s007">text S1</xref>, while the filtering algorithm is provided in <xref ref-type="supplementary-material" rid="pone.0103812.s008">text S2</xref>.</p><p>The schematic diagram of TRaCE with error correction is given in <xref ref-type="fig" rid="pone-0103812-g003">Fig. 3(b)</xref>. We consider two sets of accessibility matrices; the first set comes from differential expression analysis (based on <inline-formula><inline-graphic xlink:href="pone.0103812.e478.jpg"/></inline-formula>'s) and the second set comes from the transitive closure of the first set. We create the second set of matrices since the accessibility matrices identified from differential expressions may not satisfy the transitivity condition due to errors. The pre-processing step above is applied to both sets of matrices. Subsequently, two candidate upper bounds are generated using TRaCE with filtering. The upper bound obtained from the first set of accessibility matrices, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e479.jpg"/></inline-formula>, is expectedly smaller (in size) than the bound from the second set, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e480.jpg"/></inline-formula>. Note that ConTREx is only applicable to transitive digraphs, and therefore is applied only to the transitive closures (i.e. the second set). Using TRaCE with filtering, a candidate lower bound, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e481.jpg"/></inline-formula>, is generated from the results of ConTREx.</p><p>The last step in the procedure is to correct inconsistent edges, which is done by voting. For each inconsistent edge, we compared the number of times that the edge is present in the accessibility matrices and the ConTREx results (supporting the presence of the edge), with the number of times that the edge is absent from the accessibility and ConTREx matrices (supporting the absence of the edge). The upper bound is corrected (by addition of this edge) when the presence of the edge receives a (simple) majority vote. Vice versa, the lower bound is corrected (by removal of this edge) when the absence of the edge receives a majority vote. In the case of no majority vote, the edge is added to the upper bound and removed from the lower bound. The detail of the consistency check is described in <xref ref-type="supplementary-material" rid="pone.0103812.s009">text S3</xref>. As shown in <xref ref-type="fig" rid="pone-0103812-g003">Fig. 3(b)</xref>, the consistency check and correction are first performed for the pair <inline-formula><inline-graphic xlink:href="pone.0103812.e482.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e483.jpg"/></inline-formula>, and subsequently the corrected lower bound, denoted by <inline-formula><inline-graphic xlink:href="pone.0103812.e484.jpg"/></inline-formula>, is compared with <inline-formula><inline-graphic xlink:href="pone.0103812.e485.jpg"/></inline-formula> to obtain the final corrected <inline-formula><inline-graphic xlink:href="pone.0103812.e486.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e487.jpg"/></inline-formula>.</p></sec><sec id="s2b4"><title>Ranking of Edges from Ensemble Bounds</title><p>If desired, a ranked list of edges can be generated using the lower and upper bounds of TRaCE in conjunction with the average z-scores for <inline-formula><inline-graphic xlink:href="pone.0103812.e488.jpg"/></inline-formula>, i.e. <inline-formula><inline-graphic xlink:href="pone.0103812.e489.jpg"/></inline-formula>. Here, we carry out the ranking of regulatory edges in two phases. In the first phase, we rank subsets of edges according to the lower and upper bounds in the following order: edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e490.jpg"/></inline-formula>, edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e491.jpg"/></inline-formula>, edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e492.jpg"/></inline-formula>, edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e493.jpg"/></inline-formula>, and finally edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e494.jpg"/></inline-formula>. In the second phase, we rank the edges within individual subsets according to the average z-scores. We implement the second phase by first computing the overall scores <inline-formula><inline-graphic xlink:href="pone.0103812.e495.jpg"/></inline-formula> according to<disp-formula id="pone.0103812.e496"><graphic xlink:href="pone.0103812.e496.jpg" position="anchor" orientation="portrait"/><label>(7)</label></disp-formula></p><p>Following the submission requirement of DREAM 4 network inference challenge, we then assign a confidence score <inline-formula><inline-graphic xlink:href="pone.0103812.e497.jpg"/></inline-formula> to the edge <inline-formula><inline-graphic xlink:href="pone.0103812.e498.jpg"/></inline-formula> according to:<disp-formula id="pone.0103812.e499"><graphic xlink:href="pone.0103812.e499.jpg" position="anchor" orientation="portrait"/><label>(8)</label></disp-formula></p><p>A score <inline-formula><inline-graphic xlink:href="pone.0103812.e500.jpg"/></inline-formula> of 1 reflects the highest confidence of the existence of an edge <inline-formula><inline-graphic xlink:href="pone.0103812.e501.jpg"/></inline-formula>, and vice versa a zero confidence score indicates certainty in the inexistence of <inline-formula><inline-graphic xlink:href="pone.0103812.e502.jpg"/></inline-formula>. Finally, the ranked list of edges is generated by sorting the edges in decreasing order of confidence scores. A similar procedure, called down-ranking, has been presented in Pinna <italic>et al</italic>. <xref rid="pone.0103812-Pinna1" ref-type="bibr">[23]</xref>, where feed-forward edges are ranked lower than edges in the transitive reduction of the accessibility matrix. However, the down-ranking algorithm is described only for data of single-gene KO experiments.</p></sec></sec></sec><sec id="s3"><title>Results</title><sec id="s3a"><title>Inferability Analysis</title><p>We first applied TRaCE to error-free accessibility matrices of <inline-formula><inline-graphic xlink:href="pone.0103812.e503.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e504.jpg"/></inline-formula> by assuming ideal data (unbiased and error free) for the purpose of inferability analysis. Such an analysis is analogous to <italic>a priori</italic> identifiability analysis in the kinetic modeling of biological networks <xref rid="pone.0103812-Srinath1" ref-type="bibr">[12]</xref>. Here, we evaluated the network distances between the lower and upper bounds and the GRN, i.e. the numbers of edges in the set <inline-formula><inline-graphic xlink:href="pone.0103812.e505.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e506.jpg"/></inline-formula>, respectively.</p><sec id="s3a1"><title>Random GRNs</title><p>We investigated the inferability of random GRNs of orders <inline-formula><inline-graphic xlink:href="pone.0103812.e507.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e508.jpg"/></inline-formula> genes. We set the network size (i.e. number of edges) between <inline-formula><inline-graphic xlink:href="pone.0103812.e509.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e510.jpg"/></inline-formula> randomly with equal probability, and assigned the edges without any preference. The upper size limit of <inline-formula><inline-graphic xlink:href="pone.0103812.e511.jpg"/></inline-formula> was chosen based on the ratio between the number of edges and the number of nodes in <italic>E. coli</italic> and yeast GRNs <xref rid="pone.0103812-Schaffter1" ref-type="bibr">[24]</xref>. For each random network, we generated <inline-formula><inline-graphic xlink:href="pone.0103812.e512.jpg"/></inline-formula> accessibility matrices associated with <inline-formula><inline-graphic xlink:href="pone.0103812.e513.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e514.jpg"/></inline-formula> for every <inline-formula><inline-graphic xlink:href="pone.0103812.e515.jpg"/></inline-formula> These accessibility matrices correspond to performing the full set of single- and double-gene KO experiments.</p><p>We applied TRaCE without error correction to construct the ensemble lower and upper bounds for each random network using the aforementioned accessibility matrices. The mean network distances of the bounds from <inline-formula><inline-graphic xlink:href="pone.0103812.e516.jpg"/></inline-formula> are shown in <xref ref-type="fig" rid="pone-0103812-g004">Figs. 4(a) and (b)</xref> as a function of network size. Here, we plotted the network distances of the lower bound using negative numbers and those of the upper bound using positive numbers. By doing so, we could illustrate the distance between the lower and upper bounds in the same plot. In particular, the number of edges in the set <inline-formula><inline-graphic xlink:href="pone.0103812.e517.jpg"/></inline-formula> is equal to the distance between the two network distance curves in <xref ref-type="fig" rid="pone-0103812-g004">Fig. 4</xref>. Not surprisingly, the network distance increased with the size of the networks, i.e. larger networks are more difficult to infer than smaller networks. The difference between the lower and upper bounds also broadened with network size, indicating higher network uncertainty in the inference of larger GRNs. For networks containing fewer edges than nodes, the GRN <inline-formula><inline-graphic xlink:href="pone.0103812.e518.jpg"/></inline-formula> could generally be recovered from <inline-formula><inline-graphic xlink:href="pone.0103812.e519.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e520.jpg"/></inline-formula>'s. Nevertheless, <xref ref-type="fig" rid="pone-0103812-g004">Fig. 4</xref> demonstrated that the GRNs were typically (64% for 10 gene networks and 76% for 100 gene networks) not inferable, since the lower and upper bounds did not converge.</p><fig id="pone-0103812-g004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.g004</object-id><label>Figure 4</label><caption><title>Ensemble inference and inferability of <inline-formula><inline-graphic xlink:href="pone.0103812.e521.jpg"/></inline-formula> random networks of order (a) <inline-formula><inline-graphic xlink:href="pone.0103812.e522.jpg"/></inline-formula> and (b) <inline-formula><inline-graphic xlink:href="pone.0103812.e523.jpg"/></inline-formula> genes.</title><p>The mean network distances of the lower and upper bounds from <inline-formula><inline-graphic xlink:href="pone.0103812.e524.jpg"/></inline-formula> are shown as a function of network size (i.e. number of edges). The error bars indicate the standard deviations.</p></caption><graphic xlink:href="pone.0103812.g004"/></fig><p><xref ref-type="fig" rid="pone-0103812-g005">Fig. 5</xref> shows two examples of GRN inference of order <inline-formula><inline-graphic xlink:href="pone.0103812.e525.jpg"/></inline-formula> genes. In the first case (case I, <inline-formula><inline-graphic xlink:href="pone.0103812.e526.jpg"/></inline-formula> 8 edges), <inline-formula><inline-graphic xlink:href="pone.0103812.e527.jpg"/></inline-formula> could be recovered from <inline-formula><inline-graphic xlink:href="pone.0103812.e528.jpg"/></inline-formula> and as few as 3 <inline-formula><inline-graphic xlink:href="pone.0103812.e529.jpg"/></inline-formula>'s, while in the second case (case II, <inline-formula><inline-graphic xlink:href="pone.0103812.e530.jpg"/></inline-formula> edges), the inference problem was underdetermined. Moreover, the results suggested that <inline-formula><inline-graphic xlink:href="pone.0103812.e531.jpg"/></inline-formula>'s were not equally informative, as the reduction in the distance between the lower and upper bounds by incorporating an additional <inline-formula><inline-graphic xlink:href="pone.0103812.e532.jpg"/></inline-formula> was not uniform.</p><fig id="pone-0103812-g005" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.g005</object-id><label>Figure 5</label><caption><title>Examples of the ensemble inference of random networks with 10 genes.</title><p>In case I, the GRN has 8 edges and is inferable from the accessibility matrices <inline-formula><inline-graphic xlink:href="pone.0103812.e533.jpg"/></inline-formula> and as few as three <inline-formula><inline-graphic xlink:href="pone.0103812.e534.jpg"/></inline-formula>'s. In case II, the GRN has 13 edges and is not inferable.</p></caption><graphic xlink:href="pone.0103812.g005"/></fig></sec><sec id="s3a2"><title>Random scale-free GRNs</title><p>Many cellular networks have been shown to be scale-free with a power-law degree distribution <xref rid="pone.0103812-Albert1" ref-type="bibr">[25]</xref>, where the majority of the nodes have low degrees (1 to 2) and a few nodes (called hubs) are of high degrees. We also tested the performance of TRaCE using random scale-free networks. Here, we constructed two sets of 5000 scale-free GRNs with order <inline-formula><inline-graphic xlink:href="pone.0103812.e535.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e536.jpg"/></inline-formula> genes using the Barab&#x000e1;si&#x02013;Albert model <xref rid="pone.0103812-Albert2" ref-type="bibr">[26]</xref>. Briefly, the GRNs were grown from a random seed network of small size (with 3 vertices) by sequentially adding nodes to the network. For each node addition, between 1 and 5 new edges were inserted to the network connecting the new node with existing ones, in a manner such that the degree distribution decayed exponentially. Again, for the purpose of inferabiliity analysis, we generated <inline-formula><inline-graphic xlink:href="pone.0103812.e537.jpg"/></inline-formula> error-free accessibility matrices <inline-formula><inline-graphic xlink:href="pone.0103812.e538.jpg"/></inline-formula> and all <inline-formula><inline-graphic xlink:href="pone.0103812.e539.jpg"/></inline-formula>'s, equivalent to having ideal data from single- and double-gene KO experiments.</p><p>We used the error-free implementation of TRaCE to construct the ensemble lower and upper bounds for each of the random scale-free GRNs. <xref ref-type="fig" rid="pone-0103812-g006">Fig. 6</xref> shows the mean network distances of the bounds as a function of network size. Similar to the random GRNs, most (79% for 10 gene networks and 75% for 100 gene networks) scale-free GRNs were not inferable from single and double-gene KO experiments, as the ensemble lower and upper bound did not meet for the majority of the networks. The mean network distance of the lower and upper bounds again increased with network size. However, the inference of scale-free GRNs from the accessibility matrices <inline-formula><inline-graphic xlink:href="pone.0103812.e540.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e541.jpg"/></inline-formula>'s appeared to be more difficult than that of random GRNs, as suggested by the larger distances between the lower and upper bounds for scale-free GRNs than for random GRNs of the same size.</p><fig id="pone-0103812-g006" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.g006</object-id><label>Figure 6</label><caption><title>Ensemble inference and inferability of <inline-formula><inline-graphic xlink:href="pone.0103812.e542.jpg"/></inline-formula> random scale-free networks of order (a) <inline-formula><inline-graphic xlink:href="pone.0103812.e543.jpg"/></inline-formula> and (b) <inline-formula><inline-graphic xlink:href="pone.0103812.e544.jpg"/></inline-formula> genes.</title><p>The mean network distances of the lower and upper bounds from <inline-formula><inline-graphic xlink:href="pone.0103812.e545.jpg"/></inline-formula> are shown as a function of network size (i.e. number of edges). The error bars indicate the standard deviations.</p></caption><graphic xlink:href="pone.0103812.g006"/></fig></sec><sec id="s3a3"><title><italic>E. coli</italic> and <italic>S. cerevisiae</italic> GRNs</title><p>Finally, we investigated the inferability of large, realistic GRNs of <italic>E. coli</italic> and <italic>S. cerevisiae</italic> available in GeneNetWeaver <xref rid="pone.0103812-Schaffter1" ref-type="bibr">[24]</xref>. The <italic>E. coli</italic> GRN consists of 1565 genes and 3758 edges, while the yeast GRN comprise 4441 genes and 12873 edges. For <italic>E. coli</italic>, we generated the accessibility matrices of <inline-formula><inline-graphic xlink:href="pone.0103812.e546.jpg"/></inline-formula> and all <inline-formula><inline-graphic xlink:href="pone.0103812.e547.jpg"/></inline-formula>'s. To reduce computational complexity, in the case of yeast, we used only the 100 most informative <inline-formula><inline-graphic xlink:href="pone.0103812.e548.jpg"/></inline-formula>'s based on the number of testable edges (i.e. the number of non-zero elements in the testability matrix <inline-formula><inline-graphic xlink:href="pone.0103812.e549.jpg"/></inline-formula> in Eq. (4)). The results are shown in <xref ref-type="fig" rid="pone-0103812-g007">Figs. 7</xref> and <xref ref-type="fig" rid="pone-0103812-g008">8</xref>. Not surprisingly, both <italic>E. coli</italic> and yeast GRNs could not be completely inferred from the above accessibility matrices. There was a diminishing return of information after about 25 and 50 <inline-formula><inline-graphic xlink:href="pone.0103812.e550.jpg"/></inline-formula>'s for the inference of <italic>E. coli</italic> and yeast GRNs, respectively.</p><fig id="pone-0103812-g007" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.g007</object-id><label>Figure 7</label><caption><title>Ensemble inference of <italic>E. coli</italic> GRN from error-free <inline-formula><inline-graphic xlink:href="pone.0103812.e551.jpg"/></inline-formula> and the complete set of <inline-formula><inline-graphic xlink:href="pone.0103812.e552.jpg"/></inline-formula>'s.</title><p>The plot shows the network distances of the lower and upper bounds from <inline-formula><inline-graphic xlink:href="pone.0103812.e553.jpg"/></inline-formula> as a function of the number of <inline-formula><inline-graphic xlink:href="pone.0103812.e554.jpg"/></inline-formula>'s for the 50 most informative <inline-formula><inline-graphic xlink:href="pone.0103812.e555.jpg"/></inline-formula>'s, i.e. the top 50 highest number of testable edges. The incorporation of <inline-formula><inline-graphic xlink:href="pone.0103812.e556.jpg"/></inline-formula>'s and <inline-formula><inline-graphic xlink:href="pone.0103812.e557.jpg"/></inline-formula>'s was performed sequentially in decreasing number of testable edges. The inset shows the result for the complete set of <inline-formula><inline-graphic xlink:href="pone.0103812.e558.jpg"/></inline-formula>'s.</p></caption><graphic xlink:href="pone.0103812.g007"/></fig><fig id="pone-0103812-g008" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.g008</object-id><label>Figure 8</label><caption><title>Ensemble inference of <italic>S. cerevisieae</italic> GRN from error-free <inline-formula><inline-graphic xlink:href="pone.0103812.e559.jpg"/></inline-formula> and the 100 most informative <inline-formula><inline-graphic xlink:href="pone.0103812.e560.jpg"/></inline-formula>'s based on the number of testable edges.</title><p>The plot shows the network distances of the lower and upper bounds from <inline-formula><inline-graphic xlink:href="pone.0103812.e561.jpg"/></inline-formula> as a function of the number of <inline-formula><inline-graphic xlink:href="pone.0103812.e562.jpg"/></inline-formula>'s. The incorporation of <inline-formula><inline-graphic xlink:href="pone.0103812.e563.jpg"/></inline-formula>'s and <inline-formula><inline-graphic xlink:href="pone.0103812.e564.jpg"/></inline-formula>'s was performed sequentially in decreasing number of testable edges.</p></caption><graphic xlink:href="pone.0103812.g008"/></fig></sec></sec><sec id="s3b"><title>Ensemble inference from errorneous accessibility matrices</title><p>We evaluated the performance of TRaCE with error correction using <italic>E. coli</italic> GRN and subnetworks, as well as yeast GRN. False positive errors were simulated by randomly adding edges to the accessibility matrices, while false negatives were simulated by randomly removing edges from the accessibility matrices. The performance of error correction in TRaCE was judged by the number of erroneous edges that remained in the bounds after correction for different FP and FN rates (abbreviated as FPR and FNR, respectively), defined with respect to the size of <inline-formula><inline-graphic xlink:href="pone.0103812.e565.jpg"/></inline-formula>.</p><sec id="s3b1"><title><italic>E. coli</italic> GRNs</title><p>We first used TRaCE with error correction for the ensemble inference of 50 random subnetworks of <italic>E. coli</italic> GRN with <inline-formula><inline-graphic xlink:href="pone.0103812.e566.jpg"/></inline-formula> genes, generated using GeneNetWeaver <xref rid="pone.0103812-Schaffter1" ref-type="bibr">[24]</xref>. The average number of edges was <inline-formula><inline-graphic xlink:href="pone.0103812.e567.jpg"/></inline-formula>. As in the above case study, we created the accessibility matrices of <inline-formula><inline-graphic xlink:href="pone.0103812.e568.jpg"/></inline-formula> and every <inline-formula><inline-graphic xlink:href="pone.0103812.e569.jpg"/></inline-formula>. We subsequently contaminated these matrices with FP and FN errors at the specified rates without any preference. The accuracy of the lower and upper bounds constructed using TRaCE with and without error correction is summarized in <xref ref-type="table" rid="pone-0103812-t002">Table 2</xref>.</p><table-wrap id="pone-0103812-t002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.t002</object-id><label>Table 2</label><caption><title>Ensemble inference of <italic>E. coli</italic> subnetworks (<inline-formula><inline-graphic xlink:href="pone.0103812.e570.jpg"/></inline-formula> genes).</title></caption><alternatives><graphic id="pone-0103812-t002-2" xlink:href="pone.0103812.t002"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1">FPR</td><td align="left" rowspan="1" colspan="1">FNR</td><td colspan="2" align="left" rowspan="1">Before Correction</td><td colspan="3" align="left" rowspan="1">After Correction</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e571.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e572.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e573.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e574.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e575.jpg"/></inline-formula></td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">122.62</td></tr><tr><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">183.4</td><td align="left" rowspan="1" colspan="1">35.86</td><td align="left" rowspan="1" colspan="1">3.7</td><td align="left" rowspan="1" colspan="1">1.88</td><td align="left" rowspan="1" colspan="1">118.2</td></tr><tr><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">191.1</td><td align="left" rowspan="1" colspan="1">67.36</td><td align="left" rowspan="1" colspan="1">16.56</td><td align="left" rowspan="1" colspan="1">8.7</td><td align="left" rowspan="1" colspan="1">113.52</td></tr><tr><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">1412.42</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0.24</td><td align="left" rowspan="1" colspan="1">150.4</td></tr><tr><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">183.02</td><td align="left" rowspan="1" colspan="1">1441.68</td><td align="left" rowspan="1" colspan="1">2.72</td><td align="left" rowspan="1" colspan="1">1.42</td><td align="left" rowspan="1" colspan="1">146.3</td></tr><tr><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">191</td><td align="left" rowspan="1" colspan="1">1460.82</td><td align="left" rowspan="1" colspan="1">12.06</td><td align="left" rowspan="1" colspan="1">2.1</td><td align="left" rowspan="1" colspan="1">146.74</td></tr><tr><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">2324.46</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0.18</td><td align="left" rowspan="1" colspan="1">213.42</td></tr><tr><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">184.02</td><td align="left" rowspan="1" colspan="1">2354.16</td><td align="left" rowspan="1" colspan="1">2.72</td><td align="left" rowspan="1" colspan="1">0.46</td><td align="left" rowspan="1" colspan="1">197.28</td></tr><tr><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">191</td><td align="left" rowspan="1" colspan="1">2386.88</td><td align="left" rowspan="1" colspan="1">9.94</td><td align="left" rowspan="1" colspan="1">1.62</td><td align="left" rowspan="1" colspan="1">210.12</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>The reported values represent the averages over 50 subnetworks. FPR (FNR) is the ratio between the number of FP (FN) in the accessibility matrices and the number of edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e576.jpg"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="pone.0103812.e577.jpg"/></inline-formula> of any two digraphs <inline-formula><inline-graphic xlink:href="pone.0103812.e578.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e579.jpg"/></inline-formula> denote the number of edges in the set <inline-formula><inline-graphic xlink:href="pone.0103812.e580.jpg"/></inline-formula>.</p></fn></table-wrap-foot></table-wrap><p>As in many scenarios above, none of the subnetworks was inferable. FP errors could be very effectively eliminated by error correction. FNs errors expectedly led to missing edges from the upper bound, as indicated by the number of edges of <inline-formula><inline-graphic xlink:href="pone.0103812.e581.jpg"/></inline-formula> that did not appear in <inline-formula><inline-graphic xlink:href="pone.0103812.e582.jpg"/></inline-formula> (see <inline-formula><inline-graphic xlink:href="pone.0103812.e583.jpg"/></inline-formula> in <xref ref-type="table" rid="pone-0103812-t002">Table 2</xref>). The error correction could not completely eliminate Type A errors, leading to erroneous edges that appeared in the lower bound <inline-formula><inline-graphic xlink:href="pone.0103812.e584.jpg"/></inline-formula> but did not belong to <inline-formula><inline-graphic xlink:href="pone.0103812.e585.jpg"/></inline-formula> (see <inline-formula><inline-graphic xlink:href="pone.0103812.e586.jpg"/></inline-formula> in <xref ref-type="table" rid="pone-0103812-t002">Table 2</xref>). A combination of FP and FN errors were more easily corrected than FN errors alone. While FNs were more difficult to eliminate than FPs, correcting FP errors tended to produce larger network ensembles than FNs, indicating higher network uncertainty (see <inline-formula><inline-graphic xlink:href="pone.0103812.e587.jpg"/></inline-formula> in <xref ref-type="table" rid="pone-0103812-t002">Table 2</xref>). Nevertheless, even in the worst case (0% FP, 20% FN), roughly 90% of the errors in the lower and upper bounds could be removed by the error correction (compare <inline-formula><inline-graphic xlink:href="pone.0103812.e588.jpg"/></inline-formula> before and after correction).</p><p>For the inference of <italic>E. coli</italic> GRN, we generated erroneous accessibility matrices <inline-formula><inline-graphic xlink:href="pone.0103812.e589.jpg"/></inline-formula> and the 100 most informative <inline-formula><inline-graphic xlink:href="pone.0103812.e590.jpg"/></inline-formula>'s corresponding to the top 100 highest numbers of testable edges. The performance of TRaCE with error correction for different FP and FN rates is summarized in <xref ref-type="table" rid="pone-0103812-t003">Table 3</xref>. In addition, the structural Hamming distances of the lower and upper bounds before and after correction are reported in <xref ref-type="supplementary-material" rid="pone.0103812.s005">tables S1</xref> and <xref ref-type="supplementary-material" rid="pone.0103812.s006">S2</xref>. As before, TRaCE with error correction could handle FPs more effectively than FNs, and a mixture of FP and FN errors in the accessibility matrices were more easily eliminated than FN alone. In the worst case (0% FP, 20% FN), more than 95% of the errors were corrected. The size of the ensemble also depended strongly on the FP errors, and at 20% FP, the number of edges between the lower and upper bound reached three times the size of the full GRN.</p><table-wrap id="pone-0103812-t003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.t003</object-id><label>Table 3</label><caption><title>Ensemble inference of <italic>E. coli</italic> GRN.</title></caption><alternatives><graphic id="pone-0103812-t003-3" xlink:href="pone.0103812.t003"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1">FPR</td><td align="left" rowspan="1" colspan="1">FNR</td><td colspan="2" align="left" rowspan="1">Before Correction</td><td colspan="3" align="left" rowspan="1">After Correction</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e591.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e592.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e593.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e594.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e595.jpg"/></inline-formula></td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">3351</td></tr><tr><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">3550</td><td align="left" rowspan="1" colspan="1">1029</td><td align="left" rowspan="1" colspan="1">25</td><td align="left" rowspan="1" colspan="1">46</td><td align="left" rowspan="1" colspan="1">3281</td></tr><tr><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">3746</td><td align="left" rowspan="1" colspan="1">1685</td><td align="left" rowspan="1" colspan="1">56</td><td align="left" rowspan="1" colspan="1">173</td><td align="left" rowspan="1" colspan="1">3092</td></tr><tr><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">34796</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">4636</td></tr><tr><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">3573</td><td align="left" rowspan="1" colspan="1">35566</td><td align="left" rowspan="1" colspan="1">14</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">4624</td></tr><tr><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">3746</td><td align="left" rowspan="1" colspan="1">35975</td><td align="left" rowspan="1" colspan="1">49</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">4556</td></tr><tr><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">62035</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">14933</td></tr><tr><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">3554</td><td align="left" rowspan="1" colspan="1">62632</td><td align="left" rowspan="1" colspan="1">12</td><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1">14773</td></tr><tr><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">3741</td><td align="left" rowspan="1" colspan="1">63053</td><td align="left" rowspan="1" colspan="1">40</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">14392</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt102"><label/><p>FPR (FNR) is the ratio between the number of FP (FN) in the accessibility matrices and the number of edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e596.jpg"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="pone.0103812.e597.jpg"/></inline-formula> of any two digraphs <inline-formula><inline-graphic xlink:href="pone.0103812.e598.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e599.jpg"/></inline-formula> denote the number of edges in the set <inline-formula><inline-graphic xlink:href="pone.0103812.e600.jpg"/></inline-formula>.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3b2"><title><italic>S. cerevisiae</italic> GRN</title><p>For yeast GRN, we generated erroneous <inline-formula><inline-graphic xlink:href="pone.0103812.e601.jpg"/></inline-formula> and the 100 most informative <inline-formula><inline-graphic xlink:href="pone.0103812.e602.jpg"/></inline-formula>'s. The results of TRaCE with error correction using these accessibility matrices are summarized in <xref ref-type="table" rid="pone-0103812-t004">Table 4</xref>. The performance of TRaCE here was notably better than the inference of <italic>E. coli</italic> GRN. In all cases, TRaCE could rectify almost all erroneous edges. However, the correction came at a price of high uncertainty, where the difference between the lower and upper bounds exceeded 20 times the number of edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e603.jpg"/></inline-formula>. Despite such high uncertainty, the gap between the bounds represented only 1.3% of the total possible edges.</p><table-wrap id="pone-0103812-t004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.t004</object-id><label>Table 4</label><caption><title>Ensemble inference of <italic>S. cerevisiae</italic> GRN.</title></caption><alternatives><graphic id="pone-0103812-t004-4" xlink:href="pone.0103812.t004"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1">FPR</td><td align="left" rowspan="1" colspan="1">FNR</td><td colspan="2" align="left" rowspan="1">Before Correction</td><td colspan="3" align="left" rowspan="1">After Correction</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e604.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e605.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e606.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e607.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e608.jpg"/></inline-formula></td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">131595</td></tr><tr><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">4048</td><td align="left" rowspan="1" colspan="1">604</td><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">131879</td></tr><tr><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">6934</td><td align="left" rowspan="1" colspan="1">788</td><td align="left" rowspan="1" colspan="1">19</td><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1">132155</td></tr><tr><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">121370</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">198624</td></tr><tr><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">4096</td><td align="left" rowspan="1" colspan="1">121563</td><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">198762</td></tr><tr><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">6879</td><td align="left" rowspan="1" colspan="1">121747</td><td align="left" rowspan="1" colspan="1">16</td><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1">198883</td></tr><tr><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0.00</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">227013</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">260484</td></tr><tr><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">4113</td><td align="left" rowspan="1" colspan="1">227087</td><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">260443</td></tr><tr><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">0.20</td><td align="left" rowspan="1" colspan="1">6909</td><td align="left" rowspan="1" colspan="1">227150</td><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">260313</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt103"><label/><p>Let <inline-formula><inline-graphic xlink:href="pone.0103812.e609.jpg"/></inline-formula> of any two digraphs <inline-formula><inline-graphic xlink:href="pone.0103812.e610.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e611.jpg"/></inline-formula> denote the number of edges in the set <inline-formula><inline-graphic xlink:href="pone.0103812.e612.jpg"/></inline-formula>.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s3c"><title>Ensemble inference from expression data</title><p>We further evaluated the performance of TRaCE using <italic>in silico</italic> noisy gene expression data generated using GeneNetWeaver <xref rid="pone.0103812-Schaffter1" ref-type="bibr">[24]</xref>. We simulated steady-state gene expression data using the same settings as those in DREAM4 100-gene <italic>in silico</italic> network inference subchallenge. The simulated data are available at <ext-link ext-link-type="uri" xlink:href="http://www.cabsel.ethz.ch/tools/trace">http://www.cabsel.ethz.ch/tools/trace</ext-link> or upon request. In the following case studies, we analyzed and converted the data into accessibility matrices following the procedure described in the Numerical Implementation section. Subsequently, we used the resulting accessibility matrices with TRaCE to produce the ensemble lower and upper bounds. For the purpose of comparison with existing network inference methods, we also ranked the gene regulatory interactions according to their confidence scores. In particular, we compared the rankings with those from top performing inference methods in DREAM4, namely the downranking method by Pinna et al. <xref rid="pone.0103812-Pinna2" ref-type="bibr">[27]</xref>, GENIE3 <xref rid="pone.0103812-HuynhThu1" ref-type="bibr">[28]</xref> and TIGRESS <xref rid="pone.0103812-Haury1" ref-type="bibr">[29]</xref>. As mentioned earlier, the downranking method follows a two-phase procedure in ranking edges similar to our implementation, but the method only down-ranks feed-forward edges. On the other hand, GENIE3 uses a machine learning strategy called random forest, and TIGRESS is a regression-based method. For each method, we calculated the area under receiver operating characteristics (AUROC) and precision-recall (AUPR) using a redefined confusion matrix, in which methods were not penalized for any error within the set of non-inferable edges. We define non-inferable edges as edges belonging to the upper bound that are missing from the lower bound (i.e. all edges in the set <inline-formula><inline-graphic xlink:href="pone.0103812.e613.jpg"/></inline-formula>), which are determined from error-free accessibility matrices of the gold standard GRNs. More details of the calculation of the AUROC and AUPR can be found in a recent publication <xref rid="pone.0103812-Siegenthaler1" ref-type="bibr">[30]</xref>.</p><sec id="s3c1"><title>DREAM4 <italic>in silico</italic> network inference 100-gene subchallenge</title><p>We first simulated 5 replicates of steady state gene expression data associated with the complete single-gene KO experiments. We then used the data to construct the accessibility matrices of the gold standard GRNs. In this case, the upper bound of the ensemble was simply given by the accessibility matrix, and the lower bound was the ConTREx of the upper bound. <xref ref-type="table" rid="pone-0103812-t005">Table 5</xref> shows the FPR and FNR in the accessibility matrices, the errors in the lower and upper bounds (<inline-formula><inline-graphic xlink:href="pone.0103812.e614.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e615.jpg"/></inline-formula>), and the size of the ensemble (<inline-formula><inline-graphic xlink:href="pone.0103812.e616.jpg"/></inline-formula>) constructed using TRaCE. We noted that the majority (90%) of FN errors in the accessibility matrices were associated with fan-in motifs, in which a gene was regulated by several genes. In such a case, the effect of knocking-out one of the regulator genes could be compensated by the others and thus, the KO experiment did not show any significant differential expression of the downstream genes. As FNs affected the accessibility matrices, the errors in the upper bound <inline-formula><inline-graphic xlink:href="pone.0103812.e617.jpg"/></inline-formula> were higher than those in the lower bound <inline-formula><inline-graphic xlink:href="pone.0103812.e618.jpg"/></inline-formula>.</p><table-wrap id="pone-0103812-t005" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.t005</object-id><label>Table 5</label><caption><title>Ensemble inference of DREAM4 100-gene gold standard networks: single-gene KO dataset.</title></caption><alternatives><graphic id="pone-0103812-t005-5" xlink:href="pone.0103812.t005"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1">Network</td><td align="left" rowspan="1" colspan="1">FPR</td><td align="left" rowspan="1" colspan="1">FNR</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e619.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e620.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e621.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e622.jpg"/></inline-formula></td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">2.28</td><td align="left" rowspan="1" colspan="1">176</td><td align="left" rowspan="1" colspan="1">44</td><td align="left" rowspan="1" colspan="1">9</td><td align="left" rowspan="1" colspan="1">136</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">1.96</td><td align="left" rowspan="1" colspan="1">249</td><td align="left" rowspan="1" colspan="1">122</td><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1">123</td></tr><tr><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">11.04</td><td align="left" rowspan="1" colspan="1">195</td><td align="left" rowspan="1" colspan="1">86</td><td align="left" rowspan="1" colspan="1">21</td><td align="left" rowspan="1" colspan="1">144</td></tr><tr><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">9.69</td><td align="left" rowspan="1" colspan="1">211</td><td align="left" rowspan="1" colspan="1">91</td><td align="left" rowspan="1" colspan="1">7</td><td align="left" rowspan="1" colspan="1">208</td></tr><tr><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">3.47</td><td align="left" rowspan="1" colspan="1">193</td><td align="left" rowspan="1" colspan="1">108</td><td align="left" rowspan="1" colspan="1">12</td><td align="left" rowspan="1" colspan="1">237</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt104"><label/><p>FPR (FNR) is the ratio between the number of FP (FN) in the accessibility matrices and the number of edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e623.jpg"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="pone.0103812.e624.jpg"/></inline-formula> denote the number of edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e625.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0103812.e626.jpg"/></inline-formula> of any two digraphs <inline-formula><inline-graphic xlink:href="pone.0103812.e627.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e628.jpg"/></inline-formula> denote the number of edges in the set <inline-formula><inline-graphic xlink:href="pone.0103812.e629.jpg"/></inline-formula>.</p></fn></table-wrap-foot></table-wrap><p>Subsequently, we created a ranked list of gene regulatory predictions and compared the list against those produced by the downranking method, GENIE3 and TIGRESS. <xref ref-type="fig" rid="pone-0103812-g009">Fig. 9</xref> provides the comparison of AUROC and AUPR of the four methods. The comparison showed that TRaCE and the downranking method outperformed GENIE3 and TIGRESS, especially considering the AUPR values. Here, TRaCE performed as well as the downranking method, which was the best overall performer in DREAM 4 100-gene network inference subchallenge <xref rid="pone.0103812-Pinna2" ref-type="bibr">[27]</xref>.</p><fig id="pone-0103812-g009" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.g009</object-id><label>Figure 9</label><caption><title>Comparison of TRaCE and top performing methods in DREAM4 100-gene network inference subchallenge: single-gene KO dataset.</title><p>The error bars represent the standard deviations. Based on the AUROC values, TRaCE performed as well as the downranking method (<inline-formula><inline-graphic xlink:href="pone.0103812.e630.jpg"/></inline-formula>) and GENIE3 (<inline-formula><inline-graphic xlink:href="pone.0103812.e631.jpg"/></inline-formula>), but better than TIGRESS (<inline-formula><inline-graphic xlink:href="pone.0103812.e632.jpg"/></inline-formula>). Based on the AUPR values, TRaCE performed as well as the downranking method (<inline-formula><inline-graphic xlink:href="pone.0103812.e633.jpg"/></inline-formula>), but better than GENIE3 (<inline-formula><inline-graphic xlink:href="pone.0103812.e634.jpg"/></inline-formula>) and TIGRESS (<inline-formula><inline-graphic xlink:href="pone.0103812.e635.jpg"/></inline-formula>). The statistical significance was evaluated using two sample t-test.</p></caption><graphic xlink:href="pone.0103812.g009"/></fig></sec><sec id="s3c2"><title>Ensemble inference from single- and double-gene Kos</title><p>We further simulated 5 replicates of steady state gene expression data for the complete set of single- and double-gene KO experiments using the gold standard GRNs of DREAM4 100-gene subchallenge. We processed the data to obtain the accessibility matrices of <inline-formula><inline-graphic xlink:href="pone.0103812.e636.jpg"/></inline-formula> and all <inline-formula><inline-graphic xlink:href="pone.0103812.e637.jpg"/></inline-formula>'s. We subsequently applied TRaCE with error correction to the accessibility matrices to obtain the ensemble lower and upper bounds, which are summarized in <xref ref-type="table" rid="pone-0103812-t006">Table 6</xref>. The average FPR and FNR were similar to the single-gene KO data since both datasets had the same number of replicates. Again, the majority (80%) of errors in the accessibility matrices were associated with fan-in motifs. By comparing <xref ref-type="table" rid="pone-0103812-t005">Tables 5</xref> and <xref ref-type="table" rid="pone-0103812-t006">6</xref>, the errors in the lower bounds improved slightly in comparison with those from only single-gene KO dataset (compare <inline-formula><inline-graphic xlink:href="pone.0103812.e638.jpg"/></inline-formula> values). However, the errors in the upper bounds increased due to the accumulation of FN errors from fan-in motifs (compare <inline-formula><inline-graphic xlink:href="pone.0103812.e639.jpg"/></inline-formula> values). Nevertheless, the additional data from double-gene KO experiments led to lower network uncertainties (compare <inline-formula><inline-graphic xlink:href="pone.0103812.e640.jpg"/></inline-formula> values).</p><table-wrap id="pone-0103812-t006" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.t006</object-id><label>Table 6</label><caption><title>Ensemble inference of DREAM4 100-gene gold standard networks: single- and double-gene KO dataset.</title></caption><alternatives><graphic id="pone-0103812-t006-6" xlink:href="pone.0103812.t006"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1">Network</td><td align="left" rowspan="1" colspan="1">FPR</td><td align="left" rowspan="1" colspan="1">FNR</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e641.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e642.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e643.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e644.jpg"/></inline-formula></td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">0.02</td><td align="left" rowspan="1" colspan="1">2.21</td><td align="left" rowspan="1" colspan="1">176</td><td align="left" rowspan="1" colspan="1">50</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">27</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">0.01</td><td align="left" rowspan="1" colspan="1">1.91</td><td align="left" rowspan="1" colspan="1">249</td><td align="left" rowspan="1" colspan="1">137</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">37</td></tr><tr><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">10.43</td><td align="left" rowspan="1" colspan="1">195</td><td align="left" rowspan="1" colspan="1">103</td><td align="left" rowspan="1" colspan="1">15</td><td align="left" rowspan="1" colspan="1">30</td></tr><tr><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">9.31</td><td align="left" rowspan="1" colspan="1">211</td><td align="left" rowspan="1" colspan="1">118</td><td align="left" rowspan="1" colspan="1">8</td><td align="left" rowspan="1" colspan="1">35</td></tr><tr><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">0.01</td><td align="left" rowspan="1" colspan="1">3.40</td><td align="left" rowspan="1" colspan="1">193</td><td align="left" rowspan="1" colspan="1">131</td><td align="left" rowspan="1" colspan="1">12</td><td align="left" rowspan="1" colspan="1">21</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt105"><label/><p>FPR (FNR) is the average ratio between the number of FP (FN) in the accessibility matrices and the number of edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e645.jpg"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="pone.0103812.e646.jpg"/></inline-formula> denote the number of edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e647.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0103812.e648.jpg"/></inline-formula> of any two digraphs <inline-formula><inline-graphic xlink:href="pone.0103812.e649.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e650.jpg"/></inline-formula> denote the number of edges in the set <inline-formula><inline-graphic xlink:href="pone.0103812.e651.jpg"/></inline-formula>.</p></fn></table-wrap-foot></table-wrap><p>For each gold standard GRN, we also generated a ranked list of edges based on the confidence scores and compared the list with those using GENIE3 and TIGRESS. The downranking method could not be applied to double-gene KO data and was left out from the comparison. The AUROC and AUPR of the three methods are compared in <xref ref-type="fig" rid="pone-0103812-g010">Fig. 10</xref>. The AUPR of TRaCE was higher than GENIE3 and TIGRESS. Meanwhile, the AUROC values were generally high for all three methods, with TIGRESS having the lowest value. In comparison to single-gene KO data, the inclusion of double-gene KO data led to no change in the average AUROC (<inline-formula><inline-graphic xlink:href="pone.0103812.e652.jpg"/></inline-formula>, two sample t-test) and an increase in AUPR (<inline-formula><inline-graphic xlink:href="pone.0103812.e653.jpg"/></inline-formula>, two sample t-test). Finally, as shown in <xref ref-type="table" rid="pone-0103812-t007">Tables 7</xref> and <xref ref-type="table" rid="pone-0103812-t008">8</xref>, the AUROC and AUPR values of TRaCE were insensitive to <inline-formula><inline-graphic xlink:href="pone.0103812.e654.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e655.jpg"/></inline-formula> used in the construction of the accessibility matrices, and the threshold value in the preprocessing of <inline-formula><inline-graphic xlink:href="pone.0103812.e656.jpg"/></inline-formula>. Because of the trade-off between FPs and FNs when using different <inline-formula><inline-graphic xlink:href="pone.0103812.e657.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e658.jpg"/></inline-formula>, the maximum of AUROC and AUPR corresponded to intermediate values within the selected ranges of <inline-formula><inline-graphic xlink:href="pone.0103812.e659.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e660.jpg"/></inline-formula>.</p><fig id="pone-0103812-g010" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.g010</object-id><label>Figure 10</label><caption><title>Comparison of TRaCE and top performing methods in DREAM4 100-gene network inference subchallenge: single- and double-gene KO dataset.</title><p>The error bars represent the standard deviations. Based on the AUROC values, TRaCE performed as well as GENIE3 (<inline-formula><inline-graphic xlink:href="pone.0103812.e661.jpg"/></inline-formula>) and better than TIGRESS (<inline-formula><inline-graphic xlink:href="pone.0103812.e662.jpg"/></inline-formula>). Similarly, based on the AUPR values, TRaCE performed better than GENIE3 (<inline-formula><inline-graphic xlink:href="pone.0103812.e663.jpg"/></inline-formula>) and TIGRESS (<inline-formula><inline-graphic xlink:href="pone.0103812.e664.jpg"/></inline-formula>). The statistical significance was evaluated using two sample t-test.</p></caption><graphic xlink:href="pone.0103812.g010"/></fig><table-wrap id="pone-0103812-t007" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.t007</object-id><label>Table 7</label><caption><title>Effects of <inline-formula><inline-graphic xlink:href="pone.0103812.e665.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e666.jpg"/></inline-formula> on AUROC and AUPR of TRaCE in DREAM4 100-gene subchallenge: single gene KO data.</title></caption><alternatives><graphic id="pone-0103812-t007-7" xlink:href="pone.0103812.t007"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e667.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e668.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1">AUROC</td><td align="left" rowspan="1" colspan="1">AUPR</td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">1.5</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">0.871<inline-formula><inline-graphic xlink:href="pone.0103812.e669.jpg"/></inline-formula>0.0616</td><td align="left" rowspan="1" colspan="1">0.3085<inline-formula><inline-graphic xlink:href="pone.0103812.e670.jpg"/></inline-formula>0.1416</td></tr><tr><td align="left" rowspan="1" colspan="1">1.5</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">0.8723<inline-formula><inline-graphic xlink:href="pone.0103812.e671.jpg"/></inline-formula>0.0673</td><td align="left" rowspan="1" colspan="1">0.3209<inline-formula><inline-graphic xlink:href="pone.0103812.e672.jpg"/></inline-formula>0.1534</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">0.8756<inline-formula><inline-graphic xlink:href="pone.0103812.e673.jpg"/></inline-formula>0.0595</td><td align="left" rowspan="1" colspan="1">0.2922<inline-formula><inline-graphic xlink:href="pone.0103812.e674.jpg"/></inline-formula>0.154</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1"><bold>0.8758</bold><inline-formula><inline-graphic xlink:href="pone.0103812.e675.jpg"/></inline-formula><bold>0.0642</bold></td><td align="left" rowspan="1" colspan="1"><bold>0.2889</bold><inline-formula><inline-graphic xlink:href="pone.0103812.e676.jpg"/></inline-formula><bold>0.1596</bold></td></tr><tr><td align="left" rowspan="1" colspan="1">2.5</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">0.8758<inline-formula><inline-graphic xlink:href="pone.0103812.e677.jpg"/></inline-formula>0.0642</td><td align="left" rowspan="1" colspan="1">0.2438<inline-formula><inline-graphic xlink:href="pone.0103812.e678.jpg"/></inline-formula>0.1545</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt106"><label/><p>The AUROC and AUPR values are the average <inline-formula><inline-graphic xlink:href="pone.0103812.e679.jpg"/></inline-formula> standard devation over 5 gold standard networks. The values used in the comparison with existing methods are highlighted in bold.</p></fn></table-wrap-foot></table-wrap><table-wrap id="pone-0103812-t008" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.t008</object-id><label>Table 8</label><caption><title>Effects of <inline-formula><inline-graphic xlink:href="pone.0103812.e680.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0103812.e681.jpg"/></inline-formula> and the preprocessing threshold of <inline-formula><inline-graphic xlink:href="pone.0103812.e682.jpg"/></inline-formula> on AUROC and AUPR of TRaCE in DREAM4 100-gene subchallenge: single- and double-gene KO data.</title></caption><alternatives><graphic id="pone-0103812-t008-8" xlink:href="pone.0103812.t008"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e683.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e684.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e685.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1">AUROC</td><td align="left" rowspan="1" colspan="1">AUPR</td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">1.5</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">0.5</td><td align="left" rowspan="1" colspan="1">0.8723<inline-formula><inline-graphic xlink:href="pone.0103812.e686.jpg"/></inline-formula>0.0595</td><td align="left" rowspan="1" colspan="1">0.4327<inline-formula><inline-graphic xlink:href="pone.0103812.e687.jpg"/></inline-formula>0.1931</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">0.65</td><td align="left" rowspan="1" colspan="1">0.8718<inline-formula><inline-graphic xlink:href="pone.0103812.e688.jpg"/></inline-formula>0.0588</td><td align="left" rowspan="1" colspan="1">0.4197<inline-formula><inline-graphic xlink:href="pone.0103812.e689.jpg"/></inline-formula>0.1959</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">0.8</td><td align="left" rowspan="1" colspan="1">0.8724<inline-formula><inline-graphic xlink:href="pone.0103812.e690.jpg"/></inline-formula>0.0600</td><td align="left" rowspan="1" colspan="1">0.4184<inline-formula><inline-graphic xlink:href="pone.0103812.e691.jpg"/></inline-formula>0.2022</td></tr><tr><td align="left" rowspan="1" colspan="1">1.5</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">0.5</td><td align="left" rowspan="1" colspan="1">0.8728<inline-formula><inline-graphic xlink:href="pone.0103812.e692.jpg"/></inline-formula>0.0596</td><td align="left" rowspan="1" colspan="1">0.4204<inline-formula><inline-graphic xlink:href="pone.0103812.e693.jpg"/></inline-formula>0.1986</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">0.65</td><td align="left" rowspan="1" colspan="1">0.8733<inline-formula><inline-graphic xlink:href="pone.0103812.e694.jpg"/></inline-formula>0.0610</td><td align="left" rowspan="1" colspan="1">0.4212<inline-formula><inline-graphic xlink:href="pone.0103812.e695.jpg"/></inline-formula>0.2059</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">0.8</td><td align="left" rowspan="1" colspan="1">0.8735<inline-formula><inline-graphic xlink:href="pone.0103812.e696.jpg"/></inline-formula>0.0617</td><td align="left" rowspan="1" colspan="1">0.4201<inline-formula><inline-graphic xlink:href="pone.0103812.e697.jpg"/></inline-formula>0.2100</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">0.5</td><td align="left" rowspan="1" colspan="1">0.8726<inline-formula><inline-graphic xlink:href="pone.0103812.e698.jpg"/></inline-formula>0.0603</td><td align="left" rowspan="1" colspan="1">0.4177<inline-formula><inline-graphic xlink:href="pone.0103812.e699.jpg"/></inline-formula>0.2158</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">0.65</td><td align="left" rowspan="1" colspan="1">0.8727<inline-formula><inline-graphic xlink:href="pone.0103812.e700.jpg"/></inline-formula>0.0607</td><td align="left" rowspan="1" colspan="1">0.4167<inline-formula><inline-graphic xlink:href="pone.0103812.e701.jpg"/></inline-formula>0.2170</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">0.8</td><td align="left" rowspan="1" colspan="1">0.8728<inline-formula><inline-graphic xlink:href="pone.0103812.e702.jpg"/></inline-formula>0.0608</td><td align="left" rowspan="1" colspan="1">0.4091<inline-formula><inline-graphic xlink:href="pone.0103812.e703.jpg"/></inline-formula>0.2139</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">0.5</td><td align="left" rowspan="1" colspan="1">0.8735<inline-formula><inline-graphic xlink:href="pone.0103812.e704.jpg"/></inline-formula>0.0618</td><td align="left" rowspan="1" colspan="1">0.4170<inline-formula><inline-graphic xlink:href="pone.0103812.e705.jpg"/></inline-formula>0.2160</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">0.65</td><td align="left" rowspan="1" colspan="1"><bold>0.8734</bold><inline-formula><inline-graphic xlink:href="pone.0103812.e706.jpg"/></inline-formula><bold>0.0620</bold></td><td align="left" rowspan="1" colspan="1"><bold>0.4086</bold><inline-formula><inline-graphic xlink:href="pone.0103812.e707.jpg"/></inline-formula><bold>0.2149</bold></td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">0.8</td><td align="left" rowspan="1" colspan="1">0.8698<inline-formula><inline-graphic xlink:href="pone.0103812.e708.jpg"/></inline-formula>0.0604</td><td align="left" rowspan="1" colspan="1">0.4045<inline-formula><inline-graphic xlink:href="pone.0103812.e709.jpg"/></inline-formula>0.2108</td></tr><tr><td align="left" rowspan="1" colspan="1">2.5</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">0.5</td><td align="left" rowspan="1" colspan="1">0.8695<inline-formula><inline-graphic xlink:href="pone.0103812.e710.jpg"/></inline-formula>0.0599</td><td align="left" rowspan="1" colspan="1">0.3893<inline-formula><inline-graphic xlink:href="pone.0103812.e711.jpg"/></inline-formula>0.2054</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">0.65</td><td align="left" rowspan="1" colspan="1">0.8696<inline-formula><inline-graphic xlink:href="pone.0103812.e712.jpg"/></inline-formula>0.0598</td><td align="left" rowspan="1" colspan="1">0.3837<inline-formula><inline-graphic xlink:href="pone.0103812.e713.jpg"/></inline-formula>0.1975</td></tr><tr><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1"/><td align="left" rowspan="1" colspan="1">0.8</td><td align="left" rowspan="1" colspan="1">0.8695<inline-formula><inline-graphic xlink:href="pone.0103812.e714.jpg"/></inline-formula>0.0600</td><td align="left" rowspan="1" colspan="1">0.3764<inline-formula><inline-graphic xlink:href="pone.0103812.e715.jpg"/></inline-formula>0.2023</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt107"><label/><p>The AUROC and AUPR values are the average <inline-formula><inline-graphic xlink:href="pone.0103812.e716.jpg"/></inline-formula> standard devation over 5 gold standard GRNs. The values used in the comparison with existing methods are highlighted in bold.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3c3"><title><italic>E. coli</italic> and Yeast GRNs</title><p>Finally, we simulated the complete set of single-gene KO experiments for <italic>E. coli</italic> and yeast. For each organism, we generated 10 replicates of steady state gene expression data. We performed differential expression analysis using the Z-score transformation and obtained the accessibility matrices using either 5 or 10 replicates. We then applied TRaCE with error correction to construct the ensemble lower and upper bounds, and created ranked lists of edges as done earlier. The errors in the accessibility matrices and in the bounds are reported in <xref ref-type="table" rid="pone-0103812-t009">Table 9</xref>, along with the AUROC and AUPR values. Here, FPR in the accessibility matrices decreased with increasing number of replicates, but FNR did not change with the number of replicates. The errors in the upper bounds changed little with increasing technical replicates from 5 to 10, but those in the lower bounds dropped considerably. The sizes of the ensemble also decreased with increasing replicates. Finally, the AUPR values improved slightly with higher replicates, while the AUROC values were insensitive with respect to the number of replicates.</p><table-wrap id="pone-0103812-t009" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0103812.t009</object-id><label>Table 9</label><caption><title>Ensemble inference of <italic>E. coli</italic> and Yeast GRNs from single-gene KO data.</title></caption><alternatives><graphic id="pone-0103812-t009-9" xlink:href="pone.0103812.t009"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" rowspan="1" colspan="1">Network</td><td align="left" rowspan="1" colspan="1">Replicates</td><td align="left" rowspan="1" colspan="1">FPR</td><td align="left" rowspan="1" colspan="1">FNR</td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e717.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e718.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0103812.e719.jpg"/></inline-formula></td><td align="left" rowspan="1" colspan="1">AUROC</td><td align="left" rowspan="1" colspan="1">AUPR</td></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1"><italic>E. coli</italic></td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">0.117</td><td align="left" rowspan="1" colspan="1">2.61</td><td align="left" rowspan="1" colspan="1">1611</td><td align="left" rowspan="1" colspan="1">687</td><td align="left" rowspan="1" colspan="1">1724</td><td align="left" rowspan="1" colspan="1">0.8601</td><td align="left" rowspan="1" colspan="1">0.4836</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>E. coli</italic></td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">0.005</td><td align="left" rowspan="1" colspan="1">2.61</td><td align="left" rowspan="1" colspan="1">1612</td><td align="left" rowspan="1" colspan="1">297</td><td align="left" rowspan="1" colspan="1">1673</td><td align="left" rowspan="1" colspan="1">0.8639</td><td align="left" rowspan="1" colspan="1">0.5192</td></tr><tr><td align="left" rowspan="1" colspan="1">Yeast</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">0.582</td><td align="left" rowspan="1" colspan="1">24.97</td><td align="left" rowspan="1" colspan="1">8101</td><td align="left" rowspan="1" colspan="1">9159</td><td align="left" rowspan="1" colspan="1">7907</td><td align="left" rowspan="1" colspan="1">0.7699</td><td align="left" rowspan="1" colspan="1">0.2464</td></tr><tr><td align="left" rowspan="1" colspan="1">Yeast</td><td align="left" rowspan="1" colspan="1">10</td><td align="left" rowspan="1" colspan="1">0.141</td><td align="left" rowspan="1" colspan="1">24.98</td><td align="left" rowspan="1" colspan="1">8098</td><td align="left" rowspan="1" colspan="1">3753</td><td align="left" rowspan="1" colspan="1">7200</td><td align="left" rowspan="1" colspan="1">0.7569</td><td align="left" rowspan="1" colspan="1">0.2768</td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt108"><label/><p>FPR (FNR) is the ratio between the number of FP (FN) in the accessibility matrices and the number of edges in <inline-formula><inline-graphic xlink:href="pone.0103812.e720.jpg"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="pone.0103812.e721.jpg"/></inline-formula> of any two digraphs <inline-formula><inline-graphic xlink:href="pone.0103812.e722.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e723.jpg"/></inline-formula> denote the number of edges in the set <inline-formula><inline-graphic xlink:href="pone.0103812.e724.jpg"/></inline-formula>.</p></fn></table-wrap-foot></table-wrap></sec></sec></sec><sec id="s4"><title>Discussion</title><p>The inference of GRNs from data of gene perturbation experiments is an important but unsolved problem. The difficulty stems from the underdetermined nature of such an inference <xref rid="pone.0103812-Smet1" ref-type="bibr">[7]</xref>, <xref rid="pone.0103812-Marbach1" ref-type="bibr">[9]</xref>, as the data do not contain the necessary information to establish the complete causal interactions among the genes. Consequently, there exist many indistinguishable solutions. We have developed TRaCE with this consequence in mind by employing an ensemble inference strategy. Specifically, we have taken into consideration the fundamental limitation in using steady-state expression data of gene KO experiments for establishing direct causal relationships among genes. In TRaCE, we first transform the expression data into accessibility relationships (matrices) among genes. The novel contribution of TRaCE is an algorithm for the construction of lower and upper bounds of network ensemble, where each member of the ensemble satisfies the accessibility matrices. Edges of the upper bound that do not appear in the lower bound are considered non-inferable, as the existence of such edges can not be verified. Here, the size of the ensemble provides a metric of uncertainty in the network inference problem, with which the GRN inferability can be rigorously assessed. The GRN is inferable when the lower and upper bounds coincide (i.e. the ensemble only contains one network). Thus, in TRaCE, the inference and inferability analysis are accomplished simultaneously.</p><p>In the case studies, we have demonstrated the use of TRaCE for analyzing the inferability of GRNs. With the exception of networks of low order and small size, the majority of the GRNs were not inferable even when using error-free accessibility matrices. As we have used sparse networks in the case studies, the lower bound of the ensemble was a better estimate of the GRN than the upper bound. Finally, the majority of double-gene KO experiments were non-informative as the reduction in the size of the ensemble diminished after only a small number of <inline-formula><inline-graphic xlink:href="pone.0103812.e725.jpg"/></inline-formula>'s. The observation above suggests that experimental design contributes significantly to the underdetermined nature of the typical GRN inference. In this regard, the lower and upper bounds of the ensemble could be used for optimizing the gene perturbation experiments, for example by finding the KO experiment that provides the maximum reduction in the difference between the lower and upper bounds. A strategy for optimal design of experiments using ensemble inference will be presented in a future publication.</p><p>We have also used the ensemble lower and upper bounds in conjunction with the z-scores to produce a ranked list of gene regulatory predictions. In comparison with the top methods of DREAM4 network inference challenge, TRaCE could match the performance of the downranking method, the best overall performer in the 100-gene subchallenge. For single-gene KO dataset, TRaCE and the downranking method differed only for edges that were involved in cycles of more than 2 nodes. However, the two methods were fundamentally different, as TRaCE was developed for ensemble inference. Furthermore, the downranking method was created for single-gene KO experiments. Meanwhile, TRaCE significantly outperformed GENIE3 and TIGRESS when using single- and double-gene KO data. We note that GENIE3 and TIGRESS were also among the best performers in DREAM5 network inference challenge <xref rid="pone.0103812-Marbach2" ref-type="bibr">[10]</xref>.</p><p>As expected, data noise negatively influenced the GRN inference and increased the uncertainty in the GRN inference. In the case studies, random errors in the accessibility matrices expectedly led to a larger ensemble. While the error correction in TRaCE was able to eliminate the majority of errors, some of the errors remained in the bounds. In particular, FN errors were harder to correct than FPs. The reason was that more Type A errors originating from FNs passed through the correction than those originating from FPs (see <xref ref-type="supplementary-material" rid="pone.0103812.s003">Fig. S3</xref> and <xref ref-type="supplementary-material" rid="pone.0103812.s010">text S4</xref>). Meanwhile, FP errors could cancel out some Type A errors associated with FNs at the cost of increased uncertainty (see <xref ref-type="supplementary-material" rid="pone.0103812.s004">Fig. S4</xref> and <xref ref-type="supplementary-material" rid="pone.0103812.s010">text S4</xref>).</p><p>The application of TRaCE to simulated noisy gene expression data indicated that the majority of errors in the accessibility matrices were due to FNs associated with fan-in motifs in the GRN. In such motifs, the effects of knocking-out one regulator gene could be compensated by other regulator(s), and differential expression analysis could only reveal the dominant regulator(s) of a gene. Note that such a problem could not be improved by increasing technical replicates (see <xref ref-type="table" rid="pone-0103812-t009">Table 9</xref>). Meanwhile, errors associated with fan-in motifs usually lead to type A errors where the affected edges are absent from the lower and upper bounds. However, if the available experiments permit the construction of <inline-formula><inline-graphic xlink:href="pone.0103812.e726.jpg"/></inline-formula> in which <inline-formula><inline-graphic xlink:href="pone.0103812.e727.jpg"/></inline-formula> includes the dominant regulator(s) of a fan-in motif, then the related missing edge(s) may appear in <inline-formula><inline-graphic xlink:href="pone.0103812.e728.jpg"/></inline-formula>, leading to a detectable and correctable type C error. We expect the issue above would improve when using more sensitive measurements of gene expression, for example RNAseq.</p></sec><sec id="s5"><title>Conclusion</title><p>Inferring gene regulatory networks from DNA microarray data is an unsolved problem. Community-wide assessments of inference methods have shown that distinguishing direct and indirect regulatory interactions among genes is a common Achilles' heel of existing algorithms. In this study, we have adopted an ensemble inference strategy and develop new framework and algorithms for the creation of an ensemble of networks. Here, the ensemble represents the uncertainty associated with differentiating direct and indirect regulations using steady-state gene expression data of gene KO experiments. In particular, TRaCE produces the lower and upper bound of the ensemble. Using the bounds of the ensemble, a ranked list of gene regulatory predictions can also be generated. The case studies demonstrate that except for networks with few edges, most GRNs can not be fully inferred even when error-free data from complete single- and double-gene knock out experiments are available. In comparison with top performing methods of DREAM4 <italic>in silico</italic> network inference challenge, TRaCE performed equally well with the downranking method, the best overall performer in the challenge. However, the downranking method is not designed to handle data from multi-gene KO experiments. Meanwhile, TRaCE outperformed GENIE3 and TIGRESS when using single- and double-gene KO data. Nevertheless, the uncertainty in GRN inference is still significant, and systematic KOs of genes are often suboptimal as only a small fraction of the experiments are informative. We therefore hope that the shift of paradigm to ensemble inference will trigger further developments of methodologies for inferring and analyzing GRNs, in which network inference uncertainty is explicitly taken into consideration.</p></sec><sec sec-type="supplementary-material" id="s6"><title>Supporting Information</title><supplementary-material content-type="local-data" id="pone.0103812.s001"><label>Figure S1</label><caption><p><bold>An example of ConTREx of a simple GRN.</bold> The directed edges indicated by blue arrows in <inline-formula><inline-graphic xlink:href="pone.0103812.e729.jpg"/></inline-formula> are in the set of indirect regulations. The edges between A and B are retained, because the cycle contains only two nodes. If the cycle had contained more than two nodes, all edges among the nodes would have been removed.</p><p>(TIFF)</p></caption><media xlink:href="pone.0103812.s001.tiff"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0103812.s002"><label>Figure S2</label><caption><p><bold>Example of an ensemble involving GRN with cycle.</bold> Consider a GRN consisting of genes A, B and C, all of which are involved in a directed cycle. Further, let us assume that the edge <inline-formula><inline-graphic xlink:href="pone.0103812.e730.jpg"/></inline-formula> belongs to the lower bound and <inline-formula><inline-graphic xlink:href="pone.0103812.e731.jpg"/></inline-formula> is not in the the upper bound. In this case, the ensemble comprises the graphs shown in (a)-(d).</p><p>(TIFF)</p></caption><media xlink:href="pone.0103812.s002.tiff"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0103812.s003"><label>Figure S3</label><caption><p><bold>Type A errors due to an FN.</bold> (a) <inline-formula><inline-graphic xlink:href="pone.0103812.e732.jpg"/></inline-formula>; (b) <inline-formula><inline-graphic xlink:href="pone.0103812.e733.jpg"/></inline-formula>; (c) <inline-formula><inline-graphic xlink:href="pone.0103812.e734.jpg"/></inline-formula>; (d) <inline-formula><inline-graphic xlink:href="pone.0103812.e735.jpg"/></inline-formula>; (e) <inline-formula><inline-graphic xlink:href="pone.0103812.e736.jpg"/></inline-formula> with an FN at <inline-formula><inline-graphic xlink:href="pone.0103812.e737.jpg"/></inline-formula>. In this case, <inline-formula><inline-graphic xlink:href="pone.0103812.e738.jpg"/></inline-formula>. (f) <inline-formula><inline-graphic xlink:href="pone.0103812.e739.jpg"/></inline-formula> with an FN at <inline-formula><inline-graphic xlink:href="pone.0103812.e740.jpg"/></inline-formula> and an FP at <inline-formula><inline-graphic xlink:href="pone.0103812.e741.jpg"/></inline-formula> (g) ConTREx reduction of (f). (h) <inline-formula><inline-graphic xlink:href="pone.0103812.e742.jpg"/></inline-formula> with an FN at <inline-formula><inline-graphic xlink:href="pone.0103812.e743.jpg"/></inline-formula> and an FP at <inline-formula><inline-graphic xlink:href="pone.0103812.e744.jpg"/></inline-formula> (i) ConTREx reduction of (h). See <xref ref-type="supplementary-material" rid="pone.0103812.s010">text S4</xref> for details.</p><p>(TIFF)</p></caption><media xlink:href="pone.0103812.s003.tiff"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0103812.s004"><label>Figure S4</label><caption><p><bold>Type A error due to an FP.</bold>
<inline-formula><inline-graphic xlink:href="pone.0103812.e745.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e746.jpg"/></inline-formula> are shown in <xref ref-type="supplementary-material" rid="pone.0103812.s003">Fig. S3</xref> (a) and (b), respectively. (a) <inline-formula><inline-graphic xlink:href="pone.0103812.e747.jpg"/></inline-formula>. In this case, <inline-formula><inline-graphic xlink:href="pone.0103812.e748.jpg"/></inline-formula>. (b) <inline-formula><inline-graphic xlink:href="pone.0103812.e749.jpg"/></inline-formula>with an FP at <inline-formula><inline-graphic xlink:href="pone.0103812.e750.jpg"/></inline-formula>. Here, <inline-formula><inline-graphic xlink:href="pone.0103812.e751.jpg"/></inline-formula>.</p><p>(TIFF)</p></caption><media xlink:href="pone.0103812.s004.tiff"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0103812.s005"><label>Table S1</label><caption><p><bold>Performance of TRaCE on inference of </bold><bold><italic>E. coli</italic></bold><bold> subnetworks (</bold><inline-formula><inline-graphic xlink:href="pone.0103812.e752.jpg"/></inline-formula><bold> genes).</bold> The reported values represent the average over 50 subnetworks. Let <inline-formula><inline-graphic xlink:href="pone.0103812.e753.jpg"/></inline-formula> of any two digraphs <inline-formula><inline-graphic xlink:href="pone.0103812.e754.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e755.jpg"/></inline-formula> denote the structural Hamming distance (SHD) between them. The SHD is defined as the number of edges which differ or have opposite orientation between two networks <xref rid="pone.0103812-Tsamardinos1" ref-type="bibr">[31]</xref>.</p><p>(PDF)</p></caption><media xlink:href="pone.0103812.s005.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0103812.s006"><label>Table S2</label><caption><p><bold>Performance of TRaCE on inference of </bold><bold><italic>E. coli</italic></bold><bold> GRN.</bold> Let <inline-formula><inline-graphic xlink:href="pone.0103812.e756.jpg"/></inline-formula> of any two digraphs <inline-formula><inline-graphic xlink:href="pone.0103812.e757.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0103812.e758.jpg"/></inline-formula> denote the structural Hamming distance between them.</p><p>(PDF)</p></caption><media xlink:href="pone.0103812.s006.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0103812.s007"><label>Text S1</label><caption><p><bold>Preprocessing of </bold><inline-formula><inline-graphic xlink:href="pone.0103812.e759.jpg"/></inline-formula><bold>.</bold></p><p>(PDF)</p></caption><media xlink:href="pone.0103812.s007.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0103812.s008"><label>Text S2</label><caption><p><bold>Filter Algorithms.</bold></p><p>(PDF)</p></caption><media xlink:href="pone.0103812.s008.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0103812.s009"><label>Text S3</label><caption><p><bold>Consistency check.</bold></p><p>(PDF)</p></caption><media xlink:href="pone.0103812.s009.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0103812.s010"><label>Text S4</label><caption><p><bold>Type A errors due to FN.</bold></p><p>(PDF)</p></caption><media xlink:href="pone.0103812.s010.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ack><p>The authors would like to thank Caroline Siegenthaler, Erica Manesso and Heeju Noh for useful comments.</p></ack><ref-list><title>References</title><ref id="pone.0103812-Apic1"><label>1</label><mixed-citation publication-type="journal"><name><surname>Apic</surname><given-names>G</given-names></name>, <name><surname>Ignjatovic</surname><given-names>T</given-names></name>, <name><surname>Boyer</surname><given-names>S</given-names></name>, <name><surname>Russell</surname><given-names>RB</given-names></name> (<year>2005</year>) <article-title>Illuminating drug discovery with biological pathways</article-title>. <source>FEBS Lett</source><volume>579</volume>: <fpage>1872</fpage>&#x02013;<lpage>1877</lpage><pub-id pub-id-type="pmid">15763566</pub-id></mixed-citation></ref><ref id="pone.0103812-Alper1"><label>2</label><mixed-citation publication-type="journal"><name><surname>Alper</surname><given-names>H</given-names></name>, <name><surname>Stephanopoulos</surname><given-names>G</given-names></name> (<year>2009</year>) <article-title>Engineering for biofuels: exploiting innate microbial capacity or importing biosynthetic potential?</article-title><source>Nat Rev Microbiol</source><volume>7</volume>: <fpage>715</fpage>&#x02013;<lpage>723</lpage><pub-id pub-id-type="pmid">19756010</pub-id></mixed-citation></ref><ref id="pone.0103812-Oberhardt1"><label>3</label><mixed-citation publication-type="journal"><name><surname>Oberhardt</surname><given-names>MA</given-names></name>, <name><surname>Palsson</surname><given-names>B</given-names></name>, <name><surname>Papin</surname><given-names>JA</given-names></name> (<year>2009</year>) <article-title>Applications of genome-scale metabolic reconstructions</article-title>. <source>Mol Syst Biol</source><volume>5</volume>: <fpage>320</fpage><pub-id pub-id-type="pmid">19888215</pub-id></mixed-citation></ref><ref id="pone.0103812-Zhao1"><label>4</label><mixed-citation publication-type="journal"><name><surname>Zhao</surname><given-names>XM</given-names></name>, <name><surname>Iskar</surname><given-names>M</given-names></name>, <name><surname>Zeller</surname><given-names>G</given-names></name>, <name><surname>Kuhn</surname><given-names>M</given-names></name>, <name><surname>van Noort</surname><given-names>V</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Prediction of drug combinations by integrating molecular and pharmacological data</article-title>. <source>PLoS Comput Biol</source><volume>7</volume>: <fpage>e1002323</fpage><pub-id pub-id-type="pmid">22219721</pub-id></mixed-citation></ref><ref id="pone.0103812-Hecker1"><label>5</label><mixed-citation publication-type="journal"><name><surname>Hecker</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>Gene regulatory network inference: data integration in dynamic models&#x02013;a review</article-title>. <source>Biosystems</source><volume>96</volume>: <fpage>86</fpage>&#x02013;<lpage>103</lpage><pub-id pub-id-type="pmid">19150482</pub-id></mixed-citation></ref><ref id="pone.0103812-Margolin1"><label>6</label><mixed-citation publication-type="journal"><name><surname>Margolin</surname><given-names>AA</given-names></name>, <name><surname>Califano</surname><given-names>A</given-names></name> (<year>2007</year>) <article-title>Theory and limitations of genetic network inference from microarray data</article-title>. <source>Ann N Y Acad Sci</source><volume>1115</volume>: <fpage>51</fpage>&#x02013;<lpage>72</lpage><pub-id pub-id-type="pmid">17925348</pub-id></mixed-citation></ref><ref id="pone.0103812-Smet1"><label>7</label><mixed-citation publication-type="journal"><name><surname>Smet</surname><given-names>RD</given-names></name>, <name><surname>Marchal</surname><given-names>K</given-names></name> (<year>2010</year>) <article-title>Advantages and limitations of current network inference methods</article-title>. <source>Nature Reviews Microbiology</source><volume>8</volume>: <fpage>717</fpage>&#x02013;<lpage>729</lpage></mixed-citation></ref><ref id="pone.0103812-Stolovitzky1"><label>8</label><mixed-citation publication-type="journal"><name><surname>Stolovitzky</surname><given-names>G</given-names></name>, <name><surname>Prill</surname><given-names>RJ</given-names></name>, <name><surname>Califano</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>Lessons from the dream2 challenges</article-title>. <source>Ann N Y Acad Sci</source><volume>1158</volume>: <fpage>159</fpage>&#x02013;<lpage>195</lpage><pub-id pub-id-type="pmid">19348640</pub-id></mixed-citation></ref><ref id="pone.0103812-Marbach1"><label>9</label><mixed-citation publication-type="journal"><name><surname>Marbach</surname><given-names>D</given-names></name>, <name><surname>Prill</surname><given-names>RJ</given-names></name>, <name><surname>Schaffter</surname><given-names>T</given-names></name>, <name><surname>Mattiussi</surname><given-names>C</given-names></name>, <name><surname>Floreano</surname><given-names>D</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Revealing strengths and weaknesses of methods for gene network inference</article-title>. <source>Proc Natl Acad Sci USA</source><volume>107</volume>: <fpage>6286</fpage>&#x02013;<lpage>6291</lpage><pub-id pub-id-type="pmid">20308593</pub-id></mixed-citation></ref><ref id="pone.0103812-Marbach2"><label>10</label><mixed-citation publication-type="journal"><name><surname>Marbach</surname><given-names>D</given-names></name>, <name><surname>Costello</surname><given-names>JC</given-names></name>, <name><surname>K&#x000fc;ffner</surname><given-names>R</given-names></name>, <name><surname>Vega</surname><given-names>NM</given-names></name>, <name><surname>Prill</surname><given-names>RJ</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Wisdom of crowds for robust gene network inference</article-title>. <source>Nat Methods</source><volume>9</volume>: <fpage>796</fpage>&#x02013;<lpage>804</lpage><pub-id pub-id-type="pmid">22796662</pub-id></mixed-citation></ref><ref id="pone.0103812-Gadkar1"><label>11</label><mixed-citation publication-type="journal"><name><surname>Gadkar</surname><given-names>KG</given-names></name>, <name><surname>Gunawan</surname><given-names>R</given-names></name>, <name><surname>Doyle</surname><given-names>FJ</given-names><suffix>3rd</suffix></name> (<year>2005</year>) <article-title>Iterative approach to model identification of biological networks</article-title>. <source>BMC Bioinformatics</source><volume>6</volume>: <fpage>155</fpage><pub-id pub-id-type="pmid">15967022</pub-id></mixed-citation></ref><ref id="pone.0103812-Srinath1"><label>12</label><mixed-citation publication-type="journal"><name><surname>Srinath</surname><given-names>S</given-names></name>, <name><surname>Gunawan</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Parameter identifiability of power-law biochemical system models</article-title>. <source>J Biotechnol</source><volume>149</volume>: <fpage>132</fpage>&#x02013;<lpage>140</lpage><pub-id pub-id-type="pmid">20197073</pub-id></mixed-citation></ref><ref id="pone.0103812-Chis1"><label>13</label><mixed-citation publication-type="journal"><name><surname>Chis</surname><given-names>OT</given-names></name>, <name><surname>Banga</surname><given-names>JR</given-names></name>, <name><surname>Balsa-Canto</surname><given-names>E</given-names></name> (<year>2011</year>) <article-title>Structural identifiability of systems biology models: A critical comparison of methods</article-title>. <source>PLoS ONE</source><volume>6</volume>: <fpage>e27755</fpage><pub-id pub-id-type="pmid">22132135</pub-id></mixed-citation></ref><ref id="pone.0103812-Szederknyi1"><label>14</label><mixed-citation publication-type="journal"><name><surname>Szederk&#x000e9;nyi</surname><given-names>G</given-names></name>, <name><surname>Banga</surname><given-names>J</given-names></name>, <name><surname>Alonso</surname><given-names>A</given-names></name> (<year>2011</year>) <article-title>Inference of complex biological networks: distinguishability issues and optimization-based solutions</article-title>. <source>BMC systems biology</source><volume>5</volume>: <fpage>177</fpage><pub-id pub-id-type="pmid">22034917</pub-id></mixed-citation></ref><ref id="pone.0103812-Kuepfer1"><label>15</label><mixed-citation publication-type="journal"><name><surname>Kuepfer</surname><given-names>L</given-names></name>, <name><surname>Peter</surname><given-names>M</given-names></name>, <name><surname>Sauer</surname><given-names>U</given-names></name>, <name><surname>Stelling</surname><given-names>J</given-names></name> (<year>2007</year>) <article-title>Ensemble modeling for analysis of cell signaling dynamics</article-title>. <source>Nat Biotechnol</source><volume>25</volume>: <fpage>1001</fpage>&#x02013;<lpage>1006</lpage><pub-id pub-id-type="pmid">17846631</pub-id></mixed-citation></ref><ref id="pone.0103812-Miskovic1"><label>16</label><mixed-citation publication-type="journal"><name><surname>Miskovic</surname><given-names>L</given-names></name>, <name><surname>Hatzimanikatis</surname><given-names>V</given-names></name> (<year>2011</year>) <article-title>Modeling of uncertainties in biochemical reactions</article-title>. <source>Biotechnol Bioeng</source><volume>108</volume>: <fpage>413</fpage>&#x02013;<lpage>423</lpage><pub-id pub-id-type="pmid">20830674</pub-id></mixed-citation></ref><ref id="pone.0103812-Tan1"><label>17</label><mixed-citation publication-type="journal"><name><surname>Tan</surname><given-names>Y</given-names></name>, <name><surname>Liao</surname><given-names>JC</given-names></name> (<year>2012</year>) <article-title>Metabolic ensemble modeling for strain engineers</article-title>. <source>Biotechnol J</source><volume>7</volume>: <fpage>343</fpage>&#x02013;<lpage>353</lpage><pub-id pub-id-type="pmid">22021171</pub-id></mixed-citation></ref><ref id="pone.0103812-Jia1"><label>18</label><mixed-citation publication-type="journal"><name><surname>Jia</surname><given-names>G</given-names></name>, <name><surname>Stephanopoulos</surname><given-names>G</given-names></name>, <name><surname>Gunawan</surname><given-names>R</given-names></name> (<year>2012</year>) <article-title>Ensemble kinetic modeling of metabolic networks from dynamic metabolic profiles</article-title>. <source>Metabolites</source><volume>2</volume>: <fpage>891</fpage>&#x02013;<lpage>912</lpage><pub-id pub-id-type="pmid">24957767</pub-id></mixed-citation></ref><ref id="pone.0103812-Wagner1"><label>19</label><mixed-citation publication-type="journal"><name><surname>Wagner</surname><given-names>A</given-names></name> (<year>2001</year>) <article-title>How to reconstruct a large genetic network from n gene perturbations in fewer than n(2) easy steps</article-title>. <source>Bioinformatics</source><volume>17</volume>: <fpage>1183</fpage>&#x02013;<lpage>1197</lpage><pub-id pub-id-type="pmid">11751227</pub-id></mixed-citation></ref><ref id="pone.0103812-Aho1"><label>20</label><mixed-citation publication-type="journal"><name><surname>Aho</surname><given-names>AV</given-names></name>, <name><surname>Garey</surname><given-names>MR</given-names></name>, <name><surname>Ullman</surname><given-names>JD</given-names></name> (<year>1972</year>) <article-title>The transitive reduction of a directed graph</article-title>. <source>SIAM J Comput</source><volume>1</volume>: <fpage>131</fpage>&#x02013;<lpage>137</lpage></mixed-citation></ref><ref id="pone.0103812-Jackson1"><label>21</label><mixed-citation publication-type="other">Jackson S (2011) Research Methods and Statistics: A Critical Thinking Approach. Cengage Learning, 138 pp.</mixed-citation></ref><ref id="pone.0103812-Harray1"><label>22</label><mixed-citation publication-type="other">Harray F (1969) Graph Theory. Addison-Wesley, Reading, Massachusetts.</mixed-citation></ref><ref id="pone.0103812-Pinna1"><label>23</label><mixed-citation publication-type="journal"><name><surname>Pinna</surname><given-names>A</given-names></name>, <name><surname>Soranzo</surname><given-names>N</given-names></name>, <name><surname>de la Fuente</surname><given-names>A</given-names></name> (<year>2010</year>) <article-title>From knockouts to networks: Establishing direct cause-effect relationships through graph analysis</article-title>. <source>PLoS ONE</source><volume>5</volume>: <fpage>e12912</fpage><pub-id pub-id-type="pmid">20949005</pub-id></mixed-citation></ref><ref id="pone.0103812-Schaffter1"><label>24</label><mixed-citation publication-type="journal"><name><surname>Schaffter</surname><given-names>T</given-names></name>, <name><surname>Marbach</surname><given-names>D</given-names></name>, <name><surname>Floreano</surname><given-names>D</given-names></name> (<year>2011</year>) <article-title>Genenetweaver: in silico benchmark generation and performance profiling of network inference methods</article-title>. <source>Bioinformatics</source><volume>27</volume>: <fpage>2263</fpage>&#x02013;<lpage>2270</lpage><pub-id pub-id-type="pmid">21697125</pub-id></mixed-citation></ref><ref id="pone.0103812-Albert1"><label>25</label><mixed-citation publication-type="journal"><name><surname>Albert</surname><given-names>R</given-names></name> (<year>2005</year>) <article-title>Scale-free networks in cell biology</article-title>. <source>Journal of cell science</source><volume>118</volume>: <fpage>4947</fpage>&#x02013;<lpage>4957</lpage><pub-id pub-id-type="pmid">16254242</pub-id></mixed-citation></ref><ref id="pone.0103812-Albert2"><label>26</label><mixed-citation publication-type="journal"><name><surname>Albert</surname><given-names>R</given-names></name>, <name><surname>Barab&#x000e1;si</surname><given-names>AL</given-names></name> (<year>2002</year>) <article-title>Statistical mechanics of complex networks</article-title>. <source>Rev Mod Phys</source><volume>74</volume>: <fpage>47</fpage>&#x02013;<lpage>97</lpage></mixed-citation></ref><ref id="pone.0103812-Pinna2"><label>27</label><mixed-citation publication-type="journal"><name><surname>Pinna</surname><given-names>A</given-names></name>, <name><surname>Soranzo</surname><given-names>N</given-names></name>, <name><surname>de la Fuente</surname><given-names>A</given-names></name> (<year>2010</year>) <article-title>From knockouts to networks: Establishing direct cause-effect relationships through graph analysis</article-title>. <source>PLoS ONE</source><volume>5</volume>: <fpage>e12912</fpage><pub-id pub-id-type="pmid">20949005</pub-id></mixed-citation></ref><ref id="pone.0103812-HuynhThu1"><label>28</label><mixed-citation publication-type="journal"><name><surname>Huynh-Thu</surname><given-names>VA</given-names></name>, <name><surname>Irrthum</surname><given-names>A</given-names></name>, <name><surname>Wehenkel</surname><given-names>L</given-names></name>, <name><surname>Geurts</surname><given-names>P</given-names></name> (<year>2010</year>) <article-title>Inferring regulatory networks from expression data using tree-based methods</article-title>. <source>PLoS ONE</source><volume>5</volume>: <fpage>e12776</fpage><pub-id pub-id-type="pmid">20927193</pub-id></mixed-citation></ref><ref id="pone.0103812-Haury1"><label>29</label><mixed-citation publication-type="journal"><name><surname>Haury</surname><given-names>AC</given-names></name>, <name><surname>Mordelet</surname><given-names>F</given-names></name>, <name><surname>Vera-Licona</surname><given-names>P</given-names></name>, <name><surname>Vert</surname><given-names>JP</given-names></name> (<year>2012</year>) <article-title>Tigress: Trustful inference of gene regulation using stability selection</article-title>. <source>BMC Systems Biology</source><volume>6</volume>: <fpage>145</fpage><pub-id pub-id-type="pmid">23173819</pub-id></mixed-citation></ref><ref id="pone.0103812-Siegenthaler1"><label>30</label><mixed-citation publication-type="journal"><name><surname>Siegenthaler</surname><given-names>C</given-names></name>, <name><surname>Gunawan</surname><given-names>R</given-names></name> (<year>2014</year>) <article-title>Assessing network inference methods: How to cope with an underdetermined problem</article-title>. <source>PLoS One</source><volume>9</volume>: <fpage>e90481</fpage><pub-id pub-id-type="pmid">24603847</pub-id></mixed-citation></ref><ref id="pone.0103812-Tsamardinos1"><label>31</label><mixed-citation publication-type="journal"><name><surname>Tsamardinos</surname><given-names>I</given-names></name>, <name><surname>Brown</surname><given-names>LE</given-names></name>, <name><surname>Aliferis</surname><given-names>CF</given-names></name> (<year>2006</year>) <article-title>The max-min hill-climbing bayesian network structure learning algorithm</article-title>. <source>Machine Learning</source><volume>65</volume>: <fpage>31</fpage>&#x02013;<lpage>78</lpage></mixed-citation></ref></ref-list></back></article>