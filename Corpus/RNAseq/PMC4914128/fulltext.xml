<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 39.96?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id><journal-id journal-id-type="hwp">nar</journal-id><journal-id journal-id-type="publisher-id">nar</journal-id><journal-title-group><journal-title>Nucleic Acids Research</journal-title></journal-title-group><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4914128</article-id><article-id pub-id-type="doi">10.1093/nar/gkw448</article-id><article-categories><subj-group subj-group-type="hwp-journal-coll"><subject>9</subject></subj-group><subj-group subj-group-type="heading"><subject>Computational Biology</subject></subj-group></article-categories><title-group><article-title>RNAontheBENCH: computational and empirical resources for benchmarking RNAseq quantification and differential expression methods</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Germain</surname><given-names>Pierre-Luc</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Vitriolo</surname><given-names>Alessandro</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Adamo</surname><given-names>Antonio</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Laise</surname><given-names>Pasquale</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Das</surname><given-names>Vivek</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Testa</surname><given-names>Giuseppe</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><aff id="AFF1"><label>1</label>European Institute of Oncology, Department of Experimental Oncology, Via Adamello 16, 20139 Milano, Italy</aff><aff id="AFF2"><label>2</label>University of Milan, Department of Oncology and Hemato-Oncology, Via Festa del Perdono 7, 20122 Milano, Italy</aff></contrib-group><author-notes><corresp id="COR1"><label>*</label>To whom correspondence should be addressed. Tel: +39 2 94375 105; Fax: +39 2 94375 990; Email: <email>giuseppe.testa@ieo.eu</email></corresp></author-notes><pub-date pub-type="ppub"><day>20</day><month>6</month><year>2016</year></pub-date><pub-date pub-type="epub"><day>17</day><month>5</month><year>2016</year></pub-date><pub-date pub-type="pmc-release"><day>17</day><month>5</month><year>2016</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>44</volume><issue>11</issue><fpage>5054</fpage><lpage>5067</lpage><history><date date-type="accepted"><day>09</day><month>5</month><year>2016</year></date><date date-type="rev-recd"><day>07</day><month>5</month><year>2016</year></date><date date-type="received"><day>18</day><month>1</month><year>2016</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2016. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement><copyright-year>2016</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p></license></permissions><self-uri xlink:title="pdf" xlink:href="gkw448.pdf"/><abstract><p>RNA sequencing (RNAseq) has become the method of choice for transcriptome analysis, yet no consensus exists as to the most appropriate pipeline for its analysis, with current benchmarks suffering important limitations. Here, we address these challenges through a rich benchmarking resource harnessing (i) two RNAseq datasets including ERCC ExFold spike-ins; (ii) Nanostring measurements of a panel of 150 genes on the same samples; (iii) a set of internal, genetically-determined controls; (iv) a reanalysis of the SEQC dataset; and (v) a focus on relative quantification (i.e. across-samples). We use this resource to compare different approaches to each step of RNAseq analysis, from alignment to differential expression testing. We show that methods providing the best absolute quantification do not necessarily provide good relative quantification across samples, that count-based methods are superior for gene-level relative quantification, and that the new generation of pseudo-alignment-based software performs as well as established methods, at a fraction of the computing time. We also assess the impact of library type and size on quantification and differential expression analysis. Finally, we have created a R package and a web platform to enable the simple and streamlined application of this resource to the benchmarking of future methods.</p></abstract><counts><page-count count="14"/></counts><custom-meta-group><custom-meta><meta-name>cover-date</meta-name><meta-value>20 June 2016</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>INTRODUCTION</title><p>RNA sequencing (RNAseq) has become the method of choice for transcriptome analysis, and a large variety of softwares and methods have been developed for the different steps leading to quantification and differential expression analysis (DEA). Several benchmarking efforts (<xref rid="B1" ref-type="bibr">1</xref>&#x02013;<xref rid="B12" ref-type="bibr">12</xref>) have allowed their comparison, showing a fairly high reproducibility of the most popular methods (<xref rid="B9" ref-type="bibr">9</xref>), while highlighting their respective strengths and weaknesses (see especially (<xref rid="B1" ref-type="bibr">1</xref>) for alignment and (<xref rid="B3" ref-type="bibr">3</xref>) for differential expression). In addition, some studies demonstrated the effect of ambiguous alignments or multi-mapping reads on quantification biases (<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B11" ref-type="bibr">11</xref>), and of differential isoform length on gene-level quantification (<xref rid="B4" ref-type="bibr">4</xref>,<xref rid="B13" ref-type="bibr">13</xref>), although the effect of the latter in real datasets appears relatively small, and gene-level estimates were shown to be more stable than transcript-level ones (<xref rid="B14" ref-type="bibr">14</xref>). Regarding DEA, in addition to a comparison of statistical models (<xref rid="B3" ref-type="bibr">3</xref>), previous contributions have for instance studied the effect of &#x02018;zero-count genes&#x02019; on some methods (<xref rid="B6" ref-type="bibr">6</xref>,<xref rid="B15" ref-type="bibr">15</xref>), and shown that isoform filtering can improve differential transcript usage (<xref rid="B16" ref-type="bibr">16</xref>).</p><p>While these efforts have all been critical to guide the choice and development of analysis methods, little consensus has yet emerged as to the most appropriate pipeline. Part of the problem is due to the constant release of new methods, which makes previous comparisons obsolete, and this is especially true with the recent emergence of new, alignment-free (or pseudo-alignment-based) methods (<xref rid="B17" ref-type="bibr">17</xref>). In addition, previous benchmarking efforts also have important internal limitations. The most important (and largely inevitable) is arguably the absence of a clear and robust gold standard on which to judge performance. In facing this issue, a first strategy has been to rely on simulated data that are generated however through in-built assumptions and might thus not accurately reflect the biological conditions, as well as the technical biases and variations of a real experiment. A second strategy has been to rely on established technologies such as microarrays or RT-qPCR, which have however a very different dynamic range and suffer themselves from systematic biases (<xref rid="B18" ref-type="bibr">18</xref>,<xref rid="B19" ref-type="bibr">19</xref>). Moreover, for practical reasons, RT-qPCR validation is typically performed on a small set of genes, and/or for very few samples. Finally, another strategy has been to seek the method that maximizes the agreement between replicates, which guarantees some internal validity but cannot assess the accuracy of the quantification.</p><p>In addition, and despite the fact that a considerable proportion of RNAseq experiments are aimed at detecting differential expression, most benchmarking efforts have focused on absolute rather than relative (i.e. cross-sample) quantification, or have reduced the problem of relative quantification to that of differential expression analysis. Accurately quantifying differences across samples is necessary and prior not only to DEA, but also to a variety of other applications, such as classification and the reverse-engineering of gene regulatory networks. Moreover, the assessment of accuracy is generally performed by correlating observed expression values with expected ones, which can be heavily biased for heteroscedastic data that are non-homogeneously distributed across a large dynamic range (as is the case for RNAseq), and might thereby obfuscate proportionally small but potentially critical inaccuracies in the estimation of expression differences across samples.</p><p>To face these challenges, it is critical to use a plurality of complementary benchmarks relying on both empirical and <italic>in silico</italic> data, in order to mitigate their respective limitations. Therefore, we present here an empirically-grounded computational resource for benchmarking RNAseq analysis methods that addresses the main aforementioned issues: RNA on the Benchhmark of Expression by nCounter Hybridisation (RNAontheBENCH). RNAontheBENCH harnesses a number of innovative features: (i) a RNAseq dataset from 12 human induced pluripotent stem cell (iPSC) lines all including the External RNA Controls Consortium (ERCC) ExFold spike-ins (<xref rid="B20" ref-type="bibr">20</xref>), i.e. 92 transcripts in known concentrations, some of which are differentially-expressed across mixes; (ii) a panel of 150 genes representative of the transcriptome (Supplementary Figure S1), including multiple isoforms for some genes, measured in the same samples by the highly reproducible Nanostring nCounter technology (<xref rid="B21" ref-type="bibr">21</xref>); (iii) a set of genetically-determined, internal controls, i.e. genes present at different copy-numbers and known to be expressed linearly with copy-numbers; (iv) a further validation dataset for which the same RNA extraction was assayed using both RNAseq and Nanostring; (v) reanalyses of the Sequencing Quality Control (SEQC) dataset (<xref rid="B9" ref-type="bibr">9</xref>); (vi) accuracy metrics based on relative expression across samples, i.e. the comparison of feature-wise <italic>z</italic>-scores or foldchanges across samples; and (vii) an <italic>in silico</italic> dataset specifically designed to further establish the accuracy of relative expression at the transcript level. We use this resource to compare different approaches to each step of RNAseq analysis, from alignment to differential expression testing, and to assess the impact of coverage and library design.</p><p>The tested software can be divided into different categories on the basis of the task performed. First are genome alignment methods, which map genes onto genomic location but do not perform quantification. Of these, we tested Tophat 2.0.14 (<xref rid="B22" ref-type="bibr">22</xref>), STAR 2.4.1 (<xref rid="B23" ref-type="bibr">23</xref>), HISAT 0.1.6 (<xref rid="B24" ref-type="bibr">24</xref>) and MapSplice 2.1.9 (<xref rid="B25" ref-type="bibr">25</xref>). Second are methods quantifying genomic features on the basis of these previously aligned reads. The simplest such methods are based on counting the number of reads/fragment unambiguously overlapping a single feature (e.g. exon/transcript/gene), henceforth referred to as count-based methods. We chose not to test specifically the popular HTseq-count method (<xref rid="B26" ref-type="bibr">26</xref>), because featureCounts 1.4.4 proved equivalent and considerably faster (<xref rid="B27" ref-type="bibr">27</xref>). More refined quantification methods instead assign reads to features probabilistically, and among these we tested the popular Cufflinks 2.2.1 (<xref rid="B22" ref-type="bibr">22</xref>). Where possible, we tested both these methods (i.e. featureCounts and Cufflinks) in combination with each aligner. In addition, we tested RSEM 1.2.22 (<xref rid="B28" ref-type="bibr">28</xref>), which first performs alignment to the transcriptome using bowtie 2.1.0 (<xref rid="B29" ref-type="bibr">29</xref>) before performing transcript quantification through expectation-maximization. Third, a new and very different type of software skips traditional alignment and performs quantification at unprecedented speed through pseudo-alignment, and as such promises to transform RNAseq analysis. Of these, we tested Sailfish 0.7.6 (<xref rid="B17" ref-type="bibr">17</xref>), Salmon 0.5.0 (unpublished; manuscript: Patro, Duggal, and Kingsford, bioRxiv 2015, doi:10.1101/021592), and Kallisto 0.42.3 (unpublished but available at <ext-link ext-link-type="uri" xlink:href="http://pachterlab.github.io/kallisto">http://pachterlab.github.io/kallisto</ext-link>). Fourth and last are methods performing differential expression analysis on the basis of previously established quantifications. We tested DESeq2 1.10 (<xref rid="B30" ref-type="bibr">30</xref>,<xref rid="B31" ref-type="bibr">31</xref>), limma/voom 3.22.7 (<xref rid="B32" ref-type="bibr">32</xref>,<xref rid="B33" ref-type="bibr">33</xref>), edgeR 3.8.6 (<xref rid="B34" ref-type="bibr">34</xref>), sleuth 0.28.0 (unpublished but available at <ext-link ext-link-type="uri" xlink:href="http://pachterlab.github.io/sleuth/">http://pachterlab.github.io/sleuth/</ext-link>) and Cuffdiff 2.2.1 (<xref rid="B22" ref-type="bibr">22</xref>). The software details are listed in Supplementary Table S1, while the different pipelines and parameters used are listed along with the results in Supplementary Table S2.</p><p>Rather than attempting an exhaustive review of all available methods, we focused on developing a resource that users could easily apply to other methods. To this end, all the benchmarking code is available through the RNAontheBENCH R package (source available on github at <ext-link ext-link-type="uri" xlink:href="https://github.com/plger/RNAontheBENCH">https://github.com/plger/RNAontheBENCH</ext-link>). In addition, and similarly to some previous efforts with microarrays (<xref rid="B35" ref-type="bibr">35</xref>), we developed a user-friendly online platform allowing an in-depth benchmarking of analysis methods (<ext-link ext-link-type="uri" xlink:href="https://bio.ieo.eu/rnaseqBenchmark">https://bio.ieo.eu/rnaseqBenchmark</ext-link>), making the current study easily accessible by the community and extensible to future software/methods.</p></sec><sec sec-type="materials|methods" id="SEC2"><title>MATERIALS AND METHODS</title><sec id="SEC2-1"><title>RNAseq and spike-in distribution</title><p>The RNAseq data has been previously published in GEO series GSE63055 (see Supplementary Table S3). The two different ExFold ERCC mixes were added to total RNA before RiboZero treatment and library preparation. For the main dataset, libraries were sequenced at a coverage of &#x0223c;45&#x02013;75 M of 100 bp read pairs. For the smaller, validation dataset, libraries were sequenced at a coverage of &#x0223c;44&#x02013;57 M of 51 bp read pairs. Reads were aligned to the NCBI GRCh38 genome including the spike-in and EBV sequences.</p></sec><sec id="SEC2-2"><title>Nanostring panel</title><p>We designed a panel of Nanostring probes for 150 genes (including probes for different isoforms of two genes), and quantified them across all 12 samples (see Supplementary Table S4 for details on the probes' design). The genes include 21 genes that have different copy-numbers across samples (and were shown to be expressed accordingly), as well as other genes of interests and putatively differentially-expressed genes. Importantly, the panel of genes is representative of the whole human transcriptome in terms of transcript lengths, number of exons, and expression levels (Supplementary Figure S1A&#x02013;C). Probes expected (by the Nanostring CodeSet design team) to cross-hybyidize with other genes were excluded from the analysis, as well as, for the primary dataset, one probe related to a gene which we had independent evidence to be differentially-expressed between the RNA extractions used respectively for RNAseq and Nanostring (see Supplementary Figure S2). For the purpose of comparing RNAseq and Nanostring quantifications, we summed the TPM values of transcripts matching each Nanostring probe. Since the Nanostring itself relies on housekeeping genes for normalization (GAPDH, TUBB, and TBP), for the purpose of comparison with Nanostring we re-normalized the RNAseq data using the same housekeeping genes (using geometric normalization of TPM values) when dealing with gene-level quantification. For transcript-level quantification, for many samples count-based methods were unable to assign reads unambiguously to the housekeeping transcripts, preventing their use for normalization. For this reason, we used TMM normalization (<xref rid="B36" ref-type="bibr">36</xref>) on final values for transcript-level analysis.</p><p>For differential-expression analysis, we compared the WBS samples to the 7dup samples (see Supplementary Table S3), and we considered a Nanostring probe to be differentially-expressed if a <italic>t</italic>-test on the log-transformed Nanostring intensities gave a <italic>P</italic>-value smaller than 0.01.</p></sec><sec id="SEC2-3"><title><italic>In silico</italic> data</title><p>We simulated 100 bp paired RNAseq reads from 17817 Refseq transcripts for eight samples (&#x0003e;5 M reads per sample) using the R package Polyester (<xref rid="B37" ref-type="bibr">37</xref>). For half of the samples, we introduced foldchanges ranging from 1.1 to 10-fold difference (random noise was added for half of the foldchanges). The exact foldchanges introduced are available in Supplementary Table S5, and the generated reads are available from our website (see below). The reads were simulated on the basis of Refseq transcripts with the simulate_experiment function, ran with the following parameters: (i) empirical fragment length distribution (distr = &#x02018;empirical&#x02019;), (ii) Illumina sequencing error distribution (error_model = &#x02018;illumina5&#x02019;), (iii) positional bias (bias = &#x02018;rnaf&#x02019;), and (iv) read counts based on length (meanmodel = TRUE). Random quality scores following a usual Truseq pattern were added when converting reads to FASTQ.</p></sec><sec id="SEC2-4"><title>SEQC data</title><p>We downloaded all SEQC (<xref rid="B9" ref-type="bibr">9</xref>) Illumina reads from the BGI site, merged the different lanes for each sample, aligned with HISAT and quantified with Cufflinks (as described in the HISAT-Cufflinks pipeline in Supplementary Table S2). Between-group DEA was performed using respectively all five replicates or replicates 1, 3, 5 of each group, while within-group DEA was performed comparing replicates 1, 2, 3 to replicates 4, 5 in each group.</p></sec><sec id="SEC2-5"><title>Spike-in normalization</title><p>To avoid eventual biases in the loading of the spike-in mixes, we normalized the spike-ins independently of the rest of the transcriptome. However, most normalization methods assume that most of the genes/transcripts are <italic>not</italic> differentially-expressed, while most spike-ins are in fact in different concentration across mixes, biasing normalization. To address this issue, we homogenized the two mixes for the purpose of calculating normalization factors, by multiplying values of samples containing one of the mix by their expected foldchange to the other mix (the exact code can be found in the RNAontheBENCH R package). For the purpose of comparing quantification, we used linear normalization factors because they maximized the correlation. For the purpose of differential expression analysis, we used TMM normalization. Since Cuffdiff was not amenable to this spike-in homogenization and does not offer the freedom to input custom normalization factors, we hard-coded them into the program's source and recompiled a custom version to ensure comparability.</p></sec><sec id="SEC2-6"><title>FPKM and TPM calculations</title><p>Unless specified otherwise, all tests were performed using normalized Transcripts Per Million (TPM). If the software produced TPM values, we used these directly. If it produced Fragments Per Kilobase of transcript per Million reads sequenced (FPKM), we converted these values to TPM. If it produced counts, we first calculated FPKM values (using effective length), and converted them to TPM.</p><p>For gene-level analysis, when the quantification method provided gene-level quantification, these were used (and eventually converted as described above); otherwise we summed the TPM values of the gene's transcripts.</p></sec><sec id="SEC2-7"><title>Downsampling</title><p>For Salmon, the downsampling analysis was performed using the first <italic>N</italic> reads of the fastq files, where <italic>N</italic> was the number of reads corresponding to the given proportion for the given sample. For alignment-based methods, we instead used samtools 1.2 (<xref rid="B38" ref-type="bibr">38</xref>) to randomly select the corresponding number of reads from the aligned ones.</p></sec><sec id="SEC2-8"><title>Software selection</title><p>The packages/methods used for comparison were selected either because (i) they are widely used, (ii) previous benchmarks have found them among the most accurate, and/or (iii) they were recently released and promising. The software versions are available in Supplementary Table S1. We used default or recommended settings unless we had reasons to think that some parameters would yield better results (the detailed parameters used can be found in Supplementary Table S2).</p></sec></sec><sec sec-type="results" id="SEC3"><title>RESULTS</title><sec id="SEC3-1"><title>Transcripts and spike-ins detection</title><p>We first assessed the capacity of the different pipelines to detect the spike-ins as well as transcripts known to be expressed on the basis of the Nanostring data. We considered a transcript detected if the software gave it an expression level above zero. As shown in Figure <xref ref-type="fig" rid="F1">1A</xref>, the most important difference was the inability of count-based methods to detect a large proportion of transcripts. This is not surprising given that these methods normally discard most of the reads as ambiguous and hence require a greater coverage to quantify overlapping transcripts. Counts based on the MapSplice2 alignment showed the best detection rate (73%), followed by STAR (72%), but no difference in detection rate could be found among the other pipelines.</p><fig id="F1" orientation="portrait" position="float"><label>Figure 1.</label><caption><p>Accuracy of abundance estimates. (<bold>A</bold>) Proportion of transcripts detected by each pipeline. (<bold>B</bold>) Proportion of spike-ins detected. (<bold>C</bold>) Correlation of spike-in abundance estimates with real spike-in concentrations. Triangles indicate Pearson's correlation, while discs indicate the Spearman's correlation. (<bold>D</bold>) Correlation of gene expression estimates with Nanostring. Triangles indicate Pearson's correlation, while discs indicate the Spearman's correlation. Pearson (<bold>E</bold>) or Spearman (<bold>F</bold>) correlation of transcript abundance estimates with Nanostring. Triangles indicate the overall correlation, discs indicate the correlation for transcripts expressed below the median expression level, and squares indicate the correlation for transcript above the median.</p></caption><graphic xlink:href="gkw448fig1"/></fig><p>Instead the spike-ins, which were designed partly to assess the sensitivity of an experiment and therefore contain several RNAs in very low concentrations, did not show different detection rates between count-based quantification and other methods (Figure <xref ref-type="fig" rid="F1">1B</xref>). Since the spike-ins have no overlapping isoforms, this is consistent with the hypothesis of ambiguous reads being responsible for the count-based methods' poor performance in detecting transcripts. Finally, the spike-ins revealed a slightly better detection rate for Sailfish (86%, versus 84&#x02013;85% for most others).</p></sec><sec id="SEC3-2"><title>Spike-in and gene-level abundance estimates</title><p>To assess the accuracy of each pipeline in measuring spike-in and gene abundances, we calculated the overall correlations (using both Pearson and Spearman coefficients) of the quantification with, respectively, the real concentrations of the spike-ins (Figure <xref ref-type="fig" rid="F1">1C</xref>) and the Nanostring quantification of the genes (Figure <xref ref-type="fig" rid="F1">1D</xref>). In general, count-based methods performed worst, except for Sailfish which performed poorly <italic>specifically</italic> on the spike-in quantification. Salmon performed best for spike-ins, followed by Kallisto and RSEM; for gene abundance estimation, RSEM performed best but was nearly equalled by Cufflinks and pseudo-alignment-based methods. We also looked at the distribution of per-sample correlation, which displayed the same general trend but revealed a high variability of Cufflinks and Sailfish's spike-in (but not gene) quantification (Supplementary Figure S2).</p></sec><sec id="SEC3-3"><title>Transcript abundance estimates</title><p>When performing the same analysis at the transcript level, count-based quantification performed extremely poorly, partly but not entirely due to its low detection rate (Supplementary Figure S3A). In addition, the abundance of a large number of transcripts was underestimated. An important reason is that when calculating expression in Fragments Per Kilobasepair of transcript per Million reads (FPKM), the entire length of the transcript (or minus the fragment length) is used, whereas large proportions of the transcript might not be uniquely mappable (e.g. exons shared by all isoforms of a gene) and hence have a null read count. If the length of these regions is counted in the transcript length, FPKM values (and derived Transcripts Per Million reads, TPM) will necessarily deviate from expected abundances. Therefore, for count-based methods we calculated FPKM not based on the real transcript length, but on its &#x02018;unique length&#x02019;, i.e. the length that is uniquely attributable to that transcript. While this represents only an approximation of the length across which fragments can be unambiguously assigned, it dramatically improved the performance of count-based methods (Supplementary Figure S3B). Nevertheless, these methods could not compare with alternative methods (Figure <xref ref-type="fig" rid="F1">1E</xref>-<xref ref-type="fig" rid="F1">F</xref>), even when excluding undetected transcripts, and should therefore be avoided for (absolute) transcript abundance estimation. Among the remaining methods, Cufflinks and RSEM performed better than alignment-free methods. (See Supplementary Figure S4 for the distributions of per-sample correlations).</p></sec><sec id="SEC3-4"><title>Accuracy of relative expression estimates</title><p>For many purposes such as differential expression analysis, it is much more important to be able to detect and quantify differences across samples than to be able to accurately quantify the relative abundance of each transcript within a sample. Given imperfect quantification estimates, the methods that perform best at one task do not necessarily perform best at the other, and we therefore tested the accuracy of quantification of differences across samples.</p><p>In our experimental design, each sample was spiked-in with one of two mixes of the ERCC ExFold kit, each containing different concentrations of the same set of spike-ins (see Supplementary Table S2 for the mix distribution across samples). To assess the accuracy of relative spike-in abundance estimates, we therefore simply correlated the measured and the expected foldchanges between mixes.</p><p>For gene-level and transcript-level differences, we calculated both the foldchange-to-the-mean and the z-score for each gene/transcript. However, given that the foldchange-to-the-mean is easily distorted (e.g. random differences at low expression levels), we focused on the <italic>z</italic>-scores, which provide more stable measure of relevant differences by scaling deviations from the mean on the standard deviation.</p><p>Importantly, when quantifying differences at the gene level, count-based methods performed better than other methods (Figure <xref ref-type="fig" rid="F2">2A</xref>), confirming the hypothesis that the ability to quantify differential expression does not necessarily hinge on the ability to quantify abundance, and warranting the use of count-based methods for gene-level differential-expression analysis. These results were partly confirmed when looking at the foldchange between spike-in mixes (Figure <xref ref-type="fig" rid="F2">2B</xref>), although the differences are small in magnitude (foldchange correlation ranging from 0.789 to 0.82): with the exception of STAR-based counts, count-based methods had a higher correlation with real foldchange, and a lower median or total error (Supplementary Table S2). Pseudo-alignment methods were in the middle, while Cufflinks (with the exception of the Tophat-Cufflinks pipeline) and RSEM performed worst.</p><fig id="F2" orientation="portrait" position="float"><label>Figure 2.</label><caption><p>Accuracy of relative quantification. (<bold>A</bold>) Correlation of gene-wise z-scores (across samples) with Nanostring. (<bold>B</bold>) Correlation of observed fold-changes between spike-in mixes 1 and 2 with real fold-changes. (<bold>C</bold>) Correlation of WBSCR genes with their copy-number. (<bold>D</bold>) Correlation of transcript-wise <italic>z</italic>-scores with Nanostring. (<bold>E</bold>) Median transcript-wise correlation (across samples) between observed and expected values in the simulated dataset.</p></caption><graphic xlink:href="gkw448fig2"/></fig><p>Given the small magnitude of these differences, we sought to further validate them using genetically-determined internal controls: genes of the Williams-Beuren Syndrome Critical Region (WBSCR), which are either duplicated or hemizygously deleted in, respectively, Somerville-van der Aa syndrome and Williams-Beuren syndrome, from which we derived iPSC cell lines and profiled their transcriptomes (<xref rid="B39" ref-type="bibr">39</xref>). Importantly, the vast majority of these genes are expressed in iPSC and have been shown to vary linearly with copy-number both at the RNA and protein levels ((39) and data not shown). We therefore tested to what extent the expression of each of these genes correlated with its copy-number using the different methods outlined above (Figure <xref ref-type="fig" rid="F2">2C</xref>). Again, this showed a good performance of count-based methods (except STAR-based counts), along with Salmon and closely followed by Tophat-Cufflinks and Kallisto.</p><p>Transcript-level quantification is much more difficult, and consequently it revealed more substantial differences between methods (Figure <xref ref-type="fig" rid="F2">2D</xref>). Here, count-based methods performed very poorly as expected, while Salmon, RSEM, and Cufflinks (especially Tophat-Cufflinks) performed best. The fact that count-based methods performed well at the gene-level or with spike-ins, and very badly at transcript-level (which is beyond their purpose), corroborates the idea that their limitation lies in their inability to use ambiguous reads. We looked more closely at the differences between the other methods, which are very robust across a variety of metrics (see Supplementary Table S2), and concluded that the Tophat-Cufflinks pipeline is superior to others in all respects, except for estimating the absolute abundance of lowly-expressed transcripts, where RSEM performs best. However, the differences between Tophat-Cufflinks, RSEM and Salmon are very small, especially when looking at transcript <italic>z</italic>-scores, where they represent little more than 2% difference in correlation or median error. Importantly, Salmon was not among the best performing methods for absolute transcript quantification, but was slightly better than RSEM when looking at transcript z-scores. We therefore conclude that these three approaches appear to most accurately quantify relative differences.</p></sec><sec id="SEC3-5"><title>Confirmation with <italic>in-silico</italic> data</title><p>The spike-ins had the limitation that they are not spliced and do not produce alternative isoforms from the same genomic region, while the Nanostring dataset described so far had the limitation that most probes hybridize with more than one isofrom, and that it was not assayed on the very same RNA extraction as the RNA-seq. We therefore sought to further solidify our analysis using in-silico data generated for two groups of four samples each (see methods and supplementary materials).</p><p>Of note, the simulated data is deliberately highly artificial in that the distributions of expression levels across features does not resemble a real experiment, but was rather specifically designed to make transcript quantification difficult (see methods). In particular, most isoforms of most genes were expressed, and transcripts were assigned a foldchange randomly, independently of which gene they belonged to. Therefore, while this dataset can reveal differences between methods in dealing with difficult loci, it does not show the effective relevance of those differences in a normal context (see also (<xref rid="B14" ref-type="bibr">14</xref>)), and should be interpreted as a further validation of the previous results.</p><p>We first calculated each transcript's foldchange between groups, and correlated them to the real ones. We were surprised to see major differences (Supplementary Figure S6A) between methods which, so far, had given comparable results, and while investigating the issue we noted that this difference was mostly due to very few transcripts that were assigned an extremely high foldchange (Supplementary Figure S6B). We therefore calculated, for each transcript, the correlation between real and measured expression across samples, and plotted the distribution of correlations (Supplementary Figure S7). The mean and median transcript correlation of the best performing methods are plotted in Figure <xref ref-type="fig" rid="F2">2E</xref>. While the differences are once again small in magnitude, RSEM performed best, followed by Sailfish. Thus, when considering both the <italic>in silico</italic> data and the comparison with Nanostring, RSEM appears to give the best performance.</p></sec><sec id="SEC3-6"><title>Confirmation with a different dataset</title><p>Given the relatively small magnitude of the differences observed between the top-performing methods, we further validated them in a different, smaller dataset of 6 samples for which the very same RNA extraction was used for both RNAseq and the aforementioned Nanostring panel (Figure <xref ref-type="fig" rid="F3">3</xref>). RSEM was again the best method in quantifying transcript abundances, with a high correlation (Figure <xref ref-type="fig" rid="F3">3A</xref>) and a low median absolute error (Figure <xref ref-type="fig" rid="F3">3B</xref>) when compared to Nanostring, while Tophat-Cufflinks had the lowest mean correlation and the highest median absolute error. In terms of relative transcript quantification, Tophat-Cufflinks performed best for lowly-expressed transcripts (Figure <xref ref-type="fig" rid="F3">3E</xref>), but alignment-free methods showed the highest correlation of <italic>z</italic>-scores overall (Figure <xref ref-type="fig" rid="F3">3D</xref>) and among highly-expressed transcripts (Figure <xref ref-type="fig" rid="F3">3F</xref>). In addition, Salmon and RSEM were superior to other methods in estimating the ratio between different EIF4H isoforms (Figure <xref ref-type="fig" rid="F3">3C</xref>), a gene of the WBSCR for which both expressed isoforms were independently assayed by Nanostring. While these results bring nuance to the previous ones, they also corroborate the superiority of RSEM in estimating abundance, and further support Salmon for relative quantification, in agreement with the results obtained from the previous Nanostring dataset.</p><fig id="F3" orientation="portrait" position="float"><label>Figure 3.</label><caption><p>Accuracy of transcript quantification in the validation dataset for top-ranking methods. (<bold>A</bold>) Distribution of samples' Pearson correlation with Nanostring. (<bold>B</bold>) Median absolute error of abundance estimates. (<bold>C</bold>) Correlation of EIF4H isoform ratios with Nanostring. Pearson correlation of transcript-wise <italic>z</italic>-scores with Nanostring, for all transcripts (<bold>D</bold>), those expressed below the median (<bold>E</bold>), and those expressed above the median (<bold>F</bold>).</p></caption><graphic xlink:href="gkw448fig3"/></fig></sec><sec id="SEC3-7"><title>Difficult genes</title><p>It was recently reported that some genes are particularly difficult to quantify via RNAseq, mostly due to multi-mapping reads (<xref rid="B11" ref-type="bibr">11</xref>). To test whether the difficulty in estimating the abundance of these transcripts translated into a difficulty to estimate their relative expression across samples, we compared their transcript-wise correlation in our simulated data (Supplementary Figure S8). We found no significant difference in the accuracy of the quantification of transcripts from &#x02018;difficult genes&#x02019; versus the rest of the transcriptome, with a 95% confidence interval of the difference in mean absolute log<sub>2</sub>(fc) deviation between &#x02018;difficult genes&#x02019; and the rest of the transcriptome of &#x02212;0.037 to 0.054 (<italic>P</italic> &#x0223c; 0.71). Once more, this corroborates the idea that it is not necessary to accurately estimate abundance, in order to accurately estimate differences across samples.</p><p>Although the relative expression of &#x02018;difficult genes&#x02019; is no less accurately quantified, it is possible that differences in those features are more difficult to detect due to discarded ambiguous reads. Indeed, an analysis of variance showed that log-transformed <italic>P</italic>-values for differentially-expressed transcripts belonging to multi-mapping groups tended to be larger (<italic>P</italic> &#x0223c; 2.3e&#x02212;5, blocking for real foldchange and read count), supporting the idea that although the relative quantification of these features is not more difficult, the identification of statistically significant differences is indeed less efficient.</p><p>Finally, to investigate whether some characteristics of the transcripts might explain the difficulty in their relative quantification, we performed an analysis of variance on the transcript-wise correlations with expected values. As expected, the most important association was with the magnitude of the foldchange (<italic>P</italic> &#x0003c; 2e&#x02212;16), followed by the number of transcripts associated to the same gene (<italic>P</italic> &#x0223c; 3.87e&#x02212;06). We also observed a weak association with transcript length (<italic>P</italic> &#x0223c; 0.0061), but no significant association with the number of exons (<italic>P</italic> &#x0223c; 0.767). For each transcript, the correlation between expected and observed quantifications across samples is reported in Supplementary Table S7.</p></sec><sec id="SEC3-8"><title>Spike-in differential expression analysis</title><p>We next tested the ability of differential expression analysis (DEA) methods to accurately detect differences in concentration between the two spike-in mixes. For all methods, we calculated normalization factors in the same way, using the trimmed mean of <italic>M</italic>-values (TMM) method (<xref rid="B36" ref-type="bibr">36</xref>) on the homogenized mixes (see methods). We then computed the receiver operating characteristic (ROC) curve, which plots sensitivity against false positive rate at different significance thresholds (Figure <xref ref-type="fig" rid="F4">4A</xref>). In addition, we observed the sensitivity and specificity at different <italic>P</italic>-value thresholds, fold-change deviations, and the distribution of <italic>P</italic>-values by expected foldchange for each method (see Supplementary Figures S9&#x02013;S16). As expected given the absence of alternative isoforms for spike-ins (and hence virtually no ambiguous reads), the quantification method used had very little impact on DEA accuracy. Moreover, all DEA methods appeared fairly specific, identifying no false positive at <italic>P</italic> &#x0003c; 0.01, but there were important differences in sensitivity (Figure <xref ref-type="fig" rid="F4">4A</xref> and&#x000a0;<xref ref-type="fig" rid="F4">B</xref>). The ROC curves summarize well the performance of each method (Figure <xref ref-type="fig" rid="F4">4A</xref>). EdgeR performed best, closely followed by limma/voom, while Cuffdiff and especially Sleuth were the least performing. For Sleuth, increasing the number of bootstrap samples (from 10 to 100) made no noticeable difference to its performance (Supplementary Figures S10&#x02013;S11).</p><fig id="F4" orientation="portrait" position="float"><label>Figure 4.</label><caption><p>Accuracy of differential expression analysis (DEA) methods in different contexts. (<bold>A</bold>) ROC curve of each method in comparing spike-in mixes (see Supplementary Figures S9 to S16 for more detail). (<bold>B</bold>) Accuracy metrics at <italic>P</italic> &#x0003c; 0.01 in the comparison between spike-in mixes. (<bold>C</bold>) Area under the ROC curve and accuracy metrics at <italic>P</italic> &#x0003c; 0.01 when comparing to Nanostring data. (<bold>D)</bold> ROC curves for the spike-ins of the SEQC data. (<bold>E</bold>) Accuracy metrics at <italic>P</italic> &#x0003c; 0.01 for the spike-ins of the SEQC data. (<bold>F</bold>) Area under the ROC curve of transcript-level DEA methods in the simulated data. False discovery rate (FDR) and area under the positives' curve for each method when calling differential expression within and across cell lines, at the transcript (<bold>G</bold>) and gene (<bold>F</bold>) levels (see Supplementary Figures S27 to S30 for more detail).</p></caption><graphic xlink:href="gkw448fig4"/></fig><p>Upon repeating the same analysis on an external data-set (SEQC; see Materials and Methods and (<xref rid="B9" ref-type="bibr">9</xref>)) which also included the two spike-in mixes, the results were similar, except that Sleuth proved more specific and Cufflinks more sensitive at <italic>P</italic> &#x0003c; 0.01, although with overall performances below voom and edgeR (Figure <xref ref-type="fig" rid="F4">4D</xref> and&#x000a0;<xref ref-type="fig" rid="F4">E</xref>).</p><p>Finally, since some users are (against recommendations of the edgeR and DESeq documentations) using TPM estimates directly for DEA, we tested the performance of edgeR and voom with these values. While using TPM rather than count estimates resulted in a mild loss of specificity with voom (Supplementary Figure S17), with edgeR it resulted in a substantial loss of sensitivity (Supplementary Figure S18). Therefore, while the use of TPM values for DEA is not advisable, users who wish to do so should preferably use voom.</p></sec><sec id="SEC3-9"><title>Differential expression analysis compared to Nanostring and simulated data</title><p>Since the spike-ins are neither spliced nor overlapping, we sought to confirm these results using the Nanostring panel (Figure <xref ref-type="fig" rid="F4">4C</xref> and Supplementary Figures S19&#x02013;S22). While voom had a slightly higher area under the ROC curve and correlation with Nanostring <italic>P</italic>-values, edgeR again performed best overall, with the highest accuracy at <italic>P</italic> &#x0003c; 0.01. Of note, however, Cuffdiff proved to have the highest sensitivity at <italic>P</italic> &#x0003c; 0.01, despite being less accurate overall (Sleuth was not tested here because it does not perform gene-level differential expression, and the Nanostring panel had too few differentially-expressed probes hybridizing with a single transcript to perform a meaningful test at the transcript-level).</p><p>To further confirm these results and extend them to a context where isoform deconvolution is particularly challenging, we ran the same analysis methods on the simulated dataset (Figure <xref ref-type="fig" rid="F4">4F</xref>). As expected, using transcript-level quantification from featureCounts resulted in a major loss of accuracy, and we therefore focused on Cufflinks quantifications. In contrast to the spike-ins, in this context voom had the worst performance, and while edgeR gave the best performance, it was closely followed by Cuffdiff, which was superior to DESeq2 and voom.</p></sec><sec id="SEC3-10"><title>Differential expression analysis within and across SEQC data</title><p>Given the contrasting results of Cuffdiff and Sleuth across the different datasets, we extended our tests by reanalyzing the SEQC data (<xref rid="B9" ref-type="bibr">9</xref>), which include transcriptomes from two human RNA samples (&#x02018;A&#x02019; and &#x02018;B&#x02019;, respectively standing for the Universal Human Reference RNA and the Human Brain Reference RNA), as well as from two mixtures of those samples (&#x02018;C&#x02019; and &#x02018;D&#x02019;) in known ratios (respectively 3:1 and 1:3), each with five replicates. In contrast to the previous cases (Nanostring, spike-ins, and simulated data), here the true differential expression is not known, and the working assumption behind this dataset is that a detected differential expression between groups (i.e. mixtures) is putatively true, while a detected differential expression within groups (i.e. between replicates of a given sample) is a false positive. Therefore, plotting the number of genes in both comparisons that are below a sliding nominal false-discovery rate (FDR) threshold gives a picture analogous to the ROC curve, which we call here a &#x02018;positives' curve&#x02019; (see Supplementary Figures S23&#x02013;S26). Of note, the RNA mixtures are very different from one another, and the high degree of replication makes this a rather simple task for differential expression analysis. For this reason, we recommend focusing on the (slightly more subtle) C versus D comparison.</p><p>Given that, in this context, the number of differentially-expressed genes/transcripts is unknown, we compared for each method the area under the positives' curve, and the actual false-discovery rate when using a nominal FDR threshold of 0.05 (Figure <xref ref-type="fig" rid="F4">4G</xref>&#x02013;<xref ref-type="fig" rid="F4">H</xref>; an equivalent of this Figure using instead unadjusted <italic>P</italic>-values in available in Supplementary Figure S27). We compared these values when performing the analysis at the level of transcripts (Figure <xref ref-type="fig" rid="F4">4G</xref>) or genes (Figure <xref ref-type="fig" rid="F4">4H</xref>), and when using all five or only a subset (<xref rid="B3" ref-type="bibr">3</xref>) of the replicates. EdgeR and voom had overall the best area under the positives' curve. Although Cuffdiff generally had a poor area under the positives' curve, it systematically had the lowest FDR (reporting no false positive), closely followed by voom and, at the transcript level, Sleuth. A possible explanation is that Cuffdiff and Sleuth use information ignored by other approaches (namely the bootstrap samples for Sleuth and the uncertainty in count estimates for Cuffdiff), which could improve their performance especially at the transcript level and with low counts or replicates. Indeed, at the transcript-level with only three replicates, the beginning of the positives' curve shows for Cuffdiff and Sleuth a greatly improved performance (see especially right panels of Supplementary Figure S30), which diminishes however upon increasing the threshold. Nevertheless, in this assay voom had the best performance, with a FDR closely matching that of Cuffdiff and Sleuth, and an area under the positives' curve on a par with edgeR (Figure <xref ref-type="fig" rid="F4">4G</xref>&#x02013;<xref ref-type="fig" rid="F4">H</xref>).</p><p>Given the assumption underlying the SEQC analysis that any detected differential expression between cell lines is true (<xref rid="B9" ref-type="bibr">9</xref>), these results must be interpreted with care. However, in light of the previous results (Figure <xref ref-type="fig" rid="F4">4C</xref>&#x02013;<xref ref-type="fig" rid="F4">F</xref>), they suggest that the additional information used by Cuffdiff and Sleuth might increase performance of transcript-level differential expression in some contexts, and eventually lead to the development of methods that combine the robust statistical methods of voom and edgeR with this additional information.</p></sec><sec id="SEC3-11"><title>Effect of library type and size</title><p>To probe the impact of lower coverage on the accuracy of relative quantification, we performed a downsampling analysis using one pseudoalignment method (Salmon) and one alignment method (HISAT-Cufflinks). By and large, both methods were equally sensitive to coverage (Figure <xref ref-type="fig" rid="F5">5</xref>). Spike-in detection rate increased steadily with coverage without reaching a plateau (Figure <xref ref-type="fig" rid="F5">5A</xref>), while the transcript detection rate plateaued at around 40&#x02013;50% of the reads, which correspond to roughly 25&#x02013;30M pairs of reads (Figure <xref ref-type="fig" rid="F5">5C</xref>). The accuracy of relative quantification appeared instead to reach a plateau already at 30% of reads, or at about 19M reads (Figure <xref ref-type="fig" rid="F5">5B</xref>&#x02013;<xref ref-type="fig" rid="F5">D</xref>).</p><fig id="F5" orientation="portrait" position="float"><label>Figure 5.</label><caption><p>Downsampling analyses. Effect of downsampling coverage (i.e. library size) on spike-in detection rate (<bold>A</bold>), median absolute error in spike-in foldchange estimations (<bold>B</bold>), transcript detection rate (<bold>C</bold>), and transcript-wise z-score estimation (<bold>D</bold>), using both an alignment based method (HISAT-Cufflinks) and a pseudo-alignment method (Salmon). <bold>E-H:</bold> Effect of library type and read length on the correlation with Nanostring, specifically for transcript abundance estimates (<bold>E</bold> and <bold>F</bold>), transcript z-score estimates (<bold>G</bold>), and estimates of the ratio between EIF4H isoforms (<bold>H</bold>). (<bold>I</bold>) Effect of coverage on the detection of differences between the spike-in mixes.</p></caption><graphic xlink:href="gkw448fig5"/></fig><p>We next assessed the effect of library type and read size on the accuracy of the quantification. To emulate single-end reads, we aligned and analysed only the first mates of each read pair, while to emulate shorter reads, we trimmed the right-most 50 bp of all original reads. We then compared this derivative quantification with that obtained with the original reads. For transcript-level abundance estimates, 50 bp single-end reads proved highly inaccurate, with a very low correlation to Nanostring (Figure <xref ref-type="fig" rid="F5">5E</xref>) and a very high median absolute error (Figure <xref ref-type="fig" rid="F5">5F</xref>). A major part of this massive drop in correlation (0.4 compared to 0.9 and above for other library types) appears to be due to few undetected or under-estimated transcripts, especially for Salmon (Supplementary Figures S28&#x02013;S29). Nevertheless, the observation of the same pattern in median absolute error (where Salmon instead shows lower error than Cufflinks, see Figure <xref ref-type="fig" rid="F5">5F</xref>) suggests that the effect cannot entirely be attributed to those few transcripts. These results indicate that either long (100 bp) reads or paired reads are needed, with paired reads providing a slightly better improvement (Figure <xref ref-type="fig" rid="F5">5E</xref> and&#x000a0;<xref ref-type="fig" rid="F5">F</xref>). Of note, the respective improvements provided by longer or paired reads were not additive, but rather redundant. A similar pattern could be observed on the accuracy of relative transcript quantification (Figure <xref ref-type="fig" rid="F5">5G</xref>), with paired-reads again providing the best relative quantification, although differences in this case were much smaller. However, when we measured the capacity of the different libraries to detect the ratio between the two expressed isoforms of EIF4H (independently measured by two Nanostring probes), it was instead read size that had the strongest impact (Figure <xref ref-type="fig" rid="F5">5H</xref>). Together, these results suggest that either long (100 bp) or paired reads are very important for transcript-level quantification, but that they offer improvements that are partially redundant&#x000a0;with each other.</p><p>Finally, we assessed the extent to which library size affected each DEA method (Figure <xref ref-type="fig" rid="F5">5I</xref>). Since the downsampling analysis had suggested that 30% of the reads were sufficient for accurate quantification, we tested differential expression analysis when using 100%, 30% and 10% of the reads. DESeq2 and edgeR were most affected by the loss in coverage, closely followed by Cuffdiff. Sleuth and voom were less affected, with Sleuth showing very little reduction of accuracy with 30% of the reads, and only dropping when using 10%.</p></sec><sec id="SEC3-12"><title>Time and memory requirements</title><p>Finally, in order to assess the computing resources required by each software, we measured the actual real time of computation (wall clock time using eight cores) and the maximum peak of RAM memory used by each software for processing each sample (Supplementary Figure S30). A first major distinction must be made between alignment-based and pseudo-alignment based pipelines, with the former requiring considerably more time. Among the aligners, the best results were obtained by HISAT and STAR, taking &#x0223c;1 h per sample, while Tophat required 9 times as long. For quantification, Cuffquant required &#x0223c;7 h per sample, while featureCounts's average time was less than 45 minutes per sample. RSEM, which performs both alignment and quantification, performed better than any pipeline involving Cuffquant. All pseudo-alignment software outperformed alignment-based methods, and in particular Sailfish was the fastest with around 7 minutes per sample, roughly half of the time required by Kallisto and Salmon (disabling bootstraps). Finally, Salmon was considerably faster than Kallisto at generating bootstraps samples, merely scaling linearly while Kallisto took over a day per sample with 10 bootstraps.</p><p>Memory consumption is a major problem for STAR, which required over 32GB of RAM. All the other aligners required a reasonable amount of memory, with HISAT performing slightly better than Tophat. Cuffquant had a peak consumption of almost 7GB, while featureCounts had a very low memory footprint. Among pseudo-aligners, Sailfish was the most demanding with a peak memory requirement of 5GB.</p><p>Given that differential expression software ran relatively fast, we did not compile or compare their processing time and requirements.</p></sec></sec><sec sec-type="discussion" id="SEC4"><title>DISCUSSION</title><p>Relative (i.e. across-samples) quantification is critical for most RNAseq applications, especially given the increasing prominence of transcriptomics in the unravelling of human diseases and the attending need to capture meaningful relative differences within large cohorts of often highly heterogeneous samples. Here, we have shown that the methods providing the best absolute quantification (i.e. across-genes within individual samples) are not necessarily those that provide good relative quantification. Consequently, benchmarking should pay more attention to relative differences across samples, focusing on gene- and transcript-wise foldchanges and <italic>z</italic>-scores, as we have done here, or using other approaches (<xref rid="B40" ref-type="bibr">40</xref>).</p><p>This approach allowed us to note that although methods based on counting reads/fragments unambiguously overlapping a feature systematically give worse absolute quantifications than alternatives, they provide equal or even superior results for assessing relative expression at the gene-level, warranting their use for gene-level differential expression analysis. At the transcript-level, Cufflinks, RSEM and Salmon had a comparable performance, with RSEM being superior for absolute (but not relative) quantification. It is particularly noteworthy that Salmon, which (like Sailfish and Kallisto) bypasses traditional alignment and thereby quantifies a single sample in a matter of minutes, had a comparable performance to Cufflinks and RSEM. Importantly, we confirmed these results using a variety of assays on both empirical and simulated data.</p><p>We next benchmarked differential expression analysis methods. Most popular methods gave fairly good results, and while relevant differences could be observed, all benchmarks did not uniformly agree, which again shows the necessity of a plurality of assays to compare these methods. Nevertheless, we can say that in general voom and edgeR showed the most stable performance, being superior to alternatives in most assays, with voom significantly underperforming only in the (highly challenging) transcript-level simulation (Figure <xref ref-type="fig" rid="F4">4F</xref>), and edgeR showing suboptimal results only in the SEQC dataset (Figure <xref ref-type="fig" rid="F4">4G</xref>-<xref ref-type="fig" rid="F4">H</xref>). In a few of the tests (especially at lower coverage or sample size), Sleuth and Cuffdiff appeared promising for transcript-level analysis, but overall they proved inferior to alternative methods. This suggests that further development might allow to harness the additional information used by Sleuth and Cuffdiff within a more robust statistical framework.</p><p>Finally, we studied the effect of library size and type on the accuracy of RNAseq quantification, and showed that either long (100 bp) reads or (slightly better) paired reads were needed for transcript-level quantification, although the respective improvements provided are partially redundant with each other. Indeed, using single-end 50 bp reads resulted in a massive drop in correlation with Nanostring and a corresponding increase in median absolute error (Figure <xref ref-type="fig" rid="F5">5E</xref> and&#x000a0;<xref ref-type="fig" rid="F5">F</xref>). Instead, coverage had little impact on quantification above a certain minimum (roughly 20M reads with this experimental design), a relatively small impact on DEA, but a considerable impact on the capacity to detect spike-ins, which had not yet plateaued at full library size. This suggests that although high coverage might improve detection and quantification of rare transcripts, it is not particularly useful for the quantification of most of the transcriptome. Obviously, coverage might still be useful for other purposes, such as transcript assembly, study of RNA editing, etc., but in general it seems much preferable to invest in paired libraries and/or longer reads.</p><p>Most packages include a variety of options, whose multiple combinations clearly escape the range of tests we could perform. In addition, new methods are continually being released. For this reason, we created a R package, as well as an online platform, enabling researchers to apply the same extensive benchmarking we have performed to their pipeline of choice by simply uploading the quantification. The platform produces and displays above 30 diagnostic plots for each pipeline uploaded, and allows the comparison of a large array of accuracy measurements (including correlations and median absolute errors of values, foldchanges and feature-wise z-scores) across methods, thereby providing a rich resource for continued benchmarking efforts.</p><p>By design this benchmarking resource cannot settle all aspects of RNAseq analysis. In particular, it cannot assess normalization methods because the Nanostring quantification relies on housekeeping genes for normalization; similarly, it cannot test the impact of different transcriptome annotations or assembly methods, because the Nanostring panel was built and defined on the basis of Refseq transcripts. Further efforts, and different resources, will therefore be required to address these issues. One such resource was published during the revision of this manuscript (<xref rid="B40" ref-type="bibr">40</xref>), featuring a complementary benchmarking platform for relative RNAseq quantification, based on standard deviation for assessing accuracy of relative expression estimates. The method was used to compare popular quantification pipelines, yielding conclusions consistent with our results, such as a comparatively small effect of the alignment method, and a very good performance of RSEM and Salmon. Of note, however, their analysis rests on very different empirical evidence, with a first dataset composed of few (<xref rid="B4" ref-type="bibr">4</xref>) samples probed by microarrays to detect real biological differences, and a second based on simulated differential-expression added to real transcriptomes. Moreover, their package is explicitly not designed to assess DEA methods. Therefore, the resource we offer here is comparatively broader, richer in empirical data, and based on a larger set of tests and metrics. Nevertheless, as each benchmark carries its own limitations, a careful assessment of RNAseq analyses methods benefits from a plurality of benchmarking resources.</p></sec>
<sec sec-type="supplementary-material">
<title>Supplementary Material</title>
<supplementary-material id="PMC_1" content-type="local-data">
<caption>
<title>SUPPLEMENTARY DATA</title>
</caption>
<media mimetype="text" mime-subtype="html" xlink:href="supp_44_11_5054__index.html"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_gkw448_nar-00132-n-2016-File007.pdf"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_gkw448_nar-00132-n-2016-File008.pdf"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel"
xlink:href="supp_gkw448_nar-00132-n-2016-File009.xls"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel"
xlink:href="supp_gkw448_nar-00132-n-2016-File011.xlsx"/>
<media xlink:role="associated-file" mimetype="text" mime-subtype="plain"
xlink:href="supp_gkw448_nar-00132-n-2016-File012.tsv"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_gkw448_nar-00132-n-2016-File013.pdf"/>
<media xlink:role="associated-file" mimetype="text" mime-subtype="plain"
xlink:href="supp_gkw448_nar-00132-n-2016-File014.csv"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_gkw448_STable3.pdf"/>
</supplementary-material>
</sec>
</body><back><ack><p>We wish to thank Alessandro Ogier for his precious help in troubleshooting software compilation and server settings.</p><p><italic>Authors' contributions:</italic> PLG designed the benchmark and wrote the code. PLG, AV and GT wrote the paper. PLG and AV performed the analyses and created the figures. AA performed the selection and the primary analysis of the Nanostring data. PLG, AV, PL and VD ran the different pipelines. VD generated the simulated dataset. PLG and GT conceived and supervised the project.</p></ack><fn-group><fn id="FN1" fn-type="present-address"><p>Present address: Antonio Adamo, Biological and Environmental Sciences and Engineering Division, King Abdullah University of Science and Technology, Thuwal, 23955-6900, Kingdom of Saudi Arabia.</p></fn></fn-group><sec id="SEC5"><title>SUPPLEMENTARY DATA</title><p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/lookup/suppl/doi:10.1093/nar/gkw448/-/DC1">Supplementary Data</ext-link> are available at NAR Online.</p></sec><sec id="SEC6"><title>FUNDING</title><p>European Research Council [616441 &#x02013; DISEASEAVATARS to G.T.]; Regione Lombardia (Ricerca Indipendente 2012); Italian Ministry of Health (Ricerca Corrente to G.T.); ERA-NET Neuron Program (to G.T. and P.L.G.); Italian Association for Cancer Research (to G.T.); EPIGEN Flagship Project of the Italian National Research Council (to G.T.); Jerome-Lejeune Foundation (to G.T.); Umberto Veronesi Foundation (fellowship to P.L.G.); Federation of European Biochemical Societies (to A.A.); Italian Foundation for Cancer Research (to P.L. and V.D.). Funding for open access charge: ERC Research Grant DISEASEAVATARS [616441].</p><p><italic>Conflict of interest statement</italic>. None declared.</p></sec><ref-list><title>REFERENCES</title><ref id="B1"><label>1.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Engstr&#x000f6;m</surname><given-names>P.G.</given-names></name><name><surname>Steijger</surname><given-names>T.</given-names></name><name><surname>Sipos</surname><given-names>B.</given-names></name><name><surname>Grant</surname><given-names>G.R.</given-names></name><name><surname>Kahles</surname><given-names>A.</given-names></name><name><surname>R&#x000e4;tsch</surname><given-names>G.</given-names></name><name><surname>Goldman</surname><given-names>N.</given-names></name><name><surname>Hubbard</surname><given-names>T.</given-names></name><name><surname>Harrow</surname><given-names>J.</given-names></name><name><surname>Guig&#x000f3;</surname><given-names>R.</given-names></name><etal/></person-group>
<article-title>Systematic evaluation of spliced alignment programs for RNA-seq data</article-title>
<source>Nat. Methods</source>
<year>2013</year>
<volume>10</volume>
<fpage>1185</fpage><lpage>1191</lpage><pub-id pub-id-type="pmid">24185836</pub-id></element-citation></ref><ref id="B2"><label>2.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Seyednasrollah</surname><given-names>F.</given-names></name><name><surname>Laiho</surname><given-names>A.</given-names></name><name><surname>Elo</surname><given-names>L.L.</given-names></name></person-group>
<article-title>Comparison of software packages for detecting differential expression in RNA-seq studies</article-title>
<source>Brief. Bioinformatics</source>
<year>2013</year>
<volume>16</volume>
<fpage>1</fpage><lpage>12</lpage><pub-id pub-id-type="pmid">24300111</pub-id></element-citation></ref><ref id="B3"><label>3.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C.</given-names></name><name><surname>Delorenzi</surname><given-names>M.</given-names></name></person-group>
<article-title>A comparison of methods for differential expression analysis of RNA-seq data</article-title>
<source>BMC Bioinformatics</source>
<year>2013</year>
<volume>14</volume>
<fpage>91</fpage><pub-id pub-id-type="pmid">23497356</pub-id></element-citation></ref><ref id="B4"><label>4.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Kanitz</surname><given-names>A.</given-names></name><name><surname>Gypas</surname><given-names>F.</given-names></name><name><surname>Gruber</surname><given-names>A.J.</given-names></name><name><surname>Gruber</surname><given-names>A.R.</given-names></name><name><surname>Martin</surname><given-names>G.</given-names></name><name><surname>Zavolan</surname><given-names>M.</given-names></name></person-group>
<article-title>Comparative assessment of methods for the computational inference of transcript isoform abundance from RNA-seq data</article-title>
<source>Genome Biol.</source>
<year>2015</year>
<volume>16</volume>
<fpage>1</fpage><lpage>26</lpage><pub-id pub-id-type="pmid">25583448</pub-id></element-citation></ref><ref id="B5"><label>5.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Pertea</surname><given-names>M.</given-names></name><name><surname>Pertea</surname><given-names>G.M.</given-names></name><name><surname>Antonescu</surname><given-names>C.M.</given-names></name><name><surname>Chang</surname><given-names>T.-C.</given-names></name><name><surname>Mendell</surname><given-names>J.T.</given-names></name><name><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group>
<article-title>StringTie enables improved reconstruction of a transcriptome from RNA-seq reads</article-title>
<source>Nat. Biotechnol.</source>
<year>2015</year>
<volume>33</volume>
<fpage>290</fpage><lpage>295</lpage><pub-id pub-id-type="pmid">25690850</pub-id></element-citation></ref><ref id="B6"><label>6.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Rapaport</surname><given-names>F.</given-names></name><name><surname>Khanin</surname><given-names>R.</given-names></name><name><surname>Liang</surname><given-names>Y.</given-names></name><name><surname>Pirun</surname><given-names>M.</given-names></name><name><surname>Krek</surname><given-names>A.</given-names></name><name><surname>Zumbo</surname><given-names>P.</given-names></name><name><surname>Mason</surname><given-names>C.</given-names></name><name><surname>Socci</surname><given-names>N.</given-names></name><name><surname>Betel</surname><given-names>D.</given-names></name></person-group>
<article-title>Comprehensive evaluation of differential gene expression analysis methods for RNA-seq data</article-title>
<source>Genome Biol.</source>
<year>2013</year>
<volume>14</volume>
<fpage>R95</fpage><pub-id pub-id-type="pmid">24020486</pub-id></element-citation></ref><ref id="B7"><label>7.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Rehrauer</surname><given-names>H.</given-names></name><name><surname>Opitz</surname><given-names>L.</given-names></name><name><surname>Tan</surname><given-names>G.</given-names></name></person-group>
<article-title>Blind spots of quantitative RNA-seq: the limits for assessing abundance, differential expression, and isoform switching</article-title>
<source>BMC Bioinformatics</source>
<year>2013</year>
<volume>14</volume>
<fpage>1</fpage><lpage>10</lpage><pub-id pub-id-type="pmid">23323762</pub-id></element-citation></ref><ref id="B8"><label>8.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Munro</surname><given-names>S.</given-names></name><name><surname>Lund</surname><given-names>S.</given-names></name><name><surname>Pine</surname><given-names>P.</given-names></name><name><surname>Binder</surname><given-names>H.</given-names></name><name><surname>Clevert</surname><given-names>D.-A.</given-names></name><name><surname>Conesa</surname><given-names>A.</given-names></name><name><surname>Dopazo</surname><given-names>J.</given-names></name><name><surname>Fasold</surname><given-names>M.</given-names></name><name><surname>Hochreiter</surname><given-names>S.</given-names></name><name><surname>Hong</surname><given-names>H.</given-names></name><etal/></person-group>
<article-title>Assessing technical performance in differential gene expression experiments with external spike-in RNA control ratio mixtures</article-title>
<source>Nat. Commun.</source>
<year>2014</year>
<volume>5</volume>
<fpage>5125</fpage><pub-id pub-id-type="pmid">25254650</pub-id></element-citation></ref><ref id="B9"><label>9.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Su</surname><given-names>Z.</given-names></name><name><surname>&#x00141;abaj</surname><given-names>P.</given-names></name><name><surname>Li</surname><given-names>S.</given-names></name><name><surname>Thierry-Mieg</surname><given-names>J.</given-names></name><name><surname>Thierry-Mieg</surname><given-names>D.</given-names></name><name><surname>Shi</surname><given-names>W.</given-names></name><name><surname>Wang</surname><given-names>C.</given-names></name><name><surname>Schroth</surname><given-names>G.</given-names></name><name><surname>Setterquist</surname><given-names>R.</given-names></name><name><surname>Thompson</surname><given-names>J.</given-names></name><etal/></person-group>
<article-title>A comprehensive assessment of RNA-seq accuracy, reproducibility and information content by the Sequencing Quality Control Consortium</article-title>
<source>Nat. Biotechnol.</source>
<year>2014</year>
<volume>32</volume>
<fpage>903</fpage><lpage>914</lpage><pub-id pub-id-type="pmid">25150838</pub-id></element-citation></ref><ref id="B10"><label>10.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Rajkumar</surname><given-names>A.P.</given-names></name><name><surname>Qvist</surname><given-names>P.</given-names></name><name><surname>Lazarus</surname><given-names>R.</given-names></name><name><surname>Lescai</surname><given-names>F.</given-names></name><name><surname>Ju</surname><given-names>J.</given-names></name><name><surname>Nyegaard</surname><given-names>M.</given-names></name><name><surname>Mors</surname><given-names>O.</given-names></name><name><surname>B&#x000f8;rglum</surname><given-names>A.D.</given-names></name><name><surname>Li</surname><given-names>Q.</given-names></name><name><surname>Christensen</surname><given-names>J.H.</given-names></name></person-group>
<article-title>Experimental validation of methods for differential gene expression analysis and sample pooling in RNA-seq</article-title>
<source>BMC Genomics</source>
<year>2015</year>
<volume>16</volume>
<fpage>548</fpage><pub-id pub-id-type="pmid">26208977</pub-id></element-citation></ref><ref id="B11"><label>11.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Robert</surname><given-names>C.</given-names></name><name><surname>Watson</surname><given-names>M.</given-names></name></person-group>
<article-title>Errors in RNA-Seq quantification affect genes of relevance to human disease</article-title>
<source>Genome Biol.</source>
<year>2015</year>
<volume>16</volume>
<fpage>177</fpage><pub-id pub-id-type="pmid">26335491</pub-id></element-citation></ref><ref id="B12"><label>12.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Zhao</surname><given-names>S.</given-names></name><name><surname>Zhang</surname><given-names>B.</given-names></name></person-group>
<article-title>A comprehensive evaluation of ensembl, RefSeq, and UCSC annotations in the context of RNA-seq read mapping and gene quantification</article-title>
<source>BMC Genomics</source>
<year>2015</year>
<volume>16</volume>
<fpage>1</fpage><lpage>14</lpage><pub-id pub-id-type="pmid">25553907</pub-id></element-citation></ref><ref id="B13"><label>13.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C.</given-names></name><name><surname>Hendrickson</surname><given-names>D.G.</given-names></name><name><surname>Sauvageau</surname><given-names>M.</given-names></name><name><surname>Goff</surname><given-names>L.</given-names></name><name><surname>Rinn</surname><given-names>J.L.</given-names></name><name><surname>Pachter</surname><given-names>L.</given-names></name></person-group>
<article-title>Differential analysis of gene regulation at transcript resolution with RNA-seq</article-title>
<source>Nat. Biotechnol.</source>
<year>2012</year>
<volume>31</volume>
<fpage>46</fpage><lpage>53</lpage><pub-id pub-id-type="pmid">23222703</pub-id></element-citation></ref><ref id="B14"><label>14.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C.</given-names></name><name><surname>Love</surname><given-names>M.I.</given-names></name><name><surname>Robinson</surname><given-names>M.D.</given-names></name></person-group>
<article-title>Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences</article-title>
<source>F1000Research</source>
<year>2016</year>
<volume>4</volume>
<fpage>1521</fpage><pub-id pub-id-type="pmid">26925227</pub-id></element-citation></ref><ref id="B15"><label>15.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Zhou</surname><given-names>X.</given-names></name><name><surname>Robinson</surname><given-names>M.D.</given-names></name></person-group>
<article-title>Do count-based differential expression methods perform poorly when genes are expressed in only one condition?</article-title>
<source>Genome Biol.</source>
<year>2015</year>
<volume>16</volume>
<fpage>222</fpage><pub-id pub-id-type="pmid">26450178</pub-id></element-citation></ref><ref id="B16"><label>16.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Soneson</surname><given-names>C.</given-names></name><name><surname>Matthes</surname><given-names>K.L.</given-names></name><name><surname>Nowicka</surname><given-names>M.</given-names></name><name><surname>Law</surname><given-names>C.W.</given-names></name><name><surname>Robinson</surname><given-names>M.D.</given-names></name></person-group>
<article-title>Isoform pre-filtering improves performance of count-based methods</article-title>
<source>Genome Biol.</source>
<year>2016</year>
<volume>17</volume>
<fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="pmid">26753840</pub-id></element-citation></ref><ref id="B17"><label>17.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Patro</surname><given-names>R.</given-names></name><name><surname>Mount</surname><given-names>S.M.</given-names></name><name><surname>Kingsford</surname><given-names>C.</given-names></name></person-group>
<article-title>Sailfish enables alignment-free isoform quantification from RNA-seq reads using lightweight algorithms</article-title>
<source>Nat. Biotechnol.</source>
<year>2014</year>
<volume>32</volume>
<fpage>462</fpage><lpage>464</lpage><pub-id pub-id-type="pmid">24752080</pub-id></element-citation></ref><ref id="B18"><label>18.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z.</given-names></name><name><surname>Gerstein</surname><given-names>M.</given-names></name><name><surname>Snyder</surname><given-names>M.</given-names></name></person-group>
<article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>
<source>Nat. Rev. Genet.</source>
<year>2009</year>
<volume>10</volume>
<fpage>57</fpage><lpage>63</lpage><pub-id pub-id-type="pmid">19015660</pub-id></element-citation></ref><ref id="B19"><label>19.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Wang</surname><given-names>C.</given-names></name><name><surname>Gong</surname><given-names>B.</given-names></name><name><surname>Bushel</surname><given-names>P.R.</given-names></name><name><surname>Thierry-Mieg</surname><given-names>J.</given-names></name><name><surname>Thierry-Mieg</surname><given-names>D.</given-names></name><name><surname>Xu</surname><given-names>J.</given-names></name><name><surname>Tong</surname><given-names>W.</given-names></name></person-group>
<article-title>The concordance between RNA-seq and microarray data depends on chemical treatment and transcript abundance</article-title>
<source>Nat. Biotechnol.</source>
<year>2014</year>
<volume>32</volume>
<fpage>926</fpage><lpage>932</lpage><pub-id pub-id-type="pmid">25150839</pub-id></element-citation></ref><ref id="B20"><label>20.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Tong</surname><given-names>W.</given-names></name><name><surname>Lucas</surname><given-names>A.</given-names></name><name><surname>Shippy</surname><given-names>R.</given-names></name><name><surname>Fan</surname><given-names>X.</given-names></name><name><surname>Fang</surname><given-names>H.</given-names></name><name><surname>Hong</surname><given-names>H.</given-names></name><name><surname>Orr</surname><given-names>M.</given-names></name><name><surname>Chu</surname><given-names>T.</given-names></name><name><surname>Guo</surname><given-names>X.</given-names></name><name><surname>Collins</surname><given-names>P.</given-names></name><etal/></person-group>
<article-title>Evaluation of external RNA controls for the assessment of microarray performance</article-title>
<source>Nat. Biotechnol.</source>
<year>2006</year>
<volume>24</volume>
<fpage>1132</fpage><lpage>1139</lpage><pub-id pub-id-type="pmid">16964227</pub-id></element-citation></ref><ref id="B21"><label>21.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Geiss</surname><given-names>G.</given-names></name><name><surname>Bumgarner</surname><given-names>R.</given-names></name><name><surname>Birditt</surname><given-names>Brian</given-names></name><name><surname>Dahl</surname><given-names>T.</given-names></name><name><surname>Dowidar</surname><given-names>N.</given-names></name><name><surname>Dunaway</surname><given-names>D.</given-names></name><name><surname>Fell</surname><given-names>H.</given-names></name><name><surname>Ferree</surname><given-names>S.</given-names></name><name><surname>George</surname><given-names>R.</given-names></name><name><surname>Grogan</surname><given-names>T.</given-names></name><etal/></person-group>
<article-title>Direct multiplexed measurement of gene expression with color-coded probe pairs</article-title>
<source>Nat. Biotechnol.</source>
<year>2008</year>
<volume>26</volume>
<fpage>317</fpage><lpage>325</lpage><pub-id pub-id-type="pmid">18278033</pub-id></element-citation></ref><ref id="B22"><label>22.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C.</given-names></name><name><surname>Roberts</surname><given-names>A.</given-names></name><name><surname>Goff</surname><given-names>L.</given-names></name><name><surname>Pertea</surname><given-names>G.</given-names></name><name><surname>Kim</surname><given-names>D.</given-names></name><name><surname>Kelley</surname><given-names>D.R.</given-names></name><name><surname>Pimentel</surname><given-names>H.</given-names></name><name><surname>Salzberg</surname><given-names>S.</given-names></name><name><surname>Rinn</surname><given-names>J.</given-names></name><name><surname>Pachter</surname><given-names>L.</given-names></name></person-group>
<article-title>Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cufflinks</article-title>
<source>Nat. Protoc.</source>
<year>2012</year>
<volume>7</volume>
<fpage>562</fpage><lpage>578</lpage><pub-id pub-id-type="pmid">22383036</pub-id></element-citation></ref><ref id="B23"><label>23.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Dobin</surname><given-names>A.</given-names></name><name><surname>Davis</surname><given-names>C.A.</given-names></name><name><surname>Schlesinger</surname><given-names>F.</given-names></name><name><surname>Drenkow</surname><given-names>J.</given-names></name><name><surname>Zaleski</surname><given-names>C.</given-names></name><name><surname>Jha</surname><given-names>S.</given-names></name><name><surname>Batut</surname><given-names>P.</given-names></name><name><surname>Chaisson</surname><given-names>M.</given-names></name><name><surname>Gingeras</surname><given-names>T.R.</given-names></name></person-group>
<article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
<source>Bioinformatics</source>
<year>2012</year>
<volume>29</volume>
<fpage>15</fpage><lpage>21</lpage><pub-id pub-id-type="pmid">23104886</pub-id></element-citation></ref><ref id="B24"><label>24.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Kim</surname><given-names>D.</given-names></name><name><surname>Langmead</surname><given-names>B.</given-names></name><name><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group>
<article-title>HISAT: a fast spliced aligner with low memory requirements</article-title>
<source>Nat. Methods</source>
<year>2015</year>
<volume>12</volume>
<fpage>357</fpage><lpage>360</lpage><pub-id pub-id-type="pmid">25751142</pub-id></element-citation></ref><ref id="B25"><label>25.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Wang</surname><given-names>K.</given-names></name><name><surname>Singh</surname><given-names>D.</given-names></name><name><surname>Zeng</surname><given-names>Z.</given-names></name><name><surname>Coleman</surname><given-names>S.J.</given-names></name><name><surname>Huang</surname><given-names>Y.</given-names></name><name><surname>Savich</surname><given-names>G.L.</given-names></name><name><surname>He</surname><given-names>X.</given-names></name><name><surname>Mieczkowski</surname><given-names>P.</given-names></name><name><surname>Grimm</surname><given-names>S.</given-names></name><name><surname>Perou</surname><given-names>C.</given-names></name><etal/></person-group>
<article-title>MapSplice: accurate mapping of RNA-seq reads for splice junction discovery</article-title>
<source>Nucleic Acids Res.</source>
<year>2010</year>
<volume>38</volume>
<fpage>e178</fpage><pub-id pub-id-type="pmid">20802226</pub-id></element-citation></ref><ref id="B26"><label>26.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Anders</surname><given-names>S.</given-names></name><name><surname>Pyl</surname><given-names>P.T.</given-names></name><name><surname>Huber</surname><given-names>W.</given-names></name></person-group>
<article-title>Genome analysis HTSeq &#x02014; a Python framework to work with high-throughput sequencing data</article-title>
<source>Bioinformatics</source>
<year>2015</year>
<volume>31</volume>
<fpage>166</fpage><lpage>169</lpage><pub-id pub-id-type="pmid">25260700</pub-id></element-citation></ref><ref id="B27"><label>27.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Liao</surname><given-names>Y.</given-names></name><name><surname>Smyth</surname><given-names>G.K.</given-names></name><name><surname>Shi</surname><given-names>W.</given-names></name></person-group>
<article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>
<source>Bioinformatics</source>
<year>2013</year>
<volume>30</volume>
<fpage>923</fpage><lpage>930</lpage><pub-id pub-id-type="pmid">24227677</pub-id></element-citation></ref><ref id="B28"><label>28.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Li</surname><given-names>B.</given-names></name><name><surname>Ruotti</surname><given-names>V.</given-names></name><name><surname>Stewart</surname><given-names>R.M.</given-names></name><name><surname>Thomson</surname><given-names>J.A.</given-names></name><name><surname>Dewey</surname><given-names>C.N.</given-names></name></person-group>
<article-title>RNA-Seq gene expression estimation with read mapping uncertainty</article-title>
<source>Bioinformatics</source>
<year>2009</year>
<volume>26</volume>
<fpage>493</fpage><lpage>500</lpage><pub-id pub-id-type="pmid">20022975</pub-id></element-citation></ref><ref id="B29"><label>29.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B.</given-names></name><name><surname>Trapnell</surname><given-names>C.</given-names></name><name><surname>Pop</surname><given-names>M.</given-names></name><name><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group>
<article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
<source>Genome Biol.</source>
<year>2009</year>
<volume>10</volume>
<fpage>R25</fpage><pub-id pub-id-type="pmid">19261174</pub-id></element-citation></ref><ref id="B30"><label>30.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Anders</surname><given-names>S.</given-names></name><name><surname>Huber</surname><given-names>W.</given-names></name></person-group>
<article-title>Differential expression analysis for sequence count data</article-title>
<source>Genome Biol.</source>
<year>2010</year>
<volume>11</volume>
<fpage>R106</fpage><pub-id pub-id-type="pmid">20979621</pub-id></element-citation></ref><ref id="B31"><label>31.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Love</surname><given-names>M.I.</given-names></name><name><surname>Huber</surname><given-names>W.</given-names></name><name><surname>Anders</surname><given-names>S.</given-names></name></person-group>
<article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
<source>Genome Biol.</source>
<year>2014</year>
<volume>15</volume>
<fpage>1</fpage><lpage>34</lpage></element-citation></ref><ref id="B32"><label>32.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Law</surname><given-names>C.W.</given-names></name><name><surname>Chen</surname><given-names>Y.</given-names></name><name><surname>Shi</surname><given-names>W.</given-names></name><name><surname>Smyth</surname><given-names>G.K.</given-names></name></person-group>
<article-title>voom: Precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>
<source>Genome Biol.</source>
<year>2014</year>
<volume>15</volume>
<fpage>R29</fpage><pub-id pub-id-type="pmid">24485249</pub-id></element-citation></ref><ref id="B33"><label>33.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Ritchie</surname><given-names>M.E.</given-names></name><name><surname>Phipson</surname><given-names>B.</given-names></name><name><surname>Wu</surname><given-names>D.</given-names></name><name><surname>Hu</surname><given-names>Y.</given-names></name><name><surname>Law</surname><given-names>C.W.</given-names></name><name><surname>Shi</surname><given-names>W.</given-names></name><name><surname>Smyth</surname><given-names>G.K.</given-names></name></person-group>
<article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>
<source>Nucleic Acids Res.</source>
<year>2015</year>
<volume>43</volume>
<fpage>e47</fpage><pub-id pub-id-type="pmid">25605792</pub-id></element-citation></ref><ref id="B34"><label>34.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Robinson</surname><given-names>M.D.</given-names></name><name><surname>McCarthy</surname><given-names>D.J.</given-names></name><name><surname>Smyth</surname><given-names>G.K.</given-names></name></person-group>
<article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
<source>Bioinformatics</source>
<year>2010</year>
<volume>26</volume>
<fpage>139</fpage><lpage>140</lpage><pub-id pub-id-type="pmid">19910308</pub-id></element-citation></ref><ref id="B35"><label>35.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Irizarry</surname><given-names>R.A.</given-names></name><name><surname>Wu</surname><given-names>Z.</given-names></name><name><surname>Jaffee</surname><given-names>H.A.</given-names></name></person-group>
<article-title>Comparison of Affymetrix GeneChip expression measures</article-title>
<source>Bioinformatics</source>
<year>2006</year>
<volume>22</volume>
<fpage>789</fpage><lpage>794</lpage><pub-id pub-id-type="pmid">16410320</pub-id></element-citation></ref><ref id="B36"><label>36.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Robinson</surname><given-names>M.D.</given-names></name><name><surname>Oshlack</surname><given-names>A.</given-names></name></person-group>
<article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>
<source>Genome Biology</source>
<year>2010</year>
<volume>11</volume>
<fpage>R25</fpage><pub-id pub-id-type="pmid">20196867</pub-id></element-citation></ref><ref id="B37"><label>37.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Frazee</surname><given-names>A.C.</given-names></name><name><surname>Jaffe</surname><given-names>A.E.</given-names></name><name><surname>Langmead</surname><given-names>B.</given-names></name><name><surname>Leek</surname><given-names>J.T.</given-names></name></person-group>
<article-title>Polyester: simulating RNA-seq datasets with differential transcript expression</article-title>
<source>Bioinformatics</source>
<year>2015</year>
<volume>31</volume>
<fpage>2778</fpage><lpage>2784</lpage><pub-id pub-id-type="pmid">25926345</pub-id></element-citation></ref><ref id="B38"><label>38.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Li</surname><given-names>H.</given-names></name><name><surname>Handsaker</surname><given-names>B.</given-names></name><name><surname>Wysoker</surname><given-names>A.</given-names></name><name><surname>Fennell</surname><given-names>T.</given-names></name><name><surname>Ruan</surname><given-names>J.</given-names></name><name><surname>Homer</surname><given-names>N.</given-names></name><name><surname>Marth</surname><given-names>G.</given-names></name><name><surname>Abecasis</surname><given-names>G.</given-names></name><name><surname>Durbin</surname><given-names>R.</given-names></name><collab>1000 Genome Project Data Processing Subgroup</collab></person-group>
<article-title>The sequence Alignment/Map format and SAMtools</article-title>
<source>Bioinformatics</source>
<year>2009</year>
<volume>25</volume>
<fpage>2078</fpage><lpage>2079</lpage><pub-id pub-id-type="pmid">19505943</pub-id></element-citation></ref><ref id="B39"><label>39.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Adamo</surname><given-names>A.</given-names></name><name><surname>Atashpaz</surname><given-names>S.</given-names></name><name><surname>Germain</surname><given-names>P.-L.</given-names></name><name><surname>Zanella</surname><given-names>M.</given-names></name><name><surname>D'Agostino</surname><given-names>G.</given-names></name><name><surname>Albertin</surname><given-names>V.</given-names></name><name><surname>Chenoweth</surname><given-names>J.</given-names></name><name><surname>Micale</surname><given-names>L.</given-names></name><name><surname>Fusco</surname><given-names>C.</given-names></name><name><surname>Unger</surname><given-names>C.</given-names></name><etal/></person-group>
<article-title>7q11.23 dosage-dependent dysregulation in human pluripotent stem cells affects transcriptional programs in disease-relevant lineages</article-title>
<source>Nat. Genet.</source>
<year>2015</year>
<volume>47</volume>
<fpage>132</fpage><lpage>141</lpage><pub-id pub-id-type="pmid">25501393</pub-id></element-citation></ref><ref id="B40"><label>40.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Teng</surname><given-names>M.</given-names></name><name><surname>Love</surname><given-names>M.I.</given-names></name><name><surname>Davis</surname><given-names>C.A.</given-names></name><name><surname>Djebali</surname><given-names>S.</given-names></name><name><surname>Dobin</surname><given-names>A.</given-names></name><name><surname>Graveley</surname><given-names>B.R.</given-names></name><etal/></person-group>
<article-title>A benchmark for RNA-seq quantification pipelines</article-title>
<source>Genome Biol.</source>
<year>2016</year>
<volume>17</volume>
<fpage>74</fpage><pub-id pub-id-type="pmid">27107712</pub-id></element-citation></ref></ref-list></back></article>