<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d2 20140930//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 39.96?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">ISRN Bioinform</journal-id><journal-id journal-id-type="iso-abbrev">ISRN Bioinform</journal-id><journal-id journal-id-type="publisher-id">ISRN.BIOINFORMATICS</journal-id><journal-title-group><journal-title>ISRN bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">2090-7338</issn><issn pub-type="epub">2090-7346</issn><publisher><publisher-name>Hindawi Publishing Corporation</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4393068</article-id><article-id pub-id-type="doi">10.1155/2013/481545</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Stormbow: A Cloud-Based Tool for Reads Mapping and Expression Quantification in Large-Scale RNA-Seq Studies</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Zhao</surname><given-names>Shanrong</given-names></name><xref ref-type="aff" rid="I1"><sup>1</sup>
</xref><xref ref-type="corresp" rid="cor1">
<sup>*</sup>
</xref></contrib><contrib contrib-type="author"><name><surname>Prenger</surname><given-names>Kurt</given-names></name><xref ref-type="aff" rid="I2">
<sup>2</sup>
</xref></contrib><contrib contrib-type="author"><name><surname>Smith</surname><given-names>Lance</given-names></name><xref ref-type="aff" rid="I3">
<sup>3</sup>
</xref></contrib></contrib-group><aff id="I1"><sup>1</sup>Systems Pharmacology and Biomarkers, Janssen Research &#x00026; Development, LLC, 3210 Merryfield Row, San Diego, CA 92121, USA</aff><aff id="I2"><sup>2</sup>High Performance &#x00026; Scientific Computing, Janssen Research &#x00026; Development, LLC, 920 Route 202, Raritan, NJ 08869, USA</aff><aff id="I3"><sup>3</sup>Translational Informatics IT, Janssen Research &#x00026; Development, LLC, 3210 Merryfield Row, San Diego, CA 92121, USA</aff><author-notes><corresp id="cor1">*Shanrong Zhao: <email>shanrong_zhao@yahoo.com</email></corresp><fn fn-type="other"><p>Academic Editors: N. Lemke, K. Mizuguchi, O. Norberto de Souza, and J. T. L. Wang</p></fn></author-notes><pub-date pub-type="collection"><year>2013</year></pub-date><pub-date pub-type="epub"><day>11</day><month>9</month><year>2013</year></pub-date><volume>2013</volume><elocation-id>481545</elocation-id><history><date date-type="received"><day>8</day><month>7</month><year>2013</year></date><date date-type="accepted"><day>7</day><month>8</month><year>2013</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2013 Shanrong Zhao et al.</copyright-statement><copyright-year>2013</copyright-year><license license-type="open-access"><license-p>This is an open access article distributed under the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p>RNA-Seq is becoming a promising replacement to microarrays in transcriptome profiling and differential gene expression study. Technical improvements have decreased sequencing costs and, as a result, the size and number of RNA-Seq datasets have increased rapidly. However, the increasing volume of data from large-scale RNA-Seq studies poses a practical challenge for data analysis in a local environment. To meet this challenge, we developed Stormbow, a cloud-based software package, to process large volumes of RNA-Seq data in parallel. The performance of Stormbow has been tested by practically applying it to analyse 178 RNA-Seq samples in the cloud. In our test, it took 6 to 8 hours to process an RNA-Seq sample with 100 million reads, and the average cost was $3.50 per sample. Utilizing Amazon Web Services as the infrastructure for Stormbow allows us to easily scale up to handle large datasets with on-demand computational resources. Stormbow is a scalable, cost effective, and open-source based tool for large-scale RNA-Seq data analysis. Stormbow can be freely downloaded and can be used out of box to process Illumina RNA-Seq datasets.</p></abstract></article-meta></front><body><sec id="sec1"><title>1. Introduction</title><p>RNA-Seq is the direct sequencing of transcripts by high-throughput sequencing technology and can profile an entire transcriptome at single-base resolution whilst concurrently quantifying gene expression levels on a genome-wide scale [<xref rid="B1" ref-type="bibr">1</xref>&#x02013;<xref rid="B3" ref-type="bibr">3</xref>]. RNA-Seq not only has considerable advantages for examining transcriptome fine structure&#x02014;for example, in the detection of novel transcripts, allele-specific expression, and alternative splicing&#x02014;but also provides a far more precise measurement of levels of transcripts than that of other methods [<xref rid="B4" ref-type="bibr">4</xref>, <xref rid="B5" ref-type="bibr">5</xref>]. With no probes or primers to design, RNA-Seq delivers unbiased and unparalleled information about the transcriptome and gene expression. Early studies have demonstrated that RNA-Seq is very reliable in terms of technical reproducibility [<xref rid="B6" ref-type="bibr">6</xref>, <xref rid="B7" ref-type="bibr">7</xref>]. Compared to microarray-based profiling, RNA-Seq can detect the expression of low abundance transcripts and the subtle change under different conditions; has a wider dynamic range; and avoids technical issues in microarray related to probe performance such as cross-hybridization, limited detection range of individual probes, and nonspecific hybridization [<xref rid="B8" ref-type="bibr">8</xref>, <xref rid="B9" ref-type="bibr">9</xref>]. Currently, RNA-Seq is becoming an attractive approach in the profiling of gene expression and in evaluating differential expression [<xref rid="B10" ref-type="bibr">10</xref>&#x02013;<xref rid="B13" ref-type="bibr">13</xref>].</p><p>Until recently, sequencing has primarily been carried out in large genome centers which have invested heavily in computational infrastructure that enables genomic sequence analysis [<xref rid="B14" ref-type="bibr">14</xref>, <xref rid="B15" ref-type="bibr">15</xref>]. The recent advancements in sequencing technology have greatly decreased the sequencing costs and increased the size and number of datasets. As a consequence, larger amounts of sequence data are not only being produced at lower costs, but also being more often by small to midsize research groups. It is expected that clinical sequencing will become produced a part of the diagnostic routines shortly [<xref rid="B16" ref-type="bibr">16</xref>]. However, the enormous data from large-scale RNA-Seq studies poses a fundamental problem of data management and analysis in a local environment and requires increasingly complex computational methods [<xref rid="B17" ref-type="bibr">17</xref>]. Consequently, limited access to computational infrastructure and high-quality bioinformatics tools and the demand for personnel skilled in data analysis and interpretation remain a serious bottleneck for most researchers. </p><p>In recent years, cloud computing has emerged as a viable option to quickly and easily acquire computational resources for large-scale data analysis [<xref rid="B18" ref-type="bibr">18</xref>&#x02013;<xref rid="B22" ref-type="bibr">22</xref>]. Several cloud-based bioinformatics applications and resources have been developed specifically to address the challenges of working with the very large volumes of data generated by Next Generation Sequencing (NGS) technology, including CloudBurst [<xref rid="B23" ref-type="bibr">23</xref>], Crossbow [<xref rid="B24" ref-type="bibr">24</xref>], Myrna [<xref rid="B25" ref-type="bibr">25</xref>], CloVR [<xref rid="B26" ref-type="bibr">26</xref>], CloudAligner [<xref rid="B27" ref-type="bibr">27</xref>], and PeakRanger [<xref rid="B28" ref-type="bibr">28</xref>]. Cloud computing has created new possibilities to analyze NGS data at reasonable costs, especially for laboratories lacking a dedicated bioinformatics infrastructure. </p><p>Differential analysis of RNA-Seq data consists of three key steps [<xref rid="B10" ref-type="bibr">10</xref>]: (i) reads mapping; (ii) expression quantification; and (iii) statistical testing to determine significantly differential expressed (DE) genes. For statistical tests, several R-based packages have recently been developed specifically for DE analysis in RNA-Seq experiments, including DESeq [<xref rid="B29" ref-type="bibr">29</xref>], edgeR [<xref rid="B30" ref-type="bibr">30</xref>], and baySeq [<xref rid="B31" ref-type="bibr">31</xref>]. As an input, these algorithms take count data in the form of a rectangular table of integer values. The table cell in the <italic>i</italic>th row and the <italic>j</italic>th column of the table corresponds to the number of sequence reads mapped to gene <italic>i</italic> in sample <italic>j</italic>. To obtain such a count table, we need to generate it from the raw sequence reads, which is done by steps (i) and (ii) that are mentioned above. Both steps are very computationally intensive [<xref rid="B2" ref-type="bibr">2</xref>], especially for RNA-Seq studies in which hundreds or even thousands of samples are sequenced. </p><p>Stormbow, as described in this paper, is a cloud-based tool developed to meet the computational challenges in large-scale RNA-Seq data analysis and to significantly reduce the turnaround time in RNA-Seq data analysis. The tool simply takes raw sequence reads in FASTA format as inputs and generates a gene count table for large RNA-Seq studies in a very short time by processing individual RNA-Seq samples in parallel using the cloud. Stormbow is an extension of Rainbow [<xref rid="B32" ref-type="bibr">32</xref>], a software package that we developed for large-scale whole genome sequence data analysis in the cloud. Both Rainbow and Stormbow were developed to meet the computational challenges in large-scale genomic sequencing, with Rainbow for whole-genome sequencing while Stormbow for RNA-Seq. Stormbow can be freely downloaded from <ext-link ext-link-type="uri" xlink:href="http://s3.amazonaws.com/jnj_stormbow/index.html">http://s3.amazonaws.com/jnj_stormbow/index.html</ext-link>.</p></sec><sec id="sec2"><title>2. Materials and Methods</title><p>The architecture of Stormbow is shown in <xref ref-type="fig" rid="fig1">Figure 1</xref>. Amazon's Simple Storage Service (S3) [<xref rid="B33" ref-type="bibr">33</xref>] centralizes data storage. Stormbow comes with scripts that automate the Stormbow pipeline on Amazon's Elastic Compute Cloud (EC2) [<xref rid="B34" ref-type="bibr">34</xref>] utility computing service. The EC2 driver script can be run from any Linux computer with internet connection; however, all the computations are executed remotely by multiple EC2 instances in the cloud. Below, we describe the architectural design for Stormbow step by step.</p><sec id="sec2.1"><title>2.1. The Algorithm for Mapping Reads</title><p>There are multiple open-source based aligners available to mapping reads to a reference genome. With Stormbow, we wrap the Omicsoft Sequence Aligner (OSA) [<xref rid="B35" ref-type="bibr">35</xref>], a fast and accurate alignment tool for RNA-Seq, and run it in Amazon's cloud environment. Benchmarked with existing methods, such as TopHat [<xref rid="B36" ref-type="bibr">36</xref>], OSA improves mapping speed 4&#x02013;10<italic>x</italic> with better sensitivity and less false positives than similar tools. The detailed benchmarking results are reported at the OSA website [<xref rid="B37" ref-type="bibr">37</xref>]. OSA has built-in features to automatically trim those nucleotide bases with low-quality score at 3&#x02032;-end when it maps sequence reads to a reference transcriptome and genome. For raw sequence data, no additional preprocessing is needed. </p></sec><sec id="sec2.2"><title>2.2. Amazon's Import/Export Service and S3 for Data Storage</title><p>The raw sequence data for a large-scale RNA-Seq study, in which several hundred samples are sequenced, is typically multiple terabytes (TB) in size. For a deep RNA-Seq sample, the raw sequence data in FASTQ format ranges from 20 to 25&#x02009;GB, and after reads mapping, the corresponding BAM file (Binary version of a Sequence Alignment Map) ranges from 8 to 10&#x02009;GB. Assuming 200 samples, the input data will be 4 to 5&#x02009;TB, with the output BAM files adding another 2&#x02009;TB. For such large volumes of data, it is impractical to transfer them to and from Amazon via a typical network connection. The most efficient and reliable way is to move them through Amazon's Import/Export service. This service allows a user to ship multiple hard drives via FedEx to Amazon; after which, Amazon copies the data to S3 directly. The user has the option to encrypt the data on the hard drives to ensure security during transit. This process usually takes 2 to 3 days. When Stormbow runs, it can fetch the sequence data from S3 directly (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). In the Stormbow pipeline, S3 centralizes data storage, including inputs, intermediate results, and outputs. After an EC2 instance finishes its computational tasks, it is instructed to terminate itself. After termination, all data in that instance is inaccessible. Therefore, the result files must be uploaded to S3 prior to instance termination. S3 provides virtually unlimited storage space for cloud computing, ensures high durability of its data, and allows for parallel I/O, which is why we chose S3 as the centralized data storage for the Stormbow pipeline.</p></sec><sec id="sec2.3"><title>2.3. The Compute Node Type and Configuration for RNA-Seq Data Analysis</title><p>Amazon offers different types of machines with varying disk sizes and CPU configurations. Users can select and configure these machines to stratify their computational needs. However, Amazon does not offer an analysis solution; it is the user's responsibility to properly utilize the resources to analyse data. After requested resources from Amazon become available, they must be configured with the necessary software, datasets must be downloaded, and then analysis can be run.</p><p>OSA requires at least 8&#x02009;GB of memory to run. After benchmarking, the m1.xlarge EC2 instance type was chosen to run OSA. The m1.xlarge instance consists of a 64&#x02009;bit platform, 15&#x02009;GB memory, 4 virtual cores, 1,690&#x02009;GB instance storage, and very high I/O performance. Since there are 4 cores, 4 parallel threads can be launched to map millions of short reads to the reference genome and gene model. After an m1.xlarge instance is requested, these required software packages are installed, including the following: (1) <italic>zlib-devel</italic>, a library for data compression and inflation; (2) <italic>mono-2.10.8</italic> [<xref rid="B38" ref-type="bibr">38</xref>] to provide a runtime environment in Linux for applications that require&#x02009;&#x02009;.NET framework support; (3) OSA software; (4) hg19 (the human reference genome in its 19th version); (5) RefSeq gene model&#x02014;both the reference genome and gene model are required in reads mapping and expression quantification and are downloaded from Omicsoft's reference library website [<xref rid="B39" ref-type="bibr">39</xref>]&#x02014;; and (6) s3cmd command line tool [<xref rid="B40" ref-type="bibr">40</xref>] to transfer data to and from S3.</p><p>In principle, all required software can be installed on-the-fly when each EC2 instance is launched in the cloud. However, the total time required for system configuration is about 50 minutes if starting from the default Amazon's Linux Amazon Machine Image (AMI) 2013.03 (ami-3275ee5b). A better solution is to create a customized AMI with all the needed tools preinstalled and configured. This AMI is then used as a template for launching new EC2 instances. This approach saves 50 minutes when launching a new EC2 instance from this customized AMI, which adds up quickly when several hundred EC2 instances are launched in the cloud. Another advantage to using this customized AMI is reliability; all the needed software packages are properly configured and tested, which eliminates mistakes in system configuration. Stormbow is distributed with a script file that contains all the Unix shell commands needed to create this AMI.</p></sec><sec id="sec2.4"><title>2.4. <italic>RNASeq.sh</italic>: A Script for Analysing a Single Sample</title><p>When an EC2 instance is launched from the customized AMI above, it comes with all required software. Although it is ready for processing RNA-Seq data, it does not know which sample to process and/or how to analyse it. These two problems are solved through the <italic>cloud-init</italic> mechanism [<xref rid="B41" ref-type="bibr">41</xref>], which passes a piece of user-data to an EC2 instance when it is launched. The user-data itself is an executable shell script that is responsible for the following: (1) setting the proper environment variables, such as SAMPLE, GENOME, GENE_MODEL, and REFERENCE_LIBRARY and (2) downloading and executing <italic>RNASeq.sh</italic>, which contains step-by-step data processing instructions. The separation of <italic>RNASeq.sh</italic> from the customized AMI allows for flexibility and eases maintenance of the Stormbow pipeline. Software packages and reference genomes do not change very often, but RNA-Seq datasets and their analyses might vary with platforms and projects. <italic>RNASeq.sh</italic> is fetched on-the-fly by each EC2 instance, and tailored RNA-Seq analysis can be achieved by customizing <italic>RNASeq.sh</italic>.</p><p>As shown in the right side of <xref ref-type="fig" rid="fig1">Figure 1</xref>, the main tasks for the default <italic>RNASeq.sh</italic> script are as follows: (1) fetching sequence data from S3; (2) mapping reads to the reference genome; (3) quantifying gene and transcript expression; (4) quality checking of mapped reads; and (5) uploading result files to S3. The script also keeps track of the progress and status of the application's execution and collects and records runtime metrics, such as processing time, transfer time, and file sizes. In addition, <italic>RNASeq.sh</italic> handles some common and foreseeable errors to make the workflow more robust. For instance, it is not uncommon for a data transfer from S3 to EC2 to fail due to network congestion. Our script handles this failure by waiting a few minutes and attempting to download the data again instead of failing and terminating the instance. When the analysis is finished, this EC2 instance is terminated immediately to release all the requested resources.</p></sec><sec id="sec2.5"><title>2.5. <italic>Stormbow.pl</italic>: A Script to Launch Multiple EC2 Instances in the Cloud</title><p>So far, we have explained all the details on how to analyse a single sample in the cloud, including the hardware, software, and the analysis workflow. Now, it is time to discuss utilizing multiple EC2 instances to process many data files in parallel. Stormbow includes <italic>Stormbow.pl</italic>, a Perl script that can be run from any Linux computer with an internet connection to start EC2 instances in the cloud. <italic>Stormbow.pl</italic> takes a manifest file (to be discussed below) as input, prepares a piece of user-data for each sample listed in the manifest file, and writes this user-data to local files. The user-data files are shell scripts containing instructions for the EC2 nodes on how to process each specific sample. As a consequence, all EC2 instances process different samples in parallel, which significantly reduces the clock time of RNA-Seq data analysis. Amazon offers virtually unlimited CPU resources, and thus provides a computational environment that is ideally suited to large-scale RNA-Seq data analyses. As a result, Stormbow can easily scale up or down with the number of RNA samples, and the total running time remains almost constant no matter how large an RNA-Seq study is.</p></sec><sec id="sec2.6"><title>2.6. Manifest File and Consistent Naming Convention for Ease of Use</title><p>Another problem occurs when many EC2 instances are launched to process data in parallel. Each EC2 instance generates multiple result files that have to be uploaded to S3. The default file names might be too generic or even exactly the same. If we simply upload them to S3, we risk name conflicts and the overwriting of result files. For an RNA-Seq study with several hundred subjects, there will be several thousand result files generated when using OSA to analyse them. All these files need to be named consistently and managed properly.</p><p>In order to centralize and manage different types of results files in S3 in an automated fashion, a manifest file and naming convention are introduced. The manifest file is a plain text file to describe the subjects in an RNA-Seq project. Each subject has a corresponding entry in the manifest file, and each entry follows the convention below:<list list-type="simple"><list-item><label>&#x02009;</label><p><italic>J1</italic> s3://bt/J1_1.fq;s3://bt/J1_2.fq s3://bt/out</p></list-item><list-item><label>&#x02009;</label><p><italic>J2</italic> s3://bt/J2_1.fq;s3://bt/J2_2.fq s3://bt/out</p></list-item></list></p><p>Each entry consists of three fields separated by spaces or tabs: (1) a unique identifier; (2) raw sequence data in S3; and (3) an output location in S3. The naming convention, together with the unique identifier for each subject, controls how all the intermediate and result files are named, where these files are stored, and how they are logically organized in S3. For instance, the gene count table for sample <italic>J1</italic> has a file name <italic>J1.Gene.Count.txt</italic>, while its transcript count table is accordingly named as <italic>J1.Transcript.Count.txt</italic>. The manifest file and naming convention work together to guarantee all files are named and stored consistently and to avoid overwriting any file associated with another subject. </p></sec><sec id="sec2.7"><title>2.7. Merging of Results for Individual Samples and the Generation of the Gene Count Table</title><p>A Perl script, <italic>Merge.pl</italic>, was written to automate the merging of results. The script first fetches the result files corresponding to each subject from S3 using the s3cmd command line tool. It then calls <italic>Merge.R</italic>, an R script to perform the joining, and then puts the merged results back in S3. In addition to the generation of a combined gene and transcript count table, the alignment and mapping summary statistics for each sample are also merged. The gene count table can be directly fed as input to differential expression analysis packages such as DESeq or edgeR. </p></sec></sec><sec id="sec3"><title>3. Results and Discussions</title><sec id="sec3.1"><title>3.1. A Practical Test Runs of Stormbow</title><p>We applied Stormbow to analyse those 178 RNA-Seq subjects listed in Supplementary Table S1 which is available online at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1155/2013/481545">http://dx.doi.org/10.1155/2013/481545</ext-link>. All 178 subjects are pair-ended sequenced by Illumina HiSeq 2000 platforms. The practical steps are described as follows. We first made copies of the dataset for the original subjects onto an encrypted 2&#x02009;TB hard drive and shipped it to Amazon via FedEx. Amazon then copied the data to our specified S3 bucket. This took 2 days, including FedEx shipping time. After the sequence data was available in S3, we created a manifest file, in which each sample was given a unique identifier, locations of inputs, and an output folder in S3. Then, we ran the <italic>Stormbow.pl</italic> script to launch 178&#x02009;m1.xlarge instances in the cloud. It took an average of 7 hours to process a sample, including sequence download, analysis, and upload of result files. After the analysis of 178 samples was completed, we merged the results and shipped an empty hard drive to Amazon for encrypted data export, which took another 5 days including hard drive shipment time to and from Amazon. Lastly, the large amount of data in S3 was deleted to eliminate continuing charges for data storage.</p><p>In total, the RNA-Seq analysis of 178 samples using Stormbow in the cloud was done in less than 10 days, and the total cost was less than $1,000, including Amazon Import and Export charges. Amazon charges $0.50 per hour for m1.xlarge instances, which made the average EC2 cost of processing a single sample $3.50. The total EC2 cost for 178 samples was $650. For the Amazon Import service, the total cost was ~$150 for a single 2&#x02009;TB hard drive, including (a) $30 for FedEx shipping, (b) a flat $80 charge per device, and (c) $42 for the data loading fee, which is calculated at $2.49 per data-loading hour. The cost for the Amazon Export service was the same&#x02014;~$150 in our analysis.</p><p>The running metrics are reported in supplementary Table S1. The time required for analysis varies from sample to sample, but the majority of samples were processed within 6 to 8 hours. On average, each sample has 53 million pairs of reads, and the average FASTQ file size is 23&#x02009;GB. The average download and upload times are 18 and 12 minutes, respectively. To create a gene count table from a BAM alignment file it takes an average of 24 minutes, and the same time is needed to create a count table at transcript level. The mapping of more than 100&#x02009;M reads to a reference genome is the most time consuming step and takes an average of 321 minutes to accomplish. The relationship between the alignment time and the FASTQ file size is shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. There is no discernibly linear relationship between the computational time and the number of sequences.</p><p>We are puzzled by the trend shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. Each sample is analyzed in identical environments, including CPU, software, and parameters for alignment, but the running times seem to vary significantly for samples with comparable numbers of reads. After discussing our results with OSA developers and rerunning the analysis for sample <italic>J1</italic> four times in the cloud, we discovered two main reasons to explain the observed difference. First, the time to map a single sequence read to a reference genome varies significantly. The properties of reads have a dramatic effect on running time. Reads that are mapped with indels and mismatches require longer alignment time. Also, samples with more unmapped reads and multiple mapped reads will require additional alignment time. Moreover, sequence quality impacts alignment time as well. The total alignment is not simply determined by the number of sequence reads. Secondly, not all EC2 instances are identical in terms of performance. If we repeat the analysis in a local environment, the running times are nearly identical. However, when we analysed sample <italic>J1</italic> in the cloud 4 times using the same computational environment, the running times were 5&#x02009;h:20&#x02009;m, 5&#x02009;h:06&#x02009;m, 5&#x02009;h:19&#x02009;m, and 5&#x02009;h:44&#x02009;m. When alignment begins, all the sequence reads and reference genomes are in local instance storage drives, so we cannot attribute the difference to network fluctuations. Therefore, we can assume that the EC2 instances themselves give rise to the observed time difference. An EC2 instance is a virtual machine, and many EC2 instances can run on a single piece of hardware. Depending on the neighbouring EC2 virtual machines, each EC2 instance may get slightly varying amounts of perceived CPU, memory, and I/O bandwidth. As a consequence, the analysis time does vary. Despite the running time difference, the result files are identical for all separate runs of the same sample. </p></sec><sec id="sec3.2"><title>3.2. Amazon Cloud as an Execution Environment for Stormbow</title><p>When we implemented Stormbow, we chose Amazon's cloud as the execution environment over local clusters for two reasons: (1) Amazon offers virtually unlimited storage and CPU resources for easy and fast scaling to handle large RNA-Seq studies; the option to set up a local high-performance cluster to keep pace with the computational and storage challenges for NGS data analysis was not a feasible option for us; and (2) Amazon provides on-demand access to a wide range of cloud infrastructure services, charging you only for the resources you actually request. This &#x0201c;pay-as-you-go&#x0201d; model works better for our research because we do not need dedicated resources for RNA-Seq data analysis year-around. With its massive economies of scale, Amazon is continually driving cost down and reducing costs to the end users. Furthermore, cloud computing offers operational advantages, such as setting up infrastructure in minutes rather than months, and completing massive computational tasks with a large number of resources quickly. </p><p>We chose S3 to centralize data storage, including inputs, intermediate results, and outputs from every computational step in Stormbow. S3 provides virtually unlimited storage space for cloud computing and stores multiple copies of its data, which guarantee the safety of data in Amazon's cloud. All objects in S3 have unique identifiers and can be fetched in parallel without input/output (I/O) congestion. This parallelism is critical when multiple EC2 instances are uploading or downloading large amounts of data simultaneously to and from S3. </p></sec><sec id="sec3.3"><title>3.3. The Choice of OSA for Reads Mapping and Expression Quantification</title><p>To apply RNA-Seq to differential expression analysis, we need first to quantify the gene expression level in each sample, and then run statistical tests to identify DE genes. The quantification task typically involves (1) the mapping of large number of reads to a reference genome or transcriptome, and (2) the estimation of gene and isoform abundances based on the read mappings. In addition to OSA, there are other algorithms available to map reads in RNA-Seq studies, such as Tophat [<xref rid="B36" ref-type="bibr">36</xref>]. The reasons we chose OSA are as follows: firstly, OSA is several times faster than Tophat with better sensitivity and less false positives; secondly, OSA takes a parameter file to control how the reads are mapped to a reference genome or transcriptome, which is more versatile to pass to an EC2 node in the cloud than using a command line parameter; thirdly, the vendor of OSA has provided and maintained prebuilt genome and gene models for many common organisms, which removes the time and complexity of developing these by ourselves; finally, OSA not only is an alignment tool, but also has a built-in subcommand for expression quantification. Of course, Tophat remains a tool widely used in the RNA-Seq community. In fact, we use it for the discovery of novel genes and isoform or the detection of gene fusion. However, for differential studies in which we investigate the effects of compound treatment and/or gene knockdown, our main interest is to identify those known genes that are differentially expressed, not to discover novel genes or transcripts. In this scenario, OSA fits our needs better. </p><p>To generate a gene count table from mapped reads is complex. The first major complication in quantification is the fact that RNA-Seq reads do not always map uniquely to a single gene or isoform. The transcripts from which RNA-Seq reads are derived are not always uniquely determined. Paralogous gene families, low-complexity sequence, and high sequence similarity between alternatively spliced isoforms of the same gene are primary factors contributing to mapping uncertainty. In addition, polymorphisms, reference sequence errors, and sequencing errors require mismatches and indels to be allowed in read alignments and further contribute to lower confidence in mappings. As a consequence, a significant number of reads are multireads: reads that have high-scoring alignments to multiple positions in a reference genome or transcript set. Another challenge in quantification is gene overlapping. Some regions are shared by more than one gene. If a read is mapped to such regions, to which gene this read should be counted is ambiguous. OSA implements an algorithm similar to RSEM [<xref rid="B42" ref-type="bibr">42</xref>] to deal with gene overlapping and multireads. OSA estimates maximum likelihood (ML) expression levels using an expectation maximization (EM) algorithm and gives more accurate gene expression estimates than those using only unique reads or other alterative rescue strategies.</p></sec><sec id="sec3.4"><title>3.4. Stormbow versus Rainbow and Myrna</title><p>Both Rainbow [<xref rid="B32" ref-type="bibr">32</xref>] and Stormbow are cloud-based tools we have developed for large-scale sequence data analysis, but they have different goals. Rainbow is developed for whole genome sequence data analysis, where typically there are more than 1 billion reads per sample. With Rainbow, instead of launching a single EC2 instance to map billions of reads, a compute cluster is launched in the cloud to process the data in parallel with the output being all the Single Nucleotide Polymorphisms (SNP) for a sample. In contrast, Stormbow is designed for much smaller RNA-Seq data analysis, and its output is a gene count table to represent the expression levels of all genes in a gene model.</p><p>Myrna [<xref rid="B25" ref-type="bibr">25</xref>, <xref rid="B43" ref-type="bibr">43</xref>] is another cloud computing tool for calculating differential gene expressions in large RNA-Seq datasets. Myrna was developed more than 3 years ago, and it uses a modified Bowtie [<xref rid="B44" ref-type="bibr">44</xref>] for short read alignment. The Bowtie version in Myrna does not handle insertion and deletion when mapping reads to a reference genome. Thus, Myrna's biggest drawback is that it does not attempt to align reads across junctions, assemble isoforms, or otherwise analyse on the isoform or junction level. Unfortunately, many sequence reads from RNA-Seq indeed span two or more exons. Although Stormbow and Myrna are both designed to process large RNA-Seq datasets, the parallelism is achieved by different strategies. Stormbow launches multiple individual EC2 instances to process RNA-Seq samples in parallel, while Myrna launches a large compute cluster to sequentially process RNA-Seq data sample by sample, and parallelize data analysis within each RNA-Seq run. Of course, mapping millions of reads can be easily accomplished in parallel, but not all steps in data analysis can be easily parallelized. Compared to Myrna, Stormbow achieves a higher parallelism than that achieved by Myrna and virtually can scale up to a large RNA-Seq study of any size.</p></sec><sec id="sec3.5"><title>3.5. The Advantages of Stormbow</title><p>RNA-Seq is a powerful technology that is predicted to replace microarrays for transcriptome profiling [<xref rid="B1" ref-type="bibr">1</xref>]. The amount of data coming out of an RNA-Seq experiment can be staggering, orders of magnitude more than microarrays. For instance, a typical raw CEL data file generated from Affymetrix HT HG-U133+ PM array is 5&#x02009;MB per sample, whereas RNA-Seq data is about 23&#x02009;GB in our study. The raw data alone increases 4,600-fold. Leveraging recent advances in sequencing technology, RNA-Seq experiments produce larger amounts of sequence data at lower costs, and quite often by small to midsize research groups that have no access to local high-performance computing environment. The cloud-based Stormbow processes the large volume of RNA-Seq data quickly at an affordable price as our in-house test run has demonstrated. </p><p>Stormbow is fully scalable and developed for large-scale RNA-Seq differential studies. It is written using Perl, Shell, and R scripts, and it is simple to be deployed and used by third parties. It can be used out of the box to process Illumina RNA-Seq datasets. The manifest file is the only file that a user needs to prepare in order to run Stormbow. In essence, Stormbow is a wrapper of OSA, but it hides the complexity of directly using OSA for RNA-Seq data analysis in the cloud. More importantly, the performance of Stormbow has been tested by practically applying it to analyze 178 RNA-Seq samples simultaneously. </p></sec><sec id="sec3.6"><title>3.6. Lessons Learned with Amazon Cloud Computing</title><p>To analyse large volumes of data in Amazon's cloud is different from in a local environment. Quite often, large datasets are stored in S3. They have to be downloaded from S3 to EC2 instances first, which is not trivial. Physically, the data transfer is done through Amazon's internal network, which is not always reliable. Network congestion or failure is not uncommon for. We encountered this situation a few times during the development of Stormbow and in our test run. As shown in <xref ref-type="fig" rid="fig3">Figure 3</xref>, the download time was an average of 18.4 minutes per sample; however, it had taken as long as 79 minutes to download Sample <italic>J3</italic> in our test run of Stormbow. We repeated the analysis for <italic>J3</italic>, and the download time was about 18 minutes. Clearly, the network congestion can cause nontrivial download delays. In Stormbow, the s3cmd command line tool is used to fetch sequence data from S3 to an EC2 instance. When the network connection is lost during an upload or download, s3cmd responds with an error. In our test run of those 178 samples, we received this type of error twice. When you move data around in the cloud, it is always advised to check and make sure the data transfer is successful regardless of the data size.</p><p>Amazon offers a variety of EC2 instances for you to choose with different pricing models. You need to understand how your algorithm works and benchmark to choose the best option. In Stormbow, the m1.xlarge instance was chosen to run OSA due to reasons stated previously. When we tested on an instance type with more CPU cores, the running time was not strikingly different. The reasons behind this are as follows: first, more threads cause I/O congestion since all threads write the results into the same hard drive; second, more threads increase the parallelism only for the first step in OSA, but not the second step. For our application, an instance with higher absolute CPU and memory performance was not a better option.</p><p>For those developers who want to wrap other standalone applications and launch multiple EC2 instances to run them in parallel, they might be facing some common challenges, including the following: (1) transferring large amounts of data; (2) launching many EC2 instances automatically; (3) instructing instances to perform specific computations; and (4) managing the large number of result files in S3. In Stormbow, we wrote a driver script to automate the launch of EC2 instances, and made use of the cloud-init mechanism to pass instructions to new EC2 instances. The manifest file and naming convention standardize how the intermediate and result files are named and logically organized in S3. All these ideas and practices have proven to work well in Stormbow, and can be helpful for developing other cloud-based bioinformatics tools.</p></sec></sec><sec id="sec4"><title>4. Conclusions</title><p>In this paper, we described the motivation for the development of Stormbow, its implementation, and evaluation. Stormbow is a cloud-based software package that wraps OSA for parallel execution in the cloud. It is designed for large-scale RNA-Seq studies in which several hundred or even thousand samples are sequenced for differential analysis. It is cost effective and simple to use as we have demonstrated in our test run. Stormbow is open-source based and implemented using Perl, Shell, and R scripts. The source code for Stormbow is freely available for download from the Stormbow website [<xref rid="B45" ref-type="bibr">45</xref>]. OSA is free to academic users, but for commercial users, you need to contact Omicsoft Inc. Since all computations are performed in the Amazon cloud, a user will need to pay Amazon to be able to run analyses.</p></sec><sec sec-type="supplementary-material" id="supplementary-material-sec"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="f1"><caption><p>Descriptions on 178 RNA-Seq samples and their detail running matrices, including (1) the number of pair-ended reads, (2) the original FASTQ file size, (3) the BAM file size after alignment, (4) running times for download of FASTQ files from S3 to EC2, alignment of reads to reference genome, quantification of gene and transcript expressions, upload of results onto S3, and the total running time.</p></caption><media xlink:href="481545.f1.xlsx" mimetype="application" mime-subtype="vnd.openxmlformats-officedocument.spreadsheetml.sheet" orientation="portrait" id="d35e515" position="anchor"/></supplementary-material></sec></body><back><ack><title>Acknowledgments</title><p>The authors would like to thank Matt Newman and Kejun Liu for their invaluable help with running OSA and assistance. </p></ack><sec sec-type="conflict"><title>Conflict of Interests</title><p>The authors of the paper do not have a direct financial relation with any commercial identity mentioned in this paper that might lead to a conflict of interests for any of the authors.</p></sec><sec><title>Authors' Contribution</title><p>Shanrong Zhao designed, implemented, and tested Stormbow and wrote the paper. Kurt Prenger performed tests, collected running metrics, and participated in writing this paper. Lance Smith performed data import/export from Amazon.</p></sec><ref-list><ref id="B1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z.</given-names></name><name><surname>Gerstein</surname><given-names>M.</given-names></name><name><surname>Snyder</surname><given-names>M.</given-names></name></person-group><article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title><source><italic>Nature Reviews Genetics</italic></source><year>2009</year><volume>10</volume><issue>1</issue><fpage>57</fpage><lpage>63</lpage><pub-id pub-id-type="other">2-s2.0-57749195712</pub-id><pub-id pub-id-type="doi">10.1038/nrg2484</pub-id></element-citation></ref><ref id="B2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marguerat</surname><given-names>S.</given-names></name><name><surname>B&#x000e4;hler</surname><given-names>J.</given-names></name></person-group><article-title>RNA-seq: from technology to biology</article-title><source><italic>Cellular and Molecular Life Sciences</italic></source><year>2010</year><volume>67</volume><issue>4</issue><fpage>569</fpage><lpage>579</lpage><pub-id pub-id-type="other">2-s2.0-75649135574</pub-id><pub-id pub-id-type="doi">10.1007/s00018-009-0180-6</pub-id><pub-id pub-id-type="pmid">19859660</pub-id></element-citation></ref><ref id="B3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mutz</surname><given-names>K. O.</given-names></name><name><surname>Heilkenbrinker</surname><given-names>A.</given-names></name><name><surname>L&#x000f6;nne</surname><given-names>M.</given-names></name><name><surname>Walter</surname><given-names>J. G.</given-names></name><name><surname>Stahl</surname><given-names>F.</given-names></name></person-group><article-title>Transcriptome analysis using next-generation sequencing</article-title><source><italic>Current Opinion in Biotechnology</italic></source><year>2013</year><volume>24</volume><issue>1</issue><fpage>22</fpage><lpage>30</lpage><pub-id pub-id-type="doi">10.1016/j.copbio.2012.09.004</pub-id><pub-id pub-id-type="pmid">23020966</pub-id></element-citation></ref><ref id="B4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hurd</surname><given-names>P. J.</given-names></name><name><surname>Nelson</surname><given-names>C. J.</given-names></name></person-group><article-title>Advantages of next-generation sequencing versus the microarray in epigenetic research</article-title><source><italic>Briefings in Functional Genomics and Proteomics</italic></source><year>2009</year><volume>8</volume><issue>3</issue><fpage>174</fpage><lpage>183</lpage><pub-id pub-id-type="other">2-s2.0-70249146903</pub-id><pub-id pub-id-type="doi">10.1093/bfgp/elp013</pub-id><pub-id pub-id-type="pmid">19535508</pub-id></element-citation></ref><ref id="B5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Malone</surname><given-names>J. H.</given-names></name><name><surname>Oliver</surname><given-names>B.</given-names></name></person-group><article-title>Microarrays, deep sequencing and the true measure of the transcriptome</article-title><source><italic>BMC Biology</italic></source><year>2011</year><volume>9, article 34</volume><pub-id pub-id-type="other">2-s2.0-79957665988</pub-id><pub-id pub-id-type="doi">10.1186/1741-7007-9-34</pub-id></element-citation></ref><ref id="B6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McIntyre</surname><given-names>L. M.</given-names></name><name><surname>Lopiano</surname><given-names>K. K.</given-names></name><name><surname>Morse</surname><given-names>A. M.</given-names></name><etal/></person-group><article-title>RNA-seq: technical variability and sampling</article-title><source><italic>BMC Genomics</italic></source><year>2011</year><volume>12, article 293</volume><pub-id pub-id-type="other">2-s2.0-79957882567</pub-id><pub-id pub-id-type="doi">10.1186/1471-2164-12-293</pub-id></element-citation></ref><ref id="B7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marioni</surname><given-names>J. C.</given-names></name><name><surname>Mason</surname><given-names>C. E.</given-names></name><name><surname>Mane</surname><given-names>S. M.</given-names></name><name><surname>Stephens</surname><given-names>M.</given-names></name><name><surname>Gilad</surname><given-names>Y.</given-names></name></person-group><article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title><source><italic>Genome Research</italic></source><year>2008</year><volume>18</volume><issue>9</issue><fpage>1509</fpage><lpage>1517</lpage><pub-id pub-id-type="other">2-s2.0-50649089207</pub-id><pub-id pub-id-type="doi">10.1101/gr.079558.108</pub-id><pub-id pub-id-type="pmid">18550803</pub-id></element-citation></ref><ref id="B8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nookaew</surname><given-names>I.</given-names></name><name><surname>Papini</surname><given-names>M.</given-names></name><name><surname>Pornputtapong</surname><given-names>N.</given-names></name><etal/></person-group><article-title>A comprehensive comparison of RNA-Seq-based transcriptome analysis from reads to differential gene expression and cross-comparison with microarrays: a case study in <italic>Saccharomyces cerevisiae</italic></article-title><source><italic>Nucleic Acids Research</italic></source><year>2012</year><volume>40</volume><issue>20</issue><fpage>10084</fpage><lpage>10097</lpage><pub-id pub-id-type="doi">10.1093/nar/gks804</pub-id><pub-id pub-id-type="pmid">22965124</pub-id></element-citation></ref><ref id="B9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stalteri</surname><given-names>M. A.</given-names></name><name><surname>Harrison</surname><given-names>A. P.</given-names></name></person-group><article-title>Interpretation of multiple probe sets mapping to the same gene in Affymetrix GeneChips</article-title><source><italic>BMC Bioinformatics</italic></source><year>2007</year><volume>8, article 13</volume><pub-id pub-id-type="other">2-s2.0-33846986793</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-8-13</pub-id></element-citation></ref><ref id="B10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oshlack</surname><given-names>A.</given-names></name><name><surname>Robinson</surname><given-names>M. D.</given-names></name><name><surname>Young</surname><given-names>M. D.</given-names></name></person-group><article-title>From RNA-seq reads to differential expression results</article-title><source><italic>Genome Biology</italic></source><year>2010</year><volume>11</volume><issue>12, article 220</issue><pub-id pub-id-type="other">2-s2.0-78650539308</pub-id><pub-id pub-id-type="doi">10.1186/gb-2010-11-12-220</pub-id></element-citation></ref><ref id="B11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bullard</surname><given-names>J. H.</given-names></name><name><surname>Purdom</surname><given-names>E.</given-names></name><name><surname>Hansen</surname><given-names>K. D.</given-names></name><name><surname>Dudoit</surname><given-names>S.</given-names></name></person-group><article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title><source><italic>BMC Bioinformatics</italic></source><year>2010</year><volume>11, article 94</volume><pub-id pub-id-type="other">2-s2.0-77949481052</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-11-94</pub-id></element-citation></ref><ref id="B12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tarazona</surname><given-names>S.</given-names></name><name><surname>Garc&#x000ed;a-Alcalde</surname><given-names>F.</given-names></name><name><surname>Dopazo</surname><given-names>J.</given-names></name><name><surname>Ferrer</surname><given-names>A.</given-names></name><name><surname>Conesa</surname><given-names>A.</given-names></name></person-group><article-title>Differential expression in RNA-seq: a matter of depth</article-title><source><italic>Genome Research</italic></source><year>2011</year><volume>21</volume><issue>12</issue><fpage>2213</fpage><lpage>2223</lpage><pub-id pub-id-type="other">2-s2.0-83055192078</pub-id><pub-id pub-id-type="doi">10.1101/gr.124321.111</pub-id><pub-id pub-id-type="pmid">21903743</pub-id></element-citation></ref><ref id="B13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>J.</given-names></name><name><surname>Ji</surname><given-names>Y.</given-names></name><name><surname>Liang</surname><given-names>S.</given-names></name><name><surname>Cai</surname><given-names>G.</given-names></name><name><surname>M&#x000fc;ller</surname><given-names>P.</given-names></name></person-group><article-title>On differential gene expression using RNA-Seq data</article-title><source><italic>Cancer Informatics</italic></source><year>2011</year><volume>10</volume><fpage>205</fpage><lpage>215</lpage><pub-id pub-id-type="other">2-s2.0-80053580422</pub-id><pub-id pub-id-type="doi">10.4137/CIN.S7473</pub-id><pub-id pub-id-type="pmid">21863128</pub-id></element-citation></ref><ref id="B14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Baker</surname><given-names>M.</given-names></name></person-group><article-title>Next-generation sequencing: adjusting to data overload</article-title><source><italic>Nature Methods</italic></source><year>2010</year><volume>7</volume><issue>7</issue><fpage>495</fpage><lpage>499</lpage><pub-id pub-id-type="other">2-s2.0-77954975104</pub-id><pub-id pub-id-type="doi">10.1038/nmeth0710-495</pub-id></element-citation></ref><ref id="B15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schatz</surname><given-names>M. C.</given-names></name><name><surname>Langmead</surname><given-names>B.</given-names></name><name><surname>Salzberg</surname><given-names>S. L.</given-names></name></person-group><article-title>Cloud computing and the DNA data race</article-title><source><italic>Nature Biotechnology</italic></source><year>2010</year><volume>28</volume><issue>7</issue><fpage>691</fpage><lpage>693</lpage><pub-id pub-id-type="other">2-s2.0-77954492012</pub-id><pub-id pub-id-type="doi">10.1038/nbt0710-691</pub-id></element-citation></ref><ref id="B16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evani</surname><given-names>U. S.</given-names></name><name><surname>Challis</surname><given-names>D.</given-names></name><name><surname>Yu</surname><given-names>J.</given-names></name><etal/></person-group><article-title>Atlas2 cloud: a framework for personal genome analysis in the cloud</article-title><source><italic>BMC Genomics</italic></source><year>2012</year><volume>13</volume><issue>supplement 6, article S19</issue><pub-id pub-id-type="doi">10.1186/1471-2164-13-S6-S19</pub-id></element-citation></ref><ref id="B17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garber</surname><given-names>M.</given-names></name><name><surname>Grabherr</surname><given-names>M. G.</given-names></name><name><surname>Guttman</surname><given-names>M.</given-names></name><name><surname>Trapnell</surname><given-names>C.</given-names></name></person-group><article-title>Computational methods for transcriptome annotation and quantification using RNA-seq</article-title><source><italic>Nature Methods</italic></source><year>2011</year><volume>8</volume><issue>6</issue><fpage>469</fpage><lpage>477</lpage><pub-id pub-id-type="other">2-s2.0-79957842166</pub-id><pub-id pub-id-type="doi">10.1038/nmeth.1613</pub-id><pub-id pub-id-type="pmid">21623353</pub-id></element-citation></ref><ref id="B18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>Qian</surname><given-names>F.</given-names></name><name><surname>Yan</surname><given-names>W.</given-names></name><name><surname>Shen</surname><given-names>B.</given-names></name></person-group><article-title>Translational biomedical informatics in the cloud: present and future</article-title><source><italic>BioMed Research International</italic></source><year>2013</year><volume>2013</volume><fpage>8</fpage><pub-id pub-id-type="publisher-id">658925</pub-id><pub-id pub-id-type="doi">10.1155/2013/658925</pub-id></element-citation></ref><ref id="B19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stein</surname><given-names>L. D.</given-names></name></person-group><article-title>The case for cloud computing in genome informatics</article-title><source><italic>Genome Biology</italic></source><year>2010</year><volume>11</volume><issue>5, article 207</issue><pub-id pub-id-type="other">2-s2.0-77954526823</pub-id><pub-id pub-id-type="doi">10.1186/gb-2010-11-5-207</pub-id></element-citation></ref><ref id="B20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenthal</surname><given-names>A.</given-names></name><name><surname>Mork</surname><given-names>P.</given-names></name><name><surname>Li</surname><given-names>M. H.</given-names></name><name><surname>Stanford</surname><given-names>J.</given-names></name><name><surname>Koester</surname><given-names>D.</given-names></name><name><surname>Reynolds</surname><given-names>P.</given-names></name></person-group><article-title>Cloud computing: a new business paradigm for biomedical information sharing</article-title><source><italic>Journal of Biomedical Informatics</italic></source><year>2010</year><volume>43</volume><issue>2</issue><fpage>342</fpage><lpage>353</lpage><pub-id pub-id-type="other">2-s2.0-77949261537</pub-id><pub-id pub-id-type="doi">10.1016/j.jbi.2009.08.014</pub-id><pub-id pub-id-type="pmid">19715773</pub-id></element-citation></ref><ref id="B21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wall</surname><given-names>D. P.</given-names></name><name><surname>Kudtarkar</surname><given-names>P.</given-names></name><name><surname>Fusaro</surname><given-names>V. A.</given-names></name><name><surname>Pivovarov</surname><given-names>R.</given-names></name><name><surname>Patil</surname><given-names>P.</given-names></name><name><surname>Tonellato</surname><given-names>P. J.</given-names></name></person-group><article-title>Cloud computing for comparative genomics</article-title><source><italic>BMC Bioinformatics</italic></source><year>2010</year><volume>11, article 259</volume><pub-id pub-id-type="other">2-s2.0-77954055600</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-11-259</pub-id></element-citation></ref><ref id="B22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thakur</surname><given-names>R. S.</given-names></name><name><surname>Bandopadhyay</surname><given-names>R.</given-names></name><name><surname>Chaudhary</surname><given-names>B.</given-names></name><name><surname>Chatterjee</surname><given-names>S.</given-names></name></person-group><article-title>Now and next-generation sequencing techniques: future of sequence analysis using cloud computing</article-title><source><italic>Front Genetics</italic></source><year>2012</year><volume>3, article 280</volume><pub-id pub-id-type="doi">10.3389/fgene.2012.00280</pub-id></element-citation></ref><ref id="B23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schatz</surname><given-names>M. C.</given-names></name></person-group><article-title>CloudBurst: highly sensitive read mapping with MapReduce</article-title><source><italic>Bioinformatics</italic></source><year>2009</year><volume>25</volume><issue>11</issue><fpage>1363</fpage><lpage>1369</lpage><pub-id pub-id-type="other">2-s2.0-65649120715</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btp236</pub-id><pub-id pub-id-type="pmid">19357099</pub-id></element-citation></ref><ref id="B24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B.</given-names></name><name><surname>Schatz</surname><given-names>M. C.</given-names></name><name><surname>Lin</surname><given-names>J.</given-names></name><name><surname>Pop</surname><given-names>M.</given-names></name><name><surname>Salzberg</surname><given-names>S. L.</given-names></name></person-group><article-title>Searching for SNPs with cloud computing</article-title><source><italic>Genome Biology</italic></source><year>2009</year><volume>10</volume><issue>11, article R134</issue><pub-id pub-id-type="other">2-s2.0-72849149423</pub-id><pub-id pub-id-type="doi">10.1186/gb-2009-10-11-r134</pub-id></element-citation></ref><ref id="B25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B.</given-names></name><name><surname>Hansen</surname><given-names>K. D.</given-names></name><name><surname>Leek</surname><given-names>J. T.</given-names></name></person-group><article-title>Cloud-scale RNA-sequencing differential expression analysis with Myrna</article-title><source><italic>Genome Biology</italic></source><year>2010</year><volume>11</volume><issue>8, article R83</issue><pub-id pub-id-type="other">2-s2.0-77955343193</pub-id><pub-id pub-id-type="doi">10.1186/gb-2010-11-8-r83</pub-id></element-citation></ref><ref id="B26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angiuoli</surname><given-names>S. V.</given-names></name><name><surname>White</surname><given-names>J. R.</given-names></name><name><surname>Matalka</surname><given-names>M.</given-names></name><name><surname>White</surname><given-names>O.</given-names></name><name><surname>Fricke</surname><given-names>W. F.</given-names></name></person-group><article-title>Resources and costs for microbial sequence analysis evaluated using virtual machines and cloud computing</article-title><source><italic>PLoS ONE</italic></source><year>2011</year><volume>6</volume><issue>10</issue><pub-id pub-id-type="other">2-s2.0-80054776462</pub-id><pub-id pub-id-type="doi">10.1371/journal.pone.0026624</pub-id><pub-id pub-id-type="publisher-id">e26624</pub-id></element-citation></ref><ref id="B27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nguyen</surname><given-names>T.</given-names></name><name><surname>Shi</surname><given-names>W.</given-names></name><name><surname>Ruden</surname><given-names>D.</given-names></name></person-group><article-title>CloudAligner: a fast and full-featured MapReduce based tool for sequence mapping</article-title><source><italic>BMC Research Notes</italic></source><year>2011</year><volume>4, article 171</volume><pub-id pub-id-type="other">2-s2.0-79957895842</pub-id><pub-id pub-id-type="doi">10.1186/1756-0500-4-171</pub-id></element-citation></ref><ref id="B28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>X.</given-names></name><name><surname>Grossman</surname><given-names>R.</given-names></name><name><surname>Stein</surname><given-names>L.</given-names></name></person-group><article-title>PeakRanger: a cloud-enabled peak caller for ChIP-seq data</article-title><source><italic>BMC Bioinformatics</italic></source><year>2011</year><volume>12, article 139</volume><pub-id pub-id-type="other">2-s2.0-79955676390</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-12-139</pub-id></element-citation></ref><ref id="B29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S.</given-names></name><name><surname>Huber</surname><given-names>W.</given-names></name></person-group><article-title>Differential expression analysis for sequence count data</article-title><source><italic>Genome Biology</italic></source><year>2010</year><volume>11</volume><issue>10, article R106</issue><pub-id pub-id-type="other">2-s2.0-77958471357</pub-id><pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id></element-citation></ref><ref id="B30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>M. D.</given-names></name><name><surname>McCarthy</surname><given-names>D. J.</given-names></name><name><surname>Smyth</surname><given-names>G. K.</given-names></name></person-group><article-title>edgeR: a bioconductor package for differential expression analysis of digital gene expression data</article-title><source><italic>Bioinformatics</italic></source><year>2010</year><volume>26</volume><issue>1</issue><fpage>139</fpage><lpage>140</lpage><pub-id pub-id-type="other">2-s2.0-77449084524</pub-id><pub-id pub-id-type="pmid">19910308</pub-id></element-citation></ref><ref id="B31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardcastle</surname><given-names>T. J.</given-names></name><name><surname>Kelly</surname><given-names>K. A.</given-names></name></person-group><article-title>BaySeq: empirical bayesian methods for identifying differential expression in sequence count data</article-title><source><italic>BMC Bioinformatics</italic></source><year>2010</year><volume>11, article 422</volume><pub-id pub-id-type="other">2-s2.0-77955298482</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-11-422</pub-id></element-citation></ref><ref id="B32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>S.</given-names></name><name><surname>Prenger</surname><given-names>K.</given-names></name><name><surname>Smith</surname><given-names>L.</given-names></name><etal/></person-group><article-title>Rainbow: a tool for large-scale whole-genome sequencing data analysis using cloud computing</article-title><source><italic>BMC Genomics</italic></source><year>2013</year><volume>14, article 425</volume></element-citation></ref><ref id="B33"><label>33</label><element-citation publication-type="other"><collab>Amazon Simple Storage Service (Amazon S3)</collab><comment><ext-link ext-link-type="uri" xlink:href="http://aws.amazon.com/s3/">http://aws.amazon.com/s3/</ext-link></comment></element-citation></ref><ref id="B34"><label>34</label><element-citation publication-type="other"><collab>Amazon Elastic Compute Cloud (Amazon EC2)</collab><comment><ext-link ext-link-type="uri" xlink:href="http://aws.amazon.com/ec2/">http://aws.amazon.com/ec2/</ext-link></comment></element-citation></ref><ref id="B35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>J.</given-names></name><name><surname>Ge</surname><given-names>H.</given-names></name><name><surname>Newman</surname><given-names>M.</given-names></name><name><surname>Liu</surname><given-names>K.</given-names></name></person-group><article-title>OSA: a fast and accurate alignment tool for RNA-Seq</article-title><source><italic>Bioinformatics</italic></source><year>2012</year><volume>28</volume><issue>14</issue><fpage>1933</fpage><lpage>1934</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bts294</pub-id><pub-id pub-id-type="pmid">22592379</pub-id></element-citation></ref><ref id="B36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C.</given-names></name><name><surname>Williams</surname><given-names>B. A.</given-names></name><name><surname>Pertea</surname><given-names>G.</given-names></name><etal/></person-group><article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title><source><italic>Nature Biotechnology</italic></source><year>2010</year><volume>28</volume><issue>5</issue><fpage>511</fpage><lpage>515</lpage><pub-id pub-id-type="other">2-s2.0-77952123055</pub-id><pub-id pub-id-type="doi">10.1038/nbt.1621</pub-id></element-citation></ref><ref id="B37"><label>37</label><element-citation publication-type="other"><article-title>OSA website</article-title><comment><ext-link ext-link-type="uri" xlink:href="http://www.omicsoft.com/osa/#Supplementary">http://www.omicsoft.com/osa/#Supplementary</ext-link></comment></element-citation></ref><ref id="B38"><label>38</label><element-citation publication-type="other"><article-title>Mono-2.10.8</article-title><comment><ext-link ext-link-type="uri" xlink:href="http://www.mono-project.com/Release_Notes_Mono_2.10.8">http://www.mono-project.com/Release_Notes_Mono_2.10.8</ext-link></comment></element-citation></ref><ref id="B39"><label>39</label><element-citation publication-type="other"><article-title>Omicsoft reference library</article-title><comment><ext-link ext-link-type="uri" xlink:href="http://www.omicsoft.com/downloads/dreflib/">http://www.omicsoft.com/downloads/dreflib/</ext-link></comment></element-citation></ref><ref id="B40"><label>40</label><element-citation publication-type="other"><article-title>Command line S3 client</article-title><comment><ext-link ext-link-type="uri" xlink:href="http://s3tools.org/s3cmd">http://s3tools.org/s3cmd</ext-link></comment></element-citation></ref><ref id="B41"><label>41</label><element-citation publication-type="other"><article-title>Cloud-init</article-title><comment><ext-link ext-link-type="uri" xlink:href="https://help.ubuntu.com/community/CloudInit">https://help.ubuntu.com/community/CloudInit</ext-link></comment></element-citation></ref><ref id="B42"><label>42</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>B.</given-names></name><name><surname>Dewey</surname><given-names>C. N.</given-names></name></person-group><article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title><source><italic>BMC Bioinformatics</italic></source><year>2011</year><volume>12, article 323</volume><pub-id pub-id-type="other">2-s2.0-79961123152</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id></element-citation></ref><ref id="B43"><label>43</label><element-citation publication-type="other"><article-title>Myrna website</article-title><comment><ext-link ext-link-type="uri" xlink:href="http://bowtie-bio.sourceforge.net/myrna/index.shtml">http://bowtie-bio.sourceforge.net/myrna/index.shtml</ext-link></comment></element-citation></ref><ref id="B44"><label>44</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B.</given-names></name><name><surname>Trapnell</surname><given-names>C.</given-names></name><name><surname>Pop</surname><given-names>M.</given-names></name><name><surname>Salzberg</surname><given-names>S. L.</given-names></name></person-group><article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title><source><italic>Genome Biology</italic></source><year>2009</year><volume>10</volume><issue>3, article R25</issue><pub-id pub-id-type="other">2-s2.0-62349130698</pub-id><pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id></element-citation></ref><ref id="B45"><label>45</label><element-citation publication-type="other"><article-title>Stormbow website</article-title><comment><ext-link ext-link-type="uri" xlink:href="http://s3.amazonaws.com/jnj_stormbow/index.html">http://s3.amazonaws.com/jnj_stormbow/index.html</ext-link></comment></element-citation></ref></ref-list></back><floats-group><fig id="fig1" orientation="portrait" position="float"><label>Figure 1</label><caption><p>Stormbow in action. S3 centralizes data storage. The large volumes of data are imported into or exported from S3 through Amazon Import and Export services. Multiple EC2 instances are launched automatically from a local Linux workstation by the Perl script, <italic>Stormbow.pl</italic>. All EC2 instances fetch sequence data from S3 and upload result files to S3. The key steps and tasks performed by each EC2 instance are detailed in the right of the figure. The <italic>Merge.pl</italic> script combines the gene counts in each sample into a consolidated count table that may be used as input to differential analysis tools, such as DESeq and edgeR.</p></caption><graphic xlink:href="ISRN.BIOINFORMATICS2013-481545.001"/></fig><fig id="fig2" orientation="portrait" position="float"><label>Figure 2</label><caption><p>The relationship between the alignment time and the FASTQ file size. Surprisingly, the running times for those samples with a comparable number of sequence reads varyes significantly. The properties of reads, such as indels, mismatches, and multiple mapping, contribute to the difference in running time. More time fluctuations result from the performance difference among EC2 instances.</p></caption><graphic xlink:href="ISRN.BIOINFORMATICS2013-481545.002"/></fig><fig id="fig3" orientation="portrait" position="float"><label>Figure 3</label><caption><p>The relationship between the download time and the FASTQ file size. The average FASTQ file size is 23&#x02009;GB, and the download time is 18.4 minutes on average. For sample <italic>J3</italic>, it takes 79 minutes to download 22.3&#x02009;GB.</p></caption><graphic xlink:href="ISRN.BIOINFORMATICS2013-481545.003"/></fig></floats-group></article>