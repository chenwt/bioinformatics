<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?properties manuscript?><?origin nihpa?><?iso-abbr Nat. Biotechnol.?><?submitter-system nihms?><?submitter-canonical-name Nature Publishing Group?><?submitter-canonical-id NATURE-STRUCTUR?><?submitter-userid 1045?><?submitter-authority publisher?><?submitter-login nature-structure?><?submitter-name Nature Publishing Group (obsolete)?><?domain nihpa?><front><journal-meta><journal-id journal-id-type="nlm-journal-id">9604648</journal-id><journal-id journal-id-type="pubmed-jr-id">20305</journal-id><journal-id journal-id-type="nlm-ta">Nat Biotechnol</journal-id><journal-id journal-id-type="iso-abbrev">Nat. Biotechnol.</journal-id><journal-title-group><journal-title>Nature biotechnology</journal-title></journal-title-group><issn pub-type="ppub">1087-0156</issn><issn pub-type="epub">1546-1696</issn></journal-meta><article-meta><article-id pub-id-type="pmcid">4037530</article-id><article-id pub-id-type="pmid">24633242</article-id><article-id pub-id-type="doi">10.1038/nbt.2850</article-id><article-id pub-id-type="manuscript">nihpa566373</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Genome-guided transcript assembly from integrative analysis of RNA sequence data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Boley</surname><given-names>Nathan</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref rid="FN1" ref-type="author-notes">*</xref></contrib><contrib contrib-type="author"><name><surname>Stoiber</surname><given-names>Marcus H.</given-names></name><xref ref-type="aff" rid="A1">1</xref></contrib><contrib contrib-type="author"><name><surname>Booth</surname><given-names>Benjamin W.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Wan</surname><given-names>Kenneth H.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Hoskins</surname><given-names>Roger A.</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Bickel</surname><given-names>Peter J.</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref rid="FN2" ref-type="author-notes">&#x02020;</xref></contrib><contrib contrib-type="author"><name><surname>Celniker</surname><given-names>Susan E.</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref rid="FN1" ref-type="author-notes">*</xref><xref rid="FN2" ref-type="author-notes">&#x02020;</xref></contrib><contrib contrib-type="author"><name><surname>Brown</surname><given-names>James B.</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A3">3</xref><xref rid="FN2" ref-type="author-notes">&#x02020;</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Biostatistics, University of California at Berkeley, Berkeley, CA, USA</aff><aff id="A2"><label>2</label>Department of Genome Dynamics, Lawrence Berkeley National Laboratory, Berkeley, California, USA</aff><aff id="A3"><label>3</label>Department of Statistics, University of California at Berkeley, Berkeley, CA, USA</aff><author-notes><corresp id="FN1"><label>*</label>Corresponding Author: (<email>npboley@gmail.com</email>)</corresp><fn id="FN2"><label>&#x02020;</label><p>Senior Authors</p></fn></author-notes><pub-date pub-type="nihms-submitted"><day>3</day><month>4</month><year>2014</year></pub-date><pub-date pub-type="epub"><day>16</day><month>3</month><year>2014</year></pub-date><pub-date pub-type="ppub"><month>4</month><year>2014</year></pub-date><pub-date pub-type="pmc-release"><day>01</day><month>10</month><year>2014</year></pub-date><volume>32</volume><issue>4</issue><fpage>341</fpage><lpage>346</lpage><!--elocation-id from pubmed: 10.1038/nbt.2850--><permissions><license xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms"><license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<ext-link ext-link-type="uri" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</ext-link></license-p></license></permissions><abstract><p id="P1">The identification of full length transcripts entirely from short-read RNA sequencing data (RNA-seq) remains a challenge in genome annotation pipelines. Here we describe an automated pipeline for genome annotation that integrates RNA-seq and gene-boundary data sets, which we call generalized RNA integration tool, or GRIT. By applying GRIT to <italic>Drosophila melanogaster</italic> short-read RNA-seq, cap analysis of gene expression (CAGE) and poly(A)-site-seq data collected for the modENCODE project, we recover the vast majority of previously annotated transcripts and double the total number of transcripts cataloged. We find that 20% of protein coding genes encode multiple protein-localization signals, and that, in 20 day old adult fly heads, genes with multiple poly-adenylation sites are more common than genes with alternate splicing or alternate promoters. When compared to the most widely used transcript assembly tools, GRIT recovers a larger fraction of annotated transcripts at higher precision. GRIT will enable the automated generation of high-quality genome annotations without necessitating extensive manual annotation.</p></abstract></article-meta></front><body><p id="P2">High-throughput sequencing of cDNAs (RNA-seq) yields quantitative information about gene expression, alternative splicing, RNA editing, poly-adenylation sites and other phenomena <sup><xref rid="R1" ref-type="bibr">1</xref>,<xref rid="R2" ref-type="bibr">2</xref>,<xref rid="R3" ref-type="bibr">3</xref></sup>. The prospect of using RNA-seq data to assemble reads into models of genes and transcripts has motivated the development of algorithms and software <sup><xref rid="R4" ref-type="bibr">4</xref>,<xref rid="R5" ref-type="bibr">5</xref>,<xref rid="R6" ref-type="bibr">6</xref>,<xref rid="R7" ref-type="bibr">7</xref>,<xref rid="R8" ref-type="bibr">8</xref></sup>. De novo assembly methods, such as Trinity <sup><xref rid="R5" ref-type="bibr">5</xref></sup>, Oases <sup><xref rid="R7" ref-type="bibr">7</xref></sup> and Trans-Abyss <sup><xref rid="R8" ref-type="bibr">8</xref></sup>, assemble reads to construct transcript sequences, which are then mapped to a reference genome. Genome-guided approaches, such as Cufflinks <sup><xref rid="R4" ref-type="bibr">4</xref></sup> and Scripture <sup><xref rid="R6" ref-type="bibr">6</xref></sup>, use reads that are aligned to a reference genome to identify transcript models.</p><p id="P3">The impact of RNA-seq data on genome annotation has been most substantial for organisms with minimal cDNA resources. For instance, RNA-seq data and Cufflinks were used to produce a de novo annotation for the sea urchin (<italic>Strongylocentrotus Purpuratus</italic>) but to prevent the inclusion of transcript fragments this study incorporated a stringent filtering system that removed transcript models that lacked ORFs longer than 500aa or that didn&#x02019;t encode a known protein <sup><xref rid="R9" ref-type="bibr">9</xref></sup>. In contrast, in organisms where substantial annotation efforts are ongoing (e.g., human <sup><xref rid="R10" ref-type="bibr">10</xref></sup>, fruitfly <sup><xref rid="R11" ref-type="bibr">11</xref></sup>, zebrafish <sup><xref rid="R12" ref-type="bibr">12</xref></sup> and worms <sup><xref rid="R13" ref-type="bibr">13</xref></sup>) the impact of RNA-seq data has largely been by the manual incorporation of elements including new transcription start sites, splice junctions, and poly-adenylation sites. GRIT is designed to assemble a high quality experimentally-driven genome annotation using a reference genome and short read sequencing data, allowing it to be useful for the study both of model and non-model organisms.</p><p id="P4">It is not surprising that genome annotation has primarily remained in the domain of manual annotation and full-insert cDNA sequencing, because RNA-seq reads are too short to cover full transcripts, typically providing information only about three or four exons at a time <sup><xref rid="R14" ref-type="bibr">14</xref></sup>. This means that it is not always possible to positively identify alternate transcript isoforms, even as the read depth approaches infinity. Furthermore, biases in the RNA-seq assay make positive identification of novel transcript boundaries difficult <sup><xref rid="R15" ref-type="bibr">15</xref>,<xref rid="R16" ref-type="bibr">16</xref>,<xref rid="R1" ref-type="bibr">1</xref>,<xref rid="R17" ref-type="bibr">17</xref></sup>. Other genome annotation tools attempt to circumvent these problems by placing additional restrictions on the space of discoverable transcripts. For instance, Cufflinks only permits the minimal set of transcripts needed to explain the splice junctions, over-simplifying complex loci like <italic>Down syndrome cell adhesion molecule 1</italic> (<italic>Dscam1)</italic> of <italic>D. melanogaster</italic>. Trinity always extends transcript contigs to the last base, disallowing nested promoters and nested poly(A) sites. As we show, these restrictions can produce annotation sets that are in direct contradiction to observed data from complementary assays.</p><p id="P5">We use a sparse statistical model amenable to modern optimization techniques, combined with the integration of gene boundary data to analyze RNA-seq data. In principle our approach allows for the construction of any transcript models that can be built by Cufflinks, Trinity, Scripture, Oases or Trans-Abyss, although our requirement that every transcript model be supported by experimental evidence can make GRIT more restrictive in practice. For the purposes of benchmarking, we have used a subset of the modENCODE dataset (1.67B bp, <xref rid="SD1" ref-type="supplementary-material">Supplementary Table 1</xref>) to compare the performance of GRIT to the most widely used transcript-level RNA-seq analysis tools. GRIT has also been applied to the full set of modENCODE RNA data (over 1 terabases of sequence data from CAGE, rapid amplification of cDNA ends (RACE), expressed sequence tags (EST), cDNA, 454, stranded paired-end RNA-seq and poly(A)-site-seq experiments) to generate a data-driven annotation with unprecedented detail of gene and transcript models for the fruit fly. The full-length transcript models have revealed a number of discoveries, including the findings that &#x0003e;20% of <italic>D. melanogaster</italic> protein-coding genes encode multiple localization signals and that alternative polyadenylation is more common than alternative splicing in neuronal tissue. These and related insights reported here and in a companion manuscript <sup><xref rid="R18" ref-type="bibr">18</xref></sup> were not obtainable with other analysis tools, and underscore the importance of integrating multiple types of assays when interpreting RNA sequencing data.</p><sec sec-type="results" id="S1"><title>Results</title><sec id="S2"><title>GRIT</title><p id="P6">A brief overview of the GRIT method is outlined below; for details see the online methods.</p><p id="P7">GRIT makes few assumptions about the structure of transcripts; defining them as sets of genomic regions that begin at a transcription start site (TSS), optionally extend through one or more exons connected by splice junctions, and end with a transcription end site (TES). This implies four distinct element types: TSS exons, TES exons, internal exons, and single exon transcripts. TSS exons begin with an experimentally detected promoter (e.g. via the CAGE or RACE assays or 5&#x02032; EST sequencing <sup><xref rid="R19" ref-type="bibr">19</xref></sup>), and end with a splice donor site. Similarly, TES exons begin with a splice acceptor site and end with an observed TES (e.g., a poly(A) site). Internal exons begin and end with a verified splice site, and single exon transcripts begin with a TSS and end with a TES. GRIT uses both canonical and non-canonical splice sites.</p><p id="P8">We identify elements by segmenting the genome into non-overlapping segments with attached labels that describe their segment boundary (<xref rid="F1" ref-type="fig">Fig. 1a</xref>). After removing low coverage segments, groups of adjacent segments are combined and labeled based upon their segment boundaries. For instance, an internal exon&#x02019;s 5&#x02032; boundary is a splice acceptor, and its 3&#x02032; boundary is a splice donor. TSS exons&#x02019; 5&#x02032; boundaries are TSS sites, and their 3&#x02032; boundaries are splice donors. Similarly, the 3&#x02032; end of a TES exon is a TES, and the 5&#x02032; end is a splice acceptor.</p><p id="P9">After the exons are identified, we assemble transcript models. We define the set of candidate transcripts as the union of single exon transcripts and transcripts that begin with a TSS exon, optionally contain splice-junction connected internal exons, and end with a TES exon (<xref rid="F1" ref-type="fig">Fig. 1b</xref>). GRIT differs from other methods, e.g. Cufflinks, in that it considers all possible paths subject to this restriction &#x02013; rather than some minimal set of covering paths &#x02013; allowing GRIT to correctly build transcripts in very complex loci like <italic>Dscam1</italic> (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1a</xref>).</p><p id="P10">After identifying the possible set of candidate transcripts, we estimate their relative concentrations in the sample of interest, i.e., their expression. This is challenging because reads can not necessarily be assigned to a single transcript. Thus, we first identify transcripts by the non-overlapping exon segments. Then, we group reads into the set of non-overlapping exon segments that they overlap, which we refer to as a &#x0201c;bin&#x0201d; (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2</xref>). We define <italic>Y<sub>i</sub></italic> as the number of reads of bin <italic>i</italic>.</p><p id="P11">The number of reads that are of a particular bin, when combined with information about the expected distribution of fragments from a particular transcript, provides information about transcript frequencies. Formally, we define an entry <italic>X<sub>ij</sub></italic> in the design matrix <italic>X</italic> to be the probability of sampling bin <italic>j</italic> given that the read originated from transcript <italic>j</italic>. The maximum likelihood estimate of the transcript frequencies, <italic>&#x00074;&#x020d7;</italic>, is then the vector <italic>&#x00074;&#x00302;</italic> that maximizes the log-likelihood, <italic>lhd</italic>(<italic>Y;&#x00074;&#x020d7;</italic>) = &#x003a3;<italic><sub>i</sub>Y<sub>i</sub></italic>log[&#x003a3;<italic><sub>j</sub>X<sub>ij</sub>t<sub>j</sub></italic>], subject to the constraints <italic>t<sub>j</sub></italic> &#x02265; 0 and &#x003a3;<italic><sub>j</sub> t<sub>j</sub></italic> = 1. Whenever no row of <italic>X<sub>ij</sub></italic> can be constructed from a positively weighted sum of other rows, the statistical model is said to be identifiable given the data, and we can use a convex optimization algorithm to estimate <italic>&#x00074;&#x00302;</italic> (<xref rid="SD1" ref-type="supplementary-material">Supplementary Note 1</xref>). When the model is not identifiable, we use a penalized likelihood which produces a sparse estimate of <italic>&#x00074;&#x020d7;</italic>; we choose the sparsity parameter so that the sparse estimate achieves approximately the same maximum as the un-penalized likelihood. (<xref rid="SD1" ref-type="supplementary-material">Supplementary Note 1</xref>)</p><p id="P12">Forming confidence bounds on a particular transcript&#x02019;s frequency estimate, <italic>&#x00074;&#x00302;<sub>j</sub></italic>, requires finding the minimum and maximum values that <italic>t<sub>j</sub></italic> can take while still being reasonably likely to produce the observed data set. Given some desired marginal significance level, <italic>&#x003b1;</italic>, we estimate our lower confidence bound for transcript <italic>j</italic> by the minimum value that <italic>t<sub>j</sub></italic> can take over all possible values for <italic>&#x00074;&#x020d7;</italic> such that <inline-formula><mml:math id="M1" overflow="scroll"><mml:mi mathvariant="italic">lhd</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mi mathvariant="italic">mle</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="italic">lhd</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:msubsup><mml:mi>&#x003c7;</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. When the model is identifiable, simulations show that this approach produces confidence bounds with the correct rejection rates for realistic sample sizes (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1e</xref>). When the model is not identifiable the confidence bounds are conservative, i.e. the lower confidence bounds is zero.</p><p id="P61">The fact that GRIT produces conservative confidence bounds is a major advantage over other methods. GRIT allows the user to be confident that transcripts with lower confidence bounds greater than zero were likely present in the sample of interest, while unidentifiable regions can be easily detected and targeted for further experimentation. In contrast, the credible bounds that Cufflinks and Rsem <sup><xref rid="R20" ref-type="bibr">20</xref></sup> produce are strongly dependent on a prior distribution, which can lead to dramatically anti-conservative confidence bounds even in moderately complex genes (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1f</xref>).</p></sec><sec id="S3"><title>Comparison to other tools</title><p id="P13">Current transcript discovery tools make assumptions about the structure of the underlying transcripts, usually restricting them to some identifiable subset. For instance, Cufflinks assumes that the set of possible transcripts is the minimal set of covering paths in the graphical model described in Section 2.1.3. Trinity requires that transcript models extend to the furthest base of an assemblable contig, which disallows transcript models with nested transcription start and termination sites. The GRIT model allows for both of these, but requires gene boundary information. We benchmarked GRIT against Cufflinks, Scripture and Trinity+Rsem, using stranded RNA-seq, CAGE and poly(A)-site-seq data produced from dissected heads of 20 day adult flies (Ad20dHeads) (<xref rid="SD1" ref-type="supplementary-material">Supplementary Table 1</xref>).</p><p id="P14">We analyzed the recall and precision of the transcriptomes generated by GRIT and the three other annotation tools by comparing the transcripts predicted by each tool to 13,141 FlyBase 5.45 (Ref. <xref rid="R21" ref-type="bibr">21</xref>) transcripts corresponding to 7,079 genes expressed in Ad20dHeads. Transcripts were considered equivalent when they had the same internal splicing structure and gene boundaries within 50 bp of each other. Under this measure: GRIT recovers 44.2% of transcripts with 17.8% precision; Cufflinks recovers 13.4% of transcripts with 8.8% precision; Trinity+Rsem recovers 8.6% or transcripts with 3.0% precision; Scripture recovers 0.9% of transcripts with 1.4% precision (<xref rid="F2" ref-type="fig">Fig. 2a</xref>). When we filter predicted transcripts with an estimated expression score lower bound less than 1e-6 estimated fragments per kilobase per million reads (FPKMs) at a marginal 99% significance level, then GRIT recovers 39.8% of FlyBase transcripts with 41.3% precision. The Cufflinks, Trinity and Scripture numbers are essentially unchanged.</p><p id="P15">This substantial rise in GRIT&#x02019;s precision when low expression transcripts are filtered is largely due to eliminating complex genes. The GRIT annotation is heavily penalized in complex loci, e.g. <italic>Dscam1</italic> or <italic>Myosin heavy chain (Mhc)</italic>, because FlyBase includes new transcript models only when they contribute a new exon, intron or gene boundary (FlyBase 5.45 gene notes). The superior performance of GRIT is not purely a result of its increased ability to precisely predict transcript boundaries; when we relax the transcript boundary match distance to 200 bp and even 1,000 bp, GRIT still out-performs competing methods (<xref rid="F2" ref-type="fig">Fig. 2a</xref>, <xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 3</xref>).</p><p id="P16">We studied the consistency of tools&#x02019; estimated transcript expression scores by calculating the correlation between estimated FPKMs and both CAGE and poly(A)-site-seq tag counts. GRIT annotated transcripts achieve Spearman rank correlations between 0.71 and 0.80 across replicates, whereas Cufflinks, Trinity and Scripture correlations are all below 0.5 (<xref rid="F2" ref-type="fig">Fig. 2b</xref>).</p><p id="P17">To study the precision of TSSs, we analyzed the motif enrichment of the two most spatially localized core promoter motifs, TATA <sup><xref rid="R22" ref-type="bibr">22</xref></sup> and Inr <sup><xref rid="R23" ref-type="bibr">23</xref></sup>, in regions within 50 bp of annotated TSSs (<xref rid="F2" ref-type="fig">Fig. 2c</xref>). The genome sequence surrounding TSSs identified by GRIT and Scripture are significantly enriched (p &#x0003c; 0.01 &#x02013; see online methods) for the TATA motif 24&#x02013;32 and 30&#x02013;35 bp upstream of the TSS, respectively. These correspond to 3.2% and 1.1% of distinct annotated TSSs. Regions identified by Cufflinks and Trinity are not significantly enriched for the TATA motif at any positions. Similarly, regions identified by GRIT are significantly enriched (p &#x0003c; 0.01 &#x02013; online methods) for the Inr motif enrichment at &#x000b1;1 bp of the TSS, which corresponds to 12% of annotated TSSs. Neither Cufflinks, Trinity nor Scripture identified regions are significantly enriched (p &#x0003c; 0.01 &#x02013; online methods) at any bases for the <italic>Inr</italic> motif. This is expected, because identifying transcript boundaries from RNA-seq data alone is very difficult (<xref rid="SD1" ref-type="supplementary-material">Supplementary Result 1</xref>, <xref rid="SD1" ref-type="supplementary-material">Supplementary Figure 4</xref>)</p><p id="P18">We also analyzed the regions within 50 bp of TSSs annotated in FlyBase 5.45, and found TATA enrichment at 27&#x02013;34 bp corresponding to 2.9% of distinct TSSs, and <italic>Inr</italic> enrichment 2&#x02013;3 bp upstream of annotated TSSs, corresponding to 1.5% of distinct annotated TSSs. Although both GRIT and FlyBase TSS regions show similar TATA enrichment, GRIT more precisely identified the 26&#x02013;31 bp upstream positioning <sup><xref rid="R23" ref-type="bibr">23</xref></sup>. The GRIT enrichment results are consistent with previous studies<sup><xref rid="R19" ref-type="bibr">19</xref></sup>, which report TATA and Inr motifs in 2.1% and 13.8% of peaked promoters identified by RACE <sup><xref rid="R24" ref-type="bibr">24</xref></sup>.</p></sec><sec id="S4"><title>Alternate transcript boundaries are common and functional</title><p id="P19">Alternate promoters have long been known to serve a regulatory role. The sequence of both 5&#x02032; UTRs introns within 5&#x02032; UTRs have the potential to alter translational efficiency <sup><xref rid="R25" ref-type="bibr">25</xref>,<xref rid="R26" ref-type="bibr">26</xref>,<xref rid="R27" ref-type="bibr">27</xref></sup> and subcellular localization of the mRNA<sup><xref rid="R28" ref-type="bibr">28</xref></sup>. Alternative N-terminal protein sequence is known to control the localization of many proteins<sup><xref rid="R29" ref-type="bibr">29</xref></sup>.</p><p id="P20">Genes encoding alternative N-terminal domains, either by alternative promoter usage or splicing, include well-studied examples such as the <italic>Prothoracicotropic hormone</italic> (<italic>Ptth</italic>) gene critical for metamorphosis in insects <sup><xref rid="R30" ref-type="bibr">30</xref>,<xref rid="R31" ref-type="bibr">31</xref></sup>. <italic>Ptth</italic> encodes three neural-secreted hormone protein isoforms. The canonical form contains a signal peptide sequence for exportation from the cell. A second isoform with a 25 amino acid N-terminal extension contains a mitochondrial targeting peptide. The third form, first reported by this study, is shorter than the canonical isoform by nine amino acids (<xref rid="F3" ref-type="fig">Fig. 3a</xref>), and is predicted to localize to the cytoplasm or nucleus.</p><p id="P21"><italic>Ptth</italic> has the potential to encode multiple localization signals, which appears to be an example of a general phenomenon. Our improved annotation of the <italic>Drosophila</italic> transcriptome suggests that 19.6% of all protein coding genes encode multiple localization signals &#x02013; versus 5.7% for FlyBase 5.45 (<xref rid="SD1" ref-type="supplementary-material">Supplementary Result 2</xref>). We also find substantial complexity at the 3&#x02032; ends of transcripts, including neuronal-specific 3&#x02032; UTR extensions <sup><xref rid="R32" ref-type="bibr">32</xref>,<xref rid="R33" ref-type="bibr">33</xref></sup>. In addition, for 77 genes, we detected polyadenylation sites in canonical CDS exons that result in truncated transcript variants, some of which have been shown to be functional<sup><xref rid="R34" ref-type="bibr">34</xref></sup>.</p></sec><sec id="S5"><title>Current tools under-estimate splicing diversity</title><p id="P22">We identified 47 genes with the capacity to encode &#x0003e;1,000 transcript isoforms <sup><xref rid="R18" ref-type="bibr">18</xref></sup>, 13 of which are only expressed in samples enriched for neuronal tissue. Together, these 13 genes account for nearly 13.5% of the predicted expressed transcript isoforms. In Ad20dHeads, 59.6% of genes expressed encode multiple transcript isoforms (<xref rid="F3" ref-type="fig">Fig. 3b</xref>). Of these, 29.8% exhibit multiple promoters, 48.1% multiple poly(A) events and 40.1% exhibit alternate splicing (<xref rid="F3" ref-type="fig">Fig. 3c</xref>).</p><p id="P23"><italic>Dscam1</italic> has the potential to encode 38,016 distinct protein isoforms<sup><xref rid="R35" ref-type="bibr">35</xref></sup>, 3000 of which bind preferentially to themselves, i.e., specific homophilic binding has been observed<sup><xref rid="R36" ref-type="bibr">36</xref></sup>. DSCAM1 is known to play a crucial role in axonal tract formation in the developing fly nervous system, and is expressed in neuronal tissue throughout the lifecycle. We observed the highest levels of expression in the central nervous system of pupae (WPP +2day CNS), where we are able to identify a 3&#x02032; extension and two novel cassette exons, allowing <italic>Dscam1</italic> to produce as many as 228,096 distinct transcripts. In the data collected from Ad20dHeads, GRIT recovers 720 DSCAM isoforms, whereas Cufflinks and Trinity were unable to recover a single full-length transcript.</p><p id="P24">We used simulated data to study the ability of GRIT, Cufflinks and Trinity to recapitulate known <italic>Dscam1</italic> transcripts (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1a</xref>). When GRIT was used to analyze 10,000 RNA-seq reads simulated uniformly from the canonical 38,016 isoforms, it recovered every exon, and was thus able to predict every transcript isoforms with perfect precision in 19 of 20 simulations. Trinity was never able to build a full length transcript and Cufflinks recovered one transcript in 1 of 20 simulations, demonstrating the inability of these methods to model complex genes. Running simulations using the 228,096 isoforms identified in WPP +2day CNS produces similar results.</p></sec></sec><sec sec-type="discussion" id="S6"><title>Discussion</title><p id="P25">The development of tools that enable the accurate interpretation of RNA sequence data is an important challenge. Our tool, GRIT, leverages multiple RNA sequence data types, including CAGE, mRNA-seq, polyA+site-seq, ESTs and cDNAs to discover transcript models. The use of gene boundary data prevents fragmentary transcript models, and models that erroneously merge distinct genes.</p><p id="P26">Transcript models assembled by GRIT begin with a transcript start site, are connected by intervening mRNA-seq signal, and end in a polyadenylation site. We benchmarked GRIT and three other annotation tools using a subset of the modENCODE <italic>Drosophila</italic> RNA data sets <sup><xref rid="R18" ref-type="bibr">18</xref></sup> and found that GRIT performs substantially better than competing methods, both at identifying previously annotated transcript models and discovering new genes and transcripts. We devised a transcript quantification procedure that correctly accounts for model unidentifiability when estimating the confidence bounds, permitting conservative confidence bounds even in gene loci with the potential to produce thousands of transcript isoforms.</p><p id="P27">In cases where the extant set of transcripts cannot be confidently identified, GRIT could be coupled with other classes of genomic information, including conservation, protein functional data and RNA structure to produce a sparse subset of transcripts that preserve known function. This may aid in generating high-quality transcript annotations. As long read sequencing technologies mature, it may become possible to observe full-length transcripts directly <sup><xref rid="R37" ref-type="bibr">37</xref></sup>. GRIT currently incorporates cDNA sequences into transcript models, providing valuable connectivity information, and will make use of single-molecule data as they become available.</p><p id="P28">Among the most remarkable findings of our work on the modENCODE <italic>Drosophila</italic> RNA datasets is the fact that &#x0003e;20% of genes encode proteins with alternative localization signals. Although previous studies have identified individual genes encoding proteins with different subcellular localizations and distinct functional roles <sup><xref rid="R38" ref-type="bibr">38</xref></sup>, our data indicates that this is a ubiquitous function of alternative splicing and promoter usage throughout the genome. This suggests that molecular pleiotropy may be more common than previously thought.</p><p id="P29">The gene <italic>Ptth</italic> has been characterized for over a decade. Yet, GRIT discovered a new start codon modulated by an alternative promoter. In addition to emphasizing the importance of accurate gene-boundary information, our studies make evident the need for well-resolved tissue and cell-type transcript maps: the isoform in question is expressed in only two of the 108 modENCODE samples, where it is the dominant form. Future functional studies are needed to determine the biological role of this protein and indeed of the thousands of newly predicted protein isoforms with previously undetected protein localization signals.</p><p id="P30">GRIT generates full-length transcript models with sample-by-sample expression scores. The accuracy of these automated, purely empirical annotations yield a view of metazoan transcriptomes of unprecedented depth and complexity, which has not been previously obtained through manual annotation or the application of tools that model only a single data type (e.g. RNA-seq without gene boundary information). GRIT alleviates a current analytical bottleneck and will enhance the accessibility and usefulness of RNA sequencing data.</p></sec><sec id="S7" specific-use="web-only"><title>Online Methods</title><sec id="S8"><title>GRIT Method</title><p id="P31">Below we describe the GRIT methodology including the tuning parameters used for this study; all numerical constants can be changed at the command line. See <xref rid="SD1" ref-type="supplementary-material">Supplementary Note 2</xref> for details about the tuning parameters.</p><p id="P32">GRIT uses reads aligned to a reference genome to build transcript models. We make few assumptions about the structure of a transcript, as follows, and require that every element (e.g. promoter or splice junction) is supported experimentally. We define a transcript as a set of genomic regions that begin at a transcription start site (TSS), optionally extend through one or more exons connected by splice junctions, and end with a transcription end site (TES).</p><p id="P33">We define four distinct element types: TSS exons, TES exons, internal exons, and single exon transcripts. TSS exons begin with an experimentally detected promoter (e.g. via the CAGE or RACE assays or 5&#x02032; EST sequencing <sup><xref rid="R19" ref-type="bibr">19</xref></sup>), and end with a splice donor site. Similarly, TES exons begin with a splice acceptor site and end with an observed TES (e.g. a poly(A) site). Internal exons begin and end with a verified splice site, and single exon transcripts begin with TSS and end with a TES. Our transcript models can use both canonical and non-canonical splice sites. The set of candidate transcripts includes both single exon transcripts and transcripts that begin with a TSS exon, contain splice-junction connected exons, and end with a TES exon (<xref rid="F1" ref-type="fig">Fig. 1b</xref>).</p><p id="P34">The GRIT annotation pipeline consists of four parts: gene region identification, element discovery, transcript construction and transcript expression estimation.</p><sec id="S9"><title>Gene Region Identification</title><p id="P35">Segmenting the genome into gene regions involves three distinct steps: identifying exonic regions, identifying intronic regions and merging exonic and intronic regions into gene regions. To build a set of exon regions, we identify all 100 bp regions without any RNA-seq, CAGE, or poly(A)-site-seq reads. These empty regions form boundaries between the different exonic regions. To identify introns, we collect reads that map in a non-contiguous fashion to the reference genome, typically known as junction reads. To avoid junction reads that may be experimental or mapping artifacts, we filter the set of identified junctions using the filtering criterion described as follows.</p><p id="P36">We require that junctions have an entropy score (defined as &#x02212; &#x003a3;<italic><sub>i</sub>p<sub>i</sub></italic> log<sub>2</sub>[<italic>p<sub>i</sub></italic>] where 
<inline-formula><mml:math id="M2" overflow="scroll"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle scriptlevel="1"><mml:mfrac><mml:mrow><mml:mtext>reads</mml:mtext><mml:mspace width="0.16667em"/><mml:mtext>at</mml:mtext><mml:mspace width="0.16667em"/><mml:mtext>offset</mml:mtext><mml:mspace width="0.16667em"/><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>total</mml:mtext><mml:mspace width="0.16667em"/><mml:mtext>reads</mml:mtext><mml:mspace width="0.16667em"/><mml:mtext>at</mml:mtext><mml:mspace width="0.16667em"/><mml:mtext>junction</mml:mtext></mml:mrow></mml:mfrac></mml:mstyle></mml:math></inline-formula>) of at least 2.0 in one biological sample; this filter helps to remove mapping and sequencing artifacts. To remove incorrectly stranded reads, we remove junctions on the strand opposite of canonical acceptor/donor sequences if their frequency is less than 10% of the junction frequency on the canonical strand, and all junctions with a count less than 1% of the count of junctions at the same position but opposite strand. The junction reads that pass this filter are then aggregated into a set of discovered introns.</p><p id="P62">Finally, we construct gene regions by collecting exon regions that share one or more discovered introns. Note that although 100 bp is too large to properly separate many gene pairs, in practice it provides a good first approximation. During the element discovery stage we use the identified CAGE and poly(A)-site-seq peaks in combination with the read coverage to further segment when necessary (as described below).</p></sec><sec id="S10"><title>Element Discovery</title><p id="P37">Element discovery proceeds independently in each gene region, and is parallelized for multithreaded processing in GRIT. We split each gene region into non-overlapping segments with attached labels. Segment labels describe the segment boundary (<xref rid="F1" ref-type="fig">Fig. 1a</xref>). For instance, a segment where the 5&#x02032; boundary is a splice donor and 3&#x02032; boundary is a splice acceptor is a canonical intron; a segment where the 5&#x02032; boundary is a splice acceptor and 3&#x02032; boundary is a splice donor is a canonical exon. There are four boundary labels: splice acceptor, splice donor, TSS, and TES. Splice donors and acceptors are identified directly from junction reads, as above; TSS and TES are, respectively, identified from CAGE and poly(A)-site-seq data, as follows.</p><p id="P38">Identifying peaks from transcript boundary data (e.g. CAGE and poly(a)-site-seq) involves both filtering noisy reads and identifying peaks from the filtered data &#x02013; we use essentially the approach described in Hoskins et al 19. Briefly, we model the data as a mixture of reads sampled from actual gene bounds and from a noise component. Because the dominant source of noise is the selection of RNA fragments that did not originate from true gene bounds (e.g. RNA fragmentation pre-selection, non-specifically bound DNA), we use the RNA-seq data as an estimate of the density of the noise component. For each base <italic>i</italic>, we estimate the read background density <italic>p<sub>i</sub></italic> as the fraction of RNA-seq reads that start at base <italic>i</italic>. Then, we model the distribution of the transcript boundary data read count he null as Bin(<italic>N,p</italic>), where <italic>N</italic> is the total number of mapped gene boundary reads. If we cannot reject the null hypothesis that the observed transcript boundary data read count originated wholly from the noise component, at significance level 0.01, we zero the count at base <italic>i</italic>. To identify peaks, we greedily find the set of regions with the smallest combined length that are at least 5 bp long and cover 99% of the gene region&#x02019;s filtered transcript boundary signal. In the absence of poly(A)-site-seq data, we have successfully applied a machine learning approach to the identification of TESs (Brown et. al. <xref rid="SD1" ref-type="supplementary-material">Supplementary Section 12</xref> (Ref. <xref rid="R18" ref-type="bibr">18</xref>)), and expect that a similar approach would work for the identification of TSSs.</p><p id="P39">There are 16 possible pairwise combinations of the four segment boundary labels, which we group into seven segment labels: TSS segments, canonical introns, canonical exons, exon extensions, TES segments, single exon transcripts and intergenic segments (<xref rid="F1" ref-type="fig">Fig. 1a</xref>). TSS segments are any segments where the 5&#x02032; boundary has a TSS label; similarly, a TES segment&#x02019;s 3&#x02032; boundary has a TES label. Canonical introns have a 5&#x02032; splice donor label and a 3&#x02032; splice acceptor label. Canonical exons have a 5&#x02032; splice acceptor label and a 3&#x02032; splice donor label. Exon extensions either have two splice donor labels, or two splice acceptor labels. Single exon transcripts have a 5&#x02032; TSS label, and a 3&#x02032; TES label. Regions that begin with a 5&#x02032; TES label and end with a 3&#x02032; TSS label are intergenic segments. If intergenic segments are discovered and the average base coverage is sufficiently low, then the gene region is split and the element discovery process is re-started recursively. At this stage, poorly supported segments, meaning those with low read coverage, are removed.</p><p id="P40">Within a gene region, a low coverage region is defined as a segment where the average read coverage is lower than 1e-2 with high probability; or, the ratio of a segments average read coverage to the highest read coverage segment in the same gene region is less than 1% at a 0.99 significance level. GRIT is relatively robust to changes in these parameters for a given data type, but they may have to be changed when using, for instance, total versus poly(A)+ RNA-seq data (<xref rid="SD1" ref-type="supplementary-material">Supplementary Note 2</xref>).</p><p id="P41">The set of candidate exons is all combinations of adjacent segments that start with TSS or splice acceptor, and end with a TES or splice donor. Regions that begin with a TSS label and end with a donor junction are TSS exons; regions that begin with an acceptor junction and end with a TES label are TES exons; regions that begin with a acceptor junction and end with an donor junction are internal exons; regions that start with a TSS label and end with a TES label are single exon transcripts (<xref rid="F1" ref-type="fig">Fig. 1a</xref>).</p></sec><sec id="S11"><title>Transcript Construction</title><p id="P42">For the purposes of candidate transcript construction, we model a gene as a directed graph in which each exon is a node, and splice junctions are edges (<xref rid="F1" ref-type="fig">Fig. 1b</xref>). Then the set of candidate transcripts is composed of the single exon transcripts and all possible paths through this graph that begin with a TSS exon and end with a TES exon (<xref rid="F1" ref-type="fig">Fig. 1b</xref>). This differs from other methods, e.g. Cufflinks, in that we consider all possible paths subject to this restriction, rather than some minimal set of covering paths.</p></sec><sec id="S12"><title>Transcript Expression Estimation</title><p id="P43">The primary challenge in estimating transcript expression for a given gene is identifying a vector, <italic>&#x00074;&#x020d7;,</italic> that corresponds to the relative concentrations of all transcripts in the sample of interest. This is difficult because reads can not necessarily be unambiguously assigned to one transcript. Therefore, the first step in estimating transcript expression levels is further segmenting the transcripts into non-overlapping exon segments, or pseudo exons. It is then possible to unambiguously group reads by the set of pseudo exons that they overlap, which we refer to as a &#x0201c;bin&#x0201d; (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2</xref>). Hence, the bins that can be observed unambiguously are a function of gene structure, sequenced read length, and fragment length distribution.</p><p id="P44">We estimate the fragment length distribution by the 5 base uniform kernel smoothed middle 99% of the empirical distribution of read fragments in the 100 unspliced gene regions with the highest average base coverage that are at least 2000 base pairs long. If there are less than 5000 total fragments that satisfy these criteria, we estimate the fragment distribution by a normal distribution truncated at &#x000b1;2 standard deviations, with mean and standard deviation estimated from unspliced fragments.</p><p id="P45">We encode gene structure, read length and type, and fragment length distribution in a design matrix, <italic>X</italic>, which connects the probability of observing reads of a particular bin to the presence of a particular transcript. Each entry <italic>X<sub>ij</sub></italic> is a conditional probability that applies to individual reads. Formally, <italic>X<sub>ij</sub></italic> is the probability of sampling a read of bin <italic>i</italic> given that the read originated from transcript <italic>j</italic>. In practice, we estimate <italic>X<sub>ij</sub></italic> by 
<inline-formula><mml:math id="M3" overflow="scroll"><mml:msub><mml:mi mathvariant="normal">&#x02211;</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mspace width="0.16667em"/><mml:mrow><mml:mo>(</mml:mo><mml:mfrac bevelled="true"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msubsup><mml:mi mathvariant="normal">&#x02211;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> where <italic>f<sub>l</sub></italic> is the estimated fraction of fragments of length <italic>l</italic>, <italic>C<sub>i,j,l</sub></italic> is the count of distinct fragments of length <italic>l</italic> in transcript <italic>j</italic> that produce fragments of type <italic>i</italic>, and <italic>N<sub>j</sub></italic> is the total number of bins in transcript <italic>j</italic>. This estimate formalizes the assumption that, within a transcript, all fragments with the same length are equally likely to be observed.</p><p id="P63">Given a vector of observed bin counts, <italic>&#x00059;&#x020d7;,</italic> the maximum likelihood estimate of the transcript frequencies, <italic>&#x00074;&#x020d7;</italic>, is the vector <italic>&#x00074;&#x00302;</italic> that maximizes the log-likelihood, <italic>lhd</italic>(<italic>Y;&#x00074;&#x020d7;</italic>) = &#x003a3;<italic><sub>i</sub>Y<sub>i</sub></italic>log[&#x003a3;<italic><sub>j</sub>X<sub>ij</sub>t<sub>j</sub></italic>], subject to <italic>t<sub>j</sub></italic> &#x02265; 0 and &#x003a3;<italic><sub>j</sub>t<sub>j</sub></italic> = 1. This is the multinomial log likelihood where the event probabilities, &#x003a3;<italic><sub>j</sub>X<sub>ij</sub>t<sub>j</sub></italic>, are the bin proportions weighted by the transcript frequencies. The maximum likelihood estimate is unique whenever no row of <italic>X<sub>ij</sub></italic> can be constructed from a positively weighted sum of other rows. In such unique cases, the statistical model is said to be identifiable given the data, and we can use a convex optimization algorithm to estimate <italic>&#x00074;&#x00302;</italic> (<xref rid="SD1" ref-type="supplementary-material">Supplementary Note 1</xref>).</p><p id="P64">To form confidence bounds on a particular transcript&#x02019;s frequency estimate, <italic>&#x00074;&#x00302;<sub>j</sub></italic>, our goal is to find the minimum and maximum values that <italic>t<sub>j</sub></italic> can take while still being &#x0201c;reasonably likely&#x0201d; to result in the observed data. We identify a subset &#x00394;<italic><sub>R</sub></italic> of the probability simplex such that <italic>lhd</italic>(<italic>Y;&#x00074;&#x020d7;</italic>) is sufficiently high for every <italic>&#x00074;&#x020d7;</italic> &#x02208; &#x00394;<italic><sub>R</sub></italic>. Convexity of the likelihood function guarantees this region is simple and convex, which allows us to form our confidence bound for transcript <italic>i</italic> as the interval [min <italic>t<sub>j</sub></italic>:<italic>&#x00074;&#x020d7;</italic> &#x02208; &#x00394;<italic><sub>R</sub></italic>, max <italic>t<sub>j</sub></italic>:<italic>&#x00074;&#x020d7;</italic> &#x02208; &#x00394;<italic><sub>R</sub>,</italic>] - a conservative estimate for individual coverage rates.</p><p id="P46">This interval can be estimated directly by finding the <italic>&#x00074;&#x020d7;</italic> on the probability simplex that minimizes <italic>t<sub>j</sub></italic> such that the log likelihood ratio <italic>lhd</italic>(<italic>Y;&#x00074;&#x020d7;<sub>mle</sub></italic>) &#x02212; <italic>lhd</italic>(<italic>Y;&#x00074;&#x020d7;</italic>) is above some critical value (<xref rid="SD1" ref-type="supplementary-material">Supp 1.2.3</xref>). Since the asymptotic distribution of <italic>lhd</italic>(<italic>Y;&#x00074;&#x020d7;<sub>mle</sub></italic>) &#x02212; <italic>lhd</italic>(<italic>Y;&#x00074;&#x020d7;</italic>), a log likelihood ratio statistic<sup><xref rid="R39" ref-type="bibr">39</xref></sup> with one degree of freedom, is 
<inline-formula><mml:math id="M4" overflow="scroll"><mml:mstyle scriptlevel="1"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:msup><mml:mi>&#x003c7;</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> we set the critical value to 
<inline-formula><mml:math id="M5" overflow="scroll"><mml:mstyle scriptlevel="1"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:msup><mml:mi>&#x003c7;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> for some desired marginal significance level <italic>&#x003b1;</italic>. When the model is identifiable, simulations show that this approach produces confidence bounds with the correct rejection rates for realistic sample sizes (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1e</xref>).</p><p id="P47">If the statistical model is not identifiable, then the likelihood solution has no unique maximum even as the read depth approaches infinity. However, for the purposes of visualization or comparative analysis, it may still be useful to quantify a representative set of transcripts, in which case we must make further assumptions. A natural assumption is that the set of transcripts present in solution for a given gene is small. Optimally, we would identify the smallest such subset of transcripts that achieves near the maximum likelihood, but this is not computationally feasible. Instead, we maximize the augmented objective, 
<inline-formula><mml:math id="M6" overflow="scroll"><mml:msub><mml:mo>max</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.16667em"/><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="italic">lhd</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo>;</mml:mo><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mstyle scriptlevel="1"><mml:mfrac><mml:mi>&#x003bb;</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> subject to <italic>t<sub>j</sub></italic> &#x02265; 0 and &#x003a3;<italic><sub>j</sub>t<sub>j</sub></italic> = 1, where <italic>&#x003bb;</italic> is a tuning parameter that determines the sparsity of the resulting solution. Although this optimization problem is not convex, it can be solved by solving <italic>N<sub>t</sub></italic> convex problems<sup><xref rid="R40" ref-type="bibr">40</xref></sup>. We set <italic>&#x003bb;</italic> to 
<inline-formula><mml:math id="M7" overflow="scroll"><mml:mstyle scriptlevel="1"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mo>max</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>min</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>&#x02192;</mml:mo></mml:mover><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>&#x003c7;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:msup><mml:mi>&#x003c7;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:math></inline-formula> which guarantees that the estimate for <italic>&#x00074;&#x020d7;</italic> lies within the confidence region &#x00394;<italic><sub>R</sub></italic> (<xref rid="SD1" ref-type="supplementary-material">Supplementary Note 1</xref> &#x02013; Choosing the Sparsity Parameter).</p><p id="P65">For unidentifiable models, our method produces a lower confidence bound of zero for every transcript in the gene. This allows the user to easily identify regions in which RNA-seq data alone is not sufficient to identify the set of transcripts present. In contrast, Cufflinks and Rsem 20 both use a Bayesian approach, sampling from a posterior distribution to estimate confidence bounds. In complex genes, such as Dscam1 or Mhc, the resulting confidence bounds are strongly dependent on the prior distribution, which typically leads to dramatically anti-conservative confidence bounds (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1f</xref>).</p></sec></sec><sec id="S13"><title>Ptth Analysis</title><p id="P48">Protein sub-cellular localization signals were predicted using the WoLFPSORT<sup><xref rid="R41" ref-type="bibr">41</xref></sup> Command Line Package Version 0.2 in the &#x0201c;animal&#x0201d; setting.</p></sec><sec id="S14"><title>Identifying Flybase Transcripts Expressed in Ad20dHeads</title><p id="P49">A Flybase transcript was considered expressed in Ad20dHeads if either: it was unspliced; or, it was spliced, and every splice junction was present in at least one RNAseq sample.</p></sec><sec id="S15"><title>TSS Motif Enrichment</title><p id="P50">To identify motif enrichment in the genome sequence surrounding annotated TSSs, for each tool, we first identified the unique set of transcript start sites. Then, for each TSS, we scanned the genome sequence taken from BDGP5 genome for the TATA motif (TATAAA) and the Inr Motif ([CT][CT]A[ACGT][AT][CT][CT]). A base position was considered a hit if the motif match was exact. Finally, we summed the number of hits at each position, and then divided by the total number of sequences to produce enrichment numbers.</p><p id="P51">To identify significantly enriched regions, we used a non-parametric approach, performing the above analysis 100000 times from randomly sampled sequence. We sampled chosen randomly from FlyBase 5.45 identified 3&#x02032; UTRs, which provides a background with similar sequence composition to 5&#x02032; UTRs. A particular position was considered enriched if its value was greater than 99990 of the bootstrapped samples, so that the Type I error rate is expected to be 1%, after correcting for multiple testing (Bonferroni).</p></sec><sec id="S16"><title>Mapping</title><p id="P52">We used the RNA-seq and CAGE mappings provided by the modENCODE consortium, and distributed by the SRA. (<xref rid="SD1" ref-type="supplementary-material">Supplementary Table 1</xref>). The poly(A)-site-seq data was mapped with Statmap 19 using the polya assay annotation option, which discards mappings that map to the reference genome before the poly(A) tail is trimmed.</p></sec><sec id="S17"><title>Running Cufflinks</title><p id="P53">We ran Cufflinks version 2.1.1 on the merged Male and Female RNAseq data using the default configuration options to build the initial transcript sets. Then, we ran Cufflinks in quantification mode (-G option) to provide replicate level quantifications. We did analyze the quantifications produced by running Cufflinks on the replicates independently, but we found them to be of much lower quality than the re-quantified versions (data not shown).</p></sec><sec id="S18"><title>Running Scripture</title><p id="P54">Due to technical issues, we were not able to run the Scripture version available at <ext-link ext-link-type="uri" xlink:href="http://www.broadinstitute.org/software/scripture/">http://www.broadinstitute.org/software/scripture/</ext-link> in house. After some discussion, the authors generously ran alpha version 3.1 on the merged female 20 day adult dissected head data, and provide us the resulting annotation. The parameters used were: 1) premature assembly filter - 0.2; 2) minimum number of spliced reads - 3.0; 3) percentage of total spliced reads - 0.05; 4) alpha for single exon assemblies - 0.01.</p></sec><sec id="S19"><title>Running Trinity</title><p id="P55">We used the Trinity version 2013-08-14 with the max_number_of_paths_per_node set to 1000 to identify transcript models. We used Rsem to estimate expression (described below) and gmap version 2013-09-11 to map the quantified models to the BDGPv5 reference genome. All other command line options were the packaged defaults.</p></sec><sec id="S20"><title>Running Rsem</title><p id="P56">We used Rsem version 1.2.7 with the &#x02013;stranded option to quantify transcripts. We used gmap version 2013-09-11 to map the quantified models to the BDGPv5 reference genome. All other command line options were the packaged defaults.</p></sec><sec id="S21"><title>Simulations</title><p id="P57">We used the simulation script distributed with GRIT to simulate mapped read data for all simulations. The tool works by first sampling a random transcript from the provided frequency distribution, then sampling a random fragment length from the provided fragment length distribution, and finally choosing a fragment uniformly from the chosen transcript with the chosen fragment length until the desired number of samples is achieved. We do not introduce any sequencing or mapping artifacts into the simulated reads. We note that this simulation is consistent with the GRIT, Cufflinks, and Rsem transcript expression models.</p><p id="P58">We only compared the performance of GRIT, Cufflinks and Trinity+Rsem in simulations because they were the tools that performed best on real data.</p><p id="P59">For the synthetic gene simulations (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2 b&#x02013;f</xref>) we sampled from the transcripts uniformly, with a Normal (150, 25) fragment length distribution truncated at &#x000b1;2 standard deviations. We ran GRIT, Trinity, and Cufflinks in quantification mode. We used GRIT&#x02019;s compare_annotations.py with a boundary match of &#x000b1;20 bp to calculate recall and precision numbers. We ran 100 simulations total; 20 simulations with each of 100, 1000, 1<italic>e</italic><sup>4</sup>, and 1<italic>e</italic><sup>5</sup> simulated reads.</p><p id="P60">For the <italic>Dscam1</italic> simulations (<xref rid="SD1" ref-type="supplementary-material">Supplementary Figure 2a</xref>), we used the set of DSCAM exons from FlyBase 5.45 to enumerate all possible 38016 DSCAM transcript models. We used a Normal (300,25) fragment length distribution truncated at &#x000b1; 2 standard deviations. We ran GRIT, Trinity, and Cufflinks in quantification mode. We used GRIT&#x02019;s compare_annotations.py with a boundary match of &#x000b1;20 bp to calculate recall and precision numbers.</p></sec></sec><sec sec-type="supplementary-material" id="S22"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>1</label><media xlink:href="NIHMS566373-supplement-1.pdf" orientation="portrait" xlink:type="simple" id="d37e1458" position="anchor"/></supplementary-material></sec></body><back><ack id="S23"><p>We thank the members of the modENCODE transcription consortium for generating the data, Carolyn Cotterman, Erwin Frise, Brenton Garveley, Haiyan Huang and Jingyi Li for discussions. This work was funded by a contract from the National Human Genome Research Institute modENCODE Project, contracts R21 HG006187 to P.J.B.; K99 HG006698 to J.B.B.; U01 HG004271 to S.E.C under Department of Energy contract no. DE-AC02-05CH11231.</p></ack><fn-group><fn id="FN3"><p><bold>Accession Codes</bold></p><p>All software associated with this project and the pipelines run to generate these annotations are available for download at <ext-link ext-link-type="uri" xlink:href="http://grit-bio.org/">http://grit-bio.org/</ext-link> and as <xref rid="SD1" ref-type="supplementary-material">Supplementary Data</xref>. All annotation data are available at <ext-link ext-link-type="uri" xlink:href="http://grit-bio.org/nature-biotech-submission.html">http://grit-bio.org/nature-biotech-submission.html</ext-link>. SRA accession numbers are provided in <xref rid="SD1" ref-type="supplementary-material">Supplementary Table 1</xref>.</p></fn><fn id="FN4" fn-type="con"><p><bold>Author Contributions</bold></p><p>N.B. and P.J.B. developed the mathematics and statistics. N.B, J.B.B., and M.S. developed the exon discovery method. N.B. designed the algorithms. N.B. implemented GRIT. B.W.B. aligned the Illumina data. N.B. performed the analysis. P.J.B, J.B.B. and S.E.C. conceived the project. N.B. wrote the paper with input from J.B.B., P.J.B and S.E.C. All authors tested the software, discussed the results and commented on the manuscript.</p></fn><fn id="FN5" fn-type="conflict"><p><bold>Competing financial interests</bold></p><p>The authors declare no competing financial interests.</p></fn></fn-group><ref-list><title>Bibliography</title><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Gerstein</surname><given-names>M</given-names></name><name><surname>Snyder</surname><given-names>M</given-names></name></person-group><article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title><source>Nature Reviews Genetics</source><volume>10 </volume><issue>1</issue><fpage>57</fpage><lpage>63</lpage><year>2009</year></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graveley</surname><given-names>BR</given-names></name><etal/></person-group><article-title>The developmental transcriptome of Drosophila melanogaster</article-title><source>Nature</source><volume>471 </volume><issue>7339</issue><fpage>473</fpage><lpage>479</lpage><year>2010</year><pub-id pub-id-type="pmid">21179090</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mortazavi</surname><given-names>A</given-names></name><name><surname>Williams</surname><given-names>BA</given-names></name><name><surname>McCue</surname><given-names>K</given-names></name><name><surname>Schaeffer</surname><given-names>L</given-names></name><name><surname>Wold</surname><given-names>B</given-names></name></person-group><article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title><source>Nature methods</source><volume>5 </volume><issue>7</issue><fpage>621</fpage><lpage>628</lpage><year>2008</year><pub-id pub-id-type="pmid">18516045</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><etal/></person-group><article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title><source>Nature biotechnology</source><volume>28 </volume><issue>5</issue><fpage>511</fpage><lpage>515</lpage><year>2010</year></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grabherr</surname><given-names>MG</given-names></name><etal/></person-group><article-title>Full-length transcriptome assembly from RNA-Seq data without a reference genome</article-title><source>Nature biotechnology</source><volume>29 </volume><issue>7</issue><fpage>644</fpage><lpage>652</lpage><year>2011</year></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guttman</surname><given-names>M</given-names></name><etal/></person-group><article-title>Ab initio reconstruction of cell type-specific transcriptomes in mouse reveals the conserved multi-exonic structure of lincRNAs</article-title><source>Nature biotechnology</source><volume>28 </volume><issue>5</issue><fpage>503</fpage><lpage>510</lpage><year>2010</year></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schulz</surname><given-names>MH</given-names></name><name><surname>Zerbino</surname><given-names>DR</given-names></name><name><surname>Vingron</surname><given-names>M</given-names></name><name><surname>Birney</surname><given-names>E</given-names></name></person-group><article-title>Oases: robust de novo RNA-seq assembly across the dynamic range of expression levels</article-title><source>Bioinformatics</source><volume>28 </volume><issue>8</issue><fpage>1086</fpage><lpage>1092</lpage><year>2012</year><pub-id pub-id-type="pmid">22368243</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robertson</surname><given-names>G</given-names></name><etal/></person-group><article-title>De novo assembly and analysis of RNA-seq data</article-title><source>Nature methods</source><volume>7 </volume><issue>11</issue><fpage>909</fpage><lpage>912</lpage><year>2010</year><pub-id pub-id-type="pmid">20935650</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tu</surname><given-names>Q</given-names></name><name><surname>Cameron</surname><given-names>RA</given-names></name><name><surname>Worley</surname><given-names>KC</given-names></name><name><surname>Gibbs</surname><given-names>RA</given-names></name><name><surname>Davidson</surname><given-names>EH</given-names></name></person-group><article-title>Gene structure in the sea urchin Strongylocentrotus purpuratus based on transcriptome analysis</article-title><source>Genome Research</source><volume>22 </volume><issue>10</issue><fpage>2079</fpage><lpage>2087</lpage><year>2012</year><pub-id pub-id-type="pmid">22709795</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrow</surname><given-names>J</given-names></name><etal/></person-group><article-title>GENCODE: The reference human genome annotation for The ENCODE Project</article-title><source>Genome research</source><volume>22 </volume><issue>9</issue><fpage>1760</fpage><lpage>1774</lpage><year>2012</year><pub-id pub-id-type="pmid">22955987</pub-id></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gelbart</surname><given-names>W</given-names></name><etal/></person-group><article-title>The FlyBase database of the Drosophila genome projects and community literature</article-title><source>Nucleic Acids Research</source><volume>27</volume><year>1999</year></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Collins</surname><given-names>JE</given-names></name><name><surname>White</surname><given-names>S</given-names></name><name><surname>Searle</surname><given-names>SM</given-names></name><name><surname>Stemple</surname><given-names>DL</given-names></name></person-group><article-title>Incorporating RNA-seq data into the zebrafish Ensembl genebuild</article-title><source>Genome research</source><volume>22 </volume><issue>10</issue><fpage>2067</fpage><lpage>2078</lpage><year>2012</year><pub-id pub-id-type="pmid">22798491</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yook</surname><given-names>K</given-names></name><etal/></person-group><article-title>WormBase 2012: more genomes, more data, new website</article-title><source>Nucleic acids research</source><volume>40 </volume><issue>D1</issue><fpage>D735</fpage><lpage>D741</lpage><year>2012</year><pub-id pub-id-type="pmid">22067452</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>H</given-names></name><name><surname>Wong</surname><given-names>WH</given-names></name></person-group><article-title>Statistical inferences for isoform expression in RNA-Seq</article-title><source>Bioinformatics</source><volume>25 </volume><issue>8</issue><fpage>1026</fpage><lpage>1032</lpage><year>2009</year><pub-id pub-id-type="pmid">19244387</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bullard</surname><given-names>J</given-names></name><name><surname>Purdom</surname><given-names>E</given-names></name><name><surname>Hansen</surname><given-names>K</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name></person-group><article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title><source>BMC bioinformatics</source><volume>11 </volume><issue>1</issue><fpage>94</fpage><year>2010</year><pub-id pub-id-type="pmid">20167110</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hansen</surname><given-names>KD</given-names></name><name><surname>Brenner</surname><given-names>SE</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name></person-group><article-title>Biases in Illumina transcriptome sequencing caused by random hexamer priming</article-title><source>Nucleic acids research</source><volume>38 </volume><issue>12</issue><fpage>e131</fpage><lpage>e131</lpage><year>2010</year><pub-id pub-id-type="pmid">20395217</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Risso</surname><given-names>D</given-names></name><name><surname>Schwartz</surname><given-names>K</given-names></name><name><surname>Sherlock</surname><given-names>G</given-names></name><name><surname>Dudoit</surname><given-names>S</given-names></name></person-group><article-title>GC-content normalization for RNA-Seq data</article-title><source>BMC bioinformatics</source><volume>12 </volume><issue>1</issue><fpage>480</fpage><year>2011</year><pub-id pub-id-type="pmid">22177264</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="johurnal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>JB</given-names></name><etal/></person-group><article-title>Diversity and dynamics of the Drosophila transcriptome</article-title><source>Nature</source><comment>(Submission ID 2012-12-15978A)</comment></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hoskins</surname><given-names>RA</given-names></name><etal/></person-group><article-title>Genome-wide analysis of promoter architecture in Drosophila melanogaster</article-title><source>Genome research</source><volume>21 </volume><issue>2</issue><fpage>182</fpage><lpage>192</lpage><year>2011</year><pub-id pub-id-type="pmid">21177961</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>B</given-names></name><name><surname>Dewey</surname><given-names>C</given-names></name></person-group><article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title><source>BMC bioinformatics</source><volume>12 </volume><issue>1</issue><fpage>323</fpage><year>2011</year><pub-id pub-id-type="pmid">21816040</pub-id></element-citation></ref><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marygold</surname><given-names>SJ</given-names></name><etal/></person-group><article-title>FlyBase: improvements to the bibliography</article-title><source>Nucleic acids research</source><volume>41 </volume><issue>D1</issue><fpage>D751</fpage><lpage>D757</lpage><year>2013</year><pub-id pub-id-type="pmid">23125371</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Lifton</surname><given-names>R</given-names></name><name><surname>Goldberg</surname><given-names>M</given-names></name><name><surname>Karp</surname><given-names>R</given-names></name><name><surname>Hogness</surname><given-names>D</given-names></name></person-group><article-title>The organization of the histone genes in Drosophila melanogaster: functional and evolutionary implications</article-title><conf-name>presented at Cold Spring Harbor symposia on quantitative biology</conf-name><year>1978</year><comment>(unpublished)</comment></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>JE</given-names></name><name><surname>Kadonaga</surname><given-names>JT</given-names></name></person-group><article-title>The RNA polymerase II core promoter: a key component in the regulation of gene expression</article-title><source>Genes \&#x00026; development</source><volume>16 </volume><issue>20</issue><fpage>2583</fpage><lpage>2592</lpage><year>2002</year><pub-id pub-id-type="pmid">12381658</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jenkins</surname><given-names>C</given-names></name><name><surname>Michael</surname><given-names>D</given-names></name><name><surname>Mahendroo</surname><given-names>M</given-names></name><name><surname>Simpson</surname><given-names>E</given-names></name></person-group><article-title>Exon-specific northern analysis and rapid amplification of cDNA ends (RACE) reveal that the proximal promoter II (PII) is responsible for aromatase cytochrome <italic>P<sub>450</sub></italic> (CYP 19) expression in human ovary</article-title><source>Molecular and cellular endocrinology</source><volume>97 </volume><issue>1</issue><fpage>R1</fpage><lpage>R6</lpage><year>1993</year><pub-id pub-id-type="pmid">8143890</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rojas-Duran</surname><given-names>MF</given-names></name><name><surname>Gilbert</surname><given-names>WV</given-names></name></person-group><article-title>Alternative transcription start site selection leads to large differences in translation activity in yeast</article-title><source>RNA</source><volume>18 </volume><issue>12</issue><fpage>2299</fpage><lpage>2305</lpage><year>2012</year><pub-id pub-id-type="pmid">23105001</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lawless</surname><given-names>C</given-names></name><etal/></person-group><article-title>Upstream sequence elements direct post-transcriptional regulation of gene expression under stress conditions in yeast</article-title><source>BMC genomics</source><volume>10 </volume><issue>1</issue><fpage>7</fpage><year>2009</year><pub-id pub-id-type="pmid">19128476</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Penalva</surname><given-names>LOS</given-names></name></person-group><article-title>RNA binding protein sex-lethal (Sxl) and control of Drosophila sex determination and dosage compensation</article-title><source>Microbiology and molecular biology reviews</source><volume>67 </volume><issue>3</issue><fpage>343</fpage><lpage>359</lpage><year>2003</year><pub-id pub-id-type="pmid">12966139</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cenik</surname><given-names>C</given-names></name><etal/></person-group><article-title>Genome analysis reveals interplay between 5&#x02032; UTR introns and nuclear mRNA export for secretory and mitochondrial genes</article-title><source>PLoS genetics</source><volume>7 </volume><issue>4</issue><fpage>e1001366</fpage><year>2011</year><pub-id pub-id-type="pmid">21533221</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Emanuelsson</surname><given-names>O</given-names></name><name><surname>Nielsen</surname><given-names>H</given-names></name><name><surname>Brunak</surname><given-names>S</given-names></name><name><surname>von Heijne</surname><given-names>G</given-names></name></person-group><article-title>Predicting subcellular localization of proteins based on their N-terminal amino acid sequence</article-title><source>Journal of molecular biology</source><volume>300 </volume><issue>4</issue><fpage>1005</fpage><lpage>1016</lpage><year>2000</year><pub-id pub-id-type="pmid">10891285</pub-id></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kawakami</surname><given-names>A</given-names></name><etal/></person-group><article-title>Molecular cloning of the Bombyx mori prothoracicotropic hormone</article-title><source>Science</source><volume>247 </volume><issue>4948</issue><fpage>1333</fpage><lpage>1335</lpage><year>1990</year><pub-id pub-id-type="pmid">2315701</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rewitz</surname><given-names>KF</given-names></name><name><surname>Yamanaka</surname><given-names>N</given-names></name><name><surname>Gilbert</surname><given-names>LI</given-names></name><name><surname>O&#x02019;Connor</surname><given-names>MB</given-names></name></person-group><article-title>The insect neuropeptide PTTH activates receptor tyrosine kinase torso to initiate metamorphosis</article-title><source>Science</source><volume>326 </volume><issue>5958</issue><fpage>1403</fpage><lpage>1405</lpage><year>2009</year><pub-id pub-id-type="pmid">19965758</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hilgers</surname><given-names>V</given-names></name><etal/></person-group><article-title>Neural-specific elongation of 3&#x02032; UTRs during Drosophila development</article-title><source>Proceedings of the National Academy of Sciences</source><volume>108 </volume><issue>38</issue><fpage>15864</fpage><lpage>15869</lpage><year>2011</year></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smibert</surname><given-names>P</given-names></name><etal/></person-group><article-title>Global Patterns of Tissue-Specific Alternative Polyadenylation in Drosophila</article-title><source>Cell reports</source><volume>1 </volume><issue>3</issue><fpage>277</fpage><lpage>289</lpage><year>2012</year><pub-id pub-id-type="pmid">22685694</pub-id></element-citation></ref><ref id="R34"><label>34</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Di Ruscio</surname><given-names>A</given-names></name><etal/></person-group><article-title>DNMT1-interacting RNAs block gene-specific DNA methylation</article-title><source>Nature</source><year>2013</year></element-citation></ref><ref id="R35"><label>35</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Celotto</surname><given-names>AM</given-names></name><name><surname>Graveley</surname><given-names>BR</given-names></name></person-group><article-title>Alternative splicing of the Drosophila Dscam pre-mRNA is both temporally and spatially regulated</article-title><source>Genetics</source><volume>159 </volume><issue>2</issue><fpage>599</fpage><lpage>608</lpage><year>2001</year><pub-id pub-id-type="pmid">11606537</pub-id></element-citation></ref><ref id="R36"><label>36</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wojtowicz</surname><given-names>WM</given-names></name><name><surname>Flanagan</surname><given-names>JJ</given-names></name><name><surname>Millard</surname><given-names>SS</given-names></name><name><surname>Zipursky</surname><given-names>SL</given-names></name><name><surname>Clemens</surname><given-names>JC</given-names></name></person-group><article-title>Alternative Splicing of Drosophila Dscam Generates Axon Guidance Receptors that Exhibit Isoform-Specific Homophilic Binding</article-title><source>Cell</source><volume>118 </volume><issue>5</issue><fpage>619</fpage><lpage>633</lpage><year>2004</year><pub-id pub-id-type="pmid">15339666</pub-id></element-citation></ref><ref id="R37"><label>37</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sharon</surname><given-names>D</given-names></name><name><surname>Tilgner</surname><given-names>H</given-names></name><name><surname>Grubert</surname><given-names>F</given-names></name><name><surname>Snyder</surname><given-names>M</given-names></name></person-group><article-title>A single-molecule long-read survey of the human transcriptome</article-title><source>Nature biotechnology</source><volume>31 </volume><issue>11</issue><fpage>1009</fpage><lpage>1014</lpage><year>2013</year></element-citation></ref><ref id="R38"><label>38</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Juneau</surname><given-names>K</given-names></name><name><surname>Nislow</surname><given-names>C</given-names></name><name><surname>Davis</surname><given-names>RW</given-names></name></person-group><article-title>Alternative splicing of PTC7 in Saccharomyces cerevisiae determines protein localization</article-title><source>Genetics</source><volume>183 </volume><issue>1</issue><fpage>185</fpage><lpage>194</lpage><year>2009</year><pub-id pub-id-type="pmid">19564484</pub-id></element-citation></ref><ref id="R39"><label>39</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bickel</surname><given-names>PJ</given-names></name><name><surname>Doksum</surname><given-names>KA</given-names></name></person-group><source>Mathematical Statistics, volume I</source><publisher-name>Prentice Hall Englewood</publisher-name><publisher-loc>Cliffs, NJ</publisher-loc><year>2001</year></element-citation></ref><ref id="R40"><label>40</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Pilanci</surname><given-names>M</given-names></name><name><surname>El Ghaoui</surname><given-names>L</given-names></name><name><surname>Chandrasekaran</surname><given-names>V</given-names></name></person-group><article-title>Recovery of Sparse Probability Measures via Convex Programming</article-title><conf-name>presented at Advances in Neural Information Processing Systems</conf-name><year>2012</year><comment>(unpublished)</comment></element-citation></ref><ref id="R41"><label>41</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horton</surname><given-names>P</given-names></name><etal/></person-group><article-title>WoLF PSORT: protein localization predictor</article-title><source>Nucleic acids research</source><volume>35 </volume><issue>suppl 2</issue><fpage>W585</fpage><lpage>W587</lpage><year>2007</year><pub-id pub-id-type="pmid">17517783</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" orientation="portrait" position="float"><label>Figure 1</label><caption><title>Element discovery overview</title><p><bold>(a) Exon discovery.</bold> For each gene segment we identify CAGE peaks; segment the gene region using the CAGE peaks, splice boundaries and poly(A) sites; label the segments based upon their boundaries; filter intron segments with low RNA-seq coverage; and build labeled exons from adjacent segments. <bold>(b) Transcript discovery.</bold> For each gene, we construct a graph where each node is an exon discovered in (b), and each edge is a junction. Then, each candidate transcript is identified with a single path through this directed graph that begins with TSS node, and ends with a TES node.</p></caption><graphic xlink:href="nihms566373f1"/></fig><fig id="F2" orientation="portrait" position="float"><label>Figure 2</label><caption><title>Comparison with existing tools</title><p><bold>(a) Recall and precision analysis.</bold> We compared the set of transcript isoforms discovered by GRIT, Cufflinks, Scripture and Trinity to the FlyBase annotation. A transcript was identified as a match if the internal structure was the same, and the distal boundaries were, variously, within 50 and 200 bp of one-another. <bold>(b) FPKM versus CAGE and poly(A)-site-seq counts.</bold> For each sample, we calculated the Spearman rank correlation between estimated transcript FPKMs and raw CAGE and poly(A)-site-seq read counts within 50 bp of each annotated promoter/poly(A) site. <bold>(c) Motif analysis.</bold> For each sample, we considered the sequence within 50 bp of annotated promoters. A position was considered a TATA motif hit if it matched the sequence &#x0201c;T-A-T-A-A&#x0201d;, and an Inr motif match if it matched the sequence &#x0201c;C/T-C/T-A-N-A/T-C/T-C/T&#x0201d;. The plots are aligned with respect to the first base in the annotated promoter, and plot the fraction of promoters that contain a motif match at each position, averaged over replicates.</p></caption><graphic xlink:href="nihms566373f2"/></fig><fig id="F3" orientation="portrait" position="float"><label>Figure 3</label><caption><title>GRIT annotation of <italic>D. Melanogaster</italic></title><p><bold>(a) Ptth.</bold> The Ptth gene encodes isoforms with multiple proteins due to alternative N-terminal splicing as well as promoter usage. The sample labeled &#x0201c;Imaginal Disc&#x0201d; corresponds to mass isolated tissues enriched more than 50% for imaginal discs. <bold>(b) Gene complexity</bold>. Although most genes have less than five isoforms, nearly half of transcript isoforms originate in genes that encode 100 or more distinct transcripts. <bold>(c) Sources of gene complexity.</bold> The Venn digram represents the 59.6% of genes that encode multiple transcript isoforms.</p></caption><graphic xlink:href="nihms566373f3"/></fig></floats-group></article>