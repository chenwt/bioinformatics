<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName A++V2.4.dtd?><?SourceDTD.Version 2.4?><?ConverterInfo.XSLTName springer2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id><journal-title-group><journal-title>BMC Bioinformatics</journal-title></journal-title-group><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">5148902</article-id><article-id pub-id-type="publisher-id">1403</article-id><article-id pub-id-type="doi">10.1186/s12859-016-1403-0</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Robust multi-group gene set analysis with few replicates</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5177-3431</contrib-id><name><surname>Mishra</surname><given-names>Pashupati P.</given-names></name><address><email>pashupati.mishra@helsinki.fi</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Medlar</surname><given-names>Alan</given-names></name><address><email>alan.j.medlar@helsinki.fi</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Holm</surname><given-names>Liisa</given-names></name><address><email>liisa.holm@helsinki.fi</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>T&#x000f6;r&#x000f6;nen</surname><given-names>Petri</given-names></name><address><email>petri.toronen@helsinki.fi</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label>Institute of Biotechnology, University of Helsinki, P.O. Box 56, Viikinkaari 5, Helsinki, 00014 Finland </aff><aff id="Aff2"><label>2</label>Department of Biosciences, University of Helsinki, Viikinkaari 1, Helsinki, 00014 Finland </aff></contrib-group><pub-date pub-type="epub"><day>9</day><month>12</month><year>2016</year></pub-date><pub-date pub-type="pmc-release"><day>9</day><month>12</month><year>2016</year></pub-date><pub-date pub-type="collection"><year>2016</year></pub-date><volume>17</volume><elocation-id>526</elocation-id><history><date date-type="received"><day>1</day><month>7</month><year>2016</year></date><date date-type="accepted"><day>1</day><month>12</month><year>2016</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2016</copyright-statement><license license-type="OpenAccess"><license-p>
<bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p>Competitive gene set analysis is a standard exploratory tool for gene expression data. Permutation-based competitive gene set analysis methods are preferable to parametric ones because the latter make strong statistical assumptions which are not always met. For permutation-based methods, we permute samples, as opposed to genes, as doing so preserves the inter-gene correlation structure. Unfortunately, up until now, sample permutation-based methods have required a minimum of six replicates per sample group.</p></sec><sec><title>Results</title><p>We propose a new permutation-based competitive gene set analysis method for multi-group gene expression data with as few as three replicates per group. The method is based on advanced sample permutation technique that utilizes all groups within a data set for pairwise comparisons. We present a comprehensive evaluation of different permutation techniques, using multiple data sets and contrast the performance of our method, mGSZm, with other state of the art methods. We show that mGSZm is robust, and that, despite only using less than six replicates, we are able to consistently identify a high proportion of the top ranked gene sets from the analysis of a substantially larger data set. Further, we highlight other methods where performance is highly variable and appears dependent on the underlying data set being analyzed.</p></sec><sec><title>Conclusions</title><p>Our results demonstrate that robust gene set analysis of multi-group gene expression data is permissible with as few as three replicates. In doing so, we have extended the applicability of such approaches to resource constrained experiments where additional data generation is prohibitively difficult or expensive. An R package implementing the proposed method and supplementary materials are available from the website <ext-link ext-link-type="uri" xlink:href="http://ekhidna.biocenter.helsinki.fi/downloads/pashupati/mGSZm.html">http://ekhidna.biocenter.helsinki.fi/downloads/pashupati/mGSZm.html</ext-link>.</p></sec><sec><title>Electronic supplementary material</title><p>The online version of this article (doi:10.1186/s12859-016-1403-0) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Gene set analysis</kwd><kwd>Gene expression</kwd><kwd>Permutation</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2016</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p>Gene set analysis is an increasingly popular methodological approach for the analysis of molecular profiles such as gene expression [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], metabolomics [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>] and genome-wide association data [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]. In gene set analysis, statistical tests are performed on groups of genes that share characteristics defined by prior biological knowledge, for example, biological function [<xref ref-type="bibr" rid="CR7">7</xref>] or regulatory pathway involvement [<xref ref-type="bibr" rid="CR8">8</xref>]. A typical gene set analysis method starts by comparing genes between treatment groups. For each gene, a score for differential expression is calculated (for example, fold change and t-score). A gene set score is a function of scores from member genes. The gene set scores are then assigned <italic>P</italic>-values with either parametric or non-parametric methods.</p><p>Gene set analysis methods fall into two major categories: competitive and self-contained [<xref ref-type="bibr" rid="CR9">9</xref>]. Competitive methods, the focus of this article, test the null hypothesis that a gene set is not more associated with the phenotype of interest than a random sample from its complement set of genes. Self-contained methods, however, test whether or not a gene set is associated with the phenotype considering only genes from the tested gene set. Under the null hypothesis, competitive methods assumes that genes are independent which is violated by gene-gene correlation observed in gene expression data. Studies have suggested the use of sample permutation to generate the null distribution for <italic>P</italic>-value estimation as it preserves the gene-gene correlation [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. The most popular competitive methods are based on sample permutation and competitive statistics (implicit gene sampling) for gene set scores [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. Several parametric methods have also been developed which, although faster, make strong statistical assumptions that are not always met [<xref ref-type="bibr" rid="CR13">13</xref>&#x02013;<xref ref-type="bibr" rid="CR15">15</xref>]. While sample permutation-based approaches do not make such strong assumptions, large number of permutations are necessary for accurate <italic>P</italic>-value estimation. Indeed, it has recently been shown by Mishra et al. that the popular choice of 1000 permutations is inadequate and results in a loss of precision particularly visible in the tail-end of the gene set score distribution [<xref ref-type="bibr" rid="CR16">16</xref>]. This loss of precision is important because it can result in the same <italic>P</italic>-value being assigned to multiple gene sets whose true significance varies. In addition to being inaccurate, the relative ranking of gene sets with the same <italic>P</italic>-value is arbitrary.</p><p>We recently proposed a sample permutation-based competitive gene set analysis method, mGSZ [<xref ref-type="bibr" rid="CR16">16</xref>], that combines features from both parametric and permutation-based approaches. In mGSZ, <italic>P</italic>-values are estimated from empirical null distribution of gene set scores smoothed with a continuous distribution. We showed that the semi-parametric approach requires far fewer permutations (as low as 200) compared to other sample permutation-based methods and produces biologically plausible results. Despite the significant improvement in efficiency, mGSZ still requires at least six biological replicates per sample group to give accurate results. Multi-group gene expression data with fewer than six replicates, however, are common and na&#x000ef;ve application of sample permutation in this context is, as we have stated, potentially unreliable.</p><p>This article proposes mGSZm, a new competitive gene set analysis method for multi-group gene expression data with as few as three biological replicates per sample group. The method is based on advanced sample permutation technique that utilizes all sample groups to generate an appropriate number of permutations for pairwise comparisons.</p></sec><sec id="Sec2"><title>Methods</title><sec id="Sec3"><title>Permutation methods</title><p>Permutation-based gene set analysis methods estimate the null distribution by recalculating gene set scores for many permutations of the data (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The tested gene set scores are then compared to the null distribution for the estimation of <italic>P</italic>-values. A large number of permutations is required to obtain the null distribution and its quality is dependent on the permutation method. An ideal null distribution would include all the important noise signals (like variations within a group and gene-gene correlations) and lack true biological signals (differences between groups). Improper permutation methods can generate permutations that are almost identical to the correct sample labels, causing true biological signal to &#x0201c;leak&#x0201d; into the null distribution (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). This corruption of the null distribution can also occur when some groups in multi-group gene expression data are highly correlated.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Gene set analysis pipeline. General pipeline for permutation based gene set analysis</p></caption><graphic xlink:href="12859_2016_1403_Fig1_HTML" id="MO1"/></fig>
<fig id="Fig2"><label>Fig. 2</label><caption><p>Examples of bad and good permutations. Examples of bad and good permutations. Cancer2* and Healthy1* represent permuted Cancer2 and Healthy1 groups. Under bad permutation examples, Cancer2* fails to include samples from healthy groups and Healthy1* fails to include samples from cancer groups causing strong leakage of biological signal into null distribution. Under good permutation examples, Cancer2* and Healthy1* includes samples from both healthy and cancer groups evenly</p></caption><graphic xlink:href="12859_2016_1403_Fig2_HTML" id="MO2"/></fig>
</p><p>We propose that, in a multi-group gene expression dataset, groups other than those being compared can be used for the estimation of null distribution. Other than the phenomena being investigated, we assume that the same inherent structure, including gene-gene correlations, occur similarly across all groups, differential gene expression score represents gene regulation and co-regulation of member genes of a gene set represents regulation of the associated biological process.</p><p>We evaluated six different permutation methods for multi-group gene expression data, referred to as Perm1-6. Perm1 is the widely used na&#x000ef;ve permutation method of only permuting the labels of the groups being compared [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. The rest of the permutation methods are new approaches proposed by us that aim to prevent signal leakage by ensuring that permuted groups do not contain many samples from a single original group. Sampling is least constrained (most random) in Perm2 and most constrained (least random) in Perm6. By constraining what permutations are generated we aim to ensure that permuted groups do not correlate with the original groups. Perm3-6 showed similar performance in our evaluations (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Figure 12) and therefore, for clarity, we only describe Perm 4 in detail in this article. For details on Perm3, Perm5 and Perm6 see Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Sections 1-4.</p><p>We use the following notation to describe each permutation method: 
<list list-type="bullet"><list-item><p>Number of replicates in a group. For simplicity, we let <italic>n</italic> be constant for all groups.</p></list-item><list-item><p>Total number of groups in multi-group gene expression data.</p></list-item><list-item><p>Total number of samples in all the groups.</p></list-item><list-item><p>Total number of samples in the groups being analyzed.</p></list-item><list-item><p>Total number of permutations from permutation method <italic>x</italic>.</p></list-item></list>
</p><p>
<bold>Perm1</bold> This is the most basic permutation method where only samples from the groups being compared have their sample labels permuted (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). This approach is not suitable for data sets with few replicates because of the limited number of unique permutations, given by: 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  N|Perm1| = \frac{1}{2} \: \frac{z!}{n!(z-n)!}  $$ \end{document}</tex-math><mml:math id="M2"><mml:mi>N</mml:mi><mml:mo>|</mml:mo><mml:mtext mathvariant="italic">Perm</mml:mtext><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mspace width="2.22144pt"/><mml:mfrac><mml:mrow><mml:mi>z</mml:mi><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2016_1403_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
<fig id="Fig3"><label>Fig. 3</label><caption><p>Permutation methods. Schematic diagram representing the three permutation methods (Perm1, Perm2 and Perm4). The steps shown in each of the permutation methods are repeated for X times, where X is the number of permutations. See Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Sections 1-5 for details</p></caption><graphic xlink:href="12859_2016_1403_Fig3_HTML" id="MO3"/></fig>
</p><p>The factor 1/2 is to exclude permutations that are mirror images of one another and give identical results, for example, (1,1,0,0) and (0,0,1,1). For example, in multi-group gene expression dataset with <italic>m</italic>=6 and <italic>n</italic>=5, the total number of obtainable permutations is 126.</p><p>
<bold>Perm2</bold> We permute the sample group labels for all samples in the data set, not just those being analysed. Suppose we are analysing two sample groups <italic>B</italic> and <italic>D</italic>, a single permutation is defined as the current samples with those labels (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). This method allows for the situation where permutations may not contain a single sample from the groups currently being analysed. Furthermore, there is a risk of incorporating biological signal into the null distribution because permutations can include many or all samples from their respective original groups (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). The total number of unique permutations from this method is given by: 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$  N|Perm2| = \frac{1}{2} \: \frac{y!}{n! n!(y-2n)!}  $$ \end{document}</tex-math><mml:math id="M4"><mml:mi>N</mml:mi><mml:mo>|</mml:mo><mml:mtext mathvariant="italic">Perm</mml:mtext><mml:mn>2</mml:mn><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mspace width="2.22144pt"/><mml:mfrac><mml:mrow><mml:mi>y</mml:mi><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo><mml:mi>n</mml:mi><mml:mo>!</mml:mo><mml:mo>(</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="12859_2016_1403_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>
</p><p>The total number of unique permutations that can be obtained with our example dataset with <italic>m</italic>=6 and <italic>n</italic>=5 is 3.8<italic>e</italic>+9.</p><p>
<bold>Perm4</bold> Similar to Perm2, Perm4 produces the null distribution using all sample groups in the data set. When <italic>m</italic>&#x0003e;<italic>n</italic>, permutations are generated in two stages: group selection followed by sample selection from those groups (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). Groups are selected by starting with the two groups being analyzed followed by sampling <italic>n</italic>&#x02212;2 additional groups without replacement. Samples are selected randomly, one from each of the previously selected sample groups. This procedure must be repeated to obtain the second half of the permutation, with the exception that samples found in the first half are explicitly filtered out. The mean estimate, therefore, is not strongly influenced by any individual groups. For simplicity, we will consider the lower bound of the number of unique permutations, which is given by: 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {}\begin{aligned} N|Perm4| =\! \frac{1}{2}\: n^{n} (n-1)^{n} \left(\frac{(m-2)!}{(n-2)!(m-n)!}\right)^{2}, \quad m\! &#x0003e;\! n \end{aligned}  $$ \end{document}</tex-math><mml:math id="M6"><mml:mtable><mml:mtr><mml:mtd><mml:mi>N</mml:mi><mml:mo>|</mml:mo><mml:mtext mathvariant="italic">Perm</mml:mtext><mml:mn>4</mml:mn><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mspace width="2.22144pt"/><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>!</mml:mo><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>m</mml:mi><mml:mspace width="0.3em"/><mml:mo>&#x0003e;</mml:mo><mml:mspace width="0.3em"/><mml:mi>n</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12859_2016_1403_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>
</p><p>The total number of obtainable permutations from Perm4 for an example case with <italic>m</italic>=6 and <italic>n</italic>=5 is 2.6<italic>e</italic>+7</p></sec><sec id="Sec7"><title>Gene Set Z-score</title><p>We implemented all permutation methods together with Gene Set Z-score (GSZ) [<xref ref-type="bibr" rid="CR17">17</xref>] for evaluation. GSZ is a gene set scoring method based on a hypergeometric enrichment score weighted with the differential expression test scores [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] and has been successfully used in several projects [<xref ref-type="bibr" rid="CR18">18</xref>&#x02013;<xref ref-type="bibr" rid="CR20">20</xref>]. As the scoring function is a constant, any differences in the results can be attributed to differences in the permutation methods. Based on the results of the evaluation, we implemented Perm4 in mGSZ. We refer to the modified version of mGSZ as mGSZm (Table <xref rid="Tab1" ref-type="table">1</xref>).
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Compared competitive gene set analysis methods</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Compared methods</th><th align="left">Permutation type</th><th align="left">Descriptions</th><th align="left"/></tr></thead><tbody><tr><td align="left">mGSZm</td><td align="left">sample</td><td align="left">mGSZ from R package <italic>mGSZ</italic> updated with Perm4</td><td align="left"/></tr><tr><td align="left">mGSA</td><td align="left">sample</td><td align="left">Gene Set Z-score based gene set analysis method similar to GSA [<xref ref-type="bibr" rid="CR17">17</xref>]</td><td align="left"/></tr><tr><td align="left">Allez</td><td align="left">parametric</td><td align="left">Allez from R package <italic>allez</italic> [<xref ref-type="bibr" rid="CR14">14</xref>]</td><td align="left"/></tr><tr><td align="left">wKS</td><td align="left">sample</td><td align="left">wKS from R package <italic>mGSZ</italic> [<xref ref-type="bibr" rid="CR16">16</xref>]</td><td align="left"/></tr><tr><td align="left">GAGE</td><td align="left">parametric</td><td align="left">Generally applicable gene set enrichment from R package gage [<xref ref-type="bibr" rid="CR21">21</xref>]</td><td align="left"/></tr><tr><td align="left">CAMERA</td><td align="left">parametric</td><td align="left">Correlation adjusted mean rank gene set test from R package limma [<xref ref-type="bibr" rid="CR13">13</xref>]</td><td align="left"/></tr><tr><td align="left">QuSAGE</td><td align="left">parametric</td><td align="left">Quantitative set analysis of gene expression from R package qusage [<xref ref-type="bibr" rid="CR22">22</xref>]</td><td align="left"/></tr><tr><td align="left">romer</td><td align="left">sample</td><td align="left">Rotation testing using mean ranks from R package limma [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]</td><td align="left"/></tr></tbody></table></table-wrap>
</p></sec><sec id="Sec8"><title>Compared gene set analysis methods</title><p>We evaluated mGSZm together with several gene set analysis methods from the literature: GAGE (Generally Applicable Gene-set Enrichment) [<xref ref-type="bibr" rid="CR21">21</xref>], CAMERA (Correlation Adjusted MEan RAnk gene set test) [<xref ref-type="bibr" rid="CR13">13</xref>], QuSAGE (Quantitative Set Analysis of Gene Expression) [<xref ref-type="bibr" rid="CR22">22</xref>]) and Allez [<xref ref-type="bibr" rid="CR14">14</xref>] (Table 1). GAGE is based on parametric gene randomization and thus neglects gene-gene correlation. Another major difference between GAGE and the other methods is that GAGE is based on log fold change as gene statistics, whereas the others are based on Moderated t-test [<xref ref-type="bibr" rid="CR23">23</xref>]. CAMERA is also based on parametric gene randomization, however it corrects the errors introduced by gene-gene correlation in a gene set by incorporating a Variance Inflation Factor (VIF) estimated directly from the data. QuSAGE is similar to CAMERA, except that it associates a complete probability density function to a gene set score instead of a <italic>P</italic>-value and does not require the assumption of equal variance of gene level signals in a gene set for the estimation of VIF. In Allez, the gene set scoring function calculates the mean value of the differential expression test scores for all the genes in the analyzed gene set followed by normalization. We also included the two most popular sample permutation-based competitive gene set analysis methods, mGSA and wKS. mGSA is a sample permutation-based competitive gene set analysis method that is similar to GSA (Gene Set Analysis) [<xref ref-type="bibr" rid="CR10">10</xref>]. mGSA is based on Gene Set Z-score instead of max-mean statistics. Unlike the original GSA, mGSA is applicable for one-on-one comparison of selected groups in multi-group gene expression data. Note that we have shown improved performance of mGSA compared to GSA in our previous article [<xref ref-type="bibr" rid="CR16">16</xref>]. wKS (weighted Kolmogorov Smirnov) is our version of gene set analysis method, GSEA [<xref ref-type="bibr" rid="CR12">12</xref>]. In addition, we included romer [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>] (Rotation testing using mean ranks), a competitive gene set analysis method based on a linear model. The number of permutations in permutation based methods was set to 1000 and all the rest of the parameters in all the methods were set to default.</p></sec><sec id="Sec9"><title>Evaluation</title><p>Evaluation of gene set analysis methods is a challenge due to a lack of ground truth and the fact that any ranking of methods will vary between different datasets and evaluation criteria. While the use of simulated data is common, reliability is often questionable as it can oversimplify complex biological phenomena. Another approach is to evaluate gene set rankings based on biological relevance. This approach avoids the negative aspects of simulated data, but requires extensive literature review and assessing the relevance of gene sets is difficult. We address these challenges with three complementary evaluation approaches based on: i) data splitting, ii) detection of tissue specific gene sets and iii) generation of type 1 error.</p><sec id="Sec10"><title>Evaluation based on data splitting</title><p>Our data splitting method partitions a data set into <italic>test</italic> and <italic>reference</italic> subsets (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), similar to the cross validation approach used by T&#x000f6;r&#x000f6;nen et al. [<xref ref-type="bibr" rid="CR17">17</xref>]. This approach requires a data set with more than two sample groups and a large number of replicates per group. After splitting, the test and reference partitions comprise 25% and 75% of the data (arrays), respectively. We generated <italic>reference gene sets</italic> by taking the union of the <italic>n</italic> most significant gene sets reported by each method (mGSZ, wKS, GAGE, CAMERA, QuSAGE, romer and improved versions of GSA and Allez [<xref ref-type="bibr" rid="CR16">16</xref>]) for the reference data. We aimed to minimize any bias that the choice of <italic>n</italic> had on results by repeating the above procedure for multiple values of <italic>n</italic> (we used <italic>n</italic>=3,5 and 7). In the actual evaluation, we used the test subset to obtain a new ranking of significant gene sets for each method. For the top 50 gene sets, we kept a cumulative count of those also found in the reference gene set. At each rank, the average cumulative count across all values of <italic>n</italic> was calculated. The entire process was repeated 100 times for different data splits (20 in the evaluation of permutation methods). The graphs presented are averages over all experiments.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Evaluation based on data splitting. Workflow of the evaluation based on splitting of data</p></caption><graphic xlink:href="12859_2016_1403_Fig4_HTML" id="MO4"/></fig>
</p></sec><sec id="Sec11"><title>Evaluation based on detection of tissue specific gene sets</title><p>We generated a single gene set per tissue type based on tissue specific genes identified and verified by Song et al. [<xref ref-type="bibr" rid="CR26">26</xref>]. Next for each of the six gene sets (for six tissue types), we randomly selected <italic>x</italic>% of genes where <italic>x</italic>&#x02208;(0,10,20,30,40,50,60,70,80,90) and replaced them with randomly selected genes from the remaining complementary mouse genes. This way we generated 10 tissue specific gene sets for each tissue type based on 10 different values for <italic>x</italic>. For example, while a gene set with 0% random genes would contain only tissue specific genes, a gene set with 90% random genes would contain only 10% tissue specific genes. So, in total we had 60 gene sets that we consider &#x0201c;relevant gene sets&#x0201d;. The relevant gene sets were then mixed with randomized gene sets. The idea was then to see which methods rank the relevant gene sets higher than the random gene sets. Note that for each pairwise comparison of two tissue types, there are 20 relevant gene sets (10 tissue specific gene sets for each tissue type). All the possible 15 pairwise comparisons of six tissue samples were done. Methods were evaluated based on average number of relevant gene sets reported in the top rank of the gene set list in all the 15 pairwise comparisons. We also evaluated the methods based on precision-recall area under curve.</p></sec><sec id="Sec12"><title>Type 1 error test</title><p>Perm4 is a modified and more controlled version of the na&#x000ef;ve permutation method. It is important to test whether the modification generates false positive results (type 1 error). Null gene expression data was generated by randomizing the sample labels of breast cancer gene expression data. mGSZm and all other methods except Allez were applied to the null gene expression data and the distribution of estimated <italic>P</italic>-values was compared. Allez was not included in this evaluation because it does not report <italic>P</italic>-values. <italic>P</italic>-values for QuSASE were calculated using pdf.pVal function in QuSAGE&#x02019;s Bioconductor package. In principle, <italic>P</italic>-values estimated by mGSZm or similar methods based on null gene expression data with no true differential gene expression should follow a uniform distribution.</p></sec><sec id="Sec13"><title>Asymptotic validation of Perm4</title><p>In addition to the evaluation tests described above, we tested the validity of Perm4 by comparing the null distributions of gene set scores with 10000 permutations generated with Perm1 and Perm4 using the breast cancer dataset. The groups with 33 and 23 biological replicates were compared. Given sufficient number of replicates, Perm1 is the most optimal permutation method. The idea is to test if Perm4 generates results similar to that of Perm1 with an ideal dataset. We fitted an Extreme Value distribution to the null distributions of each of the gene sets generated by Perm1 and Perm4. The Extreme Value distribution was shown to be suitable for modeling GSZ scores under the null hypothesis (Mishra et al., 2014). The similarity between the two permutation methods was measured with correlation and mean relative error (abs(<inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {x_{i}}$\end{document}</tex-math><mml:math id="M8"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2016_1403_Article_IEq1.gif"/></alternatives></inline-formula>- <italic>x</italic>
<sub><italic>i</italic></sub>)/abs(<italic>x</italic>
<sub><italic>i</italic></sub>), where <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\hat {x_{i}}$\end{document}</tex-math><mml:math id="M10"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2016_1403_Article_IEq2.gif"/></alternatives></inline-formula> and <italic>x</italic>
<sub><italic>i</italic></sub> are the parameters of the <italic>i</italic>th gene set from Perm4 and Perm1 respectively) between the estimated parameters (scale and location) across all the analyzed gene sets.</p></sec></sec><sec id="Sec14"><title>Data sets</title><p>
<bold>Gene expression data</bold> Evaluation of the methods was based on three different multi-group gene expression data sets; 1) Human primary cell data, 2) Breast cancer data, and 3) Mouse tissue gene expression data (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 7 for details). Human primary cell and breast cancer data were used for evaluation based on data splitting. Only those sample groups that have at least 15 biological replicates, are well clustered and have no outliers were considered. Mouse tissue data was used for evaluation based on detection of tissue specific gene sets.</p><p>
<bold>Gene set data</bold> C2 curated gene sets from the Molecular Signatures Database were used throughout [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR27">27</xref>].</p></sec></sec><sec id="Sec15" sec-type="results"><title>Results</title><sec id="Sec16"><title>Overview of the results</title><p>Table <xref rid="Tab2" ref-type="table">2</xref> summarizes the results obtained from evaluation of the permutation methods and mGSZm. Advanced permutation methods showed clearly better results compared to the na&#x000ef;ve method, Perm1, with both datasets. mGSZm, gene set analysis method based on advanced permutation method, Perm4 showed the best overall result as compared to other gene set analysis methods across the three different evaluations with three different real biological datasets.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Overview of the results</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Evaluation approaches</th><th align="left">Evaluated methods</th><th align="left">Principles</th><th align="left">Data</th><th align="left">Results</th></tr></thead><tbody><tr><td align="justify">Data splitting (cross-validation type)</td><td align="justify">Permutation methods</td><td align="justify">Gene expression data was splitted into two parts; reference and test. The methods were evaluated based on their ability to replicate results from reference dataset using test dataset.</td><td align="justify">1. Human primary cell data. 2. Breast cancer data.</td><td align="justify">Perm1 showed bad performance as compared to the rest of the permutation methods in both datasets.</td></tr><tr><td align="justify">Data splitting (cross-validation type)</td><td align="justify">mGSZm and seven other gene set analysis methods shown in Table <xref rid="Tab1" ref-type="table">1</xref>.</td><td align="justify">Same as above</td><td align="justify">1. Human primary cell data. 2. Breast cancer data.</td><td align="justify">mGSZm ranked the maximum number of<italic>reference gene sets</italic> in the list of top 50 gene sets from test data in both datasets.</td></tr><tr><td align="justify">Detection of tissue specific gene sets in tissue gene expression data</td><td align="justify">mGSZm and seven other methods shown in Table <xref rid="Tab1" ref-type="table">1</xref>.</td><td align="justify">Method that ranked maximum number of tissue specific gene sets on the top 50 gene sets list was considered the best</td><td align="justify">Mouse tissue gene expression data.</td><td align="justify">mGSZm ranked the maximum number of tissue specific gene sets in the list of top 50 gene sets.</td></tr><tr><td align="justify">Type 1 error test</td><td align="justify">mGSZm and seven other methods shown in Table <xref rid="Tab1" ref-type="table">1</xref>.</td><td align="justify">An ideal method is the one that generates uniform distribution of gene set score <italic>p</italic>-values obtained from null gene expression data.</td><td align="justify">Breast cancer data.</td><td align="justify">mGSZm showed slightly left skewed null <italic>p</italic>-value distribution. Similar results were obtained with other methods.</td></tr></tbody></table></table-wrap>
</p></sec><sec id="Sec17"><title>Evaluation of permutation methods</title><p>Evaluation of the permutation methods was based on data splitting approach with two different datasets. Perm1, the na&#x000ef;ve permutation method was the worst performing method with both datasets (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). Perm4 reported &#x0223c; 8 (average over 20 different data splits) more relevant gene sets at rank positions 27 to 33 in breast cancer data and 46 to 50 in primary cell data. Perm2 showed similar results, however, we prefer Perm4 to Perm2 because Perm2 is the least constrained permutation method and it cannot prevent biological signal leakage into the null distribution.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Permutation methods evaluation plot. <italic>Reference gene sets</italic> identified by the three gene set analysis methods based on three different permutation methods with two different datasets; 1) Breast cancer data, 2) Human primary cell data. Figures represent cumulative count of <italic>reference gene sets</italic> over the ranked list of top 50 gene sets from <italic>test</italic> data reported by each of the methods</p></caption><graphic xlink:href="12859_2016_1403_Fig5_HTML" id="MO5"/></fig>
</p></sec><sec id="Sec18"><title>Evaluation of mGSZm</title><sec id="Sec19"><title>Detection of reference gene sets</title><p>mGSZm reported the maximum number of reference gene sets in both datasets (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Note the inconsistencies in the performance of CAMERA, QuSAGE, GAGE and Allez in the evaluations using the two datasets. While CAMERA is the closest competitor to mGSZm in breast cancer data with mGSZm leading only by about one gene set (average over 100 different data splits) at rank positions 37 to 50, it reports about two gene sets less at rank positions 33 to 50 in primary cell data. Similarly, GAGE and Allez reported about one gene set more than mGSZm at rank positions 4 to 15 in primary cell data. However, the performance of the methods dropped clearly at rest of the rank positions in the same dataset and all the rank positions in breast cancer dataset. While QuSAGE is the closest competitor to mGSZm in primary cell data, it is one of the worst performing method in case of breast cancer data. Overall best performance of mGSZm is clearer in the plot of average cumulative counts of the two datasets where mGSZm leads the second best method CAMERA by about 2 gene sets over the rank positions 38 to 50 (Fig. <xref rid="Fig7" ref-type="fig">7</xref>).
<fig id="Fig6"><label>Fig. 6</label><caption><p>mGSZm evaluation based on data splitting <italic>Reference gene sets</italic> identified by the eight compared gene set analysis methods with two different datasets; 1) Breast cancer data, 2) Human primary cell data. Figures represent cumulative count of <italic>reference gene sets</italic> over the ranked list of top 50 gene sets from <italic>test</italic> data reported by each of the compared methods</p></caption><graphic xlink:href="12859_2016_1403_Fig6_HTML" id="MO6"/></fig>
<fig id="Fig7"><label>Fig. 7</label><caption><p>mGSZm evaluation based on average of results from two datasets. Average number of <italic>reference gene sets</italic> identified by the eight compared gene set analysis methods with two different datasets; 1) Breast cancer data, 2) Human primary cell data. Figures represent average of cumulative counts of <italic>reference gene sets</italic> over the ranked list of top 50 gene sets from <italic>test</italic> data reported by each of the compared methods</p></caption><graphic xlink:href="12859_2016_1403_Fig7_HTML" id="MO7"/></fig>
</p></sec><sec id="Sec20"><title>Detection of tissue specific gene sets</title><p>mGSZm showed the best overall performance (Fig. <xref rid="Fig8" ref-type="fig">8</xref>). Note that CAMERA, which was a close competitor to mGSZm in other evaluations is one of the worst performer in this evaluation identifying about five gene sets less than mGSZm at rank positions 20 to 27. Further, Allez and QuSAGE, which are close competitors to mGSZm in this evaluation performed weakly in other evaluations (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). For the results from individual pairwise comparisons, see Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 8. We also evaluated the compared methods based on precision-recall area under curve (precision-recall AUC) for 13 of the 15 pairwise comparisons. The exclusion of two of the pairwise comparisons was due to ties in <italic>p</italic>-values obtained from mGSZm because of high biological signal. Also, romer was not included in the precision-recall AUC based evaluation because the romer function in R package reports <italic>p</italic>-values with multiple ties. Ties in <italic>p</italic>-values are common also in <italic>p</italic>-values obtained from wKS. However, we use wKS gene set scores (instead of <italic>p</italic>-values) and include wKS in the evaluation. Based on the evaluation, mGSZm, mGSA, Allez, wKS and QuSAGE showed similarly superior performance over CAMERA and GAGE in 12 of the 13 pairwise comparisons (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>, Section 8).
<fig id="Fig8"><label>Fig. 8</label><caption><p>Evaluation based on tissue specific gene sets Tissue specific gene sets identified by the eight compared gene set analysis methods. Figure represents average cumulative count of tissue specific gene sets over the ranked list of top 50 gene sets reported by each of the compared methods in 15 pairwise comparisons of six different tissue samples</p></caption><graphic xlink:href="12859_2016_1403_Fig8_HTML" id="MO8"/></fig>
</p></sec><sec id="Sec21"><title>Generation of type 1 error</title><p>mGSZm produces a slightly left skewed, but approximately uniform distribution of <italic>P</italic>-values, showing mGSZm to be fairly conservative in generation of type 1 error (Fig. <xref rid="Fig9" ref-type="fig">9</xref>). <italic>P</italic>-value distributions for most other methods showed similiar distributions, with the exception of QuSAGE and romer. QuSAGE is heavily left skewed and romer is slightly right skewed.
<fig id="Fig9"><label>Fig. 9</label><caption><p>Histogram of <italic>p</italic>-values. Histogram of <italic>p</italic>-values obtained from mGSZm and six other compared gene set analysis methods with null gene expression data with no true differential gene expression</p></caption><graphic xlink:href="12859_2016_1403_Fig9_HTML" id="MO9"/></fig>
</p></sec><sec id="Sec22"><title>Asymptotic validity of Perm4</title><p>Our results show that, across all the analyzed gene sets the correlations of the estimated parameters, scale and location were 0.99 and 0.98, respectively, and the mean relative errors between the parameters were 0.04 and 0.07, respectively.</p></sec></sec></sec><sec id="Sec23" sec-type="discussion"><title>Discussion</title><p>We presented a novel competitive gene set analysis method based on advanced sample permutation for multi-group gene expression data with as few as three replicates. Our results show that the na&#x000ef;ve permutation method commonly used in other methods should not be used with the type of data set in question. In addition, our results emphasize the importance of using a multi-faceted evaluation approach, without which, we would be unable to assess the relative ranking of each method.</p><p>The permutation methods considered in this work are different from each other in the way they model the background signal of the data. Our results show that na&#x000ef;ve sample permutation (Perm1) is unreliable for the size of data set in question and, further, that generating permutations using samples drawn from the complete data set can significantly improve results (Figs. <xref rid="Fig7" ref-type="fig">7</xref>, <xref rid="Fig8" ref-type="fig">8</xref>). Exactly how these permutations should be generated, however, is a deeper question than expected. Perm2, for example, uses all sample groups, but can group highly correlated samples and promote false negatives. Perm2 is therefore unsuitable for gene expression data with highly correlated sample groups. The proposed permutation method, Perm4, outperforms the other methods because it can generate sufficient number of permutations while controlling leakage of biological signals into the null distribution. Perm4 can be used in any sample permutation based gene set analysis of multi-group gene expression data irrespective of platform, i.e. microarray or RNAseq. However, we strongly recommend at least four replicates whenever possible.</p><p>mGSZm is based on Perm4 and Gene Set Z-score [<xref ref-type="bibr" rid="CR17">17</xref>]. Further, mGSZm is based on an asymptotic method for <italic>P</italic>-value estimation instead of an empirical method [<xref ref-type="bibr" rid="CR16">16</xref>]. The use of asymptotic, rather than empirical, <italic>P</italic>-values requires fewer permutations and thus speeds up the analysis process without compromising accuracy. We have shown in our previous article [<xref ref-type="bibr" rid="CR17">17</xref>] that asymptotic <italic>P</italic>-values calculated with 500 permutations are as accurate as empirical <italic>P</italic>-values calculated with 100,000 permutations. Thus, mGSZm has an advantage that allows for more accurate ranking of gene sets compared to other methods, like mGSA and wKS, that use empirical <italic>P</italic>-values. The better performance of mGSZm compared to the parametric methods could be because they are based on strong statistical assumptions which are not always met. Indeed, all the parametric methods showed inconsistent performance across data sets and evaluation criteria.</p><p>To understand why some methods performed inconsistently between data sets, we investigated whether there was a bias towards gene sets of a particular size or differential gene expression signal level. We noticed that in the breast cancer data, a large proportion (about 40%) of reference gene sets include over 100 genes, whereas in human primary cell data, there are fewer reference gene sets (about 20%) with over 100 genes. The mouse tissue specific gene sets contained, on average, 10 genes. Another difference between the data sets is that separation between sample groups is weaker in breast cancer data as compared to the other datasets. It is evident that, in contrast to other methods, mGSZm showed consistent performance irrespective of these variables. With regard to the performance of other methods, we speculate that 1) CAMERA appears to favor larger gene sets as it failed slightly in primary data and significantly in mouse data, 2) QuSAGE seems to prefer stronger expression signal as it performed well with primary human cell and mouse data, and 3) Allez performed well on the mouse data and therefore probably favors smaller gene sets. This highlights the importance of using multiple data sets when comparing different methods.</p></sec><sec id="Sec24" sec-type="conclusion"><title>Conclusion</title><p>We present mGSZm, a method for gene set analysis of multi-group gene expression data with as few as three replicates. Our proposed permutation method maintains the correlation structure of the genes and permutes samples such that leakage of biological signal into the null distribution is prevented.</p></sec></body><back><app-group><app id="App1"><sec id="Sec25"><title>Additional file</title><p>
<media position="anchor" xlink:href="12859_2016_1403_MOESM1_ESM.pdf" id="MOESM1"><label>Additional file 1</label><caption><p>This file contains supplementary figures and detailed descriptions of methods. (PDF 4540 Kb)</p></caption></media>
</p></sec></app></app-group><glossary><title>Abbreviations</title><def-list><def-item><term>AUC</term><def><p>Area under curve</p></def></def-item><def-item><term>CAMERA</term><def><p>Correlation adjusted mean rank gene set test</p></def></def-item><def-item><term>GAGE</term><def><p>Generally applicable gene-set enrichment</p></def></def-item><def-item><term>GSA</term><def><p>Gene set analysis</p></def></def-item><def-item><term>GSEA</term><def><p>Gene set enrichment analysis</p></def></def-item><def-item><term>GSZ</term><def><p>Gene set z-score</p></def></def-item><def-item><term>mGSA</term><def><p>Modified gene set analysis</p></def></def-item><def-item><term>mGSZ</term><def><p>Modified gene set z-score</p></def></def-item><def-item><term>mGSZm</term><def><p>Modified gene set z-score for multi-group gene expression data</p></def></def-item><def-item><term>QuSAGE</term><def><p>Quantitative set analysis of gene expression</p></def></def-item><def-item><term>romer</term><def><p>Rotation testing using mean ranks</p></def></def-item><def-item><term>VIF</term><def><p>Variance inflation factor</p></def></def-item><def-item><term>wKS</term><def><p>Weighted Kolmogorov-Smirnov</p></def></def-item></def-list></glossary><ack><p>We are thankful to the anonymous reviewers whose suggestions and comments contributed to the significant improvement of this paper.</p><sec id="d30e1541"><title>Funding</title><p>Funding for this work was provided by Institute of Biotechnology, University of Helsinki, Finland.</p></sec><sec id="d30e1546"><title>Availability of data and materials</title><p>Our gene set analysis method software and R codes used to generate results are available at <ext-link ext-link-type="uri" xlink:href="http://ekhidna.biocenter.helsinki.fi/downloads/pashupati/mGSZm.html">http://ekhidna.biocenter.helsinki.fi/downloads/pashupati/mGSZm.html</ext-link>.</p></sec><sec id="d30e1556"><title>Authors&#x02019; contributions</title><p>PT proposed the idea and designed the study. PPM coded and evaluated the method and drafted the manuscript. LH and AM gave advice on the design of the study, evaluation of the method and writing of the manuscript. All authors read and approved the final manuscript.</p></sec><sec id="d30e1561"><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec id="d30e1566"><title>Consent for publication</title><p>Not applicable.</p></sec><sec id="d30e1571"><title>Ethics approval and consent to participate</title><p>Not applicable.</p></sec></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>J</given-names></name><name><surname>Mouw</surname><given-names>KW</given-names></name><name><surname>Polak</surname><given-names>P</given-names></name><name><surname>Braunstein</surname><given-names>LZ</given-names></name><name><surname>Kamburov</surname><given-names>A</given-names></name><name><surname>Tiao</surname><given-names>G</given-names></name><name><surname>Kwiatkowski</surname><given-names>DJ</given-names></name><name><surname>Rosenberg</surname><given-names>JE</given-names></name><name><surname>Van Allen</surname><given-names>EM</given-names></name><name><surname>D D&#x02019;Andrea</surname><given-names>A</given-names></name><etal/></person-group><article-title>Somatic ercc2 mutations are associated with a distinct genomic signature in urothelial tumors</article-title><source>Nature genetics</source><year>2016</year><volume>48</volume><fpage>600</fpage><lpage>606</lpage><pub-id pub-id-type="doi">10.1038/ng.3557</pub-id><?supplied-pmid 27111033?><pub-id pub-id-type="pmid">27111033</pub-id></element-citation></ref><ref id="CR2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miow</surname><given-names>Q</given-names></name><name><surname>Tan</surname><given-names>T</given-names></name><name><surname>Ye</surname><given-names>J</given-names></name><name><surname>Lau</surname><given-names>J</given-names></name><name><surname>Yokomizo</surname><given-names>T</given-names></name><name><surname>Thiery</surname><given-names>J</given-names></name><name><surname>Mori</surname><given-names>S</given-names></name></person-group><article-title>Epithelial&#x02013;mesenchymal status renders differential responses to cisplatin in ovarian cancer</article-title><source>Oncogene</source><year>2015</year><volume>34</volume><issue>15</issue><fpage>1899</fpage><lpage>1907</lpage><pub-id pub-id-type="doi">10.1038/onc.2014.136</pub-id><?supplied-pmid 24858042?><pub-id pub-id-type="pmid">24858042</pub-id></element-citation></ref><ref id="CR3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Houtkooper</surname><given-names>RH</given-names></name><name><surname>Argmann</surname><given-names>C</given-names></name><name><surname>Houten</surname><given-names>SM</given-names></name><name><surname>Cant&#x000f3;</surname><given-names>C</given-names></name><name><surname>Jeninga</surname><given-names>EH</given-names></name><name><surname>Andreux</surname><given-names>PA</given-names></name><name><surname>Thomas</surname><given-names>C</given-names></name><name><surname>Doenlen</surname><given-names>R</given-names></name><name><surname>Schoonjans</surname><given-names>K</given-names></name><name><surname>Auwerx</surname><given-names>J</given-names></name></person-group><article-title>The metabolic footprint of aging in mice</article-title><source>Scientific reports</source><year>2011</year><volume>1</volume><fpage>134</fpage><pub-id pub-id-type="doi">10.1038/srep00134</pub-id><?supplied-pmid 22355651?><pub-id pub-id-type="pmid">22355651</pub-id></element-citation></ref><ref id="CR4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Johnson</surname><given-names>CH</given-names></name><name><surname>Ivanisevic</surname><given-names>J</given-names></name><name><surname>Siuzdak</surname><given-names>G</given-names></name></person-group><article-title>Metabolomics: beyond biomarkers and towards mechanisms</article-title><source>Nat Rev Mol Cell Biol</source><year>2016</year><volume>17</volume><fpage>451</fpage><lpage>459</lpage><pub-id pub-id-type="doi">10.1038/nrm.2016.25</pub-id><?supplied-pmid 26979502?><pub-id pub-id-type="pmid">26979502</pub-id></element-citation></ref><ref id="CR5"><label>5</label><mixed-citation publication-type="other">Perry JRB, McCarthy MI, Hattersley AT, Zeggini E, Wellcome Trust Case Control Consortium, Weedon MN, Frayling TM. Interrogating Type 2 Diabetes Genome-Wide Association Data Using a Biological Pathway-Based Approach. Diabetes. 2009; 58(6):1463&#x02013;1467. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2337/db08-1378">http://dx.doi.org/10.2337/db08-1378</ext-link>.</mixed-citation></ref><ref id="CR6"><label>6</label><mixed-citation publication-type="other">Elbers CC, van Eijk KR, Franke L, Mulder F, van der Schouw YT, Wijmenga C, Onland-Moret NC. Using genome-wide pathway analysis to unravel the etiology of complex diseases. Genet Epidemiol. 2009; 33(5):419&#x02013;31. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/gepi.20395">http://dx.doi.org/10.1002/gepi.20395</ext-link>.</mixed-citation></ref><ref id="CR7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashburner</surname><given-names>M</given-names></name><name><surname>Ball</surname><given-names>CA</given-names></name><name><surname>Blake</surname><given-names>JA</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name><name><surname>Butler</surname><given-names>H</given-names></name><name><surname>Cherry</surname><given-names>JM</given-names></name><name><surname>Davis</surname><given-names>AP</given-names></name><name><surname>Dolinski</surname><given-names>K</given-names></name><name><surname>Dwight</surname><given-names>SS</given-names></name><name><surname>Eppig</surname><given-names>JT</given-names></name><etal/></person-group><article-title>Gene ontology: tool for the unification of biology</article-title><source>Nat Genet</source><year>2000</year><volume>25</volume><issue>1</issue><fpage>25</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1038/75556</pub-id><?supplied-pmid 10802651?><pub-id pub-id-type="pmid">10802651</pub-id></element-citation></ref><ref id="CR8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kanehisa</surname><given-names>M</given-names></name><name><surname>Goto</surname><given-names>S</given-names></name></person-group><article-title>Kegg: kyoto encyclopedia of genes and genomes</article-title><source>Nucleic Acids Res</source><year>2000</year><volume>28</volume><issue>1</issue><fpage>27</fpage><lpage>30</lpage><pub-id pub-id-type="doi">10.1093/nar/28.1.27</pub-id><?supplied-pmid 10592173?><pub-id pub-id-type="pmid">10592173</pub-id></element-citation></ref><ref id="CR9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goeman</surname><given-names>JJ</given-names></name><name><surname>B&#x000fc;hlmann</surname><given-names>P</given-names></name></person-group><article-title>Analyzing gene expression data in terms of gene sets: methodological issues</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><issue>8</issue><fpage>980</fpage><lpage>7</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btm051</pub-id><?supplied-pmid 17303618?><pub-id pub-id-type="pmid">17303618</pub-id></element-citation></ref><ref id="CR10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Efron</surname><given-names>B</given-names></name><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><article-title>On testing the significance of sets of genes</article-title><source>Ann Appl Stat</source><year>2006</year><volume>1</volume><issue>1</issue><fpage>107</fpage><lpage>29</lpage><pub-id pub-id-type="doi">10.1214/07-AOAS101</pub-id></element-citation></ref><ref id="CR11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maciejewski</surname><given-names>H</given-names></name></person-group><article-title>Gene set analysis methods: statistical models and methodological differences</article-title><source>Briefings in bioinformatics</source><year>2013</year><volume>15</volume><fpage>504</fpage><lpage>518</lpage><pub-id pub-id-type="doi">10.1093/bib/bbt002</pub-id></element-citation></ref><ref id="CR12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Subramanian</surname><given-names>A</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Mootha</surname><given-names>VK</given-names></name><name><surname>Mukherjee</surname><given-names>S</given-names></name><name><surname>Ebert</surname><given-names>BL</given-names></name><name><surname>Gillette</surname><given-names>MA</given-names></name><name><surname>Paulovich</surname><given-names>A</given-names></name><name><surname>Pomeroy</surname><given-names>SL</given-names></name><name><surname>Golub</surname><given-names>TR</given-names></name><name><surname>Lander</surname><given-names>ES</given-names></name><etal/></person-group><article-title>Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide expression profiles</article-title><source>Proc Natl Acad Sci U S A</source><year>2005</year><volume>102</volume><issue>43</issue><fpage>15545</fpage><lpage>15550</lpage><pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id><?supplied-pmid 16199517?><pub-id pub-id-type="pmid">16199517</pub-id></element-citation></ref><ref id="CR13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>D</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>Camera: a competitive gene set test accounting for inter-gene correlation</article-title><source>Nucleic Acids Res</source><year>2012</year><volume>40</volume><issue>17</issue><fpage>133</fpage><pub-id pub-id-type="doi">10.1093/nar/gks461</pub-id></element-citation></ref><ref id="CR14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Newton</surname><given-names>MA</given-names></name><name><surname>Quintana</surname><given-names>FA</given-names></name><name><surname>Boon</surname><given-names>JAD</given-names></name><name><surname>Sengupta</surname><given-names>S</given-names></name><name><surname>Ahlquist</surname><given-names>P</given-names></name></person-group><article-title>Random-set methods identify distinct aspects of the enrichment signal in gene-set analysis</article-title><source>Ann Appl Stat</source><year>2007</year><volume>1</volume><issue>1</issue><fpage>85</fpage><lpage>106</lpage><pub-id pub-id-type="doi">10.1214/07-AOAS104</pub-id></element-citation></ref><ref id="CR15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kim</surname><given-names>SY</given-names></name><name><surname>Volsky</surname><given-names>DJ</given-names></name></person-group><article-title>Page: parametric analysis of gene set enrichment</article-title><source>BMC Bioinforma</source><year>2005</year><volume>6</volume><fpage>144</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-6-144</pub-id></element-citation></ref><ref id="CR16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mishra</surname><given-names>P</given-names></name><name><surname>T&#x000f6;r&#x000f6;nen</surname><given-names>P</given-names></name><name><surname>Leino</surname><given-names>Y</given-names></name><name><surname>Holm</surname><given-names>L</given-names></name></person-group><article-title>Gene set analysis: limitations in popular existing methods and proposed improvements</article-title><source>Bioinformatics</source><year>2014</year><volume>30</volume><issue>19</issue><fpage>2747</fpage><lpage>756</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu374</pub-id><?supplied-pmid 24903419?><pub-id pub-id-type="pmid">24903419</pub-id></element-citation></ref><ref id="CR17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>T&#x000f6;r&#x000f6;nen</surname><given-names>P</given-names></name><name><surname>Ojala</surname><given-names>PJ</given-names></name><name><surname>Marttinen</surname><given-names>P</given-names></name><name><surname>Holm</surname><given-names>L</given-names></name></person-group><article-title>Robust extraction of functional signals from gene set analysis using a generalized threshold free scoring function</article-title><source>BMC Bioinforma</source><year>2009</year><volume>10</volume><issue>1</issue><fpage>307</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-10-307</pub-id></element-citation></ref><ref id="CR18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koskinen</surname><given-names>P</given-names></name><name><surname>T&#x000f6;r&#x000f6;nen</surname><given-names>P</given-names></name><name><surname>Nokso-Koivisto</surname><given-names>J</given-names></name><name><surname>Holm</surname><given-names>L</given-names></name></person-group><article-title>Pannzer: high-throughput functional annotation of uncharacterized proteins in an error-prone environment</article-title><source>Bioinformatics</source><year>2015</year><volume>31</volume><issue>10</issue><fpage>1544</fpage><lpage>1552</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btu851</pub-id><?supplied-pmid 25653249?><pub-id pub-id-type="pmid">25653249</pub-id></element-citation></ref><ref id="CR19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wirth</surname><given-names>H</given-names></name><name><surname>von Bergen</surname><given-names>M</given-names></name><name><surname>Binder</surname><given-names>H</given-names></name></person-group><article-title>Mining som expression portraits: Feature selection and integrating concepts of molecular function</article-title><source>BioData Min</source><year>2012</year><volume>5</volume><issue>1</issue><fpage>1</fpage><pub-id pub-id-type="doi">10.1186/1756-0381-5-18</pub-id><pub-id pub-id-type="pmid">22297131</pub-id></element-citation></ref><ref id="CR20"><label>20</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Blokhina</surname><given-names>OB</given-names></name><name><surname>T&#x000f6;r&#x000f6;nen</surname><given-names>P</given-names></name><name><surname>Fagerstedt</surname><given-names>KV</given-names></name></person-group><article-title>Oxidative stress components explored in anoxic and hypoxic global gene expression data</article-title><source>Low-Oxygen Stress in Plants</source><year>2014</year><publisher-loc>Vienna</publisher-loc><publisher-name>Springer</publisher-name></element-citation></ref><ref id="CR21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>W</given-names></name><name><surname>Friedman</surname><given-names>MS</given-names></name><name><surname>Shedden</surname><given-names>K</given-names></name><name><surname>Hankenson</surname><given-names>KD</given-names></name><name><surname>Woolf</surname><given-names>PJ</given-names></name></person-group><article-title>Gage: generally applicable gene set enrichment for pathway analysis</article-title><source>BMC Bioinforma</source><year>2009</year><volume>10</volume><issue>1</issue><fpage>161</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-10-161</pub-id></element-citation></ref><ref id="CR22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yaari</surname><given-names>G</given-names></name><name><surname>Bolen</surname><given-names>CR</given-names></name><name><surname>Thakar</surname><given-names>J</given-names></name><name><surname>Kleinstein</surname><given-names>SH</given-names></name></person-group><article-title>Quantitative set analysis for gene expression: a method to quantify gene set differential expression including gene-gene correlations</article-title><source>Nucleic acids research</source><year>2013</year><volume>41</volume><fpage>e170</fpage><pub-id pub-id-type="doi">10.1093/nar/gkt660</pub-id><?supplied-pmid 23921631?><pub-id pub-id-type="pmid">23921631</pub-id></element-citation></ref><ref id="CR23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>Linear models and empirical bayes methods for assessing differential expression in microarray experiments</article-title><source>Stat Appl Genet Mol Biol</source><year>2004</year><volume>3</volume><issue>1</issue><fpage>1</fpage><lpage>25</lpage></element-citation></ref><ref id="CR24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ritchie</surname><given-names>ME</given-names></name><name><surname>Phipson</surname><given-names>B</given-names></name><name><surname>Wu</surname><given-names>D</given-names></name><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Law</surname><given-names>CW</given-names></name><name><surname>Shi</surname><given-names>W</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name></person-group><article-title>limma powers differential expression analyses for rna-sequencing and microarray studies</article-title><source>Nucleic acids research</source><year>2015</year><volume>43</volume><fpage>e47</fpage><pub-id pub-id-type="doi">10.1093/nar/gkv007</pub-id><?supplied-pmid 25605792?><pub-id pub-id-type="pmid">25605792</pub-id></element-citation></ref><ref id="CR25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Majewski</surname><given-names>IJ</given-names></name><name><surname>Ritchie</surname><given-names>ME</given-names></name><name><surname>Phipson</surname><given-names>B</given-names></name><name><surname>Corbin</surname><given-names>J</given-names></name><name><surname>Pakusch</surname><given-names>M</given-names></name><name><surname>Ebert</surname><given-names>A</given-names></name><name><surname>Busslinger</surname><given-names>M</given-names></name><name><surname>Koseki</surname><given-names>H</given-names></name><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Smyth</surname><given-names>GK</given-names></name><etal/></person-group><article-title>Opposing roles of polycomb repressive complexes in hematopoietic stem and progenitor cells</article-title><source>Blood</source><year>2010</year><volume>116</volume><issue>5</issue><fpage>731</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1182/blood-2009-12-260760</pub-id><?supplied-pmid 20445021?><pub-id pub-id-type="pmid">20445021</pub-id></element-citation></ref><ref id="CR26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>Y</given-names></name><name><surname>Ahn</surname><given-names>J</given-names></name><name><surname>Suh</surname><given-names>Y</given-names></name><name><surname>Davis</surname><given-names>ME</given-names></name><name><surname>Lee</surname><given-names>K</given-names></name></person-group><article-title>Identification of novel tissue-specific genes by analysis of microarray databases: a human and mouse model</article-title><source>PloS one</source><year>2013</year><volume>8</volume><issue>5</issue><fpage>64483</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0064483</pub-id></element-citation></ref><ref id="CR27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Godec</surname><given-names>J</given-names></name><name><surname>Tan</surname><given-names>Y</given-names></name><name><surname>Liberzon</surname><given-names>A</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Bhattacharya</surname><given-names>S</given-names></name><name><surname>Butte</surname><given-names>AJ</given-names></name><name><surname>Mesirov</surname><given-names>JP</given-names></name><name><surname>Haining</surname><given-names>WN</given-names></name></person-group><article-title>Compendium of immune signatures identifies conserved and species-specific biology in response to inflammation</article-title><source>Immunity</source><year>2016</year><volume>44</volume><fpage>194</fpage><lpage>206</lpage><pub-id pub-id-type="doi">10.1016/j.immuni.2015.12.006</pub-id><?supplied-pmid 26795250?><pub-id pub-id-type="pmid">26795250</pub-id></element-citation></ref></ref-list></back></article>