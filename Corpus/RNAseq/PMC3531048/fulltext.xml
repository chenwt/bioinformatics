<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><?epub November-29-2012?><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id><journal-id journal-id-type="publisher-id">nar</journal-id><journal-id journal-id-type="hwp">nar</journal-id><journal-title-group><journal-title>Nucleic Acids Research</journal-title></journal-title-group><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3531048</article-id><article-id pub-id-type="pmid">23203866</article-id><article-id pub-id-type="doi">10.1093/nar/gks1141</article-id><article-id pub-id-type="publisher-id">gks1141</article-id><article-categories><subj-group subj-group-type="heading"><subject>Articles</subject></subj-group></article-categories><title-group><article-title>FlyAtlas: database of gene expression in the tissues of <italic>Drosophila melanogaster</italic></article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Robinson</surname><given-names>Scott W.</given-names></name><xref ref-type="aff" rid="gks1141-AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Herzyk</surname><given-names>Pawel</given-names></name><xref ref-type="aff" rid="gks1141-AFF1"><sup>2</sup></xref><xref ref-type="aff" rid="gks1141-AFF1"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Dow</surname><given-names>Julian A. T.</given-names></name><xref ref-type="aff" rid="gks1141-AFF1"><sup>2</sup></xref><xref ref-type="corresp" rid="gks1141-COR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Leader</surname><given-names>David P.</given-names></name><xref ref-type="aff" rid="gks1141-AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="gks1141-COR2">*</xref></contrib></contrib-group><aff id="gks1141-AFF1"><sup>1</sup>School of Life Sciences, College of Medical, Veterinary and Life Sciences, <sup>2</sup>Institute of Molecular Cell and Systems Biology, College of Medical, Veterinary and Life Sciences and <sup>3</sup>Glasgow Polyomics, College of Medical, Veterinary and Life Sciences, University of Glasgow, Glasgow G12 8QQ, UK</aff><author-notes><corresp id="gks1141-COR1">*To whom correspondence should be addressed. Tel: <phone>+44 1 41 33 05 905</phone>; Email: <email>david.leader@glasgow.ac.uk</email></corresp><corresp id="gks1141-COR2">Correspondence may also be addressed to Julian A. T. Dow. Tel: <phone>+44 1 41 33 04 616</phone>; Email: <email>julian.dow@glasgow.ac.uk</email></corresp></author-notes><pub-date pub-type="ppub"><month>1</month><year>2013</year></pub-date><pub-date pub-type="epub"><day>29</day><month>11</month><year>2012</year></pub-date><pub-date pub-type="pmc-release"><day>29</day><month>11</month><year>2012</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the							<pub-date pub-type="epub"/>. --><volume>41</volume><issue>Database issue</issue><issue-title>Database issue</issue-title><fpage>D744</fpage><lpage>D750</lpage><history><date date-type="received"><day>17</day><month>9</month><year>2012</year></date><date date-type="rev-recd"><day>23</day><month>10</month><year>2012</year></date><date date-type="accepted"><day>24</day><month>10</month><year>2012</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2012. Published by Oxford University Press.</copyright-statement><copyright-year>2012</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial reuse, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com.</license-p></license></permissions><abstract><p>The FlyAtlas resource contains data on the expression of the genes of <italic>Drosophila melanogaster</italic> in different tissues (currently 25&#x02014;17 adult and 8 larval) obtained by hybridization of messenger RNA to Affymetrix Drosophila Genome 2 microarrays. The microarray probe sets cover 13 250 <italic>Drosophila</italic> genes, detecting 12 533 in an unambiguous manner. The data underlying the original web application (<ext-link ext-link-type="uri" xlink:href="http://flyatlas.org">http://flyatlas.org</ext-link>) have been restructured into a relational database and a Java servlet written to provide a new web interface, FlyAtlas 2 (<ext-link ext-link-type="uri" xlink:href="http://flyatlas.gla.ac.uk/">http://flyatlas.gla.ac.uk/</ext-link>), which allows several additional queries. Users can retrieve data for individual genes or for groups of genes belonging to the same or related ontological categories. Assistance in selecting valid search terms is provided by an Ajax &#x02018;autosuggest&#x02019; facility that polls the database as the user types. Searches can also focus on particular tissues, and data can be retrieved for the most highly expressed genes, for genes of a particular category with above-average expression or for genes with the greatest difference in expression between the larval and adult stages. A novel facility allows the database to be queried with a specific gene to find other genes with a similar pattern of expression across the different tissues.</p></abstract><counts><page-count count="7"/></counts></article-meta></front><body><sec sec-type="intro"><title>INTRODUCTION</title><p><italic>Drosophila melanogaster</italic> is one of the most important model eukaryotic organisms, in part because of the great detail with which its genetics have been studied. This genetic heritage has provided an invaluable context to the sequence of its genome (<xref rid="gks1141-B1" ref-type="bibr">1</xref>), which contains many homologues of human genes, including 75% of those known to be involved in disease (<xref rid="gks1141-B2" ref-type="bibr">2</xref>). The sequence of the genome has enabled numerous microarray studies of gene expression. Although these have produced much valuable information, they have sometimes suffered from the limitation of studying gene expression in the whole animal, rather than in individual tissues, potentially obscuring significant changes occurring in tissues that constitute only a small proportion of the overall body mass. To provide additional genome-wide insights into both gene and tissue function, a comprehensive atlas of gene expression (using the authoritative Affymetrix platform) across multiple tissues and life stages was produced and is available online at <ext-link ext-link-type="uri" xlink:href="http://flyatlas.org/">http://flyatlas.org/</ext-link> (<xref rid="gks1141-B3" ref-type="bibr">3</xref>). These data have been taken up with enthusiasm by both the <italic>Drosophila</italic> and broader biological communities, and the original article has been cited &#x0003e;700 times since 2007 on Google Scholar. Even this figure probably understates the usage of the resource, as the data are also published through the established genome project resource, FlyBase (<xref rid="gks1141-B4" ref-type="bibr">4</xref>,<xref rid="gks1141-B5" ref-type="bibr">5</xref>), as well as the <italic>Drosophila</italic> data portal, FlyMine (<xref rid="gks1141-B6" ref-type="bibr">6</xref>). An example of a listing from a search using this facility is shown in <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks1141/DC1">Supplementary Figure S1</ext-link>.</p><p>Despite its great utility, the original FlyAtlas web facility is not without limitations: a small portion of the information derived from the Affymetrix annotation was outdated or incorrect, and some searches using <italic>Drosophila</italic> genetic symbols could either fail or produce an unmanageable number of &#x02018;hits&#x02019;. This latter problem was related to the simple &#x02018;flat-file&#x02019; format of the FlyAtlas dataset and the algorithm used to search it. Rather than addressing these issues by updating the existing data records and program scripts, it was decided to replace the flat files by a relational database that would not only enable the problems to be resolved, but would also facilitate other enhancements to the web application.</p><p>One enhancement relates to an aspect of the relationship between individual probe sets used in the hybridization and <italic>Drosophila</italic> genes&#x02014;one that is particularly important for the user of the facility to appreciate. Some genes (1367 of the 13 250 for which we have data) are detected by more than one probe set (referred to as &#x02018;duplicates&#x02019; for convenience), whereas other probe sets (1188 of the 14 438) detect more than one gene (referred to as &#x02018;degenerate&#x02019;). This degeneracy means that for certain genes (717 of the 13 250) the data do not allow unambiguous conclusions to be drawn regarding expression in different tissues. The relational database has enabled us to deal with these situations more explicitly.</p><p>In this report, we describe the structure of the relational database and the new web interface that has been provided for FlyAtlas, including features that provide significant improvements in usability. We also describe a new facility that allows one to find genes with a similar pattern of expression across different tissues to that of a query gene.</p></sec><sec><title>DATA COLLECTION</title><p>The number of tissues in the original version of FlyAtlas (<xref rid="gks1141-B3" ref-type="bibr">3</xref>) was 11, but has since been increased to 25. The tissues from adult flies are currently head, salivary gland, heart, ovary, virgin spermatheca, mated spermatheca, testis, accessory glands, carcass, fat body, tubule, midgut, eye, brain, hindgut, thoracicoabdominal ganglion and crop, whereas those from larvae are central nervous system, tubule, trachea, midgut, salivary gland, fat body, hindgut and carcass. Details of the dissections are provided as <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks1141/DC1">Supplementary Table S1</ext-link>.</p><p>Other experimental details are available as <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks1141/DC1">Supplementary Material</ext-link> in the previous article (<xref rid="gks1141-B3" ref-type="bibr">3</xref>) but are briefly repeated here. The flies were wild-type <italic>Drosophila melanogaster</italic> of the Canton S strain. The adults were reared at 23&#x000b0;C on a 12 h:12 h light:dark regime, on standard <italic>Drosophila</italic> diet, and killed 7 days after adult emergence. The larvae were third instar feeding larvae, raised under the same conditions and sampled before the wandering stage. The tissues were pooled from equal numbers of males and females, except in the case of the gonads.</p><p>At least 1500 ng messenger RNA was obtained from each tissue and from whole flies. It was then amplified and hybridized to Affymetrix <italic>Drosophila</italic> Genome 2 expression arrays (representing 18 500 transcripts) using the Affymetrix standard protocol. For each tissue, four independent biological replicates were obtained, i.e. each array corresponds to one biological replicate.</p><p>The arrays were read using standard procedures with an Affymetrix GeneChip Scanner 3000 7G. Data were analysed using Affymetrix proprietary GCOS software (v 1.4), and data from tissue samples were compared with those of the adult fly dataset using Affymetrix Data mining software (v 3.1)<italic>.</italic></p></sec><sec><title>DATA REFINEMENT AND DATABASE CONSTRUCTION</title><p>Three sets of data underlie the database: a file of the results of the hybridization experiments, a file documenting the microarrays, and ontological classification data for <italic>Drosophila</italic> genes. The database, FlyAtlasDB, was constructed from these data in the relational database management system, MySQL. The database schema can be found in <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks1141/DC1">Supplementary Figure S2</ext-link> and the table attributes in <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks1141/DC1">Supplementary Figure S3</ext-link>.</p><p>The experimental data were initially in a file listing the following six items for each probe set: the tissue and stage, the number of Genechip replicates in which a signal was detected (out of the four), the mean hybridization signal (arbitrary units), the standard error of the latter, the enrichment with respect to the signal in whole flies (1.0) and whether the enrichment represented an increase, decrease or was not significantly different from the value for whole flies. These data were used to construct the &#x02018;Experiment&#x02019; and &#x02018;FlyAnat&#x02019; tables (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks1141/DC1">Supplementary Figures S2</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks1141/DC1">S3</ext-link>).</p><p>Documentation of the Drosophila Genome 2 microarray was in the standard Affymetrix annotation file, currently Drosophila_2.na30.annot.csv and downloadable from <ext-link ext-link-type="uri" xlink:href="http://www.affymetrix.com/analysis/index.affx">http://www.affymetrix.com/analysis/index.affx</ext-link>. It consists of a row for each probe set, together with about 40 columns of information regarding the probe set and the <italic>Drosophila</italic> gene or genes that it detects. Of the various gene descriptors available, we chose the FlyBase identifier as definitive. We extracted each probe set identifier and the corresponding FlyBase identifier from the file, and the latter were then checked against FlyBase (<xref rid="gks1141-B5" ref-type="bibr">5</xref>) to determine whether they were current, using a program written for the purpose. Twenty-four were found to be outdated because what had originally been thought to be a single gene had subsequently been resolved into two or more. In these cases, each probe set was reassigned to a new identifier by visual inspection using the FlyBase genome viewer. Another 272 FlyBase identifiers were found to refer to species of <italic>Drosophila</italic> other than <italic>melanogaster</italic>, and these and their corresponding probe sets were removed from the database. Probe sets without a corresponding FlyBase identifier&#x02014;notably internal controls&#x02014;were also excluded. Definitive versions of gene names, symbols and CG numbers were derived from FlyBase.</p><p>These data were used as the basis of the &#x02018;Probeset&#x02019; and &#x02018;Gene&#x02019; tables (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks1141/DC1">Supplementary Figures S2</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks1141/DC1">S3</ext-link>). The &#x02018;Probeset&#x02019; table also contained an additional pre-computed field &#x02018;ProbeDegeneracy&#x02019;, indicating whether a probe set was degenerate, i.e. hybridized to the messenger RNA from more than one gene. This was the case for 1188 of the 14 438 probe sets. The &#x02018;Gene&#x02019; table contains between 100 and 200 gene symbols and names that include Greek characters; so to allow search flexibility, additional fields were included with Romanized equivalents (e.g. with &#x02018;&#x003b1;&#x02019; replaced by &#x02018;alpha&#x02019;).</p><p>Because of errors and ambiguities in the ontological data in the Affymetrix file, ontological data were downloaded from FlyBase and used to populate the &#x02018;OntolOfGene&#x02019; and &#x02018;Ontology&#x02019; tables (<ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks1141/DC1">Supplementary Figures S2</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks1141/DC1">S3</ext-link>). These tables provide the functional descriptions of <italic>Drosophila</italic> genes that are used in &#x02018;Category&#x02019; searches (below).</p></sec><sec><title>TECHNICAL IMPLEMENTATION</title><p>The FlyAtlas web application uses a Java servlet to generate web pages and communicate with the relational database. Java packages from the Apache commons Mathematics Library (<ext-link ext-link-type="uri" xlink:href="http://commons.apache.org/math/">http://commons.apache.org/math/</ext-link>) are used to calculate correlations for the &#x02018;Profile Search&#x02019; (below). A separate smaller version of the servlet is used to provide programmatic access for developers.</p><p>The persistence of servlet instances depends on new HTML pages being generated from HTML form requests to the server. To avoid some of the constraints that this can place on interface design, JavaScript is used to access variables from within the page and generate and send a &#x02018;hidden&#x02019; form when the user initiates a request. Thus, although Java is not required by the client web browser, JavaScript must be enabled. The JQuery JavaScript library (<ext-link ext-link-type="uri" xlink:href="http://jquery.com/">http://jquery.com/</ext-link>) is used for the hide/show interface features, together with the jqBarGraph plug-in for generating the bar charts for the &#x02018;Profile&#x02019; search.</p><p>The &#x02018;autosuggest&#x02019; uses AJAX: a JavaScript file adapted from a published source (<xref rid="gks1141-B7" ref-type="bibr">7</xref>), a custom Java servlet and FlyAtlasDB.</p></sec><sec><title>USER INTERFACE &#x00026; FUNCTIONALITY OF THE WEB APPLICATION</title><sec><title>Presentation of tables of results</title><p>All of the search queries in the new version of the FlyAtlas web application (FlyAtlas 2) return pages that include experimental data in tabular form, formatted as shown in <xref ref-type="fig" rid="gks1141-F1">Figure 1</xref>. To allow comparison of corresponding tissues in adult flies and larvae, the data for these are presented side by side, an arrangement that also decreases the length of the table. Cases in which none of the arrays gave significant results are indicated by &#x02018;ND&#x02019; (Not Detected), and for those in which significant signals were only obtained with between one and three arrays, the values are presented in square brackets. In the latter case, the number of arrays can be seen by holding the cursor over the value (<xref ref-type="fig" rid="gks1141-F1">Figure 1</xref>A). The default presentation of results shown in <xref ref-type="fig" rid="gks1141-F1">Figure 1</xref>A lacks standard errors, but the user may select an option to display them (<xref ref-type="fig" rid="gks1141-F1">Figure 1</xref>B), and once selected this choice persists between different search modes until changed.
<fig id="gks1141-F1" position="float"><label>Figure 1.</label><caption><p>Presentation of experimental data in the FlyAtlas 2 web application. (<bold>A</bold>) Appearance without standard errors. The tooltip&#x02014;obtained on holding the cursor over values in square brackets&#x02014;indicates the number of replicates in which a signal was detected, if between one and four. &#x02018;ND&#x02019; indicates a value of &#x02018;0&#x02019; for the latter. Note the green &#x02018;D&#x02019; icon indicating that other probe sets besides 1637813_at detect gene abd-A. Clicking on the arrow icon to the right of this allows one to launch a page with links for this gene in various external <italic>Drosophila</italic> resources. The green button on the top left with the &#x02018;^&#x02019; symbol allows the table to be &#x02018;collapsed&#x02019; or hidden. (<bold>B</bold>) Appearance with standard errors (detail).</p></caption><graphic xlink:href="gks1141f1p"/></fig></p><p>The results table in <xref ref-type="fig" rid="gks1141-F1">Figure 1</xref> uses colour to draw the user&#x02019;s attention to the features that are likely to be of most interest and importance. Abundance is represented on a logarithmic scale (Base 2) from white to black, whereas enrichment uses a scale running from white, through yellow, to red. Yellow is used for an enrichment value of 1 (no enrichment compared with expression in whole flies), increased enrichment runs through orange to deep red and as expression decreases the colour diminishes from yellow to white (which matches the bottom of the abundance scale). An asymmetric logarithmic scale is used to optimize perception of both relatively modest and much greater changes.</p><p>The differentiation of colours used in both tables and bar charts (&#x02018;Profile&#x02019; search, below) was checked using a simulator (<ext-link ext-link-type="uri" xlink:href="http://www.colblindor.com/coblis-color-blindness-simulator/">http://www.colblindor.com/coblis-color-blindness-simulator/</ext-link>) and found to be adequate in different cases of defective colour vision.</p></sec><sec><title>Search interface: concerns and approach</title><p>A major concern in designing the search interface was to address the problem mentioned in the Introduction: that of the amount and relevance of the data returned in response to valid search queries. However, we also wished to avoid, as far as possible, the situation in which a user is allowed to submit an invalid search query, wait and then receive an uninformative negative response. Our approach to both concerns has been to make extensive use of AJAX-based &#x02018;autosuggest&#x02019; menus. These menus present users with a list of corresponding entries in the database, which, if used as search terms, ensure that results are returned and that these results are relevant.</p><p>Another concern was what search facilities to provide. We have assumed that users will approach the web application from one of two standpoints. In the first case, we envisage that they will be primarily interested in a specific gene or group of genes, and wish to obtain information about how these genes are expressed in different tissues. Two search facilities (&#x02018;Gene&#x02019; and &#x02018;Category&#x02019;) are designed for this purpose. In the second case, we envisage that users will primarily be concerned with a particular tissue, and wish to obtain information about genes expressed there. Three other search facilities (&#x02018;Top&#x02019;, &#x02018;Development&#x02019; and &#x02018;Tissue&#x02019;) address this requirement. There is a sixth&#x02014;and completely new&#x02014;facility, the &#x02018;Profile Search&#x02019;. Although this starts from the standpoint of a particular gene, it involves expression across different tissues. Its function is to find other genes with a pattern or profile of tissue expression that is similar to the query gene.</p></sec><sec><title>Gene search</title><p>The &#x02018;Gene&#x02019; search allows one to determine the expression of a particular gene in the tissues for which experimental data are available. The search entry form (<xref ref-type="fig" rid="gks1141-F2">Figure 2</xref>A) requires that before typing a gene descriptor in the search box one specifies whether it is a symbol, name, annotation symbol (CG number) or FlyBase identifier (FBgn number). If one clicks on the &#x02018;options&#x02019; box, a panel of additional options is presented (inclusion of standard errors, duplicate and ambiguous results&#x02014;see below) but the default settings of these options will be appropriate for most users, so they are initially hidden to simplify the interface.
<fig id="gks1141-F2" position="float"><label>Figure 2.</label><caption><p>Form entry for different types of search. (<bold>A</bold>) &#x02018;Gene&#x02019; search&#x02014;the &#x02018;Options&#x02019; panel is shown open (not the default) in this case; (<bold>B</bold>) &#x02018;Category&#x02019; search; (<bold>C</bold>) &#x02018;Top&#x02019; search&#x02014;stage and tissue selections have already been made; (<bold>D</bold>) &#x02018;Development&#x02019; search; (<bold>E</bold>) &#x02018;Tissue&#x02019; search&#x02014;stage, tissue and display selections have already been made; (<bold>F</bold>) &#x02018;Profile&#x02019; search&#x02014;the &#x02018;Options&#x02019; panel has been opened.</p></caption><graphic xlink:href="gks1141f2p"/></fig></p><p>The requirement for the user to specify the type of gene descriptor to be entered relates to the specificity of the &#x02018;autosuggest&#x02019; facility that operates as the descriptor is entered into the search box. This facility is tailored to specific aspects of the nomenclature of symbols for <italic>Drosophila</italic> genes, as documented in <ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks1141/DC1">Supplementary Figure S4</ext-link>. The autosuggest menu is populated with terms from the descriptor field in the database, and only appears after an appropriate number of characters is entered. If the user chooses a search term from the autosuggest menu, the default settings (i.e. excluding duplicates and ambiguous hits) will guarantee that either a single result will be returned or a notification that the gene in question is only represented by an ambiguous probe set. If a term is not present in the autosuggest menu, it will not be present in the database, and searches with such terms will naturally be futile. The single table of results is presented in an uncollapsed form, as in <xref ref-type="fig" rid="gks1141-F1">Figure 1</xref>, and is preceded by two lines listing the available gene descriptors and the probe set identifier. For users wishing further information about a particular gene, a link invokes a menu of external <italic>Drosophila</italic> resources for that gene.</p><p>The default response to genes that are only represented by ambiguous probe sets is to exclude their results, and that to genes represented by duplicate probe sets is to present the results with the probe set that gives the highest/most significant signals. This is to protect the user from more questionable data (often one duplicate has low and unreplicated signals). However the user is always alerted to the situation when duplicate or ambiguous results are available but not included, and is advised of the possibility of re-running the search with the relevant option changed. In the case of ambiguous results, as already mentioned, the alert is textual. In the case of duplicate results, the situation is indicated by a green &#x02018;D&#x02019; icon (<xref ref-type="fig" rid="gks1141-F1">Figure 1</xref>A), with explanatory text available in a tooltip. Likewise, if a user does run a search having elected to include ambiguous hits, the results are flagged with a red &#x02018;A&#x02019; icon, and the FlyBase IDs of other genes detected by the probe set are listed. The user can then resolve the ambiguity by examining results for any unambiguous duplicate probe sets detecting these other genes. In general, this is unlikely to be productive, however.</p></sec><sec><title>Category search</title><p>In the &#x02018;Category&#x02019; search (<xref ref-type="fig" rid="gks1141-F2">Figure 2</xref>B), one does not specify a single gene, but rather chooses a term that encompasses a group of genes. The categories that are used for this search are those in the Ontology table, and the default option in the search entry form is to select from an autosuggest menu populated with descriptions that include the term that has been typed. There is also the option of specifying a particular Gene Ontology ID as the search term for a &#x02018;Category&#x02019; search.</p><p>Gene Ontology descriptions are in many cases narrow, and although in some cases this is what is required, in others wider search terms may be more appropriate. The third option, &#x02018;Free Search&#x02019;, provides such wider scope, returning genes corresponding to all ontological descriptions that the search term includes. Searches with a frequently occurring string can return results from a variety of different gene ontology classes. The output for this type of search, therefore, includes the matching Gene Ontology ID for each gene listed, with the description of the gene ontology in a tooltip (<xref ref-type="fig" rid="gks1141-F3">Figure 3</xref>). (The reason Gene Ontology IDs are not included in the output of &#x02018;Gene&#x02019; searches is that many genes are assigned to a large number of ontological classes).
<fig id="gks1141-F3" position="float"><label>Figure 3.</label><caption><p>Presentation of output from a &#x02018;Category&#x02019; search. Results are listed in a &#x02018;collapsed&#x02019; form, with only the first four included. The green button at the left of each entry allows individual tables to be shown, and that at the top right allows all tables to be shown. Note that the gene ontologies corresponding to the search term &#x02018;calcium channel&#x02019; differ for different genes. (The description for one of them is shown in a tooltip).</p></caption><graphic xlink:href="gks1141f3p"/></fig></p><p>Because &#x02018;Category&#x02019; searches can produce many hits, the user has an option to limit the number of results retrieved, and the latter are presented in collapsed form initially, with only the documentation visible. Individual hide/show buttons are provided at the left of each listing, and a master hide/show control is positioned at the top right (<xref ref-type="fig" rid="gks1141-F3">Figure 3</xref>).</p><p>As with the &#x02018;Gene&#x02019; search, there is the option to include duplicate and ambiguous hits. The user is made aware of any excluded ambiguous hits by a listing of their FlyBase IDs at the end of the output.</p></sec><sec><title>Top search</title><p>The &#x02018;Top&#x02019; search (<xref ref-type="fig" rid="gks1141-F2">Figure 2</xref>C) is the most straightforward search facility focussed on tissues, and allows retrieval of the most highly expressed genes for a particular adult or larval tissue. The basis of the ranking can be either &#x02018;abundance&#x02019; (the absolute extent of expression) or &#x02018;enrichment&#x02019; (the expression relative to the average in whole flies). One can select to view from 20 to 50 &#x02018;top&#x02019; genes, and, as with the &#x02018;Category&#x02019; search, the results are presented in collapsed form. For this type of search, it was decided to withhold the option to include duplicate or ambiguous results, as we believed that the user expected the results to be definitive. However, any genes detected by duplicate probe sets are flagged in the usual way so that the user has the option of investigating them further in the &#x02018;Gene&#x02019; search facility.</p></sec><sec><title>Development search</title><p>The &#x02018;Development&#x02019; search (<xref ref-type="fig" rid="gks1141-F2">Figure 2</xref>D) is a new facility, similar to the &#x02018;Top&#x02019; search, but rather than retrieving the most highly expressed genes for particular tissues, it retrieves those that show the greatest difference in expression between the adult and larval stages. Currently this facility is only available for the seven tissues in which we have data for both stages. The user chooses whether to view genes that are most highly expressed at the adult or the larval stage of the selected tissue and has the additional generic options available in the &#x02018;Top&#x02019; search.</p></sec><sec><title>Tissue search</title><p>Although, like the &#x02018;Top&#x02019; search, the &#x02018;Tissue&#x02019; search facility (<xref ref-type="fig" rid="gks1141-F2">Figure 2</xref>E) allows one to focus on an individual tissue, it differs from the former in that this is confined to a specific group of genes, selected from gene ontologies as for the &#x02018;Category&#x02019; search. Furthermore, rather than ranking within this category and returning results for e.g. the &#x02018;top 20&#x02019;, the search returns results for all genes that are expressed to a greater extent than the overall tissue average (abundance or enrichment, as selected), provided that this increase is statistically significant.</p><p>This facility does have the option to include duplicate and ambiguous hits, and, as with the &#x02018;Category&#x02019; search, the FlyBase IDs of any excluded ambiguous hits are listed at the end of the output.</p></sec><sec><title>Profile search</title><p>The &#x02018;Profile&#x02019; search (<xref ref-type="fig" rid="gks1141-F2">Figure 2</xref>F) is a new facility that takes a query gene and compares the pattern of expression in the corresponding probe set to the others in the database, returning those with a correlation coefficient (<italic>r</italic>) greater than a particular cut-off value (the default is 0.7). Thus, the user can identify other genes with a similar pattern of expression across tissues. The actual comparisons are of log<sub>2</sub>(abundance), and signals that the Affymetrix software classifies as &#x02018;not detected&#x02019; are treated as 0. The Pearson correlation coefficient is used by default, but the option of using the Spearman correlation coefficient is also provided (<xref ref-type="fig" rid="gks1141-F2">Figure 2</xref>F). The user can also vary the cut-off value of the correlation coefficient, <italic>r</italic>; but a fixed cut-off of 0.05 is used for the Bonferroni-corrected probability <italic>P<sub>B</sub></italic>.</p><p>The default display is a bar chart, although a button is provided allowing the user to switch to tabular presentation of the results (<xref ref-type="fig" rid="gks1141-F4">Figure 4</xref>). A strong and statistically significant correlation between patterns of gene expression suggests co-ordinated regulation, and could potentially identify genes with related functions.
<fig id="gks1141-F4" position="float"><label>Figure 4.</label><caption><p>Bar chart output from &#x02018;Profile&#x02019; search. The button to switch to tabular view is at the top right.</p></caption><graphic xlink:href="gks1141f4p"/></fig></p></sec></sec><sec><title>PROGRAMMATIC ACCESS TO THE DATABASE</title><p>In addition to the web interface, and the free provision of the data for download (<ext-link ext-link-type="uri" xlink:href="http://130.209.54.32/atlas/20090519all.txt">http://130.209.54.32/atlas/20090519all.txt</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://flyatlas.gla.ac.uk/flyatlas/downloads/FlyAtlasDB.sql">http://flyatlas.gla.ac.uk/flyatlas/downloads/FlyAtlasDB.sql</ext-link>), we have provided the means for developers to make &#x02018;Gene Search&#x02019; queries directly. Programs can be written to make queries through HTTP requests and retrieve the results of such queries in either tab-separated text or extensible markup language (XML) format. Documentation (APIs) can be found at <ext-link ext-link-type="uri" xlink:href="http://flyatlas.gla.ac.uk/flydirect/docs.html">http://flyatlas.gla.ac.uk/flydirect/docs.html</ext-link>.</p></sec><sec sec-type="discussion"><title>Discussion</title><p>There is no doubt that FlyAtlas has proved to be a valuable scientific resource: for example, there have been &#x0003e;30 000 accesses to the website during the past 2 years, and Google Scholar lists 451 citations to the original article, but identifies 650 articles that mention FlyAtlas in the full text. Even this is an understatement of the true uptake of the dataset because it is now also served through the FlyBase and FlyMine portals. There is thus a demand for such data across a broad community that extends well beyond Drosophilists.</p><p>The recent restructuring of the underlying data and the redesign of the web interface should add further to the value of FlyAtlas. It is now easier for the user to select valid search terms, and the data returned is more relevant, more manageable in volume and easier to assimilate. We also believe that the recently added &#x02018;Profile Search&#x02019; facility will provide new avenues for scientific investigation.</p><p>There are some aspects of the web facility that leave scope for improvement. The &#x02018;Category Search&#x02019; options, aping as they do the ontology descriptions, will, no doubt, be too narrow in scope for certain searches. The structure of gene ontologies is not hierarchical (<xref rid="gks1141-B8" ref-type="bibr">8</xref>), so that any smaller menu of broader categories will probably require manual intervention. The clarity of presentation of the bar charts in the &#x02018;Profile Search&#x02019; facility might also be improved.</p></sec><sec><title>FUTURE DIRECTIONS</title><p>The restructuring of the web interface to FlyAtlas is recent at the time of writing, so that changes can be anticipated both as a result of planned additions and in response to user feedback. We also envisage the addition of new data, and hope shortly to be able to expand the number of tissues from the existing 25. As the data are now in a relational database, there is the opportunity to serve them to the semantic web&#x02014;for example, using the D2RQ software to generate virtual resource description framework (RDF) graphs (<ext-link ext-link-type="uri" xlink:href="http://d2rq.org/">http://d2rq.org/</ext-link>). The facility would be even more valuable if RNAseq data were available to allow comparison of the transcripts found when a gene is expressed in different tissues. This would be an exciting prospect, despite being a major undertaking and entailing a further overhaul of the database and web interface.</p></sec><sec><title>SUPPLEMENTARY DATA</title><p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/cgi/content/full/gks1141/DC1">Supplementary Data</ext-link> are available at NAR Online: Supplementary Table 1 and Supplementary Figures 1&#x02013;4.</p></sec><sec><title>FUNDING</title><p>This work was funded by the <funding-source>BBSRC</funding-source>. Funding for open access charge: General funds of the University of Glasgow and Glasgow Polyomics.</p><p><italic>Conflict of interest statement.</italic> None declared.</p></sec></body><back><ack><title>ACKNOWLEDGEMENTS</title><p>The authors thank Dr Helen Purchase for helpful suggestions regarding the visual presentation of results.</p></ack><ref-list><title>REFERENCES</title><ref id="gks1141-B1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adams</surname><given-names>MD</given-names></name><name><surname>Celniker</surname><given-names>SE</given-names></name><name><surname>Holt</surname><given-names>RA</given-names></name><name><surname>Evans</surname><given-names>CA</given-names></name><name><surname>Gocayne</surname><given-names>JD</given-names></name><name><surname>Amanatides</surname><given-names>PG</given-names></name><name><surname>Scherer</surname><given-names>SE</given-names></name><name><surname>Li</surname><given-names>PW</given-names></name><name><surname>Hoskins</surname><given-names>RA</given-names></name><name><surname>Galle</surname><given-names>RF</given-names></name><etal/></person-group><article-title>The genome sequence of <italic>Drosophila melanogaster</italic></article-title><source>Science</source><year>2000</year><volume>287</volume><fpage> 2185</fpage><lpage>2195</lpage><pub-id pub-id-type="pmid">10731132</pub-id></element-citation></ref><ref id="gks1141-B2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Reiter</surname><given-names>LT</given-names></name><name><surname>Potocki</surname><given-names>L</given-names></name><name><surname>Chien</surname><given-names>S</given-names></name><name><surname>Gribskov</surname><given-names>M</given-names></name><name><surname>Bier</surname><given-names>E</given-names></name></person-group><article-title>A systematic analysis of human disease-associated gene sequences in <italic>Drosophila melanogaster</italic></article-title><source>Genome Res.</source><year>2001</year><volume>11</volume><fpage>1114</fpage><lpage>1125</lpage><pub-id pub-id-type="pmid">11381037</pub-id></element-citation></ref><ref id="gks1141-B3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chintapalli</surname><given-names>VR</given-names></name><name><surname>Wang</surname><given-names>J</given-names></name><name><surname>Dow</surname><given-names>JAT</given-names></name></person-group><article-title>Using FlyAtlas to identify better <italic>Drosophila melanogaster</italic> models of human disease</article-title><source>Nat. Genet.</source><year>2007</year><volume>39</volume><fpage>715</fpage><lpage>720</lpage><pub-id pub-id-type="pmid">17534367</pub-id></element-citation></ref><ref id="gks1141-B4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashburner</surname><given-names>M</given-names></name><name><surname>Drysdale</surname><given-names>R</given-names></name></person-group><article-title>FlyBase &#x02014; the <italic>Drosophila</italic> genetic database</article-title><source>Development</source><year>1994</year><volume>120</volume><fpage>2077</fpage><lpage>2079</lpage><pub-id pub-id-type="pmid">7925011</pub-id></element-citation></ref><ref id="gks1141-B5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McQuilton</surname><given-names>P</given-names></name><name><surname>St Pierre</surname><given-names>SE</given-names></name><name><surname>Thurmond</surname><given-names>J</given-names></name></person-group><collab>FlyBase Consortium</collab><article-title>FlyBase 101 &#x02013; the basics of navigating FlyBase</article-title><source>Nucleic Acids Res.</source><year>2012</year><volume>40</volume><fpage>D706</fpage><lpage>D714</lpage><pub-id pub-id-type="pmid">22127867</pub-id></element-citation></ref><ref id="gks1141-B6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lyne</surname><given-names>R</given-names></name><name><surname>Smith</surname><given-names>R</given-names></name><name><surname>Rutherford</surname><given-names>K</given-names></name><name><surname>Wakeling</surname><given-names>M</given-names></name><name><surname>Varley</surname><given-names>A</given-names></name><name><surname>Guillier</surname><given-names>F</given-names></name><name><surname>Janssens</surname><given-names>H</given-names></name><name><surname>Ji</surname><given-names>W</given-names></name><name><surname>Mclaren</surname><given-names>P</given-names></name><name><surname>North</surname><given-names>P</given-names></name><etal/></person-group><article-title>FlyMine: an integrated database for <italic>Drosophila</italic> and <italic>Anopheles</italic> genomics</article-title><source>Genome Biol.</source><year>2007</year><volume>8</volume><fpage>R129</fpage><pub-id pub-id-type="pmid">17615057</pub-id></element-citation></ref><ref id="gks1141-B7"><label>7</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Asleson</surname><given-names>R</given-names></name><name><surname>Schutta</surname><given-names>NT</given-names></name></person-group><source>Foundations of Ajax</source><year>2005</year><publisher-loc>New York</publisher-loc><publisher-name>Apress</publisher-name></element-citation></ref><ref id="gks1141-B8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ashburner</surname><given-names>M</given-names></name><name><surname>Ball</surname><given-names>CA</given-names></name><name><surname>Blake</surname><given-names>JA</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name><name><surname>Butler</surname><given-names>H</given-names></name><name><surname>Cherry</surname><given-names>JM</given-names></name><name><surname>Davis</surname><given-names>AP</given-names></name><name><surname>Dolinski</surname><given-names>K</given-names></name><name><surname>Dwight</surname><given-names>SS</given-names></name><name><surname>Eppig</surname><given-names>JT</given-names></name><etal/></person-group><article-title>Gene ontology: tool for the unification of biology</article-title><source>Nat. Genet.</source><year>2000</year><volume>25</volume><fpage>25</fpage><lpage>29</lpage><pub-id pub-id-type="pmid">10802651</pub-id></element-citation></ref></ref-list></back></article>