<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4816033</article-id><article-id pub-id-type="pmid">25123903</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btu537</article-id><article-id pub-id-type="publisher-id">btu537</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Papers</subject><subj-group subj-group-type="heading"><subject>Sequence Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>HapMuC: somatic mutation calling using heterozygous germ line variants near candidate mutations</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Usuyama</surname><given-names>Naoto</given-names></name><xref ref-type="aff" rid="btu537-AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Shiraishi</surname><given-names>Yuichi</given-names></name><xref ref-type="aff" rid="btu537-AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Sato</surname><given-names>Yusuke</given-names></name><xref ref-type="aff" rid="btu537-AFF1"><sup>2</sup></xref><xref ref-type="aff" rid="btu537-AFF1"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Kume</surname><given-names>Haruki</given-names></name><xref ref-type="aff" rid="btu537-AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Homma</surname><given-names>Yukio</given-names></name><xref ref-type="aff" rid="btu537-AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Ogawa</surname><given-names>Seishi</given-names></name><xref ref-type="aff" rid="btu537-AFF1"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Miyano</surname><given-names>Satoru</given-names></name><xref ref-type="aff" rid="btu537-AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Imoto</surname><given-names>Seiya</given-names></name><xref ref-type="aff" rid="btu537-AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="btu537-COR1">*</xref></contrib><aff id="btu537-AFF1"><sup>1</sup>Human Genome Center, Institute of Medical Science, The University of Tokyo, Tokyo 108-8639, <sup>2</sup>Department of Urology, Graduate School of Medicine, The University of Tokyo, Tokyo 113-8655 and <sup>3</sup>Department of Pathology and Tumor Biology, Graduate School of Medicine, Kyoto University, Kyoto 606-8501, Japan</aff></contrib-group><author-notes><corresp id="btu537-COR1">*To whom correspondence should be addressed</corresp><fn id="FN1"><p>Associate Editor: Michael Brudno</p></fn></author-notes><pub-date pub-type="ppub"><day>01</day><month>12</month><year>2014</year></pub-date><pub-date pub-type="epub"><day>14</day><month>8</month><year>2014</year></pub-date><pub-date pub-type="pmc-release"><day>14</day><month>8</month><year>2014</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the							<pub-date pub-type="epub"/>. --><volume>30</volume><issue>23</issue><fpage>3302</fpage><lpage>3309</lpage><history><date date-type="received"><day>12</day><month>12</month><year>2013</year></date><date date-type="rev-recd"><day>28</day><month>7</month><year>2014</year></date><date date-type="accepted"><day>4</day><month>8</month><year>2014</year></date></history><permissions><copyright-statement>&#x000a9; The Author 2014. Published by Oxford University Press.</copyright-statement><copyright-year>2014</copyright-year><license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p></license></permissions><abstract><p><bold>Motivation:</bold> Identifying somatic changes from tumor and matched normal sequences has become a standard approach in cancer research. More specifically, this requires accurate detection of somatic point mutations with low allele frequencies in impure and heterogeneous cancer samples. Although haplotype phasing information derived by using heterozygous germ line variants near candidate mutations would improve accuracy, no somatic mutation caller that uses such information is currently available.</p><p><bold>Results:</bold> We propose a Bayesian hierarchical method, termed HapMuC, in which power is increased by using available information on heterozygous germ line variants located near candidate mutations. We first constructed two generative models (the mutation model and the error model). In the generative models, we prepared candidate haplotypes, considering a heterozygous germ line variant if available, and the observed reads were realigned to the haplotypes. We then inferred the haplotype frequencies and computed the marginal likelihoods using a variational Bayesian algorithm. Finally, we derived a Bayes factor for evaluating the possibility of the existence of somatic mutations. We also demonstrated that our algorithm has superior specificity and sensitivity compared with existing methods, as determined based on a simulation, the TCGA Mutation Calling Benchmark 4 datasets and data from the COLO-829 cell line.</p><p><bold>Availability and implementation:</bold> The HapMuC source code is available from <ext-link ext-link-type="uri" xlink:href="http://github.com/usuyama/hapmuc">http://github.com/usuyama/hapmuc</ext-link>.</p><p><bold>Contact:</bold>
<email>imoto@ims.u-tokyo.ac.jp</email></p><p><bold>Supplementary information:</bold>
<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract><counts><page-count count="8"/></counts></article-meta></front><body><sec><title>1 INTRODUCTION</title><p>Cancer is caused by genomic alterations. In particular, somatic point mutations play a clear role in cancer development (<xref rid="btu537-B12" ref-type="bibr">Forbes <italic>et al.</italic>, 2011</xref>; <xref rid="btu537-B24" ref-type="bibr">Pleasance <italic>et al.</italic>, 2010</xref>). Driven by the recent advancement of high-throughput DNA sequencing technologies, mutation calling from tumor and matched normal sequences is becoming a standard approach in cancer research (<xref rid="btu537-B22" ref-type="bibr">Meyerson <italic>et al.</italic>, 2010</xref>). The simple goal of this approach is to detect genetic alterations that are unique to the tumor sample. For this purpose, statistical approaches that allow distinction of true somatic mutations from relatively numerous germ line variants, sequencing errors and alignment errors are required. Moreover, mutation calling methods need to be sufficiently sensitive to detect targets with low allele frequencies in cancer because of low tumor contents, copy number variations and tumor heterogeneity. In particular, it is important to capture subclones demonstrating tumor heterogeneity because this is thought to be one of the main causes of therapeutic resistance and cancer recurrence (<xref rid="btu537-B9" ref-type="bibr">Ding <italic>et al.</italic>, 2012</xref>; <xref rid="btu537-B23" ref-type="bibr">Nik-Zainal <italic>et al.</italic>, 2012</xref>; <xref rid="btu537-B30" ref-type="bibr">Shah <italic>et al.</italic>, 2009</xref>).</p><p>There are mainly two approaches to detect somatic mutations using sequence data of a tumor&#x02013;normal pair. The first approach is to use Fisher&#x02019;s exact test on read counts for evaluating the differences in allele frequencies between tumor and matched normal tissue; VarScan 2 (<xref rid="btu537-B19" ref-type="bibr">Koboldt <italic>et al.</italic>, 2012</xref>) and Genomon (<xref rid="btu537-B34" ref-type="bibr">Yoshida <italic>et al.</italic>, 2011</xref>) are categorized in this group. By ignoring complex biological structures, this approach achieves a reasonable computational speed and robustness. The second approach is based on Bayesian modeling, which calculates the posterior probability that tumor and normal samples would have different genotypes. SomaticSniper (<xref rid="btu537-B20" ref-type="bibr">Larson <italic>et al.</italic>, 2012</xref>), jointSNVMix (<xref rid="btu537-B26" ref-type="bibr">Roth <italic>et al.</italic>, 2012</xref>), Strelka (<xref rid="btu537-B28" ref-type="bibr">Saunders <italic>et al.</italic>, 2012</xref>) and MuTect (<xref rid="btu537-B7" ref-type="bibr">Cibulskis <italic>et al.</italic>, 2013</xref>) are representatives of this second group. Comparative concurrent analysis of a pair of tumor and normal sequences achieved a performance superior to the previous independent type of analysis (<xref rid="btu537-B15" ref-type="bibr">Goya <italic>et al.</italic>, 2010</xref>; <xref rid="btu537-B21" ref-type="bibr">Ley <italic>et al.</italic>, 2008</xref>; <xref rid="btu537-B24" ref-type="bibr">Pleasance <italic>et al.</italic>, 2010</xref>) in which tumor and normal samples were genotyped independently and results were subtracted.</p><p>Here, we focused on heterozygous germ line variants located near candidate somatic mutations. In real data, we observed that somatic mutations occurred mostly on one of two normal haplotypes; however, sequencing errors occurred randomly on normal haplotypes. The data are shown in Section 3.1. Based on this observation, we propose a novel statistical method, HapMuC, which can use the information of heterozygous germ line variants near candidate mutations. First, we constructed two generative models under a Bayesian statistical framework: one represents true somatic mutations and the other regards candidate somatic mutations as errors. In our generative models, we prepared four candidate haplotypes by combining a candidate mutation and a heterozygous germ line variant, if available. The alignment probabilities of the observed reads given each candidate haplotype were then computed by using profile hidden Markov models (profile HMM; <xref rid="btu537-B1" ref-type="bibr">Albers <italic>et al.</italic>, 2011</xref>; <xref rid="btu537-B10" ref-type="bibr">Eddy, 1998</xref>). Next, we inferred the haplotype frequencies and calculated the marginal likelihoods by using a variational Bayesian algorithm (<xref rid="btu537-B2" ref-type="bibr">Beal, 2003</xref>; <xref rid="btu537-B4" ref-type="bibr">Blei <italic>et al.</italic>, 2003</xref>). Finally, we derived a Bayes factor (BF), which is the ratio of the marginal likelihoods of these two models, to evaluate the possibility of the presence of somatic mutations.</p><p>We first demonstrated the effectiveness of HapMuC in a simulation study. Second, we also confirmed its efficiency based on a real sequence dataset obtained from breast cancer cell line samples, which forms part of the The Cancer Genome Atlas (TCGA) Mutation Calling Benchmark 4 datasets. Third, we tested HapMuC in the context of a whole genome using the TCGA datasets, and the analysis suggested that our algorithm performed better than the existing methods, including VarScan 2, SomaticSniper, Strelka and MuTect. In addition, we confirmed that the sensitivity of our algorithm was superior or comparable with the existing methods using the COLO-829 dataset with its list of validated somatic mutations (<xref rid="btu537-B24" ref-type="bibr">Pleasance <italic>et al.</italic>, 2010</xref>). Finally, we discuss limitations and propose future research directions for accurate mutation calling.</p></sec><sec><title>2 METHODS</title><sec id="SEC2.1"><title>2.1 Bayesian latent Dirichlet models</title><p>We constructed a generative model of observed reads. Suppose that <italic>x</italic> is an observed read and generated from one of four haplotypes. Let <italic>z<sub>ij</sub></italic> be an indicator variable that is equal to 1 if the <italic>i</italic>th read <italic>x<sub>i</sub></italic> was generated from the <italic>j</italic>th haplotype or, alternatively, is equal to 0 if <italic>x<sub>i</sub></italic> was generated from other haplotypes. We also define <inline-formula><mml:math id="MM1"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>z</mml:mi></mml:mstyle><mml:mstyle mathvariant="bold-italic"><mml:mi>i</mml:mi></mml:mstyle></mml:msub></mml:mrow></mml:math></inline-formula> as the <italic>i</italic>th row of <inline-formula><mml:math id="MM2"><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle></mml:math></inline-formula>. A likelihood of the vector of reads <bold><italic>x</italic></bold> is formulated by a conditional density <inline-formula><mml:math id="MM3"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <bold><italic>Z</italic></bold> is a haplotype matrix whose (<italic>i</italic>, <italic>j</italic>)th element is <italic>z<sub>ij</sub></italic>. Fixing the haplotype matrix <inline-formula><mml:math id="MM4"><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle></mml:math></inline-formula>, we can compute the value of the likelihood by a profile HMM (<xref rid="btu537-B1" ref-type="bibr">Albers <italic>et al.</italic>, 2011</xref>). The profile HMM formulates alignment probabilities of a read given a reference haplotype, considering mapping qualities, base qualities and homopolymer length:
<disp-formula><mml:math id="MM5"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <bold>X</bold><italic><sub>i</sub></italic> is a hidden variable for alignment states, <bold>I</bold><italic><sub>i</sub></italic> is a hidden variable for insertion states and <inline-formula><mml:math id="MM6"><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:math></inline-formula> represents the profile HMM model parameters. Albers <italic>et al.</italic> also provided a Viterbi algorithm to infer the maximum-likelihood alignment efficiently:
<disp-formula><mml:math id="MM7"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p>We used their modeling and algorithm to infer the probability of observing a short read given a reference haplotype, that is,
<disp-formula><mml:math id="MM8"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>z</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p>In addition, when read-pair information is available, we approximate the likelihood by multiplying the likelihoods of the first read and the second read, as a paired-read is considered to arise from the same haplotype.</p><p>The haplotype matrix is, however, usually unknown, and we regard the elements in <bold><italic>Z</italic></bold> as latent variables that follow a multinomial distribution with density:
<disp-formula><mml:math id="MM9"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>&#x0220f;</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>&#x0220f;</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>&#x003c0;</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM10"><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:math></inline-formula> is a vector of haplotype frequencies.</p><p>In this article, we also aimed to use information of a heterozygous germ line variant located near a candidate somatic mutation. Here, we focus on a candidate somatic mutation, which is located near a heterozygous germ line mutation. Therefore, around the targeted candidate mutation, there are two normal haplotypes, as shown in <xref ref-type="fig" rid="btu537-F1">Figure 1</xref>. We should note that because we assume that a somatic mutation occurs independently on one of two normal haplotypes, the fourth haplotype is not observed in the ideal case, i.e. <inline-formula><mml:math id="MM11"><mml:mrow><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM12"><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:math></inline-formula>. However, in practice, the observed reads contain sequencing errors; thus, to achieve robust statistical inference, we added a variable <italic>&#x003b5;</italic> for representing haplotype error, which achieves an extension of <inline-formula><mml:math id="MM13"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="MM14"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Because tumor and normal samples have different haplotypes, it is necessary to construct statistical models of <inline-formula><mml:math id="MM15"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in tumor and normal samples, separately. The concrete modelings are shown in later sections.
<fig id="btu537-F1" position="float"><label>Fig. 1.</label><caption><p>Possible types of haplotypes around a candidate mutation. (<bold>A</bold>) Normal haplotypes around a heterozygous germ line variant. Under the assumption that a somatic mutation occurs within one of two normal haplotypes, haplotype 3 was generated by mutating the first or second haplotype. (<bold>B</bold>) Haplotype 1 was mutated, yielding haplotype 3. (<bold>C</bold>) Mutated haplotype 2 yields haplotype 3. In both cases, haplotype 4 was generated only by sequencing errors</p></caption><graphic xlink:href="btu537f1p"/></fig></p><p>Because the haplotype frequencies, <inline-formula><mml:math id="MM16"><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:math></inline-formula>, are also parameters, we built a Bayesian hierarchical structure as <inline-formula><mml:math id="MM17"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, using Dirichlet distribution with a parameter vector <inline-formula><mml:math id="MM18"><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi></mml:math></inline-formula>. We also assumed that the haplotype error, <italic>&#x003b5;</italic>, follows the beta distribution, <inline-formula><mml:math id="MM19"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, with parameter <inline-formula><mml:math id="MM20"><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:math></inline-formula>.</p><p>Using the probabilistic distributions described above, we define the decomposition of the joint distribution of the form:
<disp-formula id="btu537-M1"><label>(1)</label><mml:math id="MM21"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
In our case, there are two types of sequencing data: one is from a tumor sample, denoted by <inline-formula><mml:math id="MM22"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and the other is from a matched normal sample, <inline-formula><mml:math id="MM23"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Therefore, the haplotype matrix <bold><italic>Z</italic></bold> and the vector of haplotype frequencies <inline-formula><mml:math id="MM24"><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi></mml:math></inline-formula> should be considered for each of tumor (<italic>T</italic>) and normal (<italic>N</italic>) tissue. Hence, the joint distribution is extended to
<disp-formula><mml:math id="MM25"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script" class="calligraphy">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script" class="calligraphy">Z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM26"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">X</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM27"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">Z</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We can decompose <inline-formula><mml:math id="MM28"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM29"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> by the same way as <xref ref-type="disp-formula" rid="btu537-M1">Equation (1)</xref>. A key concept in our method involves the modelings of <inline-formula><mml:math id="MM30"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in tumor and normal tissues and is described in the following sections.</p></sec><sec id="SEC2.2"><title>2.2 Modeling of sequencing data from a normal sample</title><p>First, we consider modeling of sequencing data of a normal sample. Because a normal sample contains two haplotypes, the frequencies of these haplotypes can be represented by one parameter <italic>&#x003c0;<sub>N</sub></italic>, and the third and fourth haplotypes can be regarded as the noise generated from the first and second haplotypes, respectively. Therefore, for haplotype matrix <inline-formula><mml:math id="MM31"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is modeled by
<disp-formula><graphic xlink:href="btu537um1.jpg" position="float"/></disp-formula>
where <italic>N<sub>N</sub></italic> is the number of normal reads. Because the haplotype frequency of a normal sample can be represented by a scalar parameter <italic>&#x003c0;<sub>N</sub></italic>, <inline-formula><mml:math id="MM33"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> yields the density of beta distribution.</p></sec><sec id="SEC2.3"><title>2.3 Modeling of sequencing data from a tumor sample</title><p>As mentioned above, as we assumed that one of two haplotypes is mutated in the tumor sample, the fourth haplotype does not exist in the ideal situation. Let the first haplotype be the mutated haplotype. The fourth haplotype is then produced by the second haplotype with error rate <italic>&#x003b5;</italic>; the haplotype frequencies of the second and fourth haplotypes are <inline-formula><mml:math id="MM34"><mml:mrow><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM35"><mml:mrow><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:mi>&#x003b5;</mml:mi></mml:mrow></mml:math></inline-formula>, respectively. Therefore, we obtain
<disp-formula><mml:math id="MM36"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msubsup><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>N<sub>T</sub></italic> is the number of tumor reads and <inline-formula><mml:math id="MM37"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="MM38"><mml:mrow><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The haplotype frequencies <inline-formula><mml:math id="MM39"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:math></inline-formula> then follows multinomial distribution <inline-formula><mml:math id="MM40"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, with parameter <inline-formula><mml:math id="MM41"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="SEC2.4"><title>2.4 BF for finding somatic mutations</title><p>Although we can fit the Bayesian latent Dirichlet model to the sequencing data of tumor and matched normal samples using some statistical methods, for evaluating the possibility of a variant being a true somatic mutation, we need to define a model that can be considered as a control against the model constructed under the premise of the existence of the mutation. In a Bayesian framework, we can compare the likelihoods of these two models by the BF given by
<disp-formula><mml:math id="MM42"><mml:mrow><mml:mtext>BF</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>p<sub>M</sub></italic> and <italic>p<sub>E</sub></italic> represent the models constructed under the premise of the existence of a mutation and without a mutation, respectively, and <inline-formula><mml:math id="MM43"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the marginal likelihood defined by
<disp-formula><mml:math id="MM44"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mstyle displaystyle="true"><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script" class="calligraphy">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script" class="calligraphy">Z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mi>d</mml:mi><mml:mi>&#x003b5;</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p><p>If the value of the BF is significantly large, we regard the candidate mutation as likely to be a true somatic mutation, with high probability.</p><p>As for the two models, <italic>p<sub>M</sub></italic> and <italic>p<sub>E</sub></italic>, <italic>p<sub>M</sub></italic> is the model already described in the previous sections, which we designate a mutation model. The latter model, <italic>p<sub>E</sub></italic>, can be constructed by replacing the haplotype frequencies in <inline-formula><mml:math id="MM45"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with those in <inline-formula><mml:math id="MM46"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, i.e. only two haplotypes ideally exist, and the third and fourth haplotypes are simply errors. We designate <italic>p<sub>E</sub></italic> as an error model. It is not an easy task to compute the marginal likelihood <inline-formula><mml:math id="MM47"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> because it contains high-dimensional integrals and sums. To achieve efficient computation of the marginal likelihood, we derived a variational Bayes procedure for our proposed model.</p></sec><sec id="SEC2.5"><title>2.5 Variational Bayes method for computing marginal likelihood</title><p>Suppose that <inline-formula><mml:math id="MM48"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script" class="calligraphy">Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the variational distribution that yields the decomposition
<disp-formula id="btu537-M2"><label>(2)</label><mml:math id="MM49"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script" class="calligraphy">Z</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p>Although the variational distribution should be prepared for each of the mutation and error models, we omit the index <italic>M</italic> or <italic>E</italic> for simplifying the representation. Using the variational distribution, we obtain a lower bound of the marginal likelihood
<disp-formula id="btu537-M3"><label>(3)</label><mml:math id="MM50"><mml:mrow><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script" class="calligraphy">X</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02265;</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script" class="calligraphy">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script" class="calligraphy">Z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script" class="calligraphy">Z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>E<sub>q</sub></italic> represents the expectation under the distribution <italic>q</italic>, as defined in <xref ref-type="disp-formula" rid="btu537-M2">Equation (2)</xref>. In the variational Bayes framework, a functional of <italic>q</italic> in the right side of <xref ref-type="disp-formula" rid="btu537-M3">Equation (3)</xref> is called free energy and an iterative update of <italic>q</italic>, which maximizes the free energy achieved to an estimated posterior density of <inline-formula><mml:math id="MM51"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <italic>&#x003b5;</italic>. The update formula of <italic>q</italic> in the right side of <xref ref-type="disp-formula" rid="btu537-M2">Equation (2)</xref> can be represented by
<disp-formula><mml:math id="MM52"><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM53"><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold-italic"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM54"><mml:mspace width="-.8em"/><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>beta</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>N</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM55"><mml:mspace width="-1em"/><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>Dir</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003b1;</mml:mi><mml:mi>T</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM56"><mml:mspace width="-1em"/><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>beta</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM57"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>beta</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM58"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mtext>Dir</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are the densities of beta and Dirichlet distributions, respectively, and the updated parameters can be obtained by
<disp-formula><mml:math id="MM59"><mml:mspace width="-10em"/><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM60"><mml:mspace width="-10em"/><mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM61"><mml:mspace width="5em"/><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>
</mml:mo><mml:mo>
</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM62"><mml:mspace width="2em"/><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>
</mml:mo><mml:mo>
</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM63"><mml:mspace width="-9.5em"/><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>3</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM64"><mml:mspace width="-2em"/><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM65"><mml:mspace width="-2em"/><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p>with
<disp-formula><mml:math id="MM66"><mml:mrow><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:msubsup><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM67"><mml:mrow><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:msubsup><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM68"><mml:mrow><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:msubsup><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM69"><mml:mrow><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:msubsup><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM70"><mml:mspace width="-5em"/><mml:mrow><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:msubsup><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM71"><mml:mrow><mml:mspace width="1.5em"/><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:msubsup><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM72"><mml:mspace width="-5em"/><mml:mrow><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:msubsup><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>3</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>3</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM73"><mml:mspace width=".5em"/><mml:mrow><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:msubsup><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mn>4</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003b3;</mml:mi><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mspace width=".2em"/><mml:mo>&#x02061;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p>Here, <inline-formula><mml:math id="MM74"><mml:mrow><mml:msub><mml:mi mathvariant="script" class="calligraphy">H</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the <italic>j</italic>th haplotype, and <italic>x<sub>Ni</sub></italic> and <italic>x<sub>Ti</sub></italic> are the <italic>i</italic>th read of normal and tumor samples, respectively.</p><p>We describe the derivation of the variational procedure in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Method S1</ext-link>.</p></sec><sec id="SEC2.6"><title>2.6 Inferring local normal haplotypes when there exist multiple heterozygous germ line variants</title><p>When multiple heterozygous germ line variants are located nearby, the number of candidate haplotypes in the normal sample is two to the power of the number of the germ line variants. We use a haplotype assembly algorithm (<xref rid="btu537-B16" ref-type="bibr">He <italic>et al.</italic>, 2010</xref>) to infer the two normal local haplotypes from the set of possible haplotypes. The method constitutes a dynamic programming algorithm, which will find an optimal solution with respect to the minimum error correction (MEC) score. The MEC score is the number of conflicts between the reads and the two constructed haplotypes. The problem of minimizing the MEC score is Non-deterministic Polynomial-time hard (<xref rid="btu537-B8" ref-type="bibr">Cilibrasi <italic>et al.</italic>, 2005</xref>; <xref rid="btu537-B14" ref-type="bibr">Genovese <italic>et al.</italic>, 2008</xref>); however, the optimal algorithm is computationally practical for up to reads of length 15, where the length is the number of heterozygous germ line variants.</p></sec></sec><sec><title>3 RESULTS</title><sec id="SEC3.1"><title>3.1 Sequence errors occur randomly on normal haplotypes in real data</title><p>We investigated the relationships between somatic mutations and heterozygous germ line variants nearby, using exome tumor and matched normal sequences of 10 ccRCC patients (<xref rid="btu537-B27" ref-type="bibr">Sato <italic>et al.</italic>, 2013</xref>; <xref rid="btu537-B32" ref-type="bibr">Shiraishi <italic>et al.</italic>, 2013</xref>). First, we focused on orthogonally validated somatic mutations with a heterozygous germ line single nucleotide polymorphism (SNP) nearby. The somatic mutations were detected based on tumor and matched normal exome sequences, and then validated by using RNAseq and whole genome sequence data. For each true somatic mutation, we classified the reads, which overlap both the somatic mutation position and the heterozygous SNP position, into four types: (i) RR, reads that do not support either the somatic mutation or the heterozygous SNP; (ii) VR, reads that support the somatic mutation without the heterozygous SNP; (iii) RV, reads that support the heterozygous SNP without the somatic mutation; and (iv) VV, reads that support both the somatic mutation and the heterozygous SNP. As a heterozygous germ line SNP was located nearby, we observed both RR and RV reads for each somatic mutation. However, we mostly observed either VR or VV reads (<xref ref-type="fig" rid="btu537-F2">Fig. 2</xref>B). This experiment indicated that somatic mutations occur on one of normal haplotypes. Second, we investigated the behaviors of sequence errors. We collected mismatches in error loci (<xref rid="btu537-B32" ref-type="bibr">Shiraishi <italic>et al.</italic>, 2013</xref>) using the same exome data as above, and excluded potential mapping errors by using human chained self-alignments (<xref rid="btu537-B6" ref-type="bibr">Chiaromonte <italic>et al.</italic>, 2002</xref>; <xref rid="btu537-B18" ref-type="bibr">Kent <italic>et al.</italic>, 2003</xref>; <xref rid="btu537-B29" ref-type="bibr">Schwartz <italic>et al.</italic>, 2003</xref>), simple tandem repeats (<xref rid="btu537-B3" ref-type="bibr">Benson, 1999</xref>), dbSNP 138 (<xref rid="btu537-B31" ref-type="bibr">Sherry <italic>et al.</italic>, 2001</xref>), BLAT aligner (<xref rid="btu537-B17" ref-type="bibr">Kent, 2002</xref>) with human decoy sequences (37d5) (<xref rid="btu537-B13" ref-type="bibr">Genovese <italic>et al.</italic>, 2013</xref>) and indels located nearby (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Method S2</ext-link>). For each probable sequence error position, we classified the reads, which overlap the sequence error position and the heterozygous SNP position, into four types (RR, VR, RV and VV). We observed both VR and VV reads simultaneously in most cases (<xref ref-type="fig" rid="btu537-F2">Fig. 2</xref>B), in contrast to the observations made for the somatic mutations. This observation indicates that sequence errors occur randomly on normal haplotypes.
<fig id="btu537-F2" position="float"><label>Fig. 2.</label><caption><p>Relationships between candidate mutations and nearby heterozygous germ line variants from 10 ccRCC patients&#x02019; sequence data. For each candidate mutation, we counted the reads that cover the candidate mutation and the heterozygous germ line variant (VV), and the reads that cover the candidate mutation without the heterozygous variant (VR). (<bold>A</bold>) For the orthogonally validated somatic mutations, we mostly observed the reads of a single haplotype (VV or VR). (<bold>B</bold>) However, for sequence errors, we observed the reads of both haplotypes (VV and VR) randomly</p></caption><graphic xlink:href="btu537f2p"/></fig></p></sec><sec id="SEC3.2"><title>3.2 Simulation Study</title><p>We tested HapMuC using synthetic data. In this simulation, we used several read lengths (100, 150, 300 and 1000 bp) and compared the results between these as well as single-end reads versus paired-end reads.</p><p>We generated positive and negative examples as follows:
<list list-type="order"><list-item><p>Generate a random reference DNA sequence</p></list-item><list-item><p>Generate a heterozygous germ line variant in a random location, as well as two haplotypes (h1 and h2)</p></list-item><list-item><p>Generate a somatic mutation randomly, according to an empirical distribution (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Fig. S1</ext-link>), as well as two haplotypes (h3 and h4)</p></list-item><list-item><p>Setting parameters were as follows: tumor purity was set at 20% for positive examples and 0% for negative examples. Note that a tumor purity of 20% leads to an average allele frequency of 10%.</p></list-item><list-item><p>For 50 repetitions:
<list list-type="bullet"><list-item><p>Select a source haplotype randomly, according to the multinomial distribution (haplotype frequencies), given the parameters</p></list-item><list-item><p>Select a start point of a read randomly such that the read overlaps the candidate position</p></list-item><list-item><p>Select a strand direction randomly, and generate a paired-read with 1% sequence errors and an insertion size given by a normal distribution (<inline-formula><mml:math id="MM75"><mml:mrow><mml:mi>&#x003bc;</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mtext>
</mml:mtext><mml:mi>&#x003c3;</mml:mi><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>), where <italic>l</italic> is the read length, by referring to an empirical distribution (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Fig. S2</ext-link>).</p></list-item></list>
</p></list-item></list>
</p><p>Note that we used only those examples that passed the minimum criteria for allele frequencies, read coverage, the number of variant-supporting reads and strand bias (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Method S3</ext-link>). Note also that the read depth is 50&#x000d7;. As a counterpart method, we prepared a simple Fisher&#x02019;s exact test-based method, which uses a 2 &#x000d7; 2 base counts table.</p><p>We calculated the area under curve (AUC) values (<xref rid="btu537-B5" ref-type="bibr">Bradley, 1997</xref>) for each setting. We summarize these results in <xref ref-type="table" rid="btu537-T1">Table 1</xref>. The AUC values of the Fisher method and BFs without SNPs are comparable; however, BFs that used heterozygous germ line variants outperformed these. In addition, the number of positions, for which heterozygous germ line variants could be used, increases as the read length increases.
<table-wrap id="btu537-T1" position="float"><label>Table 1.</label><caption><p>Results from the simulation study</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Read length</th><th rowspan="1" colspan="1">Distance</th><th rowspan="1" colspan="1">Number of candidate SNVs (Paired)</th><th rowspan="1" colspan="1">Number of candidate SNVs (Single)</th><th rowspan="1" colspan="1">HapMuC (Paired)</th><th rowspan="1" colspan="1">HapMuC (Single)</th><th rowspan="1" colspan="1">HapMuC without SNP</th><th rowspan="1" colspan="1">Fisher</th></tr></thead><tbody align="left"><tr><td rowspan="3" colspan="1">100</td><td rowspan="1" colspan="1">0&#x02013;100</td><td rowspan="1" colspan="1">635</td><td rowspan="1" colspan="1">635</td><td rowspan="1" colspan="1">0.8077</td><td rowspan="1" colspan="1">0.8032</td><td rowspan="1" colspan="1">0.5892</td><td rowspan="1" colspan="1">0.578</td></tr><tr><td rowspan="1" colspan="1">100&#x02013;</td><td rowspan="1" colspan="1">542</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.7614</td><td rowspan="1" colspan="1">0.6706</td><td rowspan="1" colspan="1">0.6706</td><td rowspan="1" colspan="1">0.6177</td></tr><tr><td rowspan="1" colspan="1">None</td><td rowspan="1" colspan="1">5920</td><td rowspan="1" colspan="1">6462</td><td rowspan="1" colspan="1">0.6255</td><td rowspan="1" colspan="1">0.6246</td><td rowspan="1" colspan="1">0.6246</td><td rowspan="1" colspan="1">0.6262</td></tr><tr><td rowspan="3" colspan="1">150</td><td rowspan="1" colspan="1">0&#x02013;150</td><td rowspan="1" colspan="1">939</td><td rowspan="1" colspan="1">939</td><td rowspan="1" colspan="1">0.8254</td><td rowspan="1" colspan="1">0.8147</td><td rowspan="1" colspan="1">0.5985</td><td rowspan="1" colspan="1">0.587</td></tr><tr><td rowspan="1" colspan="1">150&#x02013;</td><td rowspan="1" colspan="1">693</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.6976</td><td rowspan="1" colspan="1">0.6082</td><td rowspan="1" colspan="1">0.6082</td><td rowspan="1" colspan="1">0.6151</td></tr><tr><td rowspan="1" colspan="1">None</td><td rowspan="1" colspan="1">5407</td><td rowspan="1" colspan="1">6100</td><td rowspan="1" colspan="1">0.6402</td><td rowspan="1" colspan="1">0.6393</td><td rowspan="1" colspan="1">0.6393</td><td rowspan="1" colspan="1">0.6052</td></tr><tr><td rowspan="3" colspan="1">300</td><td rowspan="1" colspan="1">0&#x02013;300</td><td rowspan="1" colspan="1">1714</td><td rowspan="1" colspan="1">1714</td><td rowspan="1" colspan="1">0.8501</td><td rowspan="1" colspan="1">0.8457</td><td rowspan="1" colspan="1">0.6414</td><td rowspan="1" colspan="1">0.6222</td></tr><tr><td rowspan="1" colspan="1">300&#x02013;</td><td rowspan="1" colspan="1">778</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.6779</td><td rowspan="1" colspan="1">0.6046</td><td rowspan="1" colspan="1">0.6046</td><td rowspan="1" colspan="1">0.5846</td></tr><tr><td rowspan="1" colspan="1">None</td><td rowspan="1" colspan="1">4916</td><td rowspan="1" colspan="1">5964</td><td rowspan="1" colspan="1">0.6285</td><td rowspan="1" colspan="1">0.6275</td><td rowspan="1" colspan="1">0.6275</td><td rowspan="1" colspan="1">0.6246</td></tr><tr><td rowspan="3" colspan="1">1000</td><td rowspan="1" colspan="1">0&#x02013;1000</td><td rowspan="1" colspan="1">3461</td><td rowspan="1" colspan="1">3461</td><td rowspan="1" colspan="1">0.8628</td><td rowspan="1" colspan="1">0.8609</td><td rowspan="1" colspan="1">0.6302</td><td rowspan="1" colspan="1">0.6106</td></tr><tr><td rowspan="1" colspan="1">1000&#x02013;</td><td rowspan="1" colspan="1">762</td><td rowspan="1" colspan="1">0</td><td rowspan="1" colspan="1">0.6881</td><td rowspan="1" colspan="1">0.6092</td><td rowspan="1" colspan="1">0.6092</td><td rowspan="1" colspan="1">0.6048</td></tr><tr><td rowspan="1" colspan="1">None</td><td rowspan="1" colspan="1">3280</td><td rowspan="1" colspan="1">4042</td><td rowspan="1" colspan="1">0.6432</td><td rowspan="1" colspan="1">0.6423</td><td rowspan="1" colspan="1">0.6423</td><td rowspan="1" colspan="1">0.6198</td></tr></tbody></table><table-wrap-foot><fn id="btu537-TF1"><p><italic>Notes:</italic> The AUC values of HapMuC of paired-end reads and single-reads, HapMuC, which does not use heterozygous germ line variants, and the Fisher method, were compared. We also tested the methods on several read lengths (100, 150, 300 and 1000 bp). In each read length, we grouped the candidate positions by the distances between candidate mutations and closest heterozygous germ line variants, which HapMuC used (&#x02018;Distance&#x02019; column). &#x02018;None&#x02019; means that HapMuC could not use any heterozygous germ line variants.</p></fn></table-wrap-foot></table-wrap></p></sec><sec id="SEC3.3"><title>3.3 Real data</title><p>We evaluated our new algorithm, HapMuC, using the whole-genome sequence data of breast cancer cell lines (HCC1954 and HCC1143), which are publicly available as a part of the TCGA Mutation Calling Benchmark 4 datasets (<ext-link ext-link-type="uri" xlink:href="https://cghub.ucsc.edu/datasets/benchmark_download.html">https://cghub.ucsc.edu/datasets/benchmark_download.html</ext-link>). We used the tumor samples (computationally mixed with normal) and the matched pure normal samples as evaluation datasets, whose average read coverage was &#x0223c;30&#x000d7; (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Table S1</ext-link>). We first detected the candidate positions that passed minimum criteria in the evaluation dataset. Then, we assumed that candidate positions were true positives if, and only if, the positions were also called on the corresponding pure dataset with an average coverage of 60&#x000d7;. The criteria are shown in later sections. The workflow of HapMuC is given in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Figure S3</ext-link>.</p><sec id="SEC3.3.1"><title>3.3.1 Superior performance using nearby heterozygous germ line SNPs</title><p>We used the 60% tumor dataset of HCC1954 for evaluating the effect of using heterozygous germ line variants located near candidate mutations. The criteria are shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Method S4</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">S5</ext-link> for the evaluation dataset and the pure dataset, respectively. We first restricted the candidate positions so that heterozygous SNPs were located within a 100 bp distance. Second, we excluded potential mapping errors using human chained self-alignments, simple tandem repeats, dbSNP 138, BLAT aligner with human decoy sequences (37d5), and indels located nearby, in a manner similar to that described in Section 3.1 (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Method S6</ext-link>). We then confirmed the advantage of using the information of heterozygous germ line variants by comparing the results of HapMuC and a version of HapMuC that does not use the information of heterozygous germ line variants (<xref ref-type="fig" rid="btu537-F3">Fig. 3</xref>A). By drawing ROC curves (<xref rid="btu537-B11" ref-type="bibr">Fawcett, 2006</xref>; <xref rid="btu537-B25" ref-type="bibr">Robin <italic>et al.</italic>, 2011</xref>), the AUC value of HapMuC was 0.937, and that of the counterpart was 0.898 (<xref ref-type="fig" rid="btu537-F3">Fig. 3</xref>B). The difference in AUCs was statistically significant (<italic>P</italic>-value <inline-formula><mml:math id="MM76"><mml:mo>=</mml:mo></mml:math></inline-formula> 0.00124). Furthermore, the version of HapMuC that does not use heterozygous variants demonstrated superior performance compared with the simple Fisher method, suggesting that HapMuC can use information other than neighboring heterozygous germ line variants.
<fig id="btu537-F3" position="float"><label>Fig. 3.</label><caption><p>Results obtained with the HCC1954/n40t60 dataset (TCGA Mutation Calling Benchmark 4) in cases where heterozygous germ line SNPs are present near candidate mutations. In (<bold>A</bold>), a scatter plot and (<bold>B</bold>) ROC curves, the result obtained with HapMuC is compared with that of a version of HapMuC, which does not use the information of neighboring heterozygous germ line SNPs</p></caption><graphic xlink:href="btu537f3p"/></fig></p></sec><sec id="SEC3.3.2"><title>3.3.2 Alternative methods</title><p>To compare the performance of our approach in terms of mutation detection, we also ran VarScan 2, SomaticSniper, Strelka and MuTect on the same datasets. VarScan 2 is a Fisher&#x02019;s exact test-based method with an indel filter and a triallelic site filter, and SomaticSniper, Strelka and MuTect are Bayesian modeling-based methods. We summarized the parameters that we used for these alternative methods in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Method S7</ext-link>.</p></sec><sec id="SEC3.3.3"><title>3.3.3 Performance with whole-genome data</title><p>We used the 60% tumor datasets and the 40% tumor datasets of HCC1954 and HCC1143 to benchmark the performance of mutation detection in whole genome. For this analysis, we used the criteria in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Method S8</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">S9</ext-link> for the evaluation datasets and the pure datasets, respectively. We summarize the results in <xref ref-type="table" rid="btu537-T2">Table 2</xref>. Overall, the AUC values of our HapMuC algorithm were the highest under all conditions, reflecting superior sensitivity and specificity. The AUC values of the original HapMuC were slightly higher than that of a version of HapMuC that does not use the information of heterozygous germ line variants. In this analysis, HapMuC detected heterozygous germ line variants nearby in &#x0223c;15% of all the candidate positions. In addition, we show the ROC curves on HCC1954/n40t60 (<xref ref-type="fig" rid="btu537-F4">Fig. 4</xref>). The runtime of HapMuC for HCC1954/n40t60 was &#x0003c;4 h, using 48 computing nodes. The maximum memory usage of HapMuC was 0.3 GB. We report the runtime and memory usage of the other mutation-calling programs and HapMuC in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Table S2</ext-link>.
<fig id="btu537-F4" position="float"><label>Fig. 4.</label><caption><p>Benchmarking mutation-detection methods for the whole genome using the HCC1954/n60t40 dataset (TCGA Mutation Calling Benchmark 4). The ROC curves of HapMuC (red), HapMuC, which does not use heterozygous germ line variants (blue), VarScan 2 (black), Strelka (orange), MuTect (Purple) and SomaticSniper (green) in (<bold>A</bold>) SNVs and (<bold>B</bold>) Indels</p></caption><graphic xlink:href="btu537f4p"/></fig>
<table-wrap id="btu537-T2" position="float"><label>Table 2.</label><caption><p>Results obtained with whole-genome data of the TCGA Mutation Calling Benchmark 4 datasets</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Type</th><th rowspan="1" colspan="1">Sample</th><th rowspan="1" colspan="1">Number of candidates</th><th rowspan="1" colspan="1">Number of with heterozygous germ line variants</th><th rowspan="1" colspan="1">HapMuC</th><th rowspan="1" colspan="1">HapMuC without SNP</th><th rowspan="1" colspan="1">VarScan2</th><th rowspan="1" colspan="1">Strelka</th><th rowspan="1" colspan="1">MuTect</th><th rowspan="1" colspan="1">SomaticSniper</th></tr></thead><tbody align="left"><tr><td rowspan="4" colspan="1">SNVs</td><td rowspan="1" colspan="1">HCC1954/n40t60</td><td rowspan="1" colspan="1">6153</td><td rowspan="1" colspan="1">936</td><td rowspan="1" colspan="1">0.8145</td><td rowspan="1" colspan="1">0.8088</td><td rowspan="1" colspan="1">0.7192</td><td rowspan="1" colspan="1">0.7878</td><td rowspan="1" colspan="1">0.7638</td><td rowspan="1" colspan="1">0.713</td></tr><tr><td rowspan="1" colspan="1">HCC1954/n60t40</td><td rowspan="1" colspan="1">4442</td><td rowspan="1" colspan="1">693</td><td rowspan="1" colspan="1">0.9333</td><td rowspan="1" colspan="1">0.9327</td><td rowspan="1" colspan="1">0.8286</td><td rowspan="1" colspan="1">0.9236</td><td rowspan="1" colspan="1">0.9203</td><td rowspan="1" colspan="1">0.7291</td></tr><tr><td rowspan="1" colspan="1">HCC1143/n40t60</td><td rowspan="1" colspan="1">7080</td><td rowspan="1" colspan="1">995</td><td rowspan="1" colspan="1">0.864</td><td rowspan="1" colspan="1">0.8578</td><td rowspan="1" colspan="1">0.7764</td><td rowspan="1" colspan="1">0.8397</td><td rowspan="1" colspan="1">0.8444</td><td rowspan="1" colspan="1">0.7108</td></tr><tr><td rowspan="1" colspan="1">HCC1143/n60t40</td><td rowspan="1" colspan="1">4451</td><td rowspan="1" colspan="1">735</td><td rowspan="1" colspan="1">0.9601</td><td rowspan="1" colspan="1">0.9594</td><td rowspan="1" colspan="1">0.8566</td><td rowspan="1" colspan="1">0.9406</td><td rowspan="1" colspan="1">0.946</td><td rowspan="1" colspan="1">0.7013</td></tr><tr><td rowspan="4" colspan="1">Indels</td><td rowspan="1" colspan="1">HCC1954/n40t60</td><td rowspan="1" colspan="1">762</td><td rowspan="1" colspan="1">100</td><td rowspan="1" colspan="1">0.7433</td><td rowspan="1" colspan="1">0.7412</td><td rowspan="1" colspan="1">0.6145</td><td rowspan="1" colspan="1">0.7261</td><td rowspan="1" colspan="1">&#x02013;</td><td rowspan="1" colspan="1">&#x02013;</td></tr><tr><td rowspan="1" colspan="1">HCC1954/n60t40</td><td rowspan="1" colspan="1">437</td><td rowspan="1" colspan="1">67</td><td rowspan="1" colspan="1">0.729</td><td rowspan="1" colspan="1">0.7303</td><td rowspan="1" colspan="1">0.6184</td><td rowspan="1" colspan="1">0.72</td><td rowspan="1" colspan="1">&#x02013;</td><td rowspan="1" colspan="1">&#x02013;</td></tr><tr><td rowspan="1" colspan="1">HCC1143/n40t60</td><td rowspan="1" colspan="1">349</td><td rowspan="1" colspan="1">45</td><td rowspan="1" colspan="1">0.72</td><td rowspan="1" colspan="1">0.7135</td><td rowspan="1" colspan="1">0.6181</td><td rowspan="1" colspan="1">0.7132</td><td rowspan="1" colspan="1">&#x02013;</td><td rowspan="1" colspan="1">&#x02013;</td></tr><tr><td rowspan="1" colspan="1">HCC1143/n60t40</td><td rowspan="1" colspan="1">243</td><td rowspan="1" colspan="1">39</td><td rowspan="1" colspan="1">0.7524</td><td rowspan="1" colspan="1">0.7457</td><td rowspan="1" colspan="1">0.6833</td><td rowspan="1" colspan="1">0.7381</td><td rowspan="1" colspan="1">&#x02013;</td><td rowspan="1" colspan="1">&#x02013;</td></tr></tbody></table><table-wrap-foot><fn id="btu537-TF2"><p><italic>Notes:</italic> The number of candidate positions (Number of candidates), the number of candidate positions where HapMuC used heterozygous germ line variants (Number of candidates with heterozygous germ line variants) and the AUC values of HapMuC, HapMuC that does not use heterozygous germ line variants, VarScan 2, Strelka, MuTect and SomaticSniper. The candidate positions are positions that passed the minimum criteria (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Method S8</ext-link>).</p></fn></table-wrap-foot></table-wrap></p></sec><sec id="SEC3.3.4"><title>3.3.4 Most mutations called only by the Fisher method were false positives</title><p>We focused on single nucleotide variants (SNVs) of the HCC1954/n60t40 dataset to investigate the reasons behind HapMuC&#x02019;s superiority other than using heterozygous germ line variants. We excluded positions that were within a 10 000 bp distance from gap locations, in addition to the criteria in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Method S4</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">S5</ext-link>. When we set the <italic>P</italic>-value threshold of 0.05 for the Fisher method, the specificity was 0.744 and the sensitivity was 0.719. The BF threshold of 5 for HapMuC resulted in a similar specificity (0.746) and a high sensitivity (0.974). Based on these thresholds, most of the positions called only by the simple Fisher method were found to be false positives (<xref ref-type="table" rid="btu537-T3">Table 3</xref>).
<table-wrap id="btu537-T3" position="float"><label>Table 3.</label><caption><p>The number of somatic SNVs called by HapMuC and the simple Fisher method in the whole genome from the HCC1954/n40t60 dataset (TCGA Mutation Calling Benchmark 4)</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Type</th><th rowspan="1" colspan="1">Both</th><th rowspan="1" colspan="1">Only by HapMuC</th><th rowspan="1" colspan="1">Only by Fisher</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">True positive</td><td rowspan="1" colspan="1">2461</td><td rowspan="1" colspan="1">897</td><td rowspan="1" colspan="1">15</td></tr><tr><td rowspan="1" colspan="1">False positive</td><td rowspan="1" colspan="1">760</td><td rowspan="1" colspan="1">945</td><td rowspan="1" colspan="1">959</td></tr></tbody></table><table-wrap-foot><fn id="btu537-TF3"><p><italic>Notes:</italic> The threshold for HapMuC BF was 5, and that for the simple Fisher method was 0.05. Note that we excluded positions within a 10 000 bp distance from gap locations.</p></fn></table-wrap-foot></table-wrap></p></sec><sec id="SEC3.3.5"><title>3.3.5 Sequence errors caused by homopolymers</title><p>We first focused on homopolymers near candidate mutations. We measured the length of homopolymers that cover candidate mutations; the stacked histograms (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Fig. S4</ext-link>) showed that the false positives generated by the Fisher method involved longer homopolymers when compared with HapMuC. The average homopolymer length of the positions that were called only by Fisher was 8.41 and that only by HapMuC was 4.79. This difference was statistically significant (<italic>t</italic>-test <italic>P</italic> &#x0003c; 2.2e-16). This is because the profile HMM realignment algorithm in HapMuC takes into account the fact that NGS mechanisms tend to increase error rates in homopolymers (<xref rid="btu537-B1" ref-type="bibr">Albers <italic>et al.</italic>, 2011</xref>). Thus, mismatches in homopolymers have smaller weights in our haplotype inference and BF. In <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Fig. S5</ext-link>, we show an example of false positive calls of the Fisher method in a long homopolymer.</p></sec><sec id="SEC3.3.6"><title>3.3.6 Dealing with reads with several mismatches</title><p>We also investigated the number of mismatches within a 100 bp distance from candidate mutations. The stacked histograms (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Fig. S6</ext-link>) showed a trend that candidate mutations accompanying several mismatches might be false positives. The average number of mismatches near the candidate mutations that were called only by the Fisher method was 4.82, and that only by HapMuC was 1.85 (<italic>t</italic>-test <italic>P</italic> &#x0003c; 2.2e-16). This is because the reads, which contain several mismatches with relatively high base qualities, are judged not to be mapped to any of the prepared haplotypes, but are mapped to different locations in the genome during the calculation of alignment probabilities. Thus, those reads are ignored in our haplotype inference and have no impact on the BF. In <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Figure S7</ext-link>, we show a representative false positive call by the Fisher method.</p></sec></sec><sec id="SEC3.4"><title>3.4 Estimation of sensitivity using real data</title><p>We used the COLO-829, malignant melanoma cell line, and COLO-829BL, a lymphoblastoid line, to evaluate the sensitivity of our method. The data were downloaded from the European Genome-Phenome Archive (accession number EGAS00000000052), and we used the list of validated somatic SNVs (<italic>n</italic> = 497) and validated somatic indels (<italic>n</italic> = 66) (<xref rid="btu537-B24" ref-type="bibr">Pleasance <italic>et al.</italic>, 2010</xref>). These variants were converted to hg19 from their positions on the hg18 reference using the University of California Santa Cruz (UCSC) Genome Browser liftover utility. We called 494 SNVs, with a sensitivity of 99.4%, and 32 indels, with a sensitivity of 48.5%. In both cases, the sensitivity was comparable with or higher than that of the counterpart methods (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu537/-/DC1">Supplementary Method S10</ext-link>).</p></sec></sec><sec><title>4 DISCUSSION</title><p>In this article, we addressed the problem of accurately detecting somatic mutations in cancer by using tumor and matched normal NGS sequences. Based on 10 ccRCC patients&#x02019; data, we observed that true somatic mutations mostly occurred on one of two normal haplotypes; however, sequencing errors occurred randomly on normal haplotypes. Based on this observation, we developed a novel Bayesian statistical method, HapMuC, which can use the information of heterozygous germ line variants located near candidate mutations.</p><p>In our simulation study, we demonstrated that our algorithm has superior performance compared with a simple Fisher method when a candidate mutation occurs near a heterozygous germ line variant. We also tested our algorithm on several read lengths (100, 150, 300 and 1000 bp) as well as single-end reads and paired-end reads; HapMuC achieved higher AUC values with longer reads and paired reads by using additional information. For calculating the likelihood of read pairs, we approximated it by multiplying the alignment likelihoods of the first and second read, which assumes that read pairs are generated independently given the haplotype. However, we should modify our modeling for read pairs, considering their insertion size distribution, as a read-pair usually comes from a fragment.</p><p>We also confirmed the advantages of using heterozygous germ line variants based on breast cancer cell line samples, which are publicly available as a part of the TCGA Mutation Calling Benchmark 4 datasets. In this experiment, we excluded potential alignment artifacts by using some genomic annotations, a BLAT filter with human decoy sequence (37d5) and an indel filter because mapping errors can confuse the haplotype inference of our algorithm. However, detecting and eliminating alignment errors appropriately remains a problem.</p><p>Additionally, we evaluated our algorithm in the context of a whole genome using the TCGA Mutation Calling Benchmark 4 datasets. We compared the results of HapMuC with those of the simple Fisher method, Bayesian methods, which includes Strelka, MuTect and SomaticSniper, and VarScan 2, which is based on Fisher&#x02019;s exact test but which uses some filters. For both SNVs and indels, our method shows higher AUC values than the alternative methods. During subsequent manual inspection using Integrative Genomics Viewer (IGV) (<xref rid="btu537-B33" ref-type="bibr">Thorvaldsd&#x000f3;ttir <italic>et al.</italic>, 2013</xref>), we confirmed that HapMuC succeeded in using contextual information, such as mismatches and homopolymers, near candidate mutations. Although several filtering approaches have been proposed, to date, no somatic mutation caller that integrates the contextual information into its score has been available. Furthermore, the analysis using the COLO-829 dataset with the list of validated somatic mutations (<xref rid="btu537-B24" ref-type="bibr">Pleasance <italic>et al.</italic>, 2010</xref>) showed that our algorithm has sensitivity better than or comparable with that of the existing methods.</p><p>For future studies, we intend to incorporate further information into our algorithm. First, sequence strand bias, which is suggested as a false-positive filter by SomaticSniper, VarScan 2, MuTect and so on, could be considered. We can integrate the information of strand bias into HapMuC&#x02019;s score by extending our generative model. Second, we may consider the distance to the effective 3&#x02032;end, which is suggested as an additional filter by SomaticSniper. We can achieve this by modifying the profile HMM alignment algorithm to consider the distances from the edges of reads. In addition, when sequencing data of other samples are available, we can infer background error rates and use these as prior information. A recent statistical approach, called EBCall (<xref rid="btu537-B32" ref-type="bibr">Shiraishi <italic>et al.</italic>, 2013</xref>), has succeeded in achieving outstanding performance using pooled normal samples. MuTect also uses a simple false-positive filter, which checks whether candidate mutations exist in other normal samples. In terms of statistical modeling, if we could modify the mutation model and the error model as a nested model-pair, we can use a variable selection approach, such as lasso, for detecting somatic mutations.</p></sec>
<sec sec-type="supplementary-material">
<title>Supplementary Material</title>
<supplementary-material id="PMC_1" content-type="local-data">
<caption>
<title>Supplementary Data</title>
</caption>
<media mimetype="text" mime-subtype="html" xlink:href="supp_30_23_3302__index.html"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_btu537_supplementary_materials.pdf"/>
</supplementary-material>
</sec>
</body><back><ack><title>ACKNOWLEDGEMENTS</title><p>The super-computing resource was provided by Human Genome Center, the Institute of Medical Science, the University of Tokyo.</p><p><italic>Funding</italic>: This work was partly supported by Grant-in-Aid for <funding-source>Scientific Research on Innovative Areas</funding-source> (<award-id>22134004</award-id>).</p><p><italic>Conflict of interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="btu537-B1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Albers</surname><given-names>CA</given-names></name><etal/></person-group><article-title>Dindel: accurate indel calls from short-read data</article-title><source>Genome Res.</source><year>2011</year><volume>21</volume><fpage>961</fpage><lpage>973</lpage><pub-id pub-id-type="pmid">20980555</pub-id></element-citation></ref><ref id="btu537-B2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beal</surname><given-names>MJ</given-names></name></person-group><article-title>Variational Algorithms for Approximate Bayesian Inference</article-title><year>2003</year><comment>PhD thesis, The Gatsby Computational Neuroscience Unit, University College London, London, UK</comment></element-citation></ref><ref id="btu537-B3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benson</surname><given-names>G</given-names></name></person-group><article-title>Tandem repeats finder: a program to analyze DNA sequences</article-title><source>Nucleic Acids Res.</source><year>1999</year><volume>27</volume><fpage>573</fpage><pub-id pub-id-type="pmid">9862982</pub-id></element-citation></ref><ref id="btu537-B4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blei</surname><given-names>DM</given-names></name><etal/></person-group><article-title>Latent dirichlet allocation</article-title><source>J. Mach. Learn. Res.</source><year>2003</year><volume>3</volume><fpage>993</fpage><lpage>1022</lpage></element-citation></ref><ref id="btu537-B5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bradley</surname><given-names>AP</given-names></name></person-group><article-title>The use of the area under the ROC curve in the evaluation of machine learning algorithms</article-title><source>Pattern Recognit.</source><year>1997</year><volume>30</volume><fpage>1145</fpage><lpage>1159</lpage></element-citation></ref><ref id="btu537-B6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chiaromonte</surname><given-names>F</given-names></name><etal/></person-group><article-title>Scoring pairwise genomic sequence alignments</article-title><source>Pacific Symposium on Biocomputing</source><year>2002</year><volume>Vol. 7</volume><fpage>115</fpage><lpage>126</lpage><pub-id pub-id-type="pmid">11928468</pub-id></element-citation></ref><ref id="btu537-B7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cibulskis</surname><given-names>K</given-names></name><etal/></person-group><article-title>Sensitive detection of somatic point mutations in impure and heterogeneous cancer samples</article-title><source>Nat. Biotechnol.</source><year>2013</year><volume>31</volume><fpage>213</fpage><lpage>219</lpage><pub-id pub-id-type="pmid">23396013</pub-id></element-citation></ref><ref id="btu537-B8"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cilibrasi</surname><given-names>R</given-names></name><etal/></person-group><article-title>On the complexity of several haplotyping problems</article-title><source>Algorithms in Bioinformatics</source><year>2005</year><publisher-name>Springer</publisher-name><fpage>128</fpage><lpage>139</lpage></element-citation></ref><ref id="btu537-B9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ding</surname><given-names>L</given-names></name><etal/></person-group><article-title>Clonal evolution in relapsed acute myeloid leukaemia revealed by whole-genome sequencing</article-title><source>Nature</source><year>2012</year><volume>481</volume><fpage>506</fpage><lpage>510</lpage><pub-id pub-id-type="pmid">22237025</pub-id></element-citation></ref><ref id="btu537-B10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eddy</surname><given-names>SR</given-names></name></person-group><article-title>Profile hidden Markov models</article-title><source>Bioinformatics</source><year>1998</year><volume>14</volume><fpage>755</fpage><lpage>763</lpage><pub-id pub-id-type="pmid">9918945</pub-id></element-citation></ref><ref id="btu537-B11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fawcett</surname><given-names>T</given-names></name></person-group><article-title>An introduction to ROC analysis</article-title><source>Pattern Recognit. Lett.</source><year>2006</year><volume>27</volume><fpage>861</fpage><lpage>874</lpage></element-citation></ref><ref id="btu537-B12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Forbes</surname><given-names>SA</given-names></name><etal/></person-group><article-title>COSMIC: mining complete cancer genomes in the Catalogue of Somatic Mutations in Cancer</article-title><source>Nucleic Acids Res.</source><year>2011</year><volume>39</volume><fpage>D945</fpage><lpage>D950</lpage><pub-id pub-id-type="pmid">20952405</pub-id></element-citation></ref><ref id="btu537-B13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Genovese</surname><given-names>G</given-names></name><etal/></person-group><article-title>Mapping the human reference genomes missing sequence by three-way admixture in latino genomes</article-title><source>Am. J. Hum. Genet.</source><year>2013</year><volume>93</volume><fpage>411</fpage><lpage>421</lpage><pub-id pub-id-type="pmid">23932108</pub-id></element-citation></ref><ref id="btu537-B14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Genovese</surname><given-names>LM</given-names></name><etal/></person-group><article-title>Speedhap: an accurate heuristic for the single individual SNP haplotyping problem with many gaps, high reading error rate and low coverage</article-title><source>IEEE/ACM Trans. Comput. Biol. Bioinform.</source><year>2008</year><volume>5</volume><fpage>492</fpage><lpage>502</lpage><pub-id pub-id-type="pmid">18989037</pub-id></element-citation></ref><ref id="btu537-B15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goya</surname><given-names>R</given-names></name><etal/></person-group><article-title>SNVMix: predicting single nucleotide variants from next-generation sequencing of tumors</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>730</fpage><lpage>736</lpage><pub-id pub-id-type="pmid">20130035</pub-id></element-citation></ref><ref id="btu537-B16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>He</surname><given-names>D</given-names></name><etal/></person-group><article-title>Optimal algorithms for haplotype assembly from whole-genome sequence data</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>i183</fpage><lpage>i190</lpage><pub-id pub-id-type="pmid">20529904</pub-id></element-citation></ref><ref id="btu537-B17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kent</surname><given-names>WJ</given-names></name></person-group><article-title>BLAT-the BLAST-like alignment tool</article-title><source>Genome Res.</source><year>2002</year><volume>12</volume><fpage>656</fpage><lpage>664</lpage><pub-id pub-id-type="pmid">11932250</pub-id></element-citation></ref><ref id="btu537-B18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kent</surname><given-names>WJ</given-names></name><etal/></person-group><article-title>Evolution&#x02019;s cauldron: duplication, deletion, and rearrangement in the mouse and human genomes</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2003</year><volume>100</volume><fpage>11484</fpage><lpage>11489</lpage><pub-id pub-id-type="pmid">14500911</pub-id></element-citation></ref><ref id="btu537-B19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koboldt</surname><given-names>DC</given-names></name><etal/></person-group><article-title>VarScan 2: somatic mutation and copy number alteration discovery in cancer by exome sequencing</article-title><source>Genome Res.</source><year>2012</year><volume>22</volume><fpage>568</fpage><lpage>576</lpage><pub-id pub-id-type="pmid">22300766</pub-id></element-citation></ref><ref id="btu537-B20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Larson</surname><given-names>DE</given-names></name><etal/></person-group><article-title>SomaticSniper: identification of somatic point mutations in whole genome sequencing data</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>311</fpage><lpage>317</lpage><pub-id pub-id-type="pmid">22155872</pub-id></element-citation></ref><ref id="btu537-B21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ley</surname><given-names>TJ</given-names></name><etal/></person-group><article-title>DNA sequencing of a cytogenetically normal acute myeloid leukaemia genome</article-title><source>Nature</source><year>2008</year><volume>456</volume><fpage>66</fpage><lpage>72</lpage><pub-id pub-id-type="pmid">18987736</pub-id></element-citation></ref><ref id="btu537-B22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Meyerson</surname><given-names>M</given-names></name><etal/></person-group><article-title>Advances in understanding cancer genomes through second-generation sequencing</article-title><source>Nat. Rev. Genet.</source><year>2010</year><volume>11</volume><fpage>685</fpage><lpage>696</lpage><pub-id pub-id-type="pmid">20847746</pub-id></element-citation></ref><ref id="btu537-B23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nik-Zainal</surname><given-names>S</given-names></name><etal/></person-group><article-title>The life history of 21 breast cancers</article-title><source>Cell</source><year>2012</year><volume>149</volume><fpage>994</fpage><lpage>1007</lpage><pub-id pub-id-type="pmid">22608083</pub-id></element-citation></ref><ref id="btu537-B24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pleasance</surname><given-names>ED</given-names></name><etal/></person-group><article-title>A comprehensive catalogue of somatic mutations from a human cancer genome</article-title><source>Nature</source><year>2010</year><volume>463</volume><fpage>191</fpage><lpage>196</lpage><pub-id pub-id-type="pmid">20016485</pub-id></element-citation></ref><ref id="btu537-B25"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robin</surname><given-names>X</given-names></name><etal/></person-group><article-title>pROC: an open-source package for R and S+ to analyze and compare ROC curves</article-title><source>BMC Bioinformatics</source><year>2011</year><volume>12</volume><fpage>77</fpage><pub-id pub-id-type="pmid">21414208</pub-id></element-citation></ref><ref id="btu537-B26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Roth</surname><given-names>A</given-names></name><etal/></person-group><article-title>JointSNVMix: a probabilistic model for accurate detection of somatic mutations in normal/tumour paired next-generation sequencing data</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>907</fpage><lpage>913</lpage><pub-id pub-id-type="pmid">22285562</pub-id></element-citation></ref><ref id="btu537-B27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sato</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Integrated molecular analysis of clear-cell renal cell carcinoma</article-title><source>Nat. Genet.</source><year>2013</year><volume>45</volume><fpage>860</fpage><lpage>867</lpage><pub-id pub-id-type="pmid">23797736</pub-id></element-citation></ref><ref id="btu537-B28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Saunders</surname><given-names>CT</given-names></name><etal/></person-group><article-title>Strelka: accurate somatic small-variant calling from sequenced tumor-normal sample pairs</article-title><source>Bioinformatics</source><year>2012</year><volume>28</volume><fpage>1811</fpage><lpage>1817</lpage><pub-id pub-id-type="pmid">22581179</pub-id></element-citation></ref><ref id="btu537-B29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schwartz</surname><given-names>S</given-names></name><etal/></person-group><article-title>Human-mouse alignments with BLASTZ</article-title><source>Genome Res.</source><year>2003</year><volume>13</volume><fpage>103</fpage><lpage>107</lpage><pub-id pub-id-type="pmid">12529312</pub-id></element-citation></ref><ref id="btu537-B30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shah</surname><given-names>SP</given-names></name><etal/></person-group><article-title>Mutational evolution in a lobular breast tumour profiled at single nucleotide resolution</article-title><source>Nature</source><year>2009</year><volume>461</volume><fpage>809</fpage><lpage>813</lpage><pub-id pub-id-type="pmid">19812674</pub-id></element-citation></ref><ref id="btu537-B31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sherry</surname><given-names>ST</given-names></name><etal/></person-group><article-title>dbSNP: the NCBI database of genetic variation</article-title><source>Nucleic Acids Res.</source><year>2001</year><volume>29</volume><fpage>308</fpage><lpage>311</lpage><pub-id pub-id-type="pmid">11125122</pub-id></element-citation></ref><ref id="btu537-B32"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shiraishi</surname><given-names>Y</given-names></name><etal/></person-group><article-title>An empirical Bayesian framework for somatic mutation detection from cancer genome sequencing data</article-title><source>Nucleic Acids Res.</source><year>2013</year><volume>41</volume><fpage>e89</fpage><lpage>e89</lpage><pub-id pub-id-type="pmid">23471004</pub-id></element-citation></ref><ref id="btu537-B33"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thorvaldsd&#x000f3;ttir</surname><given-names>H</given-names></name><etal/></person-group><article-title>Integrative Genomics Viewer (IGV): high-performance genomics data visualization and exploration</article-title><source>Brief. Bioinform.</source><year>2013</year><volume>14</volume><fpage>178</fpage><lpage>192</lpage><pub-id pub-id-type="pmid">22517427</pub-id></element-citation></ref><ref id="btu537-B34"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yoshida</surname><given-names>K</given-names></name><etal/></person-group><article-title>Frequent pathway mutations of splicing machinery in myelodysplasia</article-title><source>Nature</source><year>2011</year><volume>478</volume><fpage>64</fpage><lpage>69</lpage><pub-id pub-id-type="pmid">21909114</pub-id></element-citation></ref></ref-list></back></article>