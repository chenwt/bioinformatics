<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 39.96?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id><journal-id journal-id-type="hwp">nar</journal-id><journal-id journal-id-type="publisher-id">nar</journal-id><journal-title-group><journal-title>Nucleic Acids Research</journal-title></journal-title-group><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">5100560</article-id><article-id pub-id-type="pmid">27458203</article-id><article-id pub-id-type="doi">10.1093/nar/gkw655</article-id><article-categories><subj-group subj-group-type="hwp-journal-coll"><subject>15</subject></subj-group><subj-group subj-group-type="heading"><subject>Methods Online</subject></subj-group></article-categories><title-group><article-title>SNP calling from RNA-seq data without a reference genome: identification, quantification, differential analysis and impact on the protein sequence</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Lopez-Maestre</surname><given-names>H&#x000e9;l&#x000e8;ne</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Brinza</surname><given-names>Lilia</given-names></name><xref ref-type="aff" rid="AFF3"><sup>3</sup></xref></contrib><contrib contrib-type="author"><name><surname>Marchet</surname><given-names>Camille</given-names></name><xref ref-type="aff" rid="AFF4"><sup>4</sup></xref></contrib><contrib contrib-type="author"><name><surname>Kielbassa</surname><given-names>Janice</given-names></name><xref ref-type="aff" rid="AFF5"><sup>5</sup></xref></contrib><contrib contrib-type="author"><name><surname>Bastien</surname><given-names>Sylv&#x000e8;re</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Boutigny</surname><given-names>Mathilde</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Monnin</surname><given-names>David</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Filali</surname><given-names>Adil El</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Carareto</surname><given-names>Claudia Marcia</given-names></name><xref ref-type="aff" rid="AFF6"><sup>6</sup></xref></contrib><contrib contrib-type="author"><name><surname>Vieira</surname><given-names>Cristina</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Picard</surname><given-names>Franck</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Kremer</surname><given-names>Natacha</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Vavre</surname><given-names>Fabrice</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Sagot</surname><given-names>Marie-France</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Lacroix</surname><given-names>Vincent</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><aff id="AFF1"><label>1</label>Universit&#x000e9; de Lyon, F-69000, Lyon; Universit&#x000e9; Lyon 1; CNRS, UMR5558, Laboratoire de Biom&#x000e9;trie et Biologie Evolutive, F-69622 Villeurbanne, France</aff><aff id="AFF2"><label>2</label>EPI ERABLE - Inria Grenoble, Rh&#x000f4;ne-Alpes</aff><aff id="AFF3"><label>3</label>PT G&#x000e9;nomique et Transcriptomique, BIOASTER, Lyon, France</aff><aff id="AFF4"><label>4</label>Universit&#x000e9; de Rennes, F-35000 Rennes; &#x000e9;quipe GenScale, IRISA, Rennes</aff><aff id="AFF5"><label>5</label>Synergie-Lyon-Cancer, Universite Lyon 1, Centre Leon Berard, Lyon, France</aff><aff id="AFF6"><label>6</label>Department of Biology, UNESP - S&#x000e3;o Paulo State University, S&#x000e3;o Jos&#x000e9; do Rio Preto, S&#x000e3;o Paulo, Brazil</aff></contrib-group><author-notes><corresp id="COR1"><label>*</label>To whom correspondence should be addressed. Email: <email>vincent.lacroix@univ-lyon1.fr</email></corresp></author-notes><pub-date pub-type="ppub"><day>02</day><month>11</month><year>2016</year></pub-date><pub-date pub-type="epub"><day>25</day><month>7</month><year>2016</year></pub-date><pub-date pub-type="pmc-release"><day>25</day><month>7</month><year>2016</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>44</volume><issue>19</issue><fpage>e148</fpage><lpage>e148</lpage><history><date date-type="accepted"><day>11</day><month>7</month><year>2016</year></date><date date-type="rev-recd"><day>05</day><month>7</month><year>2016</year></date><date date-type="received"><day>22</day><month>12</month><year>2015</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2016. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement><copyright-year>2016</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p></license></permissions><self-uri xlink:title="pdf" xlink:href="gkw655.pdf"/><abstract><p>SNPs (Single Nucleotide Polymorphisms) are genetic markers whose precise identification is a prerequisite for association studies. Methods to identify them are currently well developed for model species, but rely on the availability of a (good) reference genome, and therefore cannot be applied to non-model species. They are also mostly tailored for whole genome (re-)sequencing experiments, whereas in many cases, transcriptome sequencing can be used as a cheaper alternative which already enables to identify SNPs located in transcribed regions. In this paper, we propose a method that identifies, quantifies and annotates SNPs without any reference genome, using RNA-seq data only. Individuals can be pooled prior to sequencing, if not enough material is available from one individual. Using pooled human RNA-seq data, we clarify the precision and recall of our method and discuss them with respect to other methods which use a reference genome or an assembled transcriptome. We then validate experimentally the predictions of our method using RNA-seq data from two non-model species. The method can be used for any species to annotate SNPs and predict their impact on the protein sequence. We further enable to test for the association of the identified SNPs with a phenotype of interest.</p></abstract><counts><page-count count="13"/></counts><custom-meta-group><custom-meta><meta-name>cover-date</meta-name><meta-value>02 November 2016</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>INTRODUCTION</title><p>Understanding the genetic basis of complex phenotypes remains a central question in biology. A classical approach consists in genotyping a large number of individuals in a population based on a pre-specified catalog of variants, and in associating their genotypes to the studied phenotype. This type of approach can be applied to many loci at once, or even genome wide, through what has been called genome wide association studies (GWAS). These methods have been successfully adopted for human and model species. However, the total cost of GWAS remains very high, and the current framework cannot be applied to non-model species for which genomic resources are sparsely or not available. The recent progress in sequencing technologies together with the recent developments in assembly algorithms are largely changing this view. It can now be envisioned to search for variants associated with a phenotype using NGS data only, without relying on pre-existing genomic resources (that have potential limitations). A possible procedure, applicable to model or non-model species, consists in: (i) sequencing the genome; (ii) assembling it; (iii) identifying the SNPs; (iv) genotyping individuals and (v) associating genotypes with phenotypes. However, such a procedure remains costly and still presents the classical problems of sequential pipelines, namely the potential to accumulate experimental and computational errors at each step.</p><p>If the purpose of the study is to identify the variants related to a phenotype, the procedure can be simplified in many ways. First, SNPs can be called <italic>de novo</italic> from the reads, without separating the steps of assembly and SNP calling. Second, cost effective methods like exome or transcriptome sequencing may be adopted as the full genome is not always necessary. Third, pooling individuals may be an attractive option if genotyping is not required. These options have been explored individually and give promising results. <italic>De novo</italic> assembly of SNPs is now computationally possible (<xref rid="B1" ref-type="bibr">1</xref>&#x02013;<xref rid="B3" ref-type="bibr">3</xref>). The clear advantage is that it can be applied to non-model species, where no reference genome is available. Even in the case where a reference genome is available, these methods still give good results compared to mapping-based approaches, compensating their lower sensitivity by an ability to call more variants in repeated regions. Transcriptome sequencing is already used in several projects, both in the context of model species (<xref rid="B4" ref-type="bibr">4</xref>) and non-model species (<xref rid="B5" ref-type="bibr">5</xref>&#x02013;<xref rid="B7" ref-type="bibr">7</xref>). In both cases, it was shown that the SNP calling methods could be tailored to have a good precision, meaning that most of the reported SNPs are true SNPs. However, their recall (i.e. capacity to exhaustively report all SNPs) remains to be clearly determined. Clearly, only SNPs from transcribed regions can be targeted, but they arguably correspond to those with a more direct functional impact. Using RNA-seq technology largely reduces the cost of the experiment, and the obtained data concurrently mirror gene expression, the most basic molecular phenotype. RNA-seq experiments may also provide very high depth at specific loci and therefore allow to discover infrequent alleles in highly expressed genes. Finally, pooling samples is already extensively used in DNA-seq (sometimes termed Pool-seq) (<xref rid="B8" ref-type="bibr">8</xref>). The main advantage of this method is that it clearly decreases costs, as library preparation for bar-coding is nowadays approximately the same price as sequencing. The drawback is that genotypes cannot be derived anymore. Instead, we have access to the allele frequency in the population, a result known as the allelotype. In this work, we present a method for the de novo identification, differential analysis and annotation of variants from RNAseq data in non-model species. It takes as input RNA-seq reads from at least two conditions (e.g. the modalities of the phenotype) with at least two replicates each, and outputs variants associated with the condition. The method does not require any reference genome, nor a database of SNPs. It can therefore be applied to any species for a very reasonable cost. We first evaluated our method using RNA-seq data from the human Geuvadis project (<xref rid="B9" ref-type="bibr">9</xref>). The great advantage of this dataset is that SNPs are well annotated, since the selected individuals were initially included in the 1000 genomes project (<xref rid="B10" ref-type="bibr">10</xref>). This enables to clarify what is the precision and recall of our method, and how it compares to methods which require a reference genome or a reference transcriptome.</p><p>We then applied our method in the context of non-model species. First we focused on <italic>Asobara tabida</italic>, an hymenoptera that exhibits contrasted phenotypes of dependence to its symbiont. Using RNA-seq data from two extreme modalities of the phenotype, we were able to establish a catalog of SNPs, stratify them by their impact on the protein sequence, and assess which SNPs had a significant change of allele frequency across modalities. We further selected cases for experimental validation, and were able to confirm that the SNPs were indeed condition specific. We then applied our method on two recently diverged <italic>Drosophila</italic> species, <italic>D. arizonae</italic> and <italic>D. mojavensis</italic>. These species can still produce hybrids that are sterile. In this case, our method identifies differences of 1 nt, which are not SNPs but divergences. On this system also, we were able to validate experimentally that the loci we identify were truly divergent.</p><p>We outline that, even though the case studies presented in this paper include two replicates, the method can be applied to any number of replicates. Larger cohorts can be helpful to narrow down the list of SNPs likely to be really causal for the phenotype. Our key contribution is that we are able to produce a list of SNPs stratified by their impact on the protein sequence, and ranked by difference of expressed allele frequency across conditions. This list can be further mined for candidates to follow up experimentally.</p><p>All the methods presented in this paper are implemented in software that are freely available at <ext-link ext-link-type="uri" xlink:href="http://kissplice.prabi.fr/TWAS">http://kissplice.prabi.fr/TWAS</ext-link>. In particular, the statistical procedure that we developed is available through an R package, <sc>kiss</sc>DE, which is of general interest for researchers who have obtained read counts for pairs of variants in a set of conditions and wish to test if these counts reflect the specificity of the variant in a particular condition.</p></sec><sec sec-type="materials|methods" id="SEC2"><title>MATERIALS AND METHODS</title><sec id="SEC2-1"><title>Overview</title><p>We present here a collection of methods which can be used together to produce, from RNA-seq data alone, a list of condition-specific SNPs, stratified by their predicted impact on the protein. Figure <xref ref-type="fig" rid="F1">1</xref> summarises the different steps.</p><fig id="F1" orientation="portrait" position="float"><label>Figure 1.</label><caption><p>With fasta/fastq input from an RNA-seq experiment, SNPs are found by K<sc>is</sc>S<sc>plice</sc> without using a reference. As K<sc>is</sc>S<sc>plice</sc> provides only a local context around the SNPs, a reference can be built with T<sc>rinity</sc>, and SNPs can be positioned on whole transcripts. Some SNPs that do not map on the transcripts of T<sc>rinity</sc>, called orphan SNPs, are harder to study but can still be of interest. We propose a statistical method, called <sc>kiss</sc>DE, to find condition-specific SNPs (even if they are not positioned) out of all SNPs found. Finally, we can also predict the amino acid change for the positioned SNPs, and intersect these results with condition-specific SNPs using our package K<sc>is</sc>S<sc>plice2</sc>R<sc>ef</sc>T<sc>ranscriptome</sc> (K2<sc>rt</sc>).</p></caption><graphic xlink:href="gkw655fig1"/></fig><p>T<sc>rinity</sc>, <sc>Transdecoder</sc> and <sc>Blat</sc> are third-party software. K<sc>is</sc>S<sc>plice</sc> was published recently (<xref rid="B11" ref-type="bibr">11</xref>), <sc>kiss</sc>DE and K<sc>is</sc>S<sc>plice2</sc>R<sc>ef</sc>T<sc>ranscriptome</sc> (K2<sc>rt</sc>) are methods we introduce in this paper.</p></sec><sec id="SEC2-2"><title>De novo identification of SNPs</title><p>K<sc>is</sc>S<sc>plice</sc> (<xref rid="B11" ref-type="bibr">11</xref>) is a software initially designed to find alternative splicing events (AS) from RNA-seq data, but which also outputs indels and SNPs. We present here its functionality for SNP detection. The key concept, initially introduced in Peterlongo <italic>et&#x000a0;al</italic>. (<xref rid="B12" ref-type="bibr">12</xref>) and later used in Iqbal <italic>et&#x000a0;al</italic>. and Uricaru <italic>et&#x000a0;al</italic>. (<xref rid="B1" ref-type="bibr">1</xref>,<xref rid="B2" ref-type="bibr">2</xref>) is that a SNP corresponds to a recognisable pattern, called a <italic>bubble</italic>, in a de Bruijn graph (DBG) built from the reads. De Bruijn graphs are widely used data structures in de novo assembly (<xref rid="B13" ref-type="bibr">13</xref>&#x02013;<xref rid="B15" ref-type="bibr">15</xref>), as they are well tailored for large amounts of short reads. In our case, DBGs are especially appealing because they model explicitly each nucleotide, a required feature to capture SNPs. The nodes of the graph are words of length <italic>k</italic>, called <italic>k</italic>-mers. There is an edge between two nodes if the suffix of length <italic>k</italic> &#x02212; 1 of the first <italic>k</italic>-mer is identical to the prefix of length <italic>k</italic> &#x02212; 1 of the second <italic>k</italic>-mer. The DBG that is built from two alleles of a locus will therefore correspond to a pair of vertex-disjoint paths in the graph, which form the bubble. Unlike AS events and indels, bubbles generated by SNPs have two paths of equal length (Figure <xref ref-type="fig" rid="F2">2B</xref>). Linear paths of the DBG can be further compressed in a single node without loss of information (Figure <xref ref-type="fig" rid="F2">2C</xref>).</p><fig id="F2" orientation="portrait" position="float"><label>Figure 2.</label><caption><p>(<bold>A</bold>) A SNP present in two alleles in the data. (<bold>B</bold>) The de Bruijn Graph derived from the data. For the sake of simplicity of exposition, we draw here with <italic>k</italic> = 3. In practice, <italic>k</italic> = 41. (<bold>C</bold>) A compressed de Bruijn graph can be obtained by merging nodes with a single outgoing edge with nodes with a single incoming edge. This compression step is lossless. (<bold>D</bold>) The two paths in the compressed de Bruijn graph correspond to the two alleles of the SNP.</p></caption><graphic xlink:href="gkw655fig2"/></fig><p>In the special case where there are two SNPs located less than <italic>k</italic> nt apart on the genome, they will be reported in the same bubble (Supplementary Figure S1). In the case where the two SNPs are perfectly linked, a single bubble is reported. If they are partially linked, each haplotype will correspond to a path, and K<sc>is</sc>S<sc>plice</sc> will report all pairs of paths. In this case, the number of bubbles does not correspond to the number of SNPs, but to the number of pairs of observed haplotypes. Supplementary Figure S2 illustrates the case of two SNPs and four haplotypes.</p><p>K<sc>is</sc>S<sc>plice</sc> consists in essentially three steps: (i) building the DBG from the RNA-seq reads; (ii) enumerating all bubbles in this graph and (iii) mapping the reads to each path of each bubble to quantify the frequency of each variant. Particular attention was paid to both the memory (<xref rid="B16" ref-type="bibr">16</xref>,<xref rid="B17" ref-type="bibr">17</xref>) and time (<xref rid="B18" ref-type="bibr">18</xref>) requirements of the pipeline. K<sc>is</sc>S<sc>plice</sc> was able to process 200M reads of 2 &#x000d7; 75 nt in 20 hours, with less than 16GB of RAM.</p></sec><sec id="SEC2-3"><title>Filtering out sequencing errors and inexact repeats</title><p>SNPs correspond to bubbles in the de Bruijn graph derived from the reads. However, not all bubbles in the DBG correspond to SNPs. Essentially two types of false positives can be found: sequencing errors and inexact repeats. RNA editing sites may also be mistaken for SNPs but in practice, these correspond to a few cases only, that we discuss in the Results section.</p><p><bold>Sequencing errors</bold> may generate bubbles in the DBG. A distinctive feature that helps to discriminate them from true variants is that one path of the bubble is expected to be poorly covered. In practice, a common way to filter out sequencing errors when dealing with DNA-seq data is to remove all rare <italic>k</italic>-mers (seen less than a given number of times) prior to the DBG construction. This simple strategy, implemented for instance in <sc>DiscoSNP</sc>, is however not sufficient when dealing with RNA-seq data. Since the coverage depends on gene expression, it is therefore very unequal across genes, and the cut-off should be adapted to each gene. To account for this constraint, we introduced a relative cut-off, which enables to remove edges in the DBG that are supported by less than a percentage of all counts outgoing from (or incoming to) the same node. This enables to remove sequencing errors even in highly expressed genes (Figure <xref ref-type="fig" rid="F3">3</xref>). Clearly, the drawback of these cut-off strategies is that rare variants will be filtered out because they will be mistaken for sequencing errors. Our ability to detect rare variants is therefore limited by this critical parameter. We set the cut-off to 5%. This cut-off corresponds to a good trade-off between precision and recall (Supplementary Figure S3).</p><fig id="F3" orientation="portrait" position="float"><label>Figure 3.</label><caption><p>Sequencing errors and rare variants generate bubbles in DBGs with very unbalanced path coverage. (<bold>A</bold>) For ease of exposition of the concept, we represent here the reads mapping to a reference genome. Applying an absolute cutoff would remove the sequencing error for a poorly expressed gene, but not for a highly expressed gene. (<bold>B</bold>) Applying a relative cutoff of 5% in the DBG removes one or two edges from the red path and hence prevents this bubble from being found.</p></caption><graphic xlink:href="gkw655fig3"/></fig><p><bold>Inexact genomic repeats</bold> may also generate bubbles in the DBG (Figure <xref ref-type="fig" rid="F4">4</xref>). This is the case for instance for recently diverged paralogs which still share a lot of sequence similarity and hence may differ locally by one nucleotide flanked by <italic>k</italic> conserved nucleotides. This is also the case for other types of repeats, including inexact tandem repeats or transposable elements which may be present in the UTRs and introns of genes. In principle, introns are not present in RNA-seq data, but in practice, whatever the protocol used to filter out pre-mRNA, a proportion of at least 5% remains (<xref rid="B19" ref-type="bibr">19</xref>).</p><fig id="F4" orientation="portrait" position="float"><label>Figure 4.</label><caption><p>Two inexact repeats give rise to a pattern in the DBG that resembles a SNP (<bold>A</bold>). Very often, repeats are present in more than two copies (<bold>B</bold>) and therefore generate branching bubbles. Bubbles with more than five branches (<bold>C</bold>) are filtered out.</p></caption><graphic xlink:href="gkw655fig4"/></fig><p>The question of discriminating SNPs from inexact repeats has already been addressed in the literature in the case of unpooled data. Romiguier <italic>et&#x000a0;al</italic>. (<xref rid="B5" ref-type="bibr">5</xref>) propose to use the idea that loci corresponding to recently diverged paralogs should present an excess of heterozygous sites. This idea cannot be employed in our case since we want our method to be able to deal with pooled data, where we cannot genotype individuals.</p><p>Repeats present in a large number of copies (like transposable elements, or large families of paralog genes) generate a large number of bubbles which are false positives. However, these bubbles have a specific feature that we can use to discriminate them from the others: they are branching (Figure <xref ref-type="fig" rid="F4">4</xref>). The more (inexact) copies in the repeat family, the higher the number of branches in each bubble. In order to filter them out, we introduced a parameter <italic>b</italic>, which corresponds to the maximum number of branches allowed. If one path of the bubble has more than <italic>b</italic> branches, then the bubble is filtered out. In practice, we set this parameter to 5, which appeared to be a good trade-off between recall and precision as shown in Supplementary Figure S3.</p><p>Repeats present in a small number of copies are not filtered out by this criterion. Some can be filtered by focusing on bubbles whose path length is strictly 2<italic>k</italic> + 1, not larger. We found that this simple strategy was efficient and we used it in this work. It can however be modified in K<sc>is</sc>S<sc>plice</sc>with the <italic>s</italic> parameter, which we recommend if the purpose is to find multiple SNPs. In any case, most inexact repeats are actually filtered out at the next step of the pipeline, when we test for the enrichment of one variant in one condition (as described in the Statistical analysis section). Indeed, most repeats do not have expression levels that are condition-specific. The ones that are <italic>not</italic> filtered out at this step correspond to paralogous genes, where one copy is more expressed in the first condition and the second copy is more expressed in the other condition. Although these are not SNPs, we can argue that they are still relevant candidates for an association study aiming at proposing causes for the difference of phenotype.</p></sec><sec id="SEC2-4"><title>Predicting the impact of SNPs on the protein sequence</title><p>K<sc>is</sc>S<sc>plice</sc> predicts SNPs, but outputs only a very local context around the SNP. In order to predict the amino acid change it causes, if any, we need to place the SNP in a larger genomic context. For this, we relied on a widely used global transcriptome assembler: T<sc>rinity</sc> (<xref rid="B15" ref-type="bibr">15</xref>), which takes as input RNA-seq reads and outputs contigs that correspond to either full-length transcripts (if the expression level of the transcript is sufficient) or to fragments of transcripts. The results of K<sc>is</sc>S<sc>plice</sc> were aligned onto the transcripts predicted by T<sc>rinity</sc> using <sc>Blat</sc> (<xref rid="B20" ref-type="bibr">20</xref>). Concurrently, we Fdsearched for coding potential in the transcripts using <sc>TransDecoder</sc>. Once we had the location of the SNP within the transcript and the location of the open reading frame (ORF), we could assess if the SNP was located within the CDS or not, and if so, if it was a synonymous or non synonymous SNP. In the case where no ORF was predicted for the transcript, we concluded that the SNP was within a non coding region. In practice, this can correspond to a non coding RNA, a UTR or an intron. Prediction of the amino acid change of a SNP was included in a Python package, called K<sc>is</sc>S<sc>plice2</sc>R<sc>ef</sc>T<sc>ranscriptome</sc> (<sc>K2rt</sc>), which takes as input a set of predicted ORFs (bed format), the output of K<sc>is</sc>S<sc>plice</sc> (fasta format), and a mapping of the results of K<sc>is</sc>S<sc>plice</sc> to the transcripts (psl format). Importantly, T<sc>rinity</sc>, <sc>TransDecoder</sc> and <sc>Blat</sc> are third party software which can be replaced by others, provided the exchange formats are respected (bed and psl).</p><p>In the case where a SNP mapped to several T<sc>rinity</sc> transcripts, we reported the amino acid change of the SNP in each transcript. This happened in particular when a SNP was located in a constitutive exon of a gene that gave rise to multiple alternative transcripts through alternative splicing. We further show in the Results Section that our ability to call SNPs both in constitutive exons and alternative exons is a strong advantage of our method against others that first map the reads to the assembled transcriptome and then call SNPs using a genotyper.</p><p>In the case where a SNP mapped to no transcript, then it could not be treated by <sc>K2rt</sc> and it was filtered out. Those SNPs were called orphan SNPs. They were mostly located in poorly expressed genes and/or highly repeated regions. Indeed, repeated regions are notoriously difficult to assemble. When repeated regions are located within genes, they may either generate chimeric transcripts in the assembly if the assembler is too permissive, or a series of truncated short contigs if the assembler is too conservative. By default, T<sc>rinity</sc> does not output contigs shorter than 200 nucleotides. Because these contigs are highly enriched in repeats and poorly expressed genes, it explains the origin of the majority of our orphan SNPs.</p><p>As mentioned in the model section, the number of bubbles does not always correspond to the number of SNPs. In the case of SNPs located less than <italic>k</italic> nucleotides apart, the number of bubbles corresponds to the number of pairs of haplotypes out of the total number of haplotypes. The same SNP may therefore be present in multiple bubbles. When mapping the bubbles to a reference transcriptome, it is possible to remove this redundancy and count the true number of SNPs. Indeed, if two bubbles map to the same transcript at the same location, then it means that they refer to the same SNP, and we count it only once.</p><p>The software versions that we used were: T<sc>rinity</sc> r20140717, <sc>TransDecoder</sc> v2.0.1, <sc>BlatSuite36</sc>, K<sc>is</sc>S<sc>plice</sc> v2.4, K<sc>is</sc>S<sc>plice2</sc>R<sc>ef</sc>T<sc>ranscriptome</sc> v1.0.</p><p>All were used with default parameters. We set the minimum query coverage to 90% in <sc>K2rt</sc>. Changing this from 70% to 90% only marginally affected our results.</p><p>A critical parameter in de novo assembly is the <italic>k</italic>-mer size. In T<sc>rinity</sc>, this value is set to 25 and cannot be modified. In K<sc>is</sc>S<sc>plice</sc> the default value is 41 as we found it is a good compromise between recall and precision. We also tested 25 and this resulted in an increase of 10% in recall but a decrease of 10% in precision (Supplementary Figure S3). For advanced users interested in obtaining a more exhaustive list of candidates (hence optimising recall), we recommend to decrease the value of <italic>k</italic> in K<sc>is</sc>S<sc>plice</sc>.</p></sec><sec id="SEC2-5"><title>Statistical analysis</title><sec id="SEC2-5-1"><title>Testing the association between a variant and a condition</title><p>Given the number of SNPs (<italic>n</italic>) and the number of replicates (<italic>m</italic>), our data set is a count matrix of size 2<italic>n</italic> &#x000d7; <italic>m</italic>, with two lines corresponding to one SNP (upper and lower path representing the two different alleles with one nucleotide differing between both paths). For each individual, we aimed to compare read counts per allele and per condition. As we worked with biological replicates, several sources of variance were added and the variance parameter of the Poisson distribution was in general not flexible enough to describe the data (<xref rid="B21" ref-type="bibr">21</xref>,<xref rid="B22" ref-type="bibr">22</xref>). Hence, our statistical analysis adopted the framework of count regression with Negative Binomial distribution.</p><p>We considered a two-way design with interaction, with <italic>alleles</italic> and <italic>experimental conditions</italic> as main effects. Following the Generalized Linear Model framework, the expected intensity of the signal was denoted by &#x003bb;<sub><italic>ijk</italic></sub> and was decomposed as:
<disp-formula><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \log \lambda _{ijk} = \mu + \alpha _{i} +\beta _{j} + \left(\alpha \beta \right)_{ij} \end{equation*}\end{document}</tex-math></disp-formula></p><p>where &#x003bc; is the local mean expression of the transcript that contains the SNP, &#x003b1;<sub><italic>i</italic></sub> the effect of allele <italic>i</italic> on the expression, &#x003b2;<sub><italic>j</italic></sub> the contribution of condition <italic>j</italic> to the total expression, and (&#x003b1;&#x003b2;)<sub><italic>ij</italic></sub> the interaction term. In order to properly model the variability of the data that are characterised by overdispersion (as in any RNASeq data (<xref rid="B21" ref-type="bibr">21</xref>,<xref rid="B22" ref-type="bibr">22</xref>)), we considered the Negative Binomial distribution. In this setting, <italic>Y</italic><sub><italic>ijk</italic></sub> denotes the counts of a sample <italic>k</italic> with allele <italic>i</italic> in condition <italic>j</italic>. We assume that:
<disp-formula><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} Y_{ijk} \sim NB(\lambda _{ijk},v_{ijk}), \end{equation*}\end{document}</tex-math></disp-formula></p><p>with &#x003bb;<sub><italic>ijk</italic></sub> defined as above. With this model, the variance of the observations becomes:
<disp-formula><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} v_{ijk} = \lambda _{ijk} + \phi \times \lambda _{ijk}^2, \end{equation*}\end{document}</tex-math></disp-formula></p><p>with &#x003d5; the over-dispersion, which is the excess of variance seen in the data in comparison to a Poisson distribution.</p><p>Due to numerical instabilities associated with the estimation of Negative Binomial parameters, we adopted a model selection approach to determine which model was best suited to handle the over-dispersion parameter &#x003d5;. Our strategy was first to estimate a model without over-dispersion using the <sc>glmnet</sc> package (model <inline-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {M}(\phi =0)$\end{document}</tex-math></inline-formula>). We then considered two different estimation methods for the parameter &#x003d5;, namely a global estimation approach using the package <sc>aod</sc> (model <inline-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {M}(\phi =\phi _{\text{global}})$\end{document}</tex-math></inline-formula>), and a SNP-specific parameter using the <sc>DSS</sc> package (model <inline-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mathcal {M}(\phi =\phi ^i_{\text{DSS}})$\end{document}</tex-math></inline-formula>. We used a BIC to choose the best model out of the three. Before comparing the allele read counts from different libraries, the count data were normalised by library sizes as proposed in the <sc>DESeq</sc> package (<xref rid="B23" ref-type="bibr">23</xref>). This software has been shown to be the most efficient according to a recent normalisation comparison study (<xref rid="B24" ref-type="bibr">24</xref>). Pseudo-counts (<italic>i.e</italic>., systematic random allocation of ones) were considered for SNPs showing many zeros to avoid singular hessian matrices while fitting the generalised linear model. Some events were then filtered out based on their counts: if global counts (for all replicates and all conditions) for both variants were too low (less than 10 counts), we considered that we did not have enough power to conclude on this event and we did not test it.</p><p>We then performed the core test on the association between variant and condition. The target hypothesis was <italic>H</italic><sub>0</sub>: {(&#x003b1;&#x003b2;)<sub><italic>ij</italic></sub> = 0}, i.e. no interaction between the allele and the condition. If this interaction term is not null, a differential usage of an allele across conditions occurred. The test was performed using a Likelihood Ratio Test with one degree of freedom, which corresponds to the supplementary interaction parameter that is included in the second model and not in the first (<xref rid="B25" ref-type="bibr">25</xref>). To account for multiple testing, <italic>p</italic>-values were adjusted with a 5% false discovery rate (FDR) following a Benjamini&#x02013;Hochberg procedure (<xref rid="B26" ref-type="bibr">26</xref>).</p></sec><sec id="SEC2-5-2"><title>Quantifying the magnitude of the effect</title><p>When a variant is found to be differentially represented in two populations, one remaining difficulty is to quantify the magnitude of this effect. Indeed, significant (<italic>P</italic> &#x0003c; 0.05) but weak effects are often detected, especially in RNA-seq data in which some genes are very highly expressed (and hence have very high read counts).</p><p>A natural measure for quantifying the magnitude of the effect would be the difference of allele frequencies between the two conditions. In practice, the true difference of allele frequencies is not known, and we estimated it using the RNA-seq counts. The precision of this estimation is discussed in the Results Section.</p><p>We denote by <italic>f</italic><sub><italic>e</italic></sub> the estimation of the allele frequency based on RNA-seq counts:
<disp-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} f_e \:=\: \frac{\#counts\_variant_1}{\#counts\_variant_1 + \#counts\_variant_2}. \end{equation*}\end{document}</tex-math></disp-formula></p><p>The value of <italic>f</italic><sub><italic>e</italic></sub> was computed for each replicate of each condition. We then took the mean of these values for all replicates within each condition. Finally, we calculated the difference across conditions and obtained the magnitude of the effect: <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Df_e = f_{e_{cond1}} - f_{e_{cond2}}.$\end{document}</tex-math></inline-formula> In the special case where the two variants had low counts (less than 10) within one replicate, then <italic>f</italic><sub><italic>e</italic></sub> was not calculated. Finally, if at least half of the replicates of one condition had low counts, <italic>Df</italic><sub><italic>e</italic></sub> was not computed either. Overall, this prevented from over-interpreting large magnitudes obtained from low counts.</p><p>Our method is embedded and distributed in an R package, called <sc>kiss</sc>DE, which can take as input either the output file of K<sc>is</sc>S<sc>plice</sc> or any count matrix with two lines representing an event.</p></sec></sec><sec id="SEC2-6"><title>Methodology for testing and validating our approach</title><p>We first evaluated our method in human, because it is a species for which a reference genome is available and SNPs are well annotated. We then used our method on a non-model species: <italic>Asobara tabida</italic>, an hymenoptera that exhibits contrasted phenotypes and for which no reference genome is available. Finally, we applied our method on a different evolutionary timescale, working on two recently diverged <italic>Drosophila</italic> species, <italic>D. mojavensis</italic> and <italic>D. arizonae</italic>, for which a draft reference genome is available only for <italic>D. mojavensis</italic>.</p><sec id="SEC2-6-1"><title>The Geuvadis dataset</title><p>Our method enables to find SNPs from RNA-seq data. In order to assess if the SNPs we find are correct, and if the list we output is exhaustive, we chose to test our method on RNA-seq data from the Geuvadis project. Indeed, the individuals whose transcriptome was sequenced in this project were already included in the 1000 genome project. Hence, their SNPs have already been well annotated. We downloaded fastq files from SRA (see Data access) and selected 10 Toscans and 10 Central Europeans. We sampled 10M reads for each individual and concatenated the fastq files in pools of five individuals.</p></sec><sec id="SEC2-6-2"><title>Definition of the set of true SNPs and their genotypes</title><p>We downloaded the vcf file from the 1000G webpage. For each SNP called in the 1000 Genomes project, we had at our disposal the genotype of each individual. We focused on the genotypes of the 20 individuals selected for our analysis. Whenever only one allele was represented in the 20 individuals, we filtered out this SNP, as it simply cannot be discovered based on these 20 individuals only.</p><p>Whenever one SNP was covered by less than 5 reads out of the total number of reads in the 20 individuals, we considered that the SNP was located in a too poorly expressed region and could not be discovered by RNA-seq. Other levels of poorly/medium/highly expressed regions are discussed in the Results section. The read coverage was computed using SAM<sc>tools</sc> depth, on the .sam file obtained after mapping the reads with <sc>Star</sc> (v2.3.0) (<xref rid="B27" ref-type="bibr">27</xref>).</p></sec><sec id="SEC2-6-3"><title>Calling SNPs from reads mapped to a reference genome: <sc>Gatk-genome</sc></title><p>In order to clarify if the performances of our method were on par with other methods, we chose to benchmark against <sc>Gatk</sc>, which is the most widely used method for variant calling in eukaryote samples when a reference genome is available.</p><p>We employed the <sc>Gatk</sc> Best Practices workflow for SNP and indel calling on RNA-seq data (<ext-link ext-link-type="uri" xlink:href="https://www.broadinstitute.orggatkguidearticle?id=3891">https://www.broadinstitute.orggatkguidearticle?id=3891</ext-link> posted on 6 March 2014, last updated on 31 October 2014) which considers the following steps: (i) mapping to the reference genome with the <sc>Star</sc> aligner, 2-pass method (<xref rid="B28" ref-type="bibr">28</xref>) with the suggested parameters allowing to obtain the best sensitivity for the variant call task, where during the second pass of <sc>Star</sc> a new reference index is created from the splice junction information determined during the first step alignment and a new alignment step is done with the new index reference; (ii) adding read group information, sorting, marking duplicates and indexing, using Picard's tools; (iii) splitting reads into exon segments (removing Ns but maintaining grouping information) and hardclipping sequences overhanging into the intronic regions, using the SplitNCigarReads <sc>Gatk</sc> tool; (iv) realigning indels and recalibrating Base quality; (v) calling variant with <sc>HaplotypeCaller</sc>, and finally filterimg the variants with <sc>VariantFiltration</sc>.</p></sec><sec id="SEC2-6-4"><title>Calling SNPs from reads mapped to a reference transcriptome <sc>MpileUp-transcriptome</sc></title><p>The reference transcriptome was assembled using T<sc>rinity</sc> (as described previously) and reads were mapped to this reference using <sc>Bowtie2</sc> (<xref rid="B29" ref-type="bibr">29</xref>). We then used <sc>MpileUp</sc> and <sc>Bcftools</sc> (<xref rid="B30" ref-type="bibr">30</xref>) to call SNPs from the mapped reads. T<sc>rinity</sc>, <sc>Bowtie2</sc> and <sc>MpileUp</sc> were used with default parameters. <sc>Bcftools</sc> was used with the options &#x02013;multiallelic-caller and &#x02013;variants-only.</p><p>As outlined in the Results section, this pipeline performs poorly in the context of alternative splicing, as it misses most of the SNPs located in exons shared by several transcripts.</p><p>A way to deal with this issue is to filter the redundancy caused by alternative splicing. The first approach we considered was described in Pante <italic>et&#x000a0;al</italic>. (<xref rid="B31" ref-type="bibr">31</xref>) and consists in applying CD-HIT (<xref rid="B7" ref-type="bibr">7</xref>), a widely used greedy clustering method, to the transcriptome assembled by T<sc>rinity</sc>. The second approach we considered was described in Van Belleghem <italic>et&#x000a0;al</italic>., 2012 (<xref rid="B6" ref-type="bibr">6</xref>) and consists in keeping only the longest isoform for each gene assembled by T<sc>rinity</sc>.</p><p>In both cases, we obtained a filtered transcriptome, with reduced redundancy, and we then used <sc>Bowtie2</sc>, <sc>MpileU<sc>p</sc></sc> and <sc>Bcftools</sc> to call SNPs.</p></sec><sec id="SEC2-6-5"><title>Comparison of genome-based and transcriptome-based approaches</title><p>In order to compare the SNPs predicted by K<sc>is</sc>S<sc>plice</sc> with our set of true SNPs, we needed to obtain a genomic position for each of our predictions. To this purpose, we aligned each variant of each bubble to the reference genome using <sc>Star</sc> (v2.3.0). In the case where a variant mapped to several locations, we used the default behaviour of <sc>Star</sc>, which is to assign the variant to the location with the fewer number of mismatches. In case of ties, we kept all equally good locations, and if at least one of the possible locations corresponded to an annotated SNP, we considered that the prediction of K<sc>is</sc>S<sc>plice</sc> was correct.</p><p>For <sc>MpileUP</sc>, we aligned the transcripts assembled by T<sc>rinity</sc> on the reference genome with <sc>Blat</sc>.</p></sec><sec id="SEC2-6-6"><title><italic>Asobara tabida</italic> lines, RNA sequencing and SNP verification</title><p><italic>Asobara tabida</italic> (Hymenoptera: Braconidae) is a parasitoid species which develops on <italic>Drosophila</italic> hosts. <italic>A. tabida</italic> is naturally infected by three strains of <italic>Wolbachia</italic>, among which one (<inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$w$\end{document}</tex-math></inline-formula>Atab3) is necessary for oogenesis completion (<xref rid="B32" ref-type="bibr">32</xref>,<xref rid="B33" ref-type="bibr">33</xref>). However, when <italic>Wolbachia</italic> are removed by antibiotic treatment, the degree of oogenetic defect exhibits genetic variation within populations (<xref rid="B34" ref-type="bibr">34</xref>). We thus founded two lineages of <italic>A. tabida</italic> from a natural population (Sainte Foy-les-Lyon, France) based on their extreme phenotype after elimination of <italic>Wolbachia</italic>: the SFR2 lineage whose females do not produce any eggs and the SFR3 lineage whose females produce half the normal content of eggs. In both cases, dependence is complete as the eggs produced are sterile. These two lineages were founded by three females and were kept for 15 generations (three founders at each generation) before RNA extraction.</p><p>The experimental design for RNA-seq sequencing aimed at describing the transcriptomic changes associated with the presence / absence of <italic>Wolbachia</italic>, and the variations observed in the two <italic>A. tabida</italic> lineages exhibiting an extreme phenotype. To this purpose, cDNA libraries were constructed from infected and non-infected ovaries in these two lineages. Because these RNA-seq data were issued from two distinct lineages from a non-model species, we exploited this dataset to validate the method developed here and to discover biologically relevant SNPs, using libraries obtained from infected ovaries. The samples used for RNA extraction were young female (0&#x02013;1 day old) ovaries dissected in a drop of A-buffer (two replicates of 30 ovaries per lineage). RNA was extracted as described in Kremer <italic>et&#x000a0;al</italic>. (<xref rid="B35" ref-type="bibr">35</xref>). These RNA extracts were used to generate corresponding cDNA libraries, following the recommendations given by the manufacturer of the SMARTer PCR cDNA synthesis and BD Advantage two PCR kits (Clontech). These cDNA libraries were then purified with the Qiaquick kit (Qiagen) and their quality checked. Sequencing of cDNA was performed by the Genoscope (Evry), on an Illumina GA-IIx instrument, to obtain 1x75bp reads. These data were trimmed using the ShortRead package with default parameters and then used as input of the pipeline defined in Figure <xref ref-type="fig" rid="F1">1</xref>.</p><p>Based on these results, 34 SNPS were chosen for verification. For each SNP, primers were designed on the corresponding transcript to amplify the surrounding genomic region. PCRs were performed from an aliquot of the purified cDNA libraries. The reaction was performed in a total volume of 25 &#x003bc;l, and the mixture consisted in 2.5 &#x003bc;l of 5&#x000d7; green DreamTaq mastermix, 200 nM of dNTP, forward and reverse primers (see Supplementary Table S1 for primer sequences), and 5U of DreamTaq DNA polymerase (ThermoFisher). PCR amplification was performed on a Tetrad thermocycler (Biorad) as follows: 2 min at 94&#x000b0;C, 35 times (30 s at 94&#x000b0;C, 30 s at 58&#x000b0;C, 30s at 72&#x000b0;C), and 10 min at 72&#x000b0;C. The PCR products were sequenced using the Sanger method from forward and reverse primers by the Biofidal company. The sequences were aligned and their respective chromatograms analysed by the CLC Main workbench.</p></sec><sec id="SEC2-6-7"><title><italic>Drosophila</italic> strains, RNA sequencing and SNP verification</title><p><italic>D. mojavensis</italic> and <italic>D. arizonae</italic> are two Drosophila species that are endemic of the arid southwestern United States and Mexico. These species diverged recently (less than 1 MYA) (<xref rid="B36" ref-type="bibr">36</xref>,<xref rid="B37" ref-type="bibr">37</xref>). In the laboratory, hybridisation of these two species is possible while in nature it does not occur (or is very rare). The ovarian transcriptome of these two species (and their reciprocal crosses) was sequenced to investigate the first step of hybrid incompatibility and look for deregulated genes in hybrids. In this paper, we did not study the transcriptomes of the hybrids, we only used the transcriptomes of the parents to test for the validity of our pipeline at a different evolutionary scale. The sequenced strains were <italic>Drosophila mojavensis</italic> from the Anza Borrego Desert, CA (stock number: 15081&#x02013;1352.01) and <italic>Drosophila arizonae</italic>, from Metztitlan &#x02013; Hidalgo, Mexico (stock number: 15081&#x02013;1271.17), both obtained in the US San Diego Drosophila Stock Center. Virgin female flies were collected after hatching and isolated until they reached ten days. The RNA was extracted from a pool of 30 ovaries of 10-days-old flies for each line. The extractions were performed using the RNeasy kit (Qiagen) and samples were then treated with DNase (DNA-free Kit, Ambion) and stored at &#x02212;80&#x000b0;C. The samples were quantified by fluorescence in the Bioanalyser 2100 (Agilent), according to pre-established criteria by the sequencing platform. For each line, the extracted RNA was divided into two parts in order to generate two cDNA libraries (two replicates per condition). RNA was sequenced by Illumina Technology, in the IlluminaHiseq 2000. We sequenced 2 &#x000d7; 51 bp paired-end reads and the medium size of the inserts was 300 bp. We used <sc>UrQt</sc> (<xref rid="B38" ref-type="bibr">38</xref>) with the default parameters to remove the low quality bases and the polyA tail from the dataset before running the pipeline described in Figure <xref ref-type="fig" rid="F1">1</xref>. The protocol for SNP verification is identical to the one used for <italic>Asobara tabida</italic> (see Supplementary Table S2 for primer sequences).</p></sec></sec><sec id="SEC2-7"><title>Data access</title><p>The human data used in this study can be found through the ArrayExpress database (<ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/arrayexpress/">http://www.ebi.ac.uk/arrayexpress/</ext-link>) under the accession number E-GEOD-29342 and we used the individuals named NA20808, NA20809, NA20810, NA20811, NA20812, NA20813, NA20814, NA20815, NA20819, NA20826, NA06984, NA11840, NA06986, NA06989, NA06994, NA07346, NA07357, NA10851, NA11829 and NA11832.</p><p>The RNAseq libraries from <italic>D. mojavensis</italic> and <italic>D. arizonae</italic> are available through the NCBI Sequence Read Archive (SRA : <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/sra">http://www.ncbi.nlm.nih.gov/sra</ext-link>) under the accession no. SRX1272419 and SRX1277353.</p><p>The <italic>A. tabida</italic> dataset is available through the NCBI Sequence Read Archive (SRA : <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/sra">http://www.ncbi.nlm.nih.gov/sra</ext-link>) under the accession no. SRX1701817, SRX1701824, SRX1701826 and SRX1701855.</p></sec></sec><sec sec-type="results" id="SEC3"><title>RESULTS</title><sec id="SEC3-1"><title>Validation of the SNP calling method using available data from a model species</title><sec id="SEC3-1-1"><title>Identification of variants</title><p>In order to evaluate the performance of our method, we needed to test it in the case where we knew which SNPs should be found. We thus focused on a dataset from human in which SNPs were already annotated. We selected two populations (Toscans and Central Europeans) from the Geuvadis project (<xref rid="B39" ref-type="bibr">39</xref>), and downloaded the RNA-seq data of 10 individuals in each population. We sampled 10M reads from each individual and pooled individuals 5 &#x000d7; 5, to obtain two replicates of five pooled individuals per population. We ran K<sc>is</sc>S<sc>plice</sc> and T<sc>rinity</sc> on these four read sets and we aligned the variants of K<sc>is</sc>S<sc>plice</sc> to the T<sc>rinity</sc> transcripts using <sc>Blat</sc> (with at least 90% query coverage and 90% identity). Out of the 64824 bubbles initially found by K<sc>is</sc>S<sc>plice</sc>, 53494 (82%) mapped to T<sc>rinity</sc>-assembled transcripts, 8024 partially aligned, and 3306 did not align. As explained in the Methods Section, SNPs located near other SNPs may be enumerated more than once, but with different contexts (see Supplementary Figure S2). After removing this redundancy, we ended up with 51,235 bubbles.</p><p>To assess whether these bubbles were true SNPs, we first aligned the sequences of the variants (i.e. each path of the bubble) to the human reference genome and compared their genomic positions to a set of SNPs downloaded from the 1000 genome project webpage. We also benchmarked our method against two software: <sc>Gatk</sc>, a widely used method to call SNPs in the presence of a reference genome and <sc>MpileU<sc>p</sc></sc>, part of the SAM<sc>tools</sc>/B<sc>cftools</sc>, used here to call SNPs on the transcriptome assembled by T<sc>rinity</sc> using the same RNAseq data.</p><p><sc>Gatk</sc> was run with parameters recommended from the <sc>Gatk</sc> web page for RNA-seq data. <sc>MpileU<sc>p</sc></sc> was run on top of <sc>Bowtie2</sc>, both on the transcriptome assembled by T<sc>rinity</sc> (<sc>MP-transcriptome</sc>), and on the reduced transcriptome. In the latter case, we either kept the longest isoform for each gene (<sc>MP-<sc>l</sc>ong-trans</sc>) as described in Van Belleghem <italic>et&#x000a0;al</italic>. (<xref rid="B6" ref-type="bibr">6</xref>), or we applied <sc>CD-HIT</sc> to cluster similar isoforms (<sc>MP<sc>-cd-hit</sc></sc>) as described in Pante <italic>et&#x000a0;al</italic>. (<xref rid="B31" ref-type="bibr">31</xref>).</p><p>For each method, we calculated the Precision, i.e. the number of true SNPs out of the total number of predicted SNPs, and the Recall, i.e. the number of predicted SNPs out of the total number of true SNPs.</p><p>As outlined in Figure <xref ref-type="fig" rid="F5">5</xref>, the recall of all methods is extremely low if no filter is applied to the set of true SNPs (True SNPs minimum coverage set to 0). This is an expected result, because true SNPs were identified using DNA-seq data and recovering them using RNA-seq data requires that they are located in sufficiently expressed regions. The higher the expression, the higher the recall of all methods. For SNPs located in regions covered by at least 100 reads, the best recall is reached for <sc>Gatk-genome</sc> (42%), which is better than K<sc>is</sc>S<sc>plice</sc> (35%) and <sc>MP-transcriptome</sc> (28%). The low recall of <sc>MP</sc><sc>-transcriptome</sc> is essentially due to its poor ability to find SNPs in constitutive exons, a limitation which can be adressed using <sc>MP-long-trans</sc> (but not <sc>MP-</sc><sc>cd-hit</sc>). The recall of K<sc>is</sc>S<sc>plice</sc> can also be improved by modifying its relative threshold parameter from 5% to 2%. Interestingly, it even slightly outperforms <sc>Gatk-genome</sc>. The reason is that K<sc>is</sc>S<sc>plice</sc> finds more SNPs located in repeated regions of the genome, while <sc>Gatk</sc> filters them out based on their low mapping quality. Finally, we show that a large number of SNPs are still not found by any method. The majority of those are rare alleles (Supplementary Figure S4) and the remaining are SNPs located in repeated regions or very polymorphic genes, like immune genes.</p><fig id="F5" orientation="portrait" position="float"><label>Figure 5.</label><caption><p>Precision and recall of K<sc>is</sc>S<sc>plice</sc>, <sc>Gatk-genome</sc>, MP-transcriptome and <sc>MP-long</sc><sc>-trans</sc> as a function of the expression level of the locus. For the recall, all predictions are taken into account, but the set of true SNPs is restricted to those covered by at least a given number of reads. For the precision, only SNPs supported by at least a given number of reads are taken into account.</p></caption><graphic xlink:href="gkw655fig5"/></fig><p>As outlined in Figure <xref ref-type="fig" rid="F5">5</xref>, with the exception of K<sc>is</sc>S<sc>plice</sc>, the precision of all methods was very poor if no filter was applied on the number of reads supporting each prediction. This is an interesting advantage of K<sc>is</sc>S<sc>plice</sc>. Its predictions can be taken as is, and the precision will already be 80%. If we now focus on predicted SNPs supported by at least 100 reads, then <sc>Gatk-genome</sc> was the best and reaches a precision of almost 90%, while <sc>MP-transcriptome</sc> was the worst with a precision of 70%.</p><p>The false positives of all methods can essentially be divided into two categories: sequencing errors, and inexact repeats. The impact of RNA editing was minor (less than 5% of cases were annotated in <sc>Radar</sc> v2 (<xref rid="B40" ref-type="bibr">40</xref>)).</p><p>Filtering out SNPs supported by few reads effectively deals with the issue of sequencing errors, but this consequently affects the ability to find true SNPs in poorly expressed regions.</p><p>The issue of inexact repeats affects mostly transcriptome-based methods, not genome-based methods. While K<sc>is</sc>S<sc>plice</sc> partially deals with this issue with the branching parameter and the filtering of long bubbles, <sc>MP-transcriptome</sc> does not address this problem.</p><p>Overall, we conclude that, although we do not use a reference genome, the recall and precision of our method are comparable to those which use one, such as <sc>Gatk</sc>. Furthermore, we show that our method has a better ability to call SNPs in the context of alternative splicing and a more efficient way to filter out inexact repeats than methods which call SNPs after mapping reads to an assembled transcriptome.</p></sec><sec id="SEC3-1-2"><title>Quantification of variants and statistical differential analysis</title><p>The quantification we obtain for variants called from pooled RNA-seq data reflects both the allele frequency of the variant in the pool and the expression level of the gene. An &#x02018;expressed&#x02019; allele frequency can be derived from these counts, by simply taking the ratio, but the obtained frequency is expected to be distorted compared to the allele frequency estimated from DNA-seq data. Several causes may be listed. First, within a heterozygous individual, one allele may be more expressed than the other, a process known as Allele Specific Expression (ASE). Second, RNA expression from different individuals (hence possibly different genotypes) can be variable within a pool, thus distorting the allelotype. In order to evaluate the magnitude of this distortion, we computed within each pool the correlations between the true allelic frequencies, and the estimated allele frequencies. To obtain the true allelic frequency within a pool, we took advantage of the availability of the genotypes of each individual from the Geuvadis dataset, and we simply summed up the number of alternative alleles over the total number of alleles within the pool. The expressed allele frequencies were obtained from K<sc>is</sc>S<sc>plice</sc> calls, summing the alternative allele counts of each individual over all allele counts of the pool.</p><p>We found that the distortion highly depends on the expression levels (Supplementary Figure S5). While the correlation was weak (0.65) for poorly expressed loci (less than 3 reads), it increased steadily with the expression level up to a plateau of 0.98. When we restricted to loci with at least 10 reads, the correlation reached 0.95.</p><p>We therefore conclude that, whenever a locus was sufficiently expressed (at least 10 reads), the expressed allele frequency was a good predictor of the true allele frequency.</p><p>If we now compute the difference of allele frequencies across conditions (denoted by <italic>df</italic>), and compare it to the difference of expressed allele frequencies across conditions (denoted by <italic>dfe</italic>), the correlations remain high, but are weaker, reaching a plateau of 80% for highly expressed loci. The reason is that most SNPs do not have a significant difference of allele frequencies across our two populations, hence these correlations are contaminated by SNPs with (almost) equal allele frequencies. In this case, the difference of allele frequencies is just a random fluctuation. When considering all SNPs, the correlation between <italic>df</italic> and <italic>dfe</italic> is significant but weak (Figure <xref ref-type="fig" rid="F6">6-A</xref>)</p><fig id="F6" orientation="portrait" position="float"><label>Figure 6.</label><caption><p>Difference of allele frequencies (df) Vs Difference of expressed allele frequencies (dfe). (<bold>A</bold>) All SNPs. (<bold>B</bold>) Condition-specific SNPs. (<bold>C</bold>) Conditions-specific SNPs covered by at least 100 reads.</p></caption><graphic xlink:href="gkw655fig6"/></fig><p>If we restrict to SNPs that are found as condition specific by <sc>kiss</sc>DE, then the correlation is much stronger (Figure <xref ref-type="fig" rid="F6">6B</xref>). Finally, if we restrict to SNPs covered by a total of at least 100 reads (an average of 25 reads per sample), then the correlation is again higher (Figure <xref ref-type="fig" rid="F6">6C</xref>). The more a gene is expressed, the higher the fit between <italic>df</italic> and <italic>dfe</italic>. A few SNPs (<italic>n</italic> = 22), however, exhibited a large difference between <italic>df</italic> and <italic>dfe</italic> (&#x0003e;0.3). A detailed analysis of these cases reveals that they are located in immune genes (<italic>n</italic> = 5), in genes showing a very variable expression across individuals (<italic>n</italic> = 9), or in genes exhibiting an allele specific expression (<italic>n</italic> = 8).</p><p>Overall, we conclude that, provided we restrict to condition specific SNPs, the metric we output with <sc>kiss</sc>DE for the difference of expressed allele frequencies, that is <italic>dfe</italic>, can largely be interpreted as a measure of the true difference of allele frequencies.</p></sec><sec id="SEC3-1-3"><title>Prediction of the amino acid change</title><p>When no reference genome is available, it is not possible to obtain a genomic location for each SNP and therefore to apply <sc>SNPeff</sc> (<xref rid="B41" ref-type="bibr">41</xref>), or <sc>PolyPhen</sc> (<xref rid="B42" ref-type="bibr">42</xref>), which are widely used software for assessing the impact of a SNP on the protein sequence. In the absence of any reference genome, a reference transcriptome can nevertheless be obtained, using a full-length transcriptome assembler like T<sc>rinity</sc> (<xref rid="B15" ref-type="bibr">15</xref>). Based on this transcriptome, it is possible to assess the coding potential of each transcript using <sc>TransDecoder</sc>, to position the predicted SNPs onto the assembled transcripts using <sc>Blat</sc> (<xref rid="B20" ref-type="bibr">20</xref>), and finally to assess the impact of each SNP on its transcript(s). In the end, each positioned SNP is classified as coding or non coding. In the case where the SNP is located in the coding region, it is then classified as synonymous or non-synonymous (See Methods).</p><p>Out of 47,243 positioned SNPs (those which aligned to T<sc>rinity</sc> transcripts), 14,804 cases (31%) fell in CDSs and the other 32,439% fell in non-coding regions (including UTRs). Among the ones falling in CDSs, we found that 53% (7788) were synonymous, while the other half (7016) were non synonymous.</p><p>To validate our predictions, we then intersected the genomic positions of our predicted SNPs with the genomic positions of SNPs in dbSNP, for which the impact on the protein sequence is known. Out of the 47,243 SNPs we predict, 39313 could be assigned a genomic position which matched a SNP annotated in dbSNP. Out of those 39313 cases, 2725 have no functional annotation in dbSNP, 35,141 had a correct prediction and 1447 cases wrongly predicted. A thorough examination of the 1447 cases wrongly predicted reveals that in most cases, the transcript predicted by T<sc>rinity</sc> was very partial and was overlapping an intron (this happens when pre-mRNA is sampled together with mRNA at the RNA extraction step, despite selection of polyA+RNAs). In this case, the ORF predictor can over-predict coding regions, and our pipeline therefore tends to over-predict non synonymous cases. Figure <xref ref-type="fig" rid="F7">7</xref> summarises our results for the prediction of the impact on the protein sequence. Overall, when SNPs can be evaluated, the precision of <sc>K2rt</sc> is 96% (35,141 out of 36,588).</p><fig id="F7" orientation="portrait" position="float"><label>Figure 7.</label><caption><p>Results of K<sc>is</sc>S<sc>plice2</sc>R<sc>ef</sc>T<sc>ranscriptome</sc> The green, red and blue areas correspond respectively to non-coding, synonymous and non-synonymous SNPs. The dashed area corresponds to errors of our predictions of the impact on the protein sequence. The outer area corresponds to SNPs that are not in dbSNP or for which the prediction cannot be evaluated due to a lack of annotation in dbSNP.</p></caption><graphic xlink:href="gkw655fig7"/></fig></sec><sec id="SEC3-1-4"><title>Performance of the full pipeline</title><p>In the previous section, we evaluated our capacity to predict the impact on the protein independently of the remaining of our pipeline. We now turn to its evaluation within the full pipeline. Two situations can be discussed here. First, if only one experimental condition is considered, then no differential analysis is carried out. SNPs are identified and their impact on the protein is predicted. In this case, the prediction inherits from the errors made at the identification step. Out of 47,243 predicted SNPs, 39313 were in dbSNP and 35,141 had a correctly predicted impact. In the worst-case scenario, if we consider that the 7930 SNPs for which there was no dbSNP entry and the 2715 SNPs for which the dbSNP entry is incomplete were false positives, the precision of the pipeline was 74%. In practice, dbSNP is not exhaustive, and the true precision is between 74% and 96%. Second, if two conditions were considered (which is the original purpose of this study), then many of the false positives of the identification step were filtered out. Out of the 47,243 predicted SNPs, 5518 were condition-specific, and 5309 had a correct prediction of the impact on the protein sequence. Hence the precision, in the worst-case scenario, for condition-specific SNPs was 96% (5309 out of 5518).</p></sec></sec><sec id="SEC3-2"><title>Application of the method using biological data from species without any reference genome</title><p>From our study on the human dataset, we conclude that our method has a precision and recall similar to methods which require a reference genome. We now turn to the application of our method to non-model species.</p><sec id="SEC3-2-1"><title>Application to intraspecific polymorphism: the case of <italic>Asobara tabida</italic></title><p>We first applied our method to <italic>Asobara tabida</italic>, for which RNA-seq data from two lineages (SFR2 and SFR3) were available. These lineages come from the same population, but they differ by their phenotype of dependence to their symbiont <italic>Wolbachia</italic>. In the absence of <italic>Wolbachia</italic>, SFR2 individuals produce no eggs, while SFR3 produce some. Consequently, we suspect a low but significant genetic differentiation between lineages that could be associated with the phenotypes, or to genetic drift associated with maintenance in the laboratory. While the experimental design, with a single lineage for each phenotype, does not enable us to separate between these two effects, we think that this dataset is still well tailored for a validation of our method because: (a) no reference genome is available for this species; (b) individuals were pooled for RNA extraction and (c) replicates are available for each lineage.</p><p>The transcriptomes of two replicates of pools of 30 individuals were sequenced through RNA-seq for each lineage, leading to 15M reads for each replicate. We ran our pipeline and found a total of 18609 positioned SNPs out of which 17,031 are condition-specific. The large proportion of condition-specific SNPs is largely due to the fact that most of them are fixed in at least one lineage. Indeed, 21% of them are fixed in both lineages, 63% are fixed in one lineage and polymorphic in the other, and 7% are polymorphic in both lineages (Supplementary Figure S6B).</p><p>Out of the 17,031 condition-specific variants, we found that 5608 (32%) were non coding, 6137 (36%) were synonymous and 3876 (22%) were non-synonymous.</p><p>Based on these results, we selected 27 cases for experimental validation: 10 were cases where the two lineages were fixed for a different nucleotide, 15 were cases where one lineage was fixed and the other polymorphic, 2 were cases where the two lineages were polymorphic. For all the 10 first cases, we were able to validate that the SNP was real and that the two lineages were indeed fixed for a different nucleotide (Supplementary Table S1, Figure <xref ref-type="fig" rid="F8">8</xref>). Out of the 17 remaining cases, we were able to validate that the SNP was real in all cases, but only in 9 cases were we able to validate that the site was polymorphic in one lineage (Supplementary Table S1, Figure <xref ref-type="fig" rid="F8">8</xref>). The rate of validation of the polymorphic status of the site within a lineage largely depended on the frequency of the minor allele (Supplementary Figure S5). Rare variants were harder to validate in terms of polymorphism detection. These rare variants could be false positives of our method, but they may also very well be true variants, not detectable experimentally using a direct sequencing technique without cloning. Importantly, although we could not always validate the fact that one site is polymorphic within a lineage, we systematically confirmed that the SNP was real, and that each lineage had a specific major allele. Therefore, we validated the condition-specificity of all SNPs.</p><fig id="F8" orientation="portrait" position="float"><label>Figure 8.</label><caption><p>Three examples of SNPs validated by Sanger sequencing. The first is fixed in both the SFR2 and SFR3 lineages. The second and third are polymorphic in SFR3 but fixed in SFR2. In the third case, the base caller does not reflect the polymorphism but it can be seen from the chromatogram.</p></caption><graphic xlink:href="gkw655fig8"/></fig><p>As discussed earlier, our method outputs SNPs that are found by no other method. In order to test if these SNPs were true, we further tested specifically 7 such cases, and were able to validate all seven SNPs (Supplementary Table S1).</p><p>Because our RNA-seq data were initially obtained to compare the transcriptome of these two lineages, the design was not optimized for QTL analysis. In particular, each phenotype is represented by a single inbred genotype, making it difficult to separate the SNPs linked to the phenotype from those linked to drift. Despite this issue, we further characterised the impact on the protein sequence of the condition-specific SNPs. Among all these genes, some called our attention regarding their possible implication in the dependence phenotype. For instance, some genes, such as <italic>Dorsal</italic> and <italic>Hypoxia up-regulated protein 1</italic>, presented SNPs in their UTRs and were differentially expressed between lineages. These genes are involved in immunity and oxidative stress homeostasis, two functions that have been shown as particularly important in this biological system. Another example concerns genes involved in oogenesis, like <italic>OTU-domain containing protein</italic> or <italic>Female sterile</italic>, that exhibit non-synonymous SNPs in their CDS regions. These few examples show how the suite we propose in this paper rapidly allows to link the SNPs detected to their impact on the protein sequence, thus permitting to pinpoint candidate genes involved in phenotypic variation. Validation of these genes could involve either genetic studies (<italic>e.g</italic>., knock-down experiments) and/or other linkage analyses targeted to these candidates.</p></sec><sec id="SEC3-2-2"><title>Application to Interspecific Divergence: the case of <italic>Drosophila mojavensis</italic> and <italic>Drosophila arizonae</italic></title><p>Similarly to the <italic>Asobara</italic> dataset, the drosophila dataset corresponds to non-model species, where individuals had to be pooled prior to RNA sequencing. In this case however, the two modalities of the phenotypes are not two populations of the same species, but two recently diverged species. This therefore enabled us to assess if our method also applies to a very different evolutionary scale, where differences of one nucleotide are no longer SNPs, but divergences. Additionally, the availability of the reference genome for <italic>D. mojavensis</italic> (and not <italic>D. arizonae</italic>) enabled us to study in depth the case of condition-specific inexact repeats.</p><p><italic>D. mojavensis</italic> and <italic>D. arizonae</italic> are two closely related species that diverged 1MYA. We sequenced through RNA-seq the ovarian transcriptomes of two replicates of pools of 30 individuals for each species. We obtained 55M paired-end reads per replicate. We ran our pipeline on the data and obtained 51,730 positioned SNPs, and most of them (51,135) were condition-specific.</p><p>The condition-specific SNPs were mostly in coding regions (60%, i.e. 40,674 SNPs). We could classify 34,382 of them as synonymous, and the other 6292 SNPs as non-synonymous.</p><p>We selected 11 cases for experimental validation, six of which were divergent sites, and five were cases where the site was polymorphic in one species and fixed in the other. We were able to validate that the variation was condition-specific for all the divergent sites, and for four cases out of five for the polymorphic cases. Additionally, for two cases out of these four, we were able to amplify the two alleles in the species where the site was predicted to be polymorphic (Supplementary Table S2).</p><p>In most cases, an observed variation in the transcriptome is caused by the presence of two alleles at one locus. However, it is also possible that two mono-allelic loci, if they exhibit the same sequence except for one nt, generate a variation that resembles a SNP. In order to quantify this phenomenon, we explicitely selected in the results of K<sc>is</sc>S<sc>plice</sc>, the variations for which one path was mapping to one locus and the other path was mapping to another locus. This was only possible because we had at our disposal a draft genome of <italic>D. mojavensis</italic>. We selected explicitely cases where we knew that the variation we detected was potentially caused by two loci. There were only 224 cases like this, which is very few compared to the total number of variations detected. We however tested three of them experimentally, and we were able to validate all of them. These cases are not true SNPs, but they correspond to recent paralog genes where one copy is more expressed in <italic>D. arizonae</italic>, and the other copy is more expressed in <italic>D. mojavensis</italic>.</p></sec></sec></sec><sec id="SEC4"><title>CONCLUSION AND PERSPECTIVES</title><p>We present a method that can discover condition-specific SNPs from raw RNA-seq data. The individuals may be pooled, which decreases the costs of library preparation, while still enabling to allelotype and to find variants specific to one condition. As no reference genome is required, the range of applications of the method is very large. We first evaluated our method in human, where a reference genome is available and SNPs are extensively annotated. We show that our method has similar performances in terms of precision and recall, compared to <sc>Gatk</sc>, a widely used mapping-based approach. We then evaluated our method on two non-model species.</p><p>In both cases, we were able to call variants, to classify them, and to discuss their impact. We selected a fraction of them for experimental validation through RT-PCR + Sanger sequencing. In all cases, we were able to validate that the variant was condition-specific. However, when the locus was predicted to be polymorphic in one condition, we were able to validate the presence of the two alleles only in cases where the minor allele frequency was at least 15%.</p><p>This work is a first approach toward transcriptome-wide association studies in non-model species. The method can readily be applied to RNA-seq data from any species, whenever two phenotypes are clearly identified and the goal is to find candidates for their genetic bases. In the case of continuous phenotypes, like height, the statistical framework can be generalised to quantitative trait loci (QTL).</p><p>This work focuses on SNP identification and analysis and does not address the question of the experimental design of a transcriptome-wide association study. A systematic evaluation of the optimal design is beyond the scope of this paper, but we would like to provide here briefly some basic advice.</p><p>First, in all the case studies presented here, we considered only two replicates, which is the minimum required by our method. We clearly advise that for a pre-determined cost, it is wiser to have a low coverage for each replicate, but to increase the number of replicates. Second, the type of replicates to choose is probably a more central issue. In the case of <italic>Asobara</italic>, we sequenced two biological replicates, but both replicates were derived from the same lineage. Having replicates when extracting RNA is useful, but not as useful as replicates at the line-establishment step. Only this type of replicate can allow to discriminate between SNPs in the original population and genetic drift in the lab. Finally, if pooling is envisioned, the number of individuals per pool should be as large as possible, especially for very polymorphic species. The larger the pool, the more representative of the population it is.</p><p>From the point of view of our method itself, there is of course also room for improvement. In particular, we found that, while easy SNPs are identified by all methods, a large amount of difficult SNPs are currently being overseen. This is the case of SNPs located in repeated regions of the genome, and that are notoriously difficult to annotate. SNPs located very close to each other are also challenging to annotate. Without a reference genome, we found that they are particularly difficult to tell apart from inexact repeats. Finally, SNPs located within very polymorphic regions of the genome, like immune genes, are also very challenging, even for mapping-based approaches. The use of a single reference genome is clearly limiting. De novo assembly methods are a promising direction for these, but still need to be optimised.</p><p>For future work, we see two lines of research, which could ultimately be combined. First, we could take advantage of the availability of long reads coming from third generation sequencing platforms (Pacbio, Minion). In principle, long reads have the potential to solve most of the issues we mentioned, but currently, the error rates are too high (10&#x02013;15%) and the sequencing depth is not sufficient to apply to RNA-seq. In the meantime, it seems still relevant to keep on working in the context of short reads, but we think that the best resolution we can achieve for the prediction of difficult SNPs is not well captured by sequences. Graphs could instead well represent close SNPs and a partial quantification of their phasing.</p></sec>
<sec sec-type="supplementary-material">
<title>Supplementary Material</title>
<supplementary-material id="PMC_1" content-type="local-data">
<caption>
<title>SUPPLEMENTARY DATA</title>
</caption>
<media mimetype="text" mime-subtype="html" xlink:href="supp_44_19_e148__index.html"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_gkw655_nar-03714-met-k-2015-File015.pdf"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel"
xlink:href="supp_gkw655_nar-03714-met-k-2015-File016.xls"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel"
xlink:href="supp_gkw655_nar-03714-met-k-2015-File017.xls"/>
</supplementary-material>
</sec>
</body><back><ack><p>This work was performed using the computing facilities of the CC LBBE/PRABI.</p><p>The authors would like to thank Marie-Christine Carpentier and Delphine Charif for help on the analysis of the <italic>Asobara</italic> dataset; Gustavo Sacomoto for help on the analysis of the Geuvadis dataset; Sebastien Deraison for help on experimental validation of the candidates for the Drosophila dataset, and Vincent Miele and Alice Julien-Laferri&#x000e8;re for help on developing K<sc>is</sc>S<sc>plice</sc> and <sc>kiss</sc>DE.</p></ack><sec id="SEC5"><title>SUPPLEMENTARY DATA</title><p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/lookup/suppl/doi:10.1093/nar/gkw655/-/DC1">Supplementary Data</ext-link> are available at NAR Online.</p></sec><sec id="SEC6"><title>FUNDING</title><p>Agence Nationale de la Recherche [ANR-12-BS02-0008, ANR-11-BINF-0001-06, ANR-2010-BLAN-170101]; S&#x000e3;o Paulo Research Foundation &#x02013; FAPESP/Brazil [2010/10731-4 to C.M.C.]; European Research Council under the European Community's Seventh Framework Programme [FP7 /2007&#x02013;2013)/ERC Grant Agreement No. [247073]10]. Funding for open access charge: INRIA.</p><p><italic>Conflict of interest statement</italic>. None declared.</p></sec><ref-list><title>REFERENCES</title><ref id="B1"><label>1.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Iqbal</surname><given-names>Z.</given-names></name><name><surname>Caccamo</surname><given-names>M.</given-names></name><name><surname>Turner</surname><given-names>I.</given-names></name><name><surname>Flicek</surname><given-names>P.</given-names></name><name><surname>McVean</surname><given-names>G.</given-names></name></person-group>
<article-title>De novo assembly and genotyping of variants using colored de Bruijn graphs</article-title>
<source>Nat. Genet.</source>
<year>2012</year>
<volume>44</volume>
<fpage>226</fpage><lpage>232</lpage><pub-id pub-id-type="pmid">22231483</pub-id></element-citation></ref><ref id="B2"><label>2.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Uricaru</surname><given-names>R.</given-names></name><name><surname>Rizk</surname><given-names>G.</given-names></name><name><surname>Lacroix</surname><given-names>V.</given-names></name><name><surname>Quillery</surname><given-names>E.</given-names></name><name><surname>Plantard</surname><given-names>O.</given-names></name><name><surname>Chikhi</surname><given-names>R.</given-names></name><name><surname>Lemaitre</surname><given-names>C.</given-names></name><name><surname>Peterlongo</surname><given-names>P.</given-names></name></person-group>
<article-title>Reference-free detection of isolated SNPs</article-title>
<source>Nucleic Acids Res.</source>
<year>2015</year>
<volume>43</volume>
<fpage>e11</fpage><pub-id pub-id-type="pmid">25404127</pub-id></element-citation></ref><ref id="B3"><label>3.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Leggett</surname><given-names>R.M.</given-names></name><name><surname>Ramirez-Gonzalez</surname><given-names>R.H.</given-names></name><name><surname>Verweij</surname><given-names>W.</given-names></name><name><surname>Kawashima</surname><given-names>C.G.</given-names></name><name><surname>Iqbal</surname><given-names>Z.</given-names></name><name><surname>Jones</surname><given-names>J.D.G.</given-names></name><name><surname>Caccamo</surname><given-names>M.</given-names></name><name><surname>Maclean</surname><given-names>D.</given-names></name></person-group>
<article-title>Identifying and classifying trait linked polymorphisms in non-reference species by walking coloured de bruijn graphs</article-title>
<source>PLoS One</source>
<year>2013</year>
<volume>8</volume>
<fpage>e60058</fpage><pub-id pub-id-type="pmid">23536903</pub-id></element-citation></ref><ref id="B4"><label>4.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Piskol</surname><given-names>R.</given-names></name><name><surname>Ramaswami</surname><given-names>G.</given-names></name><name><surname>Li</surname><given-names>J.B.</given-names></name></person-group>
<article-title>Reliable identification of genomic variants from RNA-seq data</article-title>
<source>Am. J. Hum. Genet.</source>
<year>2013</year>
<volume>93</volume>
<fpage>641</fpage><lpage>651</lpage><pub-id pub-id-type="pmid">24075185</pub-id></element-citation></ref><ref id="B5"><label>5.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Romiguier</surname><given-names>J.</given-names></name><name><surname>Gayral</surname><given-names>P.</given-names></name><name><surname>Ballenghien</surname><given-names>M.</given-names></name><name><surname>Bernard</surname><given-names>A.</given-names></name><name><surname>Cahais</surname><given-names>V.</given-names></name><name><surname>Chenuil</surname><given-names>A.</given-names></name><name><surname>Chiari</surname><given-names>Y.</given-names></name><name><surname>Dernat</surname><given-names>R.</given-names></name><name><surname>Duret</surname><given-names>L.</given-names></name><name><surname>Faivre</surname><given-names>N.</given-names></name><etal/></person-group>
<article-title>Comparative population genomics in animals uncovers the determinants of genetic diversity</article-title>
<source>Nature</source>
<year>2014</year>
<volume>515</volume>
<fpage>261</fpage><lpage>263</lpage><pub-id pub-id-type="pmid">25141177</pub-id></element-citation></ref><ref id="B6"><label>6.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Van&#x000a0;Belleghem</surname><given-names>S.M.</given-names></name><name><surname>Roelofs</surname><given-names>D.</given-names></name><name><surname>Van&#x000a0;Houdt</surname><given-names>J.</given-names></name><name><surname>Hendrickx</surname><given-names>F.</given-names></name></person-group>
<article-title>De novo transcriptome assembly and SNP discovery in the wing polymorphic salt marsh beetle Pogonus chalceus (Coleoptera, Carabidae)</article-title>
<source>PLoS One</source>
<year>2012</year>
<volume>7</volume>
<fpage>e42605</fpage><pub-id pub-id-type="pmid">22870338</pub-id></element-citation></ref><ref id="B7"><label>7.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Li</surname><given-names>W.</given-names></name><name><surname>Godzik</surname><given-names>A.</given-names></name></person-group>
<article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>
<source>Bioinformatics</source>
<year>2006</year>
<volume>22</volume>
<fpage>1658</fpage><lpage>1659</lpage><pub-id pub-id-type="pmid">16731699</pub-id></element-citation></ref><ref id="B8"><label>8.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Schl&#x000f6;tterer</surname><given-names>C.</given-names></name><name><surname>Tobler</surname><given-names>R.</given-names></name><name><surname>Kofler</surname><given-names>R.</given-names></name><name><surname>Nolte</surname><given-names>V.</given-names></name></person-group>
<article-title>Sequencing pools of individuals &#x02013; mining genome-wide polymorphism data without big funding</article-title>
<source>Nat. Rev. Genet.</source>
<year>2014</year>
<volume>15</volume>
<fpage>749</fpage><lpage>763</lpage><pub-id pub-id-type="pmid">25246196</pub-id></element-citation></ref><ref id="B9"><label>9.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Lappalainen</surname><given-names>T.</given-names></name><name><surname>Sammeth</surname><given-names>M.</given-names></name><name><surname>Friedl&#x000e4;nder</surname><given-names>M.R.</given-names></name><name><surname>&#x02019;t&#x000a0;Hoen</surname><given-names>P.A.C.</given-names></name><name><surname>Monlong</surname><given-names>J.</given-names></name><name><surname>Rivas</surname><given-names>M.A.</given-names></name><name><surname>Gonz&#x000e0;lez-Porta</surname><given-names>M.</given-names></name><name><surname>Kurbatova</surname><given-names>N.</given-names></name><name><surname>Griebel</surname><given-names>T.</given-names></name><name><surname>Ferreira</surname><given-names>P.G.</given-names></name><etal/></person-group>
<article-title>Transcriptome and genome sequencing uncovers functional variation in humans</article-title>
<source>Nature</source>
<year>2013</year>
<volume>501</volume>
<fpage>506</fpage><lpage>511</lpage><pub-id pub-id-type="pmid">24037378</pub-id></element-citation></ref><ref id="B10"><label>10.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Abecasis</surname><given-names>G.R.</given-names></name><name><surname>Auton</surname><given-names>A.</given-names></name><name><surname>Brooks</surname><given-names>L.D.</given-names></name><name><surname>DePristo</surname><given-names>M.A.</given-names></name><name><surname>Durbin</surname><given-names>R.M.</given-names></name><name><surname>Handsaker</surname><given-names>R.E.</given-names></name><name><surname>Kang</surname><given-names>H.M.</given-names></name><name><surname>Marth</surname><given-names>G.T.</given-names></name><name><surname>McVean</surname><given-names>G.A.</given-names></name></person-group>
<article-title>An integrated map of genetic variation from 1,092 human genomes</article-title>
<source>Nature</source>
<year>2012</year>
<volume>491</volume>
<fpage>56</fpage><lpage>65</lpage><pub-id pub-id-type="pmid">23128226</pub-id></element-citation></ref><ref id="B11"><label>11.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Sacomoto</surname><given-names>G.A.T.</given-names></name><name><surname>Kielbassa</surname><given-names>J.</given-names></name><name><surname>Chikhi</surname><given-names>R.</given-names></name><name><surname>Uricaru</surname><given-names>R.</given-names></name><name><surname>Antoniou</surname><given-names>P.</given-names></name><name><surname>Sagot</surname><given-names>M.-F.</given-names></name><name><surname>Peterlongo</surname><given-names>P.</given-names></name><name><surname>Lacroix</surname><given-names>V.</given-names></name></person-group>
<article-title>KISSPLICE: de-novo calling alternative splicing events from RNA-seq data</article-title>
<source>BMC Bioinformatics</source>
<year>2012</year>
<volume>13</volume><issue>Suppl 6</issue><fpage>S5</fpage></element-citation></ref><ref id="B12"><label>12.</label><element-citation publication-type="other">
<person-group person-group-type="author"><name><surname>Peterlongo</surname><given-names>P.</given-names></name><name><surname>Schnel</surname><given-names>N.</given-names></name><name><surname>Pisanti</surname><given-names>N.</given-names></name><name><surname>Sagot</surname><given-names>M.F.</given-names></name><name><surname>Lacroix</surname><given-names>V.</given-names></name></person-group>
<article-title>Identifying SNPs without a reference genome by comparing raw reads</article-title><year>2010</year><ext-link ext-link-type="uri" xlink:href="https://www.hal.inria.fr/inria-00514887/document">https://hal.inria.fr/inria-00514887/document</ext-link></element-citation></ref><ref id="B13"><label>13.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Pevzner</surname><given-names>P.A.</given-names></name><name><surname>Tang</surname><given-names>H.</given-names></name><name><surname>Waterman</surname><given-names>M.S.</given-names></name></person-group>
<article-title>An Eulerian path approach to DNA fragment assembly</article-title>
<source>Proc. Natl. Acad. Sci. U.S.A.</source>
<year>2001</year>
<volume>98</volume>
<fpage>9748</fpage><lpage>9753</lpage><pub-id pub-id-type="pmid">11504945</pub-id></element-citation></ref><ref id="B14"><label>14.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Zerbino</surname><given-names>D.R.</given-names></name><name><surname>Birney</surname><given-names>E.</given-names></name></person-group>
<article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>
<source>Genome Res.</source>
<year>2008</year>
<volume>18</volume>
<fpage>821</fpage><lpage>829</lpage><pub-id pub-id-type="pmid">18349386</pub-id></element-citation></ref><ref id="B15"><label>15.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Grabherr</surname><given-names>M.G.</given-names></name><name><surname>Haas</surname><given-names>B.J.</given-names></name><name><surname>Yassour</surname><given-names>M.</given-names></name><name><surname>Levin</surname><given-names>J.Z.</given-names></name><name><surname>Thompson</surname><given-names>D.A.</given-names></name><name><surname>Amit</surname><given-names>I.</given-names></name><name><surname>Adiconis</surname><given-names>X.</given-names></name><name><surname>Fan</surname><given-names>L.</given-names></name><name><surname>Raychowdhury</surname><given-names>R.</given-names></name><name><surname>Zeng</surname><given-names>Q.</given-names></name><etal/></person-group>
<article-title>Full-length transcriptome assembly from RNA-Seq data without a reference genome</article-title>
<source>Nat. Biotechnol.</source>
<year>2011</year>
<volume>29</volume>
<fpage>644</fpage><lpage>652</lpage><pub-id pub-id-type="pmid">21572440</pub-id></element-citation></ref><ref id="B16"><label>16.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Chikhi</surname><given-names>R.</given-names></name><name><surname>Rizk</surname><given-names>G.</given-names></name></person-group>
<article-title>Space-efficient and exact de Bruijn graph representation based on a Bloom filter</article-title>
<source>Algorith. Mol. Biol: AMB</source>
<year>2013</year>
<volume>8</volume>
<fpage>22</fpage></element-citation></ref><ref id="B17"><label>17.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Salikhov</surname><given-names>K.</given-names></name><name><surname>Sacomoto</surname><given-names>G.</given-names></name><name><surname>Kucherov</surname><given-names>G.</given-names></name></person-group>
<article-title>Using cascading Bloom filters to improve the memory usage for de Brujin graphs</article-title>
<source>Algorit. Mol. Biol.</source>
<year>2014</year>
<volume>9</volume>
<fpage>2</fpage></element-citation></ref><ref id="B18"><label>18.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Sacomoto</surname><given-names>G.</given-names></name><name><surname>Sinaimeri</surname><given-names>B.</given-names></name><name><surname>Marchet</surname><given-names>C.</given-names></name><name><surname>Miele</surname><given-names>V.</given-names></name><name><surname>Sagot</surname><given-names>M.-F.</given-names></name><name><surname>Lacroix</surname><given-names>V.</given-names></name></person-group>
<article-title>Navigating in a Sea of Repeats in RNA-seq without Drowning</article-title>
<source>Lect. Notes Bioinformatics</source>
<year>2014</year>
<volume>8701</volume>
<fpage>82</fpage><lpage>96</lpage></element-citation></ref><ref id="B19"><label>19.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Tilgner</surname><given-names>H.</given-names></name><name><surname>Knowles</surname><given-names>D.G.</given-names></name><name><surname>Johnson</surname><given-names>R.</given-names></name><name><surname>Davis</surname><given-names>C.A.</given-names></name><name><surname>Chakrabortty</surname><given-names>S.</given-names></name><name><surname>Djebali</surname><given-names>S.</given-names></name><name><surname>Curado</surname><given-names>J.</given-names></name><name><surname>Snyder</surname><given-names>M.</given-names></name><name><surname>Gingeras</surname><given-names>T.R.</given-names></name><name><surname>Guig&#x000f3;</surname><given-names>R.</given-names></name></person-group>
<article-title>Deep sequencing of subcellular RNA fractions shows splicing to be predominantly co-transcriptional in the human genome but inefficient for lncRNAs</article-title>
<source>Genome Res.</source>
<year>2012</year>
<volume>22</volume>
<fpage>1616</fpage><lpage>1625</lpage><pub-id pub-id-type="pmid">22955974</pub-id></element-citation></ref><ref id="B20"><label>20.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Kent</surname><given-names>W.J.</given-names></name></person-group>
<article-title>BLAT&#x02013;the BLAST-like alignment tool</article-title>
<source>Genome Res.</source>
<year>2002</year>
<volume>12</volume>
<fpage>656</fpage><lpage>664</lpage><pub-id pub-id-type="pmid">11932250</pub-id></element-citation></ref><ref id="B21"><label>21.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Lu</surname><given-names>J.</given-names></name><name><surname>Tomfohr</surname><given-names>J.K.</given-names></name><name><surname>Kepler</surname><given-names>T.B.</given-names></name></person-group>
<article-title>Identifying differential expression in multiple SAGE libraries: an overdispersed log-linear model approach</article-title>
<source>BMC Bioinformatics</source>
<year>2005</year>
<volume>6</volume>
<fpage>1</fpage><pub-id pub-id-type="pmid">15631638</pub-id></element-citation></ref><ref id="B22"><label>22.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Robinson</surname><given-names>M.D.</given-names></name><name><surname>Smyth</surname><given-names>G.K.</given-names></name></person-group>
<article-title>Moderated statistical tests for assessing differences in tag abundance</article-title>
<source>Bioinformatics</source>
<year>2007</year>
<volume>23</volume>
<fpage>2881</fpage><lpage>2887</lpage><pub-id pub-id-type="pmid">17881408</pub-id></element-citation></ref><ref id="B23"><label>23.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Anders</surname><given-names>S.</given-names></name></person-group>
<article-title>Analysing RNA-Seq data with the DESeq package</article-title>
<source>Mol. Biol.</source>
<year>2010</year>
<volume>43</volume>
<fpage>1</fpage><lpage>17</lpage></element-citation></ref><ref id="B24"><label>24.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Dillies</surname><given-names>M.-A.</given-names></name><name><surname>Rau</surname><given-names>A.</given-names></name><name><surname>Aubert</surname><given-names>J.</given-names></name><name><surname>Hennequet-Antier</surname><given-names>C.</given-names></name><name><surname>Jeanmougin</surname><given-names>M.</given-names></name><name><surname>Servant</surname><given-names>N.</given-names></name><name><surname>Keime</surname><given-names>C.</given-names></name><name><surname>Marot</surname><given-names>G.</given-names></name><name><surname>Castel</surname><given-names>D.</given-names></name><name><surname>Estelle</surname><given-names>J.</given-names></name><etal/></person-group>
<article-title>A comprehensive evaluation of normalization methods for Illumina high-throughput RNA sequencing data analysis</article-title>
<source>Brief. Bioinformatics</source>
<year>2013</year>
<volume>14</volume>
<fpage>671</fpage><lpage>683</lpage><pub-id pub-id-type="pmid">22988256</pub-id></element-citation></ref><ref id="B25"><label>25.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Bullard</surname><given-names>J.H.</given-names></name><name><surname>Purdom</surname><given-names>E.</given-names></name><name><surname>Hansen</surname><given-names>K.D.</given-names></name><name><surname>Dudoit</surname><given-names>S.</given-names></name></person-group>
<article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title>
<source>BMC Bioinformatics</source>
<year>2010</year>
<volume>11</volume>
<fpage>94</fpage><pub-id pub-id-type="pmid">20167110</pub-id></element-citation></ref><ref id="B26"><label>26.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y.</given-names></name><name><surname>Hochberg</surname><given-names>Y.</given-names></name></person-group>
<article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
<source>J. R. Stat. Soc. Ser. B (Methodol.)</source>
<year>1995</year><fpage>289</fpage><lpage>300</lpage></element-citation></ref><ref id="B27"><label>27.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Dobin</surname><given-names>A.</given-names></name><name><surname>Davis</surname><given-names>C.A.</given-names></name><name><surname>Schlesinger</surname><given-names>F.</given-names></name><name><surname>Drenkow</surname><given-names>J.</given-names></name><name><surname>Zaleski</surname><given-names>C.</given-names></name><name><surname>Jha</surname><given-names>S.</given-names></name><name><surname>Batut</surname><given-names>P.</given-names></name><name><surname>Chaisson</surname><given-names>M.</given-names></name><name><surname>Gingeras</surname><given-names>T.R.</given-names></name></person-group>
<article-title>STAR: ultrafast universal RNA-seq aligner</article-title>
<source>Bioinformatics</source>
<year>2013</year>
<volume>29</volume>
<fpage>15</fpage><lpage>21</lpage><pub-id pub-id-type="pmid">23104886</pub-id></element-citation></ref><ref id="B28"><label>28.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Engstr&#x000f6;m</surname><given-names>P.G.</given-names></name><name><surname>Steijger</surname><given-names>T.</given-names></name><name><surname>Sipos</surname><given-names>B.</given-names></name><name><surname>Grant</surname><given-names>G.R.</given-names></name><name><surname>Kahles</surname><given-names>A.</given-names></name><name><surname>Alioto</surname><given-names>T.</given-names></name><name><surname>Behr</surname><given-names>J.</given-names></name><name><surname>Bertone</surname><given-names>P.</given-names></name><name><surname>Bohnert</surname><given-names>R.</given-names></name><name><surname>Campagna</surname><given-names>D.</given-names></name><etal/></person-group>
<article-title>Systematic evaluation of spliced alignment programs for RNA-seq data</article-title>
<source>Nat. Methods</source>
<year>2013</year>
<volume>10</volume>
<fpage>1185</fpage><lpage>1191</lpage><pub-id pub-id-type="pmid">24185836</pub-id></element-citation></ref><ref id="B29"><label>29.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B.</given-names></name><name><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group>
<article-title>Fast gapped-read alignment with Bowtie 2</article-title>
<source>Nat. Methods</source>
<year>2012</year>
<volume>9</volume>
<fpage>357</fpage><lpage>359</lpage><pub-id pub-id-type="pmid">22388286</pub-id></element-citation></ref><ref id="B30"><label>30.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Li</surname><given-names>H.</given-names></name><name><surname>Handsaker</surname><given-names>B.</given-names></name><name><surname>Wysoker</surname><given-names>A.</given-names></name><name><surname>Fennell</surname><given-names>T.</given-names></name><name><surname>Ruan</surname><given-names>J.</given-names></name><name><surname>Homer</surname><given-names>N.</given-names></name><name><surname>Marth</surname><given-names>G.</given-names></name><name><surname>Abecasis</surname><given-names>G.</given-names></name><name><surname>Durbin</surname><given-names>R.</given-names></name><etal/></person-group>
<article-title>The sequence alignment/map format and SAMtools</article-title>
<source>Bioinformatics</source>
<year>2009</year>
<volume>25</volume>
<fpage>2078</fpage><lpage>2079</lpage><pub-id pub-id-type="pmid">19505943</pub-id></element-citation></ref><ref id="B31"><label>31.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Pante</surname><given-names>E.</given-names></name><name><surname>Rohfritsch</surname><given-names>A.</given-names></name><name><surname>Becquet</surname><given-names>V.</given-names></name><name><surname>Belkhir</surname><given-names>K.</given-names></name><name><surname>Bierne</surname><given-names>N.</given-names></name><name><surname>Garcia</surname><given-names>P.</given-names></name></person-group>
<article-title>SNP detection from de novo transcriptome sequencing in the bivalve Macoma balthica: marker development for evolutionary studies</article-title>
<source>PLoS One</source>
<year>2012</year>
<volume>7</volume>
<fpage>e52302</fpage><pub-id pub-id-type="pmid">23300636</pub-id></element-citation></ref><ref id="B32"><label>32.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Dedeine</surname><given-names>F.</given-names></name><name><surname>Vavre</surname><given-names>F.</given-names></name><name><surname>Fleury</surname><given-names>F.</given-names></name><name><surname>Loppin</surname><given-names>B.</given-names></name><name><surname>Hochberg</surname><given-names>M.E.</given-names></name><name><surname>Bouletreau</surname><given-names>M.</given-names></name></person-group>
<article-title>Removing symbiotic Wolbachia bacteria specifically inhibits oogenesis in a parasitic wasp</article-title>
<source>Proc. Natl. Acad. Sci. U.S.A.</source>
<year>2001</year>
<volume>98</volume>
<fpage>6247</fpage><lpage>6252</lpage><pub-id pub-id-type="pmid">11353833</pub-id></element-citation></ref><ref id="B33"><label>33.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Dedeine</surname><given-names>F.</given-names></name><name><surname>Vavre</surname><given-names>F.</given-names></name><name><surname>Shoemaker</surname><given-names>D.D.</given-names></name><name><surname>Boul&#x000e9;treau</surname><given-names>M.</given-names></name></person-group>
<article-title>Intra-individual coexistence of a Wolbachia strain required for host oogenesis with two strains inducing cytoplasmic incompatibility in the wasp Asobara tabida</article-title>
<source>Evolution</source>
<year>2004</year>
<volume>58</volume>
<fpage>2167</fpage><lpage>2174</lpage><pub-id pub-id-type="pmid">15562683</pub-id></element-citation></ref><ref id="B34"><label>34.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Kremer</surname><given-names>N.</given-names></name><name><surname>Dedeine</surname><given-names>F.</given-names></name><name><surname>Charif</surname><given-names>D.</given-names></name><name><surname>Finet</surname><given-names>C.</given-names></name><name><surname>Allemand</surname><given-names>R.</given-names></name><name><surname>Vavre</surname><given-names>F.</given-names></name></person-group>
<article-title>Do variable compensatory mechanisms explain the polymorphism of the dependence phenotype in the Asobara tabida-wolbachia association?</article-title>
<source>Evolution</source>
<year>2010</year>
<volume>64</volume>
<fpage>2969</fpage><lpage>2979</lpage><pub-id pub-id-type="pmid">20482609</pub-id></element-citation></ref><ref id="B35"><label>35.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Kremer</surname><given-names>N.</given-names></name><name><surname>Voronin</surname><given-names>D.</given-names></name><name><surname>Charif</surname><given-names>D.</given-names></name><name><surname>Mavingui</surname><given-names>P.</given-names></name><name><surname>Mollereau</surname><given-names>B.</given-names></name><name><surname>Vavre</surname><given-names>F.</given-names></name></person-group>
<article-title>Wolbachia interferes with ferritin expression and iron metabolism in insects</article-title>
<source>PLoS Pathog.</source>
<year>2009</year>
<volume>5</volume>
<fpage>e1000630</fpage><pub-id pub-id-type="pmid">19851452</pub-id></element-citation></ref><ref id="B36"><label>36.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Matzkin</surname><given-names>L.M.</given-names></name></person-group>
<article-title>Population genetics and geographic variation of alcohol dehydrogenase (Adh) paralogs and glucose-6-phosphate dehydrogenase (G6pd) in Drosophila mojavensis</article-title>
<source>Mol. Biol. Evol.</source>
<year>2004</year>
<volume>21</volume>
<fpage>276</fpage><lpage>285</lpage><pub-id pub-id-type="pmid">14660699</pub-id></element-citation></ref><ref id="B37"><label>37.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Reed</surname><given-names>L.</given-names></name><name><surname>Nyboer</surname><given-names>M.</given-names></name><name><surname>Markow</surname><given-names>T.</given-names></name></person-group>
<article-title>Evolutionary relationships of Drosophila mojavensis geographic host races and their sister species Drosophila arizonae</article-title>
<source>Mol. Ecol.</source>
<year>2007</year>
<volume>16</volume>
<fpage>1007</fpage><lpage>1022</lpage><pub-id pub-id-type="pmid">17305857</pub-id></element-citation></ref><ref id="B38"><label>38.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Modolo</surname><given-names>L.</given-names></name><name><surname>Lerat</surname><given-names>E.</given-names></name></person-group>
<article-title>UrQt: an efficient software for the Unsupervised Quality trimming of NGS data</article-title>
<source>BMC Bioinformatics</source>
<year>2015</year>
<volume>16</volume>
<fpage>137</fpage><pub-id pub-id-type="pmid">25924884</pub-id></element-citation></ref><ref id="B39"><label>39.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Lappalainen</surname><given-names>T.</given-names></name><name><surname>Sammeth</surname><given-names>M.</given-names></name><name><surname>Friedl&#x000e4;nder</surname><given-names>M.R.</given-names></name><name><surname>&#x02019;t&#x000a0;Hoen</surname><given-names>P.A.C.</given-names></name><name><surname>Monlong</surname><given-names>J.</given-names></name><name><surname>Rivas</surname><given-names>M.A.</given-names></name><name><surname>Gonz&#x000e0;lez-Porta</surname><given-names>M.</given-names></name><name><surname>Kurbatova</surname><given-names>N.</given-names></name><name><surname>Griebel</surname><given-names>T.</given-names></name><name><surname>Ferreira</surname><given-names>P.G.</given-names></name><etal/></person-group>
<article-title>Transcriptome and genome sequencing uncovers functional variation in humans</article-title>
<source>Nature</source>
<year>2013</year>
<volume>501</volume>
<fpage>506</fpage><lpage>511</lpage><pub-id pub-id-type="pmid">24037378</pub-id></element-citation></ref><ref id="B40"><label>40.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Ramaswami</surname><given-names>G.</given-names></name><name><surname>Li</surname><given-names>J.B.</given-names></name></person-group>
<article-title>RADAR: a rigorously annotated database of A-to-I RNA editing</article-title>
<source>Nucleic Acids Res.</source>
<year>2014</year>
<volume>42</volume>
<fpage>D109</fpage><lpage>D113</lpage><pub-id pub-id-type="pmid">24163250</pub-id></element-citation></ref><ref id="B41"><label>41.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Cingolani</surname><given-names>P.</given-names></name><name><surname>Platts</surname><given-names>A.</given-names></name><name><surname>Wang</surname><given-names>L.L.</given-names></name><name><surname>Coon</surname><given-names>M.</given-names></name><name><surname>Nguyen</surname><given-names>T.</given-names></name><name><surname>Wang</surname><given-names>L.</given-names></name><name><surname>Land</surname><given-names>S.J.</given-names></name><name><surname>Lu</surname><given-names>X.</given-names></name><name><surname>Ruden</surname><given-names>D.M.</given-names></name></person-group>
<article-title>A program for annotating and predicting the effects of single nucleotide polymorphisms, SnpEff: SNPs in the genome of Drosophila melanogaster strain w1118; iso-2; iso-3</article-title>
<source>Fly</source>
<year>2012</year>
<volume>6</volume>
<fpage>80</fpage><lpage>92</lpage><pub-id pub-id-type="pmid">22728672</pub-id></element-citation></ref><ref id="B42"><label>42.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Adzhubei</surname><given-names>I.A.</given-names></name><name><surname>Schmidt</surname><given-names>S.</given-names></name><name><surname>Peshkin</surname><given-names>L.</given-names></name><name><surname>Ramensky</surname><given-names>V.E.</given-names></name><name><surname>Gerasimova</surname><given-names>A.</given-names></name><name><surname>Bork</surname><given-names>P.</given-names></name><name><surname>Kondrashov</surname><given-names>A.S.</given-names></name><name><surname>Sunyaev</surname><given-names>S.R.</given-names></name></person-group>
<article-title>A method and server for predicting damaging missense mutations</article-title>
<source>Nat. Methods</source>
<year>2010</year>
<volume>7</volume>
<fpage>248</fpage><lpage>249</lpage><pub-id pub-id-type="pmid">20354512</pub-id></element-citation></ref></ref-list></back></article>