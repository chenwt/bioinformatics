<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v3.0 20080202//EN" "archivearticle3.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?DTDIdentifier.IdentifierValue article.dtd?><?DTDIdentifier.IdentifierType system?><?SourceDTD.DTDName article.dtd?><?SourceDTD.Version 1.0?><?ConverterInfo.XSLTName bmc2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title-group><journal-title>BMC Bioinformatics</journal-title></journal-title-group><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3166942</article-id><article-id pub-id-type="publisher-id">1471-2105-12-322</article-id><article-id pub-id-type="pmid">21816037</article-id><article-id pub-id-type="doi">10.1186/1471-2105-12-322</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology Article</subject></subj-group></article-categories><title-group><article-title>Strategies for aggregating gene expression data: The collapseRows R function</article-title></title-group><contrib-group><contrib contrib-type="author" id="A1"><name><surname>Miller</surname><given-names>Jeremy A</given-names></name><xref ref-type="aff" rid="I1">1</xref><xref ref-type="aff" rid="I2">2</xref><email>jeremyinla@gmail.com</email></contrib><contrib contrib-type="author" id="A2"><name><surname>Cai</surname><given-names>Chaochao</given-names></name><xref ref-type="aff" rid="I2">2</xref><xref ref-type="aff" rid="I3">3</xref><email>caichaochao@ucla.edu</email></contrib><contrib contrib-type="author" id="A3"><name><surname>Langfelder</surname><given-names>Peter</given-names></name><xref ref-type="aff" rid="I2">2</xref><xref ref-type="aff" rid="I3">3</xref><email>Peter.Langfelder@gmail.com</email></contrib><contrib contrib-type="author" id="A4"><name><surname>Geschwind</surname><given-names>Daniel H</given-names></name><xref ref-type="aff" rid="I2">2</xref><xref ref-type="aff" rid="I4">4</xref><email>dhg@mednet.ucla.edu</email></contrib><contrib contrib-type="author" id="A5"><name><surname>Kurian</surname><given-names>Sunil M</given-names></name><xref ref-type="aff" rid="I5">5</xref><email>smkurian@scripps.edu</email></contrib><contrib contrib-type="author" id="A6"><name><surname>Salomon</surname><given-names>Daniel R</given-names></name><xref ref-type="aff" rid="I5">5</xref><email>dsalomon@scripps.edu</email></contrib><contrib contrib-type="author" corresp="yes" id="A7"><name><surname>Horvath</surname><given-names>Steve</given-names></name><xref ref-type="aff" rid="I2">2</xref><xref ref-type="aff" rid="I3">3</xref><email>shorvath@mednet.ucla.edu</email></contrib></contrib-group><aff id="I1"><label>1</label>Interdepartmental Program for Neuroscience, UCLA, Los Angeles, California, USA</aff><aff id="I2"><label>2</label>Human Genetics Department, UCLA, Los Angeles, California, USA</aff><aff id="I3"><label>3</label>Biostatistics Department, UCLA, Los Angeles, California, USA</aff><aff id="I4"><label>4</label>Neurology Department, UCLA, Los Angeles, California, USA</aff><aff id="I5"><label>5</label>Department of Molecular and Experimental Medicine, The Scripps Research Institute, La Jolla, California, USA</aff><pub-date pub-type="collection"><year>2011</year></pub-date><pub-date pub-type="epub"><day>4</day><month>8</month><year>2011</year></pub-date><volume>12</volume><fpage>322</fpage><lpage>322</lpage><history><date date-type="received"><day>23</day><month>5</month><year>2011</year></date><date date-type="accepted"><day>4</day><month>8</month><year>2011</year></date></history><permissions><copyright-statement>Copyright &#x000a9;2011 Miller et al; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2011</copyright-year><copyright-holder>Miller et al; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="http://www.biomedcentral.com/1471-2105/12/322"/><abstract><sec><title>Background</title><p>Genomic and other high dimensional analyses often require one to summarize multiple related variables by a single representative. This task is also variously referred to as collapsing, combining, reducing, or aggregating variables. Examples include summarizing several probe measurements corresponding to a single gene, representing the expression profiles of a co-expression module by a single expression profile, and aggregating cell-type marker information to de-convolute expression data. Several standard statistical summary techniques can be used, but network methods also provide useful alternative methods to find representatives. Currently few collapsing functions are developed and widely applied.</p></sec><sec><title>Results</title><p>We introduce the R function collapseRows that implements several collapsing methods and evaluate its performance in three applications. First, we study a crucial step of the meta-analysis of microarray data: the merging of independent gene expression data sets, which may have been measured on different platforms. Toward this end, we collapse multiple microarray probes for a single gene and then merge the data by gene identifier. We find that choosing the probe with the highest average expression leads to best between-study consistency. Second, we study methods for summarizing the gene expression profiles of a co-expression module. Several gene co-expression network analysis applications show that the optimal collapsing strategy depends on the analysis goal. Third, we study aggregating the information of cell type marker genes when the aim is to predict the abundance of cell types in a tissue sample based on gene expression data ("expression deconvolution"). We apply different collapsing methods to predict cell type abundances in peripheral human blood and in mixtures of blood cell lines. Interestingly, the most accurate prediction method involves choosing the most highly connected "hub" marker gene. Finally, to facilitate biological interpretation of collapsed gene lists, we introduce the function userListEnrichment, which assesses the enrichment of gene lists for known brain and blood cell type markers, and for other published biological pathways.</p></sec><sec><title>Conclusions</title><p>The R function collapseRows implements several standard and network-based collapsing methods. In various genomic applications we provide evidence that both types of methods are robust and biologically relevant tools.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>Genomic and other high dimensional data analyses often face the challenge to collapse multiple variables. Such collapsing of data can be advantageous for several reasons: 1) to allow direct comparison of similar data from unique sources, 2) to amplify the signal by removing noisy information, or 3) to reduce the computational burden. As a first example, consider the task of combining or contrasting gene expression data measured on different microarray platforms. Most array platforms measure multiple probes per gene, and different platforms typically include different probes for the same gene. To compare such expression data sets at the level of a gene identifier (e.g. Entrez ID or gene symbol) requires that the multiple probe measurements of a given gene be collapsed into a single gene measurement. An important, yet relatively unexplored, empirical question is how to choose the best representative probe. As a second example, consider the task of representing co-expression modules (clusters of genes) by a single value (referred to as a module centroid). Several approaches for finding a module centroid have been proposed in the literature (e.g. forming the mean, choosing the first principal component, etc), but it is unclear in which situation each method should be used. As a third example, consider the task of estimating cell type abundances based on data for lineage and cell-specific markers such as selectively expressed genes or proteins. Often, microarray analyses are performed using heterogeneous tissue (e.g., brain sections, whole blood); thus, gene expression changes occurring between two groups of samples could either be due to changes in transcriptional levels in one or more cell types, or they could be due to changes in cell type proportion variation. By accurately estimating cell type abundances including data from independent measurements using complementary technologies (e.g. flow cytometry, histology), more accurate measures of transcriptional changes could be established.</p><p>Statistically speaking, all of these tasks involve summarizing several closely related variables into one collapsed variable. Collapsing approaches fall into one of two categories: 1) composite values, which involve forming an average (often weighted) of multiple variables in a group; and 2) representatives, where a single variable is chosen from those in the group. Two examples of composite values include the mean and the first principal component (PC). The first PC explains the maximum amount of variation underlying the variables. For example, when summarizing the gene expression profiles of a co-expression module, the first PC is known as the module eigengene (ME; e.g. [<xref ref-type="bibr" rid="B1">1</xref>]). Several strategies can be used for choosing a representative; for example, one could choose the variable with the least number of missing data or the maximum mean expression value or the maximum variance. Apart from these statistical approaches, network methods are increasingly used to collapse data. For example, one can first construct a network between the variables and then choose the one that has the highest connectivity (or degree; see the Methods section for more details). Toward this end, signed correlation networks are particularly relevant since often one wants to keep track of the direction of the relationship between variables. For example, in the case of transcriptional networks, genes showing positive correlation are more likely than uncorrelated or negatively correlated genes to have known protein-protein interactions [<xref ref-type="bibr" rid="B2">2</xref>-<xref ref-type="bibr" rid="B4">4</xref>].</p><p>In the present work, we have created an R function, collapseRows, that implements a host of widely used collapsing methods. We will describe this function in more detail and present several motivating examples involving gene expression data (mRNA abundances). We explore this function in the context of the several distinct gene expression-related situations presented above, describing situations when certain collapsing methods are advantageous. For example, we find that in most microarray experiments performed on brain tissue it is best to choose the probe with the maximum mean expression per gene, whereas when choosing a single gene to represent a co-expression module, the optimal collapsing method depends on the goal of the analysis. For predicting the true proportion of cell types within a tissue homogenate, on the other hand, network-based collapsing approaches perform best. Finally, we provide R code for both the collapseRows function as well as for performing all of the analyses discussed in the text. Overall, we find that the collapseRows function is useful in many situations in which data aggregation is required.</p></sec><sec><title>Results</title><p>Robust methods for summarizing large quantities of genomics data can be critical to advancing biological understanding. To address this issue we created collapseRows, which takes a numeric matrix of data as input, in which rows correspond to the variables, as well as a grouping variable that assigns each row to a group. This function implements standard collapsing methods (such as forming the average), as well as alternative network based methods (such as connectivity based collapsing) as possible strategies for data aggregation, then outputs one representative or composite value per group of rows. Thus, the resulting matrix has the same number of columns as the input matrix but typically has far fewer rows, potentially alleviating computational bottlenecks and often increasing between-study comparability. For example, in Figure <xref ref-type="fig" rid="F1">1</xref> we present a hypothetical pipeline for using microarrays from multiple data sets to predict clinical outcome, in which collapseRows is used twice: first to collapse probes to genes, and then to collapse genes to modules.</p><fig id="F1" position="float"><label>Figure 1</label><caption><p><bold>Example pipeline for using collapseRows functions</bold>. The collapseRows function could be used in two steps of a pipeline for finding predictors of a clinical outcome. First, probes could be collapsed into genes by taking the probe with the highest expression (1.max strategy) to allow comparability of data run using several microarray platforms (or RNAseq). These data could then be combined into a consensus module. Second, modules from the resulting network could be summarized using the the most highly connected gene (3.kMax strategy), some of which will likely be related to clinical outcomes.</p></caption><graphic xlink:href="1471-2105-12-322-1"/></fig><p>In the following, we describe the R implementation of collapseRows and present examples from several empirical studies of high dimensional genomics data. In particular, for each of our examples, we run a subset of the following six collapsing strategies: maximum mean (1.max), maximum variance (2.var), maximum mean + maximum connectivity (3.kMax), maximum variance + maximum connectivity (4.kVar), module eigengene (5.ME), and the average (6.Avg; see Methods for details). Table <xref ref-type="table" rid="T1">1</xref> provides an overview of our empirical studies and the types of employed collapsing strategies.</p><table-wrap id="T1" position="float"><label>Table 1</label><caption><p>Summary of data sets and corresponding collapsing strategies</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center">Fig</th><th align="center">Analysis</th><th align="center">Data sets used</th><th align="center">1. max</th><th align="center">2. var</th><th align="center">3. kMax</th><th align="center">4. kVar</th><th align="center">5. ME</th><th align="center">6. Avg</th></tr></thead><tbody><tr><td align="center"><bold>1</bold></td><td align="center">Summary</td><td align="center">Hypothetical data</td><td align="center">X</td><td align="center">-</td><td align="center">X</td><td align="center">-</td><td align="center">-</td><td align="center">-</td></tr><tr><td colspan="9"><hr/></td></tr><tr><td align="center"><bold>2</bold></td><td align="center">Collapsing probes to genes</td><td align="center">18 Human Brain # 20 Mouse Brain % 5 Human Blood $</td><td align="center">X</td><td align="center">X</td><td align="center">X</td><td align="center">X</td><td align="center">-</td><td align="center">-</td></tr><tr><td colspan="9"><hr/></td></tr><tr><td align="center"><bold>3</bold></td><td align="center">Choosing module centroids</td><td align="center">7 Human Brain # 8 Mouse Brain % 5 Human Blood $</td><td align="center">X</td><td align="center">-</td><td align="center">X</td><td align="center">-</td><td align="center">X</td><td align="center">-</td></tr><tr><td colspan="9"><hr/></td></tr><tr><td align="center"><bold>4</bold></td><td align="center">Predicting cell type proportions</td><td align="center">Abbas et al 2009 (cell lines)</td><td align="center">X</td><td align="center">-</td><td align="center">X</td><td align="center">-</td><td align="center">X</td><td align="center">X</td></tr><tr><td colspan="9"><hr/></td></tr><tr><td align="center"><bold>5</bold></td><td align="center">Predicting cell type proportions</td><td align="center">Grigoryev et al 2010 (whole blood)</td><td align="center">X</td><td align="center">-</td><td align="center">X</td><td align="center">-</td><td align="center">X</td><td align="center">X</td></tr></tbody></table><table-wrap-foot><p>"#" - The 18 human brain data sets were the following GSE numbers: 1133, <underline>1297</underline>, 1572, 2164B, 3526A, 3526B, <underline>3790A</underline>, <underline>3790B</underline>, <underline>3790C</underline>, 4036, 4757, 5281A, 5281B, <underline>5388A</underline>, <underline>5388B</underline>, 7621, <underline>8397</underline>, and 9770. "%" - The 20 mouse brain data sets were the following GSE numbers: 1482, 1782A, 1782B, 2392, 3248, 3327A, 3327B, 3594C, 3963A, 3963B, 4269, <underline>4734</underline>, 5429, <underline>6285</underline>, <underline>6514A</underline>, <underline>6514B</underline>, <underline>9444A</underline>, <underline>9444B</underline>, <underline>9444C</underline>, <underline>10263</underline>. For "#" and "&#x00026;," underlined data sets were used in Figure 3 as well as Figure 2. See Miller et al 2010 for more details on these data sets. "$" - The 5 human blood data sets were from Dumeaux et al 2010, Goring et al 2007, Pankla et al 2009, and Saris et al 2009.</p></table-wrap-foot></table-wrap><sec><title>R implementation of the function collapseRows</title><p>This collapseRows function implements several network-based and biostatistical methods for finding a single value to represent each group specified in the function call. collapseRows is available in the WGCNA package for R [<xref ref-type="bibr" rid="B5">5</xref>], and is presented as Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: the collapseRows function, while code for performing all of the above analyses is presented in Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: R code to perform analysis. Accompanying data files can be downloaded from the collapseRows website [<xref ref-type="bibr" rid="B6">6</xref>]. Our code was run using version 2.12.2 of R, although any recent version should work. A few steps of the analysis (i.e., building the networks for example 2) require a computer with a large amount of RAM (a computer with 16 GB of RAM was used for these steps); however, most analysis steps can be performed on laptops (e.g. we used a MacBook Pro with 4 GB RAM in most analyses steps), and the entire analysis can be reproduced in a few hours. The R function is called as follows:</p><p>collapseRows(datET, rowGroup, rowID, method="MaxMean",</p><p>connectivityBasedCollapsing=FALSE, methodFunction=NULL,</p><p>connectivityPower=1, selectFewestMissing=TRUE)</p><p>In this call, <italic>datET </italic>represents a matrix or data frame containing numeric values where rows correspond to variables (e.g. microarray probes) and columns correspond to observations (e.g. microarrays). Each row must have a unique row identifier (specified in the vector <italic>rowID</italic>). The group label of each row is encoded in the vector <italic>rowGroup </italic>(e.g. gene symbols corresponding to the probes in <italic>rowID</italic>). The argument <italic>method </italic>is a character string for determining which method is used to collapse rows into groups. The implemented options, described in more detail in the Methods, are "MaxMean," "MinMean," "maxRowVariance," "absMaxMean," "absMinMean," "ME", "average," and "function." If <italic>method </italic>= "function", the method used is set by the argument <italic>methodFunction</italic>, which must be a function that takes a matrix of numbers as input and produces a vector the length of the number of columns as output (e.g., colMeans). The logical argument <italic>connectivityBasedCollapsing </italic>controls whether groups with 3 or more corresponding rows should be collapsed by choosing the row with the highest connectivity according to a signed weighted correlation network adjacency matrix (Methods), where the power is determined by the argument <italic>connectivityPower</italic>. All collapsing strategies presented in the empirical studies were formed by setting a combination of the <italic>method </italic>and <italic>connectivityBasedCollapsing </italic>parameters. Finally, the logical argument <italic>selectFewestMissin</italic>g (with default value TRUE), controls whether <italic>datET </italic>should be trimmed such that only the rows with the fewest number of missing values per group are retained. Detailed information regarding the function is available within R using the help(collapseRows) command.</p></sec><sec><title>Example 1: collapsing microarray probes to genes</title><p>Gene expression microarrays often have several probes (or probe sets) per gene. Collapsing methods can be used to arrive at a single measurement per gene, which facilitates merging of data across different platforms. For example, in a previous study of mouse and human brain, a preliminary version of collapseRows was used to convert gene expression matrices from 18 human and 20 mouse data sets run on five separate microarray platforms into matrices that could be compared [<xref ref-type="bibr" rid="B3">3</xref>] (see Methods). Here we re-analyze these same data sets, along with several additional data sets from studies of human blood [<xref ref-type="bibr" rid="B7">7</xref>-<xref ref-type="bibr" rid="B12">12</xref>].</p><p>We evaluate the performance of the collapsing methods in multiple ways. To begin with, we determine how reproducible the result of the collapseRows function is across different data sets. For example, assume two different gene expression data sets in brain are available. After collapsing the probes by gene one can calculate the mean expression value of each gene in the two data sets. Next one can correlate the mean expression levels of the first data set with those of the second data set. A high correlation indicates that the output of the collapsing method allows one to robustly define the mean expression level of a gene. Since we are mainly interested in ranked expression levels, we determine the correlation of ranked mean expressions (which amounts to using the Spearman correlation coefficient). Apart from studying the reproducibility of the mean expressions, we also study the reproducibility of the network connectivity since this informs co-expression network applications. The connectivity (or degree) is the most widely used network statistic for describing the topological properties of a network node (gene) [<xref ref-type="bibr" rid="B13">13</xref>]. It is of great practical interest to determine to which extent the connectivity (and hub status) is preserved between 2 data sets. For example, it has often been used to compare networks from different species [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B14">14</xref>]. In this case, we define a signed weighted correlation network (Methods) after collapsing the probes into genes. Next we calculate the whole network connectivity measure k<sub>i</sub>, which measures how correlated the i-th gene is with other genes in the network (Methods). A significant positive correlation of ranked connectivity suggests that a co-expression network between the genes (collapsed probes) is robustly defined.</p><p>To empirically assess the reliability of different strategies of probe selection, we ran the collapseRows function on the brain and blood data sets described above, using 1.max, 2.var, 3.kMax, and 4.kVar. For each pair of gene expression matrices, we took the subset of genes in common and correlated the ranked mean expression and the ranked connectivity between data sets for each of the four collapsing strategies (see Figure <xref ref-type="fig" rid="F2">2A</xref> for a typical example; while the scatter plots do not reveal a strong relationship, we should point out that the connectivity correlations are significantly different from zero and non-negligible - at p &#x0003c; 10<sup>-8 </sup>the correlation coefficient is highly significantly different from zero). We then determined the average correlation of these two measures across data set pairs in human brain (Figure <xref ref-type="fig" rid="F2">2B</xref>), mouse brain (Figure <xref ref-type="fig" rid="F2">2C</xref>), and human blood (Figure <xref ref-type="fig" rid="F2">2D</xref>) and assessed how frequently and to what degree these measures were highest for each collapsing strategy. Overall, we found that 1.max was the most robust method, particularly with regards to the expression correlation; in other words, choosing the probe with the highest mean expression nearly always lead to the most comparable results between these data sets. We should point out that numerous alternative approaches for collapsing probes per gene are possible. Some of them are discussed below.</p><fig id="F2" position="float"><label>Figure 2</label><caption><p><bold>When collapsing probes to genes, 1.max is usually the optimal collapsing strategy to choose</bold>. A) A typical example of ranked expression (left column) and ranked connectivity (right column) correlation between two data sets. Each dot represents a gene in common between data sets, with the x and y axes represented that gene's ranked expression or connectivity in data sets 1 and 2, respectively. B-D) Across several studies in human brain (B), mouse brain (C), and human blood (D) the MaxMean (1.max) parameter generally produces better ranked expression correlations (left column) than maxVariance (2.var). For both MaxMean and maxVariance, use of connectivityBasedCollapsing (3.kMax and 4.kVar) decreases the between-study correlations. Similar results hold, to a lesser extent, with connectivity correlations (right column). Y-axes correspond to the average expression and connectivity correlation between data sets. Error bars represent standard error. Percentages indicate the percent of assessments in which the relevant strategy had the highest overall between-set correlation.</p></caption><graphic xlink:href="1471-2105-12-322-2"/></fig></sec><sec><title>Example 2: choosing one centroid per gene expression module</title><p>The collapseRows function allows one to aggregate the genes that make up a co-expression module. A co-expression module is sometimes defined via a clustering method, but any module assignment can be specified with the row-grouping variable of the collapseRows function (also see examples 3 and 4 below). We assessed the reliability of the following three different strategies for collapsing module genes into a single representative per module: 1.max, which chooses the module gene with highest mean expression; 3.kMax, which chooses the most highly connected intramodular hub gene; and 5.ME, which defines the first principal component of the module genes, resulting in the module eigengene. We focused only on these three collapsing methods since they are often used in network based data reduction methods [<xref ref-type="bibr" rid="B13">13</xref>].</p><p>To perform this analysis, we started with expression data from a single data set in each group (GSE3790B for human brain, GSE4734 for mouse brain, and [<xref ref-type="bibr" rid="B9">9</xref>] for human blood) and defined co-expression modules using WGCNA, since it is a widely used method for defining co-expression modules [<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B15">15</xref>-<xref ref-type="bibr" rid="B19">19</xref>]. Modules were defined as branches of a hierarchical clustering tree. To increase the robustness of our results, different choices of branch cutting parameters implemented in the dynamicTreeCut R library [<xref ref-type="bibr" rid="B20">20</xref>] were chosen to define 28 different module assignments. For each choice of module assignments (grouping variables), we then ran collapseRows on the subset of seven human and eight mouse brain data sets run on the HG-U133A and MG-U430A Affymetrix platforms, respectively, and on all five human blood data sets from example 1. Finally, we calculated the resulting ranked mean expression and ranked connectivity correlations between the different data sets as described above (Figure <xref ref-type="fig" rid="F3">3</xref>). If rows represent genes in a module, the connectivity of the collapsed variables measures how closely related the module is to other modules. Several studies have found that these correlations between modules may reveal higher order relationships between them [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>].</p><fig id="F3" position="float"><label>Figure 3</label><caption><p><bold>When collapsing genes to modules, the optimal method depends on the goal of the analysis</bold>. A-C) Across several studies in human brain (A), mouse brain (B), and human blood (C) the <italic>MaxMean </italic>parameter generally produces better ranked expression correlations (left column) when setting the <italic>connectivityBasedCollapsing </italic>parameter to FALSE. On the other hand, better connectivity correlations (right column) are found when setting <italic>connectivityBasedCollapsing </italic>to TRUE, in some cases producing higher correlations that even the module eigengene (5.ME). Labelling as in Figure 2 B-D.</p></caption><graphic xlink:href="1471-2105-12-322-3"/></fig><p>For human brain (Figure <xref ref-type="fig" rid="F3">3A</xref>), mouse brain (Figure <xref ref-type="fig" rid="F3">3B</xref>), and human blood (Figure <xref ref-type="fig" rid="F3">3C</xref>) the ranked mean correlation measure suggests that 1.max is the best collapsing strategy, whereas the ranked connectivity measure suggests that 3.kMax is a better collapsing strategy. Furthermore, in the case of mouse brain, 3.kMax actually leads to higher ranked connectivity correlations than the standard method of calculating the module eigengene (5.ME). Together, these results suggest that different parameter options should be chosen depending on the goal of the analysis and the specific input data being used. For example, if the goal of the analysis were to determine correlation patterns between modules then 3.kMax would be a more appropriate collapsing strategy than 1.max.</p></sec><sec><title>Example 3: predicting cell type abundances in mixtures of pure cell lines</title><p>Most microarrays measure tissue RNA from tissue homogenate rather than from a pure cell type. It has been recognized that markers for pure cells can sometimes be used to estimate the proportion of pure cells that make up the tissue homogenate. For example, standard expression deconvolution (based on a multivariate regression model) can be used to simultaneously estimate the abundance of multiple cell types [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B21">21</xref>-<xref ref-type="bibr" rid="B23">23</xref>]. While using a multivariate linear model may afford greater efficiency in estimating cell type abundances, it may perform poorly if it is incorrectly specified, for example due to omission of an unknown cell type. Our collapseRows based approach to expression deconvolution addresses a more limited, but related question: how well can expression levels of a set of marker genes for a single cell type (group) be used to estimate the relative abundance of that cell type between samples? Thus, the rows of the input matrix correspond to marker genes and the grouping variable assigns markers to their respective cell types. The collapsed variable per group is used as an abundance measure for the pure cell line.</p><p>To evaluate the performance of expression deconvolution methods, Abbas and colleagues [<xref ref-type="bibr" rid="B7">7</xref>] created a data set that involved mixing four distinct "pure" cell lines--Raji and IM-9 (from B cells), Jurkat (from T-cells), and THP-1 (from monocytes)--using pre-specified proportions. These known proportions could be used as gold standard measurement for judging the performance of methods that aim to estimate cell type abundances. Included in the expression data are microarrays run on each pure cell line, as well as microarrays run on four mixtures of these cell lines in known proportions, each in triplicate [<xref ref-type="bibr" rid="B7">7</xref>].</p><p>We applied the collapseRows function to the microarray data from the cell mixture study described above. We first chose the top 500 marker genes for each of the four cell lines by finding the genes with the highest fold change enrichment in a given cell line compared with the other three. We then ran the collapseRows function on the four mixtures of cell lines, using these 2000 marker genes as rows and the four cell lines as groups, and using several collapsing methods. Finally, we scaled these collapsed expression matrices to obtain the predicted proportions of each cell type across samples. We should emphasize that a limitation of our deconvolution approach is that it can only estimate the proportion of cells up to a constant. While our prediction is expected to be correlated with the true proportion across samples, it cannot be used to estimate the true proportion. The situation is similar to predicting degrees Fahrenheit based on another temperature scale: 0 degrees Fahrenheit does not correspond to 0 degrees Celsius, but a linear transformation can relate Fahrenheit to Celsius. It is often sufficient to use such an approach in the context of measuring cell type abundance, e.g. when correlating cell type abundances to a clinical outcome, because the correlation measure is scale invariant.</p><p>To assess the performance of different marker gene collapsing methods, we correlated the predicted abundances (proportions) of pure cell types with the true proportion determined by the mixture proportions (Figure <xref ref-type="fig" rid="F4">4</xref>). We find that all four tested methods of collapsing genes--1.max, 3.kMax, 5.ME, and 6.Avg--produced significant correlations (R &#x0003e; 0.8), but that collapsing based on maximum connectivity (3.kMax) led to by far the most accurate predictor (R = 0.994). In this application, collapsing rows by choosing the module eigengene (5.ME) leads to the least accurate predictions.</p><fig id="F4" position="float"><label>Figure 4</label><caption><p><bold>collapseRows accurately predicts the relative quantity of blood cell lines across mixed samples</bold>. Four prediction methods were used on data from (Abbas et al 2009), from which both gene expression data and actual blood cell counts were known: A) maximum mean expression (1.max), B) maximum connectivity (3.kMax), C) module eigengene (5.ME), and D) average (6.Avg) expression of all marker genes. Each dot presents one cell type in one sample. The X-axes correspond to the predicted proportion of each cell type, while the Y-axes correspond to the actual proportion of each cell type across samples. Values are scaled so that the sum of the proportions for a single cell type across all samples is 1. For all methods (except ME), the x = y line (representing perfect agreement) is plotted. Note that choosing the gene with the highest connectivity (B) most accurately predicts the true cell type proportions.</p></caption><graphic xlink:href="1471-2105-12-322-4"/></fig></sec><sec><title>Example 4: Predicting cell type abundances in peripheral human blood</title><p>Finally, to assess whether these methods can accurately predict cell type abundances in a more realistic model, we obtained microarray data from a deconvolution study of peripheral blood both pre- and post-kidney transplant [<xref ref-type="bibr" rid="B10">10</xref>]. Similar to the previous data set, these data include microarrays run on pure cell populations (CD4+ and CD8+ T cells, and CD19+ B cells) as well as on whole blood; however, these arrays were run using actual human blood and the constituent blood cell populations were purified using magnetic beads from the same samples used for whole blood assays. To assess the performance of different marker gene collapsing methods, we correlated the predicted abundances (which up to a constant are proportions) of pure cell types with the true proportion determined by flow cytometry data (described in [<xref ref-type="bibr" rid="B10">10</xref>]). Again, we find high correlation between true and predicted cell proportions for these cell types (Figure <xref ref-type="fig" rid="F5">5</xref>; 0.5 &#x0003c; R &#x0003c; 0.6 in most cases), although unsurprisingly, these real cell subset predictions for whole blood are not as accurate as the highly contrived strategy of using fixed combinations of transformed cell lines by Abbas and colleagues [<xref ref-type="bibr" rid="B7">7</xref>]. We also varied the number of marker genes per cell type used to form predictor. Collapsing on connectivity (3.kMax), ME (5.ME), and average (6.Avg) all lead to comparably good predictors. Furthermore, choosing N~100 marker genes produces the best results, although these three predictors are all fairly robust to the number of marker genes chosen. Choosing the gene with the maximum mean expression (1.max), however, is a much less robust method, and should not be used in this situation.</p><fig id="F5" position="float"><label>Figure 5</label><caption><p><bold>collapseRows accurately predicts the relative quantity of cell type across samples of whole blood</bold>. Using data from a realistic blood model (Grigoryev et al 2010), the 1.max, 3.kMax, 5.ME, and 6.Avg collapseRows aggregation strategies can still predict the relative proportion of several major cell types. Each point represents the correlation between true and predicted proportions for one of the four strategies. The X-axis corresponds to the number of marker genes used for the predictor, while the Y-axis corresponds to the correlation between true and predicted proportions. Note that all methods other than <italic>MaxMean </italic>(1.max) are relatively robust to choice in number of marker genes.</p></caption><graphic xlink:href="1471-2105-12-322-5"/></fig></sec><sec><title>Data aggregation using <italic>collapseRows </italic>leads to increased reproducibility</title><p>Despite advantages, data aggregation or collapsing will inevitably lead to a loss of information. Therefore, it is important to assess whether the loss of information has an impact on analysis results and if so what the impact looks like. Most of our empirical analyses use reproducibility (as measured by correlation of ranked mean expression and connectivity) as a measure of how much usable information remains in the data after aggregation. We now extend these analyses to assess how selective removal of information using collapseRows affects reproducibility, using the subset of 7 human brain samples run on the HG-U133A array and the subset of 8 samples run on the MG-U430A array. We measured the correlation of ranked mean expression and connectivity for comparisons on the probe level, and compared those with our best result using collapseRows (1.max; see Additional file <xref ref-type="supplementary-material" rid="S3">3</xref> - Increase in reproducibility using collapseRows). In human we find average expression correlations of R = 0.87 and 0.87, and connectivity correlations of R = 0.23 and 0.33 for the probe-level and gene-level comparisons, respectively. In mouse the comparable correlations are R = 0.93 and 0.93, and R = 0.15 and 0.24 for probe-level and gene-level comparisons. Together, these results suggest that, while present, the loss of information using collapseRows actually leads to increased reproducibility, at least as measured by correlation of ranked connectivity.</p></sec><sec><title>The function userListEnrichment facilitates biological interpretation of gene lists</title><p>After collapsing gene lists into groups, either for the purpose of finding co-expression modules or for determining marker genes, it is often useful to relate the collapsed data to cell type markers. For example, when using collapseRows to predict cell type abundances in a data set that does not contain control samples from pure cell lines, it would be useful to be able to compare each gene group against lists of known marker genes for the expected cell type before using these groups for deconvolution. Such a biological indicator is particularly useful when studying brain, where it is almost never possible to precisely separate cell types as an experimental control. To address this issue, we have created the function userListEnrichment, which is also available in the WGCNA library [<xref ref-type="bibr" rid="B5">5</xref>]. This function measures enrichment of input lists of genes (i.e., groups found using collapseRows) with respect to pre-defined or user defined collections of brain- and blood-related lists curated from the literature (see the help file for specific references cited). Files containing user-defined lists can also be input as reference lists directly. userListEnrichment measures enrichment using a hypergeometric test, after which significant enrichments are output to a file that can then be used for further biological assessments. While biological assessment of userListEnrichment is beyond the scope of this article, we present a tutorial for how to perform a co-expression analysis using both collapseRows and userListEnrichment on our website: <ext-link ext-link-type="uri" xlink:href="http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/JMiller/">http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/JMiller/</ext-link>.</p></sec></sec><sec><title>Discussion</title><p>The collapseRows function implements widely used collapsing methods and lesser known ones based on correlation network methodology. For example, we describe situations when it can be useful to collapse a group of numeric variables by determining the most highly connected hub variable. The main contributions of this article are: i) to describe important uses of this function, ii) to empirically compare different collapsing methods, and iii) to make recommendations regarding when to use various collapsing methods. Overall, our empirical studies show that collapseRows is a useful function in many situations when comparing data from separate high-throughput gene expression sources, with a set of default parameters that are often, but not always, the best parameters to use. In the case of collapsing probes to their respective gene symbols, for example, we find that the 1.max strategy (implemented by setting method = "MaxMean" and connectivityBasedCollapsing = FALSE) produces the most robust results. On the other hand, when using the collapseRows function to predict cell type abundances, we find that the 3.kmax strategy (implemented by setting connectivityBasedCollapsing = TRUE) leads to the most accurate results. In the more general case of choosing a single value as representative for all genes in a co-expression module, we would suggest trying multiple parameter options to see which work best for that particular set of data. Although originally designed and tested for expression data, in principle collapseRows could be used in any situation requiring data aggregation (e.g., fMRI data, methylation data, etc.). In this case, one should try several collapsing strategies to determine the most robust one for the task at hand.</p><p>For the special setting of expression data, alternative methods have been developed to aid in the annotation and comparison of data sets between studies. First, several sequence-based strategies for reannotating microarray probe identifiers based on updated genomic sequences have been proposed [<xref ref-type="bibr" rid="B24">24</xref>-<xref ref-type="bibr" rid="B27">27</xref>]. The most extensive such endeavour is the Array Information Library Universal Navigator (AILUN), which provides an up-to-date mapping between probe identifiers and Entrez gene IDs for microarray platforms in 79 species [<xref ref-type="bibr" rid="B25">25</xref>]. While very useful, these studies address a slightly different issue than the collapseRows function, improving probe annotations rather than combining similarly annotated probes. In fact, we expect that first downloading the appropriate data from AILUN and then running collapseRows would lead to an improvement in the robustness of one's results. Other software packages have sought to combine these steps to some degree. GeneCruiser, for example, allows users to find gene annotation, as well as display heat maps of data, view the location of probes in the genome using the UCSC Genome Browser, and perform keyword searches for probes [<xref ref-type="bibr" rid="B28">28</xref>], but it only includes Affymetrix data sets. Integrative Array Analyzer (iArray) allows the user to perform several between- and within-study analyses, including data processing, co-expression analyses, differential expression analyses, and graphical visualization [<xref ref-type="bibr" rid="B29">29</xref>], but requires genes from different array platforms to already be linked (i.e., collapsed) by gene name. In short, while all of these studies provide useful resources for gene expression analysis, the collapseRows function is involved in an important processing step for between-study analysis that, to the best of our knowledge, has not been systematically addressed elsewhere.</p><p>Although our study provides a key step in the comparison of multiple numeric matrices, particularly with regards to gene expression analysis, it also has several limitations. First, our empirical studies only involve the use of a weighted correlation networks for finding a representative hub gene, when in fact other association networks (e.g. based on mutual information) could be used. Fortunately, close relationships exist between the seemingly countless statistical and network based approaches for constructing networks. Along the same lines, we choose intramodular hub genes using the connectivity (sum of adjacencies), while in principle other centrality measures could be used. Third, our strategy 6.Avg only uses a straight average, whereas an equally valid approach would be to form a weighted average based on other statistical or biological information. Fortunately, through the use of the methodFunction parameter, these or any other collapsing functions could be used with collapseRows as required. Finally, it is important to note that group assignments should be carefully checked (for example, by using AILUN [<xref ref-type="bibr" rid="B24">24</xref>]) before running collapseRows, as this function does not test whether annotations are correct.</p></sec><sec><title>Conclusions</title><p>The collapseRows functions implements powerful and widely used methods for combining related variables. For example, collapseRows can be used to collapse probes to genes, to collapse genes to modules, or both. It can be used to choose an optimal cell marker gene. It can be used to aggregate dependent variables in such a way that computational memory requirements are greatly diminished. Our applications illustrate that the proposed collapsing strategies lead to robust, reliable results.</p></sec><sec sec-type="methods"><title>Methods</title><p>Abstractly speaking, we study methods for collapsing the rows of a numeric matrix. The word "collapse" reflects the fact that the method yields a new matrix whose rows correspond to a subset of rows from the original input data. The function collapseRows implements several biostatistical and network-based methods for finding a representative row or composite value for each group specified in <italic>rowGroup</italic>, which are described in detail below. One of the advantages of this function is that it implements the following default settings, which have worked well in numerous applications: first, each group is represented by the corresponding row with the fewest number of missing data. Often several rows have the same minimum number of missing values (for example, if there is no missing data) and a representative must be chosen among those rows; in this case, the function chooses the remaining row with the highest sample mean. In the rare case when multiple rows have the same mean, then the function randomly chooses a representative row.</p><sec><title>Using human and mouse brain data sets to assess reproducibility</title><p>All samples from the 18 human and 20 mouse brain data sets were taken from brain tissue and were all run on Affymetrix platforms. Given that we explore the same tissue (albeit from different species) we hypothesized that a subset of genes would show reproducible mean expression levels and network connectivity levels. For example, regardless of the experimental paradigm, there will be a subset of marker genes in neurons and glial cells that will be present, and this subset of genes should be reproducible. In a prior publication we confirmed that both mean expression and connectivity showed a significant amount of reproducibility in all of these data sets, even when comparing across species [<xref ref-type="bibr" rid="B3">3</xref>]. For example, the mean expression (Spearman correlation of R = 0.60, p &#x0003c; E-400) and connectivity (R = 0.27, p &#x0003c; E-70) was highly correlated between human and mouse brains. We and others have used the (Spearman) correlation to assess reproducibility of means and connectivities in pairs of data sets but we should point out that other measures are possible.</p></sec><sec><title>Biostatistical methods for collapsing rows</title><p>The collapseRows function implements several standard methods for collapsing rows into their respective groups. First, the row with the highest mean value ("MaxMean") can be selected for each group (the default). Similarly, the representative row with the lowest mean value ("MinMean"), or the one with the highest or lowest mean absolute value ("absMaxMean" and "absMinMean," respectively) can also be chosen. Further, one can also select rows according to their variance across observations ("maxRowVariance"). In addition, the function implements two composite value methods: 1) the group value can be summarized as the average value ("average") across rows in a group for each column, and 2) the group value can be summarized as the first principal component of the rows in each group (referred to as the "ME" method since, for co-expression module applications, this amounts to calculating the module eigengene). Finally, collapseRows allows the user to input their own user-defined aggregation function (by setting <italic>method </italic>= "function" and passing the desired function using <italic>methodFunction</italic>), which affords maximum flexibility.</p></sec><sec><title>Network methods for collapsing rows</title><p>Correlation network methods for collapsing variables are only meaningful when dealing with at least 3 variables (that have the same minimum number of missing values)--for groups with exactly two rows one of the above biostatistical methods is used for data aggregation ("MaxMean" by default). For groups of three or more rows, the collapseRows function constructs a signed weighted correlation network between the variables. A network is specified by the connection strengths, or <italic>adjacencies</italic>, defined for each pair of variables x<sub><italic>i </italic></sub>and x<sub><italic>j </italic></sub>and denoted by <italic>a</italic><sub><italic>ij</italic></sub>. A mathematical constraint on <italic>a</italic><sub><italic>ij </italic></sub>is that its values must lie between 0 and 1.</p><p>Weighted gene co-expression network analysis (WGCNA) [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B14">14</xref>] defines the signed weighted correlation network between <italic>x</italic><sub><italic>i </italic></sub>and <italic>x</italic><sub><italic>j </italic></sub>as:<disp-formula><graphic xlink:href="1471-2105-12-322-i1.gif"/></disp-formula></p><p>where the power &#x003b2; is used as a soft threshold [<xref ref-type="bibr" rid="B14">14</xref>]. The advantage of using a signed network is that it preserves the sign of the underlying correlation coefficient. Note that a correlation of -1 leads to an adjacency of 0, while a correlation of 1 leads to an adjacency of 1. Soft thresholding (using the power &#x003b2;) preserves the continuous nature of the correlation information; alternative approaches based on hard thresholding the correlation coefficient may lead to information loss. While any power &#x003b2; could be used, the default power of the collapseRows function is &#x003b2; = 1 since in many applications relatively few rows correspond to one group. In this case, there is less of a need to threshold the correlation measure.</p><p>The <italic>connectivity </italic>(<italic>k</italic>) of the <italic>i</italic>-th node is defined by:<disp-formula><graphic xlink:href="1471-2105-12-322-i2.gif"/></disp-formula></p><p>In weighted networks, the connectivity equals the sum of connection weights between node <italic>i </italic>and all other nodes in the network. Variables with high connectivity tend to be highly positively correlated with other variables. Connectivity based collapsing chooses the most highly connected row (highest k) as representative, and can be implemented with collapseRows by setting <italic>connectivityBasedCollapsing </italic>= TRUE. In this case, if several probes have the same maximum connectivity, the first such row is chosen.</p></sec><sec><title>Collapsing methods used in the empirical studies</title><p>For each of our examples, we ran a subset of the following six collapsing methods and studied how often each method leads to the most reproducible results. First, we choose the row with the highest mean expression (1.max) by setting <italic>method </italic>= "MaxMean" and <italic>connectivityBasedCollapsing </italic>= FALSE. Second, we choose the row with the highest between-column variability (2.var) by setting <italic>method </italic>= "maxRowVariance" and <italic>connectivityBasedCollapsing </italic>= FALSE. Third, we choose the row with the highest connectivity in cases with three or more rows per group or highest mean expression in cases with two rows per group (3.kMax) by setting <italic>method </italic>= "MaxMean" and <italic>connectivityBasedCollapsing </italic>= TRUE. Fourth, we choose the row with the highest connectivity in cases with three or more rows per group or maximum variability in cases with two rows per group (4.kVar) by setting <italic>method </italic>= "maxRowVariance" and <italic>connectivityBasedCollapsing </italic>= TRUE. Fifth, as a sort of control, we compare our results to a standard method of centroid determination by measuring the module eigengene (first principal component) for all rows in a given group across all groups (5.ME) by setting <italic>method </italic>= "ME". Finally, in our assessment of blood cell type, we also use the average of all marker genes (6.Avg) by setting <italic>method </italic>= "average".</p></sec></sec><sec><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec><title>Authors' contributions</title><p>JAM wrote the collapseRows function, carried out the analyses using the human and mouse brain data sets, and drafted the manuscript. CC carried out most of the analyses using human blood. PL tested the function in several settings and implemented it in the WGCNA package. DHG participated in the design of the human and mouse brain analyses, and provided critical input in the creation of the collapseRows function. DRS and SMK performed the sample collection, arrays, and flow cytometry analysis for the peripheral blood cell subset analysis and contributed to design and coordination of this aspect of the present study. SH participated in the design and coordination of the study, created initial R code for several aspects of the study, and helped to draft the manuscript. All authors read and approved the final manuscript.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="S1"><caption><title>Additional file 1</title><p><bold>the collapseRows function</bold>. This file contains the current version of collapseRows at the date of publication. The most current version of collapseRows is available as part of the WGCNA package [<xref ref-type="bibr" rid="B5">5</xref>].</p></caption><media xlink:href="1471-2105-12-322-S1.TXT" mimetype="text" mime-subtype="plain"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S2"><caption><title>Additional file 2</title><p><bold>R code to perform analysis</bold>. This file includes all of the code required to reproduce Figures <xref ref-type="fig" rid="F2">2</xref>, <xref ref-type="fig" rid="F3">3</xref>, <xref ref-type="fig" rid="F4">4</xref>, <xref ref-type="fig" rid="F5">5</xref> in this manuscript (and Additional file <xref ref-type="supplementary-material" rid="S3">3</xref> - Increase in reproducibility using collapseRows), along with a limited amount of annotation. Data for use with this code is available at the collapseRows website [<xref ref-type="bibr" rid="B6">6</xref>].</p></caption><media xlink:href="1471-2105-12-322-S2.PDF" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="S3"><caption><title>Additional file 3</title><p><bold>Increase in reproducibility using collapseRows</bold>. We calculated ranked expression (left column) and ranked connectivity (right column) correlation across 7 studies in human brain run on the HGu133A platform (A) and 8 studies in mouse brain run on the MGu430A platform (B). To assess change in reproducibility due to collapseRows, we compared these correlations using our best collapsing method (1.max) against uncollapsed data (0.None). We do not find any changes in reproducibility based on expression correlation; however, based on connectivity correlation we find a relatively substantial increase in reproducibility in both species. Note that these correlations are generally higher than the corresponding correlations from Figure <xref ref-type="fig" rid="F2">2</xref> because we only show the correlations from data sets coming from the same platform. Y-axes correspond to the average expression and connectivity correlation between data sets. Error bars represent standard error.</p></caption><media xlink:href="1471-2105-12-322-S3.PDF" mimetype="application" mime-subtype="pdf"><caption><p>Click here for file</p></caption></media></supplementary-material></sec></body><back><sec><title>Acknowledgements</title><p>The work was supported in part by National Research Service Award F31 AG031649 from the National Institute on Aging (NIA) and by funding from the Allen Institute for Brain Science (JAM), and by grants P50CA092131, U19 AI063603-07 (DRS, SMK), R01 AG26938-05 (to D.H.G), and P01 HL030568 (SH, PL, CC).</p></sec><ref-list><ref id="B1"><mixed-citation publication-type="journal"><name><surname>Langfelder</surname><given-names>P</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name><article-title>Eigengene networks for studying the relationships between co-expression modules</article-title><source>BMC systems biology</source><year>2007</year><volume>1</volume><issue>1</issue></mixed-citation></ref><ref id="B2"><mixed-citation publication-type="journal"><name><surname>Ge</surname><given-names>H</given-names></name><name><surname>Liu</surname><given-names>Z</given-names></name><name><surname>Church</surname><given-names>GM</given-names></name><name><surname>Vidal</surname><given-names>M</given-names></name><article-title>Correlation between transcriptome and interactome mapping data from Saccharomyces cerevisiae</article-title><source>Nature Genetics</source><year>2001</year><volume>29</volume><issue>4</issue><fpage>482</fpage><lpage>486</lpage><pub-id pub-id-type="doi">10.1038/ng776</pub-id><pub-id pub-id-type="pmid">11694880</pub-id></mixed-citation></ref><ref id="B3"><mixed-citation publication-type="journal"><name><surname>Miller</surname><given-names>J</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name><name><surname>Geschwind</surname><given-names>D</given-names></name><article-title>Divergence of human and mouse brain transcriptome highlights Alzheimer disease pathways</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>2010</year><volume>107</volume><issue>28</issue><fpage>12698</fpage><lpage>12703</lpage><pub-id pub-id-type="doi">10.1073/pnas.0914257107</pub-id><pub-id pub-id-type="pmid">20616000</pub-id></mixed-citation></ref><ref id="B4"><mixed-citation publication-type="journal"><name><surname>Oldham</surname><given-names>M</given-names></name><name><surname>Konopka</surname><given-names>G</given-names></name><name><surname>Iwamoto</surname><given-names>K</given-names></name><name><surname>Langfelder</surname><given-names>P</given-names></name><name><surname>Kato</surname><given-names>T</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name><name><surname>Geschwind</surname><given-names>D</given-names></name><article-title>Functional organization of the transcriptome in human brain</article-title><source>Nature Neuroscience</source><year>2008</year><volume>11</volume><issue>11</issue><fpage>1271</fpage><lpage>1282</lpage><pub-id pub-id-type="doi">10.1038/nn.2207</pub-id><pub-id pub-id-type="pmid">18849986</pub-id></mixed-citation></ref><ref id="B5"><mixed-citation publication-type="journal"><name><surname>Langfelder</surname><given-names>P</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name><article-title>WGCNA: an R package for weighted correlation network analysis</article-title><source>BMC Bioinformatics</source><year>2008</year><volume>9</volume><issue>1</issue></mixed-citation></ref><ref id="B6"><mixed-citation publication-type="other"><name><surname>Miller</surname><given-names>J</given-names></name><name><surname>Langfelder</surname><given-names>P</given-names></name><name><surname>Chaochao</surname><given-names>C</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name><article-title>The collapseRows function</article-title><ext-link ext-link-type="uri" xlink:href="http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/collapseRows">http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/collapseRows</ext-link></mixed-citation></ref><ref id="B7"><mixed-citation publication-type="journal"><name><surname>Abbas</surname><given-names>A</given-names></name><name><surname>Wolslegel</surname><given-names>K</given-names></name><name><surname>Seshasayee</surname><given-names>D</given-names></name><name><surname>Modrusan</surname><given-names>Z</given-names></name><name><surname>Clark</surname><given-names>H</given-names></name><article-title>Deconvolution of blood microarray data identifies cellular activation patterns in systemic lupus erythematosus</article-title><source>PloS one</source><year>2009</year><volume>4</volume><issue>7</issue><fpage>e6098</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0006098</pub-id><pub-id pub-id-type="pmid">19568420</pub-id></mixed-citation></ref><ref id="B8"><mixed-citation publication-type="journal"><name><surname>Dumeaux</surname><given-names>V</given-names></name><name><surname>Olsen</surname><given-names>K</given-names></name><name><surname>Nuel</surname><given-names>G</given-names></name><name><surname>Paulssen</surname><given-names>R</given-names></name><name><surname>Borresen-Dale</surname><given-names>AL</given-names></name><name><surname>Lund</surname><given-names>E</given-names></name><article-title>Deciphering normal blood gene expression variation--The NOWAC postgenome study</article-title><source>PLoS Genetics</source><year>2010</year><volume>6</volume><issue>3</issue></mixed-citation></ref><ref id="B9"><mixed-citation publication-type="journal"><name><surname>Goring</surname><given-names>H</given-names></name><name><surname>Curran</surname><given-names>J</given-names></name><name><surname>Johnson</surname><given-names>M</given-names></name><name><surname>Dyer</surname><given-names>T</given-names></name><name><surname>Charlesworth</surname><given-names>J</given-names></name><name><surname>Cole</surname><given-names>S</given-names></name><name><surname>Jowett</surname><given-names>J</given-names></name><name><surname>Abraham</surname><given-names>L</given-names></name><name><surname>Rainwater</surname><given-names>D</given-names></name><name><surname>Comuzzie</surname><given-names>A</given-names></name><etal/><article-title>Discovery of expression QTLs using large-scale transcriptional profiling in human lymphocytes</article-title><source>Nature Genetics</source><year>2007</year><volume>39</volume><issue>10</issue><fpage>1208</fpage><lpage>1216</lpage><pub-id pub-id-type="doi">10.1038/ng2119</pub-id><pub-id pub-id-type="pmid">17873875</pub-id></mixed-citation></ref><ref id="B10"><mixed-citation publication-type="journal"><name><surname>Grigoryev</surname><given-names>Y</given-names></name><name><surname>Kurian</surname><given-names>S</given-names></name><name><surname>Avnur</surname><given-names>Z</given-names></name><name><surname>Borie</surname><given-names>D</given-names></name><name><surname>Deng</surname><given-names>J</given-names></name><name><surname>Campbell</surname><given-names>D</given-names></name><name><surname>Sung</surname><given-names>J</given-names></name><name><surname>Nikolcheva</surname><given-names>T</given-names></name><name><surname>Quinn</surname><given-names>A</given-names></name><name><surname>Schulman</surname><given-names>H</given-names></name><etal/><article-title>Deconvoluting post-transplant immunity: cell subset-specific mapping reveals pathways for activation and expansion of memory T, monocytes and B cells</article-title><source>PloS one</source><year>2010</year><volume>5</volume><issue>10</issue><fpage>e13358</fpage><pub-id pub-id-type="doi">10.1371/journal.pone.0013358</pub-id><pub-id pub-id-type="pmid">20976225</pub-id></mixed-citation></ref><ref id="B11"><mixed-citation publication-type="journal"><name><surname>Pankla</surname><given-names>R</given-names></name><name><surname>Buddhisa</surname><given-names>S</given-names></name><name><surname>Berry</surname><given-names>M</given-names></name><name><surname>Blankenship</surname><given-names>D</given-names></name><name><surname>Bancroft</surname><given-names>G</given-names></name><name><surname>Banchereau</surname><given-names>J</given-names></name><name><surname>Lertmemongkolchai</surname><given-names>G</given-names></name><name><surname>Chaussabel</surname><given-names>D</given-names></name><article-title>Genomic transcriptional profiling identifies a candidate blood biomarker signature for the diagnosis of septicemic melioidosis</article-title><source>Genome Biology</source><year>2009</year><volume>10</volume><issue>11</issue></mixed-citation></ref><ref id="B12"><mixed-citation publication-type="journal"><name><surname>Saris</surname><given-names>C</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name><name><surname>van Vught</surname><given-names>P</given-names></name><name><surname>van Es</surname><given-names>M</given-names></name><name><surname>Blauw</surname><given-names>H</given-names></name><name><surname>Fuller</surname><given-names>T</given-names></name><name><surname>Langfelder</surname><given-names>P</given-names></name><name><surname>DeYoung</surname><given-names>J</given-names></name><name><surname>Wokke</surname><given-names>J</given-names></name><name><surname>Veldink</surname><given-names>J</given-names></name><etal/><article-title>Weighted gene co-expression network analysis of the peripheral blood from Amyotrophic Lateral Sclerosis patients</article-title><source>BMC Genomics</source><year>2009</year><volume>10</volume><issue>1</issue><fpage>405</fpage><pub-id pub-id-type="doi">10.1186/1471-2164-10-405</pub-id><pub-id pub-id-type="pmid">19712483</pub-id></mixed-citation></ref><ref id="B13"><mixed-citation publication-type="journal"><name><surname>Horvath</surname><given-names>S</given-names></name><name><surname>Dong</surname><given-names>J</given-names></name><article-title>Geometric interpretation of gene coexpression network analysis</article-title><source>PLoS computational biology</source><year>2008</year><volume>4</volume><issue>8</issue><fpage>e1000117</fpage><pub-id pub-id-type="doi">10.1371/journal.pcbi.1000117</pub-id><pub-id pub-id-type="pmid">18704157</pub-id></mixed-citation></ref><ref id="B14"><mixed-citation publication-type="journal"><name><surname>Oldham</surname><given-names>MC</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name><name><surname>Geschwind</surname><given-names>DH</given-names></name><article-title>Conservation and evolution of gene coexpression networks in human and chimpanzee brains</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>2006</year><volume>104</volume><issue>45</issue><fpage>17849</fpage><lpage>17854</lpage></mixed-citation></ref><ref id="B15"><mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name><article-title>A general framework for weighted gene co-expression network analysis</article-title><source>Stat Appl Genet Mol Biol</source><year>2005</year><volume>4</volume><issue>1</issue></mixed-citation></ref><ref id="B16"><mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>L</given-names></name><name><surname>Tang</surname><given-names>H</given-names></name><name><surname>Thayanithy</surname><given-names>V</given-names></name><name><surname>Subramanian</surname><given-names>S</given-names></name><name><surname>Oberg</surname><given-names>A</given-names></name><name><surname>Cunningham</surname><given-names>J</given-names></name><name><surname>Cerhan</surname><given-names>J</given-names></name><name><surname>Steer</surname><given-names>C</given-names></name><name><surname>Thibodeau</surname><given-names>SN</given-names></name><article-title>Gene Networks and microRNAs Implicated in Aggressive Prostate Cancer</article-title><source>Cancer Research</source><year>2009</year><volume>69</volume><issue>24</issue><fpage>9490</fpage><lpage>9497</lpage><pub-id pub-id-type="doi">10.1158/0008-5472.CAN-09-2183</pub-id><pub-id pub-id-type="pmid">19996289</pub-id></mixed-citation></ref><ref id="B17"><mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>S</given-names></name><name><surname>Kosorok</surname><given-names>M</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name><name><surname>Dai</surname><given-names>Y</given-names></name><article-title>Incorporating higher-order representative features improves prediction in network-based cancer prognosis analysis</article-title><source>BMC Med Genomics</source><year>2011</year><volume>4</volume><issue>5</issue></mixed-citation></ref><ref id="B18"><mixed-citation publication-type="journal"><name><surname>Ivliev</surname><given-names>A</given-names></name><name><surname>'t Hoen</surname><given-names>P</given-names></name><name><surname>Sergeeva</surname><given-names>M</given-names></name><article-title>Coexpression network analysis identifies transcriptional modules related to proastrocytic differentiation and sprouty signaling in glioma</article-title><source>Cancer Research</source><year>2010</year><volume>70</volume><issue>24</issue><fpage>10060</fpage><lpage>10070</lpage><pub-id pub-id-type="doi">10.1158/0008-5472.CAN-10-2465</pub-id><pub-id pub-id-type="pmid">21159630</pub-id></mixed-citation></ref><ref id="B19"><mixed-citation publication-type="journal"><name><surname>Weston</surname><given-names>D</given-names></name><name><surname>Gunter</surname><given-names>L</given-names></name><name><surname>Rogers</surname><given-names>A</given-names></name><name><surname>Wullschleger</surname><given-names>S</given-names></name><article-title>Connecting Genes, Coexpression Modules, and Molecular Signatures to Environmental Stress Phenotypes in Plants</article-title><source>BMC Systems Biology</source><year>2008</year><volume>2</volume><issue>16</issue></mixed-citation></ref><ref id="B20"><mixed-citation publication-type="journal"><name><surname>Langfelder</surname><given-names>P</given-names></name><name><surname>Zhang</surname><given-names>B</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name><article-title>Defining clusters from a hierarchical cluster tree: the Dynamic Tree Cut package for R</article-title><source>Bioinformatics (Oxford, England)</source><year>2008</year><volume>24</volume><issue>5</issue><fpage>719</fpage><lpage>720</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btm563</pub-id></mixed-citation></ref><ref id="B21"><mixed-citation publication-type="journal"><name><surname>Clarke</surname><given-names>J</given-names></name><name><surname>Seo</surname><given-names>P</given-names></name><name><surname>Clarke</surname><given-names>B</given-names></name><article-title>Statistical expression deconvolution from mixed tissue samples</article-title><source>Bioinformatics (Oxford, England)</source><year>2010</year><volume>26</volume><issue>8</issue><fpage>1043</fpage><lpage>1049</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq097</pub-id></mixed-citation></ref><ref id="B22"><mixed-citation publication-type="journal"><name><surname>Lu</surname><given-names>P</given-names></name><name><surname>Nakorchevskiy</surname><given-names>A</given-names></name><name><surname>Marcotte</surname><given-names>E</given-names></name><article-title>Expression deconvolution: a reinterpretation of DNA microarray data reveals dynamic changes in cell populations</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>2003</year><volume>100</volume><issue>18</issue><fpage>10370</fpage><lpage>10375</lpage><pub-id pub-id-type="doi">10.1073/pnas.1832361100</pub-id><pub-id pub-id-type="pmid">12934019</pub-id></mixed-citation></ref><ref id="B23"><mixed-citation publication-type="journal"><name><surname>Stuart</surname><given-names>R</given-names></name><name><surname>Wachsman</surname><given-names>W</given-names></name><name><surname>Berry</surname><given-names>C</given-names></name><name><surname>Wang-Rodriguez</surname><given-names>J</given-names></name><name><surname>Wasserman</surname><given-names>L</given-names></name><name><surname>Klacansky</surname><given-names>I</given-names></name><name><surname>Masys</surname><given-names>D</given-names></name><name><surname>Arden</surname><given-names>K</given-names></name><name><surname>Goodison</surname><given-names>S</given-names></name><name><surname>McClelland</surname><given-names>M</given-names></name><etal/><article-title>In silico dissection of cell-type-associated patterns of gene expression in prostate cancer</article-title><source>Proceedings of the National Academy of Sciences of the United States of America</source><year>2004</year><volume>101</volume><issue>2</issue><fpage>615</fpage><lpage>620</lpage><pub-id pub-id-type="doi">10.1073/pnas.2536479100</pub-id><pub-id pub-id-type="pmid">14722351</pub-id></mixed-citation></ref><ref id="B24"><mixed-citation publication-type="journal"><name><surname>Ballester</surname><given-names>B</given-names></name><name><surname>Johnson</surname><given-names>N</given-names></name><name><surname>Proctor</surname><given-names>G</given-names></name><name><surname>Flicek</surname><given-names>P</given-names></name><article-title>Consistent annotation of gene expression arrays</article-title><source>BMC Genomics</source><year>2010</year><volume>11</volume><issue>1</issue><fpage>294</fpage><pub-id pub-id-type="doi">10.1186/1471-2164-11-294</pub-id><pub-id pub-id-type="pmid">20459806</pub-id></mixed-citation></ref><ref id="B25"><mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>L</given-names></name><name><surname>Butte</surname><given-names>A</given-names></name><article-title>AILUN: reannotating gene expression data automatically</article-title><source>Nature methods</source><year>2007</year><volume>4</volume><issue>11</issue><fpage>879</fpage><lpage>879</lpage><pub-id pub-id-type="doi">10.1038/nmeth1107-879</pub-id><pub-id pub-id-type="pmid">17971777</pub-id></mixed-citation></ref><ref id="B26"><mixed-citation publication-type="journal"><name><surname>Dai</surname><given-names>M</given-names></name><name><surname>Wang</surname><given-names>P</given-names></name><name><surname>Boyd</surname><given-names>A</given-names></name><name><surname>Kostov</surname><given-names>G</given-names></name><name><surname>Athey</surname><given-names>B</given-names></name><name><surname>Jones</surname><given-names>E</given-names></name><name><surname>Bunney</surname><given-names>W</given-names></name><name><surname>Myers</surname><given-names>R</given-names></name><name><surname>Speed</surname><given-names>T</given-names></name><name><surname>Akil</surname><given-names>H</given-names></name><etal/><article-title>Evolving gene/transcript definitions significantly alter the interpretation of GeneChip data</article-title><source>Nucl Acids Res</source><year>2005</year><volume>33</volume><issue>20</issue><fpage>e175</fpage><lpage>e175</lpage><pub-id pub-id-type="doi">10.1093/nar/gni179</pub-id><pub-id pub-id-type="pmid">16284200</pub-id></mixed-citation></ref><ref id="B27"><mixed-citation publication-type="journal"><name><surname>Tsai</surname><given-names>J</given-names></name><name><surname>Sultana</surname><given-names>R</given-names></name><name><surname>Lee</surname><given-names>Y</given-names></name><name><surname>Pertea</surname><given-names>G</given-names></name><name><surname>Karamycheva</surname><given-names>S</given-names></name><name><surname>Antonescu</surname><given-names>V</given-names></name><name><surname>Cho</surname><given-names>J</given-names></name><name><surname>Parvizi</surname><given-names>B</given-names></name><name><surname>Cheung</surname><given-names>F</given-names></name><name><surname>Quackenbush</surname><given-names>J</given-names></name><article-title>RESOURCERER: a database for annotating and linking microarray resources within and across species</article-title><source>Genome Biology</source><year>2001</year><volume>2</volume><issue>11</issue></mixed-citation></ref><ref id="B28"><mixed-citation publication-type="journal"><name><surname>Liefeld</surname><given-names>T</given-names></name><name><surname>Reich</surname><given-names>M</given-names></name><name><surname>Gould</surname><given-names>J</given-names></name><name><surname>Zhang</surname><given-names>P</given-names></name><name><surname>Tamayo</surname><given-names>P</given-names></name><name><surname>Mesirov</surname><given-names>J</given-names></name><article-title>GeneCruiser: a web service for the annotation of microarray data</article-title><source>Bioinformatics (Oxford, England)</source><year>2005</year><volume>21</volume><issue>18</issue><fpage>3681</fpage><lpage>3682</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bti587</pub-id></mixed-citation></ref><ref id="B29"><mixed-citation publication-type="journal"><name><surname>Pan</surname><given-names>F</given-names></name><name><surname>Kamath</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>K</given-names></name><name><surname>Pulapura</surname><given-names>S</given-names></name><name><surname>Achar</surname><given-names>A</given-names></name><name><surname>Nunez-Iglesias</surname><given-names>J</given-names></name><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Yan</surname><given-names>X</given-names></name><name><surname>Han</surname><given-names>J</given-names></name><name><surname>Hu</surname><given-names>H</given-names></name><etal/><article-title>Integrative Array Analyzer: a software package for analysis of cross-platform and cross-species microarray data</article-title><source>Bioinformatics (Oxford, England)</source><year>2006</year><volume>22</volume><issue>13</issue><fpage>1665</fpage><lpage>1667</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btl163</pub-id></mixed-citation></ref></ref-list></back></article>