<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v3.0 20080202//EN" "archivearticle3.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">2894513</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btq269</article-id><article-id pub-id-type="publisher-id">btq269</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Papers</subject><subj-group><subject>Genome Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>Iterative Correction of Reference Nucleotides (iCORN) using second generation sequencing technology</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Otto</surname><given-names>Thomas D.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="COR1"><sup>*</sup></xref></contrib><contrib contrib-type="author"><name><surname>Sanders</surname><given-names>Mandy</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Berriman</surname><given-names>Matthew</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Newbold</surname><given-names>Chris</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref><xref ref-type="corresp" rid="COR1"><sup>*</sup></xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup> Parasite Genomics, Wellcome Trust Sanger Institute, Wellcome Trust Genome Campus, Cambridge, CB10 1SA and <sup>2</sup> Weatherall Institute of Molecular Medicine, University of Oxford, John Radcliffe Hospital, Oxford, OX3 9DS, UK</aff><author-notes><corresp id="COR1">* To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Alfonso Valencia</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>7</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>18</day><month>6</month><year>2010</year></pub-date><pub-date pub-type="pmc-release"><day>18</day><month>6</month><year>2010</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the							<pub-date pub-type="epub"/>. --><volume>26</volume><issue>14</issue><fpage>1704</fpage><lpage>1707</lpage><history><date date-type="received"><day>8</day><month>1</month><year>2010</year></date><date date-type="rev-recd"><day>23</day><month>4</month><year>2010</year></date><date date-type="accepted"><day>19</day><month>5</month><year>2010</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2010. Published by Oxford University Press.</copyright-statement><copyright-year>2010</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p><bold>Motivation:</bold> The accuracy of reference genomes is important for downstream analysis but a low error rate requires expensive manual interrogation of the sequence. Here, we describe a novel algorithm (Iterative Correction of Reference Nucleotides) that iteratively aligns deep coverage of short sequencing reads to correct errors in reference genome sequences and evaluate their accuracy.</p><p><bold>Results:</bold> Using <italic>Plasmodium falciparum</italic> (81% A + T content) as an extreme example, we show that the algorithm is highly accurate and corrects over 2000 errors in the reference sequence. We give examples of its application to numerous other eukaryotic and prokaryotic genomes and suggest additional applications.</p><p><bold>Availability:</bold> The software is available at <ext-link ext-link-type="uri" xlink:href="http://icorn.sourceforge.net">http://icorn.sourceforge.net</ext-link></p><p><bold>Contact:</bold> <email>tdo@sanger.ac.uk</email>; <email>cnewbold@hammer.imm.ox.ac.uk</email></p><p><bold>Supplementary information:</bold> <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq269/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>Although there are now over 5000 whole genome sequences in the public databases, their level of accuracy varies considerably. The aspiration set by the Human Genome Project was for a maximum of one error per 10 kb of finished sequence (International Human Genome Sequencing Consortium, <xref ref-type="bibr" rid="B7">2001</xref>). However, the true error rate varies significantly from this figure depending on the nature of the sequence (base composition, repeats, etc.) both in human and in other organisms. Even to achieve this error rate, expensive manual finishing is required to ensure that each base is covered by at least 2 clones and has a cumulative Phred score of at least 40 (Ewing and Green, <xref ref-type="bibr" rid="B4">1998</xref>). The &#x02018;Gold Standard&#x02019; for quality involves the manual inspection of each base by an experienced finisher. This is a major expense within a genome project. For example, nine chromosomes of <italic>Plasmodium falciparum</italic> were completed at the Wellcome Trust Sanger Institute (Hall <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2002</xref>), by the equivalent of approximately seven finishers working for up to 5 years. Despite this and subsequent efforts since publication, as we show here, many errors are still present. Even in genomes described as completed or finished, the underlying quality at each base is unknown and the error rate can be variable genome-wide. Therefore, rapidly fixing errors, highlighting regions that are error-prone and quantifying accuracy genome-wide is a priority that will significantly benefit the end user.</p><p>So far, few methods exist to correct genomic errors automatically. There are algorithms to improve base calling (Gajer <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2004</xref>) or to detect frameshifts by protein homology or by sequence analysis. New assembly software like Mira (<ext-link ext-link-type="uri" xlink:href="http://www.chevreux.org/projects_mira.html">http://www.chevreux.org/projects_mira.html</ext-link>) has also been developed that allows hybrid assemblies with different sequencing technologies. This can both assemble mixed Sanger/454 data and improve the homopolymer length errors in 454 technologies using high Illumina read coverage. To date, however, no methods exist that can accurately detect and correct base errors and small indels in genome sequences.</p><p>We have developed an algorithm that uses deep coverage of sequence reads produced using Illumina's Genome Analyser platform, mapped iteratively to a reference genome, in a way that allows confident sequence correction.</p></sec><sec sec-type="methods" id="SEC2"><title>2 METHODS</title><p>Due to their short length, mapping reads from second generation sequencing platforms is highly susceptible to single base errors or small indels. Small corrections made to a reference can, therefore, improve the mapability of short reads and, conversely, introducing small errors in a reference will markedly reduce mapability. We have made use of this fact in developing a new methodology to automatically correct base errors and short insertions or deletions (indels) of up to 3 bp. In an iterative process, short reads are mapped against the genome and high-quality discrepancies and indels are identified and corrected. In each iteration, we compare the coverage of perfectly mapping reads at each corrected base before and after correction. Corrections that reduce the read coverage at that position are rejected. In this way, we evaluate whether each potential correction is accurate or not. We repeat the iterations until no new corrections are called.</p><sec id="SEC2.1"><title>2.1 Data</title><p>For the <italic>P.falciparum</italic> reference sequence, we used 3D7 version 2.1.4 (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.sanger.ac.uk/pub/pathogens/Plasmodium/falciparum/3D7/3D7.version2.1.4/">ftp://ftp.sanger.ac.uk/pub/pathogens/Plasmodium/falciparum/3D7/3D7.version2.1.4/</ext-link>). All Illumina data were produced within the Sanger sequencing facility. The protocol to obtain PCR-free data is described in Kozarewa <italic>et al.</italic> (<xref ref-type="bibr" rid="B8">2009</xref>). Preparation of other samples can be seen in Quail <italic>et al.</italic> (<xref ref-type="bibr" rid="B12">2008</xref>).</p></sec><sec id="SEC2.2"><title>2.2 Iterative Correction of Reference Nucleotides Implementation</title><p>An overview of Iterative Correction of Reference Nucleotides (iCORN) is given in <xref ref-type="fig" rid="F1">Figure 1</xref>. The program itself is hosted at <ext-link ext-link-type="uri" xlink:href="http://icorn.sourceforge.net/">http://icorn.sourceforge.net/</ext-link>. Short reads are first mapped with SSAHA2 (Ning <italic>et al.</italic>, <xref ref-type="bibr" rid="B11">2001</xref>) against the genome sequence that is to be corrected (although another mapping algorithm could be used, e.g. Li <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2008</xref>). Standard Illumina mapping values are used with the &#x02018;paired&#x02019; option when reads are paired. Read pairs that do not map within the correct insert size constraint, map to different chromosomes or are in the wrong orientation, are ignored. Using the SSAHA pileup pipeline (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp.sanger.ac.uk/pub/zn1/ssaha_pileup/">ftp://ftp.sanger.ac.uk/pub/zn1/ssaha_pileup/</ext-link>), single nucleotide polymorphisms (SNPs) and short indels (1&#x02013;3 bp) are called from the remaining read pairs. Note that, each &#x02018;SNP&#x02019; or &#x02018;indel&#x02019; called by the software refers to potential sequencing errors or sample heterogeneity. A SNP is accepted if it has a SSAHA SNP quality of at least 60. Short indels are called if they occur in at least 30% of the reads with a minimum read coverage of at least 5. These parameters are the standard values but can be changed. The called SNP and indel errors are corrected in the genome sequence and saved as a new version.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Flow chart of iCORN.</p></caption><graphic xlink:href="btq269f1"/></fig>
</p><p>To evaluate the corrections, the coverage of each base before correction is compared to that after correction using SNP-o-matic (Manske and Kwiatkowski, <xref ref-type="bibr" rid="B10">2009</xref>) that only maps reads mapping perfectly over their whole length. If read coverage of a corrected base goes down, the change is rejected and the original sequence is restored. If there is no change in coverage, we assume that this region may have additional errors and accept the correction.</p><p>The procedure is repeated, using the newly corrected genome sequence as the reference and continues to iterate until no new errors can be found. The algorithm returns all changes, including coverage statistics, in GFF format [visible with Artemis (Carver <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2008</xref>)] or as Gap4 feature file.</p></sec></sec><sec sec-type="results" id="SEC3"><title>3 RESULTS</title><p>To calibrate the SSAHA2 alignment score threshold to detect real base errors but minimize false positives, all calls on a single chromosome at different calling thresholds were manually inspected by an experienced professional finisher. This involved interrogating the capillary reads and their quality scores in a GAP4 database. Using a SSAHA SNP score of 60 (reflecting a base coverage of &#x02265;20) resulted in all of the corrections being confirmed. This score was subsequently adopted for future analyses.</p><p>We first applied our algorithm to the genome sequence of <italic>P.falciparum</italic>: a reference sequence whose low complexity results from an extremely biased base composition (19% G+C content) and presents a challenge to short read alignment algorithms due to its exceptionally low information content. For the analysis, we used 28 million 36 bp paired-end and 20 million 76 bp paired-end Illumina reads. The mean coverage obtained by mapping read pairs with the correct fragment size was 82.9&#x000d7; and we used a minimum coverage of 20-fold to call changes (see <xref ref-type="sec" rid="SEC2">Section 2</xref>). An example of a corrected region can be seen in <xref ref-type="fig" rid="F2">Figure 2</xref>. The coverage plots show that the amount of mapping reads and perfectly mapping reads increase with each iteration.
<fig id="F2" position="float"><label>Fig. 2.</label><caption><p>Example of correction of a region of chromosome one of <italic>P.falciparum</italic> 3D7. The upper plot shows the coverage per iteration of the SSAHA mapping. The lower plot represent the coverage of the perfect mapping reads SNP-o-matic (<ext-link ext-link-type="uri" xlink:href="http://snpomatic.sourceforge.net/">http://snpomatic.sourceforge.net/</ext-link>). The vertical bars show the positions of the corrections. The actual corrections made at each iteration are shown in the multiple sequence alignment below.</p></caption><graphic xlink:href="btq269f2"/></fig>
</p><p>After 6 iterations, no new corrections were called. We found a total of 1906 base errors and 368 indels. In the first iteration, 81% of the base errors were corrected. After the corrections, the coverage of 84 827 more bases pairs increased to at least 5 and 87 952 additional reads were perfectly mapped. For most chromosomes, the single base error detection drops to zero after the fifth iteration (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq269/DC1">Supplementary Table S1</ext-link>). Intitially, we found 208 sites (SNP score &#x02265;60) that appear to be heterozygous in this haploid organism, using a cutoff of 15% of calls of an alternative base. Visual inspection of the areas in which these heterozygous calls occurred, however, revealed that the majority (75%) were roughly symmetrically distributed around homopolymeric tracts. The remainder appears to be strand specific as they only occur in one read direction and are clustered in general in sequences that are rich in T and G bases. These calls were not present in the original capillary sequence data and we believe them to be hitherto unreported systematic errors occurring during Illumina sequencing (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq269/DC1">Supplementary Fig. S1</ext-link>).</p><p>Ninety-six percent of the genome is covered by a read depth of &#x02265;20, so that we were unable at this level of confidence to correct the remaining 4% of the genome. These regions are mostly telomeric and non-unique.</p><p>To test the accuracy of our algorithm, we randomly introduced approximately one error per 50 kb into the 3D7 sequence 2.1.4, inserting a total of 457 errors and used the Illumina reads to correct this altered genome using iCORN. In the first iteration, 435 (96%) of the errors were found (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq269/DC1">Supplementary Table S2</ext-link>). As the errors were generated randomly, they were not clustered and could be found quickly. The random distribution also explains that 4% of the introduced errors cannot be found, as 4% of the genome is not covered sufficiently to be corrected, (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq269/DC1">Supplementary Table S1</ext-link>).</p><p>We further evaluated the performance of iCORN by manually inspecting the capillary chromatograms of called errors in chromosomes 5, 9 and 14. Of 174 corrected errors, 1 was rejected. This region comprised a string of 45 As with a G in the middle and was re-sequenced following polymerase chain reaction (PCR) amplification. This confirmed the presence of the G that had been erroneously corrected by iCORN to an A. We suspect that this may be due to the fact that polyA sequences are over represented in Illumina data because of occasional edge effects on the slide. Finally, we designed an additional 96 PCR products over regions with correction. Eighty-eight out of 96 PCR reactions were successful and in no case did the PCR product sequence disagree with the changes called by iCORN.</p><p>We next went on to assess the utility of this approach to correct the homopolymer errors that can occur using 454 technology (Droege and Hill, <xref ref-type="bibr" rid="B2">2008</xref>). We applied it to a 454 assembly of 310 242 reads (fragment size 3 kb) from <italic>P.berghei</italic>. The contigs from the assembly were corrected with &#x0223c;50 million 76 bp PCR-free paired-end Illumina reads. After 6 iterations, 25 976 SNPs and 33 860 indels were called (<xref ref-type="table" rid="T1">Table 1</xref>). <xref ref-type="fig" rid="F3">Figure 3</xref>A shows a typical example where multiple frameshifts due to homopolymer errors are corrected after just two iterations. <xref ref-type="fig" rid="F3">Figure 3</xref>B shows similar data from the correction of a 454 assembly of <italic>Clostridium difficile</italic> using deep Illumina coverage. In both cases more indels than SNPs are called due to homopolymer errors.
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Application of iCORN to prokaryotic and eukaryotic genome projects in various stages of completion</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th align="left" rowspan="1" colspan="1">Organism</th><th align="left" rowspan="1" colspan="1">Sequence quality</th><th align="left" rowspan="1" colspan="1">Sequencing method</th><th align="left" rowspan="1" colspan="1">Genome size (Mb)</th><th align="left" rowspan="1" colspan="1">SNPs</th><th align="left" rowspan="1" colspan="1">Indels</th><th align="left" rowspan="1" colspan="1">Number rejected</th><th align="left" colspan="2" rowspan="1">Genome covered<hr/></th><th align="left" rowspan="1" colspan="1">New mappable reads</th><th align="left" rowspan="1" colspan="1">Iterations</th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/><th align="left" rowspan="1" colspan="1">Before (%)</th><th align="left" rowspan="1" colspan="1">After (%)</th><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"/></tr></thead><tbody align="left"><tr><td align="left" rowspan="1" colspan="1"><italic>Plasmodium falciparum</italic> 3D7</td><td align="left" rowspan="1" colspan="1">A</td><td align="left" rowspan="1" colspan="1">Capillary</td><td align="left" rowspan="1" colspan="1">23</td><td align="left" rowspan="1" colspan="1">1906</td><td align="left" rowspan="1" colspan="1">368</td><td align="left" rowspan="1" colspan="1">30</td><td align="left" rowspan="1" colspan="1">97.20</td><td align="left" rowspan="1" colspan="1">97.56</td><td align="left" rowspan="1" colspan="1">24 698</td><td align="left" rowspan="1" colspan="1">6</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>Echinococcus multilocularis</italic></td><td align="left" rowspan="1" colspan="1">B</td><td align="left" rowspan="1" colspan="1">Capillary</td><td align="left" rowspan="1" colspan="1">110</td><td align="left" rowspan="1" colspan="1">5508</td><td align="left" rowspan="1" colspan="1">2520</td><td align="left" rowspan="1" colspan="1">2140</td><td align="left" rowspan="1" colspan="1">48.89</td><td align="left" rowspan="1" colspan="1">49.11</td><td align="left" rowspan="1" colspan="1">1 023 315</td><td align="left" rowspan="1" colspan="1">5</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>Leishmania major</italic></td><td align="left" rowspan="1" colspan="1">B</td><td align="left" rowspan="1" colspan="1">Capillary</td><td align="left" rowspan="1" colspan="1">33</td><td align="left" rowspan="1" colspan="1">594</td><td align="left" rowspan="1" colspan="1">1061</td><td align="left" rowspan="1" colspan="1">122</td><td align="left" rowspan="1" colspan="1">98.52</td><td align="left" rowspan="1" colspan="1">98.62</td><td align="left" rowspan="1" colspan="1">313</td><td align="left" rowspan="1" colspan="1">6</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>Leishmania infantum</italic></td><td align="left" rowspan="1" colspan="1">B</td><td align="left" rowspan="1" colspan="1">Capillary</td><td align="left" rowspan="1" colspan="1">32</td><td align="left" rowspan="1" colspan="1">2770</td><td align="left" rowspan="1" colspan="1">1878</td><td align="left" rowspan="1" colspan="1">320</td><td align="left" rowspan="1" colspan="1">89.26</td><td align="left" rowspan="1" colspan="1">89.72</td><td align="left" rowspan="1" colspan="1">5629</td><td align="left" rowspan="1" colspan="1">8</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>Plasmodium ovale</italic></td><td align="left" rowspan="1" colspan="1">B</td><td align="left" rowspan="1" colspan="1">Capillary</td><td align="left" rowspan="1" colspan="1">21</td><td align="left" rowspan="1" colspan="1">1431</td><td align="left" rowspan="1" colspan="1">238</td><td align="left" rowspan="1" colspan="1">1081</td><td align="left" rowspan="1" colspan="1">91.27</td><td align="left" rowspan="1" colspan="1">91.42</td><td align="left" rowspan="1" colspan="1">6368</td><td align="left" rowspan="1" colspan="1">4</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>Plasmodium berghei</italic></td><td align="left" rowspan="1" colspan="1">B</td><td align="left" rowspan="1" colspan="1">454</td><td align="left" rowspan="1" colspan="1">18</td><td align="left" rowspan="1" colspan="1">25 976</td><td align="left" rowspan="1" colspan="1">33 860</td><td align="left" rowspan="1" colspan="1">5639</td><td align="left" rowspan="1" colspan="1">88.65</td><td align="left" rowspan="1" colspan="1">95.38</td><td align="left" rowspan="1" colspan="1">140 788</td><td align="left" rowspan="1" colspan="1">7</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>Plasmodium berghei</italic></td><td align="left" rowspan="1" colspan="1">B</td><td align="left" rowspan="1" colspan="1">Capillary</td><td align="left" rowspan="1" colspan="1">22</td><td align="left" rowspan="1" colspan="1">1901</td><td align="left" rowspan="1" colspan="1">3818</td><td align="left" rowspan="1" colspan="1">538</td><td align="left" rowspan="1" colspan="1">97.18</td><td align="left" rowspan="1" colspan="1">97.48</td><td align="left" rowspan="1" colspan="1">23 805</td><td align="left" rowspan="1" colspan="1">7</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>Chlaymiadia trachomatis</italic></td><td align="left" rowspan="1" colspan="1">B</td><td align="left" rowspan="1" colspan="1">Capillary</td><td align="left" rowspan="1" colspan="1">1.0</td><td align="left" rowspan="1" colspan="1">487</td><td align="left" rowspan="1" colspan="1">16</td><td align="left" rowspan="1" colspan="1">18</td><td align="left" rowspan="1" colspan="1">99.86</td><td align="left" rowspan="1" colspan="1">99.997</td><td align="left" rowspan="1" colspan="1">9734</td><td align="left" rowspan="1" colspan="1">4</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>Clostridium difficile</italic></td><td align="left" rowspan="1" colspan="1">B</td><td align="left" rowspan="1" colspan="1">454</td><td align="left" rowspan="1" colspan="1">4.1</td><td align="left" rowspan="1" colspan="1">61</td><td align="left" rowspan="1" colspan="1">1652</td><td align="left" rowspan="1" colspan="1">32</td><td align="left" rowspan="1" colspan="1">99.30</td><td align="left" rowspan="1" colspan="1">99.43</td><td align="left" rowspan="1" colspan="1">1708</td><td align="left" rowspan="1" colspan="1">6</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>Streptococcus pneumoniae</italic></td><td align="left" rowspan="1" colspan="1">B</td><td align="left" rowspan="1" colspan="1">RNAseq</td><td align="left" rowspan="1" colspan="1">2.0</td><td align="left" rowspan="1" colspan="1">13</td><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">64.23</td><td align="left" rowspan="1" colspan="1">64.23</td><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1">3</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>Streptococcus suis</italic> BM402</td><td align="left" rowspan="1" colspan="1">A</td><td align="left" rowspan="1" colspan="1">Capillary</td><td align="left" rowspan="1" colspan="1">2.1</td><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">98.84</td><td align="left" rowspan="1" colspan="1">98.85</td><td align="left" rowspan="1" colspan="1">15</td><td align="left" rowspan="1" colspan="1">2</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>Streptococcus suis</italic> P1_7</td><td align="left" rowspan="1" colspan="1">A</td><td align="left" rowspan="1" colspan="1">Capillary</td><td align="left" rowspan="1" colspan="1">2.0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="center" colspan="2" rowspan="1">99.7626</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">Salmonella Dublin Strain</td><td align="left" rowspan="1" colspan="1">B</td><td align="left" rowspan="1" colspan="1">454</td><td align="left" rowspan="1" colspan="1">5.0</td><td align="left" rowspan="1" colspan="1">13</td><td align="left" rowspan="1" colspan="1">45</td><td align="left" rowspan="1" colspan="1">18</td><td align="left" rowspan="1" colspan="1">96.84</td><td align="left" rowspan="1" colspan="1">96.85</td><td align="left" rowspan="1" colspan="1">207</td><td align="left" rowspan="1" colspan="1">7</td></tr><tr><td align="left" rowspan="1" colspan="1"><italic>Yersinia enterocolitica</italic></td><td align="left" rowspan="1" colspan="1">B</td><td align="left" rowspan="1" colspan="1">Capillary</td><td align="left" rowspan="1" colspan="1">5.0</td><td align="left" rowspan="1" colspan="1">25</td><td align="left" rowspan="1" colspan="1">235</td><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1">99.96</td><td align="left" rowspan="1" colspan="1">99.97</td><td align="left" rowspan="1" colspan="1">131 796</td><td align="left" rowspan="1" colspan="1">3</td></tr></tbody></table><table-wrap-foot><fn><p>Sequence quality: &#x02018;A&#x02019; indicates manually finished and published genomes and &#x02018;B&#x02019; indicates a draft assembly. SNPs and Indels shows the total number called between the first and last iteration. Rejected indicates the total number of changes that were rejected because they decreased the total of perfectly mapping reads at that location. Percent genome covered indicates how many bases are covered at least five times by perfectly mapping reads, before and after the correction. New mapable reads indicates the additional number of reads that could be mapped by SSAHA between the first and last iteration. Further information can be found in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq269/DC1">Supplementary Table S3</ext-link>.</p></fn></table-wrap-foot></table-wrap>
<fig id="F3" position="float"><label>Fig. 3.</label><caption><p>Examples of corrections of homopolymer length errors in assemblies from 454 sequencing. Details of the reads used can be found in <xref ref-type="table" rid="T1">Table 1</xref>. Figures are Artemis screen shots that show the three different reading frames in the direction of the gene. Black vertical lines are stop codons. Filled coloured boxes denote open reading frames. (<bold>A</bold>) Correction of a region of an assembly of <italic>P.berghei</italic> 454 reads. (<bold>B</bold>) Correction of a region of a 454 assembly of <italic>C.dificile</italic>.</p></caption><graphic xlink:href="btq269f3"/></fig>
</p><p>Finally, we applied iCORN to a series of other eukaryotic and prokaryotic genome projects in various stages of completion (<xref ref-type="table" rid="T1">Table 1</xref>). For finished bacterial genomes, very few or no corrections were made. For those in draft assembly, it was possible to call a number of errors in relatively few iterations. This is presumably because bacteria generally have higher coverage, are shorter and have a less complex genome structure than eukaryotes. All errors in <italic>Yersinia enterocolitica</italic> and <italic>Streptococcus suis</italic> were confirmed by manual inspection of the trace files.</p></sec><sec sec-type="discussion" id="SEC4"><title>4 DISCUSSION</title><p>Here, we have shown that iterative mapping of short reads can correct errors remaining in a reference genome with great accuracy. Critical to the success of this approach is the use of two different mapping strategies during the iterations. High-quality discrepancies called using SSAHA2 are introduced into the genome and only confirmed if a separate mapping of perfectly aligning reads along their whole length using SNP-o-matic does not decrease coverage at the altered sites. Iterative mapping approaches have been used before to derive a consensus genome sequence from metagenomic sequencing data (Dutilh <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2009</xref>) but since this derives from aggregated sequences from an unknown number of starting genotypes, the resulting consensus represents no single genome and hides much of the diversity present in the original sequence pool. We have also shown that, after very few iterations, iCORN is efficient at correcting homopolymer errors that are often present in 454 data, thus potentially improving the ability to combine assemblies constructed using different sequencing technologies.</p><p>We have explored the use of iCORN to &#x02018;morph&#x02019; a reference genome into a closely related genotype using deep short read coverage. Although this approach may produce erroneous sequence changes, we have found that it has been very successful in improving the mapping of assembled contigs from a new genotype onto a reference genome.</p><p>Finally, with third generation sequencing technology on the horizon, bringing gigabase coverage from much longer read lengths but with an increase in error rates, the use of additional Illumina reads and algorithms such as iCORN may be of considerable use in first-pass error correction.</p></sec>
      <sec sec-type="supplementary-material">
         <title>Supplementary Material</title>
         <supplementary-material id="PMC_1" content-type="local-data">
            <caption>
               <title>[Supplementary Data]</title>
            </caption>
            <media mimetype="text" mime-subtype="html" xlink:href="btq269_index.html"/>
            <media xlink:role="associated-file" mimetype="application" mime-subtype="msword"
                   xlink:href="btq269_bioinf-2010-0022-File002.doc"/>
            <media xlink:role="associated-file" mimetype="image" mime-subtype="tiff"
                   xlink:href="btq269_bioinf-2010-0022-File003.tif"/>
            <media xlink:role="associated-file" mimetype="application" mime-subtype="msword"
                   xlink:href="btq269_bioinf-2010-0022-File004.doc"/>
            <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel"
                   xlink:href="btq269_bioinf-2010-0022-File005.xls"/>
            <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel"
                   xlink:href="btq269_bioinf-2010-0022-File006.xls"/>
            <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel"
                   xlink:href="btq269_bioinf-2010-0022-File007.xls"/>
         </supplementary-material>
         <supplementary-material id="PMC_2" content-type="local-data">
            <caption>
               <title>[Supplementary Data]</title>
            </caption>
            <media mimetype="text" mime-subtype="html" xlink:href="btq269v2_index.html"/>
            <media xlink:role="associated-file" mimetype="application" mime-subtype="msword"
                   xlink:href="btq269v2_bioinf-2010-0022-File002.doc"/>
            <media xlink:role="associated-file" mimetype="image" mime-subtype="tiff"
                   xlink:href="btq269v2_bioinf-2010-0022-File003.tif"/>
            <media xlink:role="associated-file" mimetype="application" mime-subtype="msword"
                   xlink:href="btq269v2_bioinf-2010-0022-File004.doc"/>
            <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel"
                   xlink:href="btq269v2_bioinf-2010-0022-File005.xls"/>
            <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel"
                   xlink:href="btq269v2_bioinf-2010-0022-File006.xls"/>
            <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel"
                   xlink:href="btq269v2_bioinf-2010-0022-File007.xls"/>
         </supplementary-material>
      </sec>
   </body><back><ack><title>ACKNOWLEDGEMENTS</title><p>We would like to thank Stephen Bentley and Nicholas Thomson for Illumina sequences to test iCORN and Heidi Hauser and Danielle Walker for manually checking the corrections in <italic>Y.enterocolitica</italic> and <italic>S.suis</italic>.</p><p><italic>Funding</italic>: Wellcome Trust (grant number WT085775/Z/08/Z); European Union 6th Framework Program grant to the BioMalPar Consortium (grant number LSHP-LT-2004-503578).</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carver</surname><given-names>T</given-names></name><etal/></person-group><article-title>Artemis and ACT: viewing, annotating and comparing sequences stored in a relational database</article-title><source>Bioinformatics</source><year>2008</year><volume>24</volume><fpage>2672</fpage><lpage>2676</lpage><pub-id pub-id-type="pmid">18845581</pub-id></element-citation></ref><ref id="B2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Droege</surname><given-names>M</given-names></name><name><surname>Hill</surname><given-names>B</given-names></name></person-group><article-title>The Genome Sequencer FLX&#x02122; System&#x02014;longer reads, more applications, straight forward bioinformatics and more complete data sets</article-title><source>J. Biotechnol.</source><year>2008</year><volume>136</volume><fpage>3</fpage><lpage>10</lpage><pub-id pub-id-type="pmid">18616967</pub-id></element-citation></ref><ref id="B3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dutilh</surname><given-names>BE</given-names></name><etal/></person-group><article-title>Increasing the coverage of a metapopulation consensus genome by iterative read mapping and assembly</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2878</fpage><lpage>2881</lpage><pub-id pub-id-type="pmid">19542148</pub-id></element-citation></ref><ref id="B4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ewing</surname><given-names>B</given-names></name><name><surname>Green</surname><given-names>P</given-names></name></person-group><article-title>Base-calling of automated sequencer traces using phred. II. Error probabilities</article-title><source>Genome Res.</source><year>1998</year><volume>8</volume><fpage>186</fpage><lpage>194</lpage><pub-id pub-id-type="pmid">9521922</pub-id></element-citation></ref><ref id="B5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gajer</surname><given-names>P</given-names></name><etal/></person-group><article-title>Automated correction of genome sequence errors</article-title><source>Nucleic Acids Res.</source><year>2004</year><volume>32</volume><fpage>562</fpage><lpage>569</lpage><pub-id pub-id-type="pmid">14744981</pub-id></element-citation></ref><ref id="B6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hall</surname><given-names>M</given-names></name><etal/></person-group><article-title>Sequence of <italic>Plasmodium falciparum</italic> chromosomes 1, 3-9 and 13</article-title><source>Nature</source><year>2002</year><volume>419</volume><fpage>527</fpage><lpage>531</lpage><pub-id pub-id-type="pmid">12368867</pub-id></element-citation></ref><ref id="B7"><element-citation publication-type="journal"><collab>International Human Genome Sequencing Consortium</collab><article-title>Initial sequencing and analysis of the human genome</article-title><source>Nature</source><year>2001</year><volume>409</volume><fpage>860</fpage><lpage>921</lpage><pub-id pub-id-type="pmid">11237011</pub-id></element-citation></ref><ref id="B8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kozarewa</surname><given-names>I</given-names></name><etal/></person-group><article-title>Amplification-free Illumina sequencing-library preparation facilitates improved mapping and assembly of (G+C)-biased genomes</article-title><source>Nat. Methods</source><year>2009</year><volume>6</volume><fpage>291</fpage><lpage>295</lpage><pub-id pub-id-type="pmid">19287394</pub-id></element-citation></ref><ref id="B9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><etal/></person-group><article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title><source>Genome Res.</source><year>2008</year><volume>18</volume><fpage>1851</fpage><lpage>1858</lpage><pub-id pub-id-type="pmid">18714091</pub-id></element-citation></ref><ref id="B10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Manske</surname><given-names>HM</given-names></name><name><surname>Kwiatkowski</surname><given-names>DP</given-names></name></person-group><article-title>SNP-o-matic</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2434</fpage><lpage>2435</lpage><pub-id pub-id-type="pmid">19574284</pub-id></element-citation></ref><ref id="B11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ning</surname><given-names>Z</given-names></name><etal/></person-group><article-title>SSAHA: a fast search method for large DNA databases</article-title><source>Genome Res.</source><year>2001</year><volume>11</volume><fpage>1725</fpage><lpage>1729</lpage><pub-id pub-id-type="pmid">11591649</pub-id></element-citation></ref><ref id="B12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quail</surname><given-names>MA</given-names></name><etal/></person-group><article-title>A large genome centre's improvements to the Illumina sequencing system</article-title><source>Nat. Methods</source><year>2008</year><volume>5</volume><fpage>1005</fpage><lpage>1010</lpage><pub-id pub-id-type="pmid">19034268</pub-id></element-citation></ref></ref-list></back></article>