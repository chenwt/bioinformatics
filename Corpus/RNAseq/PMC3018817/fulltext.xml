<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v3.0 20080202//EN" "archivearticle3.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3018817</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btq643</article-id><article-id pub-id-type="publisher-id">btq643</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Gene Expression</subject></subj-group></subj-group></article-categories><title-group><article-title>RSEQtools: a modular framework to analyze RNA-Seq data using compact, anonymized data summaries</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Habegger</surname><given-names>Lukas</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref><xref ref-type="corresp" rid="COR1">*</xref><xref ref-type="author-notes" rid="FN1"><sup>&#x02020;</sup></xref></contrib><contrib contrib-type="author"><name><surname>Sboner</surname><given-names>Andrea</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref><xref ref-type="author-notes" rid="FN1"><sup>&#x02020;</sup></xref></contrib><contrib contrib-type="author"><name><surname>Gianoulis</surname><given-names>Tara A.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>3</sup></xref><xref ref-type="aff" rid="AFF1"><sup>4</sup></xref></contrib><contrib contrib-type="author"><name><surname>Rozowsky</surname><given-names>Joel</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Agarwal</surname><given-names>Ashish</given-names></name><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref><xref ref-type="aff" rid="AFF1"><sup>5</sup></xref></contrib><contrib contrib-type="author"><name><surname>Snyder</surname><given-names>Michael</given-names></name><xref ref-type="aff" rid="AFF1"><sup>6</sup></xref></contrib><contrib contrib-type="author"><name><surname>Gerstein</surname><given-names>Mark</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref><xref ref-type="aff" rid="AFF1"><sup>5</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>Program in Computational Biology and Bioinformatics, <sup>2</sup>Department of Molecular Biophysics and Biochemistry, Yale University, New Haven, CT, <sup>3</sup>Wyss Institute for Biologically-Inspired Engineering at Harvard, Boston, MA, <sup>4</sup>Department of Genetics, Harvard Medical School, Boston, MA, <sup>5</sup>Department of Computer Science, Yale University, New Haven, CT and <sup>6</sup>Department of Genetics, Stanford University School of Medicine, Stanford, CA, USA</aff><author-notes><corresp id="COR1">* To whom correspondence should be addressed.</corresp><fn id="FN1"><p><sup>&#x02020;</sup> The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.</p></fn><fn><p>Associate Editor: Ivo Hofacker</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>1</month><year>2011</year></pub-date><pub-date pub-type="epub"><day>5</day><month>12</month><year>2010</year></pub-date><pub-date pub-type="pmc-release"><day>5</day><month>12</month><year>2010</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the							<pub-date pub-type="epub"/>. --><volume>27</volume><issue>2</issue><fpage>281</fpage><lpage>283</lpage><history><date date-type="received"><day>23</day><month>6</month><year>2010</year></date><date date-type="rev-recd"><day>5</day><month>11</month><year>2010</year></date><date date-type="accepted"><day>8</day><month>11</month><year>2010</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2010. Published by Oxford University Press.</copyright-statement><copyright-year>2010</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p><bold>Summary:</bold> The advent of next-generation sequencing for functional genomics has given rise to quantities of sequence information that are often so large that they are difficult to handle. Moreover, sequence reads from a specific individual can contain sufficient information to potentially identify and genetically characterize that person, raising privacy concerns. In order to address these issues, we have developed the Mapped Read Format (MRF), a compact data summary format for both short and long read alignments that enables the anonymization of confidential sequence information, while allowing one to still carry out many functional genomics studies. We have developed a suite of tools (RSEQtools) that use this format for the analysis of RNA-Seq experiments. These tools consist of a set of modules that perform common tasks such as calculating gene expression values, generating signal tracks of mapped reads and segmenting that signal into actively transcribed regions. Moreover, the tools can readily be used to build customizable RNA-Seq workflows. In addition to the anonymization afforded by MRF, this format also facilitates the decoupling of the alignment of reads from downstream analyses.</p><p><bold>Availability and implementation:</bold> RSEQtools is implemented in C and the source code is available at <ext-link ext-link-type="uri" xlink:href="http://rseqtools.gersteinlab.org/">http://rseqtools.gersteinlab.org/</ext-link>.</p><p><bold>Contact:</bold> <email>lukas.habegger@yale.edu</email>; <email>mark.gerstein@yale.edu</email></p><p><bold>Supplementary information:</bold> <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btq643/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p></abstract></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>The advent of next-generation sequencing technologies has revolutionized the study of genomes and transcriptomes. In particular, the application of deep sequencing approaches to transcriptome profiling (RNA-Seq) is increasingly becoming the method of choice for studying the transcriptional landscape of cells (<xref ref-type="bibr" rid="B3">Hillier <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="B7">Mortazavi <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B11">Wang <italic>et al.</italic>, 2009</xref>). Typically, the first step in this analysis is the alignment of the sequence reads to a reference sequence set. Recently, a number of different alignment tools have been developed to map short reads in an efficient manner (<xref ref-type="bibr" rid="B9">Trapnell and Salzberg, 2009</xref>). While much progress has been made on this front, there is still a great need for a set of software tools that facilitate the downstream analysis of mapped RNA-Seq reads.</p><p>Further, two other issues remain to be addressed. First, the immense file size of next-generation sequencing data poses many challenges in terms of data processing, storage and sharing. Secondly, mechanisms to protect personal confidential genetic information need to be established. With the birth of personal genomics, sequencing data stems fundamentally from individuals, and this type of data cannot be distributed as easily because significant privacy concerns arise with sharing all the sequence variations of a particular individual (<xref ref-type="bibr" rid="B1">Greenbaum <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="B6">Lowrance and Collins, 2007</xref>). One critical challenge for genomics, then, is to devise new data summaries that allow the sharing of large amounts of information from sequencing experiments without exposing the genotypic information of the underlying individual (Supplementary Material).</p><p>Although many data formats have been developed such as SAM (<xref ref-type="bibr" rid="B5">Li <italic>et al.</italic>, 2009</xref>), there is no practical solution yet that addresses the privacy concerns when sharing large sequence alignment files. Addressing this challenge is precisely what we have endeavored to do in putting together the Mapped Read Format (MRF), a format that allows data summaries to be exchanged, enabling many aspects of the RNA-Seq calculation to be performed such as expression measurements, but that also detaches the actual sequence variation in a person into separate files. Further, it provides a very clear way of linking these two pieces of information so that the data summaries can be subsequently conjoined back to the original sequences for more in-depth analyses with potentially confidential data.</p><p>Here, we present an overview of a flexible suite of tools (RSEQtools) that are designed to facilitate easily customizable workflows and efficient pipeline building for the analysis of RNA-Seq experiments using this compact format (<xref ref-type="fig" rid="F1">Fig. 1</xref>). Briefly, we first convert the aligned reads into MRF and thus decouple the alignment step from the downstream analyses. RSEQtools implements several modules using this standardized format for performing common RNA-Seq analyses, such as expression quantification, discovery of transcribed regions, coverage computations annotation manipulation, etc.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Schematic overview of RSEQtools. Mapped reads are first converted into MRF from common alignment tool output formats, including SAM. The resulting MRF files can be divided in two files: one with the alignment only and another with the corresponding sequence reads. The read identifiers provide a mapping between the two files. Then, several modules perform the downstream analyses independently from the mapping step, such as expression quantification, visualization of the mapped read and the calculation of annotation statistics, etc. Other tools have been developed based on this framework to perform more sophisticated analyses such as transcript assembly, isoform quantification (IQSeq, <ext-link ext-link-type="uri" xlink:href="http://rnaseq.gersteinlab.org/IQSeq">http://rnaseq.gersteinlab.org/IQSeq</ext-link>), fusion transcript identification (FusionSeq, <ext-link ext-link-type="uri" xlink:href="http://rnaseq.gersteinlab.org/fusionseq">http://rnaseq.gersteinlab.org/fusionseq</ext-link>), as well as aggregation and correlation of signal tracks (ACT, <ext-link ext-link-type="uri" xlink:href="http://act.gersteinlab.org">http://act.gersteinlab.org</ext-link>).</p></caption><graphic xlink:href="btq643f1"/></fig></p></sec><sec id="SEC2"><title>2 FEATURES AND METHODS</title><sec id="SEC2.1"><title>2.1 MRF and converters</title><p>MRF only stores a minimal set of information, i.e. information that cannot be derived from the MRF data itself. This has the advantage of keeping the format succinct, while still capturing the relevant information for most analyses. MRF consists of three components: comment lines (optional) denoted by a leading &#x02018;#&#x02019; sign, a header line and the mapped reads. The header line specifies the data type of each column: AlignmentBlocks, Sequences, QualityScores and QueryID. The column type AlignmentBlocks is required and represents the mapped reads. Each alignment block contains the coordinates with respect to the reference genome to which the read aligns as well as the read coordinates. A read spanning multiple regions, e.g. multiple exons, is denoted by multiple alignment blocks that are separated by a comma. Paired-end reads can be represented by using a set of alignment blocks for each end, which are separated by the &#x02018;|&#x02019; symbol. By using this format, it is straightforward to specify both gapped and paired-end alignments. The RSEQtools package includes various utilities to convert the output of several mapping tools into MRF. A converter for the commonly used SAM format is included as well. The first example below represents two paired-end reads where one end is spliced, whereas the second example shows two un-spliced single-end reads with their associated QueryIDs:</p><p><inline-graphic xlink:href="btq643i1.jpg"/></p><p><inline-graphic xlink:href="btq643i2.jpg"/></p><p>The optional types Sequences, QualityScores and QueryID provide additional information. In particular, the confidentiality issues can be addressed by generating two files: one including the alignments and a second one containing the sequences such as a FASTQ file. The former is useful for most analyses and can be publicly shared because it does not contain confidential information, whereas the latter can be subjected to a higher level of security and control. The two files can be conjoined, if necessary, by using the common QueryID as shown in <xref ref-type="fig" rid="F1">Figure 1</xref>.</p></sec><sec id="SEC2.2"><title>2.2 RNA-Seq analysis with RSEQtools</title><p>The RSEQtools suite contains a set of modules to perform a large variety of tasks including the quantification of expression values, manipulation of gene annotation sets, visualization of the mapped reads, generation of signal tracks, the identification of transcriptional active regions and several auxiliary utilities (Supplementary Table S1).</p><p><italic>Genome annotation tools</italic>: to generate a splice junction library from any annotation set, we extract the genomic sequences of all the exons and synthetically create all splice junctions specified in the annotation set. This splice junction library can be used in combination with the reference sequences. A second tool is particularly useful when estimating expression levels. In order to capture the information of the various transcript isoforms, a &#x02018;gene model&#x02019; is required. The module <italic>mergeTranscripts</italic> collapses the transcript isoforms into a single gene model by either taking the union or intersection of the exonic nucleotides.</p><p><italic>Quantification of gene expression:</italic> one of the key features of RNA-Seq is the quantification of expression at different levels. Hence, a key module calculates the gene expression values for a given annotation set and a collection of mapped reads in MRF format. The annotation set specifies which &#x02018;elements&#x02019; will be quantified. The program <italic>mrfQuantifier</italic> calculates RPKM (reads per kilobase per million mapped reads) values at the nucleotide level (<xref ref-type="bibr" rid="B7">Mortazavi <italic>et al.</italic>, 2008</xref>). Briefly, for a given entry in the annotation set (typically an exon or gene model), the number of nucleotides from all the reads that overlap with this annotation entry are added up and then this count is normalized by sequence length of the annotation entry (per killobase) and by the total number of mapped nucleotides (per million). This calculation is not performed at the transcript level, which requires a more sophisticated analysis (<xref ref-type="bibr" rid="B2">Guttman <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="B10">Trapnell <italic>et al.</italic>, 2010</xref>).</p><p><italic>Visualization of mapped reads:</italic> the RSEQtools package also contains various tools for visualizing the results in genome browsers, by means of wiggle (WIG) and bedGraph files, which are commonly used to represent a signal track of mapped reads. Also, a GFF file can be generated from MRF files to visualize splice junction reads (example in <xref ref-type="fig" rid="F1">Fig. 1</xref>).</p><p><italic>Identification of transcriptionally active regions (TARs)</italic>: transcribed regions can be identified <italic>de novo</italic> by performing a maxGap/minRun segmentation (<xref ref-type="bibr" rid="B4">Kampa <italic>et al.</italic>, 2004</xref>; <xref ref-type="bibr" rid="B8">Royce <italic>et al.</italic>, 2005</xref>) from the signal files using the <italic>wigSegmenter</italic> program. Briefly, the signal is first thresholded to identify transcribed elements. Contiguous elements whose distance is less than &#x02018;maxGap&#x02019; are joined together and then filtered if the final size is less than &#x02018;minRun&#x02019;. This type of analysis is particularly useful in discovering novel TARs such as small RNAs, etc.</p><p><italic>MRF selection and auxiliary utilities</italic>: lastly, RSEQtools includes a set of utilities to easily manipulate MRF files and a collection of format conversion tools allowing for rapid pipeline development.</p><p><italic>Implementation and run time</italic>: the modules of the RSEQtools suite were implemented in C and the code was optimized in order to efficiently handle large datasets. The importance of code scalability cannot be overemphasized in a time where datasets become increasingly large and easily exceed several gigabytes. For example, the conversion of an ELAND export file (uncompressed file size: &#x0223c;4 GB; total number of reads: &#x0223c;20 million; number of mapped reads: &#x0223c;12 million) to MRF takes &#x0223c;2 min and the resulting MRF file is significantly smaller (&#x0223c;400 MB uncompressed, &#x0223c;130 MB compressed with gzip). Converting the same ELAND export file to SAM generates a file of &#x0223c;3.1 GB (uncompressed) and the corresponding BAM file has a size of &#x0223c;1.2 GB. The subsequent quantification of gene expression using <italic>mrfQuantifier</italic> requires 45 s to calculate estimates for about 20 000 genes.</p><p>In addition, the modularity of RSEQtools also enables the development of additional programs in any programming language and their seamless integration into this framework. Finally, most modules use STDIN and STDOUT to process the data, making them suitable to be integrated into an automated pipeline.</p></sec></sec><sec sec-type="conclusions" id="SEC3"><title>3 CONCLUSIONS</title><p>In summary, RSEQtools contains a number of useful and highly specific modules that can rapidly analyze RNA-Seq data. The MRF format has two major features: it allows the decoupling of downstream analysis from the mapping strategy and addresses the issue of confidentiality that is intrinsic in any sequencing experiments involving human subjects. By separating the actual sequencing reads from the alignments, MRF provides a mechanism to protect the private genotypic information of the underlying individual. Although this approach removes the most obvious genotypic features, other distinctive attributes do remain. First of all, the information in a MRF file is at least equivalent to that in traditional expression array, which can potentially identify the underlying individual. Secondly, some information about structural variants may be contained in the MRF file of an RNA-Seq experiment. However, it is not obvious how to extract genotypic information from a subset of structural variations just affecting genes. In addition, inferring structural variations from RNA-Seq data as opposed to DNA sequencing would be more complicated due to the presence of alternative splicing.</p><p>Another advantage of storing the alignments without the underlying sequences is that it saves space, especially as reads become longer. Moreover, a possible future extension is the development of a specific compression schema that could further reduce the size of the files. In addition, this data format could be easily applied to sequence alignments obtained from other high-throughput functional genomic assays such as ChIP-Seq or chromosome conformation capture (3C).</p></sec>
      <sec sec-type="supplementary-material">
         <title>Supplementary Material</title>
         <supplementary-material id="PMC_1" content-type="local-data">
            <caption>
               <title>Supplementary Data</title>
            </caption>
            <media mimetype="text" mime-subtype="html" xlink:href="supp_27_2_281__index.html"/>
            <media xlink:role="associated-file" mimetype="application" mime-subtype="msword"
                   xlink:href="supp_btq643_RSEQtools_supplements_revision.doc"/>
         </supplementary-material>
      </sec>
   </body><back><ack><title>ACKNOWLEDGEMENT</title><p>We thank Raymond Auerbach for critical reading and editing as well as Wasay Hussain for testing of the software.</p><p><italic>Funding</italic>: <funding-source>National Institutes of Health</funding-source>.</p><p><italic>Conflict of Interest</italic>: none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenbaum</surname><given-names>D</given-names></name><etal/></person-group><article-title>Genomic anonymity: have we already lost it?</article-title><source>Am. J. Bioeth.</source><year>2008</year><volume>8</volume><fpage>71</fpage><lpage>74</lpage><pub-id pub-id-type="pmid">19003717</pub-id></element-citation></ref><ref id="B2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guttman</surname><given-names>M</given-names></name><etal/></person-group><article-title>Ab initio reconstruction of cell type-specific transcriptomes in mouse reveals the conserved multi-exonic structure of lincRNAs</article-title><source>Nat. Biotechnol.</source><year>2010</year><volume>28</volume><fpage>503</fpage><lpage>510</lpage><pub-id pub-id-type="pmid">20436462</pub-id></element-citation></ref><ref id="B3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hillier</surname><given-names>LW</given-names></name><etal/></person-group><article-title>Massively parallel sequencing of the polyadenylated transcriptome of C.elegans</article-title><source>Genome Res.</source><year>2009</year><volume>19</volume><fpage>657</fpage><lpage>666</lpage><pub-id pub-id-type="pmid">19181841</pub-id></element-citation></ref><ref id="B4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kampa</surname><given-names>D</given-names></name><etal/></person-group><article-title>Novel RNAs identified from an in-depth analysis of the transcriptome of human chromosomes 21 and 22</article-title><source>Genome Res.</source><year>2004</year><volume>14</volume><fpage>331</fpage><lpage>342</lpage><pub-id pub-id-type="pmid">14993201</pub-id></element-citation></ref><ref id="B5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><etal/></person-group><article-title>The Sequence Alignment/Map format and SAMtools</article-title><source>Bioinformatics</source><year>2009</year><volume>25</volume><fpage>2078</fpage><lpage>2079</lpage><pub-id pub-id-type="pmid">19505943</pub-id></element-citation></ref><ref id="B6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lowrance</surname><given-names>WW</given-names></name><name><surname>Collins</surname><given-names>FS</given-names></name></person-group><article-title>ETHICS: identifiability in genomic research</article-title><source>Science</source><year>2007</year><volume>317</volume><fpage>600</fpage><lpage>602</lpage><pub-id pub-id-type="pmid">17673640</pub-id></element-citation></ref><ref id="B7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mortazavi</surname><given-names>A</given-names></name><etal/></person-group><article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title><source>Nat. Method</source><year>2008</year><volume>5</volume><fpage>621</fpage><lpage>628</lpage></element-citation></ref><ref id="B8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Royce</surname><given-names>TE</given-names></name><etal/></person-group><article-title>Issues in the analysis of oligonucleotide tiling microarrays for transcript mapping</article-title><source>Trends Genet.</source><year>2005</year><volume>21</volume><fpage>466</fpage><lpage>475</lpage><pub-id pub-id-type="pmid">15979196</pub-id></element-citation></ref><ref id="B9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><name><surname>Salzberg</surname><given-names>SL</given-names></name></person-group><article-title>How to map billions of short reads onto genomes</article-title><source>Nat. Biotechnol.</source><year>2009</year><volume>27</volume><fpage>455</fpage><lpage>457</lpage><pub-id pub-id-type="pmid">19430453</pub-id></element-citation></ref><ref id="B10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><etal/></person-group><article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title><source>Nat. Biotechnol.</source><year>2010</year><volume>28</volume><fpage>511</fpage><lpage>515</lpage><pub-id pub-id-type="pmid">20436464</pub-id></element-citation></ref><ref id="B11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z</given-names></name><etal/></person-group><article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title><source>Nat. Rev. Genet.</source><year>2009</year><volume>10</volume><fpage>57</fpage><lpage>63</lpage><pub-id pub-id-type="pmid">19015660</pub-id></element-citation></ref></ref-list></back></article>