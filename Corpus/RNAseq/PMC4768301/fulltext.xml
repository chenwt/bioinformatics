<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?properties manuscript?><?origin nihpa?><?iso-abbr Nat. Methods?><?submitter-system nihms?><?submitter-canonical-name Nature Publishing Group?><?submitter-canonical-id NATURE-STRUCTUR?><?submitter-userid 1045?><?submitter-authority publisher?><?submitter-login nature-structure?><?submitter-name Nature Publishing Group (obsolete)?><?domain nihpa?><front><journal-meta><journal-id journal-id-type="nlm-journal-id">101215604</journal-id><journal-id journal-id-type="pubmed-jr-id">32338</journal-id><journal-id journal-id-type="nlm-ta">Nat Methods</journal-id><journal-id journal-id-type="iso-abbrev">Nat. Methods</journal-id><journal-title-group><journal-title>Nature methods</journal-title></journal-title-group><issn pub-type="ppub">1548-7091</issn><issn pub-type="epub">1548-7105</issn></journal-meta><article-meta><article-id pub-id-type="pmcid">4768301</article-id><article-id pub-id-type="pmid">25581801</article-id><article-id pub-id-type="doi">10.1038/nmeth.3249</article-id><article-id pub-id-type="manuscript">nihpa648616</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Targeted exploration and analysis of large cross-platform human transcriptomic compendia</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Zhu</surname><given-names>Qian</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Wong</surname><given-names>Aaron K</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Krishnan</surname><given-names>Arjun</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Aure</surname><given-names>Miriam R</given-names></name><xref ref-type="aff" rid="A3">3</xref></contrib><contrib contrib-type="author"><name><surname>Tadych</surname><given-names>Alicja</given-names></name><xref ref-type="aff" rid="A2">2</xref></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Ran</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Corney</surname><given-names>David C</given-names></name><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A4">4</xref></contrib><contrib contrib-type="author"><name><surname>Greene</surname><given-names>Casey S</given-names></name><xref ref-type="aff" rid="A5">5</xref><xref ref-type="aff" rid="A6">6</xref></contrib><contrib contrib-type="author"><name><surname>Bongo</surname><given-names>Lars A</given-names></name><xref ref-type="aff" rid="A7">7</xref></contrib><contrib contrib-type="author"><name><surname>Kristensen</surname><given-names>Vessela N</given-names></name><xref ref-type="aff" rid="A3">3</xref><xref ref-type="aff" rid="A8">8</xref></contrib><contrib contrib-type="author"><name><surname>Charikar</surname><given-names>Moses</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="cor1">10</xref></contrib><contrib contrib-type="author"><name><surname>Li</surname><given-names>Kai</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="corresp" rid="cor1">10</xref></contrib><contrib contrib-type="author"><name><surname>Troyanskaya</surname><given-names>Olga G.</given-names></name><xref ref-type="aff" rid="A1">1</xref><xref ref-type="aff" rid="A2">2</xref><xref ref-type="aff" rid="A9">9</xref><xref ref-type="corresp" rid="cor1">10</xref></contrib></contrib-group><aff id="A1"><label>1</label>Department of Computer Science, Princeton University, Princeton, NJ, USA</aff><aff id="A2"><label>2</label>Lewis-Sigler Institute of Integrative Genomics, Princeton University, Princeton, NJ, USA</aff><aff id="A3"><label>3</label>Department of Genetics, Institute for Cancer Research, Oslo University Hospital, The Norwegian Radiumhospital, Oslo, Norway</aff><aff id="A4"><label>4</label>Department of Molecular Biology, Princeton University, Princeton, NJ, USA</aff><aff id="A5"><label>5</label>Department of Genetics, Geisel School of Medicine at Dartmouth, Hanover, NH, USA</aff><aff id="A6"><label>6</label>Institute for Quantitative Biomedical Sciences, Dartmouth College, Hanover, NH, USA</aff><aff id="A7"><label>7</label>Department of Computer Science, University of Troms&#x000f8;, Troms&#x000f8;, Norway</aff><aff id="A8"><label>8</label>Institute for Clinical Medicine, Department of Clinical Molecular Biology (EpiGen), Faculty of Medicine, UiO and Division of Medicine, Akershus University Hospital, Akershus, Norway</aff><aff id="A9"><label>9</label>Simons Center for Data Analysis, Simons Foundation, New York City, NY, USA</aff><author-notes><corresp id="cor1"><label>10</label>Co-corresponding authors. M. Charikar, <email>moses@cs.princeton.edu</email>, K. Li, <email>li@cs.princeton.edu</email>, O. G. Troyanskaya, <email>ogt@cs.princeton.edu</email></corresp></author-notes><pub-date pub-type="nihms-submitted"><day>18</day><month>2</month><year>2016</year></pub-date><pub-date pub-type="epub"><day>12</day><month>1</month><year>2015</year></pub-date><pub-date pub-type="ppub"><month>3</month><year>2015</year></pub-date><pub-date pub-type="pmc-release"><day>26</day><month>2</month><year>2016</year></pub-date><volume>12</volume><issue>3</issue><fpage>211</fpage><lpage>214</lpage><!--elocation-id from pubmed: 10.1038/nmeth.3249--><permissions><license xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms"><license-p>Users may view, print, copy, and download text and data-mine the content in such documents, for the purposes of academic research, subject always to the full Conditions of use:<ext-link ext-link-type="uri" xlink:href="http://www.nature.com/authors/editorial_policies/license.html#terms">http://www.nature.com/authors/editorial_policies/license.html#terms</ext-link></license-p></license></permissions><abstract><p id="P1">We present SEEK (<ext-link ext-link-type="uri" xlink:href="http://seek.princeton.edu">http://seek.princeton.edu</ext-link>), a query-based search engine across very large transcriptomic data collections, including thousands of human data sets from almost 50 microarray and next-generation sequencing platforms. SEEK uses a novel query-level cross-validation-based algorithm to automatically prioritize data sets relevant to the query and a robust search approach to identify query-coregulated genes, pathways, and processes. SEEK provides cross-platform handling, multi-gene query search, iterative metadata-based search refinement, and extensive visualization-based analysis options.</p></abstract></article-meta></front><body><p id="P2">The accumulation of human gene expression data in public repositories, such as The Cancer Genome Atlas<sup><xref rid="R1" ref-type="bibr">1</xref></sup> and Gene Expression Omnibus<sup><xref rid="R2" ref-type="bibr">2</xref></sup>, offers unprecedented opportunities for data-driven characterization of biological pathways that underlie human diseases. Unsupervised, exploratory approaches are particularly suitable for data-driven discovery and in settings with insufficient or biased training data. However, traditional unsupervised methods, such as clustering and bi-clustering<sup><xref rid="R3" ref-type="bibr">3</xref>,<xref rid="R4" ref-type="bibr">4</xref></sup>, do not readily extend to compendia containing thousands of data sets from different expression technologies and platforms. Query-based search can enable biomedical researchers to effectively explore and analyze the large collection of expression data sets to identify co-expressed genes in order to explore functional relationships, and make inferences about pathway function with regard to query genes of interest. However, existing search approaches are limited to smaller compendia in model organisms<sup><xref rid="R5" ref-type="bibr">5</xref>,<xref rid="R6" ref-type="bibr">6</xref></sup> or, in human, to identifying similar arrays<sup><xref rid="R7" ref-type="bibr">7</xref></sup> or performing gene-level search on a single microarray platform<sup><xref rid="R8" ref-type="bibr">8</xref></sup>.</p><p id="P3">We present SEEK (Search-based Exploration of Expression Kompendia), a robust, cross-platform search system capable of handling very large compendia of human expression data across multiple expression platforms, including microarray and next-generation sequencing (NGS) technologies, and automatically prioritizing data sets relevant to the user&#x02019;s single or multi-gene query to identify genes co-regulated with the query in informative data sets. SEEK provides biomedical researchers with a systems-level, unbiased exploration of diverse human pathways, tissues, and diseases represented in the entire heterogeneous human compendium. The system integrates thousands of data sets on-the-fly using a novel cross-validation-based data set-weighting algorithm, which robustly identifies relevant data sets and leverages them to retrieve genes co-regulated with the query. It supports sophisticated biological search contexts defined by multi-gene queries and enables cross-platform analysis, with the current compendium including 155,025 experiments spanning 5,210 data sets from 41 different microarray and RNASeq platforms (<xref ref-type="fig" rid="F1">Fig. 1a</xref> and <xref ref-type="supplementary-material" rid="SD3">Supplementary Data 1</xref>). It has been implemented in a user-friendly, interactive web-interface (<ext-link ext-link-type="uri" xlink:href="http://seek.princeton.edu">http://seek.princeton.edu</ext-link>), which includes expression visualization and interpretation modules (<xref ref-type="fig" rid="F1">Fig. 1a</xref>). This interface facilitates hypothesis generation by providing 1) intuitive expression visualizations of the retrieved co-expressed genes, 2) explorations of individual data sets to establish associations between co-expressed genes and biological variables, and 3) further refinement of the search results such as limiting data sets to a specific tissue (e.g. brain or kidney) or disease (e.g. primary tumor or non-cancerous disease).</p><p id="P4">The search algorithm (<bold>Methods</bold>) allows multi-gene queries and includes a gene hubbiness<sup><xref rid="R9" ref-type="bibr">9</xref>,<xref rid="R10" ref-type="bibr">10</xref></sup> correction procedure, a novel cross-validation data set weighting method, and finally a summarization procedure to calculate the final score for each gene. Prior to applying the search algorithm, the data compendium is pre-processed to make correlation distributions comparable across data sets, and then a hubbiness-correction procedure is applied to remove biases caused by generically well-coexpressed genes not specific to the user&#x02019;s area of interest that is defined by the query. The data set weighting algorithm then prioritizes relevant data sets based on the query. The intuition of this approach is to up-weight data sets where a subset of the query genes can retrieve the remaining query genes well based on normalized, hubbiness-corrected co-expression in that data set (cross-validation-based weighting). This approach is effective even when not all query genes are co-expressed. Finally, the integrated gene scores are calculated based on the data set weights and genes&#x02019; co-expression patterns in each data set to provide a final gene ranking.</p><p id="P5">SEEK is accurate and robust in a large-scale gene-retrieval assessment across a diverse array of biological contexts. Specifically, we constructed over 129,000 queries spanning 995 human GO biological process gene-sets (by choosing subsets of genes from each process) and evaluated the ability of the algorithm to retrieve the remaining genes in the process (<bold>Methods</bold>). This set-up was designed to simulate realistic situations where the query genes are biologically coherent, but are not necessarily well co-expressed, and users are interested in identifying genes functionally related to the query (in this case, members of the same biological process). SEEK&#x02019;s performance is robust across a wide range of pathways (<xref ref-type="supplementary-material" rid="SD4">Supplementary Data 2</xref>), and it consistently outperforms previous search approaches, including the only query-based human search system MEM<sup><xref rid="R8" ref-type="bibr">8</xref></sup>, Gene recommender<sup><xref rid="R6" ref-type="bibr">6</xref></sup> (not available for human as a resource), and meta-data set correlations (<xref ref-type="fig" rid="F1">Fig. 1b</xref> and <xref ref-type="supplementary-material" rid="SD2">Supplementary Note 1</xref>). Furthermore, our evaluation demonstrates that SEEK&#x02019;s support for multi-gene queries enhances the algorithm&#x02019;s ability to effectively weight relevant data sets from the compendium (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 1a</xref>), and that the algorithm is robust to query noise (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 2</xref>).</p><p id="P6">Importantly, our evaluation demonstrates the benefits of robust search of a compendium with thousands of expression data sets, as SEEK&#x02019;s performance improves with the inclusion of more microarray and RNASeq data sets in the compendium, assessed by sub-sampling our large compendium to create smaller subsets (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 3</xref> and <xref ref-type="supplementary-material" rid="SD5">Supplementary Data 3</xref>). Furthermore, being able to integrate the full scale of the existing human gene expression data allows the approach to support focused queries covering diverse areas of biology (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 4</xref>), providing strong performance across diverse processes including erythrocyte differentiation (44-fold increase of precision over random (FIOR) at 10% recall) and glutamate signaling (104-fold) (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 4</xref>). In contrast, using the most relevant single data set for the same query yields weak performance of just 3 and 6 FIOR for the two processes respectively, demonstrating the value of using the entire compendium.</p><p id="P7">We illustrate the power of SEEK and multi-gene queries by using SEEK to identify genes dysregulated in the Hedgehog (Hh) pathway and the corresponding tissues and disease states where the Hh pathway is hyper-activated. We use Hh genes <italic>GLI1, GLI2</italic>, and <italic>PTCH1</italic> as the query, where transcription factors <italic>GLI1</italic> and <italic>GLI2</italic> have been suggested as pathway markers of Hh signaling<sup><xref rid="R11" ref-type="bibr">11</xref></sup>. By examining this query in the context 5 of a large-compendium of expression data sets (<xref ref-type="fig" rid="F2">Fig. 2a</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 5</xref>), we observe a wide prevalence of aberrant Hh-signaling across many diseased tissues (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 5</xref>). The top ranked data sets have substantially higher weights, indicating the presence of a strong query-related signal in these data (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 5</xref>) and appear to be more specific to the Hh query than to random queries (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 6a</xref>). These highly weighted data sets include studies of tumors with previously documented connections to aberrant Hh signaling, such as medulloblastoma, where over-activation of Hh has been documented<sup><xref rid="R12" ref-type="bibr">12</xref>,<xref rid="R13" ref-type="bibr">13</xref></sup>, human germ cell tumors, where Hh pathway mutations have been linked to aberrant Hh activation in human germ cells<sup><xref rid="R14" ref-type="bibr">14</xref></sup>, and malignant rhabdoid tumors<sup><xref rid="R15" ref-type="bibr">15</xref>,<xref rid="R16" ref-type="bibr">16</xref></sup>, where mutations have been found to lead to Hh signaling activation<sup><xref rid="R16" ref-type="bibr">16</xref></sup>. Thus, SEEK correctly identifies data sets relevant to the Hh signaling and helps explore the important role of the Hh pathway in a wide array of cancer types. The data set weighting leads to accurate retrieval of other genes in the Hh pathway, including Hh pathway signaling receptors and their associated genes <italic>SMO, PTCH2, HHIP, BOC</italic><sup><xref rid="R17" ref-type="bibr">17</xref></sup>, and the <italic>Cos2</italic> homolog <italic>KIF7</italic><sup><xref rid="R18" ref-type="bibr">18</xref></sup> (<xref ref-type="fig" rid="F2">Fig. 2a</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 6b</xref>) as well as additional genes associated with Hh dysregulations in cancer (<xref ref-type="supplementary-material" rid="SD2">Supplementary Note 2</xref>).</p><p id="P8">The SEEK interface can visualize the abovementioned results including the top-ranked data sets, genes, and their co-expression profiles, using flexible and interactive visualizations (an example of the Hh query is provided in <xref ref-type="fig" rid="F2">Fig. 2a</xref>). The main search result page provides users with the ability to perform extensive follow-up analyses, including functional analysis of results with a co-expression view that summarizes the query and retrieved genes&#x02019; co-expression across 50 data sets at a time (<xref ref-type="supplementary-material" rid="SD2">Supplementary Note 3</xref>). The users can also examine the behavior of any gene in a given data set in detail through a condition-specific view (<xref ref-type="fig" rid="F1">Fig. 1a</xref>), where they can examine associations between co-expressed genes and treatments or outcomes based on data set metadata. An additional post-search analysis, the search refinement function, allows users to iteratively refine their search by limiting the scope of the query search to data sets of a specific disease or tissue of interest, e.g. brain or non-cancer data, if the user wishes to further reveal disease-state or tissue-specific co-expression patterns (<xref ref-type="fig" rid="F2">Fig. 2b, c</xref>). Refine Search currently provides customized search over not only the 2,685 cancer data sets of various tissue origins, but also almost 2,000 non-cancer data sets, including nearly 280 stem cell, over 100 neurodegenerative disease, and 1,400 various immune and other cell type related data sets.</p><p id="P9">Thus, the proposed search approach is effective in enabling robust and accurate search over very large and diverse human expression compendia by defining specific biological questions based on multi-gene queries. Such compendium-wide search is powerful as it identifies and combines relevant information across many data sets, each representing a mixture of signals from diverse pathways affected by disease, environmental factors, and clinical or experimental treatments. SEEK is based on measuring co-expressions, which minimizes biases toward prior knowledge, and accurately extracts functional information without need to explicitly model outcome variables such as treatment and control experiments (<xref ref-type="fig" rid="F1">Fig. 1b</xref> and prior works<sup><xref rid="R5" ref-type="bibr">5</xref>,<xref rid="R6" ref-type="bibr">6,8,19</xref></sup>). The use of co-expression thus enables the robust integration of a large number of data sets from diverse tissues, cell lines, and disease origins, generated from diverse platforms, and it can be extended to make functional comparisons across organisms. A key challenge here is that the search results can be polluted by batch effects<sup><xref rid="R20" ref-type="bibr">20</xref></sup>, poor quality data sets, or even good quality data sets irrelevant to the user&#x02019;s query context. Yet the detailed, targeted correction of these issues in each data set or modeling of each outcome variable is impossible in the context of a very large, multi-platform compendium. SEEK&#x02019;s data set weighting algorithm addresses this challenge, by enabling multi-gene query support for constructing expressive search contexts, and using a discriminative algorithm for identifying which data sets are relevant and accurate in representing query-related biological processes. This algorithm thus automatically down-weights low-quality data sets (e.g. with severe batch effects) (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 7</xref> and <xref ref-type="supplementary-material" rid="SD2">Supplementary Note 4</xref>) and provides accurate retrieval of functionally related genes and data sets (<xref ref-type="fig" rid="F1">Fig. 1b</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Figs. 1, 2</xref>).</p><p id="P10">In summary, SEEK enables biomedical researchers to tap the enormous potential of existing expression data in a flexible, integrative, and interactive way. SEEK allows users to prioritize existing data sets. To our knowledge, SEEK is the first search system that addresses the challenges of cross-platform and cross-data set integrated search in human, integrating the large diversity of microarray and RNASeq platforms, thus fully utilizing the expression compendium, and is the largest scale integration of human transcriptomic data to date. We demonstrated that the ability to effectively search such a large and diverse compendium is important, and that search performance benefits from leveraging more diverse data. As such, we plan to regularly update SEEK&#x02019;s compendium as new microarray and RNASeq data sets become publicly available.</p><sec sec-type="methods" id="S1"><title>Online methods</title><sec id="S2"><title>Data preparation and correlation normalization</title><p id="P11">SEEK assembles its human gene expression compendium by obtaining data sets from NCBI&#x02019;s Gene Expression Omnibus (GEO) database<sup><xref rid="R2" ref-type="bibr">2</xref></sup> and the Cancer Genome Atlas (TCGA)<sup><xref rid="R1" ref-type="bibr">1</xref></sup>. The compendium consists of data sets from 41 platforms including 32 platforms from Affymetrix, Agilent, and Illumina, and 9 RNA sequencing platforms (<xref ref-type="supplementary-material" rid="SD3">Supplementary Data 1</xref>). These platforms were chosen based on the number of available data sets and the availability of raw data to perform consistent processing for each platform. The data sets were processed consistently by applying platform-specific procedures on their raw measurements (<xref ref-type="supplementary-material" rid="SD7">Supplementary Note 5</xref> and <xref ref-type="supplementary-material" rid="SD6">Supplementary Data 4</xref>) to remove the systematic differences among data sets<sup><xref rid="R21" ref-type="bibr">21</xref></sup>. The normalized data sets containing gene-level expression values can be accessed through the SEEK website.</p><p id="P12">The next step of data processing is calculating the Pearson correlations <italic>r<sub>d</sub></italic>(<italic>x, y</italic>) between all pairs of genes <italic>x</italic> and <italic>y</italic> in each data set <italic>d</italic>. As correlation values arising from different genome-wide distributions are not directly comparable across data sets, a Fisher transform procedure<sup><xref rid="R22" ref-type="bibr">22</xref></sup> is applied to convert the distribution of correlations to a normal-like distribution:<disp-formula id="FD1"><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mi>f</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>ln</mml:mtext><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula>
where <italic>f<sub>d</sub></italic>(<italic>x, y</italic>) is the Fisher-transformed score. Then, the data are translated to <italic>z</italic>-scores for standardization:
<disp-formula id="FD2"><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mi>z</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mtext mathvariant="italic">std</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mtext mathvariant="italic">avg</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:math></disp-formula>
where <italic>avg</italic>(<italic>f<sub>d</sub></italic>) is the average of <italic>f<sub>d</sub></italic> for all (<italic>x, y</italic>) pairs, and <italic>std</italic>(<italic>f<sub>d</sub></italic>) is the standard deviation of <italic>f<sub>d</sub></italic>.</p><p id="P13">The normalization procedure has been used in previous studies<sup><xref rid="R5" ref-type="bibr">5</xref>,<xref rid="R23" ref-type="bibr">23</xref></sup>, and has been found successful in transforming most correlation distributions that are generated from different platforms and technologies into a comparable normal distribution with mean 0 and variance 1 (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 8</xref>). Note that SEEK also works well with other correlation measures, such as Spearman and bicor<sup><xref rid="R24" ref-type="bibr">24</xref></sup> (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 9</xref>). We found that the normalized Pearson correlation provides performance better or comparable to that of Spearman and bicor in the search setting, likely because the normalization procedure and the SEEK algorithm itself reduce the effects of outliers in search performance (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 9</xref>).</p></sec><sec id="S3"><title>Search algorithm</title><p id="P14">The search algorithm takes two inputs 1) a set of query genes <italic>Q</italic> = {<italic>q</italic><sub>1</sub>, &#x02026;, <italic>q<sub>x</sub></italic>}, and 2) the set of correlation <italic>z</italic>-scores containing the query: <italic>z<sub>d</sub></italic>(<italic>g, q</italic>), for each data set <italic>d</italic> in the data compendium <italic>D</italic>, for all genes <italic>q</italic> in <italic>Q</italic> and for all genes <italic>g</italic> in the genome <italic>G</italic>. The outputs of the algorithm are a prioritized list of data sets and co-expressed genes relevant to <italic>Q</italic>.</p><p id="P15">The search algorithm consists of four steps. The first step is to load pre-computed <italic>z</italic>-scores of Pearson correlations (in the normalization step above) containing the query across <italic>D</italic>.</p><p id="P16">The second step is to perform hubbiness correction on each data set <italic>d</italic>. The correction procedure is motivated by the observation that hubby<sup><xref rid="R9" ref-type="bibr">9</xref>,<xref rid="R10" ref-type="bibr">10</xref></sup> or well-connected genes in the co-expression network represent global, well-co-expressed processes<sup><xref rid="R25" ref-type="bibr">25</xref></sup>, and can contaminate the search results regardless of query composition due to the effect of unbalanced gene connectivity in a scale-free co-expression network<sup><xref rid="R9" ref-type="bibr">9</xref>,<xref rid="R10" ref-type="bibr">10</xref>,<xref rid="R26" ref-type="bibr">26</xref>&#x02013;<xref rid="R28" ref-type="bibr">28</xref></sup>, and can lead to non-specific results in search or clustering approaches. To avoid the bias created by hubby genes that are not related to the user&#x02019;s query or pathway of interest, our method corrects each gene <italic>g</italic>&#x02019;s correlation to <italic>q</italic> in each data set <italic>d</italic>:
<disp-formula id="FD3"><label>(Eq. 1)</label><mml:math id="M3" display="block" overflow="scroll"><mml:msub><mml:mover><mml:mi>z</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula>
where <bold>&#x0007a;&#x00303;</bold> is the hubbiness-corrected <italic>z</italic>-score. By subtracting <italic>g</italic>&#x02019;s average correlation from the correlation of (<italic>g, q</italic>), we expect the resulting score to emphasize <italic>g</italic>&#x02019;s co-expression specifically with the query rather than its general connectivity. The control of co-expression hubbiness enables the detection of specific biological signals in the data that would otherwise be swamped by broad co-expression patterns of the most well-connected genes.</p><p id="P17">The third step performs cross-validation-based data set weighting. The goal is to rank data sets based on each data set&#x02019;s relevance to the query<sup><xref rid="R5" ref-type="bibr">5</xref></sup>. The result will be the first output of the search system and will also be used to compute the final gene-score vector for the last step. The main idea is to upweight data sets where a subset of the query genes can retrieve the remaining query genes well based on normalized, hubbiness-corrected co-expression in that data set. Thus, it is analogous in spirit to the cross-validation procedures commonly used in machine learning, where a subset of the standard (in this case query) &#x0201c;hides&#x0201d; from the system to assess how well the method can predict these hidden genes.</p><p id="P18">To describe the weighting method, we first introduce some notations. The data set <italic>d</italic> is implicit in each formula below and omitted for brevity, thus <bold>&#x0007a;&#x00303;</bold>(<italic>g, q</italic>) is the corrected <italic>z</italic>-score for <italic>g</italic> to a query gene <italic>q</italic> in <italic>Q</italic> in data set <italic>d</italic>. Let <italic>R<sub>q</sub></italic> = (<italic>g</italic><sup>(1)</sup>, <italic>g</italic><sup>(2)</sup>, <italic>g</italic><sup>(3)</sup>, &#x02026;, <italic>g</italic><sup>(r)</sup>) be the sequence of genes at rank 1, 2, 3, &#x02026;, <italic>r</italic> obtained from ordering genes by decreasing <bold>&#x0007a;&#x00303;</bold>(<italic>g, q</italic>). That is, <italic>R<sub>q</sub></italic> satisfies: <bold>&#x0007a;&#x00303;</bold>(<italic>g</italic><sup>(1)</sup>, <italic>q</italic>) &#x02265; <bold>&#x0007a;&#x00303;</bold>(<italic>g</italic><sup>(2)</sup>, <italic>q</italic>) &#x02265; <bold>&#x0007a;&#x00303;</bold>(<italic>g</italic><sup>(3)</sup>, <italic>q</italic>)&#x02026; Let <italic>r</italic>(<italic>t, R<sub>q</sub></italic>) be the rank of gene <italic>t</italic> in the ranking <italic>R<sub>q</sub></italic> minus 1 (for example, <italic>r</italic>(<italic>g</italic><sup>(1)</sup>, <italic>R<sub>q</sub></italic>) = 0), and let <italic>p</italic> &#x0003c; 1be a rate parameter, which we set at 0.99 based on empirical analysis (<xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 10</xref>). Then the weight of the data set is
<disp-formula id="FD4"><label>(Eq. 2)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>Q</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="true">]</mml:mo></mml:math></disp-formula>
</p><p id="P19">The weighting formula performs cross-validations on <italic>q</italic> in the set <italic>Q</italic>. The goal is to detect which query genes <italic>q</italic> can best retrieve the remainder query <italic>Q &#x02013; q</italic>; such <italic>q</italic>&#x02019;s have a high contribution to <italic>w</italic>. We shorten <italic>r</italic>(<italic>t, R<sub>q</sub></italic>) in <xref ref-type="disp-formula" rid="FD4">Eq. 2</xref> as <italic>r</italic>(<italic>t</italic>). The exact form of this expression for weight (i.e. sum of <italic>p<sup>r</sup></italic><sup>(<italic>t</italic>)</sup>) is inspired by rank-biased precision<sup><xref rid="R29" ref-type="bibr">29</xref></sup>, and is adapted to our setting to robustly measure the effectiveness of the data set in retrieving <italic>Q</italic> &#x02013; <italic>q</italic>. Here, <italic>p</italic> &#x0003c; 1 is the rate parameter in rank-biased precision, and is the parameter of geometric distribution, since <italic>r</italic>(<italic>t</italic>) assumes discrete values. When it is employed, <italic>p<sup>r</sup></italic><sup>(<italic>t</italic>)</sup> upweights ranks for genes <italic>t</italic> in the set <italic>Q</italic> &#x02013; <italic>q</italic> that are high in the rank list (i.e., <italic>r</italic>(<italic>t</italic>) is small), which intuitively emphasizes those genes in the query that are highly co-expressed to each other. The measure has the desired property of upweighting pairs of query genes that are well correlated while not allowing the correlations between the uninformative, non-coherent part of the query to affect the weight of the data set because the query genes may only be partially co-expressed in a given data set. Compared to previous methods<sup><xref rid="R5" ref-type="bibr">5</xref></sup>, our method gains robustness to heterogeneous query signals, because the reward on the highly coherent query genes far outweighs the damaging effect of a few non-coherent query genes, which are poorly ranked to other query genes, have high <italic>r</italic>(<italic>t</italic>), and have scores <italic>p<sup>r</sup></italic><sup>(<italic>t</italic>)</sup> tending to zero.</p><p id="P20">The last step of the algorithm calculates the final integrated gene scores to generate a master ranking of co-expressed genes that is the second output of the system (in addition to data set relevance weighting). We obtain the gene-to-query score matrix <bold>M</bold><sub><italic>G,D</italic></sub>, where the entry <italic>M<sub>g</sub></italic><sub>,<italic>d</italic></sub> is the average corrected <italic>z</italic>-score of gene <italic>g</italic> to the query in data set <italic>d</italic>:
<disp-formula id="FD5"><mml:math id="M5" display="block" overflow="scroll"><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mfrac><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover><mml:mi>z</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></disp-formula>
With the data set weight vector from the previous step <bold>w</bold> = [<italic>w</italic><sub>1</sub>, <italic>w</italic><sub>2</sub>, &#x02026;], a simple formulation of the final gene-score vector <italic>F</italic> is given by:
<disp-formula id="FD6"><mml:math id="M6" display="block" overflow="scroll"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">M</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:msup><mml:mi mathvariant="bold">w</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>w</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:math></disp-formula>
</p><p id="P21">Although previous research had some success with this formulation<sup><xref rid="R5" ref-type="bibr">5</xref></sup>, our findings show that it works well only in the presence of complete gene information with no missing genes in <bold>M</bold><sub><italic>G,D</italic></sub>. When there are heterogeneous sources of data in the compendium (e.g. different microarray and RNAseq platforms), the confounding factor of missing genes and partial gene rankings must be accounted for. Our approach is to modify the procedure above by employing threshold parameters to exclude a data set from weighting if it does not contain enough query genes, and exclude a gene from the final ranking if it is not assayed by a sufficient number of data sets in the compendium (<xref ref-type="supplementary-material" rid="SD2">Supplementary Note 6</xref>).</p><p id="P22">The pseudocode for the entire SEEK search algorithm can be found in <xref ref-type="supplementary-material" rid="SD2">Supplementary Note 6</xref>. The algorithm is robust to query composition (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figs. 1, 2</xref>) and data set quality, including automatically down weighting data sets with substantial batch effects (<xref ref-type="supplementary-material" rid="SD2">Supplementary Note 4</xref> and <xref ref-type="supplementary-material" rid="SD1">Supplementary Fig. 7</xref>).</p><p id="P23">For single-gene queries, the search algorithm performs the same steps above except that in the data set weighting step the algorithm assigns equal weight to all data sets. Thus, for single-gene queries, the search system will treat each data set equally and retrieve genes that are generally correlated with the query in the hubbiness-corrected space. If users wish to perform their single-gene searches in a tissue-specific or disease-specific manner, they can manually define a category of data sets using the extensive &#x0201c;Refine Search&#x0201d; interface on the SEEK website, which will restrict <italic>D</italic> in the search system input.</p></sec><sec id="S4"><title>Estimating the significance of gene scores</title><p id="P24">We estimate a <italic>P</italic> value for each retrieved gene by comparing the integrated score of each gene with scores from a pool of 10,000 randomly generated queries with diverse query sizes varying from 1 to 100 genes. The random pool allows SEEK to estimate the significance of gene-score as well as evaluate the specificity of that gene to the query genes (as opposed to random queries). For a given gene <italic>g</italic> and its final co-expression score <italic>S<sub>Q</sub></italic>(<italic>g</italic>) generated from the user&#x02019;s query <italic>Q</italic>, the <italic>P</italic> value of <italic>g</italic> is estimated as the number of random queries <italic>R</italic> in which <italic>S<sub>R</sub></italic>(<italic>g</italic>) &#x0003e; <italic>S<sub>Q</sub></italic>(<italic>g</italic>) divided by the random pool size.</p></sec><sec id="S5"><title>Algorithm and interface implementations</title><p id="P25">The SEEK algorithm is implemented in C++ and has been integrated into the open-source C++ Sleipnir library, enabling other computational users to use and expand SEEK without website tie-in<sup><xref rid="R30" ref-type="bibr">30</xref></sup>. The backend employs the efficient data structures from the Sleipnir library to facilitate the process of handling large query sets of over 100 genes without memory overflow. SEEK&#x02019;s jobs are parallelized to make full use of the multiprocessor resources and their processing power. The SEEK web server is constructed with some of the latest web technologies including JQuery and Qtip2 libraries. Dynamic pages are generated with Java servlets running behind the Apache Tomcat server on a Red Hat CentOS Linux operating system. In addition, Ajax technology is deployed to send and retrieve data from the server asynchronously such that users can receive instant feedback on their gene enrichment analysis, expression zoom-in function, and data set selection module without having to leave or refresh the page.</p></sec><sec id="S6"><title>Metadata processing</title><p id="P26">SEEK categorizes data sets into tissue and disease groups by mining the description, title, and sample level characteristic fields in data sets&#x02019; metadata. The text mining procedure utilizes the UMLS MetaThesaurus<sup><xref rid="R31" ref-type="bibr">31</xref></sup> and BRENDA<sup><xref rid="R32" ref-type="bibr">32</xref></sup> controlled vocabularies to extract predefined concept names that are present in the individual fields. To ensure that tissue groups are accurate, we manually reviewed annotations to the frequently appearing terms generated by text mining. Similarly, we formed additional &#x02018;meta&#x02019; data set groups, such as cancer and non-cancer groups and the multi-tissue profiling group (<xref ref-type="supplementary-material" rid="SD7">Supplementary Data 5</xref>), to provide users with the ability to limit their search to such groups under the &#x0201c;Refine Search&#x0201d; feature of the website.</p></sec><sec id="S7"><title>Large-scale functional evaluation setup</title><p id="P27">We conducted a comprehensive evaluation of SEEK in comparison with existing algorithms Gene recommender, MEM, and meta-data set correlation search (<xref ref-type="supplementary-material" rid="SD2">Supplementary Note 1</xref>). We tested each system&#x02019;s ability to retrieve genes from the same biological process given some chosen genes from the process as queries. For the evaluation, we partitioned the genes in each of the 995 GO biological process terms (<xref ref-type="supplementary-material" rid="SD4">Supplementary Data 2</xref>) into a <italic>query building set</italic> and a <italic>testing set</italic>. The <italic>query building set</italic> consists of a random sample of 25 genes from each term if the term has more than 40 genes, or else it is made of half of the number of genes in the term. Queries were formed by repeatedly sampling genes from the set, so that each query size has 10 different queries of that size represented, and we iteratively generated queries for sizes 2, 3, 4, &#x02026; up to <italic>Q</italic> genes, where <italic>Q</italic>=0.8|<italic>query building set</italic>|. The <italic>testing set</italic> consists of the remaining genes in the term (after subtracting the <italic>query building set</italic>), and is used for evaluating the queries&#x02019; retrieval results. A precision recall (PR) curve is computed on a per-query basis, averaged over all queries of a term, and finally averaged over all evaluated terms to derive an overall system performance plot for each method. Fold precision over random is calculated at an indicated recall (10%), and uses a random ranking of genes where genes&#x02019; rank positions are shuffled. By selecting genes randomly from each process in building the queries, we mimic the situation in which the query genes are functionally related but not well co-expressed. By keeping the two sets (<italic>query building</italic> and <italic>testing</italic>) separate in the evaluation, we can reduce the performance variation between the queries of the same size within a process.</p><p id="P28">For building gold standard GO gene-set for evaluation, we used gene annotations with experimental evidence codes (IMP, IGI, IPI, IDA, IEP, EXP) as well as TAS (traceable author statements) and NAS (non-traceable author statement). To select the GO slim set (<xref ref-type="supplementary-material" rid="SD5">Supplementary Data 3</xref>) used for studying the effect of compendium size, we carefully examined the title and description of the GO terms in the context of the GO hierarchy and arrived at a non-redundant subset of GO terms that are both specific enough to be informative, and diverse enough to represent the hierarchy, similar to our approach in<sup><xref rid="R33" ref-type="bibr">33</xref></sup>.</p><p id="P29">To evaluate SEEK&#x02019;s performance as a function of the query size, we pooled together previously built biological process queries from 995 processes, then binned them by query size (2&#x02013;20 genes). We examined 3 categories of biological processes based on process size: 20&#x02013;40 genes, 40&#x02013;100 genes, and 100&#x02013;300 genes. Performance refers to the fold precision over random at 10% recall (fold PR10%) in using each query to retrieve remaining genes from its corresponding process.</p><p id="P30">To evaluate the search system&#x02019;s robustness to noisy query genes, we selected over 1,800 5-gene and 10-gene queries from 90 KEGG pathways with 50&#x02013;100 genes per pathway. Each pathway had 10 queries selected of each query size. We established a &#x0201c;no noise&#x0201d; case, where each query was purely made of genes belonging to the same KEGG pathway, and a noisy case, where 1-, 2-, 4- random genes were added to each query. The fraction (fold PR@10% of each noisy query) / (fold PR@10% of the corresponding &#x0201c;no noise&#x0201d; query) was calculated, where fold PR@10% refers to the performance of retrieving KEGG pathway genes using the queries.</p></sec></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>1</label><media xlink:href="NIHMS648616-supplement-1.doc" orientation="portrait" xlink:type="simple" id="d37e1580" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD2"><label>2</label><media xlink:href="NIHMS648616-supplement-2.pdf" orientation="portrait" xlink:type="simple" id="d37e1584" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD3"><label>3</label><media xlink:href="NIHMS648616-supplement-3.xlsx" orientation="portrait" xlink:type="simple" id="d37e1588" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD4"><label>4</label><media xlink:href="NIHMS648616-supplement-4.xlsx" orientation="portrait" xlink:type="simple" id="d37e1592" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD5"><label>5</label><media xlink:href="NIHMS648616-supplement-5.xlsx" orientation="portrait" xlink:type="simple" id="d37e1596" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD6"><label>6</label><media xlink:href="NIHMS648616-supplement-6.xlsx" orientation="portrait" xlink:type="simple" id="d37e1600" position="anchor"/></supplementary-material><supplementary-material content-type="local-data" id="SD7"><label>7</label><media xlink:href="NIHMS648616-supplement-7.xlsx" orientation="portrait" xlink:type="simple" id="d37e1604" position="anchor"/></supplementary-material></sec></body><back><ack id="S8"><p id="P31">The work was supported in part by the NIH award R01 HG005998 and partially supported by the NSF CAREER award (DBI-0546275) and NIH award R01 GM071966 to O.G.T. The project was also partially supported in part by the NIH awards T32 HG003284 and P50 GM071508. M.C. was supported by NSF awards CCF 1218687 and CCF 1302518. O.G.T. is a Senior Fellow of the Canadian Institute For Advanced Research in the Genetic Networks group.</p><p id="P32">We thank members of the Troyanskaya lab for comments and inputs about SEEK in the regular lab meetings, and Qibo Zhu for critically reading the manuscript. We thank the volunteers from Princeton and other universities, including the Canadian Institute for Advanced Research Genetic Networks meetings attendees for testing the SEEK web interface and providing valuable feedback.</p></ack><fn-group><fn id="FN1" fn-type="con"><p id="P33"><bold>Authors&#x02019; contributions</bold></p><p id="P34">Q.Z. and O.G.T. wrote the manuscript. Q.Z., O.G.T., K.L., M.C. designed the algorithm. Q.Z. implemented the search backend and frontend, and performed evaluations. A.K.W., D.C.C., A.K., R.Z., M.R.A., C.S.G. contributed ideas, performed analyses, and edited the manuscript. A.T., L.A.B., Q.Z. performed data and metadata processing. V.N.K., O.G.T. contributed ideas in the biological study. O.G.T., K.L., M.C. conceived the study and gave guidance.</p></fn></fn-group><ref-list><title>References</title><ref id="R1"><label>1</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cancer</surname><given-names>T</given-names></name><name><surname>Atlas</surname><given-names>G</given-names></name></person-group><article-title>Comprehensive genomic characterization defines human glioblastoma genes and core pathways</article-title><source>Nature</source><year>2008</year><volume>455</volume><fpage>1061</fpage><lpage>1068</lpage><pub-id pub-id-type="pmid">18772890</pub-id></element-citation></ref><ref id="R2"><label>2</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Edgar</surname><given-names>R</given-names></name><name><surname>Domrachev</surname><given-names>M</given-names></name><name><surname>Lash</surname><given-names>AE</given-names></name></person-group><article-title>Gene Expression Omnibus: NCBI gene expression and hybridization array data repository</article-title><source>Nucleic Acids Res</source><year>2002</year><volume>30</volume><fpage>207</fpage><lpage>210</lpage><pub-id pub-id-type="pmid">11752295</pub-id></element-citation></ref><ref id="R3"><label>3</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eisen</surname><given-names>MB</given-names></name><name><surname>Spellman</surname><given-names>PT</given-names></name><name><surname>Brown</surname><given-names>PO</given-names></name><name><surname>Botstein</surname><given-names>D</given-names></name></person-group><article-title>Cluster analysis and display of genome-wide expression patterns</article-title><source>Proc. Natl. Acad. Sci. U. S. A</source><year>1998</year><volume>95</volume><fpage>14863</fpage><lpage>14868</lpage><pub-id pub-id-type="pmid">9843981</pub-id></element-citation></ref><ref id="R4"><label>4</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanay</surname><given-names>A</given-names></name><name><surname>Sharan</surname><given-names>R</given-names></name><name><surname>Kupiec</surname><given-names>M</given-names></name><name><surname>Shamir</surname><given-names>R</given-names></name></person-group><article-title>Revealing modularity and organization in the yeast molecular network by integrated analysis of highly heterogeneous genomewide data</article-title><source>Proc. Natl. Acad. Sci. U. S. A</source><year>2004</year><volume>101</volume><fpage>2981</fpage><lpage>2986</lpage><pub-id pub-id-type="pmid">14973197</pub-id></element-citation></ref><ref id="R5"><label>5</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hibbs</surname><given-names>Ma</given-names></name><etal/></person-group><article-title> Exploring the functional landscape of gene expression: directed search of large microarray compendia</article-title><source>Bioinformatics</source><year>2007</year><volume>23</volume><fpage>2692</fpage><lpage>2699</lpage><pub-id pub-id-type="pmid">17724061</pub-id></element-citation></ref><ref id="R6"><label>6</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Owen</surname><given-names>AB</given-names></name><name><surname>Stuart</surname><given-names>J</given-names></name><name><surname>Mach</surname><given-names>K</given-names></name><name><surname>Villeneuve</surname><given-names>AM</given-names></name><name><surname>Kim</surname><given-names>S</given-names></name></person-group><article-title>A Gene Recommender Algorithm to Identify Coexpressed Genes in C. elegans</article-title><source>Genome Res</source><year>2003</year><volume>13</volume><fpage>1828</fpage><lpage>1837</lpage><pub-id pub-id-type="pmid">12902378</pub-id></element-citation></ref><ref id="R7"><label>7</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zinman</surname><given-names>GE</given-names></name><name><surname>Naiman</surname><given-names>S</given-names></name><name><surname>Kanfi</surname><given-names>Y</given-names></name><name><surname>Cohen</surname><given-names>H</given-names></name><name><surname>Bar-Joseph</surname><given-names>Z</given-names></name></person-group><article-title>ExpressionBlast: mining large, unstructured expression databases</article-title><source>Nat. Methods</source><year>2013</year><volume>10</volume><fpage>925</fpage><lpage>926</lpage><pub-id pub-id-type="pmid">24076985</pub-id></element-citation></ref><ref id="R8"><label>8</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Adler</surname><given-names>P</given-names></name><etal/></person-group><article-title>Mining for coexpression across hundreds of datasets using novel rank aggregation and visualization methods</article-title><source>Genome Biol</source><year>2009</year><volume>10</volume><fpage>R139</fpage><pub-id pub-id-type="pmid">19961599</pub-id></element-citation></ref><ref id="R9"><label>9</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barab&#x000e1;si</surname><given-names>A-L</given-names></name><name><surname>Oltvai</surname><given-names>ZN</given-names></name></person-group><article-title>Network biology: understanding the cell&#x02019;s functional organization</article-title><source>Nat. Rev. Genet</source><year>2004</year><volume>5</volume><fpage>101</fpage><lpage>113</lpage><pub-id pub-id-type="pmid">14735121</pub-id></element-citation></ref><ref id="R10"><label>10</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>J-DJ</given-names></name><etal/></person-group><article-title>Evidence for dynamically organized modularity in the yeast protein&#x02013;protein interaction network</article-title><source>Nature</source><year>2004</year><volume>430</volume></element-citation></ref><ref id="R11"><label>11</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kimura</surname><given-names>H</given-names></name><name><surname>Stephen</surname><given-names>D</given-names></name><name><surname>Joyner</surname><given-names>A</given-names></name><name><surname>Curran</surname><given-names>T</given-names></name></person-group><article-title>Gli1 is important for medulloblastoma formation in Ptc1+/&#x02212; mice</article-title><source>Oncogene</source><year>2005</year><volume>24</volume><fpage>4026</fpage><lpage>4036</lpage><pub-id pub-id-type="pmid">15806168</pub-id></element-citation></ref><ref id="R12"><label>12</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oliver</surname><given-names>TG</given-names></name><etal/></person-group><article-title>Transcriptional profiling of the Sonic hedgehog response: a critical role for N-myc in proliferation of neuronal precursors</article-title><source>Proc. Natl. Acad. Sci. U. S. A</source><year>2003</year><volume>100</volume><fpage>7331</fpage><lpage>7336</lpage><pub-id pub-id-type="pmid">12777630</pub-id></element-citation></ref><ref id="R13"><label>13</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>D</given-names></name><name><surname>Karhadkar</surname><given-names>S</given-names></name><name><surname>Hallahan</surname><given-names>A</given-names></name></person-group><article-title>Medulloblastoma growth inhibition by hedgehog pathway blockade</article-title><source>Science</source><year>2002</year><volume>297</volume><fpage>1559</fpage><lpage>1561</lpage><pub-id pub-id-type="pmid">12202832</pub-id></element-citation></ref><ref id="R14"><label>14</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carpenter</surname><given-names>D</given-names></name><etal/></person-group><article-title>Characterization of two patched receptors for the vertebrate</article-title><source>Proc. Natl. Acad. Sci. U. S. A</source><year>1998</year><volume>95</volume><fpage>13630</fpage><lpage>13634</lpage><pub-id pub-id-type="pmid">9811851</pub-id></element-citation></ref><ref id="R15"><label>15</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Oue</surname><given-names>T</given-names></name><name><surname>Yoneda</surname><given-names>A</given-names></name><name><surname>Uehara</surname><given-names>S</given-names></name></person-group><article-title>Increased expression of the hedgehog signaling pathway in pediatric solid malignancies</article-title><source>J. Pediatr. Surg</source><year>2010</year><volume>45</volume><fpage>387</fpage><lpage>392</lpage><pub-id pub-id-type="pmid">20152358</pub-id></element-citation></ref><ref id="R16"><label>16</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jagani</surname><given-names>Z</given-names></name><name><surname>Mora-Blanco</surname><given-names>E</given-names></name><name><surname>Sansam</surname><given-names>C</given-names></name></person-group><article-title>Loss of the tumor suppressor Snf5 leads to aberrant activation of the Hedgehog-Gli pathway</article-title><source>Nat. Med</source><year>2010</year><volume>16</volume><fpage>1429</fpage><lpage>1433</lpage><pub-id pub-id-type="pmid">21076395</pub-id></element-citation></ref><ref id="R17"><label>17</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cohen</surname><given-names>M</given-names></name></person-group><article-title>The hedgehog signaling network</article-title><source>Am. J. Med. Genet. Part A</source><year>2003</year><volume>123A</volume><fpage>5</fpage><lpage>28</lpage><pub-id pub-id-type="pmid">14556242</pub-id></element-citation></ref><ref id="R18"><label>18</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheung</surname><given-names>HO-L</given-names></name><etal/></person-group><article-title>The kinesin protein Kif7 is a critical regulator of Gli transcription factors in mammalian hedgehog signaling</article-title><source>Sci. Signal</source><year>2009</year><volume>2</volume><fpage>ra29</fpage><pub-id pub-id-type="pmid">19549984</pub-id></element-citation></ref><ref id="R19"><label>19</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>HK</given-names></name><name><surname>Hsu</surname><given-names>AK</given-names></name><name><surname>Sajdak</surname><given-names>J</given-names></name><name><surname>Qin</surname><given-names>J</given-names></name><name><surname>Pavlidis</surname><given-names>P</given-names></name></person-group><article-title>Coexpression analysis of human genes across many microarray data sets</article-title><source>Genome Res</source><year>2004</year><volume>14</volume><fpage>1085</fpage><lpage>1094</lpage><pub-id pub-id-type="pmid">15173114</pub-id></element-citation></ref><ref id="R20"><label>20</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leek</surname><given-names>J</given-names></name><name><surname>Scharpf</surname><given-names>R</given-names></name><name><surname>Bravo</surname><given-names>H</given-names></name></person-group><article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title><source>Nat. Rev. Genet</source><year>2010</year><volume>11</volume><fpage>733</fpage><lpage>739</lpage><pub-id pub-id-type="pmid">20838408</pub-id></element-citation></ref></ref-list><ref-list><title>Methods-only references</title><ref id="R21"><label>21</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramasamy</surname><given-names>A</given-names></name><name><surname>Mondry</surname><given-names>A</given-names></name><name><surname>Holmes</surname><given-names>CC</given-names></name><name><surname>Altman</surname><given-names>DG</given-names></name></person-group><article-title>Key issues in conducting a meta-analysis of gene expression microarray datasets</article-title><source>PLoS Med</source><year>2008</year><volume>5</volume><fpage>e184</fpage><pub-id pub-id-type="pmid">18767902</pub-id></element-citation></ref><ref id="R22"><label>22</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>R</given-names></name></person-group><article-title>Frequency distribution of the values of the correlation coefficient in samples from an indefinitely large population</article-title><source>Biometrika</source><year>1915</year><volume>10</volume><fpage>507</fpage><lpage>521</lpage></element-citation></ref><ref id="R23"><label>23</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huttenhower</surname><given-names>C</given-names></name><etal/></person-group><article-title>Exploring the human genome with functional maps</article-title><source>Genome Res</source><year>2009</year><volume>19</volume><fpage>1093</fpage><lpage>1106</lpage><pub-id pub-id-type="pmid">19246570</pub-id></element-citation></ref><ref id="R24"><label>24</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>L</given-names></name><name><surname>Langfelder</surname><given-names>P</given-names></name><name><surname>Horvath</surname><given-names>S</given-names></name></person-group><article-title>Comparison of co-expression measures: mutual information, correlation, and model based indices</article-title><source>BMC Bioinformatics</source><year>2012</year><volume>13</volume><fpage>328</fpage><pub-id pub-id-type="pmid">23217028</pub-id></element-citation></ref><ref id="R25"><label>25</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname><given-names>JM</given-names></name><name><surname>Segal</surname><given-names>E</given-names></name><name><surname>Koller</surname><given-names>D</given-names></name><name><surname>Kim</surname><given-names>SK</given-names></name></person-group><article-title>A gene-coexpression network for global discovery of conserved genetic modules</article-title><source>Science</source><year>2003</year><volume>302</volume><fpage>249</fpage><lpage>255</lpage><pub-id pub-id-type="pmid">12934013</pub-id></element-citation></ref><ref id="R26"><label>26</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Horvath</surname><given-names>S</given-names></name><name><surname>Dong</surname><given-names>J</given-names></name></person-group><article-title>Geometric interpretation of gene coexpression network analysis</article-title><source>PLoS Comput. Biol</source><year>2008</year><volume>4</volume><fpage>e1000117</fpage><pub-id pub-id-type="pmid">18704157</pub-id></element-citation></ref><ref id="R27"><label>27</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ruan</surname><given-names>J</given-names></name><name><surname>Dean</surname><given-names>AK</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name></person-group><article-title>A general co-expression network-based approach to gene expression analysis: comparison and applications</article-title><source>BMC Syst. Biol</source><year>2010</year><volume>4</volume><fpage>8</fpage><pub-id pub-id-type="pmid">20122284</pub-id></element-citation></ref><ref id="R28"><label>28</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Xulvi-Brunet</surname><given-names>R</given-names></name><name><surname>Li</surname><given-names>H</given-names></name></person-group><article-title>Co-expression networks: graph properties and topological comparisons</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>205</fpage><lpage>214</lpage><pub-id pub-id-type="pmid">19910304</pub-id></element-citation></ref><ref id="R29"><label>29</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Moffat</surname><given-names>A</given-names></name><name><surname>Zobel</surname><given-names>J</given-names></name></person-group><article-title>Rank-biased precision for measurement of retrieval effectiveness</article-title><source>ACM Trans. Inf. Syst</source><year>2008</year><volume>27</volume><fpage>1</fpage><lpage>27</lpage></element-citation></ref><ref id="R30"><label>30</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Huttenhower</surname><given-names>C</given-names></name><name><surname>Schroeder</surname><given-names>M</given-names></name><name><surname>Chikina</surname><given-names>MD</given-names></name><name><surname>Troyanskaya</surname><given-names>OG</given-names></name></person-group><article-title>The Sleipnir library for computational functional genomics</article-title><source>Bioinformatics</source><year>2008</year><volume>24</volume><fpage>1559</fpage><lpage>1561</lpage><pub-id pub-id-type="pmid">18499696</pub-id></element-citation></ref><ref id="R31"><label>31</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bodenreider</surname><given-names>O</given-names></name></person-group><article-title>The Unified Medical Language System (UMLS): integrating biomedical terminology</article-title><source>Nucleic Acids Res</source><year>2004</year><volume>32</volume><fpage>D267</fpage><lpage>D270</lpage><pub-id pub-id-type="pmid">14681409</pub-id></element-citation></ref><ref id="R32"><label>32</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gremse</surname><given-names>M</given-names></name><name><surname>Chang</surname><given-names>A</given-names></name><name><surname>Schomburg</surname><given-names>I</given-names></name></person-group><article-title>The BRENDA Tissue Ontology (BTO): the first all-integrating ontology of all organisms for enzyme sources</article-title><source>Nucleic Acids Res</source><year>2011</year><volume>39</volume><fpage>D507</fpage><lpage>D513</lpage><pub-id pub-id-type="pmid">21030441</pub-id></element-citation></ref><ref id="R33"><label>33</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Myers</surname><given-names>C</given-names></name><name><surname>Barrett</surname><given-names>D</given-names></name><name><surname>Hibbs</surname><given-names>M</given-names></name></person-group><article-title>Finding function: evaluation methods for functional genomic data</article-title><source>BMC Genomics</source><year>2006</year><volume>7</volume><fpage>187</fpage><pub-id pub-id-type="pmid">16869964</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="F1" orientation="portrait" position="float"><label>Figure 1</label><caption><title>The SEEK system overview and systematic functional evaluation</title><p id="P35">(<bold>a</bold>) The system overview. Users begin by defining a query gene set of interest. SEEK can easily accommodate gene sets as small as 1&#x02013;2 genes and as large as 100 genes (step 1). The SEEK search engine searches the entire compendium, and returns genes that are co-expressed with the query and the top relevant data sets (steps 2, 3). The web user-interface provides visualizations of gene co-expressions across data sets (step 4), and enables users to iteratively refine their search (<xref ref-type="fig" rid="F2">Fig. 2</xref>) and further analyze the results through condition-specific view (step 5). The latter allows users to check possible associations with the measured outcomes in order to interpret the co-expressed genes (<xref ref-type="supplementary-material" rid="SD2">Supplementary Note 3</xref>). (<bold>b</bold>) Gene retrieval evaluations across 995 diverse GO biological process terms, for each of SEEK, MEM, Gene recommender, and meta-data set correlation algorithms (<xref ref-type="supplementary-material" rid="SD2">Supplementary Note 1</xref>). Queries of diverse sizes (2&#x02013;20 genes) were selected randomly among each term&#x02019;s genes to evaluate the precision of retrieving the remaining genes in each term. Individual term performances (<xref ref-type="supplementary-material" rid="SD4">Supplementary Data 2</xref>) and additional detailed comparative evaluations (<xref ref-type="supplementary-material" rid="SD1">Supplementary Figs. 1, 2</xref>) are provided.</p></caption><graphic xlink:href="nihms648616f1"/></fig><fig id="F2" orientation="portrait" position="float"><label>Figure 2</label><caption><title>Search results for the Hedgehog (Hh) query (<italic>GLI1, GLI2, PTCH1</italic>) and search refinement</title><p id="P36">(<bold>a</bold>) Data sets prioritized and genes retrieved for the query in the main result page, expression view. The result is retrieved from the Hh query after a global compendium search. The top ranked data sets (1) and the co-expressed gene list (2) are indicated. Conditions in each data set are hierarchically clustered in real-time according to the expression values of the top genes retrieved from the search (3). The expression heat-map of the genes in one of the data sets is shown in (4). (<bold>b</bold>) Illustration of the search refinement function. Refine Search enables users to narrow the scope of their search based on a powerful and broad set of selection criteria including tissue, cell-type, or disease categories, platforms, or rank of data sets from initial search (<xref ref-type="supplementary-material" rid="SD2">Supplementary Note 3</xref>). (<bold>c</bold>) The final results after limiting the search scope to brain data sets. Brain-specific co-expressions are noted in this case with higher co-expression scores to the query and better groupings of conditions than the initial search. SEEK also has alternative view modes such as co-expression view, and condition-specific view (<xref ref-type="supplementary-material" rid="SD2">Supplementary Note 3</xref>).</p></caption><graphic xlink:href="nihms648616f2"/></fig></floats-group></article>