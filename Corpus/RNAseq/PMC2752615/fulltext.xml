<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v3.0 20080202//EN" "archivearticle3.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">2752615</article-id><article-id pub-id-type="pmid">19648138</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btp459</article-id><article-id pub-id-type="publisher-id">btp459</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Gene Expression</subject></subj-group></subj-group></article-categories><title-group><article-title>RNA-MATE: a recursive mapping strategy for high-throughput RNA-sequencing data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Cloonan</surname><given-names>Nicole</given-names></name><xref ref-type="corresp" rid="COR1"><sup>*</sup></xref><xref ref-type="author-notes" rid="FN1"><sup>&#x02020;</sup></xref></contrib><contrib contrib-type="author"><name><surname>Xu</surname><given-names>Qinying</given-names></name><xref ref-type="author-notes" rid="FN1"><sup>&#x02020;</sup></xref></contrib><contrib contrib-type="author"><name><surname>Faulkner</surname><given-names>Geoffrey J.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Taylor</surname><given-names>Darrin F.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Tang</surname><given-names>Dave T. P.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Kolle</surname><given-names>Gabriel</given-names></name></contrib><contrib contrib-type="author"><name><surname>Grimmond</surname><given-names>Sean M.</given-names></name></contrib></contrib-group><aff>Queensland Centre for Medical Genomics, Institute for Molecular Bioscience, The University of Queensland, St. Lucia 4072, Australia</aff><author-notes><corresp id="COR1"><sup>*</sup>To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Joaquin Dopazo</p></fn><fn id="FN1"><p><sup>&#x02020;</sup> The authors wish it be known that, in their opinion, the first two authors should be regarded as joint First Authors.</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>10</month><year>2009</year></pub-date><pub-date pub-type="epub"><day>30</day><month>7</month><year>2009</year></pub-date><pub-date pub-type="pmc-release"><day>30</day><month>7</month><year>2009</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the							<pub-date pub-type="epub"/>. --><volume>25</volume><issue>19</issue><fpage>2615</fpage><lpage>2616</lpage><history><date date-type="received"><day>4</day><month>2</month><year>2009</year></date><date date-type="rev-recd"><day>21</day><month>7</month><year>2009</year></date><date date-type="accepted"><day>22</day><month>7</month><year>2009</year></date></history><permissions><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5/uk/">http://creativecommons.org/licenses/by-nc/2.5/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p><bold>Summary:</bold> Mapping of next-generation sequencing data derived from RNA samples (RNAseq) presents different genome mapping challenges than data derived from DNA. For example, tags that cross exon-junction boundaries will often not map to a reference genome, and the strand specificity of the data needs to be retained. Here we present RNA-MATE, a computational pipeline based on a recursive mapping strategy for placing strand specific RNAseq data onto a reference genome. Maximizing the mappable tags can provide significant savings in the cost of sequencing experiments. This pipeline provides an automatic and integrated way to align color-space sequencing data, collate this information and generate files for examining gene-expression data in a genomic context.</p><p><bold>Availability:</bold> Executables, source code, and exon-junction libraries are available from <ext-link ext-link-type="uri" xlink:href="http://grimmond.imb.uq.edu.au/RNA-MATE/">http://grimmond.imb.uq.edu.au/RNA-MATE/</ext-link></p><p><bold>Contact:</bold> <email>n.cloonan@imb.uq.edu.au</email></p><p><bold>Supplementary information:</bold> <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp459/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> Online.</p></abstract></article-meta></front><body><p>High-throughput sequencing technologies can generate hundreds of millions of short tags (typically only 25&#x02013;50 nt) from a single experiment, and this capacity is enabling a new wave of genomic research. Not only is this technology being used for genomic sequencing, re-sequencing and epigenomic applications, but several groups have recently applied this technology to sequence RNA for gene-expression studies (RNAseq).</p><p>Conceptually, RNAseq protocols are simple. Single-stranded RNA molecules are captured between two sequencing adaptors, either through serial ligation (Lister <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2008</xref>) or through random-primed PCR (Cloonan <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2008</xref>), yielding strand specific information. More commonly, RNAseq data is generated from sheared, double-stranded cDNA libraries (Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2008</xref>; Nagalakshmi <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2008</xref>; Sultan <italic>et al.</italic>, <xref ref-type="bibr" rid="B8">2008</xref>; Wilhelm <italic>et al.</italic>, <xref ref-type="bibr" rid="B9">2008</xref>), however this approach loses strand information, which can not always be assumed from annotations (since loci can produce antisense transcripts, and loci on different strands can overlap).</p><p>Some of the benefits of using RNAseq over microarrays to study gene-expression data include: (i) the potentially unlimited dynamic range of expression; (ii) the greater sensitivity of the sequencing data; (iii) the improved ability to discriminate regions of high sequence identity; and (iv) the ability to profile transcription without prior assumptions of which genomic regions are expressed. However, for mammalian genomes, there are technical challenges associated with mapping and counting short-tag sequences. Firstly, mammalian transcripts are non-contiguous due to the splicing of introns from the pre-mRNA, therefore a proportion of tags (those that cross exon-exon boundaries) will not map directly to the genome. The presence of genome wide repeats and other repetitive sequence in the mouse and human genomes means that a sizeable proportion of short tags can not be placed uniquely (Faulkner <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>). Finally, depending on the specific library preparation protocol, a proportion of fragments may be shorter than the full length of the tag sequenced. Such tags will contain adaptor sequence that prevents mapping to the genome. Here we present a computational pipeline to map RNAseq data. RNA-Mapping and Alignment Tools for Expression (RNA-MATE) generates both tag counting and genome-browser visualization of genomic and exon-junction mapping results, addressing the issues above (<xref ref-type="fig" rid="F1">Fig. 1</xref>).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>The RNA-MATE recursive mapping pipeline. The pipeline consists of four major components. (<bold>1</bold>) Tags are (optionally) filtered based on the quality values for each basecall. (<bold>2</bold>) The alignment module attempts to align tags first to the genome, and then to a library of known exon-junction sequences. If a tag fails to align, then the tag is truncated, and the process is repeated. (<bold>3</bold>) The optional tag rescue module uses information derived from both single- and multi-mapping tags to uniquely place multi-mapping tags. (<bold>4</bold>) Finally, UCSC genome browser compatible wiggle plots and BED files are generated.</p></caption><graphic xlink:href="btp459f1"/></fig>
</p><p>Depending on the downstream applications of the mapped data, the quality of individual tags may need to be assessed before inclusion in the mapping dataset. To accommodate this, there is an optional tag quality module, which assesses the tags by the number of basecalls with PHRED scores of &#x0003c;10. If this option is disabled, all tags are passed to the alignment module. Alignment of the short tags to a reference is done using mapreads (<ext-link ext-link-type="uri" xlink:href="http://solidsoftwaretools.com/gf/project/mapreads/">http://solidsoftwaretools.com/gf/project/mapreads/</ext-link>), an algorithm that maps color-space data. Tags are mapped to the reference genome, and then against a library of known exon-junctions (although this default behavior can be modified). Tags that fail to map are chopped to user-defined lengths, and the genomic mapping is restarted. In this way, tags that have adaptor sequence, or poor quality ends are recovered at their longest length. Although this strategy uses more CPU time, it will typically yield between 1.6 and 3 times the mappable tags, providing significant cost savings. The number of mismatches between the reference and tag is user defined, and when unique genomic mappings are selected, only the mappings at the highest level of stringency are retained. Advice on mapping parameters is included in the documentation.</p><p>For most downstream applications, tags are only informative if they can be placed uniquely within a genome. The proportion of transcriptome tags that align to multiple places within a genome will vary depending on the length of the tags, the genome, and the expression in the individual sample, however this is typically between 13&#x02013;38% for mammalian libraries (Cloonan <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2008</xref>; Mortazavi <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2008</xref>). Strategies to rescue ambiguous sequences have recently been applied to high-throughput sequencing data, and we have refined our previously described algorithm (Faulkner <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>) to work efficiently with large data sets. For every multi-mapping tag, the algorithm considers all tags that map near to each of the possible locations of the tag (within a user-specified window) to determine the most likely mapping position of the tag. Where a tag can not be unambiguously assigned, a fractional weighting to the relevant positions is assigned. Between 40 and 60% of multi-mapping tags can be assigned a single position with &#x02265;60% likelihood, depending on the relative sequence coverage (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btp459/DC1">Supplementary Table 1</ext-link>). The recommended window size for shotgun sequencing is 10 nt (Cloonan <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2008</xref>), though for disparate data types currently available this can vary. For instance, Cap Analysis of Gene Expression (CAGE) tags are rescued using a window of 100 nt, a size previously shown to optimize mammalian promoter detection (Carninci <italic>et al.</italic>, <xref ref-type="bibr" rid="B1">2006</xref>).</p><p>Finally, UCSC genome browser compatible wiggle plots for genome mapped data, and BED files for exon-junction mapped data are generated automatically from the collated results. The wiggle plots are strand-specific, single-nucleotide resolution coverage plots, and directly represent the number of times an individual nucleotide has been seen in the sequencing data. BED files depict hits to junction sequences, and graphically display exon combinatorics. In addition, plots containing only start sites of tags are included to facilitate tag-counting applications. Plots generated from particularly deep sequencing may be difficult to upload directly to the UCSC genome browser, and a post-processing script to filter wiggle plots to aid visualization in this way is provided.</p><p>The assignment of tags to genes is facilitated Galaxy (Giardine <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2005</xref>), and a tutorial is provided in the user manual. This allows the comparison of RNAseq data to microarray data, or the visualization and analysis using tools developed for microarrays. In this step, particular care needs to be taken to ensure that different RNAseq protocols are processed with the strand of capture in mind. For example, serial-ligation approaches will generate sequences from the sense strand, relative to the annotated gene, whereas the random-primed strand-specific protocols will generate tags mapping to the anti-sense strand.</p><p>This pipeline described here is written in Perl, and makes use of a PBS queue manager, however it can be configured to use LSF or SGE (detailed in the documentation). Due to the long computational times required for recursive-mapping, implementation on machines without access to a cluster is not recommended, but possible. Future releases will support alternative alignment algorithms, SNP calling, and an easy to use web based GUI. All source code, instructions, testing data, and additional scripts are available from <ext-link ext-link-type="uri" xlink:href="http://grimmond.imb.uq.edu.au/RNA-MATE/">http://grimmond.imb.uq.edu.au/RNA-MATE/</ext-link>.</p>
      <sec sec-type="supplementary-material">
         <title>Supplementary Material</title>
         <supplementary-material id="PMC_1" content-type="local-data">
            <caption>
               <title>[Supplementary Data]</title>
            </caption>
            <media mimetype="text" mime-subtype="html" xlink:href="btp459_index.html"/>
            <media xlink:role="associated-file" mimetype="application" mime-subtype="msword"
                   xlink:href="btp459_bioinf-2009-0180-File002.doc"/>
         </supplementary-material>
      </sec>
   </body><back><ack><title>ACKNOWLEDGEMENTS</title><p>The authors greatly appreciate the advice and sequencing data given to us by Ehsan Nourbakhsh and Brooke Gardiner, and the help with LSF and SGE queues given to us by Xuanzhong Li and Till Bayer.</p><p><italic>Funding</italic>: National Health and Medical Research Council [455857 to S.M.G. 456140, 631701]; the Australian Research Council [DP0988754]; the Australian Stem Cell Centre [to G.J.F, G.K. and D.F.T.]; and the University of Queensland [to N.C. and Q.X.].</p><p><italic>Conflict of Interest:</italic> none declared.</p></ack><ref-list><title>REFERENCES</title><ref id="B1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Carninci</surname><given-names>P</given-names></name><etal/></person-group><article-title>Genome-wide analysis of mammalian promoter architecture and evolution</article-title><source>Nat. Genet.</source><year>2006</year><volume>38</volume><fpage>626</fpage><lpage>635</lpage><pub-id pub-id-type="pmid">16645617</pub-id></element-citation></ref><ref id="B2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cloonan</surname><given-names>N</given-names></name><etal/></person-group><article-title>Stem cell transcriptome profiling via massive-scale mRNA sequencing</article-title><source>Nat. Meth.</source><year>2008</year><volume>5</volume><fpage>613</fpage><lpage>619</lpage></element-citation></ref><ref id="B3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Faulkner</surname><given-names>GJ</given-names></name><etal/></person-group><article-title>A rescue strategy for multimapping short sequence tags refines surveys of transcriptional activity by CAGE</article-title><source>Genomics</source><year>2008</year><volume>91</volume><fpage>281</fpage><lpage>288</lpage><pub-id pub-id-type="pmid">18178374</pub-id></element-citation></ref><ref id="B4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Giardine</surname><given-names>B</given-names></name><etal/></person-group><article-title>Galaxy: a platform for interactive large-scale genome analysis</article-title><source>Genome Res.</source><year>2005</year><volume>15</volume><fpage>1451</fpage><lpage>1455</lpage><pub-id pub-id-type="pmid">16169926</pub-id></element-citation></ref><ref id="B5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lister</surname><given-names>R</given-names></name><etal/></person-group><article-title>Highly integrated single-base resolution maps of the epigenome in Arabidopsis</article-title><source>Cell</source><year>2008</year><volume>133</volume><fpage>523</fpage><lpage>536</lpage><pub-id pub-id-type="pmid">18423832</pub-id></element-citation></ref><ref id="B6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mortazavi</surname><given-names>A</given-names></name><etal/></person-group><article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title><source>Nat. Meth.</source><year>2008</year><volume>5</volume><fpage>621</fpage><lpage>628</lpage></element-citation></ref><ref id="B7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagalakshmi</surname><given-names>U</given-names></name><etal/></person-group><article-title>The transcriptional landscape of the yeast genome defined by RNA sequencing</article-title><source>Science</source><year>2008</year><volume>320</volume><fpage>1344</fpage><lpage>1349</lpage><pub-id pub-id-type="pmid">18451266</pub-id></element-citation></ref><ref id="B8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sultan</surname><given-names>M</given-names></name><etal/></person-group><article-title>A global view of gene activity and alternative splicing by deep sequencing of the human transcriptome</article-title><source>Science</source><year>2008</year><fpage>1160342</fpage></element-citation></ref><ref id="B9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wilhelm</surname><given-names>BT</given-names></name><etal/></person-group><article-title>Dynamic repertoire of a eukaryotic transcriptome surveyed at single-nucleotide resolution</article-title><source>Nature</source><year>2008</year><volume>453</volume><fpage>1239</fpage><lpage>1243</lpage><pub-id pub-id-type="pmid">18488015</pub-id></element-citation></ref></ref-list></back></article>