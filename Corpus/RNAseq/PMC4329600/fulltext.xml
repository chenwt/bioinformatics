<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1d2 20140930//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?subarticle report5915?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing3.dtd?><?SourceDTD.Version 3.0?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">F1000Res</journal-id><journal-id journal-id-type="iso-abbrev">F1000Res</journal-id><journal-id journal-id-type="pmc">F1000Research</journal-id><journal-title-group><journal-title>F1000Research</journal-title></journal-title-group><issn pub-type="epub">2046-1402</issn><publisher><publisher-name>F1000Research</publisher-name><publisher-loc>London, UK</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4329600</article-id><article-id pub-id-type="doi">10.12688/f1000research.4867.1</article-id><article-categories><subj-group subj-group-type="heading"><subject>Software Tool Article</subject></subj-group><subj-group><subject>Articles</subject><subj-group><subject>Bioinformatics</subject></subj-group><subj-group><subject>Genomics</subject></subj-group></subj-group></article-categories><title-group><article-title>High-Performance Mixed Models Based Genome-Wide Association Analysis with omicABEL software</article-title><fn-group content-type="pub-status"><fn><p>v1; ref status: indexed</p></fn></fn-group></title-group><contrib-group><contrib contrib-type="author"><name><surname>Fabregat-Traver</surname><given-names>Diego</given-names></name><xref ref-type="aff" rid="a1">1</xref></contrib><contrib contrib-type="author"><name><surname>Sharapov</surname><given-names>Sodbo Zh.</given-names></name><xref ref-type="aff" rid="a2">2</xref><xref ref-type="aff" rid="a3">3</xref></contrib><contrib contrib-type="author"><name><surname>Hayward</surname><given-names>Caroline</given-names></name><xref ref-type="aff" rid="a4">4</xref></contrib><contrib contrib-type="author"><name><surname>Rudan</surname><given-names>Igor</given-names></name><xref ref-type="aff" rid="a5">5</xref><xref ref-type="aff" rid="a6">6</xref></contrib><contrib contrib-type="author"><name><surname>Campbell</surname><given-names>Harry</given-names></name><xref ref-type="aff" rid="a5">5</xref></contrib><contrib contrib-type="author"><name><surname>Aulchenko</surname><given-names>Yurii</given-names></name><xref ref-type="corresp" rid="c1">a</xref><xref ref-type="aff" rid="a2">2</xref><xref ref-type="aff" rid="a3">3</xref><xref ref-type="aff" rid="a5">5</xref></contrib><contrib contrib-type="author"><name><surname>Bientinesi</surname><given-names>Paolo</given-names></name><xref ref-type="aff" rid="a1">1</xref></contrib><aff id="a1"><label>1</label>Aachen Institute for Advanced Study in Computational Engineering Science, Aachen, 52062, Germany</aff><aff id="a2"><label>2</label>Institute of Cytology and Genetics, Siberian Division of the Russian Academy of Sciences, Novosibirsk, 630090, Russian Federation</aff><aff id="a3"><label>3</label>Novosibirsk State University, Novosibirsk, 630090, Russian Federation</aff><aff id="a4"><label>4</label>MRC Human Genetics Unit, Institute of Genetics and Molecular Medicine, University of Edinburgh, Edinburgh, EH4 2XU, UK</aff><aff id="a5"><label>5</label>Centre for Population Health Sciences, University of Edinburgh, Edinburgh, EH8 9AG, UK</aff><aff id="a6"><label>6</label>Split University, Split, 21000, Croatia</aff></contrib-group><author-notes><corresp id="c1"><label>a</label><email xlink:href="mailto:yurii.aulchenko@gmail.com">yurii.aulchenko@gmail.com</email></corresp><fn fn-type="con"><p>YA and PB jointly designed and supervised the project. DFT and PB developed the methods and algorithms. DFT designed the software, and, together with SZS and YA, analyzed the data. CH, IR and HC provided the data for demonstration analysis. DFT, YA and PB wrote the original version of the paper. All authors contributed to review of the manuscript during its preparation and agreed to the final content.</p></fn><fn fn-type="conflict"><p>
<bold>Competing interests: </bold>No competing interests were disclosed.</p></fn></author-notes><pub-date pub-type="epub"><day>20</day><month>8</month><year>2014</year></pub-date><pub-date pub-type="collection"><year>2014</year></pub-date><volume>3</volume><elocation-id>200</elocation-id><history><date date-type="accepted"><day>7</day><month>8</month><year>2014</year></date></history><permissions><copyright-statement>Copyright: &#x000a9; 2014 Fabregat-Traver D et al.</copyright-statement><copyright-year>2014</copyright-year><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article distributed under the terms of the Creative Commons Attribution Licence, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri content-type="pdf" xlink:type="simple" xlink:href="f1000research-3-5195.pdf"/><abstract><p>To raise the power of genome-wide association studies (GWAS) and avoid false-positive&#x000a0;results in structured populations, one can rely on mixed model based tests.&#x000a0;When large samples are used, and when multiple traits are to be studied in the&#x000a0;&#x02019;omics&#x02019; context, this approach becomes computationally challenging.&#x000a0;Here we consider the problem of mixed-model based GWAS for arbitrary number&#x000a0;of traits, and demonstrate that for the analysis of single-trait and multiple-trait scenarios&#x000a0;different computational algorithms are optimal. We implement these optimal&#x000a0;algorithms in a high-performance computing framework that uses state-of-the-art&#x000a0;linear algebra kernels, incorporates optimizations, and avoids redundant computations,</p><p>increasing throughput while reducing memory usage and energy consumption.&#x000a0;We show that, compared to existing libraries, our algorithms and software&#x000a0;achieve considerable speed-ups.&#x000a0;The OmicABEL software described in this manuscript is available under the GNU</p><p>GPL v. 3 license as part of the GenABEL project for statistical genomics at http:&#x000a0;//www.genabel.org/packages/OmicABEL.</p></abstract><funding-group><award-group id="fund-1"><funding-source>Deutsche Forschungsgemeinschaft</funding-source><award-id>GSC 111</award-id></award-group><award-group id="fund-2"><funding-source>Medical Research Council UK</funding-source></award-group><award-group id="fund-3"><funding-source>Ministry of Science, Education, and Sport of the Republic of Croatia</funding-source><award-id>108-1080315-0302</award-id></award-group><award-group id="fund-4"><funding-source>European Commission FP6 STRP</funding-source><award-id>018947 (LSHG-CT-2006-01947)</award-id></award-group><award-group id="fund-5"><funding-source>RFBR</funding-source><award-id>12-04-91322</award-id></award-group><award-group id="fund-6"><funding-source>Helmholtz society</funding-source><award-id>12-04-91322</award-id></award-group><award-group id="fund-7"><funding-source>Russian Science Foundation</funding-source><award-id>14-14-00313</award-id></award-group><award-group id="fund-8"><funding-source>European Union Seventh Framework Programme (FP7-Health)</funding-source><award-id>305280</award-id></award-group><funding-statement>PB and DFT gratefully acknowledge the support received from the Deutsche Forschungsgemeinschaft (German Research Association) through grant GSC 111. The VIS study in the Croatian island of Vis was supported through the Core grant from the Medical Research Council UK and a grant of the Ministry of Science, Education, and Sport of the Republic of Croatia (number 108-1080315-0302). EUROSPAN (European Special Populations Research Network) was supported by the European Commission FP6 STRP grant number 018947 (LSHG-CT-2006-01947). The work of SZhS was funded by a joint grant from RFBR and the Helmholtz society (Joint Research Groups, 12-04-91322). The work of YA was supported by grant from the Russian Science Foundation (RSCF, grant no. 14-14-00313). The work of IR, CH and HC has received funding from the European Union&#x02019;s Seventh Framework Programme (FP7-Health) under the grant agreement no. 305280 (MIMOmics).</funding-statement></funding-group></article-meta></front><body><sec sec-type="intro"><title>Introduction</title><p>Current biomedical research is experiencing a large boost in the amount of data generated. In particular, investigations involve human cohorts comprising hundreds of thousands of participants as part of nation-wide biobanking initiatives; furthermore, by using both arrays that include hundreds of thousands of single nucleotide polymorphisms (SNPs), and more recently, exome and whole-genome re-sequencing, the genomes of these participants are being characterized at an increasing level of detail, bringing the number of features assessed to tens of millions. At the same time, technologies for high-throughput assessment of different molecular &#x0201c;omics&#x0201d; phenotypes in large study cohorts are becoming more and more affordable. These molecular phenotypes characterize different classes and sub-classes of biological molecules, their functional modifications and relationships. Examples include hundreds of thousands of epigenetic modifications (epigenome
<sup><xref rid="ref-1" ref-type="bibr">1</xref></sup>), levels of tens of thousands of transcripts (transcriptome
<sup><xref rid="ref-2" ref-type="bibr">2</xref>,
<xref rid="ref-3" ref-type="bibr">3</xref></sup>), metabolites (metabonome or metabolome
<sup><xref rid="ref-4" ref-type="bibr">4</xref>,
<xref rid="ref-5" ref-type="bibr">5</xref></sup>), glycans (glyco(protein)ome
<sup><xref rid="ref-6" ref-type="bibr">6</xref>,
<xref rid="ref-7" ref-type="bibr">7</xref></sup>), and proteins (proteome
<sup><xref rid="ref-8" ref-type="bibr">8</xref></sup>). The evolution of current molecular techniques expands our capacity to access different components in the omics space, and new prominent omics emerge (e.g. cellomics, interactomics, activomics). The study of the genetic control of different omics brings the promise of new fundamental and applied biological discoveries; however, such analyses pose &#x0201c;big data&#x0201d; challenges.</p><p>Genome-Wide Association Studies (GWAS) is an established tool for analyzing the genetic control of complex traits
<sup><xref rid="ref-9" ref-type="bibr">9</xref></sup>. In GWAS, the association between millions of genetic markers (usually SNPs) and phenotype(s) of interest is studied, with significant associations highlighting the genomic regions harboring the functional variants involved in the control of the trait. While initially GWAS were mostly used to study common diseases, with the rising availability and affordability of omics phenotypes, this methodology is now also applied to investigate the omics space
<sup><xref rid="ref-6" ref-type="bibr">6</xref>,
<xref rid="ref-7" ref-type="bibr">7</xref>,
<xref rid="ref-10" ref-type="bibr">10</xref>&#x02013;
<xref rid="ref-13" ref-type="bibr">13</xref></sup>, providing important insights into both the mechanisms underlying the genetic regulation of particular biological systems, and the determinants of human health and disease
<sup><xref rid="ref-14" ref-type="bibr">14</xref>&#x02013;
<xref rid="ref-16" ref-type="bibr">16</xref></sup>.</p><p>In this work, we address the computational challenges posed by big-data GWAS. These challenges arise when size of sample under analysis is very large or when (potentially hundreds of) thousands of omics phenotypes are studied. We consider analyses facilitated by the use of linear mixed models (LMMs)
<sup><xref rid="ref-17" ref-type="bibr">17</xref>,
<xref rid="ref-18" ref-type="bibr">18</xref></sup>, which allow for modeling of correlations between phenotypes of relatives. The LMMs are among the most flexible and powerful methods to account for the genetic (sub)structure that inevitably occurs even in carefully designed large population-based studies. However, the increase in power and precision achieved through the use of mixed models comes with considerable costs in terms of computing time.</p><p>Recent advances in GWAS using mixed models
<sup><xref rid="ref-19" ref-type="bibr">19</xref>&#x02013;
<xref rid="ref-25" ref-type="bibr">25</xref></sup> represent a breakthrough compared to older methods, and allow analyses of a limited number of traits in reasonably sized samples even on personal computers. Still, current algorithms and software may be prohibitively expensive for analysis of large samples when dealing with omics data, since the time needed for a multi-trait analysis is essentially that of a one-trait study multiplied by the number of traits. Under this scenario, the analysis of even relatively small samples sizes leads to extremely long wait times. Therefore at the moment, the LMM-based GWAS analysis of large cohorts (tens to hundreds of thousands of participants), and even small (thousands of participants) studies involving omics measurements, represents a considerable problem. This limitation compromises the analyses availability, the data-to-knowledge turnaround time, and leads to excessive energy spending.</p><p>With this work, we aimed to address the aforementioned problems for big-data LMM-based GWAS. To do so, we took advantage of properties specific to the LMM formulation of GWAS, and analyzed a number of possible algorithms applicable to the analysis of large data. By combining sophisticated linear algebra and optimization techniques, we produced a fast and scalable software. Our software facilitates GWAS of tens of thousands of samples and hundreds of thousands of omics phenotypes, without the need for super-computing facilities.</p></sec><sec sec-type="methods" id="m1"><title>Methods</title><sec><title>Linear Mixed Models for GWAS</title><p>In a nutshell, LMM models the phenotypes of a group of
<italic>n</italic> studied individuals as a point in an
<italic>n</italic>-dimensional space, which comes from a multivariate Normal distribution. The expected mean is modeled using a standard regression model as
<italic>E</italic>[
<italic>Y</italic>] =
<italic>X&#x003b2;</italic>, where
<italic>X</italic> is the design matrix which includes the genotypes of interest and other covariates, and
<italic>&#x003b2;</italic> are fixed effects. The variance-covariance matrix is defined as
<italic>M</italic> =
<italic>&#x003c3;</italic>
<sup>2</sup> &#x000b7; (
<italic>h</italic>
<sup>2</sup>&#x003a6; + (1
<italic>&#x02212; h</italic>
<sup>2</sup>)
<italic>I</italic>); here,
<italic>&#x003c3;</italic>
<sup>2</sup> is the total variance of the trait,
<italic>h</italic>
<sup>2</sup> is the heritability coefficient,
<italic>I</italic> is the identity matrix, and &#x003a6; is the matrix containing the relationship coefficients for all pairs of studied individuals. GWAS are performed by consecutively including SNPs in the analysis model (usually one SNP at a time) and computing the association statistics for the included SNP, thus iteratively applying the model throughout the genome.</p><p>The statistical model considered in this work is the same as that outlined in previous works
<sup><xref rid="ref-19" ref-type="bibr">19</xref>&#x02013;
<xref rid="ref-21" ref-type="bibr">21</xref></sup>, and proceeds with analysis in two steps: for each trait considered, we first estimate the matrix of (co)variances between phenotypes, and then we use it when estimating the SNP effects (see
<xref ref-type="other" rid="SNS1">Supplementary Note S1</xref> for mathematical details).</p><p>
<xref ref-type="fig" rid="f1">Figure 1</xref> illustrates how a multi-trait analysis consists of a series of
<italic>t</italic> separate single-trait analyses, each of which, in turn, consists of a series of
<italic>m</italic> Generalized Least-Squares (GLS) problems. The key to fast analysis algorithms is the realization that such problems are correlated, both along the
<italic>m</italic> and the
<italic>t</italic> direction; in big-data GWAS, any approach that ignores such correlations cannot be feasible in terms of time-to-solution.</p><fig fig-type="figure" id="f1" orientation="portrait" position="float"><label>Figure 1. </label><caption><title>Interpretation of multi-trait GWAS as a two-dimensional grid of generalized least-squares problems (
<italic>b</italic> := (
<italic>X
<sup>T</sup> M</italic>
<sup>-1</sup>
<italic>X</italic>)
<sup>-1</sup>
<italic>X
<sup>T</sup> M</italic>
<sup>-1</sup>
<italic>y</italic>).</title><p>GWAS with multiple phenotypes requires the solution of
<italic>m</italic> &#x000d7;
<italic>t</italic> correlated Generalized Least-Squares (GLS) problems, originating a three-dimensional object
<italic>B</italic> of size
<italic>m</italic> &#x000d7;
<italic>t</italic> &#x000d7;
<italic>p</italic>. Along the
<italic>t</italic> direction, the variance-covariance matrix
<italic>M</italic> and the phenotype
<italic>y</italic> vary, while the design matrix
<italic>X</italic> does not; conversely, in the
<italic>m</italic> direction,
<italic>M</italic> and
<italic>y</italic> are fixed while
<italic>X</italic> varies. Specifically,
<italic>X</italic> can be viewed as consisting of two parts,
<italic>X
<sub>L</sub></italic> and
<italic>X
<sub>R</sub></italic>, where the former is constant across the entire grid and the latter changes along
<italic>m</italic>. The figure also captures GWAS with single phenotype, in which case the dimension
<italic>t</italic> reduces to 1.</p></caption><graphic xlink:href="f1000research-3-5195-g0000"/></fig></sec><sec><title>Efficient algorithms for single-trait and multi-trait GWAS</title><p>Aiming at supporting computational scientists in the design of efficient software, two of the authors recently developed CLAK, an algebraic system that replicates the reasoning of human experts for the automatic discovery of linear algebra solvers
<sup><xref rid="ref-26" ref-type="bibr">26</xref></sup>. The core idea is to first decompose a target matrix-based problem in terms of library-supported kernels, and then apply algorithmic and algebraic optimizations. Since the decomposition is not unique, CLAK returns not one but a family of possible solutions, all mathematically equivalent, but exhibiting different space and time complexity.</p><p>With the help of CLAK, we generated many solutions to perform the aforementioned GWAS analyses (for a representative list, see
<xref ref-type="other" rid="ST2">Table S2</xref>). Each solution was subjected to the analysis of its computational complexity, expressing the cost in terms of the number of samples, markers, and traits in question. Interestingly, depending on the number of traits, the best theoretical performance was attained by two different solutions, which we named CLAK-C
<sc>hol</sc> and CLAK-E
<sc>ig</sc> (described in
<xref ref-type="other" rid="ST1">Table S1</xref>), respectively.
<xref ref-type="fig" rid="f2">Figure 2</xref> shows the surfaces representing the time complexity of CLAK-C
<sc>hol</sc> and CLAK-E
<sc>ig</sc> as a function of the number of traits and markers analyzed; the solid curve denotes the crossover between the surfaces. When fewer than four traits are considered, CLAK-C
<sc>hol</sc> attains better theoretical performance; on the contrary, for a higher number of traits, CLAK-E
<sc>ig</sc> is expected to perform better (see also
<xref ref-type="table" rid="T1">Table 1</xref>, and
<xref ref-type="other" rid="SNS1">Supplementary Methods</xref>).</p><fig fig-type="figure" id="f2" orientation="portrait" position="float"><label>Figure 2. </label><caption><title>Cost analysis for CLAK-E
<sc>ig</sc> and CLAK-C
<sc>hol</sc>.</title><p>The brown and blue surfaces indicate the number of operations performed by CLAK-E
<sc>ig</sc> and CLAK-C
<sc>hol</sc>, respectively, for a given number of SNPs and traits. The crossover curve suggests that for analyses with more than just a handful of traits, CLAK-E
<sc>ig</sc> is the fastest algorithm.</p></caption><graphic xlink:href="f1000research-3-5195-g0001"/></fig><table-wrap id="T1" orientation="portrait" position="anchor"><label>Table 1. </label><caption><title>Computational costs for the solution of single-trait and multiple-trait analyses.</title><p>The variables
<italic>n</italic>,
<italic>m</italic> and
<italic>t</italic> denote the sample size, the number of genetic markers, and the number of traits, respectively.
<italic>v</italic> is the average number of iterations necessary to estimate the model parameters
<italic>&#x003c3;</italic>
<sup>2</sup> and
<italic>h</italic>
<sup>2</sup> (see &#x0201c;Time complexity&#x0201d; in
<xref ref-type="other" rid="SNS1">Supplementary Note S1</xref>).</p></caption><table frame="hsides" rules="groups" content-type="article-table"><thead><tr><th align="left" rowspan="1" colspan="1">Algorithm</th><th align="center" rowspan="1" colspan="1">Estimation
<break/>of
<italic>&#x003c3;</italic>
<sup>2</sup> and
<italic>h</italic>
<sup>2</sup>
</th><th align="center" rowspan="1" colspan="1">Single-trait
<break/>analysis</th><th align="center" rowspan="1" colspan="1">Multi-trait
<break/>analysis
<break/>(
<italic>t &#x0003e; n</italic>)</th><th align="center" rowspan="1" colspan="1">Multi-trait
<break/>analysis
<break/>(
<italic>n &#x0003e; t</italic>)</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">CLAK-C
<sc>hol</sc>
</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>n</italic>
<sup>3</sup> +
<italic>tvn</italic>)</td><td align="center" rowspan="1" colspan="1">
<bold>O</bold>(
<bold>mpn
<sup>2</sup></bold>)</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>tmn</italic>
<sup>2</sup>)</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>tmn</italic>
<sup>2</sup>)</td></tr><tr><td align="left" rowspan="1" colspan="1">CLAK-E
<sc>ig</sc>
</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>n</italic>
<sup>3</sup> +
<italic>tvn</italic>)</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>mpn</italic>
<sup>2</sup>)</td><td align="center" rowspan="1" colspan="1">
<bold>O</bold>(
<bold>tmn</bold>)</td><td align="center" rowspan="1" colspan="1">
<bold>O</bold>(
<bold>mn
<sup>2</sup></bold>)</td></tr><tr><td align="left" rowspan="1" colspan="1">FaST-LMM</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>n</italic>
<sup>3</sup> +
<italic>tvn</italic>)</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>mpn</italic>
<sup>2</sup>)</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>tmn</italic>
<sup>2</sup>)</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>tmn</italic>
<sup>2</sup>)</td></tr><tr><td align="left" rowspan="1" colspan="1">GWFGLS</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>n</italic>
<sup>3</sup> +
<italic>tvn</italic>)</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>mpn</italic>
<sup>2</sup>)</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>tmn</italic>
<sup>2</sup>)</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>tmn</italic>
<sup>2</sup>)</td></tr><tr><td align="left" rowspan="1" colspan="1">EMMAX</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>n</italic>
<sup>3</sup> +
<italic>tvn</italic>)</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>mpn</italic>
<sup>2</sup>)</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>tmn</italic>
<sup>2</sup>)</td><td align="center" rowspan="1" colspan="1">
<italic>O</italic>(
<italic>tmn</italic>
<sup>2</sup>)</td></tr></tbody></table></table-wrap><p>The idea underlying CLAK-C
<sc>hol</sc> is to linearly transform the input data to de-correlate the observations. To this end, the variance-covariance matrix
<italic>M</italic> is formed explicitly, and its triangular Cholesky factor
<italic>L</italic> is computed (
<italic>LL
<sup>T</sup></italic> =
<italic>M</italic>); through this factor, each SNP
<italic>X</italic> and each trait
<italic>y</italic> is then linearly transformed, giving raise to a sequence of Ordinary Least Squares problems of the form
<italic>b</italic> := (
<italic>X
<sup>T</sup>X</italic>)
<sup>-1</sup>
<italic>X
<sup>T</sup>y</italic>. While such problems are solvable with standard techniques, CLAK-C
<sc>hol</sc> takes advantage of the fact that the covariates are fixed for all SNPs, hence lowering the computational complexity. In single-trait analyses, it is also possible to exploit the fact that the matrix
<italic>M</italic> is symmetric and positive definite. Although asymptotically the Cholesky factorization is equivalent to an eigen-decomposition, in practice it requires 10 times fewer operations. Moreover, instead of using the eigenvectors (a full matrix) to rotate the SNPs, the Cholesky factor (a triangular matrix) allows us to transform them at half the cost. For more details, see the work we have previously published
<sup><xref rid="ref-27" ref-type="bibr">27</xref></sup> describing the CLAK-C
<sc>hol</sc> algorithm.</p><p>The design of CLAK-E
<sc>ig</sc> is based on three insights: 1) For a given study, the relationship matrix &#x003a6; is constant across both SNPs and traits; 2) since the variance-covariance matrix
<italic>M</italic> is built by merely shifting and scaling relationship matrix, its eigenvectors are the same as those of &#x003a6;, and its eigenvalues are obtained by shifting and scaling those of &#x003a6;; 3) the inverse of
<italic>M</italic> is easily expressed by inverting the diagonal matrix containing its eigenvalues (note that in our solutions we never explicitly invert matrices; we instead factor them, and operate with their factors). Together, these insights suggest that the eigen-decomposition of &#x003a6; can be computed once and for all, and most importantly, the eigenvectors of the relationship matrix can be used to rotate all the SNPs and traits only once. After the data is rotated, the computation of the mixed model based GWAS can be carried out by means of a grid of inexpensive Weighted Least Squares problems.</p><p>Once the initial eigen-decomposition of &#x003a6; is available, the complexity of CLAK-E
<sc>ig</sc> is determined by three operations: the rotation of the SNPs, the rotation of the traits, and the solution of the Weighted Least Squares problems. The dominant term depends on the size of population (
<italic>n</italic>), number of SNPs (
<italic>m</italic>), and number of traits (
<italic>t</italic>). When
<italic>n &#x0003e; t</italic> (or
<italic>n &#x0003e; m</italic>), the overall time complexity comes from the rotation of the SNPs (or the traits), and amounts to
<italic>O</italic>(
<italic>n</italic>
<sup>2</sup>
<italic>m</italic>) (or
<italic>O</italic>(
<italic>n</italic>
<sup>2</sup>
<italic>t</italic>)); if instead both
<italic>t</italic> and
<italic>m</italic> are larger than
<italic>n</italic>, then the dominant term comes from the Least Squares problems, and is linear in population, SNPs and traits:
<italic>O</italic>(
<italic>nmt</italic>) (
<xref ref-type="table" rid="T1">Table 1</xref>). Note that the CLAK-E
<sc>ig</sc> algorithm is a generalization of the eigen-decomposition based algorithms published before (e.g.
<sup><xref rid="ref-22" ref-type="bibr">22</xref>,
<xref rid="ref-28" ref-type="bibr">28</xref></sup>) for a case of multiple trait analysis.</p><p>Compared with current state-of-the-art algorithms
<sup><xref rid="ref-19" ref-type="bibr">19</xref>,
<xref rid="ref-21" ref-type="bibr">21</xref>,
<xref rid="ref-22" ref-type="bibr">22</xref></sup> in multi-trait analyses, CLAK-E
<sc>ig</sc> achieves a lower computational complexity. As shown in
<xref ref-type="table" rid="T1">Table 1</xref>, there are two scenarios of interest, depending on whether the number of traits is larger than the population size or not. In the first case (
<italic>t &#x0003e; n</italic>), which is probably the most typical for current and near-future omics studies, the time complexity of CLAK-E
<sc>ig</sc> is linear on the number of markers, traits, and samples; by contrast, all the other methods have quadratic complexity with the sample size. In the second case (
<italic>n &#x0003e; t</italic>), which takes place for smaller &#x02018;omics&#x02019; and also will become more common with the increasing affordability of omics technologies and hence larger sample sizes, the cost of CLAK-E
<sc>ig</sc> is determined by the sample size and the number of SNPs, and its complexity is a factor
<italic>t</italic> lower than other methods.</p><p>For both CLAK-E
<sc>ig</sc> and CLAK-C
<sc>hol</sc>, the space complexity is mainly determined by the square of the sample size; also, a minimum of one trait, one SNP, and the
<italic>p</italic> covariates must reside in memory. In total, our methods only require enough memory to accommodate
<italic>n</italic>
<sup>2</sup>+(2+
<italic>p</italic>)
<italic>n</italic> entries. If multiple SNPs and/or traits fit in main memory at once, &#x02014;e.g., dozens or hundreds of them&#x02014;the computational throughput of our methods improves noticeably. In this case, the space requirement becomes
<italic>n</italic>
<sup>2</sup>+(
<italic>k</italic>+
<italic>p</italic>)
<italic>n</italic>, where
<italic>k</italic> is the number of SNPs and traits resident in memory. As examples, for sample sizes of 10,000, 20,000 and 40,000, the
<italic>n</italic>
<sup>2</sup> space requirement translates to 1, 3, and 12 GBs, respectively. More details on space complexity are provided in
<xref ref-type="other" rid="SNS1">Supplementary Note S1</xref>.</p></sec></sec><sec sec-type="results"><title>Results</title><sec><title>Implementation and comparison</title><p>To demonstrate the practical advantages of CLAK-E
<sc>ig</sc> and CLAK-C
<sc>hol</sc>, we implemented these algorithms in the O
<sc>mic</sc>ABEL software package. In doing so, we tailored our implementations to save intermediate results across adjacent problems; we also re-organized the calculations to fully benefit from both the efficiency of highly optimized linear algebra kernels, and the parallelism offered by modern computing platforms.</p><p>Since the size of the datasets involved in GWAS is considerably larger than the memory capacity of current processors, input and output data can only be stored in disk devices. Aware that the penalty for accessing information residing on disk is enormous&#x02014;several orders of magnitude greater than the cost for performing one arithmetic operation&#x02014;it is imperative to handle these big-data efficiently. By means of asynchronous transfers between memory and disk, our algorithms achieve a perfect overlap of computation and data movement. As long as the relationship matrix fits in the main memory, and regardless of the size of the data sets&#x02014;both in terms of SNPs and phenotypes&#x02014;, the processor never idles waiting for a transfer to complete, thus computing at maximum efficiency.</p><p>We compared the GWAS run-time of CLAK-C
<sc>hol</sc> and CLAK-E
<sc>ig</sc> as implemented in O
<sc>mic</sc>ABEL with that of several well-established packages: EMMAX
<sup><xref rid="ref-19" ref-type="bibr">19</xref></sup>, FaST-LMM
<sup><xref rid="ref-22" ref-type="bibr">22</xref></sup> (two-step approximation), and GWFGLS (implementation of the mmscore method of ProbABEL
<sup><xref rid="ref-21" ref-type="bibr">21</xref></sup> in the MixABEL-package
<sup><xref rid="ref-29" ref-type="bibr">29</xref></sup>). In the experiments, we considered three different scenarios, varying one among sample size
<italic>n</italic>, number of SNPs
<italic>m</italic>, and number of traits
<italic>t</italic>, while keeping the other two values constant (
<xref ref-type="fig" rid="f3">Figure 3</xref>). A description of the experimental setup is provided in
<xref ref-type="other" rid="SNS2">Supplementary Note S2</xref> and
<xref ref-type="other" rid="SNS3">Supplementary Note S3</xref>.</p><fig fig-type="figure" id="f3" orientation="portrait" position="float"><label>Figure 3. </label><caption><title>Timings comparison.</title><p>Panels (
<bold>a</bold>) and (
<bold>b</bold>) include timings for EMMAX, GWFGLS, FaST-LMM, and our O
<sc>mic</sc>ABEL software, for single trait analyses; (
<bold>c</bold>) and (
<bold>d</bold>) present a comparison of EMMAX, GWFGLS, FaST-LMM, and our O
<sc>mic</sc>ABEL software, in the case of multiple traits. In (
<bold>a</bold>), the number of SNPs is fixed to
<italic>m</italic> = 10
<sup>7</sup> and the sample size
<italic>n</italic> ranges from 1,000 to 40,000. In panel (
<bold>b</bold>), the sample size is fixed to
<italic>n</italic> = 10,000 and the number of SNPs
<italic>m</italic> ranges between 10
<sup>6</sup> and 3.6 &#x000d7; 10
<sup>7</sup>. In (
<bold>c</bold>) and (
<bold>d</bold>),
<italic>n</italic> = 1,000,
<italic>m</italic> = 10
<sup>6</sup> and
<italic>t</italic> ranges from 1 to 100,000.</p></caption><graphic xlink:href="f1000research-3-5195-g0002"/></fig><p>In the first scenario (single trait and
<italic>m</italic> = 10,000,000 SNPs; the sample size varies from 1,000 to 40,000), all methods exhibit a quadratic behavior, and CLAK-C
<sc>hol</sc> is the only algorithm that completed all tests within 25 hours (
<xref ref-type="fig" rid="f3">Figure 3(a)</xref>). For the largest problem considered (sample size
<italic>n</italic> = 40,000), the speed-up over the next-fastest software (FaST-LMM) is 8.3: 205 vs. 25 hours; when
<italic>n</italic> = 1,000, the speed-ups over GWFGLS, FaST-LMM and EMMAX are 24, 32 and 68, respectively: 86, 112 and 240 vs. 3.5 minutes.</p><p>The second scenario (single trait and sample size of 10,000; the number of markers varies between 1 and 36 millions) shows a linear dependence on the number of genetic markers for all software packages. Again, CLAK-C
<sc>hol</sc> attains the best timings, outperforming FaST-LMM, GWFGLS and EMMAX by a factor of 11.7, 93.6 and 298, respectively (
<xref ref-type="fig" rid="f3">Figure 3(b)</xref>), when the number of analysis SNPs is 36 millions.</p><p>Finally, the third scenario illustrates the analysis of multiple phenotypes (sample size of 1,000 and 1,000,000 genetic markers; number of traits varies between 1 and 100,000). The (estimated) time required for these analyses is presented in
<xref ref-type="fig" rid="f3">Figure 3(d)</xref>. Note that the time scale on this graph is in years. Due to CLAK-E
<sc>ig</sc>&#x02019;s linear time complexity with respect to sample size, SNPs and traits, its advantage becomes most apparent: when thousands of traits are considered, CLAK-E
<sc>ig</sc> outperforms GWFGLS, FaST-LMM and EMMAX by a factor of 1012, 1352, and 2789, respectively (
<xref ref-type="fig" rid="f3">Figure 3(d)</xref>), bringing the execution time down from months to hours.</p></sec><sec><title>Demonstration of application to real data</title><p>We applied the O
<sc>mic</sc>ABEL (CLAK-E
<sc>ig</sc>) to study 107,144 metabolomic traits in a sample of 781 people from a genetically isolated population of the Vis island (Croatia). These data are part of the EUROSPAN data set reported in the works of
<xref rid="ref-11" ref-type="bibr">11</xref>, and
<xref rid="ref-12" ref-type="bibr">12</xref>. In short, the data comprise plasma levels of 23 sphingomyelins (SPM), 9 ceramides (CER), 56 phosphatidylcholines (PC), 15 lysophosphatidylcholines (LPC), 27 phosphatidylethanolamines (PE), and 19 PE-based plasmalogens (PLPE). From these data, additional traits were defined by aggregating species into groups with similar characteristics (e.g. unsaturated ceramides), and also by expressing data as molar percentages (instead of absolute concentrations) within classes. Following the standards accepted in genetic analysis of metabolomics data
<sup><xref rid="ref-30" ref-type="bibr">30</xref></sup>, in this work, 328 such measurements served as a base to compute all pair-wise ratios, resulting in 107,584 traits, which were analyzed for association with 266,878 SNPs. More details about the data are provided in
<xref ref-type="other" rid="SNS4">Supplementary Note S4</xref>.</p><p>Previously, it took several weeks to accomplish the original analysis of only few hundreds &#x0201c;original&#x0201d; traits. However, using our O
<sc>mic</sc>ABEL software and a computer with 40 cores, we were able to finish the analysis of more than 100,000 traits in only 8 hours.</p><p>
<xref ref-type="other" rid="ST4">Table S4</xref> shows the results for five SNPs previously reported
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup> to be significantly associated with levels of circulating sphingolipid concentrations. The best results obtained for these SNPs when using the original and derived traits are reported. The implicated traits were also analyzed by using other approaches: the full likelihood ratio test based LMM
<sup><xref rid="ref-18" ref-type="bibr">18</xref>,
<xref rid="ref-22" ref-type="bibr">22</xref></sup> (as implemented in MixABEL::FMM), Grammar-
<italic>&#x003b3;</italic>
<sup><xref rid="ref-25" ref-type="bibr">25</xref></sup> (as implemented in the GenABEL-package
<sup><xref rid="ref-29" ref-type="bibr">29</xref></sup>), and the two-step approach
<sup><xref rid="ref-19" ref-type="bibr">19</xref>&#x02013;
<xref rid="ref-21" ref-type="bibr">21</xref></sup> (as implemented in MixABEL::GWFGLS). From
<xref ref-type="other" rid="ST4">Table S4</xref> one can see that our results are consistent with those obtained by other methods. Additionally,
<xref ref-type="other" rid="ST3">Table S3</xref> summarizes the results concerning heritabilities of analyzed traits, while
<xref ref-type="other" rid="ST5">Table S5</xref> lists the Geinflation factor
<italic>&#x003bb;</italic> obtained when analyzing the selected traits with different methods. More details of the analysis of this human metabolomics data set are provided in
<xref ref-type="other" rid="SNS4">Supplementary Note S4</xref>.</p></sec></sec><sec sec-type="discussion"><title>Discussion</title><p>In contemporary human genomics, methods and tools face the additional challenge posed by the sheer size of the datasets. Big data are produced from the investigation of large human cohorts including hundreds of thousands of participants; these massive samples facilitate the identification of small effects and lead to important biological insights. Large data also come from the field of functional (gen)omics, which aims at establishing the functional roles of genetic variants; hence GWAS are increasingly applied not only to study complex traits in large cohorts, but also to understand the regulation of human and animal transcriptome
<sup><xref rid="ref-15" ref-type="bibr">15</xref>,
<xref rid="ref-31" ref-type="bibr">31</xref>,
<xref rid="ref-32" ref-type="bibr">32</xref></sup>, metabolome
<sup><xref rid="ref-10" ref-type="bibr">10</xref>&#x02013;
<xref rid="ref-12" ref-type="bibr">12</xref></sup>, glyco(protein)ome
<sup><xref rid="ref-6" ref-type="bibr">6</xref>,
<xref rid="ref-7" ref-type="bibr">7</xref></sup> and other types of omics data. Results of these studies are used to uncover the link between these molecular phenotypes and high-level complex traits, including human diseases
<sup><xref rid="ref-14" ref-type="bibr">14</xref>&#x02013;
<xref rid="ref-16" ref-type="bibr">16</xref></sup>.</p><p> In recent years, linear mixed model was accepted as a powerful tool for whole-genome analysis of genetic associations
<sup><xref rid="ref-17" ref-type="bibr">17</xref>,
<xref rid="ref-18" ref-type="bibr">18</xref></sup>. Most current LMM-based methods for GWAS
<sup><xref rid="ref-19" ref-type="bibr">19</xref>&#x02013;
<xref rid="ref-24" ref-type="bibr">24</xref></sup> exhibit linear dependency of the compute time on the number of genetic polymorphisms and traits studied, but at least quadratic dependency on the sample size. A notable exception from the latter &#x0201c;at-least-quadratic&#x0201d; rule is the GRAMMAR-Gamma method
<sup><xref rid="ref-25" ref-type="bibr">25</xref></sup> and a method based on low rank approximation of the similarity matrix
<sup><xref rid="ref-22" ref-type="bibr">22</xref></sup> - with the latter exploiting the ideas similar to EIGENSTRAT approach
<sup><xref rid="ref-33" ref-type="bibr">33</xref></sup> and the methods assuming the adjustment of the model for top Principal Components of the kinship matrix variation. However, the computational advantage of these methods comes at the cost of mathematical approximation. For example, the GRAMMAR-Gamma method, while extremely fast, and showing excellent results for human studies, is less suited for analyses of samples with uneven genetic structure; adjusting for top principle components (and EIGENSTRAT) is known to provide incomplete correction for stratification in case of complex kinship. Increasing sample sizes and availability of molecular omics phenotypes lead to &#x0201c;big data challenges&#x0201d; and the computational throughput of LMM&#x02019;s starts being more and more of an issue, which at present sometimes cannot be resolved without resorting to supercomputing facilities.</p><p>With this work, we address the problem of mixed-model based whole-genome analysis of genetic association for an arbitrary number of traits. We describe the CLAK-C
<sc>hol</sc> and CLAK-E
<sc>ig</sc> algorithms and software tools (O
<sc>mic</sc>ABEL package) to address LMM-based GWAS. Specifically, our CLAK-C
<sc>hol</sc> will be useful for investigation of complex traits in very large (tens of thousands of individuals) samples, while CLAK-E
<sc>ig</sc> will be a useful tool for the investigation of genetic control of different omics, potentially including hundreds of thousands or even millions of features.</p><p>As for our CLAK-C
<sc>hol</sc> approach, we are not aware of similar, Cholesky-based solutions proposed before. The CLAK-E
<sc>ig</sc> approach behind our solutions bear similarities, and actually reduces to previously suggested methods (e.g.
<sup><xref rid="ref-22" ref-type="bibr">22</xref>,
<xref rid="ref-28" ref-type="bibr">28</xref></sup>) when the number of traits is one. It is also worth mentioning the Matrix eQTL software
<sup><xref rid="ref-34" ref-type="bibr">34</xref></sup>, which, while not implementing the LMM, in many respects exploits the problem-specific properties of multi-trait GWAS in the ways similar to ours.</p><p>The key achievement of this research is that it facilitates big-data LMM-based GWAS without supercomputers. For a sample problem with a population of 1,000, three covariates, one million SNPs and 100,000 traits, we estimate that the available methods would require the entire Sequoia supercomputer (equipped with 1.5 million cores)
<sup><xref ref-type="other" rid="N1">1</xref></sup> for about 3 minutes; by contrast, using a common 40-core compute node (see
<xref ref-type="other" rid="SNS1">Supplementary Methods</xref>,
<xref ref-type="other" rid="SNS2">Note S2</xref>), our method completes within a day and reduces the energy consumption by a factor of 200 (estimated). It should be noted that this impressive speed-up comes at the price of additional assumption of complete data. For many types of omics assays assumption of absence of missing data could be (almost) true, and a small proportion of missing data could be imputed (in the simplest case &#x02013; replaced with average value) with little negative effect onto statistical properties of the method. However, for the omics assays which produce large proportion of missing data, our CLAK-E
<sc>ig</sc> method in its current formulation and implementation would be inapplicable, unless the missing values could be reliably imputed.</p><p>In case of single-trait analysis, our results are somewhat less impressive, and our CLAK-C
<sc>hol</sc> solution outperforms advanced current methods (e.g. FaST-LMM) by about one order of magnitude for large-sample-size problems. It is worth mentioning that the latter speed-up becomes possible because we show that for single-trait GWAS problems our CLAK-C
<sc>hol</sc> algorithm is superior to CLAK-E
<sc>ig</sc>, but other current methods are actually implementing solutions similar to our CLAK-E
<sc>ig</sc> algorithm to address the single-trait GWAS problem.</p><p>Further optimizations of our solutions are possible, for instance by exploiting the structure of the kinship matrix. A &#x0201c;compressed MLM&#x0201d; approach was proposed for decreasing the effective sample size of datasets by clustering individuals into groups
<sup><xref rid="ref-20" ref-type="bibr">20</xref></sup>; similarly, the fast decaying and possibly sparse structure of the kinship matrix can be exploited to lower the number of mathematical operations. Caution must be exercised in the interpretation of findings resulting from GWAS analyses as they may generate false positives if the multiple testing problem is not addressed adequately. A conservative strategy to determine whether an association is statistically significant would be to apply a Bonferronni correction, that is, in our example analysis of 107,144 traits, the conventional genome-wide significance threshold
<italic>p</italic>-value of 5 &#x000b7; 10
<sup>-8</sup> should be replaced by 4.7 &#x000b7; 10
<sup>-13</sup>. This is the common approach applied in the metabolomics studies (see
<sup><xref rid="ref-10" ref-type="bibr">10</xref>,
<xref rid="ref-30" ref-type="bibr">30</xref></sup>). On the other hand, this threshold would probably be too conservative, given that many of the measurements may be highly correlated. Several methods have been introduced recently
<sup><xref rid="ref-35" ref-type="bibr">35</xref>&#x02013;
<xref rid="ref-37" ref-type="bibr">37</xref></sup>, which may help to overcome this problem; however, this topic lays outside the scope of the current work.</p><p>For the analysis of specific omics data, our methods (and software) might require some modifications. For example, in the genetic regulation of human transcriptome, large attention is dedicated to cis-eQTLs, computationally a relatively simple task. In contrast, our implementation is tailored to perform full GWAS for every trait analyzed. While O
<sc>mic</sc>ABEL could be used for the identification of trans-eQTLs, one should be aware of the specifics of the analysis of this type of data (e.g. allele-specific expression in RNAseq studies) and a body of methods developed (e.g. methods to account for influences of hidden factors
<sup><xref rid="ref-38" ref-type="bibr">38</xref>,
<xref rid="ref-39" ref-type="bibr">39</xref></sup>).</p><p>We foresee that the primary use of our algorithms and software is within the domain of analysis of complex traits in very large samples and for the genetic analysis of &#x0201c;omics&#x0201d; data. However, potentially, there are other uses. The same set of methods and tools can be used for scanning through other omics in e.g. search for biomarkers for a complex trait or in order to determine functional relations between different omics. For example, one may be interested in doing epigenome-wide scans relating the epigenome to a complex trait (or other omics, such as metabolome). Under this use, the genomic inputs would be replaced by epigenomic data. Advanced statistical and machine learning methods, such as penalized regression, can make use of joint analysis of up to several hundreds of thousands of predictors
<sup><xref rid="ref-40" ref-type="bibr">40</xref></sup>. One of the common scenarios include the construction of millions of features, and their filtering for further joint analysis&#x02014;a task which can be also effectively addressed by our methods. Finally, our algorithms can be easily extended, e.g. to search for interactions.</p></sec><sec sec-type="conclusions"><title>Conclusions</title><p>We demonstrated that different computational algorithms are optimal for the problems of single- and multi-trait Mixed-Model based GWAS, and implemented these algorithms in a freely available O
<sc>mic</sc>ABEL software.</p></sec><sec><title>Software availability</title><sec><title>Software access</title><p>The O
<sc>mic</sc>ABEL software implementing computational methods described in this manuscript is available as part of the G
<sc>en</sc>ABEL project for statistical genomics at
<ext-link ext-link-type="uri" xlink:href="http://www.genabel.org/packages/OmicABEL">http://www.genabel.org/packages/OmicABEL</ext-link>. The web-page provides the link to O
<sc>mic</sc>ABEL tutorial, giving examples of its use.</p></sec><sec><title>Latest source code</title><p>
<ext-link ext-link-type="uri" xlink:href="https://r-forge.r-project.org/scm/viewvc.php/pkg/OmicABEL/?root=genabel">https://r-forge.r-project.org/scm/viewvc.php/pkg/OmicABEL/?root=genabel</ext-link>
</p></sec><sec><title>Archived source code as at the time of publication</title><p>
<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.10999">http://dx.doi.org/10.5281/zenodo.10999</ext-link>
<sup><xref rid="ref-41" ref-type="bibr">41</xref></sup>
</p></sec><sec><title>Software license</title><p>GNU GPL v. 3</p></sec></sec></body><back><ack><title>Acknowledgements</title><p>We are grateful to Tatiana Axenovich, Felix Agakov, Xia Shen, and Lars R&#x000f6;nneg&#x000e5;rd for fruitful discussion of the manuscript, and to Nadezhda Belonogova for help with setting up the analysis. We thank the Center for Computing and Communication at RWTH Aachen for the computing resources.</p></ack><sec><title>Supplementary Tables</title><table-wrap id="ST1" orientation="portrait" position="anchor"><label>Table S1. </label><caption><title>The CLAK-C
<sc>hol</sc> and CLAK-E
<sc>ig</sc> algorithms for single-trait and multi-trait analyses, respectively.</title></caption><table frame="hsides" rules="groups" content-type="article-table"><thead><tr><th align="left" rowspan="1" colspan="1">CLAK-C
<sc>hol</sc>: Single-trait analysis</th><th align="left" rowspan="1" colspan="1">&#x000a0;&#x000a0;</th><th align="left" rowspan="1" colspan="1">CLAK-E
<sc>ig</sc>: Multi-trait analysis</th></tr></thead><tbody><tr><td valign="top" rowspan="1" colspan="1">1&#x000a0;&#x000a0;&#x000a0;
<mml:math id="math1"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math> :=
<mml:math id="math2"><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>(
<mml:math id="math3"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>&#x003a6; + (1 &#x02013;
<mml:math id="math4"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>)
<italic>I</italic>)
<break/>2&#x000a0;&#x000a0;&#x000a0;
<italic>LL
<sup>T</sup></italic> =
<mml:math id="math5"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<break/>
<break/>3&#x000a0;&#x000a0;&#x000a0;
<italic>X
<sub>L</sub></italic> :=
<italic>L</italic>
<sup>&#x02013;1</sup>
<italic>X
<sub>L</sub></italic>
<break/>
<break/>4&#x000a0;&#x000a0;&#x000a0;
<italic>X
<sub>R</sub></italic> :=
<italic>L</italic>
<sup>&#x02013;1</sup>
<italic>X
<sub>R</sub></italic>
<break/>
<break/>5&#x000a0;&#x000a0;&#x000a0;
<italic>y</italic> :=
<italic>L</italic>
<sup>&#x02013;1</sup>
<italic>y</italic>
<break/>
<break/>6&#x000a0;&#x000a0;&#x000a0;
<italic>S
<sub>TL</sub></italic> :=
<italic>X
<sup>T</sup><sub>L</sub> X
<sub>L</sub></italic>
<break/>
<break/>7&#x000a0;&#x000a0;&#x000a0;
<italic>b
<sub>T</sub></italic> :=
<italic>X
<sup>T</sup><sub>L</sub> y</italic>
<break/>
<break/>8&#x000a0;&#x000a0;&#x000a0;
<bold>for</bold>&#x000a0;&#x000a0;&#x000a0;i = 1:m
<break/>
<break/>9&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<mml:math id="math6"><mml:mrow><mml:mi>S</mml:mi><mml:mo>&#x02009;</mml:mo><mml:mtext>:=</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02009;</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>*</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
<break/>
<break/>10&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<mml:math id="math7"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02009;</mml:mo></mml:mrow></mml:msub><mml:mo>&#x02009;</mml:mo><mml:mtext>:=</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mi>y</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
<break/>
<break/>11&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<italic>b
<sub>i</sub></italic> :=
<italic>S</italic>
<sub><italic>i</italic></sub>
<sup>&#x02013;1</sup>
<italic>b
<sub>i</sub></italic>
</td><td rowspan="1" colspan="1">&#x000a0;&#x000a0;</td><td rowspan="1" colspan="1">1&#x000a0;&#x000a0;&#x000a0;
<italic>ZWZ
<sup>T</sup></italic> = &#x003a6;
<break/>
<break/>2&#x000a0;&#x000a0;&#x000a0;
<italic>X
<sub>L</sub></italic> :=
<italic>Z
<sup>T</sup> X
<sub>L</sub></italic>
<break/>
<break/>3&#x000a0;&#x000a0;&#x000a0;
<italic>X
<sub>R</sub></italic> :=
<italic>Z
<sup>T</sup> X
<sub>R</sub></italic>
<break/>
<break/>4&#x000a0;&#x000a0;&#x000a0;
<italic>Y</italic> :=
<italic>Z
<sup>T</sup> Y</italic>
<break/>
<break/>5&#x000a0;&#x000a0;&#x000a0;
<bold>for</bold>&#x000a0;&#x000a0;&#x000a0;j = 1: t
<break/>6&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<italic>D</italic> := (
<mml:math id="math8"><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>
<sub>j</sub>(
<mml:math id="math9"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>
<sub>j</sub>
<italic>W</italic> + (1 &#x02013;
<mml:math id="math10"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>
<sub>j</sub>)
<italic>I</italic>))
<sup>&#x02013;1</sup>
<break/>
<break/>7&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<italic>KK
<sup>T</sup></italic> =
<italic>D</italic>
<break/>
<break/>8&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<italic>Y
<sub>j</sub></italic> :=
<italic>K
<sup>T</sup> Y
<sub>j</sub></italic>
<break/>
<break/>9&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<italic>W
<sub>L</sub></italic> :=
<italic>K
<sup>T</sup> X
<sub>L</sub></italic>
<break/>
<break/>10&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<italic>S
<sub>TL</sub></italic> :=
<italic>W
<sup>T</sup><sub>L</sub> W
<sub>L</sub></italic>
<break/>
<break/>11&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<italic>b
<sub>T</sub></italic> :=
<italic>W
<sup>T</sup><sub>L</sub> Y
<sub>j</sub></italic>
<break/>
<break/>12&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<bold>for</bold>&#x000a0;&#x000a0;&#x000a0;i = 1:m
<break/>
<break/>13&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<italic>W
<sub>R</sub></italic> :=
<italic>K
<sup>T</sup> X
<sub>R
<sub>i</sub></sub></italic>
<break/>
<break/>14&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<mml:math id="math11"><mml:mrow><mml:mi>S</mml:mi><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mtext>:=</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02009;</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>*</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>W</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
<break/>
<break/>15&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<mml:math id="math12"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02009;</mml:mo><mml:mtext>:=</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>Y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math>
<break/>
<break/>16&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;
<italic>b
<sub>ij</sub></italic> :=
<italic>S</italic>
<sup>&#x02013;1</sup>
<italic>b
<sub>ij</sub></italic>
</td></tr></tbody></table></table-wrap><table-wrap id="ST2" orientation="portrait" position="anchor"><label>Table S2. </label><caption><title>Representative list of algorithms for solving a single generalized least-squares problem, as generated by the
CLAK expert system.</title></caption><table frame="hsides" rules="groups" content-type="article-table"><thead><tr><th align="left" rowspan="1" colspan="1">CLAK-C
<sc>hol</sc>&#x02019;s for a single GLS problem</th><th align="left" rowspan="1" colspan="1">&#x000a0;&#x000a0;</th><th align="left" rowspan="1" colspan="1">CLAK-E
<sc>ig</sc>&#x02019;s for a single GLS problem</th></tr></thead><tbody><tr><td valign="top" rowspan="1" colspan="1">1&#x000a0;&#x000a0;&#x000a0;
<mml:math id="math13"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math> :=
<mml:math id="math14"><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>(
<mml:math id="math15"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>&#x003a6; + (1 &#x02013;
<mml:math id="math16"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>)
<italic>I</italic>)
<break/>2&#x000a0;&#x000a0;&#x000a0;
<italic>LL
<sup>T</sup></italic> =
<mml:math id="math17"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<break/>
<break/>3&#x000a0;&#x000a0;&#x000a0;
<italic>X</italic> :=
<italic>L</italic>
<sup>&#x02013;1</sup>
<italic>X</italic>
<break/>
<break/>4&#x000a0;&#x000a0;&#x000a0;
<italic>y</italic> :=
<italic>L</italic>
<sup>&#x02013;1</sup>
<italic>y</italic>
<break/>
<break/>5&#x000a0;&#x000a0;&#x000a0;
<italic>S</italic> :=
<italic>X
<sup>T</sup>X</italic>
<break/>
<break/>6&#x000a0;&#x000a0;&#x000a0;
<italic>b</italic> :=
<italic>X
<sup>T</sup>y</italic>
<break/>
<break/>7&#x000a0;&#x000a0;&#x000a0;
<italic>b</italic> :=
<italic>S</italic>
<sup>&#x02013;1</sup>
<italic>b</italic>
</td><td rowspan="1" colspan="1">&#x000a0;&#x000a0;</td><td valign="top" rowspan="1" colspan="1">1&#x000a0;&#x000a0;&#x000a0;
<italic>ZWZ
<sup>T</sup></italic> = &#x003a6;
<break/>2&#x000a0;&#x000a0;&#x000a0;
<italic>D</italic> := (
<mml:math id="math18"><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>(
<mml:math id="math19"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>
<italic>W</italic> + (1 &#x02013;
<mml:math id="math20"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>)
<italic>I</italic>))
<sup>&#x02013;1</sup>
<break/>
<break/>3&#x000a0;&#x000a0;&#x000a0;
<italic>KK
<sup>T</sup></italic> =
<italic>D</italic>
<break/>
<break/>4&#x000a0;&#x000a0;&#x000a0;
<italic>X'</italic> :=
<italic>Z
<sup>T</sup>X</italic>
<break/>
<break/>5&#x000a0;&#x000a0;&#x000a0;
<italic>y'</italic> :=
<italic>Z
<sup>T</sup>y</italic>
<break/>
<break/>6&#x000a0;&#x000a0;&#x000a0;
<italic>V</italic> :=
<italic>K
<sup>T</sup>X'</italic>
<break/>
<break/>7&#x000a0;&#x000a0;&#x000a0;
<italic>&#x003bd;</italic> :=
<italic>K
<sup>T</sup>y'</italic>
<break/>
<break/>8&#x000a0;&#x000a0;&#x000a0;
<italic>S</italic> :=
<italic>V
<sup>T</sup>V</italic>
<break/>
<break/>9&#x000a0;&#x000a0;&#x000a0;
<italic>b</italic> :=
<italic>V
<sup>T</sup>&#x003bd;</italic>
<break/>
<break/>10&#x000a0;&#x000a0;&#x000a0;
<italic>b</italic> :=
<italic>S</italic>
<sup>&#x02013;1</sup>
<italic>b</italic>
</td></tr><tr><th align="left" rowspan="1" colspan="1">Algorithm 7</th><th align="left" rowspan="1" colspan="1">&#x000a0;&#x000a0;</th><th align="left" rowspan="1" colspan="1">Algorithm 13</th></tr><tr><td valign="top" rowspan="1" colspan="1">1&#x000a0;&#x000a0;&#x000a0;
<mml:math id="math21"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math> :=
<mml:math id="math22"><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>(
<mml:math id="math23"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>&#x003a6; + (1 &#x02013;
<mml:math id="math24"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>)
<italic>I</italic>)
<break/>2&#x000a0;&#x000a0;&#x000a0;
<italic>LL
<sup>T</sup></italic> =
<mml:math id="math25"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<break/>
<break/>3&#x000a0;&#x000a0;&#x000a0;
<italic>X</italic> :=
<italic>L</italic>
<sup>&#x02013;1</sup>
<italic>X</italic>
<break/>
<break/>4&#x000a0;&#x000a0;&#x000a0;
<italic>QR</italic> :=
<italic>X</italic>
<break/>
<break/>5&#x000a0;&#x000a0;&#x000a0;
<italic>y</italic> :=
<italic>L</italic>
<sup>&#x02013;1</sup>
<italic>y</italic>
<break/>
<break/>6&#x000a0;&#x000a0;&#x000a0;
<italic>b</italic> :=
<italic>Q
<sup>T</sup>y</italic>
<break/>
<break/>7&#x000a0;&#x000a0;&#x000a0;
<italic>b</italic> :=
<italic>R</italic>
<sup>&#x02013;1</sup>
<italic>b</italic>
</td><td rowspan="1" colspan="1">&#x000a0;&#x000a0;</td><td valign="top" rowspan="1" colspan="1">1&#x000a0;&#x000a0;&#x000a0;
<italic>ZWZ
<sup>T</sup></italic> = &#x003a6;
<break/>2&#x000a0;&#x000a0;&#x000a0;
<italic>D</italic> := (
<mml:math id="math26"><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>(
<mml:math id="math27"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>
<italic>W</italic> + (1 &#x02013;
<mml:math id="math28"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>)
<italic>I</italic>))
<sup>&#x02013;1</sup>
<break/>
<break/>3&#x000a0;&#x000a0;&#x000a0;
<italic>KK
<sup>T</sup></italic> =
<italic>D</italic>
<break/>
<break/>4&#x000a0;&#x000a0;&#x000a0;
<italic>X'</italic> :=
<italic>Z
<sup>T</sup>X</italic>
<break/>
<break/>5&#x000a0;&#x000a0;&#x000a0;
<italic>V</italic> :=
<italic>K
<sup>T</sup>X'</italic>
<break/>
<break/>6&#x000a0;&#x000a0;&#x000a0;
<italic>QR</italic> :=
<italic>V</italic>
<break/>
<break/>7&#x000a0;&#x000a0;&#x000a0;
<italic>y'</italic> :=
<italic>L</italic>
<sup>&#x02013;1</sup>
<italic>y</italic>
<break/>
<break/>8&#x000a0;&#x000a0;&#x000a0;
<italic>&#x003bd;</italic> :=
<italic>K
<sup>T</sup>y'</italic>
<break/>
<break/>9&#x000a0;&#x000a0;&#x000a0;
<italic>b</italic> :=
<italic>Q
<sup>T</sup>&#x003bd;</italic>
<break/>
<break/>10&#x000a0;&#x000a0;&#x000a0;
<italic>b</italic> :=
<italic>R</italic>
<sup>&#x02013;1</sup>
<italic>b</italic>
</td></tr></tbody></table></table-wrap><table-wrap id="ST3" orientation="portrait" position="anchor"><label>Table S3. </label><caption><title>Regression analysis of heritability estimates in different traits classes.</title><p>The label &#x0201c;Original&#x0201d; refers to the average heritability of the original traits (intercept of the model); similarly, &#x0201c;cer-cer&#x0201d; refers to the heritability of ratios involving CER, &#x0201c;cer-lpc&#x0201d; to the heritability of ratios involving CER and LPC, and so on.</p></caption><table frame="hsides" rules="groups" content-type="article-table"><thead><tr><th align="left" rowspan="1" colspan="1">Trait</th><th align="center" rowspan="1" colspan="1">Estimate</th><th align="center" rowspan="1" colspan="1">Std. Error</th><th align="center" rowspan="1" colspan="1">t value</th><th align="center" rowspan="1" colspan="1">Pr(&#x0003e; |
<italic>t</italic>|)</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">Original</td><td align="center" rowspan="1" colspan="1">0.310493</td><td align="center" rowspan="1" colspan="1">0.007645</td><td align="center" rowspan="1" colspan="1">40.613</td><td align="center" rowspan="1" colspan="1">&#x0003c; 2e-16</td></tr><tr><td align="left" rowspan="1" colspan="1">cer-cer</td><td align="center" rowspan="1" colspan="1">0.126283</td><td align="center" rowspan="1" colspan="1">0.009268</td><td align="center" rowspan="1" colspan="1">13.625</td><td align="center" rowspan="1" colspan="1">&#x0003c; 2e-16</td></tr><tr><td align="left" rowspan="1" colspan="1">cer-lpc</td><td align="center" rowspan="1" colspan="1">0.009870</td><td align="center" rowspan="1" colspan="1">0.008183</td><td align="center" rowspan="1" colspan="1">1.206</td><td align="center" rowspan="1" colspan="1">0.22777</td></tr><tr><td align="left" rowspan="1" colspan="1">cer-pc</td><td align="center" rowspan="1" colspan="1">0.012576</td><td align="center" rowspan="1" colspan="1">0.007833</td><td align="center" rowspan="1" colspan="1">1.606</td><td align="center" rowspan="1" colspan="1">0.10838</td></tr><tr><td align="left" rowspan="1" colspan="1">cer-pe</td><td align="center" rowspan="1" colspan="1">-0.016897</td><td align="center" rowspan="1" colspan="1">0.007982</td><td align="center" rowspan="1" colspan="1">-2.117</td><td align="center" rowspan="1" colspan="1">0.03426</td></tr><tr><td align="left" rowspan="1" colspan="1">cer-pls</td><td align="center" rowspan="1" colspan="1">-0.008811</td><td align="center" rowspan="1" colspan="1">0.008176</td><td align="center" rowspan="1" colspan="1">-1.078</td><td align="center" rowspan="1" colspan="1">0.28119</td></tr><tr><td align="left" rowspan="1" colspan="1">cer-spm</td><td align="center" rowspan="1" colspan="1">0.067942</td><td align="center" rowspan="1" colspan="1">0.008095</td><td align="center" rowspan="1" colspan="1">8.393</td><td align="center" rowspan="1" colspan="1">&#x0003c; 2e-16</td></tr><tr><td align="left" rowspan="1" colspan="1">lpc-lpc</td><td align="center" rowspan="1" colspan="1">0.009306</td><td align="center" rowspan="1" colspan="1">0.008364</td><td align="center" rowspan="1" colspan="1">1.113</td><td align="center" rowspan="1" colspan="1">0.26590</td></tr><tr><td align="left" rowspan="1" colspan="1">lpc-pc</td><td align="center" rowspan="1" colspan="1">-0.035843</td><td align="center" rowspan="1" colspan="1">0.007769</td><td align="center" rowspan="1" colspan="1">-4.614</td><td align="center" rowspan="1" colspan="1">3.96e-06</td></tr><tr><td align="left" rowspan="1" colspan="1">lpc-pe</td><td align="center" rowspan="1" colspan="1">-0.053195</td><td align="center" rowspan="1" colspan="1">0.007868</td><td align="center" rowspan="1" colspan="1">-6.761</td><td align="center" rowspan="1" colspan="1">1.38e-11</td></tr><tr><td align="left" rowspan="1" colspan="1">lpc-pls</td><td align="center" rowspan="1" colspan="1">-0.024212</td><td align="center" rowspan="1" colspan="1">0.008001</td><td align="center" rowspan="1" colspan="1">-3.026</td><td align="center" rowspan="1" colspan="1">0.00248</td></tr><tr><td align="left" rowspan="1" colspan="1">lpc-spm</td><td align="center" rowspan="1" colspan="1">-0.021573</td><td align="center" rowspan="1" colspan="1">0.007942</td><td align="center" rowspan="1" colspan="1">-2.716</td><td align="center" rowspan="1" colspan="1">0.00660</td></tr><tr><td align="left" rowspan="1" colspan="1">pc-pc</td><td align="center" rowspan="1" colspan="1">-0.062170</td><td align="center" rowspan="1" colspan="1">0.007732</td><td align="center" rowspan="1" colspan="1">-8.041</td><td align="center" rowspan="1" colspan="1">9.03e-16</td></tr><tr><td align="left" rowspan="1" colspan="1">pc-pe</td><td align="center" rowspan="1" colspan="1">-0.063491</td><td align="center" rowspan="1" colspan="1">0.007722</td><td align="center" rowspan="1" colspan="1">-8.222</td><td align="center" rowspan="1" colspan="1">&#x0003c; 2e-16</td></tr><tr><td align="left" rowspan="1" colspan="1">pc-pls</td><td align="center" rowspan="1" colspan="1">-0.059816</td><td align="center" rowspan="1" colspan="1">0.007767</td><td align="center" rowspan="1" colspan="1">-7.702</td><td align="center" rowspan="1" colspan="1">1.36e-14</td></tr><tr><td align="left" rowspan="1" colspan="1">pc-spm</td><td align="center" rowspan="1" colspan="1">-0.044365</td><td align="center" rowspan="1" colspan="1">0.007749</td><td align="center" rowspan="1" colspan="1">-5.725</td><td align="center" rowspan="1" colspan="1">1.04e-08</td></tr><tr><td align="left" rowspan="1" colspan="1">pe-pe</td><td align="center" rowspan="1" colspan="1">-0.041556</td><td align="center" rowspan="1" colspan="1">0.007922</td><td align="center" rowspan="1" colspan="1">-5.246</td><td align="center" rowspan="1" colspan="1">1.56e-07</td></tr><tr><td align="left" rowspan="1" colspan="1">pe-pls</td><td align="center" rowspan="1" colspan="1">-0.056304</td><td align="center" rowspan="1" colspan="1">0.007864</td><td align="center" rowspan="1" colspan="1">-7.160</td><td align="center" rowspan="1" colspan="1">8.13e-13</td></tr><tr><td align="left" rowspan="1" colspan="1">pe-spm</td><td align="center" rowspan="1" colspan="1">-0.049549</td><td align="center" rowspan="1" colspan="1">0.007834</td><td align="center" rowspan="1" colspan="1">-6.325</td><td align="center" rowspan="1" colspan="1">2.54e-10</td></tr><tr><td align="left" rowspan="1" colspan="1">pls-pls</td><td align="center" rowspan="1" colspan="1">-0.056809</td><td align="center" rowspan="1" colspan="1">0.008341</td><td align="center" rowspan="1" colspan="1">-6.811</td><td align="center" rowspan="1" colspan="1">9.75e-12</td></tr><tr><td align="left" rowspan="1" colspan="1">pls-spm</td><td align="center" rowspan="1" colspan="1">-0.039083</td><td align="center" rowspan="1" colspan="1">0.007941</td><td align="center" rowspan="1" colspan="1">-4.922</td><td align="center" rowspan="1" colspan="1">8.60e-07</td></tr><tr><td align="left" rowspan="1" colspan="1">spm-spm</td><td align="center" rowspan="1" colspan="1">-0.010163</td><td align="center" rowspan="1" colspan="1">0.008164</td><td align="center" rowspan="1" colspan="1">-1.245</td><td align="center" rowspan="1" colspan="1">0.21319</td></tr></tbody></table></table-wrap><table-wrap id="ST4" orientation="portrait" position="anchor"><label>Table S4. </label><caption><title>Nominal
<italic>p</italic>-values for the analysis of SNPs previously associated with circulating sphingolipid concentrations in Vis data.</title><p>
<italic>Lead trait</italic>: the original trait for which the association signal was most significant in Vis data.
<italic>Lead percentage</italic>: the molar percentage, for which the most significant association was obtained.
<italic>Lead Ratio</italic>: the ratio, for which the most significant association was obtained. OmicA: OmicABEL, our implementation of CLAK-E
<sc>ig</sc>; FASTA: the two-step approach
<sup><xref rid="ref-19" ref-type="bibr">19</xref>&#x02013;
<xref rid="ref-21" ref-type="bibr">21</xref></sup> (as implemented in MixABEL::GWFGLS); LRT: the full likelihood ratio test based LMM
<sup><xref rid="ref-18" ref-type="bibr">18</xref>,
<xref rid="ref-22" ref-type="bibr">22</xref></sup> (as implemented in MixABEL::FMM); Gra-
<italic>&#x003b3;</italic>: Grammar-
<italic>&#x003b3;</italic>
<sup><xref rid="ref-25" ref-type="bibr">25</xref></sup> (as implemented in the GenABEL-package
<sup><xref rid="ref-29" ref-type="bibr">29</xref></sup>).</p></caption><table frame="hsides" rules="groups" content-type="article-table"><thead><tr><th align="left" rowspan="2" valign="bottom" colspan="1">SNP</th><th align="left" rowspan="2" valign="bottom" colspan="1">Trait</th><th align="center" colspan="4" rowspan="1">Method</th></tr><tr><th align="center" rowspan="1" colspan="1">OmicA</th><th align="center" rowspan="1" colspan="1">FASTA</th><th align="center" rowspan="1" colspan="1">LRT</th><th align="center" rowspan="1" colspan="1">Gra-
<italic>&#x003b3;</italic>
</th></tr></thead><tbody><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">Original traits</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">rs10938494
<break/>rs1000778
<break/>rs4902242
<break/>rs7258249
<break/>rs680379</td><td rowspan="1" colspan="1">PC 40:6
<break/>PC 38:4
<break/>SPM 14:0
<break/>SPM 18:1
<break/>C23:0</td><td align="center" rowspan="1" colspan="1">3.83E-03
<break/>4.07E-06
<break/>3.42E-13
<break/>3.93E-08
<break/>9.90E-05</td><td align="center" rowspan="1" colspan="1">3.66E-03
<break/>3.49E-06
<break/>2.70E-13
<break/>3.71E-08
<break/>9.53E-05</td><td align="center" rowspan="1" colspan="1">3.71E-03
<break/>3.14E-06
<break/>1.03E-13
<break/>2.42E-08
<break/>8.69E-05</td><td align="center" rowspan="1" colspan="1">3.89E-03
<break/>3.39E-06
<break/>2.75E-13
<break/>3.97E-08
<break/>9.77E-05</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">Molar percentages</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">rs10938494
<break/>rs1000778
<break/>rs4902242
<break/>rs7258249
<break/>rs680379</td><td rowspan="1" colspan="1">% PC 40:6
<break/>% PC 36:4
<break/>% SPM 14:0
<break/>% SPM 18:1
<break/>% C16:0</td><td align="center" rowspan="1" colspan="1">8.42E-03
<break/>2.90E-04
<break/>1.32E-13
<break/>2.30E-05
<break/>9.43E-04</td><td align="center" rowspan="1" colspan="1">8.25E-03
<break/>2.92E-04
<break/>1.11E-13
<break/>2.33E-05
<break/>8.91E-04</td><td align="center" rowspan="1" colspan="1">8.04E-03
<break/>2.29E-04
<break/>4.08E-14
<break/>1.92E-05
<break/>8.61E-04</td><td align="center" rowspan="1" colspan="1">8.25E-03
<break/>2.30E-04
<break/>1.19E-13
<break/>2.35E-05
<break/>9.07E-04</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">Ratios</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">rs10938494
<break/>rs1000778
<break/>rs4902242
<break/>rs7258249
<break/>rs680379</td><td rowspan="1" colspan="1">SPM 24:1 / glucosylceramide
<break/>% SPM 23:0 / % PC 36:4
<break/>SPM 14:0 / % SPM 23:0
<break/>SPM 16:1 / SPM 18:1
<break/>SPM 16:1-OH / % C16:0</td><td align="center" rowspan="1" colspan="1">2.29E-06
<break/>8.83E-09
<break/>1.71E-15
<break/>6.41E-08
<break/>1.56E-07</td><td align="center" rowspan="1" colspan="1">1.72E-06
<break/>8.16E-09
<break/>1.35E-15
<break/>5.72E-08
<break/>1.52E-07</td><td align="center" rowspan="1" colspan="1">1.31E-06
<break/>6.04E-09
<break/>4.44E-16
<break/>3.74E-08
<break/>1.17E-07</td><td align="center" rowspan="1" colspan="1">1.89E-06
<break/>7.64E-09
<break/>8.95E-15
<break/>6.23E-08
<break/>1.60E-07</td></tr></tbody></table></table-wrap><table-wrap id="ST5" orientation="portrait" position="anchor"><label>Table S5. </label><caption><title>Genomic Control
<italic>&#x003bb;</italic> estimates for traits analyzed in
<xref ref-type="table" rid="ST4">Table S4</xref> (main text).</title></caption><table frame="hsides" rules="groups" content-type="article-table"><thead><tr><th align="left" rowspan="2" valign="bottom" colspan="1">Trait</th><th align="center" colspan="4" rowspan="1">Method</th></tr><tr><th align="center" rowspan="1" colspan="1">OmicA</th><th align="center" rowspan="1" colspan="1">FASTA</th><th align="center" rowspan="1" colspan="1">LRT</th><th align="center" rowspan="1" colspan="1">Gra-
<italic>&#x003b3;</italic>
</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">Original traits</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td align="left" rowspan="1" colspan="1">PC 40:6
<break/>PC 38:4
<break/>SPM 14:0
<break/>SPM 18:1
<break/>C23:0</td><td align="center" rowspan="1" colspan="1">0.995
<break/>0.987
<break/>0.992
<break/>0.998
<break/>0.995</td><td align="center" rowspan="1" colspan="1">1.008
<break/>1.000
<break/>0.999
<break/>1.005
<break/>1.004</td><td align="center" rowspan="1" colspan="1">0.999
<break/>1.001
<break/>0.996
<break/>1.014
<break/>0.999</td><td align="center" rowspan="1" colspan="1">0.989
<break/>1.026
<break/>0.998
<break/>0.995
<break/>0.993</td></tr><tr><td align="left" rowspan="1" colspan="1">Molar percentages</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td align="left" rowspan="1" colspan="1">% PC 40:6
<break/>% PC 36:4
<break/>% SPM 14:0
<break/>% SPM 18:1
<break/>% C16:0</td><td align="center" rowspan="1" colspan="1">1.007
<break/>0.964
<break/>0.995
<break/>0.998
<break/>0.989</td><td align="center" rowspan="1" colspan="1">1.015
<break/>0.995
<break/>1.005
<break/>1.002
<break/>1.001</td><td align="center" rowspan="1" colspan="1">1.006
<break/>1.006
<break/>1.004
<break/>1.002
<break/>1.008</td><td align="center" rowspan="1" colspan="1">0.985
<break/>1.010
<break/>0.993
<break/>0.994
<break/>0.991</td></tr><tr><td align="left" rowspan="1" colspan="1">Ratios</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td align="left" rowspan="1" colspan="1">SPM 24:1 / glucosylceramide
<break/>% SPM 23:0 / % PC 36:4
<break/>SPM 14:0 / % SPM 23:0
<break/>SPM 16:1 / SPM 18:1
<break/>SPM 16:1-OH / % C16:0</td><td align="center" rowspan="1" colspan="1">0.975
<break/>1.008
<break/>1.006
<break/>1.008
<break/>0.997</td><td align="center" rowspan="1" colspan="1">1.005
<break/>1.007
<break/>1.009
<break/>1.010
<break/>1.002</td><td align="center" rowspan="1" colspan="1">0.998
<break/>1.006
<break/>0.997
<break/>0.999
<break/>1.003</td><td align="center" rowspan="1" colspan="1">0.994
<break/>1.011
<break/>0.994
<break/>0.994
<break/>0.993</td></tr></tbody></table></table-wrap></sec><sec id="SNS1"><title>Supplementary Note S1</title></sec><sec><title>Methods and algorithms</title><sec><title>Mixed Models for GWAS</title><p>The Variance Components model for a quantitative trait can be formulated as</p><p>
<disp-formula><mml:math id="math29"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>&#x02009;</mml:mo><mml:mo>=</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mi>X</mml:mi><mml:mi>&#x003b2;</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p>where
<italic>Y</italic> is the vector containing the phenotypes for
<italic>n</italic> individuals,
<italic>X</italic> is the design matrix, and
<italic>&#x003b2;</italic> and
<italic>R</italic> are the vectors of fixed and random effects, respectively. The partitioning
<italic>X</italic> = [1|
<italic>L</italic>|
<italic>g</italic>] indicates that the design matrix is composed of three parts: 1 denotes a column-vector (corresponding to the intercept) containing ones,
<italic>L</italic> is an
<italic>n &#x000d7; p</italic> matrix corresponding to fixed covariates such as age and sex, and
<italic>g</italic> typically consists of a single column-vector containing genotypes. The vector of random effect
<italic>R</italic> is assumed to be distributed as a Multivariate Normal with mean zero and variance-covariance matrix
<italic>M</italic> =
<italic>&#x003c3;</italic>
<sup>2</sup>(
<italic>h</italic>
<sup>2</sup>&#x003a6; + (1 &#x02212;
<italic>h</italic>
<sup>2</sup>)
<italic>I</italic>); here,
<italic>&#x003c3;</italic>
<sup>2</sup> is the total variance of the trait,
<italic>h</italic>
<sup>2</sup> (in the range [0, 1]) is the heritability coefficient,
<italic>I</italic> is the identity matrix, and &#x003a6; is the matrix containing the relationship coefficients for all pairs of studied individuals. The relationship matrix &#x003a6; can be estimated from the pedigree or from the genomic data
<sup><xref rid="ref-18" ref-type="bibr">18</xref></sup>.</p><p>In GWAS, the quantity of interest is the effect of the genotype, that is, the element(s) of
<italic>&#x003b2;</italic> corresponding to
<italic>g</italic>. Technically, a GWAS with mixed model consists of traversing all measured polymorphic sites in the genome, substituting the corresponding
<italic>g</italic> into
<italic>X</italic>, and fitting the above model; the result is millions of estimates of genetic effect together with their
<italic>p</italic>-values.</p><p>One of the most used mixed model-based approaches used in GWAS relies on a two-step analysis methodology
<sup><xref rid="ref-19" ref-type="bibr">19</xref>&#x02013;
<xref rid="ref-22" ref-type="bibr">22</xref>,
<xref rid="ref-41" ref-type="bibr">41</xref></sup>. In the first step, the reduced model (with
<italic>X</italic> = [1|
<italic>L</italic>]) is fit to the data, thus obtaining the estimates {
<mml:math id="math30"><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>,
<mml:math id="math31"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>}; the variance-covariance matrix corresponding to such estimates is denoted by
<mml:math id="math32"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math> =
<mml:math id="math33"><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>(
<mml:math id="math34"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>&#x003a6; + (1 &#x02013;
<mml:math id="math35"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>)
<italic>I</italic>). In the second step, for each
<italic>g
<sub>i</sub></italic> and corresponding
<italic>X
<sub>i</sub></italic> = [1|
<italic>L</italic>|
<italic>g
<sub>i</sub></italic>], the estimates of the effects and the variance-covariance matrix are respectively obtained as</p><p>
<disp-formula><mml:math id="math36"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p>and</p><p>
<disp-formula><mml:math id="math37"><mml:mrow><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p>with
<italic>i</italic> = 1, . . . ,
<italic>m</italic>, where
<italic>m</italic> is the number of genetic markers considered.</p><p>In this work, we consider an extended formulation of this problem to the case of multiple phenotypes, that is, Y is a collection of
<italic>t</italic> vectors, with
<italic>y
<sub>j</sub></italic> (
<italic>j</italic> = 1, . . . ,
<italic>t</italic>) being a vector corresponding to a specific trait. In this case, trait-specific estimates
<mml:math id="math38"><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>
<sub>j</sub>,
<mml:math id="math39"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>
<sub>j</sub> need to be obtained, resulting in
<italic>t</italic> different
<mml:math id="math40"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<italic><sub>j</sub></italic>s. As the result of the analysis,
<italic>m &#x000d7; t</italic> vectors of estimates of
<mml:math id="math41"><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<italic><sub>ij</sub></italic> and corresponding
<italic>Var</italic>(
<mml:math id="math42"><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<italic><sub>ij</sub></italic>) are generated. In summary, the problem we are facing is</p><p id="e2">
<disp-formula><mml:math id="math43"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mtext>with</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>m</mml:mi><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x003a6;</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mtext>and</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>;</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula>
</p><p>see
<xref ref-type="fig" rid="f1">Figure 1</xref> for a visual description. For each
<italic>i</italic> and
<italic>j</italic>,
<xref ref-type="other" rid="e2">Equation (2)</xref> represents a generalized least-square (GLS) problem. Single-trait and multiple-trait analyses correspond to the solution of
<italic>m&#x000d7;</italic>1 (1-dimensional) and
<italic>m&#x000d7;t</italic> (two-dimensional) grids of GLS problems, respectively.</p></sec><sec><title>Single-instance algorithms</title><p>We provide here an overview of a simplified version of CLAK-C
<sc>hol</sc> and CLAK-E
<sc>ig</sc> to solve a single GLS; the versions tailored for one-dimensional and two-dimensional grids of GLS&#x02019;s are discussed in the
<xref ref-type="other" rid="m1">Methods</xref> section and presented in
<xref ref-type="table" rid="ST1">Table S1</xref>. In the following, we use
<italic>b</italic> to indicate
<mml:math id="math44"><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>; in both our algorithms, the computation of
<italic>Var</italic>(
<italic>b</italic>) represents an intermediate result towards
<italic>b</italic>.</p><p>
<bold><italic>CLAK-Chol</italic></bold>. The approach for CLAK-C
<sc>hol</sc> (
<xref ref-type="table" rid="ST2">Table S2</xref>, top-left) is to first reduce the initial GLS
<italic>b</italic> := (
<italic>X
<sup>T</sup></italic>
<mml:math id="math45"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>&#x02013;1</sup>
<italic>X</italic>)
<sup>&#x02013;1</sup>
<italic>X
<sup>T</sup></italic>
<mml:math id="math46"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>&#x02013;1</sup>
<italic>y</italic> to a linear least-squares problem, and then solve this via normal equations. Specifically, the algorithm starts by forming
<mml:math id="math47"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math> =
<mml:math id="math48"><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>(
<mml:math id="math49"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>&#x003a6; + (1 &#x02013;
<mml:math id="math50"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>
<sup>2</sup>)
<italic>I</italic>), which is known to be symmetric positive definite, and by computing its Cholesky factor
<italic>L</italic>. This leads to the expression
<italic>b</italic> := (
<italic>X
<sup>T</sup> L
<sup>&#x02212;T</sup> L</italic>
<sup>&#x02212;1</sup>
<italic>X</italic>)
<sup>&#x02013;1</sup>
<italic>X
<sup>T</sup></italic>
<italic>L</italic>
<sup>&#x02212;
<italic>T</italic></sup>
<italic>L</italic>
<sup>&#x02212;1</sup>
<italic>y</italic>, in which two triangular linear systems can be identified and solved&#x02014;
<mml:math id="math51"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>&#x002cd;</mml:mo></mml:mover></mml:math> :=
<italic>L</italic>
<sup>&#x02212;1</sup>
<italic>X</italic> and
<mml:math id="math52"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x002cd;</mml:mo></mml:mover></mml:math> :=
<italic>L</italic>
<sup>&#x02212;1</sup>
<italic>y</italic> &#x02014;thus completing the reduction to the standard least-squares problem
<italic>b</italic> := (
<mml:math id="math53"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>&#x002cd;</mml:mo></mml:mover></mml:math>
<italic><sup>T</sup></italic>
<mml:math id="math54"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>&#x002cd;</mml:mo></mml:mover></mml:math>)
<sup>&#x02013;1</sup>
<mml:math id="math55"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>&#x002cd;</mml:mo></mml:mover></mml:math>
<italic><sup>T</sup></italic>
<mml:math id="math56"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x002cd;</mml:mo></mml:mover></mml:math>. Numerical considerations allow us to safely rely on the Cholesky factorization of
<italic>S</italic> :=
<mml:math id="math57"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>&#x002cd;</mml:mo></mml:mover></mml:math>
<italic><sup>T</sup></italic>
<mml:math id="math58"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>&#x002cd;</mml:mo></mml:mover></mml:math> without incurring instabilities. The algorithm completes by computing
<mml:math id="math59"><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>&#x002cd;</mml:mo></mml:mover></mml:math> :=
<mml:math id="math60"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>&#x002cd;</mml:mo></mml:mover></mml:math>
<italic><sup>T</sup></italic>
<mml:math id="math61"><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>&#x002cd;</mml:mo></mml:mover></mml:math> and solving the linear system
<italic>b</italic> :=
<italic>S</italic>
<sup>&#x02013;1</sup>
<mml:math id="math62"><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>&#x002cd;</mml:mo></mml:mover></mml:math>, for a total cost of
<mml:math id="math63"><mml:mfrac><mml:mo>1</mml:mo><mml:mo>3</mml:mo></mml:mfrac></mml:math>
<italic>n</italic>
<sup>3</sup> +
<italic>O</italic>(
<italic>n</italic>
<sup>2</sup>
<italic>p</italic>).</p><p>
<bold><italic>CLAK-Eig</italic></bold>. Instead of forming the matrix
<mml:math id="math64"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math>, Algorithm CLAK-E
<sc>ig</sc> (
<xref ref-type="table" rid="ST2">Table S2</xref>, top-right) operates on the matrix &#x003a6;: At first, it diagonalizes &#x003a6; as
<italic>ZWZ
<sup>T</sup></italic>, leading to the expression</p><p>
<disp-formula><mml:math id="math65"><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mo>&#x02009;</mml:mo><mml:mtext>:=</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mi>Z</mml:mi><mml:mi>W</mml:mi><mml:msup><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p>with diagonal
<italic>W</italic>. By orthogonality of
<italic>Z</italic>, the inverse of
<mml:math id="math66"><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover></mml:math> can be represented as</p><p>
<disp-formula><mml:math id="math67"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>&#x02009;</mml:mo><mml:mtext>:=</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mi>Z</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></disp-formula>
</p><p>and easily computed with a cost of
<italic>O</italic>(
<italic>n</italic>) operations via</p><p>
<disp-formula><mml:math id="math68"><mml:mrow><mml:mi>D</mml:mi><mml:mo>&#x02009;</mml:mo><mml:mtext>:=</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x0032d;</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>;</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p>the solution to the GLS is thus given by</p><p id="e3">
<disp-formula><mml:math id="math69"><mml:mrow><mml:mi>b</mml:mi><mml:mo>&#x02009;</mml:mo><mml:mtext>:=</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>Z</mml:mi><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>Z</mml:mi><mml:msup><mml:mi>D</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>y</mml:mi><mml:mo>.</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo>&#x02009;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p>Moreover, since
<italic>D</italic> is symmetric positive definite,
<xref ref-type="other" rid="e3">Equation 3</xref> can be rewritten as</p><p>
<disp-formula><mml:math id="math70"><mml:mrow><mml:mi>b</mml:mi><mml:mo>&#x02009;</mml:mo><mml:mtext>:=</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>Z</mml:mi><mml:mi>K</mml:mi><mml:msup><mml:mi>K</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>Z</mml:mi><mml:mi>K</mml:mi><mml:msup><mml:mi>K</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>Z</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>Y</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
</p><p>and the algorithm proceeds by computing
<italic>V</italic> :=
<italic>X
<sup>T</sup>ZK</italic> (matrix-matrix multiplication and scaling), obtaining
<italic>b</italic> := (
<italic>VV
<sup>T</sup></italic>)
<sup>&#x02013;1</sup>
<italic>VK
<sup>T</sup>Z
<sup>T</sup>y</italic>. Similar to CLAK-C
<sc>hol</sc>,
<italic>b</italic> is finally obtained through matrix-vector multiplications and a linear system, for a total cost of
<mml:math id="math71"><mml:mfrac><mml:mo>10</mml:mo><mml:mo>3</mml:mo></mml:mfrac></mml:math>
<italic>n</italic>
<sup>3</sup> +
<italic>O</italic>(
<italic>n</italic>
<sup>2</sup>
<italic>p</italic>).</p></sec><sec><title>Effectively solving the grids of Generalized Least-Squares problems</title><p>As shown in
<xref ref-type="table" rid="T1">Table 1</xref>, the strength of the algorithms CLAK-C
<sc>hol</sc> and CLAK-E
<sc>ig</sc> becomes apparent in the context of 1D and 2D grids of GLS problems, corresponding to GWAS with single and multiple phenotypes, respectively. The straightforward approach, which is the only alternative provided by current general-purpose numerical libraries, lies in a loop that utilizes the best performing algorithm for a single least-square problem. No matter how optimized the GLS solver, such an approach is prohibitively expensive for either single or multiple phenotypes, due to the unmanageable complexity of
<italic>O</italic>(
<italic>mn</italic>
<sup>3</sup>) and
<italic>O</italic>(
<italic>tmn</italic>
<sup>3</sup>), respectively. By contrast, the versions of CLAK-C
<sc>hol</sc> and CLAK-E
<sc>ig</sc> shown in
<xref ref-type="table" rid="ST1">Table S1</xref> are the product of a number of optimizations aimed at saving intermediate results across successive problems, thus avoiding redundant calculations. For instance, the matrix
<italic>X</italic> is logically split as [
<italic>X
<sub>L</sub>|X
<sub>R</sub></italic>], where
<italic>X
<sub>L</sub></italic> includes the intercept and the covariates ([1|
<italic>L</italic>]), while
<italic>X
<sub>R</sub></italic> is the collection of all the genetic markers
<italic>g
<sub>i</sub></italic>. Thanks to these savings, both algorithms achieve a lower overall complexity.</p><p>Unfortunately, the reduced complexity of algorithms CLAK-C
<sc>hol</sc> and CLAK-E
<sc>ig</sc> is not enough to guarantee high-performance implementations. It is well known that in terms of execution time, the difference between a straightforward translation of an algorithm into code and a carefully assembled routine is of at least one order of magnitude. In other words, the benefits inherent to our new algorithms might go unnoticed unless paired with state-of-the-art implementation techniques. In this following, we detail our strategy to attain high-performance routines.</p><p>Both CLAK-C
<sc>hol</sc> and CLAK-E
<sc>ig</sc> are entirely expressed in terms of standard linear algebra operations, such as matrix products and matrix factorizations, provided by the BLAS
<sup><xref rid="ref-42" ref-type="bibr">42</xref></sup> and LAPACK
<sup><xref rid="ref-43" ref-type="bibr">43</xref></sup> libraries. Since LAPACK itself is built in terms of BLAS kernels, these are the main responsible for the overall performance of an algorithm. BLAS consists of a relatively small set of highly optimized kernels, organized in three levels (1, 2, and 3), corresponding to vector, matrix-vector, and matrix-matrix operations, respectively.</p><p>A common misconception is that all the BLAS kernels, across the three levels, attain a comparable (and high) level of efficiency. Instead, it is only BLAS-3&#x02014;when operating on large matrices&#x02014;that fully exploits the processors&#x02019; potential; as an example, the matrix-vector multiplication, matrix-matrix multiplication on small matrices, and matrix-matrix multiplication on large matrices attain an efficiency of
<italic>&#x02248;</italic> 5%,
<italic>&#x02248;</italic> 15%, and more than 95%, respectively. In this context, the linear systems
<italic>X</italic> :=
<italic>L</italic>
<sup>&#x02212;1</sup>
<italic>X</italic> in CLAK-C
<sc>hol</sc> (Line 3 of the top-left algorithm in
<xref ref-type="table" rid="ST2">Table S2</xref>), to be solved for each individual SNP, should ideally be aggregated into a single&#x02014;very large&#x02014;linear system
<italic>X
<sub>R</sub></italic> :=
<italic>L</italic>
<sup>&#x02212;1</sup>
<italic>X
<sub>R</sub></italic>, in which
<italic>X
<sub>R</sub></italic> is the collection of the genetic markers of all SNPs (Line 3 of the left Algorithm in
<xref ref-type="table" rid="ST1">Table S1</xref>). An analogous comment is valid for CLAK-E
<sc>ig</sc> (see the multiplications at Lines 3 and 4 of the right Algorithm in
<xref ref-type="table" rid="ST1">Table S1</xref>), in which the number of markers accessed at once is a user-configurable input parameter.</p><p>Since all the current computing platforms include multicore processors, we briefly discuss how to take advantage of this architecture. An effective practice is to invoke a multi-threaded version of the BLAS library. Both in CLAK-C
<sc>hol</sc> and CLAK-E
<sc>ig</sc> (
<xref ref-type="table" rid="ST1">Table S1</xref>) we rely on such a solution for the sections leading up to the outer loop (Lines 1&#x02013;7 and 1&#x02013;4, respectively). In the remainder of the algorithms (Lines 8&#x02013;11 and 5&#x02013;16), due to the lack of matrix-matrix operations, we instead apply a thread-based parallelization in conjunction with single-threaded BLAS. This mixed use of multi-threading becomes more and more effective as the number of available computing cores increases.</p></sec><sec><title>Time complexity</title><p>Prior to solving a grid of GLS, the heritability (
<italic>h</italic>
<sup>2</sup>) and the total variance (
<italic>&#x003c3;</italic>
<sup>2</sup>) have to be estimated. For this first step, our algorithms use an approach similar to Software packages such as GenABEL
<sup><xref rid="ref-29" ref-type="bibr">29</xref></sup>, EMMAX, and FaST-LMM: First, the eigen-decomposition of the kinship matrix is performed, for a computational cost of
<italic>O</italic>(
<italic>n</italic>
<sup>3</sup>). Then, the model parameters are estimated using an iterative procedure based on the Maximum Likelihood (GenABEL, FaST-LMM) or Restricted Maximum Likelihood (EMMAX, CLAK-C
<sc>hol</sc>, CLAK-E
<sc>ig</sc>) methods, for a cost of
<italic>O</italic>(
<italic>tvnp</italic>
<sup>2</sup>), where
<italic>v</italic> is the average number of iterations required to reach convergence. In total, the parameter estimation has a complexity of
<italic>O</italic>(
<italic>n</italic>
<sup>3</sup> +
<italic>tvnp</italic>
<sup>2</sup>) operations.</p><p>In the second step, a 1D or 2D grid of GLS is solved, corresponding to single and multiple phenotype analysis. For 1D grids, all the considered methods share the same asymptotic time complexity, but the constant factor for CLAK-C
<sc>hol</sc> is the lowest, yielding a speedup factor of at least 6. In 2D grids, EMMAX, FaST-LMM and GenABEL simply tackle each individual trait independently, one after another, for a total complexity of
<italic>O</italic>(
<italic>tmpn</italic>
<sup>2</sup>). By exploiting the common structure of the variance-covariance matrix of different phenotypes, CLAK-E
<sc>ig</sc> reduces the complexity by a factor of
<italic>n</italic>, down to
<italic>O</italic>(
<italic>tmpn</italic>). As a result, our algorithm outperforms the other methods by factors higher than 1,000.</p></sec><sec><title>Space requirement</title><p>
<bold><italic>CLAK-C
<sc>hol</sc></italic></bold>. To form and factor the variance matrix, the algorithm uses
<italic>n</italic>
<sup>2</sup> memory (Lines 1&#x02013;2 in the left Algorithm of
<xref ref-type="table" rid="ST1">Table S1</xref>). The overall space requirement is determined by the triangular solve (Line 4), which necessitates the full
<italic>L</italic> and a portion of
<italic>X</italic> to reside in memory at the same time. This operation is performed in a streaming fashion&#x02014;operating on
<italic>k</italic> SNPs at the time&#x02014;and overwriting
<italic>X</italic> . All the other instructions do not require any extra space. In total, CLAK-C
<sc>hol</sc> uses about
<italic>n</italic>
<sup>2</sup> +
<italic>kn</italic> memory.</p><p>
<bold><italic>CLAK-E
<sc>ig</sc></italic></bold>. The initial eigen-decomposition (Line 1 in the right Algorithm of
<xref ref-type="table" rid="ST1">Table S1</xref>) needs 2
<italic>n</italic>
<sup>2</sup> memory. The following matrix-matrix multiplications (Lines 2, 3 and 8) overwrite the input matrices and again are performed in a streaming fashion; in terms of space, the analysis is similar to that for the triangular solve in CLAK-C
<sc>hol</sc>. The remaining instructions do not affect the overall memory usage. In total, the space requirement is 2
<italic>n</italic>
<sup>2</sup> +
<italic>kn</italic>.</p><p>If memory is a limiting factor, one can set
<italic>k</italic> to 1 in either algorithm, possibly at the cost of exposed data movement. Moreover, by using a different (slower) eigensolver, the eigenvectors
<italic>Z</italic> can overwrite the input matrix &#x003a6;, effectively saving
<italic>n</italic>
<sup>2</sup> memory. These considerations indicate that our algorithms are capable of solving GWAS of any size, as long as the kinship matrix, one SNP, and one trait fit in RAM.</p></sec></sec><sec id="SNS2"><title>Supplementary Note S2</title></sec><sec><title>Computing environment</title><p>All the computing tests were run on a symmetric multiprocessor system consisting of four Intel Xeon E7-4850 10-core processors, operating at a frequency of 2.00 GHz. The system is equipped with 256GB of RAM and 4TB of disk as secondary memory
<sup><xref ref-type="other" rid="N2">2</xref></sup>. The routines were compiled with the GNU C Compiler (gcc v4.4.5) and linked to Intel&#x02019;s MKL multi-threaded library (v12.1). For double-buffering, our out-of-core routines make use of the AIO library, one of the standard libraries on UNIX systems. The available multi-core parallelism is exploited through MKL&#x02019;s multi-threaded BLAS and OpenMP&#x02019;s pragma directives.</p></sec><sec id="SNS3"><title>Supplementary Note S3</title></sec><sec><title>Simulated data</title><p>A data set for GWAS can be characterized by the number of individuals in the sample (
<italic>n</italic>), the number of measured and/or imputed SNPs (
<italic>m</italic>) to be tested, the number of outcomes to be analyzed (
<italic>t</italic>), and the number of covariates (
<italic>p</italic>) to be included in the model. In current GWAS, a typical scenario consists of a few covariates (for example, two, such as sex and age), 10
<sup>5</sup>&#x02013;10
<sup>7</sup> SNPs, and thousands or tens of thousands individuals. In our experiments, we assumed that the number of covariates is two (p=2), and we varied the three other characteristics (
<italic>n</italic>,
<italic>m</italic>,
<italic>t</italic>) of the data set, leading to these three scenarios.</p><list list-type="simple"><list-item><label>(A)</label><p>The number of SNPs was fixed to
<italic>m</italic> = 10,000,000 and one single outcome (
<italic>t</italic> = 1) was studied. As sample size, we used 1,000, 5,000, 10,000, 20,000, and 40,000. The latter test represents a scenario with large number of individuals.</p></list-item></list><list list-type="simple"><list-item><label>(B)</label><p>The number of individuals was fixed to
<italic>n</italic> = 10,000 and one single outcome (
<italic>t</italic> = 1) was studied. The number of markers
<italic>m</italic> to be analyzed was set to 1,000,000, 10,000,000, and 36,000,000. The latter test is a scenario that represents a whole genome re-sequencing.</p></list-item></list><list list-type="simple"><list-item><label>(C)</label><p>The number of individuals and markers were fixed to
<italic>n</italic> = 1,000 and
<italic>m</italic> = 1,000,000, respectively. The number of outcomes
<italic>t</italic> studied varied (1, 10, 100, 1,000, 10,000, and 100,000), corresponding to an Omics analysis.</p></list-item></list><p>For testing purposes, we generated artificial data sets which met pre-specified values of
<italic>t</italic>,
<italic>m</italic>,
<italic>p</italic>, and
<italic>n</italic>.</p></sec><sec id="SNS4"><title>Supplementary Note S4</title></sec><sec><title>Application to human metabolomics data</title><sec><title>CROATIA-Vis study</title><p>The CROATIA-Vis study includes 1056 unselected Croatians, aged 18&#x02013;93 years, who were recruited into the study during 2003 and 2004 from the villages of Vis and Komiza on the Dalmatian island of Vis
<sup><xref rid="ref-44" ref-type="bibr">44</xref>,
<xref rid="ref-45" ref-type="bibr">45</xref></sup>. The settlements on Vis island have unique population histories and have preserved their isolation from other villages and from the outside world for centuries. Participants were phenotyped for more than 450 disease-related quantitative traits. Biochemical and physiological measurements were performed, detailed genealogies reconstructed, questionnaire of lifestyle and environmental exposures collected, and blood samples and lymphocytes extracted and stored for further analyses. Samples in all studies were taken in the fasting state. The CROATIA-Vis study was approved by the ethics committee of the medical faculty in Zagreb and the Multi-Centre Research Ethics Committee for Scotland.</p></sec><sec><title>Metabolomics measurements</title><p>We applied the OmicABEL to study 107,144 metabolomic traits in a sample of 781 people from a genetically isolated population of the Vis island (Croatia). These data are a part of the EUROSPAN data set reported in work of Hicks
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup> and Demirkan and colleagues
<sup><xref rid="ref-12" ref-type="bibr">12</xref></sup>. In short, the data comprise plasma levels of 23 sphingomyelins (SPM), 9 ceramides (CER), 56 phosphatidylcholines (PC), 15 lysophosphatidylcholines (LPC), 27 phosphatidylethanolamines (PE), and 19 PE-based plasmalogens (PLPE). From these data, additional traits were then defined by aggregating species into groups with similar characteristics (e.g. unsaturated ceramides), and also by expressing data as molar percentages (instead of absolute concentrations) within classes. In this work, 328 such measurements served as a base to compute all pair-wise ratios, resulting in 107,584 traits. The traits with
<italic>&#x0003e;</italic>95% of measured values without ties were sex- and age-adjusted and then Gaussianized using the quantile normalization. The resulting 107,144 traits were subject to GWAS with 266,878 SNPs.</p><p>Here we report several findings showing the power of this approach to large-scale hypothesis-free analysis; while such an analysis was hardly conceivable before, is now within the reach for most researchers by using our new methods, algorithms and software.</p></sec><sec><title>Results</title><p>In total, heritability was
<italic>&#x0003e;</italic>0 for 102,985 (96.1%) traits, with an average heritability of 27%, and a maximum of 85%. We investigated if there were systematic differences in heritabilities between different classes of measurements. The average heritability of the original traits was 0.31 (see
<xref ref-type="table" rid="ST3">Table S3</xref>). We observed that heritabilities were specific for different classes of ratios. For example, the ratios involving ceramides were more heritable than the &#x0201c;original&#x0201d; traits, especially for the ratios CER:CER (
<italic>h</italic>
<sup>2</sup>
<sub><italic>CER:CER</italic></sub> = 0.44 vs.
<italic>h</italic>
<sup>2</sup>
<sub><italic>orginal</italic></sub> = 0.31,
<italic>p &#x0003c;</italic> 10
<sup>&#x02013;15</sup>) and CER:SPM (
<italic>h</italic>
<sup>2</sup>
<sub><italic>CER:SPM</italic></sub> = 0.38,
<italic>p &#x0003c;</italic> 10
<sup>&#x02013;15</sup>). All ratios involving LPC, PC, PE, PLS, and SPM had significantly lower (all
<italic>p &#x0003c;</italic> 0.01) heritabilities, except for the cases when CER&#x02019;s were involved in the ratio or, in the biologically plausible case in which the ratios were derived within the same lipids class (i.e. LPC:LPC, PE:PE, etc.).</p><p>To this end, we re-analyzed the associations for five SNPs previously reported
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup> to be significantly associated with levels of circulating sphingolipid concentrations.
<xref ref-type="table" rid="ST4">Table S4</xref> reports the best results obtained for these SNPs when using the original and derived traits. The traits implicated were also analyzed by using the full likelihood ratio test based LMM (MixABEL::FMM), Grammar-
<italic>&#x003b3;</italic>
<sup><xref rid="ref-25" ref-type="bibr">25</xref></sup>, and MixABEL::GWFGLS (which is very similar to OmicABEL) methods. All
<italic>p</italic>-value were corrected for the Genomic Control inflation factor (presented in
<xref ref-type="table" rid="ST5">Table S5</xref>). From
<xref ref-type="table" rid="ST4">Table S4</xref> one can see that our results are consistent with these obtained by other methods.</p><p>Note that we have analyzed only a subset of the data reported by Hicks
<italic>et al.</italic>
<sup><xref rid="ref-11" ref-type="bibr">11</xref></sup>, and therefore our lead concentrations did not always come from the class reported in previous work (e.g.
<italic>ATP10D</italic> was reported to be associated with glucosylceramides and
<italic>FADS</italic> with SPM).</p></sec></sec><notes><p id="N1">
<sup>1</sup>As of January of 2014, Sequoia is the third fastest supercomputer in the world:
<ext-link ext-link-type="uri" xlink:href="http://www.top500.org/lists/2013/11/"/>.</p><p id="N2">
<sup>2</sup>Recall that our algorithms do not require large amounts of available RAM, as long as it accommodates the kinship matrix, the algorithms will complete.</p></notes><ref-list><ref id="ref-1"><label>1</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flintoft</surname><given-names>L</given-names></name></person-group>:
<article-title>Human epigenomics: Putting epigenetic variation on the map.</article-title><source><italic>Nat Rev Genet.</italic></source><year>2009</year>;<volume>10</volume>:<fpage>663</fpage>&#x02013;<lpage>663</lpage>
<pub-id pub-id-type="doi">10.1038/nrg2676</pub-id></mixed-citation></ref><ref id="ref-2"><label>2</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>de Koning</surname><given-names>DJ</given-names></name><name><surname>Haley</surname><given-names>CS</given-names></name></person-group>:
<article-title>Genetical genomics in humans and model organisms.</article-title><source><italic>Trends Genet.</italic></source><year>2005</year>;<volume>21</volume>(<issue>7</issue>):<fpage>377</fpage>&#x02013;<lpage>381</lpage>.
<pub-id pub-id-type="doi">10.1016/j.tig.2005.05.004</pub-id><?supplied-pmid 15908034?><pub-id pub-id-type="pmid">15908034</pub-id></mixed-citation></ref><ref id="ref-3"><label>3</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z</given-names></name><name><surname>Gerstein</surname><given-names>M</given-names></name><name><surname>Snyder</surname><given-names>M</given-names></name></person-group>:
<article-title>RNA-Seq: a revolutionary tool for transcriptomics.</article-title><source><italic>Nat Rev Genet.</italic></source><year>2009</year>;<volume>10</volume>(<issue>1</issue>):<fpage>57</fpage>&#x02013;<lpage>63</lpage>.
<pub-id pub-id-type="doi">10.1038/nrg2484</pub-id><!--<pub-id pub-id-type="pmcid">2949280</pub-id>--><?supplied-pmid 19015660?><pub-id pub-id-type="pmid">19015660</pub-id></mixed-citation></ref><ref id="ref-4"><label>4</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nicholson</surname><given-names>JK</given-names></name><name><surname>Lindon</surname><given-names>JC</given-names></name><name><surname>Holmes</surname><given-names>E</given-names></name></person-group>:
<article-title>&#x02018;Metabonomics&#x02019;: understanding the metabolic responses of living systems to pathophysiological stimuli via multivariate statistical analysis of biological nmr spectroscopic data.</article-title><source><italic>Xenobiotica.</italic></source><year>1999</year>;<volume>29</volume>(<issue>11</issue>):<fpage>1181</fpage>&#x02013;<lpage>1189</lpage>.
<pub-id pub-id-type="doi">10.1080/004982599238047</pub-id><?supplied-pmid 10598751?><pub-id pub-id-type="pmid">10598751</pub-id></mixed-citation></ref><ref id="ref-5"><label>5</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raamsdonk</surname><given-names>LM</given-names></name><name><surname>Teusink</surname><given-names>B</given-names></name><name><surname>Broadhurst</surname><given-names>D</given-names></name><etal/></person-group>:
<article-title>A functional genomics strategy that uses metabolome data to reveal the phenotype of silent mutations.</article-title><source><italic>Nat Biotechnol.</italic></source><year>2001</year>;<volume>19</volume>(<issue>1</issue>):<fpage>45</fpage>&#x02013;<lpage>50</lpage>.
<pub-id pub-id-type="doi">10.1038/83496</pub-id><?supplied-pmid 11135551?><pub-id pub-id-type="pmid">11135551</pub-id></mixed-citation></ref><ref id="ref-6"><label>6</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lauc</surname><given-names>G</given-names></name><name><surname>Essafi</surname><given-names>A</given-names></name><name><surname>Huffman</surname><given-names>JE</given-names></name><etal/></person-group>:
<article-title>Genomics meets glycomics: the first GWAS study of human N-glycome identifies HNF1&#x003b1; as a master regulator of plasma protein fucosylation.</article-title><source><italic>PLoS Genet.</italic></source><year>2010</year>;<volume>6</volume>:<fpage>e1001256</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pgen.1001256</pub-id><pub-id pub-id-type="pmid">21203500</pub-id></mixed-citation></ref><ref id="ref-7"><label>7</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lauc</surname><given-names>G</given-names></name><name><surname>Huffman</surname><given-names>JE</given-names></name><name><surname>Pu&#x0010d;i&#x00107;</surname><given-names>M</given-names></name><etal/></person-group>:
<article-title>Loci associated with N-glycosylation of human immunoglobulin g show pleiotropy with autoimmune diseases and haematological cancers.</article-title><source><italic>PLoS Genet.</italic></source><year>2013</year>;<volume>9</volume>(<issue>1</issue>):<fpage>e1003225</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pgen.1003225</pub-id><!--<pub-id pub-id-type="pmcid">3561084</pub-id>--><?supplied-pmid 23382691?><pub-id pub-id-type="pmid">23382691</pub-id></mixed-citation></ref><ref id="ref-8"><label>8</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altelaar</surname><given-names>AF</given-names></name><name><surname>Munoz</surname><given-names>J</given-names></name><name><surname>Heck</surname><given-names>AJ</given-names></name></person-group>:
<article-title>Next-generation proteomics: towards an integrative view of proteome dynamics.</article-title><source><italic>Nat Rev Genet.</italic></source><year>2013</year>;<volume>14</volume>(<issue>1</issue>):<fpage>35</fpage>&#x02013;<lpage>48</lpage>.
<pub-id pub-id-type="doi">10.1038/nrg3356</pub-id><?supplied-pmid 23207911?><pub-id pub-id-type="pmid">23207911</pub-id></mixed-citation></ref><ref id="ref-9"><label>9</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hindorff</surname><given-names>LA</given-names></name><name><surname>Sethupathy</surname><given-names>P</given-names></name><name><surname>Junkins</surname><given-names>HA</given-names></name><etal/></person-group>:
<article-title>Potential etiologic and functional implications of genome-wide association loci for human diseases and traits.</article-title><source><italic>Proc Natl Acad Sci U S A.</italic></source><year>2009</year>;<volume>106</volume>(<issue>23</issue>):<fpage>9362</fpage>&#x02013;<lpage>9367</lpage>.
<pub-id pub-id-type="doi">10.1073/pnas.0903103106</pub-id><!--<pub-id pub-id-type="pmcid">2687147</pub-id>--><?supplied-pmid 19474294?><pub-id pub-id-type="pmid">19474294</pub-id></mixed-citation></ref><ref id="ref-10"><label>10</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gieger</surname><given-names>C</given-names></name><name><surname>Geistlinger</surname><given-names>L</given-names></name><name><surname>Altmaier</surname><given-names>E</given-names></name><etal/></person-group>:
<article-title>Genetics meets metabolomics: a genome-wide association study of metabolite profiles in human serum.</article-title><source><italic>PLoS Genet.</italic></source><year>2008</year>;<volume>4</volume>(<issue>11</issue>):<fpage>e1000282</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pgen.1000282</pub-id><!--<pub-id pub-id-type="pmcid">2581785</pub-id>--><?supplied-pmid 19043545?><pub-id pub-id-type="pmid">19043545</pub-id></mixed-citation></ref><ref id="ref-11"><label>11</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hicks</surname><given-names>AA</given-names></name><name><surname>Pramstaller</surname><given-names>PP</given-names></name><name><surname>Johansson</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>Genetic determinants of circulating sphingolipid concentrations in European populations.</article-title><source><italic>PLoS Genet.</italic></source><year>2009</year>;<volume>5</volume>(<issue>10</issue>):<fpage>e1000672</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pgen.1000672</pub-id><!--<pub-id pub-id-type="pmcid">2745562</pub-id>--><?supplied-pmid 19798445?><pub-id pub-id-type="pmid">19798445</pub-id></mixed-citation></ref><ref id="ref-12"><label>12</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Demirkan</surname><given-names>A</given-names></name><name><surname>van Duijn</surname><given-names>CM</given-names></name><name><surname>Ugocsai</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>Genome-wide association study identifies novel loci associated with circulating phospho- and sphingolipid concentrations.</article-title><source><italic>PLoS Genet.</italic></source><year>2012</year>;<volume>8</volume>(<issue>2</issue>):<fpage>e1002490</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pgen.1002490</pub-id><!--<pub-id pub-id-type="pmcid">3280968</pub-id>--><?supplied-pmid 22359512?><pub-id pub-id-type="pmid">22359512</pub-id></mixed-citation></ref><ref id="ref-13"><label>13</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>J</given-names></name><name><surname>Wolfs</surname><given-names>MG</given-names></name><name><surname>Deelen</surname><given-names>P</given-names></name><etal/></person-group>:
<article-title>Unraveling the regulatory mechanisms underlying tissue-dependent genetic variation of gene expression.</article-title><source><italic>PLoS Genet.</italic></source><year>2012</year>;<volume>8</volume>(<issue>1</issue>):<fpage>e1002431</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pgen.1002431</pub-id><!--<pub-id pub-id-type="pmcid">3261927</pub-id>--><?supplied-pmid 22275870?><pub-id pub-id-type="pmid">22275870</pub-id></mixed-citation></ref><ref id="ref-14"><label>14</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cookson</surname><given-names>W</given-names></name><name><surname>Liang</surname><given-names>L</given-names></name><name><surname>Abecasis</surname><given-names>G</given-names></name><etal/></person-group>:
<article-title>Mapping complex disease traits with global gene expression.</article-title><source><italic>Nat Rev Genet.</italic></source><year>2009</year>;<volume>10</volume>(<issue>3</issue>):<fpage>184</fpage>&#x02013;<lpage>194</lpage>.
<pub-id pub-id-type="doi">10.1038/nrg2537</pub-id><?supplied-pmid 19223927?><pub-id pub-id-type="pmid">19223927</pub-id></mixed-citation></ref><ref id="ref-15"><label>15</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Westra</surname><given-names>HJ</given-names></name><name><surname>Peters</surname><given-names>MJ</given-names></name><name><surname>Esko</surname><given-names>T</given-names></name><etal/></person-group>:
<article-title>Systematic identification of trans eQTLs as putative drivers of known disease associations.</article-title><source><italic>Nat Genet.</italic></source><year>2013</year>;<volume>45</volume>(<issue>10</issue>):<fpage>1238</fpage>&#x02013;<lpage>1243</lpage>.
<pub-id pub-id-type="doi">10.1038/ng.2756</pub-id><!--<pub-id pub-id-type="pmcid">3991562</pub-id>--><?supplied-pmid 24013639?><pub-id pub-id-type="pmid">24013639</pub-id></mixed-citation></ref><ref id="ref-16"><label>16</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thanabalasingham</surname><given-names>G</given-names></name><name><surname>Huffman</surname><given-names>JE</given-names></name><name><surname>Kattla</surname><given-names>JJ</given-names></name><etal/></person-group>:
<article-title>Mutations in HNF1A result in marked alterations of plasma glycan profile.</article-title><source><italic>Diabetes.</italic></source><year>2013</year>;<volume>62</volume>(<issue>4</issue>):<fpage>1329</fpage>&#x02013;<lpage>1337</lpage>.
<pub-id pub-id-type="doi">10.2337/db12-0880</pub-id><!--<pub-id pub-id-type="pmcid">3609552</pub-id>--><?supplied-pmid 23274891?><pub-id pub-id-type="pmid">23274891</pub-id></mixed-citation></ref><ref id="ref-17"><label>17</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>J</given-names></name><name><surname>Pressoir</surname><given-names>G</given-names></name><name><surname>Briggs</surname><given-names>WH</given-names></name><etal/></person-group>:
<article-title>A unified mixed-model method for association mapping that accounts for multiple levels of relatedness.</article-title><source><italic>Nat Genet.</italic></source><year>2006</year>;<volume>38</volume>(<issue>2</issue>):<fpage>203</fpage>&#x02013;<lpage>208</lpage>.
<pub-id pub-id-type="doi">10.1038/ng1702</pub-id><?supplied-pmid 16380716?><pub-id pub-id-type="pmid">16380716</pub-id></mixed-citation></ref><ref id="ref-18"><label>18</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Astle</surname><given-names>W</given-names></name><name><surname>Balding</surname><given-names>DJ</given-names></name></person-group>:
<article-title>Population structure and cryptic relatedness in genetic association studies.</article-title><source><italic>Statist Sci.</italic></source><year>2009</year>;<volume>24</volume>(<issue>4</issue>):<fpage>451</fpage>&#x02013;<lpage>471</lpage>
<pub-id pub-id-type="doi">10.1214/09-STS307</pub-id></mixed-citation></ref><ref id="ref-19"><label>19</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kang</surname><given-names>HM</given-names></name><name><surname>Sul</surname><given-names>JH</given-names></name><name><surname>Service</surname><given-names>SK</given-names></name><etal/></person-group>:
<article-title>Variance component model to account for sample structure in genome-wide association studies.</article-title><source><italic>Nat Genet.</italic></source><year>2010</year>;<volume>42</volume>(<issue>4</issue>):<fpage>348</fpage>&#x02013;<lpage>354</lpage>.
<pub-id pub-id-type="doi">10.1038/ng.548</pub-id><!--<pub-id pub-id-type="pmcid">3092069</pub-id>--><?supplied-pmid 20208533?><pub-id pub-id-type="pmid">20208533</pub-id></mixed-citation></ref><ref id="ref-20"><label>20</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Z</given-names></name><name><surname>Ersoz</surname><given-names>E</given-names></name><name><surname>Lai</surname><given-names>CQ</given-names></name><etal/></person-group>:
<article-title>Mixed linear model approach adapted for genome-wide association studies.</article-title><source><italic>Nat Genet.</italic></source><year>2010</year>;<volume>42</volume>(<issue>4</issue>):<fpage>355</fpage>&#x02013;<lpage>360</lpage>.
<pub-id pub-id-type="doi">10.1038/ng.546</pub-id><!--<pub-id pub-id-type="pmcid">2931336</pub-id>--><?supplied-pmid 20208535?><pub-id pub-id-type="pmid">20208535</pub-id></mixed-citation></ref><ref id="ref-21"><label>21</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aulchenko</surname><given-names>Y</given-names></name><name><surname>Struchalin</surname><given-names>M</given-names></name><name><surname>van Duijn</surname><given-names>C</given-names></name></person-group>:
<article-title>ProbABEL package for genome-wide association analysis of imputed data.</article-title><source><italic>BMC Bioinformatics.</italic></source><year>2010</year>;<volume>11</volume>:<fpage>134</fpage>.
<pub-id pub-id-type="doi">10.1186/1471-2105-11-134</pub-id><!--<pub-id pub-id-type="pmcid">2846909</pub-id>--><?supplied-pmid 20233392?><pub-id pub-id-type="pmid">20233392</pub-id></mixed-citation></ref><ref id="ref-22"><label>22</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lippert</surname><given-names>C</given-names></name><name><surname>Listgarten</surname><given-names>J</given-names></name><name><surname>Liu</surname><given-names>Y</given-names></name><etal/></person-group>:
<article-title>FaST linear mixed models for genome-wide association studies.</article-title><source><italic>Nat Methods.</italic></source><year>2011</year>;<volume>8</volume>(<issue>10</issue>):<fpage>833</fpage>&#x02013;<lpage>835</lpage>.
<pub-id pub-id-type="doi">10.1038/nmeth.1681</pub-id><?supplied-pmid 21892150?><pub-id pub-id-type="pmid">21892150</pub-id></mixed-citation></ref><ref id="ref-23"><label>23</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>X</given-names></name><name><surname>Stephens</surname><given-names>M</given-names></name></person-group>:
<article-title>Genome-wide efficient mixed-model analysis for association studies.</article-title><source><italic>Nat Genet.</italic></source><year>2012</year>;<volume>44</volume>(<issue>7</issue>):<fpage>821</fpage>&#x02013;<lpage>824</lpage>.
<pub-id pub-id-type="doi">10.1038/ng.2310</pub-id><!--<pub-id pub-id-type="pmcid">3386377</pub-id>--><?supplied-pmid 22706312?><pub-id pub-id-type="pmid">22706312</pub-id></mixed-citation></ref><ref id="ref-24"><label>24</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Segura</surname><given-names>V</given-names></name><name><surname>Vilhjalmsson</surname><given-names>BJ</given-names></name><name><surname>Platt</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>An efficient multi-locus mixed-model approach for genome-wide association studies in structured populations.</article-title><source><italic>Nat Genet.</italic></source><year>2012</year>;<volume>44</volume>(<issue>7</issue>):<fpage>825</fpage>&#x02013;<lpage>830</lpage>.
<pub-id pub-id-type="doi">10.1038/ng.2314</pub-id><!--<pub-id pub-id-type="pmcid">3386481</pub-id>--><?supplied-pmid 22706313?><pub-id pub-id-type="pmid">22706313</pub-id></mixed-citation></ref><ref id="ref-25"><label>25</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svishcheva</surname><given-names>GR</given-names></name><name><surname>Axenovich</surname><given-names>TI</given-names></name><name><surname>Belonogova</surname><given-names>NM</given-names></name><etal/></person-group>:
<article-title>Rapid variance componentsbased method for whole-genome association analysis.</article-title><source><italic>Nat Genet.</italic></source><year>2012</year>;<volume>44</volume>(<issue>10</issue>):<fpage>1166</fpage>&#x02013;<lpage>1170</lpage>.
<pub-id pub-id-type="doi">10.1038/ng.2410</pub-id><?supplied-pmid 22983301?><pub-id pub-id-type="pmid">22983301</pub-id></mixed-citation></ref><ref id="ref-26"><label>26</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fabregat-Traver</surname><given-names>D</given-names></name><name><surname>Bientinesi</surname><given-names>P</given-names></name></person-group>:
<article-title>Applicationtailored linear algebra algorithms: A search-based approach.</article-title><source><italic>Int J High Perform Comput Appl.</italic></source><year>2013</year>;<volume>27</volume>(<issue>4</issue>):<fpage>425</fpage>&#x02013;<lpage>438</lpage>
<pub-id pub-id-type="doi">10.1177/1094342013494428</pub-id></mixed-citation></ref><ref id="ref-27"><label>27</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fabregat-Traver</surname><given-names>D</given-names></name><name><surname>Aulchenko</surname><given-names>Y</given-names></name><name><surname>Bientinesi</surname><given-names>P</given-names></name></person-group>:
<article-title>Solving sequences of generalized least-squares problems on multi-threaded architectures.</article-title><source><italic>Appl Math Comput.</italic></source><year>2014</year>;<volume>234</volume>:<fpage>606</fpage>&#x02013;<lpage>617</lpage>
<pub-id pub-id-type="doi">10.1016/j.amc.2014.02.056</pub-id></mixed-citation></ref><ref id="ref-28"><label>28</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Astle</surname><given-names>W</given-names></name><name><surname>Balding</surname><given-names>DJ</given-names></name></person-group>:
<article-title>Population structure and cryptic relatedness in genetic association studies</article-title>. Ph.D. thesis, The University of London.
<source><italic>Statist Sci.</italic></source><year>2009</year>;<volume>24</volume>(<issue>4</issue>):<fpage>451</fpage>&#x02013;<lpage>471</lpage>
<pub-id pub-id-type="doi">10.1214/09-STS307</pub-id></mixed-citation></ref><ref id="ref-29"><label>29</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aulchenko</surname><given-names>YS</given-names></name><name><surname>Ripke</surname><given-names>S</given-names></name><name><surname>Isaacs</surname><given-names>A</given-names></name><etal/></person-group>:
<article-title>GenABEL: an R library for genome-wide association analysis.</article-title><source><italic>Bioinformatics.</italic></source><year>2007</year>;<volume>23</volume>(<issue>10</issue>):<fpage>1294</fpage>&#x02013;<lpage>6</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btm108</pub-id><?supplied-pmid 17384015?><pub-id pub-id-type="pmid">17384015</pub-id></mixed-citation></ref><ref id="ref-30"><label>30</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Suhre</surname><given-names>K</given-names></name><name><surname>Shin</surname><given-names>SY</given-names></name><name><surname>Petersen</surname><given-names>AK</given-names></name><etal/></person-group>:
<article-title>Human metabolic individuality in biomedical and pharmaceutical research.</article-title><source><italic>Nature.</italic></source><year>2011</year>;<volume>477</volume>(<issue>7362</issue>):<fpage>54</fpage>&#x02013;<lpage>60</lpage>.
<pub-id pub-id-type="doi">10.1038/nature10354</pub-id><!--<pub-id pub-id-type="pmcid">3832838</pub-id>--><?supplied-pmid 21886157?><pub-id pub-id-type="pmid">21886157</pub-id></mixed-citation></ref><ref id="ref-31"><label>31</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goring</surname><given-names>HH</given-names></name><name><surname>Curran</surname><given-names>JE</given-names></name><name><surname>Johnson</surname><given-names>MP</given-names></name><etal/></person-group>:
<article-title>Discovery of expression QTLs using large-scale transcriptional profiling in human lymphocytes.</article-title><source><italic>Nat Genet.</italic></source><year>2007</year>;<volume>39</volume>(<issue>10</issue>):<fpage>1208</fpage>&#x02013;<lpage>1216</lpage>.
<pub-id pub-id-type="doi">10.1038/ng2119</pub-id><?supplied-pmid 17873875?><pub-id pub-id-type="pmid">17873875</pub-id></mixed-citation></ref><ref id="ref-32"><label>32</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lonsdale</surname><given-names>J</given-names></name><name><surname>Thomas</surname><given-names>J</given-names></name><name><surname>Salvatore</surname><given-names>M</given-names></name><etal/></person-group>:
<collab>GTEx Consortium</collab>.
<article-title>The Genotype-Tissue Expression (GTEx) project.</article-title><source><italic>Nat Genet.</italic></source><year>2013</year>;<volume>45</volume>(<issue>6</issue>):<fpage>580</fpage>&#x02013;<lpage>585</lpage>.
<pub-id pub-id-type="doi">10.1038/ng.2653</pub-id><!--<pub-id pub-id-type="pmcid">4010069</pub-id>--><?supplied-pmid 23715323?><pub-id pub-id-type="pmid">23715323</pub-id></mixed-citation></ref><ref id="ref-33"><label>33</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Price</surname><given-names>AL</given-names></name><name><surname>Patterson</surname><given-names>NJ</given-names></name><name><surname>Plenge</surname><given-names>RM</given-names></name><etal/></person-group>:
<article-title>Principal components analysis corrects for stratification in genome-wide association studies.</article-title><source><italic>Nat Genet.</italic></source><year>2006</year>;<volume>38</volume>(<issue>8</issue>):<fpage>904</fpage>&#x02013;<lpage>909</lpage>.
<pub-id pub-id-type="doi">10.1038/ng1847</pub-id><?supplied-pmid 16862161?><pub-id pub-id-type="pmid">16862161</pub-id></mixed-citation></ref><ref id="ref-34"><label>34</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shabalin</surname><given-names>AA</given-names></name></person-group>:
<article-title>Matrix eQTL: ultra fast eQTL analysis via large matrix operations.</article-title><source><italic>Bioinformatics.</italic></source><year>2012</year>;<volume>28</volume>(<issue>10</issue>):<fpage>1353</fpage>&#x02013;<lpage>1358</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/bts163</pub-id><!--<pub-id pub-id-type="pmcid">3348564</pub-id>--><?supplied-pmid 22492648?><pub-id pub-id-type="pmid">22492648</pub-id></mixed-citation></ref><ref id="ref-35"><label>35</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conneely</surname><given-names>KN</given-names></name><name><surname>Boehnke</surname><given-names>M</given-names></name></person-group>:
<article-title>So many correlated tests, so little time! Rapid adjustment of P values for multiple correlated tests.</article-title><source><italic>Am J Hum Genet.</italic></source><year>2007</year>;<volume>81</volume>(<issue>6</issue>):<fpage>1158</fpage>&#x02013;<lpage>1168</lpage>.
<pub-id pub-id-type="doi">10.1086/522036</pub-id><!--<pub-id pub-id-type="pmcid">2276357</pub-id>--><?supplied-pmid 17966093?><pub-id pub-id-type="pmid">17966093</pub-id></mixed-citation></ref><ref id="ref-36"><label>36</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>MX</given-names></name><name><surname>Gui</surname><given-names>HS</given-names></name><name><surname>Kwan</surname><given-names>JH</given-names></name><etal/></person-group>:
<article-title>GATES: a rapid and powerful gene-based association test using extended Simes procedure.</article-title><source><italic>Am J Hum Genet.</italic></source><year>2011</year>;<volume>88</volume>(<issue>3</issue>):<fpage>283</fpage>&#x02013;<lpage>293</lpage>.
<pub-id pub-id-type="doi">10.1016/j.ajhg.2011.01.019</pub-id><!--<pub-id pub-id-type="pmcid">3059433</pub-id>--><?supplied-pmid 21397060?><pub-id pub-id-type="pmid">21397060</pub-id></mixed-citation></ref><ref id="ref-37"><label>37</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Sluis</surname><given-names>S</given-names></name><name><surname>Posthuma</surname><given-names>D</given-names></name><name><surname>Dolan</surname><given-names>CV</given-names></name></person-group>:
<article-title>TATES: Efficient multivariate genotype-phenotype analysis for genome-wide association studies.</article-title><source><italic>PLoS Genet.</italic></source><year>2013</year>;<volume>9</volume>(<issue>1</issue>):<fpage>e1003235</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pgen.1003235</pub-id><!--<pub-id pub-id-type="pmcid">3554627</pub-id>--><?supplied-pmid 23359524?><pub-id pub-id-type="pmid">23359524</pub-id></mixed-citation></ref><ref id="ref-38"><label>38</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fusi</surname><given-names>N</given-names></name><name><surname>Stegle</surname><given-names>O</given-names></name><name><surname>Lawrence</surname><given-names>ND</given-names></name></person-group>:
<article-title>Joint modelling of confounding factors and prominent genetic regulators provides increased accuracy in genetical genomics studies.</article-title><source><italic>PLoS Comput Biol.</italic></source><year>2012</year>;<volume>8</volume>(<issue>1</issue>):<fpage>e1002330</fpage>.
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1002330</pub-id><!--<pub-id pub-id-type="pmcid">3252274</pub-id>--><?supplied-pmid 22241974?><pub-id pub-id-type="pmid">22241974</pub-id></mixed-citation></ref><ref id="ref-39"><label>39</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fusi</surname><given-names>N</given-names></name><name><surname>Lippert</surname><given-names>C</given-names></name><name><surname>Borgwardt</surname><given-names>K</given-names></name><etal/></person-group>:
<article-title>Detecting regulatory gene-environment interactions with unmeasured environmental factors.</article-title><source><italic>Bioinformatics.</italic></source><year>2013</year>;<volume>29</volume>(<issue>11</issue>):<fpage>1382</fpage>&#x02013;<lpage>1389</lpage>.
<pub-id pub-id-type="doi">10.1093/bioinformatics/btt148</pub-id><?supplied-pmid 23559640?><pub-id pub-id-type="pmid">23559640</pub-id></mixed-citation></ref><ref id="ref-40"><label>40</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shen</surname><given-names>X</given-names></name><name><surname>Alam</surname><given-names>M</given-names></name><name><surname>Fikse</surname><given-names>F</given-names></name><etal/></person-group>:
<article-title>A novel generalized ridge regression method for quantitative genetics.</article-title><source><italic>Genetics.</italic></source><year>2013</year>;<volume>193</volume>(<issue>4</issue>):<fpage>1255</fpage>&#x02013;<lpage>1268</lpage>.
<pub-id pub-id-type="doi">10.1534/genetics.112.146720</pub-id><!--<pub-id pub-id-type="pmcid">3606101</pub-id>--><?supplied-pmid 23335338?><pub-id pub-id-type="pmid">23335338</pub-id></mixed-citation></ref><ref id="ref-41"><label>41</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fabregat-TRaver</surname><given-names>D</given-names></name><name><surname>Sharapov</surname><given-names>SZ</given-names></name><name><surname>Hayward</surname><given-names>C</given-names></name><etal/></person-group>:
<article-title>OmicABEL software for genome-wide association studies.</article-title><source><italic>Zenodo.</italic></source><year>2014</year>
<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5281/zenodo.1099941">Data Source</ext-link></mixed-citation></ref><ref id="ref-42"><label>42</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Abecasis</surname><given-names>G</given-names></name></person-group>:
<article-title>Family-based association tests for genomewide association scans.</article-title><source><italic>Am J Hum Genet.</italic></source><year>2007</year>;<volume>81</volume>(<issue>5</issue>):<fpage>913</fpage>&#x02013;<lpage>926</lpage>.
<pub-id pub-id-type="doi">10.1086/521580</pub-id><!--<pub-id pub-id-type="pmcid">2265659</pub-id>--><?supplied-pmid 17924335?><pub-id pub-id-type="pmid">17924335</pub-id></mixed-citation></ref><ref id="ref-43"><label>43</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dongarra</surname><given-names>J</given-names></name><name><surname>Croz</surname><given-names>JD</given-names></name><name><surname>Hammarling</surname><given-names>S</given-names></name><etal/></person-group>:
<article-title>A set of level 3 basic linear algebra subprograms.</article-title><source><italic>ACM Trans Math Softw.</italic></source><year>1990</year>;<volume>16</volume>(<issue>1</issue>):<fpage>1</fpage>&#x02013;<lpage>17</lpage>
<pub-id pub-id-type="doi">10.1145/77626.79170</pub-id></mixed-citation></ref><ref id="ref-44"><label>44</label><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>E</given-names></name><name><surname>Bai</surname><given-names>Z</given-names></name><name><surname>Bischof</surname><given-names>C</given-names></name><etal/></person-group>:
<article-title>LAPACK Users&#x02019; Guide</article-title>. Philadelphia, PA: Society for Industrial and Applied Mathematics, third edition.<year>1999</year>
<pub-id pub-id-type="doi">10.1137/1.9780898719604</pub-id></mixed-citation></ref><ref id="ref-45"><label>45</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vitart</surname><given-names>V</given-names></name><name><surname>Biloglav</surname><given-names>Z</given-names></name><name><surname>Hayward</surname><given-names>C</given-names></name><etal/></person-group>:
<article-title>3000 years of solitude: extreme differentiation in the island isolates of Dalmatia, Croatia.</article-title><source><italic>Eur J Hum Genet.</italic></source><year>2006</year>;<volume>14</volume>(<issue>4</issue>):<fpage>478</fpage>&#x02013;<lpage>487</lpage>.
<pub-id pub-id-type="doi">10.1038/sj.ejhg.5201589</pub-id><?supplied-pmid 16493443?><pub-id pub-id-type="pmid">16493443</pub-id></mixed-citation></ref><ref id="ref-46"><label>46</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rudan</surname><given-names>I</given-names></name><name><surname>Marusi&#x00107;</surname><given-names>A</given-names></name><name><surname>Jankovi&#x00107;</surname><given-names>S</given-names></name><etal/></person-group>:
<article-title>&#x0201c;10001 dalmatians:&#x0201d; Croatia launches its national biobank.</article-title><source><italic>Croat Med J.</italic></source><year>2009</year>;<volume>50</volume>(<issue>1</issue>):<fpage>4</fpage>&#x02013;<lpage>6</lpage>.
<pub-id pub-id-type="doi">10.3325/cmj.2009.50.4</pub-id><!--<pub-id pub-id-type="pmcid">2657560</pub-id>--><?supplied-pmid 19260138?><pub-id pub-id-type="pmid">19260138</pub-id></mixed-citation></ref></ref-list></back><sub-article id="report5915" article-type="peer-review"><front-stub><article-id pub-id-type="doi">10.5256/f1000research.5195.r5915</article-id><title-group><article-title>Referee response for version 1</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Muller-Myhsok</surname><given-names>Bertram</given-names></name><xref ref-type="aff" rid="r5915a1">1</xref><role>Referee</role></contrib><aff id="r5915a1"><label>1</label>Max Planck Institute for Psychiatry, Munich, Germany</aff></contrib-group><author-notes><fn fn-type="conflict"><p>
<bold>Competing interests: </bold>No competing interests were disclosed.</p></fn></author-notes><pub-date pub-type="epub"><day>11</day><month>2</month><year>2015</year></pub-date><related-article id="d35e8153" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.4867.1">Version </related-article><custom-meta-group><custom-meta><meta-name>recommendation</meta-name><meta-value>approve</meta-value></custom-meta></custom-meta-group></front-stub><body><p>This is a very well written report on a very important topic of very high impact in the actual of omics and multi-level omics data, allowing beyond sheer analysis (which in large data sets is very demanding indeed in terms of runtime and memory) many more questions answered also for methods research.</p><p>The methods put forward present a very major step forward for this type of analysis. The methodology is very sound and promising. A tool to actually use is provided, which is also not always the case.</p><p>The authors are to be commended for this work.</p><p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p></body></sub-article><sub-article id="report5916" article-type="peer-review"><front-stub><article-id pub-id-type="doi">10.5256/f1000research.5195.r5916</article-id><title-group><article-title>Referee response for version 1</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Holmans</surname><given-names>Peter</given-names></name><xref ref-type="aff" rid="r5916a1">1</xref><role>Referee</role></contrib><aff id="r5916a1"><label>1</label>MRC Center for Neuropsychiatric Genetics and Genomics, Cardiff University, Cardiff, UK</aff></contrib-group><author-notes><fn fn-type="conflict"><p>
<bold>Competing interests: </bold>No competing interests were disclosed.</p></fn></author-notes><pub-date pub-type="epub"><day>5</day><month>9</month><year>2014</year></pub-date><related-article id="d35e8205" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.4867.1">Version </related-article><custom-meta-group><custom-meta><meta-name>recommendation</meta-name><meta-value>approve</meta-value></custom-meta></custom-meta-group></front-stub><body><p>This article introduces a new software tool (omicABEL) for performing rapid association analyses between SNP data and high-dimensional "omics" data (e.g. gene expression) using mixed models. This is an extremely important development for the following reasons:
<list list-type="order"><list-item><p>Identification of genetic variants associated with gene expression (eQTLs), methylation (mQTLs) etc is becoming ever more important in understanding the biology of complex genetic disorders.</p></list-item><list-item><p>It is desirable, when performing association analyses, to allow for population stratification and/or cryptic relatedness among members of the sample. Mixed models are an effective way of doing this.</p></list-item><list-item><p>The high dimensionality of the "omics" data (tens or even hundreds of thousands of measurements) has made the application of mixed model association approaches computationally prohibitive up to now. In addition to detailing an application of considerable practical utility, the article is also clearly written and mathematically rigorous.</p></list-item></list>
</p><p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard.</p></body></sub-article><sub-article id="report5981" article-type="peer-review"><front-stub><article-id pub-id-type="doi">10.5256/f1000research.5195.r5981</article-id><title-group><article-title>Referee response for version 1</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Jan de Koning</surname><given-names>Dirk</given-names></name><xref ref-type="aff" rid="r5981a1">1</xref><role>Referee</role></contrib><aff id="r5981a1"><label>1</label>Department of Animal Breeding and Genetics, Swedish University of Agricultural Sciences, Uppsala, Sweden</aff></contrib-group><author-notes><fn fn-type="conflict"><p>
<bold>Competing interests: </bold>No competing interests were disclosed.</p></fn></author-notes><pub-date pub-type="epub"><day>29</day><month>8</month><year>2014</year></pub-date><related-article id="d35e8264" related-article-type="peer-reviewed-article" ext-link-type="doi" xlink:href="10.12688/f1000research.4867.1">Version </related-article><custom-meta-group><custom-meta><meta-name>recommendation</meta-name><meta-value>approve-with-reservations</meta-value></custom-meta></custom-meta-group></front-stub><body><p>The manuscript shows a computational approach that enABELs the use of linear mixed mixed models for large pedigrees, large numbers of markers and large numbers of (omics) traits.</p><p>While the work is interesting, several things need to be clarified before the work can be of interest to the wider community.</p><p>I assume that the manuscript is aimed at the potential users: researchers in genetics with an interest to analyze their 'big data' in a correct fashion and in a repeatable fashion. The manuscript is compact but possibly too compact in places. I would like the following points to be addressed:</p><p>&#x000a0;
<list list-type="order"><list-item><p>Accuracy of estimates and comparison of results. The authors make a big deal about comparing the approaches in terms of computing time. They should also be compared systematically in terms of type I error, accuracy of estimates etc. The computational approximations that are made must come at some cost and as researchers we need to know this cost. There are some token comparisons in the supplementary tables but these deal with heritability and P values. Not with the actual SNP effects which are what we want from these analyses. Some scatter plots between different methods may be helpful.</p></list-item><list-item><p>We need more detail about the simulations.&#x000a0;You simulate different population sizes but you must clarify the family structures and the family complexity. How many generations? All family sizes equal? etc.&#x000a0;Also how you simulate marker data in terms of historical population size, lD structure etc. Likewise for correlation structure among the multiple traits.</p></list-item><list-item><p>In many places, variables are used before they are defined. p appears in Table 1 but is only clarified later in the text.&#x000a0;The tables are currently not readable on their own and the acronyms and variables should be explained within the tables.</p></list-item></list>&#x000a0;</p><p>In general, the mathematical notation as well as the language in general needs a bit of work. Some sentences are too long with too many clauses, for example CLAK is not defined at first use. X and y are linearly transformed: should you not introduce new variables for the transformed data?
<list list-type="bullet"><list-item><p>Some parts of result should be in the Materials and Methods.</p></list-item><list-item><p>Figure 3C could have a logarithmic Y-axis.</p></list-item><list-item><p>Figure 3D could omit line for CLAK-Eig and CLAK-Chol is unlabeled.</p></list-item><list-item><p>The abbreviation in Table S3 cer-cer lpc, pls spm pc pe etc. makes no sense to me. They are different trait classes but still the table adds very little.</p></list-item></list>&#x000a0;</p><p>The manuscript has the promise to introduce an interesting new computational approach, but we need more details to make up our mind.</p><p>I have read this submission. I believe that I have an appropriate level of expertise to confirm that it is of an acceptable scientific standard, however I have significant reservations, as outlined above.</p></body></sub-article></article>