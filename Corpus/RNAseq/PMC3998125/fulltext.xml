<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing.dtd?><?SourceDTD.Version 2.3?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3998125</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btt756</article-id><article-id pub-id-type="publisher-id">btt756</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Notes</subject><subj-group subj-group-type="heading"><subject>Genome Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>CGAT: computational genomics analysis toolkit</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Sims</surname><given-names>David</given-names></name></contrib><contrib contrib-type="author"><name><surname>Ilott</surname><given-names>Nicholas E.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Sansom</surname><given-names>Stephen N.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Sudbery</surname><given-names>Ian M.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Johnson</surname><given-names>Jethro S.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Fawcett</surname><given-names>Katherine A.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Berlanga-Taylor</surname><given-names>Antonio J.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Luna-Valero</surname><given-names>Sebastian</given-names></name></contrib><contrib contrib-type="author"><name><surname>Ponting</surname><given-names>Chris P.</given-names></name></contrib><contrib contrib-type="author"><name><surname>Heger</surname><given-names>Andreas</given-names></name><xref ref-type="corresp" rid="btt756-COR1">*</xref></contrib><aff>CGAT, MRC Functional Genomics Unit, Department of Physiology, Anatomy and Genetics, Parks Road, Oxford OX1 3PT, UK</aff></contrib-group><author-notes><corresp id="btt756-COR1">*To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Michael Brudno</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>5</month><year>2014</year></pub-date><pub-date pub-type="epub"><day>5</day><month>1</month><year>2014</year></pub-date><pub-date pub-type="pmc-release"><day>5</day><month>1</month><year>2014</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the							<pub-date pub-type="epub"/>. --><volume>30</volume><issue>9</issue><fpage>1290</fpage><lpage>1291</lpage><history><date date-type="received"><day>4</day><month>10</month><year>2013</year></date><date date-type="rev-recd"><day>27</day><month>11</month><year>2013</year></date><date date-type="accepted"><day>20</day><month>12</month><year>2013</year></date></history><permissions><copyright-statement>&#x000a9; The Author 2014. Published by Oxford University Press.</copyright-statement><copyright-year>2014</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by/3.0/"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">http://creativecommons.org/licenses/by/3.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p><bold>Summary:</bold> Computational genomics seeks to draw biological inferences from genomic datasets, often by integrating and contextualizing next-generation sequencing data. CGAT provides an extensive suite of tools designed to assist in the analysis of genome scale data from a range of standard file formats. The toolkit enables filtering, comparison, conversion, summarization and annotation of genomic intervals, gene sets and sequences. The tools can both be run from the Unix command line and installed into visual workflow builders, such as Galaxy.</p><p><bold>Availability:</bold> The toolkit is freely available from <ext-link ext-link-type="uri" xlink:href="http://github.com/CGATOxford/cgat">http://github.com/CGATOxford/cgat</ext-link></p><p><bold>Contact:</bold>
<email>andreas.heger@dpag.ox.ac.uk</email></p></abstract><counts><page-count count="2"/></counts></article-meta></front><body><sec><title>1 INTRODUCTION</title><p>A central task in computational genomics is to extract biologically meaningful summaries and annotations from short read sequences to facilitate both visualization and statistical analysis. Commonly, this process starts by mapping next-generation sequencing (NGS) reads and quantitating their distribution in genomic features such as transcripts with expression level and transcription factor binding sites with peak scores. This initial contextualization phase is well supported by specialized tools such as Tophat/Cufflinks (<xref rid="btt756-B16" ref-type="bibr">Trapnell <italic>et al.</italic>, 2012</xref>) or MACS (<xref rid="btt756-B3" ref-type="bibr">Feng <italic>et al.</italic>, 2012</xref>). In a second phase, datasets are typically integrated to allow interpretation, asking, for example, how many transcription factor binding sites are associated with each of exonic, intronic, flanking and intergenic genomic annotations. This phase necessarily relies on computational tools that can describe, integrate and summarize a variety of feature files produced from the initial phase and external annotation sources. Here we introduce a collection of tools that assist genomic scientists in successfully performing this crucial data integration and interpretation phase, bridging the gap from raw data to biologically interpretable results. We have made extensive use of these tools in a number of NGS projects (<xref rid="btt756-B9" ref-type="bibr">Long <italic>et al.</italic>, 2013</xref>, <xref rid="btt756-B10" ref-type="bibr">Rajan <italic>et al.</italic>, 2013</xref>, <xref rid="btt756-B12" ref-type="bibr">Ramagopalan <italic>et al.</italic>, 2010</xref>).</p></sec><sec><title>2 OVERVIEW</title><p>The computational genomic analysis toolkit comprises &#x0003e;50 tools, each with documentation and examples. Tools are tagged to facilitate discovery. Tags associate tools with broad themes (genomic intervals, gene sets, sequences), standard genomic file formats (BED, GTF, BAM, FASTA/Q) and the type of computation performed by the tool, such as statistical summary, format conversion, annotation, comparison or filtering.</p><p>As an illustrative example, a gene set can be annotated with the tool <italic>gtf2table.</italic> In fact, <italic>gtf2table</italic> provides &#x0003e;25 different methods to annotate transcript models. Annotation is dependent on auxiliary data: given a genome sequence, transcripts can be annotated by composition (e.g. %GC); given a reference gene set, transcripts can be marked as fragments or extensions, enabling the user to ascertain the completeness of transcript models built for RNAseq data. Given a BAM file with NGS read data, <italic>gtf2table</italic> can compute coverage in sense/antisense direction over transcript models; another example, <italic>bam2geneprofile</italic> computes and plots metagene-profiles from mapped NGS read data in BAM format (<xref ref-type="fig" rid="btt756-F1">Fig. 1</xref>a). Different metagene models (with/without UTRs/introns, etc.) and various normalization options are available. Finally, the tool <italic>bam2peakshape</italic> computes read densities in specified genomic intervals to generate matrix data suitable for visualization in heatmaps (<xref ref-type="fig" rid="btt756-F1">Fig. 1</xref>b). The toolkit also contains standard sequence analysis utilities such as <italic>fasta2table</italic>, which annotates sequences with CpG frequencies, codon frequencies and amino acid composition. To assist the interpretation of NGS data, the toolkit implements various classification schemes for transcript data or interval data. RNA-seq-derived transcripts can be marked as instances, fragments, extensions or alternative versions of transcripts in a reference gene set. Chromatin immunoprecipitation-sequencing (ChIP-Seq) intervals can be marked as intronic, intergenic or within the UTR, upstream or downstream regions of transcript models. Finally, the toolkit provides tools to summarize genomic datasets, reporting the number of intervals or transcripts per chromosome, size distributions of features and more.
<fig id="btt756-F1" position="float"><label>Fig. 1.</label><caption><p>Visualization of the output of (<bold>a</bold>) bam2geneprofile and (<bold>b</bold>) bam2peakshape</p></caption><graphic xlink:href="btt756f1p"/></fig></p></sec><sec id="SEC3"><title>3 USAGE</title><p>We introduce the usage of the computational genomics analysis toolkit with a brief example. The fully worked example can be found online. Given a set of transcription factor binding intervals from a ChIP-seq experiment in BED format (<italic>nfkb.bed</italic>), we wish to determine how many binding intervals lie within exons, introns or intergenic sequence using a reference gene set from GENCODE (<xref rid="btt756-B6" ref-type="bibr">Harrow <italic>et al.</italic>, 2012</xref>), in GTF format (<italic>hg19.gtf</italic>). We then want to plot the density of binding relative to transcript models and examine the chromatin signatures within the intervals:
<list list-type="simple"><list-item><p>cgat <bold>gtf2gtf</bold><bold>&#x02013;</bold>sort = gene &#x0003c; hg19.gtf</p></list-item><list-item><p>| cgat <bold>gtf2gtf</bold><bold>&#x02013;</bold>merge-exons-with-utr<sup>(1)</sup></p></list-item><list-item><p>| cgat <bold>gtf2gtf</bold>&#x02013;filter = longest-gene<sup>(2)</sup></p></list-item><list-item><p>| cgat <bold>gtf2gff</bold><bold>&#x02013;</bold>flank=5000&#x02013;method = genome<sup>(3) </sup>&#x0003e; <italic>annotations.gff</italic></p></list-item><list-item><p>cgat <bold>bed2table</bold><bold>&#x02013;</bold>filename-gff = <italic>annotations.gff</italic></p></list-item><list-item><p>&#x02003;&#x02013;counter=classifier-chipseq&#x0003c;nfkb.bed&#x0003e;<italic>annotated_peaks.tsv</italic><sup>(4)</sup></p></list-item></list>
</p><p>The above sequence of Unix commands in turn (1) merges all exons of alternative transcripts per gene, (2) retains the longest gene in the case of overlapping genes and (3) annotates exonic, intronic, intergenic and flanking regions (size = 5 kb) within and between genes. Choosing different options can provide different sets of answers. Instead of merging all exons per gene, the longest transcript might be selected by replacing (2) with <italic>gtf2gtf &#x02013; filter = longest-transcript</italic>. Note that the creation of <italic>annotations.gff`</italic> goes beyond simple interval intersection, as gene structures are normalized from multiple possible alternative transcripts to a single transcript that is chosen by the user depending on what is most relevant for the analysis.</p><p>The generated annotations are then used to classify the transcription factor binding sites using <italic>bed2table</italic> (4). The profile of ChIP-seq binding over genes can be calculated and plotted using <italic>bam2geneprofile</italic> (<xref ref-type="fig" rid="btt756-F1">Fig. 1</xref>a). Chromatin state at ChIP-seq peaks can be investigated by integrating H3K4me1 and H3K4me3 data for a relevant tissue (<xref rid="btt756-B2" ref-type="bibr">ENCODE Project Consortium <italic>et al.</italic>, 2012</xref>) using <italic>bam2peakshape</italic> and plotted in <italic>R</italic> (<xref rid="btt756-B11" ref-type="bibr">R Core Team, 2012</xref>) (<xref ref-type="fig" rid="btt756-F1">Fig. 1</xref>b). Statistical significance can be assessed using tools such as GAT (<xref rid="btt756-B7" ref-type="bibr">Heger <italic>et al.</italic>, 2013</xref>). More usage examples, including testing for functional enrichment, assessment of CpG content in long non-coding RNA promoters and clustering metagenomic contigs on tetranucleotide frequency, can be found online.</p></sec><sec id="SEC4"><title>4 IMPLEMENTATION</title><p>We aim to write legible and maintainable code that can serve as an entry point into computational methods for biologists. The toolkit is implemented in the Python language (<xref rid="btt756-B13" ref-type="bibr">van Rossum, 1995</xref>). Some performance-critical sections have been implemented in Cython (<xref rid="btt756-B1" ref-type="bibr">Behnel <italic>et al.</italic>, 2011</xref>). The toolkit can be installed from common Python package repositories. Dependencies will be installed automatically, although some tools require external software to be installed. All tools are freely available under the BSD 3-clause licence. The toolkit is under constant development, and community involvement in the project is welcome. Regression tests ensure that core functionality is maintained as scripts are extended. All tools are built using a common coding style and follow a naming scheme centred on common genomic file formats. The tools have a consistent command line interface enabling them to be combined into work flows using Unix pipes and integrated into automated pipelines allowing automated and parallel execution. They use a consistent logging mechanism to facilitate issue tracking. Furthermore, the use of common genomic formats means that tools can be easily combined with other popular genomic software such as BEDtools (<xref rid="btt756-B14" ref-type="bibr">Quinlan and Hall, 2010</xref>), University of California, Santa Cruz tools (<xref rid="btt756-B8" ref-type="bibr">Kuhn <italic>et al.</italic>, 2013</xref>) or biopieces, <ext-link ext-link-type="uri" xlink:href="http://www.biopieces.org">http://www.biopieces.org</ext-link>. An RDF (Resource Description Framework, <ext-link ext-link-type="uri" xlink:href="http://www.w3.org/RDF">http://www.w3.org/RDF</ext-link>) description of each tool can be generated for use with tools such as CLI-MATE (<xref rid="btt756-B15" ref-type="bibr">Tatum <italic>et al.</italic>, 2011</xref>) to generate XML files for a variety of workflow frameworks, such as Galaxy (<xref rid="btt756-B5" ref-type="bibr">Goecks <italic>et al.</italic>, 2010</xref>).</p><p><italic>Funding</italic>: This work was funded by the <funding-source>UK Medical Research Council</funding-source>.</p><p><italic>Conflict of Interest</italic>: none declared.</p></sec></body><back><ref-list><title>REFERENCES</title><ref id="btt756-B1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Behnel</surname><given-names>S</given-names></name><etal/></person-group><article-title>Cython: the best of both worlds</article-title><source>Comput. Sci. Eng.</source><year>2011</year><volume>13</volume><fpage>31</fpage><lpage>39</lpage></element-citation></ref><ref id="btt756-B2"><element-citation publication-type="journal"><collab>ENCODE Project Consortium <italic>et al.</italic></collab><article-title>An integrated encyclopedia of DNA elements in the human genome</article-title><source>Nature</source><year>2012</year><volume>7414</volume><fpage>57</fpage><lpage>74</lpage></element-citation></ref><ref id="btt756-B3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>J</given-names></name><etal/></person-group><article-title>Identifying ChIP-seq enrichment using MACS</article-title><source>Nat. Protoc.</source><year>2012</year><volume>7</volume><fpage>1728</fpage><lpage>1740</lpage><pub-id pub-id-type="pmid">22936215</pub-id></element-citation></ref><ref id="btt756-B5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goecks</surname><given-names>J</given-names></name><etal/></person-group><article-title>Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences</article-title><source>Genome Biol.</source><year>2010</year><volume>11</volume><fpage>R86</fpage><pub-id pub-id-type="pmid">20738864</pub-id></element-citation></ref><ref id="btt756-B6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrow</surname><given-names>J</given-names></name><etal/></person-group><article-title>GENCODE: the reference human genome annotation for The ENCODE Project</article-title><source>Genome Res.</source><year>2012</year><volume>22</volume><fpage>1760</fpage><lpage>1774</lpage><pub-id pub-id-type="pmid">22955987</pub-id></element-citation></ref><ref id="btt756-B7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heger</surname><given-names>A</given-names></name><etal/></person-group><article-title>GAT: a simulation framework for testing the association of genomic intervals</article-title><source>Bioinformatics</source><year>2013</year><volume>29</volume><fpage>2046</fpage><lpage>2048</lpage><pub-id pub-id-type="pmid">23782611</pub-id></element-citation></ref><ref id="btt756-B8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kuhn</surname><given-names>RM</given-names></name><etal/></person-group><article-title>The UCSC genome browser and associated tools</article-title><source>Brief. Bioinform.</source><year>2013</year><volume>14</volume><fpage>144</fpage><lpage>161</lpage><pub-id pub-id-type="pmid">22908213</pub-id></element-citation></ref><ref id="btt756-B9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Long</surname><given-names>HK</given-names></name><etal/></person-group><article-title>Epigenetic conservation at gene regulatory elements revealed by non-methylated DNA profiling in seven vertebrates</article-title><source>Elife</source><year>2013</year><volume>2</volume><fpage>e00348</fpage><comment>doi: 10.7554/eLife.00348</comment><pub-id pub-id-type="pmid">23467541</pub-id></element-citation></ref><ref id="btt756-B10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rajan</surname><given-names>P</given-names></name><etal/></person-group><article-title>Next-generation Sequencing of Advanced Prostate Cancer Treated with Androgen-deprivation Therapy</article-title><source>Eur. Urol.</source><year>2013</year><comment>[Epub ahead of print, doi: 10.1016/j.eururo.2013.08.011]</comment></element-citation></ref><ref id="btt756-B11"><element-citation publication-type="book"><collab>R Core Team</collab><article-title>R: a language and environment for statistical computing. ISBN 3-900051-07-0</article-title><year>2012</year><publisher-loc>Vienna, Austria</publisher-loc><publisher-name>R Foundation for Statistical Computing</publisher-name></element-citation></ref><ref id="btt756-B12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramagopalan</surname><given-names>SV</given-names></name><etal/></person-group><article-title>A ChIP-seq defined genome-wide map of vitamin D receptor binding: associations with disease and evolution</article-title><source>Genome Res.</source><year>2010</year><volume>20</volume><fpage>1352</fpage><lpage>1360</lpage><pub-id pub-id-type="pmid">20736230</pub-id></element-citation></ref><ref id="btt756-B13"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>van Rossum</surname><given-names>G</given-names></name></person-group><source>Python tutorial, Technical Report CS-R9526</source><year>1995</year><publisher-loc>Amsterdam</publisher-loc><publisher-name>Centrum voor Wiskunde en Informatica</publisher-name></element-citation></ref><ref id="btt756-B14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinlan</surname><given-names>AR</given-names></name><name><surname>Hall</surname><given-names>IM</given-names></name></person-group><article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><fpage>841</fpage><lpage>842</lpage><pub-id pub-id-type="pmid">20110278</pub-id></element-citation></ref><ref id="btt756-B15"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Tatum</surname><given-names>Z</given-names></name><etal/></person-group><article-title>CLI-mate: an interface generator for command line programs</article-title><source>Proceedings of the 4th International Workshop on Semantic Web Applications and Tools for the Life Sciences</source><year>2011</year><publisher-loc>New York, NY, USA</publisher-loc><publisher-name>ACM</publisher-name><fpage>114</fpage><lpage>115</lpage></element-citation></ref><ref id="btt756-B16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C</given-names></name><etal/></person-group><article-title>Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cufflinks</article-title><source>Nat. Protoc.</source><year>2012</year><volume>7</volume><fpage>562</fpage><lpage>567</lpage><pub-id pub-id-type="pmid">22383036</pub-id></element-citation></ref></ref-list></back></article>