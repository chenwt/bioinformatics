<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 39.96?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, CA USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">4889067</article-id><article-id pub-id-type="publisher-id">PONE-D-15-36807</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0155999</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Cell Biology</subject><subj-group><subject>Signal Transduction</subject><subj-group><subject>Cell Signaling</subject><subj-group><subject>Signaling Cascades</subject><subj-group><subject>WNT Signaling Cascade</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Physiological Processes</subject><subj-group><subject>Secretion</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Physiological Processes</subject><subj-group><subject>Secretion</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Oncology</subject><subj-group><subject>Cancers and Neoplasms</subject><subj-group><subject>Colorectal Cancer</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Cell Biology</subject><subj-group><subject>Cellular Types</subject><subj-group><subject>Animal Cells</subject><subj-group><subject>Immune Cells</subject><subj-group><subject>Antigen-Presenting Cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune Cells</subject><subj-group><subject>Antigen-Presenting Cells</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune Cells</subject><subj-group><subject>Antigen-Presenting Cells</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Network Analysis</subject><subj-group><subject>Signaling Networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene Expression</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene Expression</subject><subj-group><subject>Gene Regulation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Topology</subject></subj-group></subj-group></subj-group></article-categories><title-group><article-title>Refining Pathways: A Model Comparison Approach</article-title><alt-title alt-title-type="running-head">Refining Pathways: A Model Comparison Approach</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Moffa</surname><given-names>Giusi</given-names></name><xref ref-type="aff" rid="aff001"><sup>1</sup></xref><xref ref-type="corresp" rid="cor001">*</xref></contrib><contrib contrib-type="author"><name><surname>Erdmann</surname><given-names>Gerrit</given-names></name><xref ref-type="aff" rid="aff002"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Voloshanenko</surname><given-names>Oksana</given-names></name><xref ref-type="aff" rid="aff002"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Hundsrucker</surname><given-names>Christian</given-names></name><xref ref-type="aff" rid="aff001"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Sadeh</surname><given-names>Mohammad J.</given-names></name><xref ref-type="aff" rid="aff001"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Boutros</surname><given-names>Michael</given-names></name><xref ref-type="aff" rid="aff002"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Spang</surname><given-names>Rainer</given-names></name><xref ref-type="aff" rid="aff001"><sup>1</sup></xref></contrib></contrib-group><aff id="aff001"><label>1</label><addr-line>Department of Statistical Bioinformatics, Institute of Functional Genomics, University of Regensburg, Regensburg, Germany</addr-line></aff><aff id="aff002"><label>2</label><addr-line>Division of Signaling and Functional Genomics, German Cancer Research Center (DKFZ) and Department of Cell and Molecular Biology, Faculty of Medicine Mannheim, Heidelberg University, Heidelberg, Germany</addr-line></aff><contrib-group><contrib contrib-type="editor"><name><surname>Wang</surname><given-names>Hong</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1"><addr-line>Rutgers, the State Univesity of New Jersey, UNITED STATES</addr-line></aff><author-notes><fn fn-type="conflict" id="coi001"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><fn fn-type="con" id="contrib001"><p>Conceived and designed the experiments: MB RS. Performed the experiments: OV GE. Analyzed the data: GM CH. Wrote the paper: GM RS. Developed the statistical method: GM RS MJS.</p></fn><corresp id="cor001">* E-mail: <email>giusi.moffa@gmail.com</email></corresp></author-notes><pub-date pub-type="collection"><year>2016</year></pub-date><pub-date pub-type="epub"><day>1</day><month>6</month><year>2016</year></pub-date><volume>11</volume><issue>6</issue><elocation-id>e0155999</elocation-id><history><date date-type="received"><day>20</day><month>8</month><year>2015</year></date><date date-type="accepted"><day>6</day><month>5</month><year>2016</year></date></history><permissions><copyright-statement>&#x000a9; 2016 Moffa et al</copyright-statement><copyright-year>2016</copyright-year><copyright-holder>Moffa et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="pone.0155999.pdf"/><abstract><p>Cellular signalling pathways consolidate multiple molecular interactions into working models of signal propagation, amplification, and modulation. They are described and visualized as networks. Adjusting network topologies to experimental data is a key goal of systems biology. While network reconstruction algorithms like nested effects models are well established tools of computational biology, their data requirements can be prohibitive for their practical use. In this paper we suggest focussing on well defined aspects of a pathway and develop the computational tools to do so. We adapt the framework of nested effect models to focus on a specific aspect of activated Wnt signalling in HCT116 colon cancer cells: Does the activation of Wnt target genes depend on the secretion of Wnt ligands or do mutations in the signalling molecule <italic>&#x003b2;</italic>-catenin make this activation independent from them? We framed this question into two competing classes of models: Models that depend on Wnt ligands secretion versus those that do not. The model classes translate into restrictions of the pathways in the network topology. Wnt dependent models are more flexible than Wnt independent models. Bayes factors are the standard Bayesian tool to compare different models fairly on the data evidence. In our analysis, the Bayes factors depend on the number of potential Wnt signalling target genes included in the models. Stability analysis with respect to this number showed that the data strongly favours Wnt ligands dependent models for all realistic numbers of target genes.</p></abstract><funding-group><funding-statement>Work in the group of R.S. was supported by the NGFN-Project FKZ01GS08183 - Verbund Kolonkarzinom and the BioSysNet-Project - Bavarian Research Network for Molecular Biosystems. Work in the laboratory of M.B. was supported by grants from the BMBF (NGFN-plus 01GS08181-6) and BMBF GERF.</funding-statement></funding-group><counts><fig-count count="5"/><table-count count="0"/><page-count count="13"/></counts><custom-meta-group><custom-meta id="data-availability"><meta-name>Data Availability</meta-name><meta-value>ArrayExpress database with accession number E-MTAB-651 <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-651/">http://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-651/</ext-link>.</meta-value></custom-meta></custom-meta-group></article-meta><notes><title>Data Availability</title><p>ArrayExpress database with accession number E-MTAB-651 <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-651/">http://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-651/</ext-link>.</p></notes></front><body><sec sec-type="intro" id="sec001"><title>Introduction</title><p>Cellular signalling pathways like the Wnt pathway can be represented as networks modelling signal propagation, amplification and modulation of multiple molecular interactions. An important objective of systems biology is learning and adjusting the network topologies of pathways from experimental data.</p><p>During signal propagation, upstream components of the pathway control the activation of downstream components and, indirectly, the expression of target genes. Perturbations of signalling components affect the regulation of target genes and these gene expression changes reflect the topology of the pathway: Blocking an upstream component like a molecule of a receptor complex automatically blocks the activation of downstream components like signalling mediators or transcription factors. In fact, we use this concept as a definition of upstream/downstream relationships in pathways. With this definition, upstream components change the expression of more target genes then downstream components. Nested effects models (NEMs) implement this concept into an algorithm for inferring pathway topologies [<xref rid="pone.0155999.ref001" ref-type="bibr">1</xref>&#x02013;<xref rid="pone.0155999.ref003" ref-type="bibr">3</xref>]. They have been successfully applied to analyse LPS-mediated signalling in Drosophila cells [<xref rid="pone.0155999.ref001" ref-type="bibr">1</xref>], B-cell receptor signalling in human BL2-cells [<xref rid="pone.0155999.ref004" ref-type="bibr">4</xref>], cellular decision making in early murin embryonic stem cells differentiation [<xref rid="pone.0155999.ref003" ref-type="bibr">3</xref>], the yeast mediator complex [<xref rid="pone.0155999.ref005" ref-type="bibr">5</xref>], rhinovirus infection mechanisms [<xref rid="pone.0155999.ref006" ref-type="bibr">6</xref>], or gene regulatory interaction networks in C. elegans [<xref rid="pone.0155999.ref007" ref-type="bibr">7</xref>].</p><p>A new perturbation data set can support the current working model of a pathway or it can falsify it. NEMs are statistical tools designed to analyze such data. They predict a topology that can be compared to the current model. To apply the basic NEM algorithm, we must specify all signalling components in a pathway, silence or inhibit all of them, monitor all target genes, and provide this data as input to the algorithm, which returns the best scoring pathway topology. There can be many obstacles to this enterprise: Lists of a pathway&#x02019;s signalling components and target genes are incomplete, or they differ between references. It might be too expensive or even impossible to perform all perturbation experiments. Even if we accomplish all experiments, the pathway with all its fine details can be so large that computing its topology becomes prohibitive. We argue that in these cases resolving the full pathway is too ambitious.</p><p>A working model is falsified, if a specific aspect of the topology like an edge is in clear conflict to data. For instance, a pathway model that does not include cross-talk between two parallel branches of a pathway, while the data cannot be explained without such cross-talk. The question whether there is cross talk reduces to a single bit of information: a <italic>yes</italic> or a <italic>no</italic>. The basic NEM algorithm will provide a complex topology. A topology that with limited input data is very questionable. However, if we combine nested effects models with statistical principles like model comparison and stability analysis we can address the questions directly focussing on the single bit of information desired. In a statistical case study on Wnt signalling in HCT116 colon cancer cells, we show how properties of the pathway&#x02019;s topology can be studied using only a few perturbation assays and easily feasible computations.</p><p>More than 85% [<xref rid="pone.0155999.ref008" ref-type="bibr">8</xref>] of sporadic colorectal cancers (CRC) harbour mutations in proteins which regulate the canonical Wnt signalling pathway, like the adenomatous polyposis coli gene (<italic>APC</italic>) or the <italic>CTNNB1/&#x003b2;-catenin</italic> gene. Upon activation of the pathway, the destruction complex dissociates, <italic>&#x003b2;</italic>-catenin accumulates and translocates to the nucleus. There <italic>&#x003b2;</italic>-catenin acts as a transcriptional coactivator for TCF transcription factors (including <italic>TCF7L2</italic>) leading to the regulation of target genes such as <italic>AXIN2</italic>. Many cells produce Wnt ligands that signal in an autocrine or paracrine manner. Wnt ligands secretion depends on the Wnt-specific secretion factor Evi/Wls. The cell line HCT116 has a mutated CTNNB1 gene, which encodes the signalling protein <italic>&#x003b2;</italic>-catenin. We focus on the following question: Does the activation of Wnt target genes still depend on the secretion of Wnt ligands (a) or do the CTNNB1 mutations make this activation independent from them (b)?</p><p>We framed the binary question into two competing classes of pathway models: Models that depend on Wnt ligand secretion versus those that do not. The model classes translate into restrictions of the pathway topology space. Since Wnt dependent models are more flexible than Wnt independent models, we need to account for the extra complexity in our comparison of the two models. Bayes factors do so and fairly compare the data evidence for competing models. In our analysis, the Bayes factors depended on the number of potential Wnt signalling target genes included in the models. Stability analysis showed that the data strongly favours Wnt ligand dependent models for all (realistic) numbers of Wnt target genes.</p><p>For this analysis, we performed RNA interference experiments in HCT116 cells where we silenced just four genes: <italic>EVI/WLS</italic>, <italic>APC</italic>, <italic>CTNNB1/&#x003b2;-catenin</italic>, and <italic>TCF7L2</italic>. We monitored changes in target gene expression by RNAseq. Details about the experimental protocols are given in the appendix. This previously unpublished dataset is available at the ArrayExpress database with accession number <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-651/">E-MTAB-651</ext-link>. Supplementary material for full reproducibility of the analysis is available on github at <ext-link ext-link-type="uri" xlink:href="https://github.com/annlia/featureNEM">https://github.com/annlia/featureNEM</ext-link>.</p></sec><sec sec-type="materials|methods" id="sec002"><title>Methods</title><sec id="sec003"><title>Restrictions on the topology of a signalling network can be sustained or rejected using Bayes factors on topology classes</title><p>Let <italic>f</italic> be an arbitrary feature of a topology, we denote by <inline-formula id="pone.0155999.e001"><alternatives><graphic xlink:href="pone.0155999.e001.jpg" id="pone.0155999.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula> the class of all topologies that exhibit feature <italic>f</italic> and by <inline-formula id="pone.0155999.e002"><alternatives><graphic xlink:href="pone.0155999.e002.jpg" id="pone.0155999.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> the complimentary class of topologies that do not have it. Bayes factors [<xref rid="pone.0155999.ref009" ref-type="bibr">9</xref>] are the classical Bayesian tools for model comparison, where we wish to quantify the evidence which the data <bold><italic>D</italic></bold> provides in favour of a model <inline-formula id="pone.0155999.e003"><alternatives><graphic xlink:href="pone.0155999.e003.jpg" id="pone.0155999.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> relative to a different model <inline-formula id="pone.0155999.e004"><alternatives><graphic xlink:href="pone.0155999.e004.jpg" id="pone.0155999.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula>. The Bayes factor <italic>B</italic><sub>10</sub> of model <inline-formula id="pone.0155999.e005"><alternatives><graphic xlink:href="pone.0155999.e005.jpg" id="pone.0155999.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> versus <inline-formula id="pone.0155999.e006"><alternatives><graphic xlink:href="pone.0155999.e006.jpg" id="pone.0155999.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula> is defined as the ratio between the posterior and the prior odds<disp-formula id="pone.0155999.e007"><alternatives><graphic xlink:href="pone.0155999.e007.jpg" id="pone.0155999.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>10</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>&#x02261;</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula>
which is the ratio between the models&#x02019; marginal likelihoods. The Bayes factor provides more protection against over-fitting compared to log-likelihood ratios, since the parameters <italic>&#x003b8;</italic><sub><italic>m</italic></sub> are integrated out rather than maximised
<disp-formula id="pone.0155999.e008"><alternatives><graphic xlink:href="pone.0155999.e008.jpg" id="pone.0155999.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>&#x0222b;</mml:mo><mml:msub><mml:mo>&#x00398;</mml:mo><mml:mi>m</mml:mi></mml:msub></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">M</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="2.em"/><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></disp-formula></p><p>If the models consist of topology classes: a class <inline-formula id="pone.0155999.e009"><alternatives><graphic xlink:href="pone.0155999.e009.jpg" id="pone.0155999.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula> of topologies with the feature <italic>f</italic> and its complement class <inline-formula id="pone.0155999.e010"><alternatives><graphic xlink:href="pone.0155999.e010.jpg" id="pone.0155999.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula>, the Bayes factor is
<disp-formula id="pone.0155999.e011"><alternatives><graphic xlink:href="pone.0155999.e011.jpg" id="pone.0155999.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula></p><p>The models in each class will be sets of NEMs. To evaluate the Bayes factors we therefore need the mathematical treatment of their marginal likelihoods <italic>P</italic>(<bold><italic>D</italic></bold>|<italic>C</italic><sub><italic>f</italic></sub>), which we turn to next.</p></sec><sec id="sec004"><title>Quantifying the evidence for NEM structural features via Bayes factors</title><p>NEMs are probabilistic models for reverse engineering signalling pathways [<xref rid="pone.0155999.ref001" ref-type="bibr">1</xref>]. They represent pathways by directed graphs with distinct nodes for the signalling proteins (S-genes) and for the effected target genes (E-genes) that change expression in response to perturbations of S-genes. A NEM predicts that an E-gene changes expression when blocking the S-gene <italic>S</italic>, if and only if it is connected to <italic>S</italic> or to a descendent of <italic>S</italic>. <xref ref-type="fig" rid="pone.0155999.g001">Fig 1</xref> gives examples for a nested effect model (A) and the expected data pattern it encodes (B).</p><fig id="pone.0155999.g001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0155999.g001</object-id><label>Fig 1</label><caption><title>Nested effect models and structural features.</title><p>An example of a NEM network, its expected observation pattern and structural features. <bold>A</bold> shows a signalling network including S- and E-genes. <bold>B</bold> shows the corresponding expected downstream effects of E-genes that are attached to S-genes (columns), if the S-genes in the rows are blocked. <bold>C</bold> shows classes of topologies that share a specific feature. In this case the distinguishing feature is the existence of an edge that connects the sub-networks formed by (<italic>S</italic><sub>1</sub>, <italic>S</italic><sub>2</sub>, <italic>S</italic><sub>3</sub>) and (<italic>S</italic><sub>4</sub>, <italic>S</italic><sub>5</sub>). The topologies on the right have this feature while those on the left do not.</p></caption><graphic xlink:href="pone.0155999.g001"/></fig><p>In the Bayesian framework of [<xref rid="pone.0155999.ref001" ref-type="bibr">1</xref>] full network topologies are scored by their marginal posterior probability given the data <bold><italic>D</italic></bold>, while integrating out the parameters which describe how E-genes attach to S-genes. Topologies with the same transitive closure cannot be distinguished on the basis of data because they are score equivalent [<xref rid="pone.0155999.ref001" ref-type="bibr">1</xref>]. Let &#x003a6; = (<italic>&#x003d5;</italic><sub><italic>ij</italic></sub>) be the adjacency matrix of a transitively closed network, <italic>&#x003b8;</italic> = (<italic>&#x003b8;</italic><sub><italic>l</italic></sub>) be the attachment parameters, such that <italic>&#x003b8;</italic><sub><italic>l</italic></sub> = <italic>k</italic> if <italic>E</italic><sub><italic>l</italic></sub> is attached to <italic>S</italic><sub><italic>k</italic></sub>, and <bold><italic>D</italic></bold> = (<italic>d</italic><sub><italic>lk</italic></sub>) a data matrix whose elements quantify the effect observed for <italic>E</italic><sub><italic>l</italic></sub> when &#x02018;blocking&#x02019; <italic>S</italic><sub><italic>k</italic></sub>. The network posterior probability is
<disp-formula id="pone.0155999.e012"><alternatives><graphic xlink:href="pone.0155999.e012.jpg" id="pone.0155999.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>&#x003a6;</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:mo>&#x003a6;</mml:mo><mml:mo>)</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mo>&#x003a6;</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula>
The marginal likelihood <italic>P</italic>(<bold><italic>D</italic></bold>|&#x003a6;) is obtained by summing over <italic>&#x003b8;</italic>
<disp-formula id="pone.0155999.e013"><alternatives><graphic xlink:href="pone.0155999.e013.jpg" id="pone.0155999.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:mo>&#x003a6;</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:mo>&#x003a6;</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo>|</mml:mo><mml:mo>&#x003a6;</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives><label>(1)</label></disp-formula>
where <italic>P</italic>(<italic>&#x003b8;</italic>|&#x003a6;) is a prior distribution for <italic>&#x003b8;</italic> and is assumed to be independent of the network structure &#x003a6;, such that it can be written as <italic>P</italic>(<italic>&#x003b8;</italic>).</p><p>Defining <bold><italic>D</italic></bold><sub><italic>l</italic></sub> as the <italic>l</italic>-th row of the data matrix, or in other words the vector of observations corresponding to E-gene <italic>E</italic><sub><italic>l</italic></sub>, the likelihood decomposes as
<disp-formula id="pone.0155999.e014"><alternatives><graphic xlink:href="pone.0155999.e014.jpg" id="pone.0155999.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:mo>&#x003a6;</mml:mo><mml:mo>,</mml:mo><mml:mo>&#x00398;</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>&#x003a6;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1.em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>&#x003a6;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>&#x003a6;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives><label>(2)</label></disp-formula>
Different likelihood models <italic>P</italic>(<italic>d</italic><sub><italic>lk</italic></sub>|&#x003a6;, <italic>&#x003b8;</italic><sub><italic>l</italic></sub>) exist for discrete [<xref rid="pone.0155999.ref001" ref-type="bibr">1</xref>] and continuous data [<xref rid="pone.0155999.ref010" ref-type="bibr">10</xref>]. Expression profiling data is better described as continuous, so we chose a Bayesian version of the continous data likelihood. Expression changes of E-genes were provided as posterior probabilities <italic>p</italic><sub><italic>lk</italic></sub>, where <italic>l</italic> refers to an E-gene and <italic>k</italic> to a perturbation. We used the Bayesian linear modelling implemented in the <monospace>limma</monospace> package [<xref rid="pone.0155999.ref011" ref-type="bibr">11</xref>&#x02013;<xref rid="pone.0155999.ref013" ref-type="bibr">13</xref>] to calculate these posterior probabilities. Finally, network topologies are scored by the marginal likelihood in <xref ref-type="disp-formula" rid="pone.0155999.e013">Eq (1)</xref> where the terms in the likelihood <xref ref-type="disp-formula" rid="pone.0155999.e014">Eq (2)</xref> are defined as
<disp-formula id="pone.0155999.e015"><alternatives><graphic xlink:href="pone.0155999.e015.jpg" id="pone.0155999.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mrow><mml:mspace width="4.pt"/><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mo>&#x003a6;</mml:mo><mml:mspace width="4.pt"/><mml:mtext>predicts</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>an</mml:mtext><mml:mspace width="4.pt"/><mml:mtext>effect</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:math></alternatives></disp-formula></p><p>
<xref ref-type="fig" rid="pone.0155999.g001">Fig 1</xref> shows an example of two classes of topologies <inline-formula id="pone.0155999.e016"><alternatives><graphic xlink:href="pone.0155999.e016.jpg" id="pone.0155999.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0155999.e017"><alternatives><graphic xlink:href="pone.0155999.e017.jpg" id="pone.0155999.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> that are distinguished by a feature <italic>f</italic>. Let N be the total number of admitted topologies on the set of S-genes and <italic>N</italic><sub><italic>f</italic></sub> and <inline-formula id="pone.0155999.e018"><alternatives><graphic xlink:href="pone.0155999.e018.jpg" id="pone.0155999.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:msub><mml:mi>N</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> the numbers of topologies in <inline-formula id="pone.0155999.e019"><alternatives><graphic xlink:href="pone.0155999.e019.jpg" id="pone.0155999.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0155999.e020"><alternatives><graphic xlink:href="pone.0155999.e020.jpg" id="pone.0155999.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> respectively. The Bayes factor for class <inline-formula id="pone.0155999.e021"><alternatives><graphic xlink:href="pone.0155999.e021.jpg" id="pone.0155999.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula> versus <inline-formula id="pone.0155999.e022"><alternatives><graphic xlink:href="pone.0155999.e022.jpg" id="pone.0155999.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> can be written as
<disp-formula id="pone.0155999.e023"><alternatives><graphic xlink:href="pone.0155999.e023.jpg" id="pone.0155999.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives><label>(3)</label></disp-formula>
Given the topology &#x003a6;<sub><italic>n</italic></sub> the marginal likelihood of the data <bold><italic>D</italic></bold> is independent of the class <italic>C</italic><sub><italic>m</italic></sub> to which the topology belongs
<disp-formula id="pone.0155999.e024"><alternatives><graphic xlink:href="pone.0155999.e024.jpg" id="pone.0155999.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02261;</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
for all <italic>n</italic> &#x02208; {1, &#x02026;, <italic>N</italic>} and for <inline-formula id="pone.0155999.e025"><alternatives><graphic xlink:href="pone.0155999.e025.jpg" id="pone.0155999.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>. The prior distribution <inline-formula id="pone.0155999.e026"><alternatives><graphic xlink:href="pone.0155999.e026.jpg" id="pone.0155999.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of the network topologies is assumed to be uniform within each class
<disp-formula id="pone.0155999.e027"><alternatives><graphic xlink:href="pone.0155999.e027.jpg" id="pone.0155999.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mfrac><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></disp-formula>
for <inline-formula id="pone.0155999.e028"><alternatives><graphic xlink:href="pone.0155999.e028.jpg" id="pone.0155999.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, with <italic>I</italic> the indicator function. The Bayes Factor then reduces to
<disp-formula id="pone.0155999.e029"><alternatives><graphic xlink:href="pone.0155999.e029.jpg" id="pone.0155999.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub></mml:mrow></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003a6;</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives><label>(4)</label></disp-formula>
where we can see that the class <inline-formula id="pone.0155999.e030"><alternatives><graphic xlink:href="pone.0155999.e030.jpg" id="pone.0155999.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is penalised by the ratio <inline-formula id="pone.0155999.e031"><alternatives><graphic xlink:href="pone.0155999.e031.jpg" id="pone.0155999.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> if it allows for more topologies than <inline-formula id="pone.0155999.e032"><alternatives><graphic xlink:href="pone.0155999.e032.jpg" id="pone.0155999.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula>.</p><p>Which of the two classes <inline-formula id="pone.0155999.e033"><alternatives><graphic xlink:href="pone.0155999.e033.jpg" id="pone.0155999.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0155999.e034"><alternatives><graphic xlink:href="pone.0155999.e034.jpg" id="pone.0155999.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> describes the data better? If <inline-formula id="pone.0155999.e035"><alternatives><graphic xlink:href="pone.0155999.e035.jpg" id="pone.0155999.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is larger then <inline-formula id="pone.0155999.e036"><alternatives><graphic xlink:href="pone.0155999.e036.jpg" id="pone.0155999.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:msub></mml:math></alternatives></inline-formula> does the data support this extra complexity of the class? The Bayes factor helps to answer exactly these questions. If the Bayes factor exceeds 1, the evidence favours including feature <italic>f</italic> in the working model of a pathway, otherwise <italic>f</italic> should not be part the model. More refined inference comes from including prior beliefs on the two model classes and considering the ratio of posterior probabilities.</p></sec></sec><sec sec-type="results" id="sec005"><title>Results</title><sec id="sec006"><title>Perturbations of Wnt signalling in colon cancer HCT116 cells</title><p>We here describe a case study of a focused pathway analysis based on NEMs. To this end, we investigate canonical Wnt signalling in colon cancer HCT116 cells. These cells carry a heterozygous one amino acid (<italic>&#x003b4;</italic>SERer45 [<xref rid="pone.0155999.ref014" ref-type="bibr">14</xref>, <xref rid="pone.0155999.ref015" ref-type="bibr">15</xref>]) deletion in the <italic>&#x003b2;</italic>-catenin protein [<xref rid="pone.0155999.ref016" ref-type="bibr">16</xref>] which has been associated with constitutively active canonical Wnt signalling [<xref rid="pone.0155999.ref015" ref-type="bibr">15</xref>]. Recently, it was proposed that independent of constantly active mutation of <italic>&#x003b2;</italic>-catenin upstream components (like Evi/Wls), Lrp5/6 and Dvls regulate the canonical Wnt pathway [<xref rid="pone.0155999.ref017" ref-type="bibr">17</xref>].</p><p>We depleted signalling molecules at different levels of the Wnt pathway using RNA interference (RNAi). Specifically, we silenced EVI/WLS, APC, CTNNB1/<italic>&#x003b2;</italic>-catenin, and TCF7L2 by RNAi. Changes in the expression of Wnt target genes were monitored using RNAseq. In addition HCT116 cells were treated with a non-targeting siRNA as a control. All experiments were replicated twice, with the exception of TCF7L2, for which only one biological replicate was available. In addition, two samples of HCT116 cells were treated with a nonsense siRNA and profiled as control. Silencing efficiency of the genes was confirmed by qPCR (data not shown) and showed efficiencies above 80% (<xref ref-type="fig" rid="pone.0155999.g002">Fig 2A</xref>). On average 37 million sequence reads were generated per knock-down. Reproducibility of the log-cpm value between the two replicates of the same experiment is shown in <xref ref-type="fig" rid="pone.0155999.g002">Fig 2B</xref> for the EVI/WLS knock-down. Reproducibility of log-cpm values translates into reproducibility of log fold changes of cpm values, when comparing perturbations to controls (<xref ref-type="fig" rid="pone.0155999.g002">Fig 2C</xref>). Similar reproducibility could also be observed for the other experiments. The fold changes also matched the qPCR knock-down results. For example, RNAi depletion of CTNNB1/<italic>&#x003b2;</italic>-catenin led to a log fold change of the CTNNB1/<italic>&#x003b2;</italic>-catenin gene of -3.98, and a log fold change of -3.71 in the Wnt target gene AXIN2, whereas non-related genes such as ACTB were not affected (<xref ref-type="supplementary-material" rid="pone.0155999.s003">S1 Fig</xref>). The RNAseq data also confirmed the presence of the mutated CTNNB1/<italic>&#x003b2;</italic>-catenin allele, which expressed at higher levels than the wild-type allele (<xref ref-type="supplementary-material" rid="pone.0155999.s003">S1 Fig</xref>). Indeed, we could not detect any phosphorylation of S45 which is deleted in the mutated allele, suggesting that in HCT116 mutated CTNNB1/<italic>&#x003b2;</italic>-catenin is more abundant than in the wild-type.</p><fig id="pone.0155999.g002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0155999.g002</object-id><label>Fig 2</label><caption><title>Experiments&#x02019; efficiency and reproducibility.</title><p>Panel <bold>A</bold> reports the relative expression of the direct siRNA targets with respect to the control in the corresponding experiment. log-cpm measured in the two replicates of the EVI silencing experiment are shown in panel <bold>B</bold>. Panel <bold>C</bold> shows the log fold changes between the cpm measured in two pairs of experiment, namely EVI silencing and CTRL.</p></caption><graphic xlink:href="pone.0155999.g002"/></fig><p>We preprocessed the count data using the <monospace>voom</monospace> function of the <monospace>limma</monospace> package [<xref rid="pone.0155999.ref013" ref-type="bibr">13</xref>] and calculated fitted Bayesian linear models to the data using the <monospace>limma</monospace> package [<xref rid="pone.0155999.ref011" ref-type="bibr">11</xref>]. From these models we calculated the posterior probability that the expression of a gene is affected by the knock-down again using <monospace>limma</monospace>. For the direct targets of the siRNAs the posterior probabilities of change were all estimated as effectively 1. A probability of nearly 1 was also obtained for <italic>AXIN2</italic> under depletion of <italic>CTNNB1/&#x003b2;-catenin</italic>, while a probability well below.01 was estimated for the non Wnt target <italic>ACTB</italic> under the same intervention. Fold changes and corresponding posterior probabilities for a number of well known Wnt targets are shown in <xref ref-type="fig" rid="pone.0155999.g003">Fig 3</xref>.</p><fig id="pone.0155999.g003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0155999.g003</object-id><label>Fig 3</label><caption><title>Expression of Wnt target genes.</title><p>Comparison of gene expression profiles after siRNA mediated knock-down of Wnt pathway components show high similarity between <italic>EVI/WLS</italic> and downstream positive pathway regulators. The top panel shows the posterior probability of differential expression in the experiments, with the dashed line marking probability.5. There is strong evidence for differential expression of the canonical target gene AXIN2 when silencing <italic>CTNNB1/&#x003b2;-catenin</italic>, <italic>EVI/WLS</italic> and <italic>APC</italic>. RUNX2 and SMAD7 show a similar pattern of opposite regulation after knock-down of <italic>APC</italic> and <italic>CTNNB1/&#x003b2;-catenin</italic>, but while for SMAD7 the posterior probability of differential expression are still above a half for the <italic>EVI/WLS</italic> and <italic>APC</italic> knock-down, the probabilities for RUNX2 are below, which translates into reduced evidence for reproducibility of the fold changes.</p></caption><graphic xlink:href="pone.0155999.g003"/></fig><p>Transcriptome wide downstream effects are outlined in <xref ref-type="fig" rid="pone.0155999.g004">Fig 4</xref> which shows a heat map of posterior probabilities for all four knock-downs and 2978 genes. Red corresponds to high probabilities of expression change and blue to virtually zero probability. All 2978 genes showed a high probability in at least one condition. The genes to the left of the green line reacted to both <italic>CTNNB1/&#x003b2;-catenin</italic> and <italic>EVI/WLS</italic> knock-downs. If we considered them all as bona fide Wnt target genes, the heat map would already give compelling evidence that the activation of Wnt target genes in fact depends on Evi/Wls and thus on Wnts secretion. Interestingly, most of these genes also responded to blocking TCF7L2 but only few of them to APC. To the right of the green line are some genes that are blue in the <italic>EVI/WLS</italic> row but red in the <italic>CTNNB1/&#x003b2;-catenin</italic> row. They respond to <italic>CTNNB1/&#x003b2;-catenin</italic> but not <italic>EVI/WLS</italic>. Nevertheless, they are a small minority.</p><fig id="pone.0155999.g004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0155999.g004</object-id><label>Fig 4</label><caption><title>Posterior probabilities of differential expression.</title><p>Heat-map of the posterior probabilities of differential expression in the silencing experiments. Only genes which have a posterior probability larger than .5 in at least one of the knock-down experiments are shown. The green line leaves about 750 genes on its left. The pattern there shows that the majority of those genes respond not only to intervention on <italic>CTNNB1/&#x003b2;-catenin</italic>, but also to <italic>EVI/WLS</italic>.</p></caption><graphic xlink:href="pone.0155999.g004"/></fig></sec><sec id="sec007"><title>A focused analysis of Wnt signalling in HCT116 cells using Bayes factors</title><p>We now examine the descriptive arguments of the previous section with sound statistical inference. Our leading question is: Does the activation of Wnt target genes in HCT116 cells depend on the secretion of Wnt ligands (a) or do the CTNNB1 mutations make this activation independent from them (b)? And to answer this question we rely on perturbation data for four proteins <italic>EVI/WLS</italic>, <italic>APC</italic>, <italic>CTNNB1/&#x003b2;-catenin</italic>, and <italic>TCF7L2</italic>. The mutated gene CTNNB1 encodes for <italic>CTNNB1/&#x003b2;-catenin</italic>. Hence, the first two proteins (<italic>EVI/WLS</italic>, <italic>APC</italic>) operate upstream of the mutated protein, the third protein is mutated, and the last protein (<italic>TCF7L2</italic>) operates downstream of the mutated protein. All four proteins together constitute only a tiny fragment of the Wnt pathway.</p><p>We represented the two competing models (a) and (b) by classes of topologies. For the Wnt independent topologies (b) we requested that there are no edges connecting (<italic>EVI/WLS</italic> and <italic>APC</italic>) with (<italic>CTNNB1/&#x003b2;-catenin</italic> and <italic>TCF7L2</italic>). In contrast, for the Wnt dependent topologies (a) we requested that there must be at least one edge between the two groups of proteins. There were more topologies in the Wnt dependent class making the dependent model more complex and more flexible. A Wnt dependent topology fitted the data best. But was this simply because there are more of them, or did the data justify this additional model complexity? We had translated our initial biological question into a statistical model comparison problem. We chose Bayes factors to address it. The computational implications were already addressed in the method section.</p><p>A practical difficulty emerged when it came to naming all Wnt target genes. In our model they played the role of E-genes. Some canonical Wnt target genes, like AXIN2, SMAD7 and MYC, are well established; but there is no consensus on a complete list of Wnt targets. Most likely, the Wnt pathway regulates different target genes in different cellular systems. We decided to use our own RNAseq data to screen for potential Wnt targets in HCT116 cells. To this end, we ranked all genes by the maximum posterior probability across the four perturbations. For a cut-off <italic>&#x003bb;</italic> we included all genes with a score above <italic>&#x003bb;</italic>. This reduced the E-gene selection problem to a parameter calibration problem. Recalling <xref ref-type="disp-formula" rid="pone.0155999.e014">Eq (2)</xref> we saw that determining the number of E-genes was crucial because this number drives the right hand product of conditional probabilities. So, how many Wnt target genes are there in HCT116 cells? The Nusse lab currently names 30 genes as Wnt targets in human colon cancer on their <italic>The Wnt Homepage</italic> resource <ext-link ext-link-type="uri" xlink:href="http://web.stanford.edu/group/nusselab/cgi-bin/wnt/target_genes">http://web.stanford.edu/group/nusselab/cgi-bin/wnt/target_genes</ext-link>. All of them are backed up by publications. This list does not claim to be complete. In a more data driven approach we relied on our posterior probabilities and cut the list at a threshold of 95%. This gave us 1483 potential target genes with high support from data. In fact, determining the correct number of Wnt target genes in HCT116 cells might be a very hard problem, and not even well defined. Fortunately, stability analysis showed that we do not need an exact solution.</p><p>We run the Bayes factor analysis for the full range of cut-offs between 0 and 1. <xref ref-type="fig" rid="pone.0155999.g005">Fig 5B</xref> plots the log Bayes factor against the number of E-genes used to calculate it. In the context of our initial question: Does the activation of Wnt target genes in HCT116 cells still depend on the secretion of Wnt ligands (a) or do the CTNNB1 mutations make this activation independent from them (b)? Positive log Bayes factors are evidence in favor of (a) while negative values support (b). We considered values above 10 or below -10 as strong evidence as they correspond to odds ratios exceeding 1:1000. If we used the 1483 E-genes corresponding to a 95% posterior probability cut-off we reached log Bayes factors much higher than 10 (dashed yellow line). If we used only the top 200 or the top 30 genes the evidence in favour of a Wnt secretion dependent model was even stronger. In fact, any model based on less then 2200 potential target genes endorsed Wnt secretion dependence (dashed purple line). This number greatly exceeds any number of direct Wnt target genes reported so far. With even lower cut-offs, we believe that noise dominated the models. In summary, although we do not know how many Wnt target genes there are in HCT116 cells, we could confidently answer our leading question. Our answer is (a): The activation of Wnt target genes in HCT116 cells depends on the secretion of Wnt ligands. All models with a realistic number of E-genes consistently answered (a).</p><fig id="pone.0155999.g005" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0155999.g005</object-id><label>Fig 5</label><caption><title>Model comparison for network structural features.</title><p>Panel <bold>A</bold> is a schematic representation of the two topology classes compared. Panel <bold>B</bold> summarizes the main result of our statistical case study. Log Bayes Factors were obtained from NEMs including different numbers of potential target genes (x-axis, top), which are included according to a cut-off on the posterior probability that a gene is affected for at least one perturbation. Positive log Bayes factor reflect evidence in favour of a Wnt secretion dependent model. The dashed purple line indicates the smallest cut-off that still favours this topology class. A cut-off of 95% posterior probability is marked by the yellow dashed line.</p></caption><graphic xlink:href="pone.0155999.g005"/></fig><p>Code and data for reproducing the plot of <xref ref-type="fig" rid="pone.0155999.g005">Fig 5B</xref> are provided as supplementary material.</p></sec></sec><sec sec-type="conclusions" id="sec008"><title>Discussion</title><p>In the context of a statistical case study we illustrated here how NEM modelling can be combined with model comparison and stability analysis to analyse complex pathways with limited data. We developed the computational implications of Bayes factor analysis in the context of NEM modelling with restricted topology classes. In the case study we were confronted with the statistical question on whether a perturbation data set justified the refinement of an existing simpler pathway model. By allowing for additional edges the pathway model became more complex, and naturally fitted data better. The Bayes factors penalized the additional model complexity but nevertheless strongly endorsed the more complex model. A complication emerged when we had to decide which and how many genes to include in the analysis. We overcame the problem by stability analysis. No matter how many genes we included, model comparison gave the same answer: The more complex model is appropriate.</p><p>We believe that strategies similar to that used in the case study can greatly improve the scope of problems in which NEM modelling can be applied. First, it is common that pathway features rather then complete pathways are under study. Second, it is also common that perturbation data is limited and does not cover all components of a pathway. Third, models of full pathways involve many parameters that need to be jointly estimated from data requiring very high numbers of repeated experiments to control the variance of the estimators. The variance of a single estimated binary parameter is easier to control. To do so, Bayesian model comparison is our method of choice. It can be used to focus analysis on a defined aspect of a pathway, it does not require data covering the full pathway, and, as shown in our case study, it provides strong collective evidence by joining individual evidence from many target genes even with small data sets.</p><p>To date, model comparison is not the standard approach to network analysis in biology. Most algorithms bank on a maximum likelihood approach, or on heuristic scoring systems. Maximum likelihood is prone to over-fitting. There is an eminent danger of deriving pathway models that are too complex. In the context of Gaussian graphical models this has been addressed for example by likelihood penalisation [<xref rid="pone.0155999.ref018" ref-type="bibr">18</xref>], or shrinkage [<xref rid="pone.0155999.ref019" ref-type="bibr">19</xref>]. For NEM no such approach existed to date. Bayes factors address the over-fitting problem. <xref ref-type="disp-formula" rid="pone.0155999.e029">Eq (4)</xref> highlights the intrinsic penalty for larger topology classes.</p><p>In our understanding, all current working models of signalling pathways are abstractions that cannot live up to the true complexity of cellular processes. There is always data that cannot be explained by them. Pathway models focus on the dominant mechanisms of a pathway, those that are indispensable to understand it. If new data emerges that is in contradiction to an established pathway model, there is the inevitable question whether the new data provides sufficient evidence justifying a refinement of the pathway model. Especially, because every refinement comes with increasing complexity, that makes a pathway more difficult to understand. Model comparison addresses exactly this problem.</p><p>In our case study on the Wnt pathway we could sustain the proposition that the activation of Wnt target genes in colon cancer cells depends on Wnts secretion, at least for HCT116 cells. This result has been previously reported and endorsed by a series of biochemical experiments [<xref rid="pone.0155999.ref017" ref-type="bibr">17</xref>]. Our modelling adds a new aspect to the previous work. We analyse Wnt signalling controlled gene regulation on a transcriptome wide level. Surprisingly, we observed more than a thousand genes that changed expression to knock-downs of Wnt signalling components at a 95% posterior probability level. This included both activated and repressed genes suggesting that the Wnt pathway directly or indirectly affects many cellular processes, maybe even more than known today.</p><p>A limitation of the analysis in our study is that conclusions can only be drawn for the investigated HCT116 cells lines and not for colon cancer in general. We cannot exclude effects from the culturing or that there are colon cancers where the Wnt pathway operate in a Wnt secretion independent mode. To further uncover the important mechanisms in the Wnt pathway and colon tumour development, a comparative study of a diverse set of tumorous, as well as non-tumorous, colon primary cells would therefore be highly valuable. From such data, one could then refine the pathway inference and draw more generalised conclusions again utilising the general framework of network model comparison developed in this manuscript.</p></sec><sec sec-type="supplementary-material" id="sec009"><title>Supporting Information</title><supplementary-material content-type="local-data" id="pone.0155999.s001"><label>S1 Code</label><caption><title>Reproducible analysis.</title><p>For the sake of allowing full reproducibility the complete code for the analysis presented in the manuscript is available on github at <ext-link ext-link-type="uri" xlink:href="https://github.com/annlia/featureNEM">https://github.com/annlia/featureNEM</ext-link>.</p><p>(PDF)</p></caption><media xlink:href="pone.0155999.s001.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0155999.s002"><label>S1 Protocols</label><caption><title>Protocols.</title><p>Details about the experimental protocols are given in the supplementary material.</p><p>(PDF)</p></caption><media xlink:href="pone.0155999.s002.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0155999.s003"><label>S1 Fig</label><caption><title>Sequence reads.</title><p>Examples about the distribution of the sequence reads, with a quantification of the expression of both <italic>&#x003b2;</italic>-catenin alleles (mutated and wild-type) in HCT116 cells are reported in the supplementary material.</p><p>(PDF)</p></caption><media xlink:href="pone.0155999.s003.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0155999.s004"><label>S2 Fig</label><caption><title>Phosphorylation.</title><p>Results from Western blot analysis are reported in the supplementary material.</p><p>(PDF)</p></caption><media xlink:href="pone.0155999.s004.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0155999.s005"><label>S1 Alternative Analysis</label><caption><title>No-CONAN analysis.</title><p>Details about the No-CONAN approach.</p><p>(PDF)</p></caption><media xlink:href="pone.0155999.s005.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ack><p><bold>Funding:</bold> Work in the group of R.S. was supported by the NGFN-Project FKZ01GS08183&#x02014;Verbund Kolonkarzinom and the BioSysNet-Project&#x02014;Bavarian Research Network for Molecular Biosystems. Work in the laboratory of M.B. was supported by grants from the BMBF (NGFN-plus 01GS08181-6) and BMBF GERF.</p></ack><ref-list><title>References</title><ref id="pone.0155999.ref001"><label>1</label><mixed-citation publication-type="journal">
<name><surname>Markowetz</surname><given-names>F</given-names></name>, <name><surname>Bloch</surname><given-names>J</given-names></name>, <name><surname>Spang</surname><given-names>R</given-names></name>. <article-title>Non-transcriptional pathway features reconstructed from secondary effects of RNA interference</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>(<issue>21</issue>):<fpage>4026</fpage>&#x02013;<lpage>4032</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bti662">10.1093/bioinformatics/bti662</ext-link></comment>
<?supplied-pmid 16159925?><pub-id pub-id-type="pmid">16159925</pub-id></mixed-citation></ref><ref id="pone.0155999.ref002"><label>2</label><mixed-citation publication-type="journal">
<name><surname>Markowetz</surname><given-names>F</given-names></name>, <name><surname>Kostka</surname><given-names>D</given-names></name>, <name><surname>Troyanskaya</surname><given-names>OG</given-names></name>, <name><surname>Spang</surname><given-names>R</given-names></name>. <article-title>Nested effects models for high-dimensional phenotyping screens</article-title>. <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>(<issue>13</issue>):<fpage>i305</fpage>&#x02013;<lpage>i312</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btm178">10.1093/bioinformatics/btm178</ext-link></comment>
<?supplied-pmid 17646311?><pub-id pub-id-type="pmid">17646311</pub-id></mixed-citation></ref><ref id="pone.0155999.ref003"><label>3</label><mixed-citation publication-type="journal">
<name><surname>Anchang</surname><given-names>B</given-names></name>, <name><surname>Sadeh</surname><given-names>MJ</given-names></name>, <name><surname>Jacob</surname><given-names>J</given-names></name>, <name><surname>Tresch</surname><given-names>A</given-names></name>, <name><surname>Vlad</surname><given-names>MO</given-names></name>, <name><surname>Oefner</surname><given-names>PJ</given-names></name>, <etal>et al</etal>
<article-title>Modeling the temporal interplay of molecular signaling and gene expression by using dynamic nested effects models</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2009</year>;<volume>106</volume>(<issue>16</issue>):<fpage>6447</fpage>&#x02013;<lpage>6452</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0809822106">10.1073/pnas.0809822106</ext-link></comment></mixed-citation></ref><ref id="pone.0155999.ref004"><label>4</label><mixed-citation publication-type="journal">
<name><surname>Pirkl</surname><given-names>M</given-names></name>, <name><surname>Hand</surname><given-names>E</given-names></name>, <name><surname>Kube</surname><given-names>D</given-names></name>, <name><surname>Spang</surname><given-names>R</given-names></name>. <article-title>Analyzing synergistic and non-synergistic interactions in signalling pathways using Boolean Nested Effect Models</article-title>. <source>Bioinformatics</source>. <year>2015</year>; p. <fpage>btv680</fpage>.</mixed-citation></ref><ref id="pone.0155999.ref005"><label>5</label><mixed-citation publication-type="journal">
<name><surname>Niederberger</surname><given-names>T</given-names></name>, <name><surname>Etzold</surname><given-names>S</given-names></name>, <name><surname>Lidschreiber</surname><given-names>M</given-names></name>, <name><surname>Maier</surname><given-names>KC</given-names></name>, <name><surname>Martin</surname><given-names>DE</given-names></name>, <name><surname>Fr&#x000f6;hlich</surname><given-names>H</given-names></name>, <etal>et al</etal>
<article-title>MC EMiNEM Maps the Interaction Landscape of the Mediator</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>6</issue>):<fpage>e1002568</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002568">10.1371/journal.pcbi.1002568</ext-link></comment>
<?supplied-pmid 22737066?><pub-id pub-id-type="pmid">22737066</pub-id></mixed-citation></ref><ref id="pone.0155999.ref006"><label>6</label><mixed-citation publication-type="journal">
<name><surname>Siebourg-Polster</surname><given-names>J</given-names></name>, <name><surname>Mudrak</surname><given-names>D</given-names></name>, <name><surname>Emmenlauer</surname><given-names>M</given-names></name>, <name><surname>R&#x000e4;m&#x000f6;</surname><given-names>P</given-names></name>, <name><surname>Dehio</surname><given-names>C</given-names></name>, <name><surname>Greber</surname><given-names>U</given-names></name>, <etal>et al</etal>
<article-title>NEMix: Single-cell nested effects models for probabilistic pathway stimulation</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>1</volume>(<issue>2</issue>):<fpage>e1004078</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004078">10.1371/journal.pcbi.1004078</ext-link></comment><pub-id pub-id-type="pmid">25879530</pub-id></mixed-citation></ref><ref id="pone.0155999.ref007"><label>7</label><mixed-citation publication-type="journal">
<name><surname>Mac Neil</surname><given-names>L</given-names></name>, <name><surname>Pons</surname><given-names>C</given-names></name>, <name><surname>Arda</surname><given-names>EH</given-names></name>, <name><surname>Giese</surname><given-names>GE</given-names></name>, <name><surname>Myers</surname><given-names>CL</given-names></name>, <name><surname>Walhout</surname><given-names>A</given-names></name>. <article-title>Transcription Factor Activity Mapping of a Tissue-Specific In Vivo Gene Regulatory Network</article-title>. <source>Cell Systemsl</source>. <year>2015</year>;<volume>11</volume>(<issue>4</issue>):<fpage>152</fpage>&#x02013;<lpage>162</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cels.2015.08.003">10.1016/j.cels.2015.08.003</ext-link></comment></mixed-citation></ref><ref id="pone.0155999.ref008"><label>8</label><mixed-citation publication-type="journal">
<name><surname>Muzny</surname><given-names>DM</given-names></name>, <name><surname>Bainbridge</surname><given-names>MN</given-names></name>, <name><surname>Chang</surname><given-names>K</given-names></name>, <name><surname>Dinh</surname><given-names>HH</given-names></name>, <name><surname>Drummond</surname><given-names>JA</given-names></name>, <name><surname>Fowler</surname><given-names>G</given-names></name>, <etal>et al</etal>
<article-title>Comprehensive molecular characterization of human colon and rectal cancer</article-title>. <source>Nature</source>. <year>2012</year>;<volume>487</volume>:<fpage>330</fpage>&#x02013;<lpage>337</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11252">10.1038/nature11252</ext-link></comment><pub-id pub-id-type="pmid">22810696</pub-id></mixed-citation></ref><ref id="pone.0155999.ref009"><label>9</label><mixed-citation publication-type="journal">
<name><surname>Kass</surname><given-names>RE</given-names></name>, <name><surname>Raftery</surname><given-names>AE</given-names></name>. <article-title>Bayes Factors</article-title>. <source>Journal of the American Statistical Association</source>. <year>1995</year>;<volume>90</volume>(<issue>430</issue>):<fpage>773</fpage>&#x02013;<lpage>795</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.1995.10476572">10.1080/01621459.1995.10476572</ext-link></comment></mixed-citation></ref><ref id="pone.0155999.ref010"><label>10</label><mixed-citation publication-type="journal">
<name><surname>Fr&#x000f6;hlich</surname><given-names>H</given-names></name>, <name><surname>Fellmann</surname><given-names>M</given-names></name>, <name><surname>S&#x000fc;ltmann</surname><given-names>H</given-names></name>, <name><surname>Poustka</surname><given-names>A</given-names></name>, <name><surname>Beissbarth</surname><given-names>T</given-names></name>. <article-title>Estimating large-scale signaling networks through nested effect models with intervention effects from microarray data</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>22</issue>):<fpage>2650</fpage>&#x02013;<lpage>2656</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btm634">10.1093/bioinformatics/btm634</ext-link></comment>
<?supplied-pmid 18227117?><pub-id pub-id-type="pmid">18227117</pub-id></mixed-citation></ref><ref id="pone.0155999.ref011"><label>11</label><mixed-citation publication-type="book">
<name><surname>Smyth</surname><given-names>GK</given-names></name>. <chapter-title>Limma: linear models for microarray data</chapter-title> In: <name><surname>Gentleman</surname><given-names>R</given-names></name>, <name><surname>Carey</surname><given-names>V</given-names></name>, <name><surname>Dudoit</surname><given-names>S</given-names></name>, <name><surname>Irizarry</surname><given-names>R</given-names></name>, <name><surname>Huber</surname><given-names>W</given-names></name>, editors. <source>Bioinformatics and Computational Biology Solutions Using R and Bioconductor</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>2005</year> p. <fpage>397</fpage>&#x02013;<lpage>420</lpage>.</mixed-citation></ref><ref id="pone.0155999.ref012"><label>12</label><mixed-citation publication-type="journal">
<name><surname>Smyth</surname><given-names>GK</given-names></name>. <article-title>Linear models and empirical Bayes methods for assessing differential expression in microarray experiments</article-title>. <source>Statistical Applications in Genetics and Molecular Biology</source>. <year>2004</year>;<volume>3</volume>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2202/1544-6115.1027">10.2202/1544-6115.1027</ext-link></comment>
<?supplied-pmid 16646809?><pub-id pub-id-type="pmid">16646809</pub-id></mixed-citation></ref><ref id="pone.0155999.ref013"><label>13</label><mixed-citation publication-type="journal">
<name><surname>Law</surname><given-names>CW</given-names></name>, <name><surname>Chen</surname><given-names>Y</given-names></name>, <name><surname>Shi</surname><given-names>W</given-names></name>, <name><surname>Smyth</surname><given-names>GK</given-names></name>. <article-title>voom: precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>. <source>Genome Biology</source>. <year>2014</year>;<volume>15</volume>:<fpage>R29</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2014-15-2-r29">10.1186/gb-2014-15-2-r29</ext-link></comment>
<?supplied-pmid 24485249?><pub-id pub-id-type="pmid">24485249</pub-id></mixed-citation></ref><ref id="pone.0155999.ref014"><label>14</label><mixed-citation publication-type="journal">
<name><surname>Ilyas</surname><given-names>M</given-names></name>, <name><surname>Tomlinson</surname><given-names>I</given-names></name>, <name><surname>Rowan</surname><given-names>A</given-names></name>, <name><surname>Pignatelli</surname><given-names>M</given-names></name>, <name><surname>Bodmer</surname><given-names>W</given-names></name>. <article-title><italic>&#x003b2;</italic>-Catenin mutations in cell lines established from human colorectal cancers</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1997</year>;<volume>94</volume>(<issue>19</issue>):<fpage>10330</fpage>&#x02013;<lpage>10334</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.94.19.10330">10.1073/pnas.94.19.10330</ext-link></comment></mixed-citation></ref><ref id="pone.0155999.ref015"><label>15</label><mixed-citation publication-type="journal">
<name><surname>Morin</surname><given-names>PJ</given-names></name>, <name><surname>Sparks</surname><given-names>AB</given-names></name>, <name><surname>Korinek</surname><given-names>V</given-names></name>, <name><surname>Barker</surname><given-names>N</given-names></name>, <name><surname>Clevers</surname><given-names>H</given-names></name>, <name><surname>Vogelstein</surname><given-names>B</given-names></name>, <etal>et al</etal>
<article-title>Activation of <italic>&#x003b2;</italic>-catenin-Tcf signaling in colon cancer by mutations in <italic>&#x003b2;</italic>-catenin or APC</article-title>. <source>Science</source>. <year>1997</year>;<volume>275</volume>(<issue>5307</issue>):<fpage>1787</fpage>&#x02013;<lpage>1790</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.275.5307.1787">10.1126/science.275.5307.1787</ext-link></comment>
<?supplied-pmid 9065402?><pub-id pub-id-type="pmid">9065402</pub-id></mixed-citation></ref><ref id="pone.0155999.ref016"><label>16</label><mixed-citation publication-type="journal">
<name><surname>Sekine</surname><given-names>S</given-names></name>, <name><surname>Shibata</surname><given-names>T</given-names></name>, <name><surname>Sakamoto</surname><given-names>M</given-names></name>, <name><surname>Hirohashi</surname><given-names>S</given-names></name>. <article-title>Target disruption of the mutant beta-catenin gene in colon cancer cell line HCT116: preservation of its malignant phenotype</article-title>. <source>Oncogene</source>. <year>2002</year>;<volume>21</volume>(<issue>38</issue>):<fpage>5906</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/sj.onc.1205756">10.1038/sj.onc.1205756</ext-link></comment>
<?supplied-pmid 12185590?><pub-id pub-id-type="pmid">12185590</pub-id></mixed-citation></ref><ref id="pone.0155999.ref017"><label>17</label><mixed-citation publication-type="journal">
<name><surname>Voloshanenko</surname><given-names>O</given-names></name>, <name><surname>Erdmann</surname><given-names>G</given-names></name>, <name><surname>Dubash</surname><given-names>TD</given-names></name>, <name><surname>Augustin</surname><given-names>I</given-names></name>, <name><surname>Metzig</surname><given-names>M</given-names></name>, <name><surname>Moffa</surname><given-names>G</given-names></name>, <etal>et al</etal>
<article-title>Wnt secretion is required to maintain high levels of Wnt activity in colon cancer cells</article-title>. <source>Nature communications</source>. <year>2013</year>;<volume>4</volume>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms3610">10.1038/ncomms3610</ext-link></comment>
<?supplied-pmid 24162018?><pub-id pub-id-type="pmid">24162018</pub-id></mixed-citation></ref><ref id="pone.0155999.ref018"><label>18</label><mixed-citation publication-type="journal">
<name><surname>Meinshausen</surname><given-names>N</given-names></name>, <name><surname>B&#x000fc;hlmann</surname><given-names>P</given-names></name>. <article-title>High-dimensional graphs and variable selection with the lasso</article-title>. <source>The annals of statistics</source>. <year>2006</year>; p. <fpage>1436</fpage>&#x02013;<lpage>1462</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/009053606000000281">10.1214/009053606000000281</ext-link></comment></mixed-citation></ref><ref id="pone.0155999.ref019"><label>19</label><mixed-citation publication-type="journal">
<name><surname>Sch&#x000e4;fer</surname><given-names>J</given-names></name>, <name><surname>Strimmer</surname><given-names>K</given-names></name>. <article-title>A shrinkage approach to large-scale covariance matrix estimation and implications for functional genomics</article-title>. <source>Statistical applications in genetics and molecular biology</source>. <year>2005</year>;<volume>4</volume>(<issue>1</issue>). <?supplied-pmid 16646851?><pub-id pub-id-type="pmid">16646851</pub-id></mixed-citation></ref></ref-list></back></article>