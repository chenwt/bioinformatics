<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v3.0 20080202//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName journalpublishing3.dtd?><?SourceDTD.Version 3.0?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">3696101</article-id><article-id pub-id-type="publisher-id">PONE-D-13-05946</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0067885</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>HLA Haplotyping from RNA-seq Data Using Hierarchical Read Weighting</article-title><alt-title alt-title-type="running-head">HLA Haplotyping with HLAforest</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Kim</surname><given-names>Hyunsung John</given-names></name><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="aff" rid="aff1"/></contrib><contrib contrib-type="author"><name><surname>Pourmand</surname><given-names>Nader</given-names></name><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="aff" rid="aff1"/></contrib></contrib-group><aff id="aff1"><addr-line>Biomolecular Engineering Department, Baskin School of Engineering, University of California, Santa Cruz, Santa Cruz, California, United States of America</addr-line></aff><contrib-group><contrib contrib-type="editor"><name><surname>Colombo</surname><given-names>Gualtiero</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1"><addr-line>Centro Cardiologico Monzino IRCCS, Italy</addr-line></aff><author-notes><corresp id="cor1">* E-mail: <email>hyjkim@soe.ucsc.edu</email> (HJK); <email>pourmand@soe.ucsc.edu</email> (NP)</corresp><fn fn-type="conflict"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><fn fn-type="con"><p>Conceived and designed the experiments: HJK. Performed the experiments: HJK. Analyzed the data: HJK. Contributed reagents/materials/analysis tools: HJK NP. Wrote the manuscript: HJK NP. </p></fn></author-notes><pub-date pub-type="collection"><year>2013</year></pub-date><pub-date pub-type="epub"><day>28</day><month>6</month><year>2013</year></pub-date><volume>8</volume><issue>6</issue><elocation-id>e67885</elocation-id><history><date date-type="received"><day>6</day><month>2</month><year>2013</year></date><date date-type="accepted"><day>23</day><month>5</month><year>2013</year></date></history><permissions><copyright-year>2013</copyright-year><license><license-p>This is an open-access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the Creative Commons CC0 public domain dedication.</license-p></license></permissions><abstract><p>Correctly matching the HLA haplotypes of donor and recipient is essential to the success of allogenic hematopoietic stem cell transplantation. Current HLA typing methods rely on targeted testing of recognized antigens or sequences. Despite advances in Next Generation Sequencing, general high throughput transcriptome sequencing is currently underutilized for HLA haplotyping due to the central difficulty in aligning sequences within this highly variable region. Here we present the method, HLAforest, that can accurately predict HLA haplotype by hierarchically weighting reads and using an iterative, greedy, top down pruning technique. HLAforest correctly predicts &#x0003e;99% of allele group level (2 digit) haplotypes and 93% of peptide-level (4 digit) haplotypes of the most diverse HLA genes in simulations with read lengths and error rates modeling currently available sequencing technology. The method is very robust to sequencing error and can predict 99% of allele-group level haplotypes with substitution rates as high as 8.8%. When applied to data generated from a trio of cell lines, HLAforest corroborated PCR-based HLA haplotyping methods and accurately predicted 16/18 (89%) major class I genes for a daughter&#x02013;father-mother trio at the peptide level. Major class II genes were predicted with 100% concordance between the daughter&#x02013;father-mother trio. In fifty HapMap samples with paired end reads just 37 nucleotides long, HLAforest predicted 96.5% of allele group level HLA haplotypes correctly and 83% of peptide level haplotypes correctly. In sixteen RNAseq samples with limited coverage across HLA genes, HLAforest predicted 97.7% of allele group level haplotypes and 85% of peptide level haplotypes correctly.</p></abstract><funding-group><funding-statement>This study is supported in part by NIH (<ext-link ext-link-type="uri" xlink:href="http://nih.gov">nih.gov</ext-link>) grant U19 AI089987 and NCI (<ext-link ext-link-type="uri" xlink:href="http://cancer.gov">cancer.gov</ext-link>) grant U54CA143803. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Hematopoietic stem cell transplantation (HSCT) has successfully treated a wide variety of diseases including autoimmune disorders, rare genetic diseases and blood cancers [<xref ref-type="bibr" rid="B1">1</xref>]. Success of allogenic HSCT treatments is highly correlated with matching of Human Leukocyte Antigen (HLA) alleles between donor and recipient [<xref ref-type="bibr" rid="B2">2</xref>]. The process of matching a donor and recipient requires HLA haplotyping, a process that typically requires specialized antibody or targeted DNA based tests [<xref ref-type="bibr" rid="B3">3</xref>]. The utility of high throughput sequencing methods has been restricted by the need for specialized primer sets to enrich targeted DNA or RNA sequences [<xref ref-type="bibr" rid="B4">4</xref>&#x02013;<xref ref-type="bibr" rid="B10">10</xref>]. The use of untargeted RNA-seq data for HLA haplotyping has not seen much development despite dramatic reductions in sequencing costs. This is unfortunate, as RNA-seq assays have proven to be useful tools in personalized medicine for the subclassification of cancers including breast, prostate, leukemias and lymphomas [<xref ref-type="bibr" rid="B11">11</xref>&#x02013;<xref ref-type="bibr" rid="B15">15</xref>]. In cases where a patient would benefit from sequencing of RNA and whose disease would require HSCT, it would be cost effective to predict HLA haplotypes directly from RNA-seq data rather than performing an additional specialized test to determine HLA haplotype.</p><p>Predicting HLA haplotypes, however, has been historically a difficult task [<xref ref-type="bibr" rid="B16">16</xref>]. This is due to the fact that the HLA genes reside in the most polymorphic region of the human genome, the Major Histocompatibility Complex (MHC) [<xref ref-type="bibr" rid="B17">17</xref>]. As a result of balancing selection, the number of known haplotypes for many HLA genes is in the thousands [<xref ref-type="bibr" rid="B18">18</xref>,<xref ref-type="bibr" rid="B19">19</xref>]. Despite the diversity of the region, a high degree of sequence similarity exists between known haplotypes. The unique assignment of a short read to an allele is nearly impossible due to sequence similarity between alleles. The hierarchical nature of the haplotypes (see Methods for details) and the sampling bias, with over representation of most common haplotypes in public databases (e.g. IMGT), further add to the complexity. For these reasons, traditional techniques for assigning mapping qualities or confidence in alignments cannot be applied for this region [<xref ref-type="bibr" rid="B20">20</xref>].</p><p>Despite the difficulty of predicting HLA haplotypes, attempts to call HLA haplotypes from short read data are numerous. Earlier studies utilized targeted resequencing and the generous read length of the Roche 454 to predict haplotypes [<xref ref-type="bibr" rid="B4">4</xref>&#x02013;<xref ref-type="bibr" rid="B10">10</xref>]. Recent studies employ targeted resequencing in conjunction with Illumina sequencers to generate haplotypes [<xref ref-type="bibr" rid="B21">21</xref>]. However, at the time of this publication only two publicly available haplotyping tools, HLAMiner and seq2HLA, are available for the HLA haplotyping directly from RNA-seq reads [<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B23">23</xref>]. HLAMiner utilizes a targeted <italic>de novo</italic> assembly technique to rebuild the genes and then check the haplotype. While the method effectively handles sequencing errors and can potentially increase phasing information, it is limited by the assembly technique that relies on overlapping kmers just 15 nucleotides long. The second available tool, seq2HLA utilizes an alignment-based method to predict low resolution haplotypes, but is unable to provide predictions at higher resolutions.</p><p>Here, we present HLAforest, an alignment-based method that exploits the implicit hierarchy of HLA nomenclature to weight alignments systematically and procedurally predict haplotypes individually. This approach addresses the combinatorial problem of selecting paternal and maternal alleles prior to scoring the most likely haplotype pairs. Additionally, by aligning the entire read to the reference, HLAforest maximizes the information contained within paired reads. Predictions from HLAforest are more accurate at clinically relevant HLA resolutions, due to the topology of the trees generated. Finally, this method exploits the efficiency of modern short read alignment tools and is easily scaled with parallelized computing.</p></sec><sec sec-type="methods" id="s2"><title>Methods</title><sec id="s2.1"><title>HLA Nomenclature</title><p>For both historical and functional reasons, HLA haplotypes are defined hierarchically [<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B25">25</xref>]. HLA molecules are divided into two classes: Class I molecules are expressed on almost all nucleated cells in the human body and present self as well as foreign peptides [<xref ref-type="bibr" rid="B26">26</xref>]. Class II molecules present foreign peptides and are only expressed by specialized antigen-presenting cells such as macrophages, B-lymphocytes and dendritic cells. Both classes of molecules are responsible for peptide-presentation to T-cells for antigen recognition. The peptide-binding domains of class I molecules are encoded by a single gene, whereas the peptide-binding domains of class II molecules are encoded by two genes.</p><p>The first hierarchical unit of HLA genes is the genes themselves. There are three major class I molecules (<italic>HLA-A, HLA-B, HLA-C</italic>), three minor class I molecules (<italic>HLA-E, HLA-F, HLA-G</italic>), three major class II molecules (<italic>HLA-DP, HLA-DQ, HLA-DR</italic>) and two minor class II molecules (<italic>HLA-DM, HLA-DO</italic>). Because class II molecules consist of two genes, haplotypes are further subdivided into an &#x02018;A&#x02019; and &#x02018;B&#x02019; locus, eg <italic>HLA-DRA</italic> and <italic>HLA-DRB</italic>. The IMGT database also contains the non-classical molecules <italic>MicA</italic>, <italic>MicB</italic>, <italic>TapA</italic>, and <italic>TapB</italic> that do not participate in antigen presentation. However, TapA and TapB are important for the transportation and loading of antigenic peptides onto classical HLA molecules.</p><p>Each HLA gene is subdivided into up to four subclassifications: allele group, peptide, nucleotide and intron. Allele groups originated from early serotyping experiments and represent sets of peptide sequences with high levels of sequence homology. The peptide level represents unique amino acid sequences. The nucleotide level represents unique nucleotide sequences that generate the same peptide sequence. The intron level represents polymorphisms that occur in non-coding portions of the gene, such as introns. These subclassifications are denoted by a 2 digit number separated by colons, e.g., the haplotype HLA-A*01<italic>: 02:03:04</italic> is a haplotype for gene &#x02018;<italic>A</italic>&#x02019; with the allele group &#x02018;<italic>01</italic>&#x02019;, peptide sequence of &#x02018;<italic>02</italic>&#x02019;, nucleotide sequence of &#x02018;<italic>03</italic>&#x02019; and intronic sequence of &#x02018;<italic>04</italic>&#x02019;. A haplotype of <italic>HLA-A*01: 02:01:01</italic> belongs to the same peptide group as <italic>HLA-A*01: 02:03:04</italic>, but has a unique nucleotide sequence.</p><p>The resolution of HLA haplotyping assays is typically described by the number of significant digits the test can discriminate. For example, a 2 digit assay will reveal the allele group; whereas, a 4 digit assay will reveal the unique peptide sequence. 2 digit assays are typically referred to as &#x0201c;low resolution typing&#x0201d;; whereas, 4 digit assays are referred to as &#x0201c;high resolution typing&#x0201d;.</p></sec><sec id="s2.2"><title>Alignment</title><p>Version 3.10.0 of the IMGT HLA nucleotide database was downloaded as a FASTA file and was used as a reference for Bow tie alignments. Null alleles were excluded from the set of known alleles, as intronic reads can artificially inflate the scores of those alleles. Reads mapping to any HLA haplotype in the IMGT were filtered using Bow tie v-0.12.8 using default options [<xref ref-type="bibr" rid="B27">27</xref>]. Reads that aligned at least once to any IMGT reference HLA haplotype were kept using Bow tie&#x02019;s option to write aligned reads to a new file. Filtered reads were then realigned to the IMGT database, this time reporting all possible alignments. Alignments with exact matches excluded any alignment with &#x0003e; 0 mismatches. For read lengths greater than 100bp, the maximum insert size was set to the sum of simulated fragment length and three standard deviations of fragment size. All other parameters were set to bow tie defaults.</p></sec><sec id="s2.3"><title>Alignment Tree Building</title><p>A tree is built for each read given the set of possible alignments generated during the mapping step (<xref ref-type="fig" rid="pone-0067885-g001">Figure 1)</xref>. This tree describes the entire set of alignments such that each leaf in the tree represents an alignment of a read to a specific HLA allele (<xref ref-type="fig" rid="pone-0067885-g001">Figure 1b)</xref>. The root of the tree is an empty node with no biological significance. The descendants of the root node represent a specific HLA gene (e.g., <italic>HLA-A, HLA-B</italic>, and <italic>HLA-C</italic> are each represented as unique nodes under the root node). The structure of each gene subtree is defined by the HLA nomenclature where the second level represents the allele group, the third level represents unique peptide sequence, the fourth level represents synonymous nucleotide sequences and the fifth level represents differences in non-coding regions. For example, direct descendants of root nodes correspond to genes. The descendants of gene nodes correspond to allele groups and this pattern continues until a leaf is reached.</p><fig id="pone-0067885-g001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067885.g001</object-id><label>Figure 1</label><caption><title>Method for building a weighted read tree.</title><p>Given a set of alignments (a) for a single read, a tree is built such that all possible alignments are leaf nodes (b). Gene, allele group, peptide, nucleotide and intronic digits are represented as nodes on the tree. Sum of mismatch qualities (SMMQs) are converted to alignment probabilities for leaf nodes (c). Probabilities are then distributed upwards such that the probability of a parent node is equal to the maximum probability of its children (d). Weights are distributed downwards in such that the weight of a node is dependent on the local probability of the node and the weight of the parent child (e &#x00026; f). Equations used for generating probability of an alignment and weights of example nodes are outlined (g).</p></caption><graphic xlink:href="pone.0067885.g001"/></fig></sec><sec id="s2.4"><title>Generating Weights for Each Node in a Read Tree</title><p>An alignment tree is built for each read given the set of possible alignments generated during the mapping step. Local alignment probabilities are calculated for each leaf node by first identifying mismatched positions in the alignment between the read and a reference allele (<xref ref-type="fig" rid="pone-0067885-g002">Figure 2b)</xref>. The phred quality scores of mismatched positions are summed and the sum is exponentiated in order to generate a probability (<xref ref-type="fig" rid="pone-0067885-g002">Figure 2c)</xref>. More specifically:</p><fig id="pone-0067885-g002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067885.g002</object-id><label>Figure 2</label><caption><title>An example of the top-down pruning algorithm.</title><p>Given a set of reads and their alignments (a), read trees are built for each read (b). The evidence for each allele group is determined by taking the sum of the evidence of all allele groups represented in the trees (c). Here it is assumed that the weight of each node is 1. The allele group with the maximum evidence is assumed to be the primary allele group for each gene and edges in trees containing the primary allele group are pruned (d). After pruning, the trees are reweighted and the evidence for each allele group (e). The second highest scoring allele group is then considered to be the minor haplotype. Read trees are then repruned such that only edges supporting the primary or secondary allele group remain (f). The process repeats itself iteratively until the most likely leaf nodes remain (g and h).</p></caption><graphic xlink:href="pone.0067885.g002"/></fig><disp-formula><mml:math id="m1"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula><p>where <italic>p</italic><sub><italic>leaf</italic></sub> represents the local alignment probability of a leaf and <italic>q</italic> represents to a phred quality value corresponding to a mismatched base at position <italic>i</italic> in the read. These probabilities are then distributed upwards through the tree by assigning the maximum probability of all children to the current node (<xref ref-type="fig" rid="pone-0067885-g002">Figure 2e</xref>),</p><disp-formula><mml:math id="m2"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>l</mml:mi><mml:mi>d</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><p>Once probabilities have been distributed throughout the tree, they are converted to weights. The weighting procedure distributes the total evidence provided by the read to all nodes of the tree, such that</p><disp-formula><mml:math id="m3"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mstyle><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula><p>In the above equation, <italic>w</italic> is the weight of a node and <italic>p</italic> is the local probability of a node (<xref ref-type="fig" rid="pone-0067885-g002">Figure 2f and g)</xref>. Each node can only have as much weight as its parent, and all weight contained in a node is distributed amongst its children. In this study, all root nodes were given a weight of 1; this weight, however, may be modified to reflect variable read lengths.</p></sec><sec id="s2.5"><title>Haplotype Prediction</title><p>Haplotypes are predicted using a greedy, top down, iterative pruning algorithm (<xref ref-type="fig" rid="pone-0067885-g002">Figure 2)</xref>. The algorithm begins by attempting to select a primary and secondary haplotype for each HLA gene at the allele group level. Here a primary haplotype is defined as the haplotype with greater representation in an RNA-seq library. A secondary haplotype is the haplotype with less sequence representation. Selecting a primary haplotype begins by summing the weighted evidence of all read trees at the allele group level (<xref ref-type="fig" rid="pone-0067885-g002">Figure 2b and c)</xref>. For each gene in the IMGT reference database, the allele group with the highest score is chosen as the primary haplotype (<xref ref-type="fig" rid="pone-0067885-g002">Figure 2c)</xref>.</p><p>After primary haplotypes are chosen, a temporary set of pruned trees is generated to predict the secondary haplotype. Trees that contain evidence for any of the primary haplotypes are pruned by removing edges that do not support primary haplotypes. Secondary haplotypes are predicted by summing the weighted evidence of pruned trees and selecting the haplotype with the second highest score. Read trees are then repruned such that only edges that belong to the primary or secondary allele group remain. In the event that a read tree supports both primary and secondary haplotypes, it is assigned to the haplotype with greater weight. If the weights between the primary and secondary haplotypes are equal, the read is randomly assigned to a haplotype. Nodes of pruned trees are then reweighted using the local alignment probabilities generated in the tree-building step.</p><p>Following the selection of primary and secondary haplotypes at the allele group level, protein level haplotypes are chosen using the same methodology used to predict primary haplotypes. The sum of node weights over all pruned trees are generated at the protein level. The protein level haplotype with the maximum score is chosen for both the primary and secondary haplotypes. Trees are then repruned to reflect the protein level haplotypes and the process iterates until the nucleotide and intron level haplotypes are similarly chosen.</p><p>In some instances, an individual may have a primary and secondary haplotype that are the same at the allele group level, but differ at the protein or nucleotide level. In these instances, the secondary haplotype is only assigned if the sum of its evidence exceeds 5% of the primary haplotype. This percentage was determined empirically (data not shown).</p></sec><sec id="s2.6"><title>Simulations</title><p>Simulations were generated to test the effect of read length, sequencing depth and error rate on the accuracy of this HLA haplotyping method. Each of these variables was tested independently. Two haplotypes were randomly selected for a subset of genes represented in the IMGT reference database. In this case, <italic>HLA-A</italic>, <italic>HLA-B</italic>, <italic>HLA-C</italic> and <italic>HLA-DRB1</italic> were chosen as these genes represent the majority of diversity in the IMGT database (<xref ref-type="supplementary-material" rid="pone.0067885.s002">Table S1</xref> and <xref ref-type="supplementary-material" rid="pone.0067885.s001">Figure S1</xref>).</p><p>Reads were simulated using ART [<xref ref-type="bibr" rid="B28">28</xref>]. ART uses empirically derived models to generate simulated reads with a realistic distribution of errors with regards to position. Simulations tested the effect of substitution rate, coverage, and read length on the accuracy of the method. Paired read lengths of 37 nt, 50 nt, 75 nt, 100 nt and 200 nt were tested. Coverage of 1x, 10x, 25x, 50x, 100x and 500x for each selected gene. Varying substitution rates were generated by modifying the quality shift parameter of the ART simulator. Higher quality shift values resulted in reads with fewer substitutions. The substitution rate for each quality shift value was calculated by dividing the total number of substituted bases by the total number of simulated bases. For 100nt reads, quality shift values of 0, 3, 6, 9, 12, and 30 resulted in substitution rates of 8.8%, 4.4%, 2.2%, 1.1%, 0.5% and .009%, respectively. In addition, simulations using all genes present in the IMGT were also performed. 5,000 simulations were performed for each variable. Paired reads were used in all simulations. Insertion and deletions were not included in simulation. Exact parameters used for simulation are described in <xref ref-type="supplementary-material" rid="pone.0067885.s003">Table S2</xref>.</p></sec><sec id="s2.7"><title>Calculating Simulation Accuracy</title><p>Predictions were considered to be accurate if the true haplotype (determined by selection during simulation or through external validation) was consistent at the allele group, peptide, nucleotide or intron level. Accuracy was assessed over all levels present in the true haplotype. If the true allele was only typed to the peptide level, accuracy was not assessed at the nucleotide or intron level. For example, the reference allele <italic>HLA-A*02: 90</italic> is only typed to the peptide level and accuracy at the nucleotide level cannot be determined for this allele. Of the 8,631 sequences present in the IMGT database: 87 (1%) are typed to the allele group level; 6,014 (70%) are typed to the peptide level; 2,308 (27%) are typed to the nucleotide level; and 222 (2%) are typed to the intron level.</p></sec><sec id="s2.8"><title>Cell Line Trio Data</title><p>Cell line Tri&#x000f3; RNA-seq data was downloaded from the UCSC Encode release 4 (August 2012). Raw fastq files for GM12878 rep2v2 were downloaded from the UCSC genome browser. Raw fastq files for gm12891 (rep2v2) and gm12892 (rep3v2) were also downloaded from the UCSC genome browser. The number of reads available for each dataset are presented in <xref ref-type="supplementary-material" rid="pone.0067885.s004">Table S3</xref>.</p></sec><sec id="s2.9"><title>HapMap Data</title><p>Fifty RNAseq samples were sequenced in a study by de Bakker et al and HLA haplotypes were subsequently reported by Montgomery et al [<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B30">30</xref>]. RNA-seq samples were obtained from the NCBI SRA with the study accession id ERP000101. The accession numbers of the individual samples presented in this study are available in <xref ref-type="supplementary-material" rid="pone.0067885.s005">Table S4</xref>.</p></sec><sec id="s2.10"><title>Colorectal Cancer Data</title><p>Warren et al tests HLAMiner on sixteen colorectal cancer RNAseq datasets. These samples were HLA Haplotyped by Sanger Sequencing, for which 87 out of 96 possible Class I haplotypes were reported [<xref ref-type="bibr" rid="B22">22</xref>]. Corresponding RNAseq data with the NCBI SRA study accession id SRP10181 was downloaded and used as input for HLAforest. Sample accession numbers are available in <xref ref-type="supplementary-material" rid="pone.0067885.s006">Table S5</xref>.</p></sec><sec id="s2.11"><title>Implementation</title><p>HLAforest is implemented in perl and is free for academic use under the Apache License. It can be downloaded (<ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/hlaforest">http://code.google.com/p/hlaforest</ext-link>). HLAforest uses bioperl to read in FASTA files. Alignments use Bow tie, although any alignment tool can be used to generate SAM alignments for use as input to HLAforest.</p></sec></sec><sec sec-type="results" id="s3"><title>Results</title><sec id="s3.1"><title>Simulation Results</title><p>Simulations were performed to test the effect of read length, coverage depth and substitution rate on the accuracy of the method. These simulations were performed only on the HLA genes <italic>HLA-A</italic>, <italic>HLA-B</italic>, <italic>HLA-C</italic>, and <italic>HLA-DRB1</italic> as these represented the majority of diversity present in the IMGT database (<xref ref-type="supplementary-material" rid="pone.0067885.s001">Figure S1</xref>). The average of prediction rates over these four genes is reported (<xref ref-type="fig" rid="pone-0067885-g003">Figure 3)</xref>. Performance of each individual gene is available in <xref ref-type="supplementary-material" rid="pone.0067885.s003">Table S2</xref>. Simulations were also performed using all genes in the IMGT database in order to test the accuracy on each individual gene. HLAforest performed very well at the allele group level, achieving &#x0003e; 99% accuracy in all situations except for very low coverage (1x) and short read lengths (2x37nt and 2x50nt). Peptide level accuracy varied more throughout the simulations with shorter read lengths contributing most to a decline in accuracy. HLAforest performed well at varying levels of coverage and with substantial substitution rates.</p><fig id="pone-0067885-g003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067885.g003</object-id><label>Figure 3</label><caption><title>Simulation results showing the effect of read length (a), sequencing depth (b), and substitution rate (c) on average accuracy of HLA-A, HLA-B, HLA-C, and HLA-DRB1.</title></caption><graphic xlink:href="pone.0067885.g003"/></fig></sec><sec id="s3.2"><title>Simulated Effect of Read Length</title><p>Accuracy was largely affected by read length, with longer reads providing substantially better results. Read lengths of 2x50, 2x75, 2x100, and 2x200 nt were tested for their effect on accuracy (<xref ref-type="fig" rid="pone-0067885-g003">Figure 3a)</xref>. Greater read lengths provided more accurate results, with 2x200 nt achieving very high accuracy (96.7%) at the peptide level. At 2x100 nt an average accuracy of 94% was achieved. At lower read lengths, accuracy declined at the peptide level but increased at the nucleotide level. This effect is artifactual as accuracy is not assessed at the nucleotide level if the true haplotype is only typed to the peptide level. Allele group level suffered with 2x37nt and 2x50nt reads, achieving 94.5% and 97.6% accuracy, respectively. However, accuracy was above 98.7% for 2x75nt, 2x100nt and 2x200nt read lengths.</p></sec><sec id="s3.3"><title>Simulated Effect of Sequencing Depth</title><p>Simulations showed a minimal effect of increasing sequencing depth on accuracy. Total coverage amounts of 1x, 10x, 25x, 50x, 100x and 500x for each chosen haplotype were tested (<xref ref-type="fig" rid="pone-0067885-g003">Figure 3b)</xref>. Although high resolution performance suffered at very low coverage (64% at 1x), accuracy jumped to 92% with just 10x coverage. Increasing coverage above 25x had minimal effect on high resolution accuracy. Peptide level accuracy was above 94.9% for all coverage levels above 25x. Allele group level accuracy was above 98.9% at coverage levels greater than 10x.</p></sec><sec id="s3.4"><title>Simulated Effect of Substitution Rate</title><p>Substitution rates of 0.009%, 0.5%, 1.1%, 2.2%, 4.4%, and 8.8% were assayed in order to test the effect of sequencing error on the accuracy of the method. Substitution rate had minor effects on the accuracy of the method. With substitution rates below 2.2%, peptide level accuracy was above 93%. At 4.4%, accuracy declined to 90%. With a large substitution rate of 8.8%, peptide level accuracy was still respectable at 84%. Allele group level accuracy was above 98.9% for all substitution rates tested.</p></sec><sec id="s3.5"><title>Simulations Using All Genes</title><p>Simulations using all genes in the IMGT database rather than just <italic>HLA-A</italic>, <italic>HLA-B</italic>, <italic>HLA-C</italic> and <italic>HLA-DRB1</italic> were conducted to see the accuracy of the method on each individual gene (<xref ref-type="supplementary-material" rid="pone.0067885.s003">Table S2</xref>). Low resolution accuracy was above 98% for most genes except for a few selected genes (DPA1, DPB1, DRB6, MicA, MicB, Tap1, Tap2, V). Peptide level accuracy was above 91% for HLA-A, HLA-B, HLA-C, but fell below 90% for remaining genes.</p></sec><sec id="s3.6"><title>Simulations Allowing No Mismatches during Alignment</title><p>Disallowing mismatches during the alignment step resulted in higher accuracy when substitution rates were sufficiently low (<xref ref-type="supplementary-material" rid="pone.0067885.s003">Table S2</xref>). At 0.009% error, peptide level accuracy was 94.3% when mismatches were allowed, but increased to 95.6% when only exact matches were utilized. However, at higher substitution rates, performance declined achieving an accuracy of 55% at 1.1% error rate. At 0.009% substitution rate, accuracy was improved by 1-2% over all conditions tested when no mismatches were allowed during alignment. With a low substitution rate and sufficiently high coverage, it may be beneficial to restrict the number of mismatches during alignment. Boegel et al. reports a similar effect and recommends allowing only a single mismatch during alignment [<xref ref-type="bibr" rid="B23">23</xref>].</p></sec><sec id="s3.7"><title>Read Weighting and Tree Pruning Reduces Noise</title><p>An example demonstrating the effect of read weighting and tree pruning can be visualized in <xref ref-type="fig" rid="pone-0067885-g004">Figure 4</xref>. Here, one hundred 2x100 nt reads were sampled for the HLA haplotypes HLA-A*02<italic>: 90</italic> and <italic>HLA-A*26: 36</italic>. The difficulty of predicting HLA allele groups without read weighting or tree pruning can be seen in <xref ref-type="fig" rid="pone-0067885-g004">Figure 4a</xref>, which charts the maximum number of reads that map to a child member of an allele group. Although <italic>HLA-A*26</italic> is ranked first in the number of reads supporting that allele, three incorrect allele groups rank above the true allele group of <italic>HLA-A*02</italic>.</p><fig id="pone-0067885-g004" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067885.g004</object-id><label>Figure 4</label><caption><title>Effect of read weighting and tree pruning on predicting allele group.</title><p>In this simulated example, HLA-A*02: 90 (labeled in red text) and HLA-A*26: 30 (labeled in blue text) are the true alleles. (a) The maximum number of reads mapping to any descendant of allele groups are shown. These results represent a naive attempt at predicting haplotypes from RNA-seq data where reads are unweighted. (b) Evidence for each allele group after building weighted read trees. Allele groups are labeled on the outermost circle. Arcs connecting allele groups have widths proportional to the amount of evidence that shared between connected allele groups. Here it is already evident that A*02 and A*26 have the most evidence, but other haplotypes have substantial evidence. (c) The effect of pruning read trees after selecting the primary haplotype (A*02) clearly distinguishes the secondary allele group (A*26) from other allele groups. (d) A final pruning step removes all ambiguous edges and assigns all evidence to the true allele groups.</p></caption><graphic xlink:href="pone.0067885.g004"/></fig><p>Hierarchically weighting and pruning the simulated reads allows for the reduction of noise and for accurate prediction of allele groups in this example. The hierarchical weighting procedure provides multiple benefits. First it distributes all the evidence a single read could provide to all possible alignments, rather than giving equal weight to all alignments. Secondly, it allows for the visualization of the amount of shared evidence between all allele groups (<xref ref-type="fig" rid="pone-0067885-g004">Figure 4b)</xref>. After weighting has been applied, <italic>HLA-A*02</italic> and <italic>HLA-A*26</italic> contain the majority of evidence, however much of the evidence for the incorrect allele groups remain. The intermediate pruning step, where ambiguous evidence is assigned to the primary allele group, significantly reduces noise. <xref ref-type="fig" rid="pone-0067885-g004">Figure 4c</xref> shows that post pruning, the secondary allele group with the most evidence is clearly A*26. The final pruning step removes all ambiguous evidence (<xref ref-type="fig" rid="pone-0067885-g004">Figure 4d)</xref>.</p></sec><sec id="s3.8"><title>Cell Line Trio</title><p>Three cell lines, gm12878, gm12891, and gm12892, representing a daughter&#x02013;father-mother trio, respectively, were used to test this method. It is expected that the daughter (gm12878) would carry a set of alleles from each parent. 2x75bp reads were used to predict haplotypes for all genes present in the IMGT database (<xref ref-type="supplementary-material" rid="pone.0067885.s004">Table S3</xref>).</p><p>When compared to haplotypes determined by targeted resequencing and Sanger sequencing as performed by Erlich et al. [<xref ref-type="bibr" rid="B5">5</xref>], all HLA class I alleles were recapitulated for gm12878 at the peptide level (<xref ref-type="table" rid="tab1">Table 1)</xref>. Most class I alleles were recapitulated for gm12891 and gm12892, except for those that were found to be discordant when compared to gm12878. In all, sixteen out of eighteen (89%) of class I molecules were called consistently with previous studies. Accuracy of other genes, assessed by looking for consistent predictions between the daughter (gm12878) and her parents, had accuracy similar to major class I genes.</p><table-wrap id="tab1" orientation="portrait" position="float"><label>Table 1</label><caption><title>Predicted haplotypes of major HLA genes on the daughter-father-mother trio of cell lines using exact alignments.</title></caption><table frame="hsides" rules="groups"><colgroup span="1"><col span="1"/><col span="1"/><col span="1"/><col span="1"/><col span="1"/><col span="1"/><col span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1"><bold>Gene</bold></th><th colspan="2" rowspan="1"><bold>Father (gm12891)</bold><hr/></th><th colspan="2" rowspan="1"><bold>Mother (gm12892)</bold><hr/></th><th colspan="2" rowspan="1"><bold>Daughter (gm12878)</bold><hr/></th></tr><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"><bold>Primary</bold></th><th rowspan="1" colspan="1"><bold>Secondary</bold></th><th rowspan="1" colspan="1"><bold>Primary</bold></th><th rowspan="1" colspan="1"><bold>Secondary</bold></th><th rowspan="1" colspan="1"><bold>Paternal</bold></th><th rowspan="1" colspan="1"><bold>Maternal</bold></th></tr></thead><tbody><tr><td rowspan="1" colspan="1"><bold>A</bold></td><td rowspan="1" colspan="1">01:01:01<xref rid="ngtab1.1">**</xref></td><td rowspan="1" colspan="1">24:02:01<xref rid="ngtab1.1">**</xref></td><td rowspan="1" colspan="1">11:01:18<xref rid="ngtab1.1">**</xref><sup><xref rid="ngtab1.2">&#x000a7;</xref></sup></td><td rowspan="1" colspan="1">02:01:01<xref rid="ngtab1.1">**</xref></td><td rowspan="1" colspan="1">01:01:01<xref rid="ngtab1.1">**</xref></td><td rowspan="1" colspan="1">11:01:01<xref rid="ngtab1.1">**</xref><sup><xref rid="ngtab1.2">&#x000a7;</xref></sup></td></tr><tr><td rowspan="1" colspan="1"><bold>B</bold></td><td rowspan="1" colspan="1">08:01:01<xref rid="ngtab1.1">**</xref></td><td rowspan="1" colspan="1">07:02:01<xref rid="ngtab1.1">**</xref></td><td rowspan="1" colspan="1">15:01:01<xref rid="ngtab1.1">**</xref></td><td rowspan="1" colspan="1">15:01:20<sup><xref rid="ngtab1.3">&#x02020;</xref></sup></td><td rowspan="1" colspan="1">08:01:01<xref rid="ngtab1.1">**</xref></td><td rowspan="1" colspan="1">56:01:01<xref rid="ngtab1.1">**</xref><sup><xref rid="ngtab1.3">&#x02020;</xref></sup></td></tr><tr><td rowspan="1" colspan="1"><bold>C</bold></td><td rowspan="1" colspan="1">07:02:01<xref rid="ngtab1.1">**</xref></td><td rowspan="1" colspan="1">07:02:01<xref rid="ngtab1.4">*</xref><sup><xref rid="ngtab1.5">&#x02021;</xref></sup></td><td rowspan="1" colspan="1">01:02:01<xref rid="ngtab1.1">**</xref></td><td rowspan="1" colspan="1">04:01:01<xref rid="ngtab1.1">**</xref></td><td rowspan="1" colspan="1">07:01:01<xref rid="ngtab1.1">**</xref><sup><xref rid="ngtab1.5">&#x02021;</xref></sup></td><td rowspan="1" colspan="1">01:02:01<xref rid="ngtab1.1">**</xref></td></tr><tr><td rowspan="1" colspan="1"><bold>DPA1</bold></td><td rowspan="1" colspan="1">01:03:01</td><td rowspan="1" colspan="1">01:03:01</td><td rowspan="1" colspan="1">02:01:01</td><td rowspan="1" colspan="1">01:03:01</td><td rowspan="1" colspan="1">01:03:01</td><td rowspan="1" colspan="1">02:01:01</td></tr><tr><td rowspan="1" colspan="1"><bold>DPB1</bold></td><td rowspan="1" colspan="1">04:01:01</td><td rowspan="1" colspan="1">03:01:01</td><td rowspan="1" colspan="1">14:01</td><td rowspan="1" colspan="1">06:01</td><td rowspan="1" colspan="1">04:01:01</td><td rowspan="1" colspan="1">14:01</td></tr><tr><td rowspan="1" colspan="1"><bold>DQA1</bold></td><td rowspan="1" colspan="1">05:01:01</td><td rowspan="1" colspan="1">01:02:01</td><td rowspan="1" colspan="1">01:01:01</td><td rowspan="1" colspan="1">01:01:01</td><td rowspan="1" colspan="1">05:01:01</td><td rowspan="1" colspan="1">01:01:01</td></tr><tr><td rowspan="1" colspan="1"><bold>DQB1</bold></td><td rowspan="1" colspan="1">02:01:01</td><td rowspan="1" colspan="1">06:02:01</td><td rowspan="1" colspan="1">05:01:01</td><td rowspan="1" colspan="1">05:01:01</td><td rowspan="1" colspan="1">02:01:01</td><td rowspan="1" colspan="1">05:01:01</td></tr><tr><td rowspan="1" colspan="1"><bold>DRA</bold></td><td rowspan="1" colspan="1">01:02:03<sup><xref rid="ngtab1.2">&#x000a7;</xref></sup></td><td rowspan="1" colspan="1">01:02:02</td><td rowspan="1" colspan="1">01:01:01</td><td rowspan="1" colspan="1">01:01:01</td><td rowspan="1" colspan="1">01:02:02<sup><xref rid="ngtab1.2">&#x000a7;</xref></sup></td><td rowspan="1" colspan="1">01:01:01</td></tr><tr><td rowspan="1" colspan="1"><bold>DRB1</bold></td><td rowspan="1" colspan="1">03:01:01</td><td rowspan="1" colspan="1">15:01:01</td><td rowspan="1" colspan="1">01:01:01</td><td rowspan="1" colspan="1">01:01:01</td><td rowspan="1" colspan="1">03:01:01</td><td rowspan="1" colspan="1">01:01:01</td></tr></tbody></table><table-wrap-foot><fn id="ngtab1.4"><label>*</label><p> Consistent at allele group level with haplotypes from Erlich, et al. [<xref ref-type="bibr" rid="B5">5</xref>]</p></fn><fn id="ngtab1.1"><label>**</label><p> Consistent at peptide level with haplotypes from Erlich, et al.</p></fn><fn id="ngtab1.3"><label>&#x02020;</label><p> Inconsistent between parent and daughter at allele group level</p></fn><fn id="ngtab1.5"><label>&#x02021;</label><p> Inconsistent between parent and daughter at peptide level</p></fn><fn id="ngtab1.2"><label>&#x000a7;</label><p> Inconsistent between parent and daughter at nucleotide level</p></fn></table-wrap-foot></table-wrap><p>Accuracy of haplotyping was assessed over the fifteen genes with sufficient coverage (greater than 1% of all mapped reads supporting the gene). Of the thirty alleles in these genes, twenty-six were predicted consistently at the peptide level, two were predicted consistently at the allele group level and two were completely miscalled (<xref ref-type="supplementary-material" rid="pone.0067885.s004">Table S3</xref>).</p><p>In addition to predicting haplotypes, the method allows for the estimation of expression of all genes. <xref ref-type="fig" rid="pone-0067885-g005">Figure 5</xref> shows the number of pruned reads aligning to each HLA gene. We see that classical class I molecules (<italic>HLA-A</italic>, <italic>HLA-B</italic>, <italic>HLA-C</italic>) have moderate expression in all samples. Likewise there is moderate to high expression of some major class II genes (<italic>HLA-DPA1</italic>, <italic>HLA-DPB1</italic>, <italic>HLA-DQA1</italic>, <italic>HLA-DQB1</italic>, <italic>HLA-DRA</italic> and <italic>HLA-DRB1</italic>). There is lower expression of the minor class I molecules along with some class II molecules (<italic>HLA-E</italic>, <italic>HLA-F</italic>, <italic>HLA-DMA</italic>, <italic>HLA-DMB</italic>, <italic>HLA-DOA</italic> and <italic>HLA-DOB</italic>).</p><fig id="pone-0067885-g005" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0067885.g005</object-id><label>Figure 5</label><caption><title>Final pruned weights supporting each gene in the IMGT database shows expression over major class I molecules (A, B, C) as well as over most major class I molecules (DMA, DMB, DPA1, DPB1, DQB1, DRA, DRB1).</title><p>Some expression is seen in minor class I alleles (E, F) and non classical molecules (TAP1 and TAP2).</p></caption><graphic xlink:href="pone.0067885.g005"/></fig></sec><sec id="s3.9"><title>HapMap Results</title><p>Fifty HapMap samples that have been both HLA haplotyped with Sanger Sequencing and for which there are RNA-seq data available were analyzed using HLAforest. RNAseq data was 2x37nt in length. HLAforest was able to predict 96% of allele-group level haplotypes correctly. 82% of peptide-level haplotypes were also predicted correctly. When alignments were restricted to disallow mismatches, HLAforest was able to predict 96.5% and 83.5% of peptide level haplotypes correctly (<xref ref-type="table" rid="tab2">Table 2)</xref>. On average, 127,000 reads aligned to the IMGT database when mismatches were allowed and 91,000 reads aligned when no mismatches were allowed. Detailed results are available in <xref ref-type="supplementary-material" rid="pone.0067885.s005">Table S4</xref>.</p><table-wrap id="tab2" orientation="portrait" position="float"><label>Table 2</label><caption><title>Accuracy of haplotyping results from 50 HapMap samples with 2x37bp reads allowing or not allowing mismatched alignments to references.</title></caption><table frame="hsides" rules="groups"><colgroup span="1"><col span="1"/><col span="1"/><col span="1"/><col span="1"/><col span="1"/><col span="1"/><col span="1"/><col span="1"/><col span="1"/><col span="1"/><col span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1"><bold>Mismatches Allowed?</bold></th><th rowspan="1" colspan="1"><bold>A</bold></th><th rowspan="1" colspan="1"><bold>B</bold></th><th rowspan="1" colspan="1"><bold>C</bold></th><th rowspan="1" colspan="1"><bold>DQA</bold></th><th rowspan="1" colspan="1"><bold>DQB</bold></th><th rowspan="1" colspan="1"><bold>DRB</bold></th><th rowspan="1" colspan="1"><bold>Class I</bold></th><th rowspan="1" colspan="1"><bold>Class II</bold></th><th rowspan="1" colspan="1"><bold>Total</bold></th></tr></thead><tbody><tr><td rowspan="1" colspan="1"><bold>Allele Group</bold></td><td rowspan="1" colspan="1">Yes</td><td align="char" rowspan="1" colspan="1">.950</td><td align="char" rowspan="1" colspan="1">.930</td><td align="char" rowspan="1" colspan="1">.950</td><td align="char" rowspan="1" colspan="1">.980</td><td align="char" rowspan="1" colspan="1">.980</td><td align="char" rowspan="1" colspan="1">.976</td><td align="char" rowspan="1" colspan="1">.943</td><td align="char" rowspan="1" colspan="1">.978</td><td align="char" rowspan="1" colspan="1">.960</td></tr><tr><td rowspan="1" colspan="1"><bold>Peptide</bold></td><td rowspan="1" colspan="1">Yes</td><td align="char" rowspan="1" colspan="1">.940</td><td align="char" rowspan="1" colspan="1">.838</td><td align="char" rowspan="1" colspan="1">.680</td><td align="char" rowspan="1" colspan="1">.804</td><td align="char" rowspan="1" colspan="1">.804</td><td align="char" rowspan="1" colspan="1">.872</td><td align="char" rowspan="1" colspan="1">.819</td><td align="char" rowspan="1" colspan="1">.823</td><td align="char" rowspan="1" colspan="1">.821</td></tr><tr><td rowspan="1" colspan="1"><bold>Allele Group</bold></td><td rowspan="1" colspan="1">No</td><td align="char" rowspan="1" colspan="1">.950</td><td align="char" rowspan="1" colspan="1">.940</td><td align="char" rowspan="1" colspan="1">.950</td><td rowspan="1" colspan="1">1</td><td align="char" rowspan="1" colspan="1">.990</td><td align="char" rowspan="1" colspan="1">.963</td><td align="char" rowspan="1" colspan="1">.947</td><td align="char" rowspan="1" colspan="1">.985</td><td align="char" rowspan="1" colspan="1">.965</td></tr><tr><td rowspan="1" colspan="1"><bold>Peptide</bold></td><td rowspan="1" colspan="1">No</td><td align="char" rowspan="1" colspan="1">.940</td><td align="char" rowspan="1" colspan="1">.848</td><td align="char" rowspan="1" colspan="1">.730</td><td align="char" rowspan="1" colspan="1">.804</td><td align="char" rowspan="1" colspan="1">.825</td><td align="char" rowspan="1" colspan="1">.872</td><td align="char" rowspan="1" colspan="1">.839</td><td align="char" rowspan="1" colspan="1">.830</td><td align="char" rowspan="1" colspan="1">.835</td></tr></tbody></table></table-wrap></sec><sec id="s3.10"><title>Colorectal Cancer Samples</title><p>In a study by Warren, et al. on HLA haplotyping using short read assembly, he presented a dataset of sixteen RNA-seq samples for which Class I molecules were haplotyped by PCR [<xref ref-type="bibr" rid="B22">22</xref>]. Of the 96 total possible alleles, 87 were typed to the peptide level. Reads for this dataset were 2x100nt in length. On average, 3,500 reads aligned to the IMGT database. HLAforest predicted 85 (97.7%) of low resolution haplotypes correctly and 74 (85%) of high resolution peptides correctly. Detailed results are available in <xref ref-type="supplementary-material" rid="pone.0067885.s006">Table S5</xref>.</p></sec></sec><sec sec-type="discussion" id="s4"><title>Discussion</title><p>The method described herein performed well in simulations with read length and substitution rates mirroring those of available sequencing technologies, namely Illumina sequencers. HLAforest has the advantage of scaling well with longer reads and it fully utilizes the phasing information present in paired-end reads. The method is generalizable to any set of genes that can be arranged hierarchically. It also has the major benefit of selecting haplotypes individually, thus reducing the complexity and combinatorial difficulty of selecting two haplotypes simultaneously. Some problems remain, including the inability to call novel haplotypes and report ambiguous haplotypes, but these can be addressed in the future.</p><p>Simulations show that this method can achieve a high resolution accuracy of 93% (2x100bp reads and 0.5% substitution rate) over the genes that represent the majority of diversity in the IMGT database (<italic>HLA-A</italic>, <italic>HLA-B</italic>, <italic>HLA-C</italic>, <italic>HLA-DRB1</italic>). Evaluation of this method on the daughter&#x02013;father-mother cell line trio shows that 26/30 (87%) the daughter&#x02019;s alleles were predicted consistently at the peptide level. After comparison to results of Sanger sequencing and targeted resequencing with Roche 454, it was determined that errors in typing occurred within gm12891 and gm12892 (<xref ref-type="table" rid="tab1">Table 1)</xref>. Errors in typing may be related to the 2x75bp read lengths available for these cell lines. In order to make accurate predictions, HLAforest relies on the phasing information within individual reads, which are dependent on read length.</p><p>The majority of information extracted from short reads comes from the ability to phase discriminatory SNPs across the most diverse coding regions of the HLA genes. For class I genes, the majority of diversity are present in exons 2-4 [<xref ref-type="bibr" rid="B31">31</xref>]. Here, short reads of sufficient length and quality are able to phase the discriminatory SNPs that define each haplotype. Indeed, increasing the read length to 2x200 nt in simulations substantially improves the accuracy of the method with accuracy greater than 96.7% at the peptide level. This finding is significant as high throughput sequencing technologies such as Illumina and Ion Torrent have announced plans to release 2x200 nt sequencing kits. The HLAforest method is best applied to RNA-seq data as reads are more likely to phase discriminatory SNPs across exons in fully spliced transcripts. If read lengths or insert size exceed the length of introns in these genes, this method can be extended to the whole genome or targeted sequencing datasets without loss of accuracy.</p><p>The robustness of this method is apparent in simulations testing effect of substitution rate on accuracy. Modern Illumina machines report an overall substitution rate &#x0003c; 0.5% [<xref ref-type="bibr" rid="B32">32</xref>]. In simulations with comparable error rates, HLAforest is able to predict 93% of haplotypes at the peptide level. Even with substitution rates as high as 8.8%, HLAforest can predict 99% of low resolution haplotypes correctly.</p><p>This method has major benefits over earlier methods. First it can be generalized to any set of genes that are classified hierarchically. Secondly, as opposed to competing methods, there are no combinatorial issues with selecting two haplotypes to score simultaneously. In this method, haplotypes are chosen procedurally and this reduces the computation time necessary for scoring many hypothetical pairs of alleles.</p><p>Recently, HLAMiner has been published and shares many of the same benefits as HLAforest. The major distinction between the methods is HLAMiner&#x02019;s reliance on the <italic>de novo</italic> assembler, TASR [<xref ref-type="bibr" rid="B33">33</xref>]. HLAforest exploits highly efficient short read alignment algorithms, which have been the subject of major development in the bioinformatics field. This alignment step is easily parallelizable, as opposed to <italic>de novo</italic> assembly methods that require shared memory. Additionally, HLAforest uses all the phasing information within paired-end reads rather than attempting <italic>de novo</italic> assembly with shorter k-mers. Differences in the methodologies make direct comparison of the methods difficult. However, our simulations with 2x100 nt reads and 0.55% substitution rate show an average major class I accuracy of 92.7% at the peptide level as opposed to HLAMiner&#x02019;s sensitivity and specificity of 84.7% and 89.65% with the same parameters, respectively. When error rates were increased to 2%, average major class I accuracy with HLAforest dropped slightly to 92.7% whereas the sensitivity and specificity of HLAminer&#x02019;s simulations were 54.9% and 87.5% respectively. The data suggests that HLAforest&#x02019;s predictions are more accurate than HLAMiner even with larger error rates.</p><p>When compared to HLAMiner on sixteen colorectal cancer samples, HLAforest was able to predict 97.7% of low resolution haplotypes and 85% of high resolution haplotypes for Class I molecules. HLAMiner reported 95.6% sensitivity and 99% specificity at low resolution, and 90.7% sensitivity and 93.5% specific at high resolution. It is worth noting that the sensitivity and specificity measures reported by Warren, et al. are not standard. Whereas HLAforest generated 96 predictions for the 96 possible peptide-level Class I haplotypes, HLAMiner generated 235 predictions.</p><p>HLAforest&#x02019;s predictions for colorectal cancer samples fell below the levels predicted by simulations with 2x100nt read lengths. This is perhaps due to the low number of reads aligning to the IMGT database, especially when compared to the HapMap samples (3,500 for colorectal samples vs 127,000 for HapMap samples).</p><p>HLAforest performed well on fifty HapMap samples using 2x37nt reads. It was able to predict 96% low resolution haplotypes accurately. Performance of HLAforest was comparable to seq2HLA, which predicted low resolution haplotypes with 100% sensitivity and 93% specificity. However, HLAforest was also able to predict 82% of high resolution haplotypes correctly. Remarkably, HLAforest performed better on these samples than it did in simulation with similar read lengths. This is perhaps due to the increased coverage in the HapMap samples as well as the reduced representation of haplotypes present in these samples. These cross study comparisons imply better performance with HLAforest; however, such comparisons should be interpreted cautiously until systematic benchmarking can be performed.</p><p>Although HLAforest presents many strengths, there are some shortcomings. First, typing class II MHC molecules may be impossible based on the cell type of the input RNA. Because only specialized antigen presenting cells (such as B cells, dendritic cells, etc) express class II MHC molecules, some of these cells must be present in the sample in order to generate the corresponding reads. Second, the method is restricted to haplotypes that already exist in the IMGT database. HLAforest chooses the closest matching haplotype, but does not reconstruct the actual haplotype. It is feasible to look for novel haplotypes by generating a consensus sequence from the reads supporting each predicted haplotype and then checking for novel SNPs. Third, HLAforest reports only two haplotypes and does not produce confidence scores at this time. Finally, this method does not yet incorporate population-based frequency data that has been shown to improve the accuracy of all typing methods in well-studied populations [<xref ref-type="bibr" rid="B34">34</xref>]</p></sec><sec sec-type="supplementary-material"><title>Supporting Information</title><supplementary-material content-type="local-data" id="pone.0067885.s001"><label>Figure S1</label><caption><p><bold>Number of Haplotypes in IMGT Database.</bold></p><p>(PNG)</p></caption><media xlink:href="pone.0067885.s001.png" mimetype="image" mime-subtype="png"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0067885.s002"><label>Table S1</label><caption><p><bold>IMGT Statistics.</bold></p><p>(XLS)</p></caption><media xlink:href="pone.0067885.s002.xls" mimetype="application" mime-subtype="vnd.ms-excel"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0067885.s003"><label>Table S2</label><caption><p><bold>Simulation Conditions and Results.</bold></p><p>(XLS)</p></caption><media xlink:href="pone.0067885.s003.xls" mimetype="application" mime-subtype="vnd.ms-excel"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0067885.s004"><label>Table S3</label><caption><p><bold>Cell Line Trio Results.</bold></p><p>(XLS)</p></caption><media xlink:href="pone.0067885.s004.xls" mimetype="application" mime-subtype="vnd.ms-excel"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0067885.s005"><label>Table S4</label><caption><p><bold>HapMap Results.</bold></p><p>(XLS)</p></caption><media xlink:href="pone.0067885.s005.xls" mimetype="application" mime-subtype="vnd.ms-excel"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material><supplementary-material content-type="local-data" id="pone.0067885.s006"><label>Table S5</label><caption><p><bold>Colorectal Cancer Results.</bold></p><p>(XLS)</p></caption><media xlink:href="pone.0067885.s006.xls" mimetype="application" mime-subtype="vnd.ms-excel"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ack><p>We would like to thank A. Atkins, N. Nguyen, E. Scott and R. Shelansky for their critical review of the manuscript.</p></ack><ref-list><title>References</title><ref id="B1"><label>1</label><mixed-citation publication-type="journal"><name><surname>Copelan</surname><given-names>EA</given-names></name> (<year>2006</year>) <article-title>Hematopoietic stem-cell transplantation</article-title>. <source>N Engl J Med</source><volume>354</volume>: <fpage>1813</fpage>-<lpage>1826</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1056/NEJMra052638">10.1056/NEJMra052638</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/16641398">16641398</ext-link><pub-id pub-id-type="pmid">16641398</pub-id></mixed-citation></ref><ref id="B2"><label>2</label><mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>SJ</given-names></name>, <name><surname>Klein</surname><given-names>J</given-names></name>, <name><surname>Haagenson</surname><given-names>M</given-names></name>, <name><surname>Baxter-Lowe</surname><given-names>LA</given-names></name>, <name><surname>Confer</surname><given-names>DL</given-names></name><etal>et al.</etal> (<year>2007</year>) <article-title>High-resolution donor-recipient HLA matching contributes to the success of unrelated donor marrow transplantation</article-title>. <source>Blood</source><volume>110</volume>: <fpage>4576</fpage>-<lpage>4583</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1182/blood-2007-06-097386">10.1182/blood-2007-06-097386</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/17785583">17785583</ext-link><pub-id pub-id-type="pmid">17785583</pub-id></mixed-citation></ref><ref id="B3"><label>3</label><mixed-citation publication-type="journal"><name><surname>Erlich</surname><given-names>H</given-names></name> (<year>2012</year>) <article-title>HLA DNA typing: past, present, and future</article-title>. <source>Tissue Antigens</source><volume>80</volume>: <fpage>1</fpage>-<lpage>11</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1399-0039.2012.01881.x">10.1111/j.1399-0039.2012.01881.x</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/22651253">22651253</ext-link><pub-id pub-id-type="pmid">22651253</pub-id></mixed-citation></ref><ref id="B4"><label>4</label><mixed-citation publication-type="journal"><name><surname>Bentley</surname><given-names>G</given-names></name>, <name><surname>Higuchi</surname><given-names>R</given-names></name>, <name><surname>Hoglund</surname><given-names>B</given-names></name>, <name><surname>Goodridge</surname><given-names>D</given-names></name>, <name><surname>Sayer</surname><given-names>D</given-names></name><etal>et al.</etal> (<year>2009</year>) <article-title>High-resolution, high-throughput HLA genotyping by next-generation sequencing</article-title>. <source>Tissue Antigens</source><volume>74</volume>: <fpage>393</fpage>-<lpage>403</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1399-0039.2009.01345.x">10.1111/j.1399-0039.2009.01345.x</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/19845894">19845894</ext-link><pub-id pub-id-type="pmid">19845894</pub-id></mixed-citation></ref><ref id="B5"><label>5</label><mixed-citation publication-type="journal"><name><surname>Erlich</surname><given-names>RL</given-names></name>, <name><surname>Jia</surname><given-names>X</given-names></name>, <name><surname>Anderson</surname><given-names>S</given-names></name>, <name><surname>Banks</surname><given-names>E</given-names></name>, <name><surname>Gao</surname><given-names>X</given-names></name><etal>et al.</etal> (<year>2011</year>) <article-title>Next-generation sequencing for HLA typing of class I loci</article-title>. <source>BMC Genomics</source><volume>12</volume>: <fpage>42</fpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-12-42">10.1186/1471-2164-12-42</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/21244689">21244689</ext-link><pub-id pub-id-type="pmid">21244689</pub-id></mixed-citation></ref><ref id="B6"><label>6</label><mixed-citation publication-type="journal"><name><surname>Gabriel</surname><given-names>C</given-names></name>, <name><surname>Danzer</surname><given-names>M</given-names></name>, <name><surname>Hackl</surname><given-names>C</given-names></name>, <name><surname>Kopal</surname><given-names>G</given-names></name>, <name><surname>Hufnagl</surname><given-names>P</given-names></name><etal>et al.</etal> (<year>2009</year>) <article-title>Rapid high-throughput human leukocyte antigen typing by massively parallel pyrosequencing for high-resolution allele identification</article-title>. <source>Hum Immunol</source><volume>70</volume>: <fpage>960</fpage>-<lpage>964</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.humimm.2009.08.009">10.1016/j.humimm.2009.08.009</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/19706315">19706315</ext-link><pub-id pub-id-type="pmid">19706315</pub-id></mixed-citation></ref><ref id="B7"><label>7</label><mixed-citation publication-type="journal"><name><surname>Holcomb</surname><given-names>CL</given-names></name>, <name><surname>H&#x000f6;glund</surname><given-names>B</given-names></name>, <name><surname>Anderson</surname><given-names>MW</given-names></name>, <name><surname>Blake</surname><given-names>LA</given-names></name>, <name><surname>B&#x000f6;hme</surname><given-names>I</given-names></name><etal>et al.</etal> (<year>2011</year>) <article-title>A multi-site study using high-resolution HLA genotyping by next generation sequencing</article-title>. <source>Tissue Antigens</source><volume>77</volume>: <fpage>206</fpage>-<lpage>217</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1399-0039.2010.01606.x">10.1111/j.1399-0039.2010.01606.x</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/21299525">21299525</ext-link><pub-id pub-id-type="pmid">21299525</pub-id></mixed-citation></ref><ref id="B8"><label>8</label><mixed-citation publication-type="journal"><name><surname>Lank</surname><given-names>SM</given-names></name>, <name><surname>Wiseman</surname><given-names>RW</given-names></name>, <name><surname>Dudley</surname><given-names>DM</given-names></name>, <name><surname>O&#x02019;Connor</surname><given-names>DH</given-names></name> (<year>2010</year>) <article-title>A novel single cDNA amplicon pyrosequencing method for high-throughput, cost-effective sequence-based HLA class I genotyping</article-title>. <source>Hum Immunol</source><volume>71</volume>: <fpage>1011</fpage>-<lpage>1017</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.humimm.2010.07.012">10.1016/j.humimm.2010.07.012</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20650293">20650293</ext-link><pub-id pub-id-type="pmid">20650293</pub-id></mixed-citation></ref><ref id="B9"><label>9</label><mixed-citation publication-type="journal"><name><surname>Lind</surname><given-names>C</given-names></name>, <name><surname>Ferriola</surname><given-names>D</given-names></name>, <name><surname>Mackiewicz</surname><given-names>K</given-names></name>, <name><surname>Heron</surname><given-names>S</given-names></name>, <name><surname>Rogers</surname><given-names>M</given-names></name><etal>et al.</etal> (<year>2010</year>) <article-title>Next-generation sequencing: the solution for high-resolution, unambiguous human leukocyte antigen typing</article-title>. <source>Hum Immunol</source><volume>71</volume>: <fpage>1033</fpage>-<lpage>1042</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.humimm.2010.06.016">10.1016/j.humimm.2010.06.016</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20603174">20603174</ext-link><pub-id pub-id-type="pmid">20603174</pub-id></mixed-citation></ref><ref id="B10"><label>10</label><mixed-citation publication-type="journal"><name><surname>Pr&#x000f6;ll</surname><given-names>J</given-names></name>, <name><surname>Danzer</surname><given-names>M</given-names></name>, <name><surname>Stabentheiner</surname><given-names>S</given-names></name>, <name><surname>Niklas</surname><given-names>N</given-names></name>, <name><surname>Hackl</surname><given-names>C</given-names></name><etal>et al.</etal> (<year>2011</year>) <article-title>Sequence capture and next generation resequencing of the MHC region highlights potential transplantation determinants in HLA identical haematopoietic stem cell transplantation</article-title>. <source>DNA Res</source><volume>18</volume>: <fpage>201</fpage>-<lpage>210</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/dnares/dsr008">10.1093/dnares/dsr008</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/21622977">21622977</ext-link><pub-id pub-id-type="pmid">21622977</pub-id></mixed-citation></ref><ref id="B11"><label>11</label><mixed-citation publication-type="journal"><name><surname>Ren</surname><given-names>S</given-names></name>, <name><surname>Peng</surname><given-names>Z</given-names></name>, <name><surname>Mao</surname><given-names>JH</given-names></name>, <name><surname>Yu</surname><given-names>Y</given-names></name>, <name><surname>Yin</surname><given-names>C</given-names></name><etal>et al.</etal> (<year>2012</year>) <article-title>RNA-seq analysis of prostate cancer in the Chinese population identifies recurrent gene fusions, cancer-associated long noncoding RNAs and aberrant alternative splicings</article-title>. <source>Cell Res</source><volume>22</volume>: <fpage>806</fpage>-<lpage>821</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/cr.2012.30">10.1038/cr.2012.30</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/22349460">22349460</ext-link><pub-id pub-id-type="pmid">22349460</pub-id></mixed-citation></ref><ref id="B12"><label>12</label><mixed-citation publication-type="journal"><name><surname>Maher</surname><given-names>CA</given-names></name>, <name><surname>Kumar-Sinha</surname><given-names>C</given-names></name>, <name><surname>Cao</surname><given-names>X</given-names></name>, <name><surname>Kalyana-Sundaram</surname><given-names>S</given-names></name>, <name><surname>Han</surname><given-names>B</given-names></name><etal>et al.</etal> (<year>2009</year>) <article-title>Transcriptome sequencing to detect gene fusions in cancer</article-title>. <source>Nature</source><volume>458</volume>: <fpage>97</fpage>-<lpage>101</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature07638">10.1038/nature07638</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/19136943">19136943</ext-link><pub-id pub-id-type="pmid">19136943</pub-id></mixed-citation></ref><ref id="B13"><label>13</label><mixed-citation publication-type="journal"><name><surname>Roychowdhury</surname><given-names>S</given-names></name>, <name><surname>Iyer</surname><given-names>MK</given-names></name>, <name><surname>Robinson</surname><given-names>DR</given-names></name>, <name><surname>Lonigro</surname><given-names>RJ</given-names></name>, <name><surname>Wu</surname><given-names>YM</given-names></name><etal>et al.</etal> (<year>2011</year>) <article-title>Personalized Oncology Through Integrative High-Throughput Sequencing: A Pilot Study</article-title>. <source>Sci Transl Med</source><volume>3</volume>: <fpage>111ra121</fpage> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/22133722">22133722</ext-link></mixed-citation></ref><ref id="B14"><label>14</label><mixed-citation publication-type="journal"><name><surname>Schmitz</surname><given-names>R</given-names></name>, <name><surname>Young</surname><given-names>RM</given-names></name>, <name><surname>Ceribelli</surname><given-names>M</given-names></name>, <name><surname>Jhavar</surname><given-names>S</given-names></name>, <name><surname>Xiao</surname><given-names>W</given-names></name><etal>et al.</etal> (<year>2012</year>) <article-title>Burkitt lymphoma pathogenesis and therapeutic targets from structural and functional genomics</article-title>. <source>Nature</source><volume>490</volume>: <fpage>116</fpage>-<lpage>120</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11378">10.1038/nature11378</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/22885699">22885699</ext-link><pub-id pub-id-type="pmid">22885699</pub-id></mixed-citation></ref><ref id="B15"><label>15</label><mixed-citation publication-type="journal"><name><surname>Nevins</surname><given-names>JR</given-names></name>, <name><surname>Potti</surname><given-names>A</given-names></name> (<year>2007</year>) <article-title>Mining gene expression profiles: expression signatures as cancer phenotypes</article-title>. <source>Nat Rev Genet</source><volume>8</volume>: <fpage>601</fpage>-<lpage>609</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ni1471">10.1038/ni1471</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/17607306">17607306</ext-link><pub-id pub-id-type="pmid">17607306</pub-id></mixed-citation></ref><ref id="B16"><label>16</label><mixed-citation publication-type="journal"><name><surname>Tait</surname><given-names>BD</given-names></name> (<year>2011</year>) <article-title>The ever-expanding list of HLA alleles: changing HLA nomenclature and its relevance to clinical transplantation</article-title>. <source>Transplant Rev</source><volume>25</volume>: <fpage>1</fpage>-<lpage>8</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0955-470X(11)00035-8">10.1016/S0955-470X(11)00035-8</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/21030236">21030236</ext-link></mixed-citation></ref><ref id="B17"><label>17</label><mixed-citation publication-type="journal"><name><surname>Frazer</surname><given-names>KA</given-names></name>, <name><surname>Ballinger</surname><given-names>DG</given-names></name>, <name><surname>Cox</surname><given-names>DR</given-names></name>, <name><surname>Hinds</surname><given-names>DA</given-names></name>, <name><surname>Stuve</surname><given-names>LL</given-names></name><etal>et al.</etal> (<year>2007</year>) <article-title>A second generation human haplotype map of over 3.1 million SNPs</article-title>. <source>Nature</source><volume>449</volume>: <fpage>851</fpage>-<lpage>U853</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature06258">10.1038/nature06258</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/17943122">17943122</ext-link><pub-id pub-id-type="pmid">17943122</pub-id></mixed-citation></ref><ref id="B18"><label>18</label><mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>J</given-names></name>, <name><surname>Waller</surname><given-names>MJ</given-names></name>, <name><surname>Fail</surname><given-names>SC</given-names></name>, <name><surname>McWilliam</surname><given-names>H</given-names></name>, <name><surname>Lopez</surname><given-names>R</given-names></name><etal>et al.</etal> (<year>2009</year>) <article-title>The IMGT/HLA database</article-title>. <source>Nucleic Acids Res</source><volume>37</volume>: <fpage>D1013</fpage>-<lpage>D1017</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkn662">10.1093/nar/gkn662</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/18838392">18838392</ext-link><pub-id pub-id-type="pmid">18838392</pub-id></mixed-citation></ref><ref id="B19"><label>19</label><mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>J</given-names></name>, <name><surname>Mistry</surname><given-names>K</given-names></name>, <name><surname>McWilliam</surname><given-names>H</given-names></name>, <name><surname>Lopez</surname><given-names>R</given-names></name>, <name><surname>Parham</surname><given-names>P</given-names></name><etal>et al.</etal> (<year>2011</year>) <article-title>The IMGT/HLA database</article-title>. <source>Nucleic Acids Res</source><volume>39</volume>: <fpage>D1171</fpage>-<lpage>D1176</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkq998">10.1093/nar/gkq998</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/21071412">21071412</ext-link><pub-id pub-id-type="pmid">21071412</pub-id></mixed-citation></ref><ref id="B20"><label>20</label><mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name> (<year>2008</year>) <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>. <source>Genome Res</source><volume>18</volume>: <fpage>1851</fpage>-<lpage>1858</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.078212.108">10.1101/gr.078212.108</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/18714091">18714091</ext-link><pub-id pub-id-type="pmid">18714091</pub-id></mixed-citation></ref><ref id="B21"><label>21</label><mixed-citation publication-type="journal"><name><surname>Krishnakumar</surname><given-names>S</given-names></name>, <name><surname>Wang</surname><given-names>CL</given-names></name>, <name><surname>Wilhelmy</surname><given-names>J</given-names></name>, <name><surname>Babrzadeh</surname><given-names>F</given-names></name>, <name><surname>Su</surname><given-names>L</given-names></name><etal>et al.</etal> (<year>2012</year>) <article-title>High Throughput, High Fidelity Hla Genotyping with Ultra Deep Sequencing</article-title>. <source>Tissue Antigens</source><volume>79</volume>: <fpage>426</fpage>-<lpage>426</lpage></mixed-citation></ref><ref id="B22"><label>22</label><mixed-citation publication-type="journal"><name><surname>Warren</surname><given-names>RL</given-names></name>, <name><surname>Choe</surname><given-names>G</given-names></name>, <name><surname>Freeman</surname><given-names>DJ</given-names></name>, <name><surname>Castellarin</surname><given-names>M</given-names></name>, <name><surname>Munro</surname><given-names>S</given-names></name><etal>et al.</etal> (<year>2012</year>) <article-title>Derivation of HLA types from shotgun sequence datasets</article-title>. <source>Genome Med</source><volume>4</volume>: <fpage>95</fpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gm396">10.1186/gm396</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/23228053">23228053</ext-link><pub-id pub-id-type="pmid">23228053</pub-id></mixed-citation></ref><ref id="B23"><label>23</label><mixed-citation publication-type="journal"><name><surname>Boegel</surname><given-names>S</given-names></name>, <name><surname>L&#x000f6;wer</surname><given-names>M</given-names></name>, <name><surname>Sch&#x000e4;fer</surname><given-names>M</given-names></name>, <name><surname>Bukur</surname><given-names>T</given-names></name>, <name><surname>de Graaf</surname><given-names>J</given-names></name><etal>et al.</etal> (<year>2013</year>) <article-title>HLA typing from RNA-Seq sequence reads</article-title>. <source>Genome Med</source><volume>4</volume>: <fpage>102</fpage> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/23259685">23259685</ext-link><pub-id pub-id-type="pmid">23259685</pub-id></mixed-citation></ref><ref id="B24"><label>24</label><mixed-citation publication-type="journal"><name><surname>Park</surname><given-names>I</given-names></name>, <name><surname>Terasaki</surname><given-names>P</given-names></name> (<year>2000</year>) <article-title>Origins of the first HLA specificities</article-title>. <source>Hum Immunol</source><volume>61</volume>: <fpage>185</fpage>-<lpage>189</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0198-8859(99)00154-8">10.1016/S0198-8859(99)00154-8</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/10689107">10689107</ext-link><pub-id pub-id-type="pmid">10689107</pub-id></mixed-citation></ref><ref id="B25"><label>25</label><mixed-citation publication-type="journal"><name><surname>Marsh</surname><given-names>SG</given-names></name>, <name><surname>Albert</surname><given-names>ED</given-names></name>, <name><surname>Bodmer</surname><given-names>WF</given-names></name>, <name><surname>Bontrop</surname><given-names>RE</given-names></name>, <name><surname>Dupont</surname><given-names>B</given-names></name><etal>et al.</etal> (<year>2010</year>) <article-title>Nomenclature for factors of the HLA system, 2010</article-title>. <source>Tissue Antigens</source><volume>75</volume>: <fpage>291</fpage>-<lpage>455</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1399-0039.2010.01466.x">10.1111/j.1399-0039.2010.01466.x</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20356336">20356336</ext-link><pub-id pub-id-type="pmid">20356336</pub-id></mixed-citation></ref><ref id="B26"><label>26</label><mixed-citation publication-type="journal"><name><surname>Williams</surname><given-names>A</given-names></name>, <name><surname>Peh</surname><given-names>CA</given-names></name>, <name><surname>Elliott</surname><given-names>T</given-names></name> (<year>2002</year>) <article-title>The cell biology of MHC class I antigen presentation</article-title>. <source>Tissue Antigens</source><volume>59</volume>: <fpage>3</fpage>-<lpage>17</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1034/j.1399-0039.2002.590103.x">10.1034/j.1399-0039.2002.590103.x</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/11972873">11972873</ext-link><pub-id pub-id-type="pmid">11972873</pub-id></mixed-citation></ref><ref id="B27"><label>27</label><mixed-citation publication-type="journal"><name><surname>Langmead</surname><given-names>B</given-names></name>, <name><surname>Trapnell</surname><given-names>C</given-names></name>, <name><surname>Pop</surname><given-names>M</given-names></name>, <name><surname>Salzberg</surname><given-names>SL</given-names></name> (<year>2009</year>) <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome Biol</source><volume>10</volume>: <fpage>R25</fpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2009-10-3-r25">10.1186/gb-2009-10-3-r25</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/19261174">19261174</ext-link><pub-id pub-id-type="pmid">19261174</pub-id></mixed-citation></ref><ref id="B28"><label>28</label><mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Myers</surname><given-names>JR</given-names></name>, <name><surname>Marth</surname><given-names>GT</given-names></name> (<year>2012</year>) <article-title>ART: a next-generation sequencing read simulator</article-title>. <source>Bioinformatics</source><volume>28</volume>: <fpage>593</fpage>-<lpage>594</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr708">10.1093/bioinformatics/btr708</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/22199392">22199392</ext-link><pub-id pub-id-type="pmid">22199392</pub-id></mixed-citation></ref><ref id="B29"><label>29</label><mixed-citation publication-type="journal"><name><surname>de Bakker</surname><given-names>PI</given-names></name>, <name><surname>McVean</surname><given-names>G</given-names></name>, <name><surname>Sabeti</surname><given-names>PC</given-names></name>, <name><surname>Miretti</surname><given-names>MM</given-names></name>, <name><surname>Green</surname><given-names>T</given-names></name><etal>et al.</etal> (<year>2006</year>) <article-title>A high-resolution HLA and SNP haplotype map for disease association studies in the extended human MHC</article-title>. <source>Nat Genet</source><volume>38</volume>: <fpage>1166</fpage>-<lpage>1172</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng1885">10.1038/ng1885</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/16998491">16998491</ext-link><pub-id pub-id-type="pmid">16998491</pub-id></mixed-citation></ref><ref id="B30"><label>30</label><mixed-citation publication-type="journal"><name><surname>Montgomery</surname><given-names>SB</given-names></name>, <name><surname>Sammeth</surname><given-names>M</given-names></name>, <name><surname>Gutierrez-Arcelus</surname><given-names>M</given-names></name>, <name><surname>Lach</surname><given-names>RP</given-names></name>, <name><surname>Ingle</surname><given-names>C</given-names></name><etal>et al.</etal> (<year>2010</year>) <article-title>Transcriptome genetics using second generation sequencing in a Caucasian population</article-title>. <source>Nature</source><volume>464</volume>: <fpage>773</fpage>-<lpage>777</lpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08903">10.1038/nature08903</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/20220756">20220756</ext-link><pub-id pub-id-type="pmid">20220756</pub-id></mixed-citation></ref><ref id="B31"><label>31</label><mixed-citation publication-type="journal"><name><surname>Parham</surname><given-names>P</given-names></name>, <name><surname>Lawlor</surname><given-names>DA</given-names></name>, <name><surname>Lomen</surname><given-names>CE</given-names></name>, <name><surname>Ennis</surname><given-names>PD</given-names></name> (<year>1989</year>) <article-title>Diversity and diversification of HLA-A,B,C alleles</article-title>. <source>J Immunol</source><volume>142</volume>: <fpage>3937</fpage>-<lpage>3950</lpage> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/2715640">2715640</ext-link><pub-id pub-id-type="pmid">2715640</pub-id></mixed-citation></ref><ref id="B32"><label>32</label><mixed-citation publication-type="journal"><name><surname>Quail</surname><given-names>MA</given-names></name>, <name><surname>Smith</surname><given-names>M</given-names></name>, <name><surname>Coupland</surname><given-names>P</given-names></name>, <name><surname>Otto</surname><given-names>TD</given-names></name>, <name><surname>Harris</surname><given-names>SR</given-names></name><etal>et al.</etal> (<year>2012</year>) <article-title>A tale of three next generation sequencing platforms: comparison of Ion Torrent, Pacific Biosciences and Illumina MiSeq sequencers</article-title>. <source>BMC Genomics</source><volume>13</volume>: <fpage>341</fpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2164-13-341">10.1186/1471-2164-13-341</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/22827831">22827831</ext-link><pub-id pub-id-type="pmid">22827831</pub-id></mixed-citation></ref><ref id="B33"><label>33</label><mixed-citation publication-type="journal"><name><surname>Warren</surname><given-names>RL</given-names></name>, <name><surname>Holt</surname><given-names>RA</given-names></name> (<year>2011</year>) <article-title>Targeted assembly of short sequence reads</article-title>. <source>PLOS ONE</source><volume>6</volume>: <fpage>e19816</fpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0019816">10.1371/journal.pone.0019816</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/21589938">21589938</ext-link><pub-id pub-id-type="pmid">21589938</pub-id></mixed-citation></ref><ref id="B34"><label>34</label><mixed-citation publication-type="journal"><name><surname>Pauni&#x00107;</surname><given-names>V</given-names></name>, <name><surname>Gragert</surname><given-names>L</given-names></name>, <name><surname>Madbouly</surname><given-names>A</given-names></name>, <name><surname>Freeman</surname><given-names>J</given-names></name>, <name><surname>Maiers</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>Measuring ambiguity in HLA typing methods</article-title>. <source>PLOS ONE</source><volume>7</volume>: <fpage>e43585</fpage>.<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0043585">10.1371/journal.pone.0043585</ext-link> PubMed: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/22952712">22952712</ext-link><pub-id pub-id-type="pmid">22952712</pub-id></mixed-citation></ref></ref-list></back></article>