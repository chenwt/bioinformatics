<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 39.96?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 2?><front><journal-meta><journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id><journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id><journal-id journal-id-type="hwp">nar</journal-id><journal-id journal-id-type="publisher-id">nar</journal-id><journal-title-group><journal-title>Nucleic Acids Research</journal-title></journal-title-group><issn pub-type="ppub">0305-1048</issn><issn pub-type="epub">1362-4962</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">5001598</article-id><article-id pub-id-type="pmid">27207878</article-id><article-id pub-id-type="doi">10.1093/nar/gkw452</article-id><article-categories><subj-group subj-group-type="hwp-journal-coll"><subject>7</subject><subject>24</subject></subj-group><subj-group subj-group-type="heading"><subject>Methods Online</subject></subj-group></article-categories><title-group><article-title>Robust lineage reconstruction from high-dimensional single-cell data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Giecold</surname><given-names>Gregory</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Marco</surname><given-names>Eugenio</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Garcia</surname><given-names>Sara P.</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Trippa</surname><given-names>Lorenzo</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref></contrib><contrib contrib-type="author"><name><surname>Yuan</surname><given-names>Guo-Cheng</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF2"><sup>2</sup></xref><xref ref-type="aff" rid="AFF3"><sup>3</sup></xref><xref ref-type="corresp" rid="COR1">*</xref></contrib><aff id="AFF1"><label>1</label>Department of Biostatistics and Computational Biology, Dana-Farber Cancer Institute, Boston, MA 02215, USA</aff><aff id="AFF2"><label>2</label>Department of Biostatistics, Harvard T.H. Chan School of Public Health, Boston, MA 02115, USA</aff><aff id="AFF3"><label>3</label>Harvard Stem Cell Institute, Cambridge, MA 02138, USA</aff></contrib-group><author-notes><corresp id="COR1"><label>*</label>To whom correspondence should be addressed. Tel: +1 617 582 8532; Fax: +1 617 632 2444; Email: <email>gcyuan@jimmy.harvard.edu</email></corresp></author-notes><pub-date pub-type="ppub"><day>19</day><month>8</month><year>2016</year></pub-date><pub-date pub-type="epub"><day>20</day><month>5</month><year>2016</year></pub-date><pub-date pub-type="pmc-release"><day>20</day><month>5</month><year>2016</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>44</volume><issue>14</issue><fpage>e122</fpage><lpage>e122</lpage><history><date date-type="accepted"><day>09</day><month>5</month><year>2016</year></date><date date-type="rev-recd"><day>12</day><month>4</month><year>2016</year></date><date date-type="received"><day>04</day><month>1</month><year>2016</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2016. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement><copyright-year>2016</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p></license></permissions><self-uri xlink:title="pdf" xlink:href="gkw452.pdf"/><abstract><p>Single-cell gene expression data provide invaluable resources for systematic characterization of cellular hierarchy in multi-cellular organisms. However, cell lineage reconstruction is still often associated with significant uncertainty due to technological constraints. Such uncertainties have not been taken into account in current methods. We present ECLAIR (Ensemble Cell Lineage Analysis with Improved Robustness), a novel computational method for the statistical inference of cell lineage relationships from single-cell gene expression data. ECLAIR uses an ensemble approach to improve the robustness of lineage predictions, and provides a quantitative estimate of the uncertainty of lineage branchings. We show that the application of ECLAIR to published datasets successfully reconstructs known lineage relationships and significantly improves the robustness of predictions. ECLAIR is a powerful bioinformatics tool for single-cell data analysis. It can be used for robust lineage reconstruction with quantitative estimate of prediction accuracy.</p></abstract><counts><page-count count="7"/></counts><custom-meta-group><custom-meta><meta-name>cover-date</meta-name><meta-value>19 August 2016</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>INTRODUCTION</title><p>Over the past few years, high-throughput sequencing, flow and mass cytometry, microfluidics along with other technologies have evolved to the point that the measurements of gene expression and protein levels are now possible at the single-cell resolution (<xref rid="B1" ref-type="bibr">1</xref>), providing an unprecedented opportunity to systematically characterize the cellular heterogeneity within a tissue or cell type. The high-resolution information of cell-type composition has also provided new insights into the cellular heterogeneity in cancer and other diseases (<xref rid="B2" ref-type="bibr">2</xref>). Single-cell data present new challenges for data analysis, and computational methods for addressing such challenges are still under-developed (<xref rid="B3" ref-type="bibr">3</xref>). Here we focus on a common challenge: to infer cell lineage relationships from single-cell gene expression and proteomic data. While several methods have been developed (<xref rid="B4" ref-type="bibr">4</xref>&#x02013;<xref rid="B8" ref-type="bibr">8</xref>), one common limitation is that the resulting lineage is often sensitive to various factors including measurement error, sample size and the choice of pre-processing methods. However, such sensitivity has not been systematically evaluated.</p><p>Ensemble learning is an effective strategy for enhancing prediction accuracy and robustness that is widely used in science and engineering (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B10" ref-type="bibr">10</xref>). The key idea is to aggregate information from multiple prediction methods or subsamples. This approach has also been applied to unsupervised clustering, where multiple clustering methods are applied to a common dataset and consolidated into a single partition called the consensus clustering (<xref rid="B11" ref-type="bibr">11</xref>).</p><p>Here we apply such an ensemble strategy to aggregate information from multiple estimates of lineage trees. We call our method ECLAIR, which stands for <underline>E</underline>nsemble <underline>C</underline>ell <underline>L</underline>ineage <underline>A</underline>nalysis with <underline>I</underline>mproved <underline>R</underline>obustness. We show that ECLAIR improves the overall robustness of lineage estimates and is generally applicable to diverse data-types Moreover, ECLAIR provides a quantitative evaluation of the uncertainty associated with each inferred lineage relationship, providing a guide for further biological validation.</p></sec><sec sec-type="materials|methods" id="SEC2"><title>MATERIALS AND METHODS</title><p>ECLAIR consists in three steps: 1. ensemble generation; 2. consensus clustering and 3. tree combination. An overview of our method is shown in Figure <xref ref-type="fig" rid="F1">1</xref>.</p><fig id="F1" orientation="portrait" position="float"><label>Figure 1.</label><caption><p>Overview of the ECLAIR method. First, multiple subsamples are randomly drawn from the data. Each subsample is divided into cell clusters with similar gene expression patterns, and a minimum spanning tree is constructed to connect the cell clusters. Next, consensus clustering is constructed by aggregating information from all cell clusters. Finally, a lineage tree connecting the consensus clusters (CC) is constructed by aggregating information from the tree ensemble.</p></caption><graphic xlink:href="gkw452fig1"/></fig><sec id="SEC2-1"><title>Ensemble generation</title><p>Given a dataset, we generate an ensemble of partitions out of a population of <italic>n</italic> cells by subsampling, which can be either uniform or non-uniform. For large sample size, we prefer to use a non-uniform, density-based subsampling strategy in order to enrich for under-represented cell types. Specifically, a local density at each cell is estimated as the number of cells falling within a neighborhood of fixed size in the gene expression space. If the local density is above a maximum threshold value, a cell is sampled with a probability that is inversely proportional to the local density. If the local density is below a minimum threshold value, the cell is discarded to avoid technical artifacts In other situations, the cell is always included. The resulting subsample exhibits a nearly uniform coverage of the gene expression space while removing outliers in the cell population.</p><p>Each subsample is divided into clusters with similar gene expression patterns. The specific clustering algorithm is determined by the user and can be selected from <italic>k</italic>-means (<xref rid="B12" ref-type="bibr">12</xref>), affinity propagation (<xref rid="B13" ref-type="bibr">13</xref>) or DBSCAN (Density-based Spatial Clustering of Applications with Noise) (<xref rid="B14" ref-type="bibr">14</xref>). In practice, we find that <italic>k</italic>-means clustering typically offers a good balance between robustness of the final estimates and computational costs.</p><p>For a given clustering solution, a fully connected graph is constructed by connecting every cluster pair, with the edge weight defined as the average Euclidean distance (in the gene expression vector space) between all pairs of cells straddling the two clusters. A minimum spanning tree (MST) is defined as the tree connecting all clusters with minimal total weight. We use Prim's algorithm (<xref rid="B15" ref-type="bibr">15</xref>) to identify the MST. Later on, the path length between a pair of cells, x and y, is defined as the minimum number of edges along the a MST path connecting their corresponding clusters, and denoted by L(x,y).</p><p>The above clustering and linkage procedure is repeated <italic>M</italic> times, each corresponding to a random subsample. After each iteration, the resulting clusters are expanded to incorporate every cell in the population: each cell that has not been subsampled is assigned to its closest cluster. In the end, each tree in the ensemble provides a specific estimate of the lineage tree for the entire cell population.</p><p>Our goals are to aggregate information from the ensemble and to obtain a robust estimate of the lineage tree.</p></sec><sec id="SEC2-2"><title>Consensus clustering</title><p>We start by aggregating the clustering information, searching for a consensus clustering that is on average the most consistent with the different <italic>M</italic> partitions in the ensemble, using a strategy proposed by Strehl and Ghosh (<xref rid="B11" ref-type="bibr">11</xref>). For a population of n cells, the similarity between a pair of clusterings, <inline-formula><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\lambda ^{(a)}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\lambda ^{(b)}}$\end{document}</tex-math></inline-formula>, which contains <inline-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${k^{(a)}}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${k^{(b)}}$\end{document}</tex-math></inline-formula> clusters respectively, is quantified by the normalized mutual information (NMI), defined as: 
<disp-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*} \phi^{( NMI )} (\lambda^{(a)}, \lambda^{(b)})=\frac{\sum_{h=1}^{k^{(a)}}\sum_{l=1}^{k^{(b)}}n_{h,l}\log (\frac{n \cdot n_{h,l}}{n_{h}^{a}n_{l}^{b}})}{\sqrt{(\sum_{h=1}^{k^{(a)}}n_{h}^{(a)}\log \frac{n_{h}^{(a)}}{n})(\sum_{h=1}^{k^{(b)}}n_{l}^{(b)}\log \frac{n_{l}^{(b)}}{n})}} \end{equation*}\end{document}</tex-math></disp-formula></p><p>here, <inline-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n_h^{(a)}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n_l^{(b)}$\end{document}</tex-math></inline-formula> denote the numbers of cells in the corresponding clusters, and <inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${n_{h,l}}$\end{document}</tex-math></inline-formula> stands for the number of cells in their intersection.</p><p>For an ensemble of <italic>M</italic> partitions, <inline-formula><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\lambda ^{(1)}}, \cdots ,{\lambda ^{(M)}}$\end{document}</tex-math></inline-formula>, the consensus clustering <inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\lambda ^*} = \{ {C_1^*, \cdots ,C_K^*} \}$\end{document}</tex-math></inline-formula> is defined as the one that maximizes the average NMI with the <italic>M</italic> partitions in the ensemble. The solution is computed by combining three approximation algorithms, CSPA, HGPA and MCLA, and selecting the one that performs the best (<xref rid="B11" ref-type="bibr">11</xref>).</p></sec><sec id="SEC2-3"><title>Tree combination</title><p>The final step of ECLAIR amounts to constructing a representative tree connecting the consensus clusters (CC). We first construct a fully connected graph <inline-formula><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${G^*}$\end{document}</tex-math></inline-formula>, with the weight of the edge connecting clusters <inline-formula><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C_i^*$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C_j^*$\end{document}</tex-math></inline-formula> given by:
<disp-formula><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*}{W_{ij}} = \frac{1}{{n_i^*n_j^*M}}\mathop \sum \limits_{x \in C_i^*} \mathop \sum \limits_{y \in C_j^*} \mathop \sum \limits_{m = 1}^M {L^{(m)}}(x,y)\end{equation*}\end{document}</tex-math></disp-formula>
where, <inline-formula><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n_i^*$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$n_j^*$\end{document}</tex-math></inline-formula> refer to the number of cells in <inline-formula><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C_i^*$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C_j^*$\end{document}</tex-math></inline-formula>, respectively, and <inline-formula><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${L^{(m)}}(x,y)$\end{document}</tex-math></inline-formula> is the path length between cells <italic>x</italic> and <italic>y</italic> in the <italic>m</italic>-th tree <inline-formula><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${T^{(m)}}$\end{document}</tex-math></inline-formula>. From <inline-formula><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${G^*}$\end{document}</tex-math></inline-formula>, again, we extract a MST, <inline-formula><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${T^*}$\end{document}</tex-math></inline-formula>, by using Prim's algorithm. This is from now on referred to as the ECLAIR tree. In what follows we show that the ECLAIR tree provides a robust estimate of the lineage relationship.</p></sec><sec id="SEC2-4"><title>Tree visualization</title><p>We use the igraph Python package (<ext-link ext-link-type="uri" xlink:href="http://igraph.org/python/">http://igraph.org/python/</ext-link>) to visualize the various trees generated by SPADE (<xref rid="B4" ref-type="bibr">4</xref>) or ECLAIR. To facilitate visualization, we encode the overall gene expression pattern associated with a cell cluster in a particular coloring scheme. Specifically, the raw gene expression pattern is subjected to Principal Component Analysis (PCA). The first three components are rescaled to the [0, 1] interval, and together define a unique color in the RGB (red-green-blue) encoding scheme. As such, clusters with similar expression patterns will have similar colors. Besides, the size of each node is scaled according to the number of cells it contains.</p></sec><sec id="SEC2-5"><title>Lineage tree comparison and robustness estimation</title><p>When we compare two lineage trees, we need to compare not only their edge connections but also their nodes&#x02019; (i.e. cell clusters) identities, since the variation associated with subsampling results in different cell clusters. Although there exists a body of literature on graph comparison (<xref rid="B16" ref-type="bibr">16</xref>), we are not aware of any method that takes into account the differences in the nodes&#x02019; composition. We have therefore developed new metrics that are suitable for comparing lineage trees.</p><p>First, we define a metric to compare the overall similarity between two lineage trees: <inline-formula><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${T_1}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${T_2}$\end{document}</tex-math></inline-formula>. For each tree, we evaluate the path length between every pair of cells in the population, based on the edge connectivity. The correlation between the two sets of path length values is used as a metric to compare the overall similarity of <inline-formula><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${T_1}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${T_2}$\end{document}</tex-math></inline-formula>. In particular, when <inline-formula><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${T_1}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${T_2}$\end{document}</tex-math></inline-formula> are trained on two non-overlapping subsets obtained by partitioning the dataset, the correlation coefficient becomes a measure of the ECLAIR tree estimate variability.</p><p>Second, we define edge-specific dispersion rates to evaluate the robustness of each edge within a lineage tree <inline-formula><tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${T^*}$\end{document}</tex-math></inline-formula>. Specifically, for each edge <inline-formula><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${E_{ij}}$\end{document}</tex-math></inline-formula> connecting a pair of clusters <inline-formula><tex-math id="M32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C_i^*$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C_j^*$\end{document}</tex-math></inline-formula>, we define the dispersion rate <inline-formula><tex-math id="M34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${D_{ij}}$\end{document}</tex-math></inline-formula> associated with <inline-formula><tex-math id="M35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${E_{ij}}$\end{document}</tex-math></inline-formula> as the standard deviation
<disp-formula id="M1"><label>(1)</label><tex-math id="M36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}\begin{equation*}{D_{ij}} = \sqrt {\ E({L^2}(x,y)) - {E^2}\left( {L(x,y)} \right)} \end{equation*}\end{document}</tex-math></disp-formula>
of the path length <inline-formula><tex-math id="M37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$L(x,y)$\end{document}</tex-math></inline-formula>, where (i) <italic>x</italic> and <italic>y</italic> range over all possible pairs of cells selected from <inline-formula><tex-math id="M38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C_i^*$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C_j^*$\end{document}</tex-math></inline-formula> respectively, (ii) the distance <inline-formula><tex-math id="M40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$L(x,y)$\end{document}</tex-math></inline-formula> refers to an independent ECLAIR tree, trained by a hypothetical distinct dataset with identical size and identical distribution of the cell composition. The dispersion rate <inline-formula><tex-math id="M41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${D_{ij}}$\end{document}</tex-math></inline-formula> is unknown because we work with a single dataset. Still, <inline-formula><tex-math id="M42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${D_{ij}} \approx 0$\end{document}</tex-math></inline-formula> implies that nearly every pair <inline-formula><tex-math id="M43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$(x,y)$\end{document}</tex-math></inline-formula> from <inline-formula><tex-math id="M44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C_i^*$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$C_j^*$\end{document}</tex-math></inline-formula> after having been mapped on a hypothetical independent ECLAIR tree would preserve their distance of 1 edge.</p><p>We estimate <inline-formula><tex-math id="M46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\ E({L^2}(x,y))$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$E(L(x,y))$\end{document}</tex-math></inline-formula> to evaluate <inline-formula><tex-math id="M48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${D_{ij}}$\end{document}</tex-math></inline-formula>. To this end, we first randomly created 50 ECLAIR trees each obtained from a different dataset obtained by resampling. Then, by averaging over the resulting 50 trees we estimate <inline-formula><tex-math id="M49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\ E({L^2}(x,y))$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math id="M50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$E(L(x,y))$\end{document}</tex-math></inline-formula>. The results are denoted by <italic>&#x0010e;<sub>ij</sub></italic>. The edges associated with lower <italic>&#x0010e;<sub>ij</sub></italic> values are more reproducible and therefore more likely to reflect true lineage relationships.</p><p>In addition, we provide an alternative uncertainty metric, denoted by <inline-formula><tex-math id="M51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat D_{ij}}$\end{document}</tex-math></inline-formula> from a single ECLAIR tree. Here we consider the variation among the trees within one ECLAIR ensemble, to quantify the variation within the tree ensemble, as the standard deviation of path lengths <inline-formula><tex-math id="M52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${L^{(m)}}(x,y)$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math id="M53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$m = 1,..M$\end{document}</tex-math></inline-formula> across the individual trees, <inline-formula><tex-math id="M54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${T^{(m)}}$\end{document}</tex-math></inline-formula>, within each ensemble. We compute <inline-formula><tex-math id="M55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat D_{ij}}$\end{document}</tex-math></inline-formula> by averaging over the <italic>M</italic> individual trees. To distinguish the two approaches, we call <italic>&#x0010e;<sub>ij</sub></italic> the inter-ensemble dispersion rate and <inline-formula><tex-math id="M56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat D_{ij}}$\end{document}</tex-math></inline-formula> the intra-ensemble dispersion rate. Whereas <italic>&#x0010e;<sub>ij</sub></italic> is an estimate of <inline-formula><tex-math id="M57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${D_{ij}}$\end{document}</tex-math></inline-formula>, it is computationally costly. On the other hand, <inline-formula><tex-math id="M58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat D_{ij}}$\end{document}</tex-math></inline-formula> provides a more computationally variability metric. As shown in the Results section, <inline-formula><tex-math id="M59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat D_{ij}}$\end{document}</tex-math></inline-formula> and <italic>&#x0010e;<sub>ij</sub></italic> are well correlated.</p></sec><sec id="SEC2-6"><title>Numerical implementation and software package</title><p>ECLAIR is implemented as an open-source Python package, which can be accessed at <ext-link ext-link-type="uri" xlink:href="https://www.github.com/GGiecold/ECLAIR">https://www.github.com/GGiecold/ECLAIR</ext-link>. In order to manipulate large datasets, we have made a number of efforts to optimize storage and numerical efficiency, including: a scalable Python module utilizing the HDF5 data structure, a sparse-matrix and streamlined implementation of the Strehl-Ghosh approximation algorithms for consensus clustering, along with scalable and efficient implementations of the affinity propagation and DBSCAN algorithms. All packages are accessible from either the aforementioned Github website or the Python Package Index.</p></sec></sec><sec sec-type="results" id="SEC3"><title>RESULTS</title><sec id="SEC3-1"><title>Reconstruction of cell lineages in mouse embryos</title><p>We used ECLAIR to analyze a public quantitative polymerase chain reaction (qPCR) dataset, which contains gene expression information for 48 genes in 438 cells isolated from early mouse embryos (<xref rid="B17" ref-type="bibr">17</xref>). Previously, we developed a method called SCUBA (Single-cell Clustering Using Bifurcation Analysis) to reconstruct and experimentally validate the cell lineages based on the temporal information (<xref rid="B8" ref-type="bibr">8</xref>). Here we applied ECLAIR to reanalyze this dataset without using the temporal information. One of the goals is to evaluate if ECLAIR, blinded to any temporal information, estimates a tree consistent with the temporal information in the dataset. The clustering was done by using <italic>k</italic>-means, with <italic>k</italic> set to 11 as suggested by a gap statistics analysis (<xref rid="B18" ref-type="bibr">18</xref>). We generated an ensemble of 50 trees, each obtained from a subsample containing 75% of the total number of cells. As shown in Figure <xref ref-type="fig" rid="F2">2</xref>, the SCUBA and ECLAIR trees have strikingly similar overall structures, and the corresponding nodes have similar gene expression patterns. Similar results were obtained by replacing k-means by either DBSCAN (<xref rid="B14" ref-type="bibr">14</xref>) or affinity propagation (<xref rid="B13" ref-type="bibr">13</xref>) clustering algorithm (Supplementary Figure S1). Taken, together, these results suggest a good accuracy of the ECLAIR algorithm.</p><fig id="F2" orientation="portrait" position="float"><label>Figure 2.</label><caption><p>ECLAIR correctly reconstructs the lineage tree in mouse early embryo. (<bold>A</bold>) The lineage tree constructed by SCUBA, based on temporal information in the data. This tree has been experimentally validated. (<bold>B</bold>) The lineage tree constructed by ECLAIR, without using temporal information. The size of each node is proportional to the number of cells in the corresponding cluster. The color of each node indicates the gene expression pattern associated with the corresponding cell cluster. In (B), the edge width is inversely proportional to the estimated dispersion rate.</p></caption><graphic xlink:href="gkw452fig2"/></fig></sec><sec id="SEC3-2"><title>ECLAIR is scalable to large dataset analysis</title><p>To test the scalability of ECLAIR, we analyzed two larger single-cell gene expression datasets. This first (<xref rid="B19" ref-type="bibr">19</xref>) is a qPCR dataset which consists of expression levels of 33 transcription factors and 9 marker genes among 3934 cells with blood-forming potential. These cells can also be divided into five cell-types: primitive streak (PS), neural plate (NP), head fold (HF), GFP+ four somite (4SG) and Flk1+GFP&#x02212; (4SFG) cells. As in the previous section, we generated an ensemble of 50 lineage trees each obtained from a density-based subsample. Here we used a 50% down-sampling rate due to the large sample size. We set <italic>k</italic> = 5 to be comparable with the original paper (<xref rid="B19" ref-type="bibr">19</xref>). The resulting ECLAIR analysis tree contains five nodes along a single branch (Figure <xref ref-type="fig" rid="F3">3</xref>).</p><fig id="F3" orientation="portrait" position="float"><label>Figure 3.</label><caption><p>ECLAIR identifies lineage tree in blood-forming potential cells. The pie-charts represent the cell-type composition of each node using the same color scheme as in (<xref rid="B19" ref-type="bibr">19</xref>). The numbers indicate the labels for each CC.</p></caption><graphic xlink:href="gkw452fig3"/></fig><p>To test whether our ECLAIR analysis is consistent with prior biological knowledge, we analyzed the cell-type composition of each CC identified by ECLAIR and compared with the original analysis. We found that our consensus clustering identified similar but more refined structure than the original results. In particular, CC 1 is mainly composed of PS cells but also contains NP and HF cells, similarly to Cluster I in the original paper (Figure&#x000a0;<xref ref-type="fig" rid="F1">1E</xref> in (<xref rid="B19" ref-type="bibr">19</xref>) and Supplementary Figure S2a and c in (<xref rid="B19" ref-type="bibr">19</xref>)). CC2 is mainly composed of 4SFG cells but also has contributions from PS, HF and NP cells, similar to the upper part of Cluster II in Supplemental Figure S2c in (<xref rid="B19" ref-type="bibr">19</xref>). CC3 is composed HF and 4SFG cells, in accordance with middle part of Cluster II in Supplemental Figure S2c in (<xref rid="B19" ref-type="bibr">19</xref>). CC4 has nearly equal contribution from NP cells, well corresponding to the lower part of Cluster II in Supplemental Figure S2c in (<xref rid="B19" ref-type="bibr">19</xref>). Finally, CC5 is entirely contributed by 4SG cells, well corresponding to Cluster III in the original paper. As such, our ECLAIR analysis correctly recapitulated the cellular hierarchy.</p><p>Recently, single-cell RNAseq technologies have been rapidly developed to profile the whole transcriptome at single-cell resolution (<xref rid="B1" ref-type="bibr">1</xref>). To test whether ECLAIR can also be used to analyze single-cell RNAseq data, we analyzed a large dataset consisting of expression levels of 8716 genes in 2730 cells (<xref rid="B20" ref-type="bibr">20</xref>). The high-dimensionality of the data prevents direct application of ECLAIR. To circumvent this difficulty, we reduced the data dimensionality by using a computationally efficient variant of randomized PCA (<xref rid="B21" ref-type="bibr">21</xref>). We retained the top 50 principal components, which accounted for 74% of the total variance and applied ECLAIR to analyze the reduced dataset using the same parameter setting except for changing k to 19 in order to be comparable with the original study.</p><p>ECLAIR analysis identified a lineage tree which can be divided into two major branches (Figure <xref ref-type="fig" rid="F4">4A</xref>). The upper branch (CC1&#x02013;CC8) recapitulated the progression from early progenitors CC8 to erythroid lineages, whereas the lower branch (CC8&#x02013;CC19) recapitulated the progression from early progenitors to the myeloid lineages including monocytes, granulocytes and basophils. Close examination of the expression pattern of 33 lineage marker genes (Figure <xref ref-type="fig" rid="F4">4</xref>) identified striking similarity with the clustering patterns in the original paper (Figure <xref ref-type="fig" rid="F1">1c</xref> in (<xref rid="B20" ref-type="bibr">20</xref>)). In particular, CC1-3 are associated with Klf1, Gfi1b and Gata1 expression, characteristic of erythroid lineage progenitors, similar to Clusters 1&#x02013;6 in the original study (Figure <xref ref-type="fig" rid="F1">1c</xref> in (<xref rid="B20" ref-type="bibr">20</xref>)). CC4-7 represent transitional states, whereas CC8 is enriched with the early progenitor TF Gata2, which is similar to the C7 population in (<xref rid="B20" ref-type="bibr">20</xref>). CC9-12 are transitional states. CC13-18 are enriched with Cebpa, Mpo and several other myeloid lineage markers and associated with neutrophils, monocytes and eosinophils (similar to Clusters 14&#x02013;17 in (<xref rid="B20" ref-type="bibr">20</xref>)). Taken together, these analyses strongly suggest that our ECLAIR analysis is scalable to analyzing large datasets without losing accuracy.</p><fig id="F4" orientation="portrait" position="float"><label>Figure 4.</label><caption><p>Analysis of the single-cell RNAseq data in (<xref rid="B20" ref-type="bibr">20</xref>). (<bold>A</bold>) The lineage tree inferred by ECLAIR. The numbers represent the label for each CC. (<bold>B</bold>) Heatmap showing the expression pattern of 33 lineage markers.</p></caption><graphic xlink:href="gkw452fig4"/></fig></sec><sec id="SEC3-3"><title>ECLAIR significantly improves robustness over SPADE</title><p>To evaluate the robustness of ECLAIR, we analyzed a publicly-available mass cytometry dataset (<xref rid="B22" ref-type="bibr">22</xref>), which contains the expression levels of 9 protein markers for 500 000 cells from the mouse hematopoietic system. This dataset was originally used as the basis to develop SPADE (<xref rid="B4" ref-type="bibr">4</xref>), one of the prevalent methods for lineage reconstruction. Despite its wide applications, it has been noted that two independent runs of SPADE often lead to substantially different results. In the latest version, the developers attempted to solve the problem by fixing the value of a random seed for subsampling. However, this simple approach does not resolve the intrinsic problem of variability in the algorithm output.</p><p>ECLAIR has a similar model structure compared to SPADE, but uses an ensemble-based approach to improve the estimate robustness. We compared the performance of ECLAIR and SPADE based on the correlation between pairwise path lengths. For each method, we generated 50 trees. Note that each ECLAIR tree itself is obtained by aggregating information from 50 individual lineage trees from subsamples. We set the down-sampling parameter to 50% for both SPADE and ECLAIR. To quantify the reproducibility of each method, we compared the cell-pair path lengths obtained from any pair of the 50 tree estimates (Figure <xref ref-type="fig" rid="F5">5</xref>). For both methods, SPADE and ECLAIR, we obtain independent trees&#x02019; estimates from non-overlapping subsets of data and graph cell-pair path lengths (see &#x02018;Materials and Methods&#x02019; section for details). It is clear that the distribution is more densely populated near the diagonal for ECLAIR (Figure <xref ref-type="fig" rid="F5">5A</xref>) compared to SPADE (Figure <xref ref-type="fig" rid="F5">5C</xref>). For ECLAIR, the correlation coefficient between different pairs of trees varies between 0.73 and 0.94, with a mean of 0.86 and standard deviation of 0.05. For SPADE, the correlation coefficient between different pairs of trees varies from 0.70 and 0.83, with a mean of 0.75 and a standard deviation of 0.03, indicating ECLAIR significantly improves reproducibility.</p><fig id="F5" orientation="portrait" position="float"><label>Figure 5.</label><caption><p>Comparison of the reproducibility between ECLAIR (<bold>A</bold> and <bold>B</bold>) and SPADE (<bold>C</bold> and <bold>D</bold>). Each heatmap shows the probability density of the cell-pair path length estimated using two trees obtained from the same method. (A) Two independent runs of ECLAIR on the same training set. (B) Two independent runs of ECLAIR on different training datasets. (C) Two independent runs of SPADE on the same training set. (D) Two Independent runs of SPADE on different training datasets.</p></caption><graphic xlink:href="gkw452fig5"/></fig><p>In order to evaluate the robustness with respect to training data differences, we randomly divided the whole cell population into three equal-size non-overlapping subsets, labeled S1, S2 and S3, respectively. For each method, we constructed two lineage trees: one using S1 as the training set, whereas the other using S2 for model training. S3 was reserved as the testing set. Again, we compared the cell-pair path lengths obtained from two different trees from each method, based on cells in the S3 subset.). This procedure was repeated 10 times. The distribution is more densely populated near the diagonal for ECLAIR (Figure <xref ref-type="fig" rid="F5">5B</xref>) compared to SPADE (Figure <xref ref-type="fig" rid="F5">5D</xref> for ECLAIR, the correlation between different training sets varies from 0.72 to 0.91, with a mean value of 0.82; whereas for SPADE, the correlation varies between 0.62 and 0.82 with an average value of 0.75. Again, ECLAIR is significantly more reproducible compared to SPADE.</p></sec><sec id="SEC3-4"><title>Edge-specific dispersion rate</title><p>In view of the significant variation across the lineage trees obtained from different methods or, as we have shown here, from different training sets even using the same method, it is important to systematically quantify the robustness of different edges and to identify those edges that are the most robust. To this end, we have developed a quantitative metric, called dispersion rate, to evaluate the robustness of each edge in a lineage tree (see &#x02018;Materials and Methods&#x02019; section for detail).</p><p>For an ECLAIR tree obtained from the mass cytometry dataset (Supplementary Figure S2A), we estimated the edge-specific dispersion rates as a way to quantify uncertainty. We started by using the inter-ensemble dispersion rate <italic>&#x0010e;<sub>ij</sub></italic>. To this end, we obtained 50 ECLAIR trees, each from a randomly selected subsample containing 50% of the cells. Comparing the structure of two randomly picked ECLAIR trees (Supplementary Figures S2A and B), we find that the edges associated with lower dispersion rates (thicker edges) are conserved between the trees, indicating that the dispersion rate is an informative metric for edge robustness. For comparison, we also show two randomly picked SPADE trees obtained from the same data (Supplementary Figures S2C and D). We see that the overall structure is more variable.</p><p>Next, we compared the intra-ensemble <inline-formula><tex-math id="M60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat D_{ij}}$\end{document}</tex-math></inline-formula> and inter-ensemble <italic>&#x0010e;<sub>ij</sub></italic> estimates (Figure <xref ref-type="fig" rid="F6">6</xref> and Supplementary Figure S3). Although the definition and interpretation of these two uncertainty metrics is different, their correlation coefficient estimates is 0.69, indicating substantial agreement of the dispersion rates. In our examples we verified that <inline-formula><tex-math id="M61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat D_{ij}}$\end{document}</tex-math></inline-formula> is computationally less demanding than <italic>&#x0010e;<sub>ij</sub></italic>.</p><fig id="F6" orientation="portrait" position="float"><label>Figure 6.</label><caption><p>Correlation between the intra-ensemble and inter-ensemble dispersion rates.</p></caption><graphic xlink:href="gkw452fig6"/></fig></sec></sec><sec id="SEC4"><title>DISCUSSIONS AND CONCLUSIONS</title><p>One important goal in single-cell analysis is to map the cellular hierarchy within a cell population. Computational based predictions provide important guide for reconstructing lineage relationships which can then be experimentally tested. On the other hand, it must be recognized that such predictions are often associated with a high degree of uncertainty. Our ECLAIR method provides a systematic way to evaluate the uncertainty associated with lineage reconstruction. By comparing with SPADE, a state-of-the-art method for lineage reconstruction, we show that our method has improved the overall robustness and further quantifies the uncertainty for each predicted lineage relationship. The most reliable link may be prioritized for further experimental validation. We recognize that a number of similar methods have been recently developed (<xref rid="B6" ref-type="bibr">6</xref>,<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B23" ref-type="bibr">23</xref>). However, these methods are intended to reorder cells, without inference of multi-lineage relationships, therefore they are not discussed in our study.</p><p>Our ECLAIR analysis still does not entirely remove the variation even when using the same training dataset. However, if the ensemble size were set to a much large size, it follows from Cramer's theorem that the ECLAIR tree converges to a single solution, although the rate of convergence is slow and at odds with most practical purposes (<xref rid="B24" ref-type="bibr">24</xref>).</p><p>To aid with biological interpretation, we have represented the lineage relationship as a tree, as is commonly done. On the other hand, the full graph contains additional useful information, and it is more reproducible than the MST estimate itself (Supplementary Figure S4). The average correlation of graph weights is 0.96, which is much higher than that for the ECLAIR tree path lengths (<italic>R</italic> = 0.86). This is because the tree structure is sensitive to small perturbations of the underlying data (Supplementary Figure S5). The graph structure may be more suitable for comparison of different studies or subpopulations because of its enhanced reproducibility. Nonetheless, the MST approach still provides an intuitive interpretation as sequential events during cell differentiation. As such, ECLAIR provides both representations as model outputs.</p><p>Our ECLAIR method has important limitations. As in other similar methods, we assume that gene expression similarity is regulated by lineage similarity. However, this ignores the contributions of other mechanisms such as spatial organizations. As such, we should only view the predicted cell lineages as one possible hypothesis. More comprehensive experimental data are required to more accurately define cell lineage information.</p></sec>
<sec sec-type="supplementary-material">
<title>Supplementary Material</title>
<supplementary-material id="PMC_1" content-type="local-data">
<caption>
<title>SUPPLEMENTARY DATA</title>
</caption>
<media mimetype="text" mime-subtype="html" xlink:href="supp_44_14_e122__index.html"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_gkw452_nar-00022-met-n-2016-File008.pdf"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_gkw452_nar-00022-met-n-2016-File009.pdf"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_gkw452_nar-00022-met-n-2016-File010.pdf"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_gkw452_nar-00022-met-n-2016-File011.pdf"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_gkw452_nar-00022-met-n-2016-File012.pdf"/>
<media xlink:role="associated-file" mimetype="application" mime-subtype="pdf"
xlink:href="supp_gkw452_nar-00022-met-n-2016-File013.pdf"/>
</supplementary-material>
</sec>
</body><back><ack><p><italic>Authors' contributions</italic>: G.C.Y., E.M., G.G. and L.T. and conceived and designed the computational method. G.G., E.M., S.G. and L.T. implemented the method and analyzed the data. G.G. developed the software package. G.C.Y., L.T. and G.G. wrote the paper. All authors read and approved the final manuscript.</p></ack><fn-group><fn id="FN1" fn-type="present-address"><p>Present address: Eugenio Marco, Editas Medicine, Cambridge, MA 02142, USA.</p></fn></fn-group><sec id="SEC5"><title>SUPPLEMENTARY DATA</title><p><ext-link ext-link-type="uri" xlink:href="http://nar.oxfordjournals.org/lookup/suppl/doi:10.1093/nar/gkw452/-/DC1">Supplementary Data</ext-link> are available at NAR Online.</p></sec><sec id="SEC6"><title>FUNDING</title><p>Claudia Barr Award (to G.C.Y.); NIH [R01HL119099 to G.C.Y.]. Funding for open access charge: NIH.</p><p><italic>Conflict of interest statement</italic>. None declared.</p></sec><ref-list><title>REFERENCES</title><ref id="B1"><label>1.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Sandberg</surname><given-names>R.</given-names></name></person-group>
<article-title>Entering the era of single-cell transcriptomics in biology and medicine</article-title>
<source>Nat. Methods</source>
<year>2014</year>
<volume>11</volume>
<fpage>22</fpage><lpage>24</lpage><pub-id pub-id-type="pmid">24524133</pub-id></element-citation></ref><ref id="B2"><label>2.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Saadatpour</surname><given-names>A.</given-names></name><name><surname>Lai</surname><given-names>S.</given-names></name><name><surname>Guo</surname><given-names>G.</given-names></name><name><surname>Yuan</surname><given-names>G.C.</given-names></name></person-group>
<article-title>Single-cell analysis in cancer genomics</article-title>
<source>Trends Genet.</source>
<year>2015</year>
<volume>31</volume>
<fpage>576</fpage><lpage>586</lpage><pub-id pub-id-type="pmid">26450340</pub-id></element-citation></ref><ref id="B3"><label>3.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Stegle</surname><given-names>O.</given-names></name><name><surname>Teichmann</surname><given-names>S.A.</given-names></name><name><surname>Marioni</surname><given-names>J.C.</given-names></name></person-group>
<article-title>Computational and analytical challenges in single-cell transcriptomics</article-title>
<source>Nat. Rev. Genet.</source>
<year>2015</year>
<volume>16</volume>
<fpage>133</fpage><lpage>145</lpage><pub-id pub-id-type="pmid">25628217</pub-id></element-citation></ref><ref id="B4"><label>4.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Qiu</surname><given-names>P.</given-names></name><name><surname>Simonds</surname><given-names>E.F.</given-names></name><name><surname>Bendall</surname><given-names>S.C.</given-names></name><name><surname>Gibbs</surname><given-names>K.D.</given-names><suffix>Jr</suffix></name><name><surname>Bruggner</surname><given-names>R.V.</given-names></name><name><surname>Linderman</surname><given-names>M.D.</given-names></name><name><surname>Sachs</surname><given-names>K.</given-names></name><name><surname>Nolan</surname><given-names>G.P.</given-names></name><name><surname>Plevritis</surname><given-names>S.K.</given-names></name></person-group>
<article-title>Extracting a cellular hierarchy from high-dimensional cytometry data with SPADE</article-title>
<source>Nat. Biotechnol.</source>
<year>2011</year>
<volume>29</volume>
<fpage>886</fpage><lpage>891</lpage><pub-id pub-id-type="pmid">21964415</pub-id></element-citation></ref><ref id="B5"><label>5.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Treutlein</surname><given-names>B.</given-names></name><name><surname>Brownfield</surname><given-names>D.G.</given-names></name><name><surname>Wu</surname><given-names>A.R.</given-names></name><name><surname>Neff</surname><given-names>N.F.</given-names></name><name><surname>Mantalas</surname><given-names>G.L.</given-names></name><name><surname>Espinoza</surname><given-names>F.H.</given-names></name><name><surname>Desai</surname><given-names>T.J.</given-names></name><name><surname>Krasnow</surname><given-names>M.A.</given-names></name><name><surname>Quake</surname><given-names>S.R.</given-names></name></person-group>
<article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>
<source>Nature</source>
<year>2014</year>
<volume>509</volume>
<fpage>371</fpage><lpage>375</lpage><pub-id pub-id-type="pmid">24739965</pub-id></element-citation></ref><ref id="B6"><label>6.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Bendall</surname><given-names>S.C.</given-names></name><name><surname>Davis</surname><given-names>K.L.</given-names></name><name><surname>Amir&#x000a0;el</surname><given-names>A.D.</given-names></name><name><surname>Tadmor</surname><given-names>M.D.</given-names></name><name><surname>Simonds</surname><given-names>E.F.</given-names></name><name><surname>Chen</surname><given-names>T.J.</given-names></name><name><surname>Shenfeld</surname><given-names>D.K.</given-names></name><name><surname>Nolan</surname><given-names>G.P.</given-names></name><name><surname>Pe'er</surname><given-names>D.</given-names></name></person-group>
<article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</article-title>
<source>Cell</source>
<year>2014</year>
<volume>157</volume>
<fpage>714</fpage><lpage>725</lpage><pub-id pub-id-type="pmid">24766814</pub-id></element-citation></ref><ref id="B7"><label>7.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C.</given-names></name><name><surname>Cacchiarelli</surname><given-names>D.</given-names></name><name><surname>Grimsby</surname><given-names>J.</given-names></name><name><surname>Pokharel</surname><given-names>P.</given-names></name><name><surname>Li</surname><given-names>S.</given-names></name><name><surname>Morse</surname><given-names>M.</given-names></name><name><surname>Lennon</surname><given-names>N.J.</given-names></name><name><surname>Livak</surname><given-names>K.J.</given-names></name><name><surname>Mikkelsen</surname><given-names>T.S.</given-names></name><name><surname>Rinn</surname><given-names>J.L.</given-names></name></person-group>
<article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
<source>Nat. Biotechnol.</source>
<year>2014</year>
<volume>32</volume>
<fpage>381</fpage><lpage>386</lpage><pub-id pub-id-type="pmid">24658644</pub-id></element-citation></ref><ref id="B8"><label>8.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Marco</surname><given-names>E.</given-names></name><name><surname>Karp</surname><given-names>R.L.</given-names></name><name><surname>Guo</surname><given-names>G.</given-names></name><name><surname>Robson</surname><given-names>P.</given-names></name><name><surname>Hart</surname><given-names>A.H.</given-names></name><name><surname>Trippa</surname><given-names>L.</given-names></name><name><surname>Yuan</surname><given-names>G.C.</given-names></name></person-group>
<article-title>Bifurcation analysis of single-cell gene expression data reveals epigenetic landscape</article-title>
<source>Proc. Natl. Acad. Sci. U.S.A.</source>
<year>2014</year>
<volume>111</volume>
<fpage>E5643</fpage><lpage>E5650</lpage><pub-id pub-id-type="pmid">25512504</pub-id></element-citation></ref><ref id="B9"><label>9.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Wolpert</surname><given-names>D.H.</given-names></name><name><surname>Mecready</surname><given-names>W.G.</given-names></name></person-group>
<article-title>No free lunch theorems for optimization</article-title>
<source>IEEE Trans. Evol. Comput.</source>
<year>1997</year>
<volume>1</volume>
<fpage>67</fpage><lpage>82</lpage></element-citation></ref><ref id="B10"><label>10.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Polikar</surname><given-names>R.</given-names></name></person-group>
<article-title>Ensemble based systems in decision making</article-title>
<source>IEEE Circuits Syst. Mag.</source>
<year>2006</year>
<volume>6</volume>
<fpage>21</fpage><lpage>45</lpage></element-citation></ref><ref id="B11"><label>11.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Strehl</surname><given-names>A.</given-names></name><name><surname>Ghosh</surname><given-names>J.</given-names></name></person-group>
<article-title>Cluster ensembles { a knowledge reuse framework for combining multiple partitions</article-title>
<source>J. Mach. Learn. Res.</source>
<year>2002</year>
<volume>3</volume>
<fpage>583</fpage><lpage>617</lpage></element-citation></ref><ref id="B12"><label>12.</label><element-citation publication-type="book">
<person-group person-group-type="author"><name><surname>Hartigan</surname><given-names>J.A.</given-names></name></person-group>
<source>Clustering Algorithms</source>
<year>1975</year>
<publisher-loc>NY</publisher-loc>
<publisher-name>Wiley</publisher-name></element-citation></ref><ref id="B13"><label>13.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Frey</surname><given-names>B.J.</given-names></name><name><surname>Dueck</surname><given-names>D.</given-names></name></person-group>
<article-title>Clustering by passing messages between data points</article-title>
<source>Science</source>
<year>2007</year>
<volume>315</volume>
<fpage>972</fpage><lpage>976</lpage><pub-id pub-id-type="pmid">17218491</pub-id></element-citation></ref><ref id="B14"><label>14.</label><element-citation publication-type="book">
<person-group person-group-type="author"><name><surname>Ester</surname><given-names>M.</given-names></name><name><surname>Kriegel</surname><given-names>H.-P.</given-names></name><name><surname>Sander</surname><given-names>J.</given-names></name><name><surname>Xu</surname><given-names>X.</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Simoudis</surname><given-names>E</given-names></name><name><surname>Han</surname><given-names>J</given-names></name><name><surname>Fayyad</surname><given-names>U</given-names></name></person-group>
<article-title>A Density-based algorithm for discovering clusters in large spatial databases with noise</article-title>
<source>Proceedings of the Second International Conference on Knowledge Discovery and Data Mining</source>
<year>1996</year><publisher-name>AAAI Press</publisher-name>
<fpage>226</fpage><lpage>231</lpage></element-citation></ref><ref id="B15"><label>15.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Prim</surname><given-names>R.C.</given-names></name></person-group>
<article-title>Shortest connection networks And some generalizations</article-title>
<source>Bell Syst. Tech. J.</source>
<year>1957</year>
<volume>36</volume>
<fpage>1389</fpage><lpage>1401</lpage></element-citation></ref><ref id="B16"><label>16.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Conte</surname><given-names>D.</given-names></name><name><surname>Foggia</surname><given-names>P.</given-names></name><name><surname>Sansone</surname><given-names>C.</given-names></name><name><surname>Vento</surname><given-names>M.</given-names></name></person-group>
<article-title>Thirty years of graph matching in pattern recognition</article-title>
<source>Int. J. Pattern Recognit. Artif. Intell.</source>
<year>2004</year>
<volume>18</volume>
<fpage>265</fpage><lpage>298</lpage></element-citation></ref><ref id="B17"><label>17.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Guo</surname><given-names>G.</given-names></name><name><surname>Huss</surname><given-names>M.</given-names></name><name><surname>Tong</surname><given-names>G.Q.</given-names></name><name><surname>Wang</surname><given-names>C.</given-names></name><name><surname>Li&#x000a0;Sun</surname><given-names>L.</given-names></name><name><surname>Clarke</surname><given-names>N.D.</given-names></name><name><surname>Robson</surname><given-names>P.</given-names></name></person-group>
<article-title>Resolution of cell fate decisions revealed by single-cell gene expression analysis from zygote to blastocyst</article-title>
<source>Dev. Cell</source>
<year>2010</year>
<volume>18</volume>
<fpage>675</fpage><lpage>685</lpage><pub-id pub-id-type="pmid">20412781</pub-id></element-citation></ref><ref id="B18"><label>18.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Tibshirani</surname><given-names>R.</given-names></name><name><surname>Walther</surname><given-names>G.</given-names></name><name><surname>Hastie</surname><given-names>T.</given-names></name></person-group>
<article-title>Estimating the number of clusters in a data set via the gap statistic</article-title>
<source>J. R. Stat. Soc. B.</source>
<year>2001</year>
<volume>63</volume>
<fpage>411</fpage><lpage>423</lpage></element-citation></ref><ref id="B19"><label>19.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Moignard</surname><given-names>V.</given-names></name><name><surname>Woodhouse</surname><given-names>S.</given-names></name><name><surname>Haghverdi</surname><given-names>L.</given-names></name><name><surname>Lilly</surname><given-names>A.J.</given-names></name><name><surname>Tanaka</surname><given-names>Y.</given-names></name><name><surname>Wilkinson</surname><given-names>A.C.</given-names></name><name><surname>Buettner</surname><given-names>F.</given-names></name><name><surname>Macaulay</surname><given-names>I.C.</given-names></name><name><surname>Jawaid</surname><given-names>W.</given-names></name><name><surname>Diamanti</surname><given-names>E.</given-names></name><etal/></person-group>
<article-title>Decoding the regulatory network of early blood development from single-cell gene expression measurements</article-title>
<source>Nat. Biotechnol.</source>
<year>2015</year>
<volume>33</volume>
<fpage>269</fpage><lpage>276</lpage><pub-id pub-id-type="pmid">25664528</pub-id></element-citation></ref><ref id="B20"><label>20.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Paul</surname><given-names>F.</given-names></name><name><surname>Arkin</surname><given-names>Y.</given-names></name><name><surname>Giladi</surname><given-names>A.</given-names></name><name><surname>Jaitin</surname><given-names>D.A.</given-names></name><name><surname>Kenigsberg</surname><given-names>E.</given-names></name><name><surname>Keren-Shaul</surname><given-names>H.</given-names></name><name><surname>Winter</surname><given-names>D.</given-names></name><name><surname>Lara-Astiaso</surname><given-names>D.</given-names></name><name><surname>Gury</surname><given-names>M.</given-names></name><name><surname>Weiner</surname><given-names>A.</given-names></name><etal/></person-group>
<article-title>Transcriptional Heterogeneity and Lineage Commitment in Myeloid Progenitors</article-title>
<source>Cell</source>
<year>2015</year>
<volume>163</volume>
<fpage>1663</fpage><lpage>1677</lpage><pub-id pub-id-type="pmid">26627738</pub-id></element-citation></ref><ref id="B21"><label>21.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Halko</surname><given-names>N.</given-names></name><name><surname>Martinsson</surname><given-names>P.G.</given-names></name><name><surname>Tropp</surname><given-names>J.A.</given-names></name></person-group>
<article-title>Finding structure with randomness: probabilistic algorithms for constructing approximate matrix decompositions</article-title>
<source>SIAM Rev.</source>
<year>2009</year>
<volume>53</volume>
<fpage>217</fpage><lpage>288</lpage></element-citation></ref><ref id="B22"><label>22.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Bendall</surname><given-names>S.C.</given-names></name><name><surname>Simonds</surname><given-names>E.F.</given-names></name><name><surname>Qiu</surname><given-names>P.</given-names></name><name><surname>Amir&#x000a0;el</surname><given-names>A.D.</given-names></name><name><surname>Krutzik</surname><given-names>P.O.</given-names></name><name><surname>Finck</surname><given-names>R.</given-names></name><name><surname>Bruggner</surname><given-names>R.V.</given-names></name><name><surname>Melamed</surname><given-names>R.</given-names></name><name><surname>Trejo</surname><given-names>A.</given-names></name><name><surname>Ornatsky</surname><given-names>O.I.</given-names></name><etal/></person-group>
<article-title>Single-cell mass cytometry of differential immune and drug responses across a human hematopoietic continuum</article-title>
<source>Science</source>
<year>2011</year>
<volume>332</volume>
<fpage>687</fpage><lpage>696</lpage><pub-id pub-id-type="pmid">21551058</pub-id></element-citation></ref><ref id="B23"><label>23.</label><element-citation publication-type="journal">
<person-group person-group-type="author"><name><surname>Shin</surname><given-names>J.</given-names></name><name><surname>Berg</surname><given-names>D.A.</given-names></name><name><surname>Zhu</surname><given-names>Y.</given-names></name><name><surname>Shin</surname><given-names>J.Y.</given-names></name><name><surname>Song</surname><given-names>J.</given-names></name><name><surname>Bonaguidi</surname><given-names>M.A.</given-names></name><name><surname>Enikolopov</surname><given-names>G.</given-names></name><name><surname>Nauen</surname><given-names>D.W.</given-names></name><name><surname>Christian</surname><given-names>K.M.</given-names></name><name><surname>Ming</surname><given-names>G.L.</given-names></name><name><surname>Song</surname><given-names>H.</given-names></name></person-group>
<article-title>Single-cell RNA-seq with waterfall reveals molecular cascades underlying adult neurogenesis</article-title>
<source>Cell Stem Cell</source>
<year>2015</year>
<volume>17</volume>
<fpage>360</fpage><lpage>372</lpage><pub-id pub-id-type="pmid">26299571</pub-id></element-citation></ref><ref id="B24"><label>24.</label><element-citation publication-type="book">
<person-group person-group-type="author"><name><surname>Topchy</surname><given-names>A.P.</given-names></name><name><surname>Law</surname><given-names>M.H.C.</given-names></name><name><surname>Jain</surname><given-names>A.K.</given-names></name><name><surname>Fred</surname><given-names>A.L.</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Rastogi</surname><given-names>R</given-names></name><name><surname>Morik</surname><given-names>K</given-names></name><name><surname>Bramer</surname><given-names>M</given-names></name><name><surname>Wu</surname><given-names>X</given-names></name></person-group>
<article-title>Analysis of consensus partition in cluster ensemble</article-title>
<source>Fourth IEEE International Conference on Data Mining</source>
<year>2004</year><publisher-name>IEEE</publisher-name>
<fpage>225</fpage><lpage>232</lpage></element-citation></ref></ref-list></back></article>